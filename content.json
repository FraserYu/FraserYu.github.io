{"meta":{"title":"æ—¥æ‹±ä¸€å…µï½œJavaï½œSpring Bootï½œJavaå¹¶å‘ç¼–ç¨‹ï½œæœ€æ–°å¹²è´§åˆ†äº«","subtitle":"æ—¥æ‹±ä¸€å…µ","description":"æœ¬ç«™æ˜¯æ—¥æ‹±ä¸€å…µçš„æŠ€æœ¯åˆ†äº«åšå®¢ï¼Œå†…å®¹æ¶µç›–Javaåç«¯æŠ€æœ¯ã€Spring Bootã€Javaå¹¶å‘ç¼–ç¨‹ç­‰æŠ€æœ¯ç ”ç©¶ä¸åˆ†äº«ï¼Œç”¨æœ‰è¶£çš„æ–¹å¼è§£è¯»æŠ€æœ¯","author":"tanÎ¸","url":"https://dayarch.top","root":"/"},"pages":[{"title":"404 Not Found","date":"2020-07-25T13:39:31.518Z","updated":"2019-11-14T04:31:25.233Z","comments":true,"path":"404.html","permalink":"https://dayarch.top/404.html","excerpt":"404 Not Found **ç”±äºæ›´æ”¹äº†æ–‡ç« é“¾æ¥ï¼ŒåŸæœ‰é“¾æ¥ä¸¢å¤±ï¼Œä½†å†…å®¹ä¾æ—§åœ¨**è¯•è¯•åœ¨æœ¬ç«™é€šè¿‡æœç´¢å…³é”®å­—æ‰¾åˆ°ç›¸å…³æ–‡ç« ","text":"404 Not Found **ç”±äºæ›´æ”¹äº†æ–‡ç« é“¾æ¥ï¼ŒåŸæœ‰é“¾æ¥ä¸¢å¤±ï¼Œä½†å†…å®¹ä¾æ—§åœ¨** è¯•è¯•åœ¨æœ¬ç«™é€šè¿‡æœç´¢å…³é”®å­—æ‰¾åˆ°ç›¸å…³æ–‡ç« "},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2019-10-31T12:18:29.000Z","updated":"2019-10-31T12:44:03.895Z","comments":true,"path":"categories/index.html","permalink":"https://dayarch.top/categories/index.html","excerpt":"","text":""},{"title":"ç•™è¨€äº¤æµ","date":"2020-07-25T13:39:31.341Z","updated":"2019-11-03T12:15:27.885Z","comments":true,"path":"comments/index.html","permalink":"https://dayarch.top/comments/index.html","excerpt":"ä¸ºäº†æ›´å¥½çš„è·Ÿè¸ªå¤§å®¶ç•™è¨€é—®é¢˜ï¼Œç•™è¨€æ–¹å¼é€‰ç”¨ Gitalk, å¤§å®¶åªéœ€ç™»å½• Github è´¦å·å³å¯ç•™è¨€ï¼Œæ¬¢è¿å¤§å®¶æ¥è¸©â˜•ï¸","text":"ä¸ºäº†æ›´å¥½çš„è·Ÿè¸ªå¤§å®¶ç•™è¨€é—®é¢˜ï¼Œç•™è¨€æ–¹å¼é€‰ç”¨ Gitalk, å¤§å®¶åªéœ€ç™»å½• Github è´¦å·å³å¯ç•™è¨€ï¼Œæ¬¢è¿å¤§å®¶æ¥è¸©â˜•ï¸"},{"title":"å…³äºæˆ‘","date":"2019-10-31T12:27:35.000Z","updated":"2019-11-01T23:45:30.022Z","comments":true,"path":"about/index.html","permalink":"https://dayarch.top/about/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2019-10-31T12:18:52.000Z","updated":"2019-10-31T12:44:13.682Z","comments":true,"path":"tags/index.html","permalink":"https://dayarch.top/tags/index.html","excerpt":"","text":""},{"title":"æˆ‘çš„æœ‹å‹ä»¬ã€Œå‹é“¾æ·»åŠ åœ¨åº•éƒ¨ã€","date":"2019-10-31T07:45:38.000Z","updated":"2019-11-26T02:24:36.839Z","comments":true,"path":"friends/index.html","permalink":"https://dayarch.top/friends/index.html","excerpt":"éœ€è¦æ·»åŠ å‹é“¾ï¼Œè¯·åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œéœ€è¦ä»¥ä¸‹å†…å®¹ï¼š * å¤´åƒå¤–é“¾ï¼ˆå¦‚æœ‰ç™½åå•è®¾ç½®ï¼Œè¯·ä¸º https://dayarch.top å¼€ç™½åå•ï¼‰ * ç½‘ç«™/åšå®¢åç§° * ä¸¤ä¸ªæè¿°ä½ æˆ–ç½‘ç«™çš„ tag * ç½‘ç«™/åšå®¢ https URL åœ°å€","text":"éœ€è¦æ·»åŠ å‹é“¾ï¼Œè¯·åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œéœ€è¦ä»¥ä¸‹å†…å®¹ï¼š å¤´åƒå¤–é“¾ï¼ˆå¦‚æœ‰ç™½åå•è®¾ç½®ï¼Œè¯·ä¸º https://dayarch.top å¼€ç™½åå•ï¼‰ ç½‘ç«™/åšå®¢åç§° ä¸¤ä¸ªæè¿°ä½ æˆ–ç½‘ç«™çš„ tag ç½‘ç«™/åšå®¢ https URL åœ°å€"},{"title":"ç½‘ç«™ç»´æŠ¤æ—¥å¿—","date":"2020-07-25T13:39:31.510Z","updated":"2020-01-16T03:14:15.415Z","comments":true,"path":"website/index.html","permalink":"https://dayarch.top/website/index.html","excerpt":"å¾…å‡çº§/ä¿®å¤å†…å®¹ï¼š * æ–‡ç« åº•éƒ¨ github-badge * æ·»åŠ ç¤¾äº¤é“¾æ¥å’ŒRSS * ã€Œå…³äºã€é¡µé¢è‡ªå®šä¹‰æ”¹é€  * æ·»åŠ å…¶ä»–æ¸ é“é“¾æ¥ * bingçš„æ”¶å½• https://www.bing.com/webmaster/home/mysites * è‡ªå®šä¹‰é‚®ç®± https://mp.weixin.qq.com/s/Mg60BmNOou-2J0g0GRUEkAs * è½¬ç§»åˆ°è‡ªå·±çš„äº‘æœåŠ¡å™¨ä¸Š 2019.12.17: * ã€Œæ–°å¢ã€æ·»åŠ å…¶ä»–å¹³å°åšå®¢é“¾æ¥ * ã€Œä¼˜åŒ–ã€é¦–é¡µåŠæ–‡ç« é¡µé¢å»é™¤æ ‡ç­¾ç­‰åŒºåŸŸ * ã€Œä¼˜åŒ–ã€å»é™¤èƒŒæ™¯åŠ¨æ€æ•ˆæœ 2019.12.13: * ã€Œä¼˜åŒ–ã€å®Œ","text":"å¾…å‡çº§/ä¿®å¤å†…å®¹ï¼š æ–‡ç« åº•éƒ¨ github-badge æ·»åŠ ç¤¾äº¤é“¾æ¥å’ŒRSS ã€Œå…³äºã€é¡µé¢è‡ªå®šä¹‰æ”¹é€  æ·»åŠ å…¶ä»–æ¸ é“é“¾æ¥ bingçš„æ”¶å½• https://www.bing.com/webmaster/home/mysites è‡ªå®šä¹‰é‚®ç®± https://mp.weixin.qq.com/s/Mg60BmNOou-2J0g0GRUEkAs è½¬ç§»åˆ°è‡ªå·±çš„äº‘æœåŠ¡å™¨ä¸Š 2019.12.17: ã€Œæ–°å¢ã€æ·»åŠ å…¶ä»–å¹³å°åšå®¢é“¾æ¥ ã€Œä¼˜åŒ–ã€é¦–é¡µåŠæ–‡ç« é¡µé¢å»é™¤æ ‡ç­¾ç­‰åŒºåŸŸ ã€Œä¼˜åŒ–ã€å»é™¤èƒŒæ™¯åŠ¨æ€æ•ˆæœ 2019.12.13: ã€Œä¼˜åŒ–ã€å®Œæˆæ–‡ç« ç›¸å…³é“¾æ¥æŒ‡å‘åŠŸèƒ½ 2019.11.7: ã€Œä¼˜åŒ–ã€å®Œæˆåšå®¢å¤‡ä»½åŠŸèƒ½ 2019.11.4: ã€Œä¿®å¤ã€ç½‘ç«™ç»Ÿè®¡è®¿é—®äººæ•°ä¸æ˜¾ç¤ºé—®é¢˜ ã€Œä¿®å¤ã€ç§»åŠ¨ç«¯é¦–é¡µåŠ¨æ€å­—ä½“æ˜¾ç¤ºä¸å…¨é—®é¢˜ 2019.11.3: ã€Œæ–°å¢ã€ç«™å†…å¯¼èˆªæ–°å¢è±†ç“£è¯»ä¹¦ ã€Œæ–°å¢ã€å³ä¸‹è§’å³æ—¶èŠå¤©å·¥å…· ã€Œæ–°å¢ã€ç«™ç‚¹è¿è¡Œæ—¶é—´ ã€Œæ–°å¢ã€ç«™ç‚¹å­—æ•°ç»Ÿè®¡ 2019.11.2: ã€Œæ–°å¢ã€æ·»åŠ ç™¾åº¦/è°·æ­Œç«™é•¿ä»¥åŠåˆ†æå·¥å…· ã€Œæ–°å¢ã€å¢åŠ é¼ æ ‡ç‚¹å‡»ğŸ’¥æ•ˆæœ ã€Œæ–°å¢ã€é¦–é¡µåŠ¨æ€æ–‡å­—æ•ˆæœ ã€Œæ–°å¢ã€æ·»åŠ æ–‡ç«  sidebar éŸ³ä¹æ’ä»¶ 2019.11.1: ã€Œä¼˜åŒ–ã€æ›´æ¢åšå®¢ä¸»é¢˜ï¼Œä»¥åŠæ›´æ”¹é¢œè‰²æ ·å¼"}],"posts":[{"title":"SQLECTRON-è¶…è½»é‡çº§SQLå®¢æˆ·ç«¯","slug":"SQLECTRON-è¶…è½»é‡çº§SQLå®¢æˆ·ç«¯","date":"2020-07-26T13:36:47.000Z","updated":"2020-07-26T13:44:30.713Z","comments":true,"path":"/p/SQLECTRON-sql-client.html","link":"","permalink":"https://dayarch.top/p/SQLECTRON-sql-client.html","excerpt":"æ— æ„é—´çœ‹åˆ°è¿™ä¸ªSQLå®¢æˆ·ç«¯ï¼Œç¬é—´è¢«å®ƒç®€æ´çš„é¡µé¢å¸å¼•äº†ï¼Œ å¯åŠ¨ç”»é¢å¯èƒ½æ˜¯å®ƒæœ€å¤æ‚çš„å‘ˆç°äº†ï¼Œçˆ±æ²¡ï¼Ÿ SQLECTRON æŒ‰ç…§å®˜ç½‘ (https://sqlectron.github.io/, çœ‹ URL å‘ç°ï¼ŒSQLECTRONå®˜ç½‘éƒ½æ˜¯ç”¨ Github Pages æ­å»ºçš„) çš„è¯´æ˜ï¼š ä¸€ä¸ªç®€å•çš„è½»é‡çº§SQLå®¢æˆ·ç«¯æ¡Œé¢/ç»ˆç«¯ï¼Œå…·æœ‰è·¨æ•°æ®åº“å’Œè·¨å¹³å°çš„æ”¯æŒ çœ‹åˆ°è¿™ä½ åº”è¯¥æ”¾å¿ƒäº†ï¼Œæ— è®ºä½ ä½¿ç”¨çš„æ˜¯ Linuxï¼Œ Mac è¿˜æ˜¯ Windowsï¼Œéƒ½å¯ä»¥è¯•ä¸€è¯•ã€‚é‚£å®ƒæ”¯æŒå“ªäº›æ•°æ®åº“å‘¢ï¼Ÿä¸€ä¼šåˆ°å®‰è£…ç•Œé¢ä½ å°±ä¼šå‘ç°äº† è¿™é‡Œæˆ‘ç”¨ MAC æ¼”ç¤ºä¸€ä¸‹æ•´ä¸ªä½¿ç”¨è¿‡ç¨‹ å®‰è£…ä¸ä½¿ç”¨ å†™æœ¬æ–‡æ—¶çš„ç‰ˆæœ¬ä¸º v1.30.0, ç›´æ¥","text":"æ— æ„é—´çœ‹åˆ°è¿™ä¸ªSQLå®¢æˆ·ç«¯ï¼Œç¬é—´è¢«å®ƒç®€æ´çš„é¡µé¢å¸å¼•äº†ï¼Œ å¯åŠ¨ç”»é¢å¯èƒ½æ˜¯å®ƒæœ€å¤æ‚çš„å‘ˆç°äº†ï¼Œçˆ±æ²¡ï¼Ÿ SQLECTRONæŒ‰ç…§å®˜ç½‘ (https://sqlectron.github.io/, çœ‹ URL å‘ç°ï¼ŒSQLECTRONå®˜ç½‘éƒ½æ˜¯ç”¨ Github Pages æ­å»ºçš„) çš„è¯´æ˜ï¼š ä¸€ä¸ªç®€å•çš„è½»é‡çº§SQLå®¢æˆ·ç«¯æ¡Œé¢/ç»ˆç«¯ï¼Œå…·æœ‰è·¨æ•°æ®åº“å’Œè·¨å¹³å°çš„æ”¯æŒ çœ‹åˆ°è¿™ä½ åº”è¯¥æ”¾å¿ƒäº†ï¼Œæ— è®ºä½ ä½¿ç”¨çš„æ˜¯ Linuxï¼Œ Mac è¿˜æ˜¯ Windowsï¼Œéƒ½å¯ä»¥è¯•ä¸€è¯•ã€‚é‚£å®ƒæ”¯æŒå“ªäº›æ•°æ®åº“å‘¢ï¼Ÿä¸€ä¼šåˆ°å®‰è£…ç•Œé¢ä½ å°±ä¼šå‘ç°äº† è¿™é‡Œæˆ‘ç”¨ MAC æ¼”ç¤ºä¸€ä¸‹æ•´ä¸ªä½¿ç”¨è¿‡ç¨‹ å®‰è£…ä¸ä½¿ç”¨å†™æœ¬æ–‡æ—¶çš„ç‰ˆæœ¬ä¸º v1.30.0, ç›´æ¥ä¸‹è½½å®‰è£…åŒ…â€”â€”&gt;æ‹–æ‹½, ä¸€æ­¥å®‰è£…å®Œæˆ æ·»åŠ  Server å¡«å†™ç›¸å…³ä¿¡æ¯ï¼Œä»Database Type ä¸­ä½ åº”è¯¥å·²ç»çœ‹åˆ°äº†ï¼Œç›®å‰æ”¯æŒçš„æ•°æ®åº“ç±»å‹æœ‰ï¼š MySQL PostgreSQL Microsoft SQL Server SQLite Cassandra æµ‹è¯•è¿æ¥ â€”â€”&gt; Save å³å¯ é€‰æ‹©ç›¸åº”çš„ Serverï¼Œ ç„¶å Connectï¼Œæ‰§è¡Œä¸ª SQL è¯•ä¸€è¯• è·å–æ‰§è¡Œç»“æœåï¼Œå¯ä»¥å¿«é€Ÿç²˜è´´ä¸º JSON æˆ– CSV æ ¼å¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¯¼å‡ºç›¸åº”æ ¼å¼æ–‡ä»¶ï¼Œéå¸¸æ–¹ä¾¿ æ—¥å¸¸ explain ä¸ª SQLï¼Œ ç”»é£éƒ½ä¸ä¸€æ ·äº† è¯´å®ƒå¾ˆè½»é‡çº§ï¼Œæˆ‘ä»¬å’ŒDataGrip æ¥åšä¸ªæ¯”è¾ƒï¼ˆè¿™ä¹ˆæ¯”çœŸæ˜¯æ²¡æœ‰äººæ€§ï¼ŒDataGrip çš„åŠŸèƒ½æœ‰å¤šå°‘æ€ä¹ˆä¸è¯´å‘¢ï¼‰ å¦‚æœä¸æ˜¯é‡åº¦å®¢æˆ·ç«¯ä¾èµ–çš„åŒå­¦ï¼ŒSQLECTRON è¿˜æ˜¯æ»¡è¶³åŸºæœ¬è¦æ±‚çš„ ç”±äºå®¢æˆ·ç«¯æä¾›çš„åŠŸèƒ½å¹¶ä¸å¤æ‚ï¼Œæ‰€ä»¥å¿«æ·é”® (https://github.com/sqlectron/sqlectron-gui/wiki/Keyboard-Shortcuts)ä¹Ÿå°‘çš„å¯æ€œï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜… å¦‚æœä½ æ›´å–œæ¬¢ç»ˆç«¯å½¢å¼ï¼ŒSQLECTRON è¿˜æœ‰ä¸€ä¸ª SQLECTRON-TERM (https://github.com/sqlectron/sqlectron-term) å®¢æˆ·ç«¯æ”¯æŒï¼Œå°±åƒè¿™æ ·ï¼Œæµ“æµ“çš„ BIOS é£ åªéœ€ä¸€æ¡å‘½ä»¤å®‰è£…å³å¯ï¼ˆå‰ææ˜¯å®‰è£… Nodeï¼‰ 1npm install -g sqlectron-term Bu~t å…ˆåˆ«ç›²ç›®è¿½é€ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨ Javascript è¯­è¨€å®ç°çš„ï¼Œå¹¶ä¸”åœ¨ github ä¸Šçš„æ˜Ÿæ ‡å¹¶ä¸å¤š å› ä¸º Owner å‡ºäºå…´è¶£ç»´æŠ¤è¿™ä¸ªé¡¹ç›®ï¼Œä½†æ˜¯ç°åœ¨å…´è¶£æ²¡äº† æ€»ç»“å¦‚æœä½ åªæ˜¯åšæ—¥å¸¸çš„åŸºæœ¬ SQL æ‰§è¡Œï¼Œé‚£ä¹ˆ SQLECTRON å®Œå…¨å¯ä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ ä¸ç”¨å†æ‰¾ DataGrip æˆ– Navicat çš„æ³¨å†Œç ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šè®©ç”µè„‘å‘çƒ­å¤ªå¤šå‘ç”Ÿå¡é¡¿ å¦‚æœä½ æœ‰å…´è¶£çœ‹ä¸€çœ‹ï¼Œå¹¶ä¸”æƒ³å°è¯•ç»´æŠ¤è¿™ä¸ªé¡¹ç›®ï¼Œè¿™åˆæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é”»ç‚¼æœºä¼š","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"æ•°æ®åº“-æŒä¹…å±‚-SQL","slug":"Coding/æ•°æ®åº“-æŒä¹…å±‚-SQL","permalink":"https://dayarch.top/categories/Coding/%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%8C%81%E4%B9%85%E5%B1%82-SQL/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://dayarch.top/tags/MySQL/"}]},{"title":"java8 CompletableFuture ä½¿ç”¨è¯¦è§£","slug":"java8 CompletableFuture ä½¿ç”¨è¯¦è§£","date":"2020-07-19T13:17:30.000Z","updated":"2020-07-29T03:47:02.372Z","comments":true,"path":"/p/java8-completablefuture-tutorial.html","link":"","permalink":"https://dayarch.top/p/java8-completablefuture-tutorial.html","excerpt":"å‰è¨€ ä¸Šä¸€ç¯‡æ–‡ç«  ä¸ä¼šç”¨Java Futureï¼Œæˆ‘æ€€ç–‘ä½ æ³¡èŒ¶æ²¡æˆ‘å¿« å…¨é¢åˆ†æäº† Futureï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥è·å–çº¿ç¨‹çš„æ‰§è¡Œç»“æœï¼Œå®ƒè™½ç„¶è§£å†³äº† Runnable çš„ â€œä¸‰æ— â€ çŸ­æ¿ï¼Œä½†æ˜¯å®ƒè‡ªèº«è¿˜æ˜¯æœ‰çŸ­æ¿ï¼š ä¸èƒ½æ‰‹åŠ¨å®Œæˆè®¡ç®— å‡è®¾ä½ ä½¿ç”¨ Future è¿è¡Œå­çº¿ç¨‹è°ƒç”¨è¿œç¨‹ API æ¥è·å–æŸæ¬¾äº§å“çš„æœ€æ–°ä»·æ ¼ï¼ŒæœåŠ¡å™¨ç”±äºæ´ªç¾å®•æœºäº†ï¼Œæ­¤æ—¶å¦‚æœä½ æƒ³æ‰‹åŠ¨ç»“æŸè®¡ç®—ï¼Œè€Œæ˜¯æƒ³è¿”å›ä¸Šæ¬¡ç¼“å­˜ä¸­çš„ä»·æ ¼ï¼Œè¿™æ˜¯ Future åšä¸åˆ°çš„ è°ƒç”¨ get() æ–¹æ³•ä¼šé˜»å¡ç¨‹åº Future ä¸ä¼šé€šçŸ¥ä½ å®ƒçš„å®Œæˆï¼Œå®ƒæä¾›äº†ä¸€ä¸ªget()æ–¹æ³•ï¼Œç¨‹åºè°ƒç”¨è¯¥æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°ç»“æœå¯ç”¨ä¸ºæ­¢ï¼Œæ²¡æœ‰åŠæ³•åˆ©ç”¨å›è°ƒå‡½æ•°é™„åŠ åˆ°Futureï¼Œå¹¶åœ¨Fut","text":"å‰è¨€ä¸Šä¸€ç¯‡æ–‡ç«  ä¸ä¼šç”¨Java Futureï¼Œæˆ‘æ€€ç–‘ä½ æ³¡èŒ¶æ²¡æˆ‘å¿« å…¨é¢åˆ†æäº† Futureï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥è·å–çº¿ç¨‹çš„æ‰§è¡Œç»“æœï¼Œå®ƒè™½ç„¶è§£å†³äº† Runnable çš„ â€œä¸‰æ— â€ çŸ­æ¿ï¼Œä½†æ˜¯å®ƒè‡ªèº«è¿˜æ˜¯æœ‰çŸ­æ¿ï¼š ä¸èƒ½æ‰‹åŠ¨å®Œæˆè®¡ç®— å‡è®¾ä½ ä½¿ç”¨ Future è¿è¡Œå­çº¿ç¨‹è°ƒç”¨è¿œç¨‹ API æ¥è·å–æŸæ¬¾äº§å“çš„æœ€æ–°ä»·æ ¼ï¼ŒæœåŠ¡å™¨ç”±äºæ´ªç¾å®•æœºäº†ï¼Œæ­¤æ—¶å¦‚æœä½ æƒ³æ‰‹åŠ¨ç»“æŸè®¡ç®—ï¼Œè€Œæ˜¯æƒ³è¿”å›ä¸Šæ¬¡ç¼“å­˜ä¸­çš„ä»·æ ¼ï¼Œè¿™æ˜¯ Future åšä¸åˆ°çš„ è°ƒç”¨ get() æ–¹æ³•ä¼šé˜»å¡ç¨‹åº Future ä¸ä¼šé€šçŸ¥ä½ å®ƒçš„å®Œæˆï¼Œå®ƒæä¾›äº†ä¸€ä¸ªget()æ–¹æ³•ï¼Œç¨‹åºè°ƒç”¨è¯¥æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°ç»“æœå¯ç”¨ä¸ºæ­¢ï¼Œæ²¡æœ‰åŠæ³•åˆ©ç”¨å›è°ƒå‡½æ•°é™„åŠ åˆ°Futureï¼Œå¹¶åœ¨Futureçš„ç»“æœå¯ç”¨æ—¶è‡ªåŠ¨è°ƒç”¨å®ƒ ä¸èƒ½é“¾å¼æ‰§è¡Œ çƒ§æ°´æ³¡èŒ¶ä¸­ï¼Œé€šè¿‡æ„é€ å‡½æ•°ä¼ å‚åšåˆ°å¤šä¸ªä»»åŠ¡çš„é“¾å¼æ‰§è¡Œï¼Œä¸‡ä¸€æœ‰æ›´å¤šçš„ä»»åŠ¡ï¼Œæˆ–æ˜¯ä»»åŠ¡é“¾çš„æ‰§è¡Œé¡ºåºæœ‰å˜ï¼Œå¯¹åŸæœ‰ç¨‹åºçš„å½±å“éƒ½æ˜¯éå¸¸å¤§çš„ æ•´åˆå¤šä¸ª Future æ‰§è¡Œç»“æœæ–¹å¼ç¬¨é‡ å‡è®¾æœ‰å¤šä¸ª Future å¹¶è¡Œæ‰§è¡Œï¼Œéœ€è¦åœ¨è¿™äº›ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæˆä¹‹ååšåç»­æ“ä½œï¼ŒFuture æœ¬èº«æ˜¯åšä¸åˆ°çš„ï¼Œéœ€è¦å€ŸåŠ©å·¥å…·ç±» Executors çš„æ–¹æ³• 12&lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)&lt;T&gt; T invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks) æ²¡æœ‰å¼‚å¸¸å¤„ç† Future åŒæ ·æ²¡æœ‰æä¾›å¾ˆå¥½çš„å¼‚å¸¸å¤„ç†æ–¹æ¡ˆ ä¸Šä¸€ç¯‡æ–‡ç« çœ‹ Future è§‰å¾—æ˜¯å‘ç°äº†æ–°å¤©åœ°ï¼Œè¿™ä¹ˆä¸€è¯´æœ‰æ„Ÿè§‰å›åˆ°äº†è§£æ”¾å‰ å¯¹äº Java åç«¯çš„åŒå­¦ï¼Œåœ¨ Java1.8 ä¹‹å‰æƒ³å®ç°å¼‚æ­¥ç¼–ç¨‹ï¼Œè¿˜æƒ³é¿å¼€ä¸Šè¿°è¿™äº›çƒ¦æ¼ï¼ŒReactiveX åº”è¯¥æ˜¯ä¸€ä¸ªå¸¸è§è§£å†³æ–¹æ¡ˆï¼ˆåšAndroid çš„åº”è¯¥ä¼šæœ‰äº†è§£ï¼‰ã€‚å¦‚æœç†Ÿæ‚‰å‰ç«¯åŒå­¦ï¼Œ ES6 Promiseï¼ˆç”·æœ‹å‹çš„æ‰¿è¯ºï¼‰ä¹Ÿè§£å†³äº†å¼‚æ­¥ç¼–ç¨‹çš„çƒ¦æ¼ å¤©ä¸‹è¯­è¨€éƒ½åœ¨å½¼æ­¤å€Ÿé‰´ç›¸åº”ä¼˜ç‚¹ï¼ŒJava ä½œä¸ºè€ç‰ŒåŠ²æ—…è‡ªç„¶ä¹Ÿè¦è§£å†³ä¸Šè¿°é—®é¢˜ã€‚åˆæ˜¯é‚£ä¸ªç”·äººï¼Œå¹¶å‘å¤§å¸ˆ Doug Lea å¿§å¤©ä¸‹ç¨‹åºå‘˜ä¹‹å¿§ï¼Œè§£å¤©ä¸‹ç¨‹åºå‘˜ä¹‹å›°æ‰°ï¼Œåœ¨ Java1.8 ç‰ˆæœ¬ï¼ˆLambda æ¨ªç©ºå‡ºä¸–ï¼‰ä¸­ï¼Œæ–°å¢äº†ä¸€ä¸ªå¹¶å‘å·¥å…·ç±» CompletableFutureï¼Œå®ƒçš„å‡ºç°ï¼Œè®©äººåœ¨æ³¡èŒ¶è¿‡ç¨‹ä¸­ï¼Œå“å°åˆ°äº†ä¸ä¸€æ ·çš„å‘³é“â€¦â€¦ å‡ ä¸ªé‡è¦ Lambda å‡½æ•°CompletableFuture åœ¨ Java1.8 çš„ç‰ˆæœ¬ä¸­å‡ºç°ï¼Œè‡ªç„¶ä¹Ÿå¾—æ­ä¸Š Lambda çš„é¡ºé£è½¦ï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£ CompletableFutureï¼Œè¿™é‡Œæˆ‘éœ€è¦å…ˆä»‹ç»ä¸€ä¸‹å‡ ä¸ª Lambda å‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨å®ƒä»¬çš„ä»¥ä¸‹å‡ ç‚¹å°±å¯ä»¥ï¼š å‚æ•°æ¥å—å½¢å¼ è¿”å›å€¼å½¢å¼ å‡½æ•°åç§° RunnableRunnable æˆ‘ä»¬å·²ç»è¯´è¿‡æ— æ•°æ¬¡äº†ï¼Œæ— å‚æ•°ï¼Œæ— è¿”å›å€¼ 1234@FunctionalInterfacepublic interface Runnable &#123; public abstract void run();&#125; FunctionFunction&lt;T, R&gt; æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ 1234@FunctionalInterfacepublic interface Function&lt;T, R&gt; &#123; R apply(T t);&#125; ConsumerConsumer æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ 1234@FunctionalInterfacepublic interface Consumer&lt;T&gt; &#123; void accept(T t);&#125; SupplierSupplier æ²¡æœ‰å‚æ•°ï¼Œæœ‰ä¸€ä¸ªè¿”å›å€¼ 1234@FunctionalInterfacepublic interface Supplier&lt;T&gt; &#123; T get();&#125; BiConsumerBiConsumer&lt;T, U&gt; æ¥å—ä¸¤ä¸ªå‚æ•°ï¼ˆBiï¼Œ è‹±æ–‡å•è¯è¯æ ¹ï¼Œä»£è¡¨ä¸¤ä¸ªçš„æ„æ€ï¼‰ï¼Œæ²¡æœ‰è¿”å›å€¼ 123@FunctionalInterfacepublic interface BiConsumer&lt;T, U&gt; &#123; void accept(T t, U u); å¥½äº†ï¼Œæˆ‘ä»¬åšä¸ªå°æ±‡æ€» æœ‰äº›åŒå­¦å¯èƒ½æœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¦å…³æ³¨è¿™å‡ ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå› ä¸º CompletableFuture çš„å‡½æ•°å‘½åä»¥åŠå…¶ä½œç”¨éƒ½æ˜¯å’Œè¿™å‡ ä¸ªå‡½æ•°å¼æ¥å£é«˜åº¦ç›¸å…³çš„ï¼Œä¸€ä¼šä½ å°±ä¼šå‘ç°äº† å‰æˆåšè¶³ï¼Œç»ˆäºå¯ä»¥è¿›å…¥æ­£é¢˜äº† CompletableFuture CompletableFutureç±»ç»“æ„è€è§„çŸ©ï¼Œå…ˆä»ç±»ç»“æ„çœ‹èµ·ï¼š å®ç°äº† Future æ¥å£å®ç°äº† Future æ¥å£ï¼Œé‚£å°±å…·æœ‰ Future æ¥å£çš„ç›¸å…³ç‰¹æ€§ï¼Œè¯·è„‘è¡¥ Future é‚£å°‘çš„å¯æ€œçš„ 5 ä¸ªæ–¹æ³•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œå…·ä½“è¯·æŸ¥çœ‹ ä¸ä¼šç”¨Java Futureï¼Œæˆ‘æ€€ç–‘ä½ æ³¡èŒ¶æ²¡æˆ‘å¿« å®ç°äº† CompletionStage æ¥å£CompletionStage è¿™ä¸ªæ¥å£è¿˜æ˜¯æŒºé™Œç”Ÿçš„ï¼Œä¸­æ–‡ç›´è¯‘è¿‡æ¥æ˜¯ã€ç«£å·¥é˜¶æ®µã€‘ï¼Œå¦‚æœå°†çƒ§æ°´æ³¡èŒ¶æ¯”å–»æˆä¸€é¡¹å¤§å·¥ç¨‹ï¼Œä»–ä»¬çš„ç«£å·¥é˜¶æ®µä½“ç°æ˜¯ä¸ä¸€æ ·çš„ å•çœ‹çº¿ç¨‹1 æˆ–å•çœ‹çº¿ç¨‹ 2 å°±æ˜¯ä¸€ç§ä¸²è¡Œå…³ç³»ï¼Œåšå®Œä¸€æ­¥ä¹‹ååšä¸‹ä¸€æ­¥ ä¸€èµ·çœ‹çº¿ç¨‹1 å’Œ çº¿ç¨‹ 2ï¼Œå®ƒä»¬å½¼æ­¤å°±æ˜¯å¹¶è¡Œå…³ç³»ï¼Œä¸¤ä¸ªçº¿ç¨‹åšçš„äº‹å½¼æ­¤ç‹¬ç«‹äº’ä¸å¹²æ‰° æ³¡èŒ¶å°±æ˜¯çº¿ç¨‹1 å’Œ çº¿ç¨‹ 2 çš„æ±‡æ€»/ç»„åˆï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ 1 å’Œ çº¿ç¨‹ 2 éƒ½å®Œæˆä¹‹åæ‰èƒ½åˆ°è¿™ä¸ªé˜¶æ®µï¼ˆå½“ç„¶ä¹Ÿå­˜åœ¨çº¿ç¨‹1 æˆ– çº¿ç¨‹ 2 ä»»æ„ä¸€ä¸ªçº¿ç¨‹ç«£å·¥å°±å¯ä»¥å¼€å¯ä¸‹ä¸€é˜¶æ®µçš„åœºæ™¯ï¼‰ æ‰€ä»¥ï¼ŒCompletionStage æ¥å£çš„ä½œç”¨å°±åšäº†è¿™ç‚¹äº‹ï¼Œæ‰€æœ‰å‡½æ•°éƒ½ç”¨äºæè¿°ä»»åŠ¡çš„æ—¶åºå…³ç³»ï¼Œæ€»ç»“èµ·æ¥å°±æ˜¯è¿™ä¸ªæ ·å­ï¼š CompletableFuture æ—¢ç„¶å®ç°äº†ä¸¤ä¸ªæ¥å£ï¼Œè‡ªç„¶ä¹Ÿå°±ä¼šå®ç°ç›¸åº”çš„æ–¹æ³•å……åˆ†åˆ©ç”¨å…¶æ¥å£ç‰¹æ€§ï¼Œæˆ‘ä»¬èµ°è¿›å®ƒçš„æ–¹æ³•æ¥çœ‹ä¸€çœ‹ CompletableFuture å¤§çº¦æœ‰50ç§ä¸åŒå¤„ç†ä¸²è¡Œï¼Œå¹¶è¡Œï¼Œç»„åˆä»¥åŠå¤„ç†é”™è¯¯çš„æ–¹æ³•ã€‚å°å¼Ÿå±å¹•ä¸äº‰æ°”ï¼Œæ–¹æ³•ä¹‹å¤šï¼Œä¸€ä¸ªå±å¹•è£…ä¸ä¸‹ï¼Œçœ‹åˆ°è¿™ä¹ˆå¤šæ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯ç¬é—´è¦ç›´æ¥ æ”¶è—â€”â€”&gt;åƒç° 2è¿èµ°äººï¼Ÿåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬æŒ‰ç…§ç›¸åº”çš„å‘½åå’Œä½œç”¨è¿›è¡Œåˆ†ç±»ï¼Œåˆ†åˆ†é’Ÿæå®š50å¤šç§æ–¹æ³• ä¸²è¡Œå…³ç³»then ç›´è¯‘ã€ç„¶åã€‘ï¼Œä¹Ÿå°±æ˜¯è¡¨ç¤ºä¸‹ä¸€æ­¥ï¼Œæ‰€ä»¥é€šå¸¸æ˜¯ä¸€ç§ä¸²è¡Œå…³ç³»ä½“ç°, then åé¢çš„å•è¯ï¼ˆæ¯”å¦‚ run /apply/acceptï¼‰å°±æ˜¯ä¸Šé¢è¯´çš„å‡½æ•°å¼æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•åç§°äº†ï¼Œå®ƒçš„ä½œç”¨å’Œé‚£å‡ ä¸ªå‡½æ•°å¼æ¥å£çš„ä½œç”¨æ˜¯ä¸€æ ·ä¸€æ ·æ»´ 123456789101112131415CompletableFuture&lt;Void&gt; thenRun(Runnable action)CompletableFuture&lt;Void&gt; thenRunAsync(Runnable action)CompletableFuture&lt;Void&gt; thenRunAsync(Runnable action, Executor executor) &lt;U&gt; CompletableFuture&lt;U&gt; thenApply(Function&lt;? super T,? extends U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; thenApplyAsync(Function&lt;? super T,? extends U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; thenApplyAsync(Function&lt;? super T,? extends U&gt; fn, Executor executor) CompletableFuture&lt;Void&gt; thenAccept(Consumer&lt;? super T&gt; action) CompletableFuture&lt;Void&gt; thenAcceptAsync(Consumer&lt;? super T&gt; action)CompletableFuture&lt;Void&gt; thenAcceptAsync(Consumer&lt;? super T&gt; action, Executor executor) &lt;U&gt; CompletableFuture&lt;U&gt; thenCompose(Function&lt;? super T, ? extends CompletionStage&lt;U&gt;&gt; fn) &lt;U&gt; CompletableFuture&lt;U&gt; thenComposeAsync(Function&lt;? super T, ? extends CompletionStage&lt;U&gt;&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; thenComposeAsync(Function&lt;? super T, ? extends CompletionStage&lt;U&gt;&gt; fn, Executor executor) èšåˆ And å…³ç³»combine... with... å’Œ both...and... éƒ½æ˜¯è¦æ±‚ä¸¤è€…éƒ½æ»¡è¶³ï¼Œä¹Ÿå°±æ˜¯ and çš„å…³ç³»äº† 1234567891011&lt;U,V&gt; CompletableFuture&lt;V&gt; thenCombine(CompletionStage&lt;? extends U&gt; other, BiFunction&lt;? super T,? super U,? extends V&gt; fn)&lt;U,V&gt; CompletableFuture&lt;V&gt; thenCombineAsync(CompletionStage&lt;? extends U&gt; other, BiFunction&lt;? super T,? super U,? extends V&gt; fn)&lt;U,V&gt; CompletableFuture&lt;V&gt; thenCombineAsync(CompletionStage&lt;? extends U&gt; other, BiFunction&lt;? super T,? super U,? extends V&gt; fn, Executor executor)&lt;U&gt; CompletableFuture&lt;Void&gt; thenAcceptBoth(CompletionStage&lt;? extends U&gt; other, BiConsumer&lt;? super T, ? super U&gt; action)&lt;U&gt; CompletableFuture&lt;Void&gt; thenAcceptBothAsync(CompletionStage&lt;? extends U&gt; other, BiConsumer&lt;? super T, ? super U&gt; action)&lt;U&gt; CompletableFuture&lt;Void&gt; thenAcceptBothAsync( CompletionStage&lt;? extends U&gt; other, BiConsumer&lt;? super T, ? super U&gt; action, Executor executor) CompletableFuture&lt;Void&gt; runAfterBoth(CompletionStage&lt;?&gt; other, Runnable action)CompletableFuture&lt;Void&gt; runAfterBothAsync(CompletionStage&lt;?&gt; other, Runnable action)CompletableFuture&lt;Void&gt; runAfterBothAsync(CompletionStage&lt;?&gt; other, Runnable action, Executor executor) èšåˆ Or å…³ç³»Either...or... è¡¨ç¤ºä¸¤è€…ä¸­çš„ä¸€ä¸ªï¼Œè‡ªç„¶ä¹Ÿå°±æ˜¯ Or çš„ä½“ç°äº† 1234567891011&lt;U&gt; CompletableFuture&lt;U&gt; applyToEither(CompletionStage&lt;? extends T&gt; other, Function&lt;? super T, U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; applyToEitherAsync(ã€CompletionStage&lt;? extends T&gt; other, Function&lt;? super T, U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; applyToEitherAsync(CompletionStage&lt;? extends T&gt; other, Function&lt;? super T, U&gt; fn, Executor executor)CompletableFuture&lt;Void&gt; acceptEither(CompletionStage&lt;? extends T&gt; other, Consumer&lt;? super T&gt; action)CompletableFuture&lt;Void&gt; acceptEitherAsync(CompletionStage&lt;? extends T&gt; other, Consumer&lt;? super T&gt; action)CompletableFuture&lt;Void&gt; acceptEitherAsync(CompletionStage&lt;? extends T&gt; other, Consumer&lt;? super T&gt; action, Executor executor)CompletableFuture&lt;Void&gt; runAfterEither(CompletionStage&lt;?&gt; other, Runnable action)CompletableFuture&lt;Void&gt; runAfterEitherAsync(CompletionStage&lt;?&gt; other, Runnable action)CompletableFuture&lt;Void&gt; runAfterEitherAsync(CompletionStage&lt;?&gt; other, Runnable action, Executor executor) å¼‚å¸¸å¤„ç†123456789101112CompletableFuture&lt;T&gt; exceptionally(Function&lt;Throwable, ? extends T&gt; fn)CompletableFuture&lt;T&gt; exceptionallyAsync(Function&lt;Throwable, ? extends T&gt; fn)CompletableFuture&lt;T&gt; exceptionallyAsync(Function&lt;Throwable, ? extends T&gt; fn, Executor executor) CompletableFuture&lt;T&gt; whenComplete(BiConsumer&lt;? super T, ? super Throwable&gt; action)CompletableFuture&lt;T&gt; whenCompleteAsync(BiConsumer&lt;? super T, ? super Throwable&gt; action)CompletableFuture&lt;T&gt; whenCompleteAsync(BiConsumer&lt;? super T, ? super Throwable&gt; action, Executor executor) &lt;U&gt; CompletableFuture&lt;U&gt; handle(BiFunction&lt;? super T, Throwable, ? extends U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; handleAsync(BiFunction&lt;? super T, Throwable, ? extends U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; handleAsync(BiFunction&lt;? super T, Throwable, ? extends U&gt; fn, Executor executor) è¿™ä¸ªå¼‚å¸¸å¤„ç†çœ‹ç€è¿˜æŒºå“äººçš„ï¼Œæ‹¿ä¼ ç»Ÿçš„ try/catch/finally åšä¸ªå¯¹æ¯”ä¹Ÿå°±ç¬é—´ç§’æ‡‚äº† whenComplete å’Œ handle çš„åŒºåˆ«å¦‚æœä½ çœ‹æ¥å—çš„å‚æ•°å‡½æ•°å¼æ¥å£åç§°ä½ ä¹Ÿå°±èƒ½çœ‹å‡ºå·®åˆ«äº†ï¼Œå‰è€…ä½¿ç”¨Comsumer, è‡ªç„¶ä¹Ÿå°±ä¸ä¼šæœ‰è¿”å›å€¼ï¼›åè€…ä½¿ç”¨ Functionï¼Œè‡ªç„¶ä¹Ÿå°±ä¼šæœ‰è¿”å›å€¼ è¿™é‡Œå¹¶æ²¡æœ‰å…¨éƒ¨åˆ—ä¸¾ï¼Œä¸è¿‡ç›¸ä¿¡å¾ˆå¤šåŒå­¦å·²ç»å‘ç°äº†è§„å¾‹ï¼š CompletableFuture æä¾›çš„æ‰€æœ‰å›è°ƒæ–¹æ³•éƒ½æœ‰ä¸¤ä¸ªå¼‚æ­¥ï¼ˆAsyncï¼‰å˜ä½“ï¼Œéƒ½åƒè¿™æ · 1234// thenApply() çš„å˜ä½“&lt;U&gt; CompletableFuture&lt;U&gt; thenApply(Function&lt;? super T,? extends U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; thenApplyAsync(Function&lt;? super T,? extends U&gt; fn)&lt;U&gt; CompletableFuture&lt;U&gt; thenApplyAsync(Function&lt;? super T,? extends U&gt; fn, Executor executor) å¦å¤–,æ–¹æ³•çš„åç§°ä¹Ÿéƒ½ä¸å‰æˆä¸­è¯´çš„å‡½æ•°å¼æ¥å£å®Œå…¨åŒ¹é…ï¼ŒæŒ‰ç…§è¿™ä¸­è§„å¾‹åˆ†ç±»ä¹‹åï¼Œè¿™ 50 å¤šä¸ªæ–¹æ³•çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆè½»æ¾äº†å‘¢ï¼Ÿ åŸºæœ¬æ–¹æ³•å·²ç»ç½—åˆ—çš„å·®ä¸å¤šäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­æ¥å®é™…æ¼”ç¤ºä¸€ä¸‹ï¼š æ¡ˆä¾‹æ¼”ç¤ºåˆ›å»ºä¸€ä¸ª CompletableFuture å¯¹è±¡åˆ›å»ºä¸€ä¸ª CompletableFuture å¯¹è±¡å¹¶æ²¡æœ‰ä»€ä¹ˆç¨€å¥‡çš„ï¼Œä¾æ—§æ˜¯é€šè¿‡æ„é€ å‡½æ•°æ„å»º 1CompletableFuture&lt;String&gt; completableFuture = new CompletableFuture&lt;String&gt;(); è¿™æ˜¯æœ€ç®€å•çš„ CompletableFuture å¯¹è±¡åˆ›å»ºæ–¹å¼ï¼Œç”±äºå®ƒå®ç°äº† Future æ¥å£ï¼Œæ‰€ä»¥è‡ªç„¶å°±å¯ä»¥é€šè¿‡ get() æ–¹æ³•è·å–ç»“æœ 1String result = completableFuture.get(); æ–‡ç« å¼€å¤´å·²ç»è¯´è¿‡ï¼Œget()æ–¹æ³•åœ¨ä»»åŠ¡ç»“æŸä¹‹å‰å°†ä¸€ç›´å¤„åœ¨é˜»å¡çŠ¶æ€ï¼Œç”±äºä¸Šé¢åˆ›å»ºçš„ Future æ²¡æœ‰è¿”å›ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œè°ƒç”¨ get() å°†ä¼šæ°¸ä¹…æ€§çš„å µå¡ è¿™æ—¶å°±éœ€è¦æˆ‘ä»¬è°ƒç”¨ complete() æ–¹æ³•æ‰‹åŠ¨çš„ç»“æŸä¸€ä¸ª Future 1completableFuture.complete(\"Future's Result Here Manually\"); è¿™æ—¶ï¼Œæ‰€æœ‰ç­‰å¾…è¿™ä¸ª Future çš„ client éƒ½ä¼šè¿”å›æ‰‹åŠ¨ç»“æŸçš„æŒ‡å®šç»“æœ runAsyncä½¿ç”¨ runAsync è¿›è¡Œå¼‚æ­¥è®¡ç®— 12345678910CompletableFuture&lt;Void&gt; future = CompletableFuture.runAsync(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(3); &#125; catch (InterruptedException e) &#123; throw new IllegalStateException(e); &#125; System.out.println(\"è¿è¡Œåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å½“ä¸­\");&#125;);future.get(); ç”±äºä½¿ç”¨çš„æ˜¯ Runnable å‡½æ•°å¼è¡¨è¾¾å¼ï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šè·å–åˆ°ç»“æœ supplyAsyncä½¿ç”¨ runAsync æ˜¯æ²¡æœ‰è¿”å›ç»“æœçš„ï¼Œæˆ‘ä»¬æƒ³è·å–å¼‚æ­¥è®¡ç®—çš„è¿”å›ç»“æœéœ€è¦ä½¿ç”¨ supplyAsync() æ–¹æ³• 1234567891011CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(3); &#125; catch (InterruptedException e) &#123; throw new IllegalStateException(e); &#125; log.info(\"è¿è¡Œåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å½“ä¸­\"); return \"æˆ‘æœ‰è¿”å›å€¼\";&#125;);log.info(future.get()); ç”±äºä½¿ç”¨çš„æ˜¯ Supplier å‡½æ•°å¼è¡¨è¾¾å¼ï¼Œè‡ªç„¶å¯ä»¥è·å¾—è¿”å›ç»“æœ æˆ‘ä»¬å·²ç»å¤šæ¬¡è¯´è¿‡ï¼Œget() æ–¹æ³•åœ¨Future è®¡ç®—å®Œæˆä¹‹å‰ä¼šä¸€ç›´å¤„åœ¨ blocking çŠ¶æ€ä¸‹ï¼Œå¯¹äºçœŸæ­£çš„å¼‚æ­¥å¤„ç†ï¼Œæˆ‘ä»¬å¸Œæœ›çš„æ˜¯å¯ä»¥é€šè¿‡ä¼ å…¥å›è°ƒå‡½æ•°ï¼Œåœ¨Future ç»“æŸæ—¶è‡ªåŠ¨è°ƒç”¨è¯¥å›è°ƒå‡½æ•°ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸ç”¨ç­‰å¾…ç»“æœ 12345678910111213141516171819CompletableFuture&lt;String&gt; comboText = CompletableFuture.supplyAsync(() -&gt; &#123; //å¯ä»¥æ³¨é‡Šæ‰åšå¿«é€Ÿè¿”å› start try &#123; TimeUnit.SECONDS.sleep(3); &#125; catch (InterruptedException e) &#123; throw new IllegalStateException(e); &#125; log.info(\"ğŸ‘\"); //å¯ä»¥æ³¨é‡Šæ‰åšå¿«é€Ÿè¿”å› end return \"èµ\"; &#125;) .thenApply(first -&gt; &#123; log.info(\"åœ¨çœ‹\"); return first + \", åœ¨çœ‹\"; &#125;) .thenApply(second -&gt; second + \", è½¬å‘\"); log.info(\"ä¸‰è¿æœ‰æ²¡æœ‰ï¼Ÿ\"); log.info(comboText.get()); å¯¹ thenApply çš„è°ƒç”¨å¹¶æ²¡æœ‰é˜»å¡ç¨‹åºæ‰“å°logï¼Œä¹Ÿå°±æ˜¯å‰é¢è¯´çš„é€šè¿‡å›è°ƒé€šçŸ¥æœºåˆ¶ï¼Œ è¿™é‡Œä½ çœ‹åˆ° thenApply ä½¿ç”¨çš„æ˜¯supplyAsyncæ‰€ç”¨çš„çº¿ç¨‹ï¼Œå¦‚æœå°†supplyAsync åšå¿«é€Ÿè¿”å›ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹è¿è¡Œç»“æœï¼š thenApply æ­¤æ—¶ä½¿ç”¨çš„æ˜¯ä¸»çº¿ç¨‹ï¼Œæ‰€ä»¥ï¼š ä¸²è¡Œçš„åç»­æ“ä½œå¹¶ä¸ä¸€å®šä¼šå’Œå‰åºæ“ä½œä½¿ç”¨åŒä¸€ä¸ªçº¿ç¨‹ thenAcceptå¦‚æœä½ ä¸æƒ³ä»å›è°ƒå‡½æ•°ä¸­è¿”å›ä»»ä½•ç»“æœï¼Œé‚£å¯ä»¥ä½¿ç”¨ thenAccept 1234567final CompletableFuture&lt;Void&gt; voidCompletableFuture = CompletableFuture.supplyAsync( // æ¨¡æ‹Ÿè¿œç«¯APIè°ƒç”¨ï¼Œè¿™é‡Œåªè¿”å›äº†ä¸€ä¸ªæ„é€ çš„å¯¹è±¡ () -&gt; Product.builder().id(12345L).name(\"é¢ˆæ¤/è…°æ¤æ²»ç–—ä»ª\").build()) .thenAccept(product -&gt; &#123; log.info(\"è·å–åˆ°è¿œç¨‹APIäº§å“åç§° \" + product.getName()); &#125;);voidCompletableFuture.get(); thenRunthenAccept å¯ä»¥ä»å›è°ƒå‡½æ•°ä¸­è·å–å‰åºæ‰§è¡Œçš„ç»“æœï¼Œä½†thenRun å´ä¸å¯ä»¥ï¼Œå› ä¸ºå®ƒçš„å›è°ƒå‡½æ•°å¼è¡¨è¾¾å¼å®šä¹‰ä¸­æ²¡æœ‰ä»»ä½•å‚æ•° 12345CompletableFuture.supplyAsync(() -&gt; &#123; //å‰åºæ“ä½œ&#125;).thenRun(() -&gt; &#123; //ä¸²è¡Œçš„åéœ€æ“ä½œï¼Œæ— å‚æ•°ä¹Ÿæ— è¿”å›å€¼&#125;); æˆ‘ä»¬å‰é¢åŒæ ·è¯´è¿‡äº†ï¼Œæ¯ä¸ªæä¾›å›è°ƒæ–¹æ³•çš„å‡½æ•°éƒ½æœ‰ä¸¤ä¸ªå¼‚æ­¥ï¼ˆAsyncï¼‰å˜ä½“ï¼Œå¼‚æ­¥å°±æ˜¯å¦å¤–èµ·ä¸€ä¸ªçº¿ç¨‹ 1234567CompletableFuture&lt;String&gt; stringCompletableFuture = CompletableFuture.supplyAsync(() -&gt; &#123; log.info(\"å‰åºæ“ä½œ\"); return \"å‰éœ€æ“ä½œç»“æœ\";&#125;).thenApplyAsync(result -&gt; &#123; log.info(\"åç»­æ“ä½œ\"); return \"åç»­æ“ä½œç»“æœ\";&#125;); åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ ä¸²è¡Œçš„æ“ä½œä½ å·²ç»éå¸¸ç†Ÿç»ƒäº† thenComposeæ—¥å¸¸çš„ä»»åŠ¡ä¸­ï¼Œé€šå¸¸å®šä¹‰çš„æ–¹æ³•éƒ½ä¼šè¿”å› CompletableFuture ç±»å‹ï¼Œè¿™æ ·ä¼šç»™åç»­æ“ä½œç•™æœ‰æ›´å¤šçš„ä½™åœ°ï¼Œå‡å¦‚æœ‰è¿™æ ·çš„ä¸šåŠ¡ï¼ˆXå‘—æ˜¯ä¸æ˜¯éƒ½æœ‰è¿™æ ·çš„ä¸šåŠ¡å‘¢ï¼Ÿï¼‰ï¼š 123456789//è·å–ç”¨æˆ·ä¿¡æ¯è¯¦æƒ… CompletableFuture&lt;User&gt; getUsersDetail(String userId) &#123; return CompletableFuture.supplyAsync(() -&gt; User.builder().id(12345L).name(\"æ—¥æ‹±ä¸€å…µ\").build()); &#125; //è·å–ç”¨æˆ·ä¿¡ç”¨è¯„çº§ CompletableFuture&lt;Double&gt; getCreditRating(User user) &#123; return CompletableFuture.supplyAsync(() -&gt; CreditRating.builder().rating(7.5).build().getRating()); &#125; è¿™æ—¶ï¼Œå¦‚æœæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ thenApply() æ–¹æ³•æ¥æè¿°ä¸²è¡Œå…³ç³»ï¼Œè¿”å›çš„ç»“æœå°±ä¼šå‘ç”Ÿ CompletableFuture çš„åµŒå¥— 12CompletableFuture&lt;CompletableFuture&lt;Double&gt;&gt; result = completableFutureCompose.getUsersDetail(12345L) .thenApply(user -&gt; completableFutureCompose.getCreditRating(user)); æ˜¾ç„¶è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå¦‚æœæƒ³â€œæ‹å¹³â€ è¿”å›ç»“æœï¼ŒthenCompose æ–¹æ³•å°±æ´¾ä¸Šç”¨åœºäº† 12CompletableFuture&lt;Double&gt; result = completableFutureCompose.getUsersDetail(12345L) .thenCompose(user -&gt; completableFutureCompose.getCreditRating(user)); è¿™ä¸ªå’Œ Lambda çš„map å’Œ flatMap çš„é“ç†æ˜¯ä¸€æ ·ä¸€æ ·æ»´ thenCombineå¦‚æœè¦èšåˆä¸¤ä¸ªç‹¬ç«‹ Future çš„ç»“æœï¼Œé‚£ä¹ˆ thenCombine å°±ä¼šæ´¾ä¸Šç”¨åœºäº† 12345678910CompletableFuture&lt;Double&gt; weightFuture = CompletableFuture.supplyAsync(() -&gt; 65.0);CompletableFuture&lt;Double&gt; heightFuture = CompletableFuture.supplyAsync(() -&gt; 183.8);CompletableFuture&lt;Double&gt; combinedFuture = weightFuture .thenCombine(heightFuture, (weight, height) -&gt; &#123; Double heightInMeter = height/100; return weight/(heightInMeter*heightInMeter); &#125;);log.info(\"èº«ä½“BMIæŒ‡æ ‡ - \" + combinedFuture.get()); å½“ç„¶è¿™é‡Œå¤šæ•°æ—¶å¤„ç†ä¸¤ä¸ª Future çš„å…³ç³»ï¼Œå¦‚æœè¶…è¿‡ä¸¤ä¸ªFutureï¼Œå¦‚ä½•å¤„ç†ä»–ä»¬çš„ä¸€äº›èšåˆå…³ç³»å‘¢ï¼Ÿ allOf ï½œ anyOfç›¸ä¿¡ä½ çœ‹åˆ°æ–¹æ³•çš„ç­¾åï¼Œä½ å·²ç»æ˜ç™½ä»–çš„ç”¨å¤„äº†ï¼Œè¿™é‡Œå°±ä¸å†ä»‹ç»äº† 12static CompletableFuture&lt;Void&gt; allOf(CompletableFuture&lt;?&gt;... cfs)static CompletableFuture&lt;Object&gt; anyOf(CompletableFuture&lt;?&gt;... cfs) æ¥ä¸‹æ¥å°±æ˜¯å¼‚å¸¸çš„å¤„ç†äº† exceptionally1234567891011121314151617181920Integer age = -1;CompletableFuture&lt;String&gt; maturityFuture = CompletableFuture.supplyAsync(() -&gt; &#123; if( age &lt; 0 ) &#123; throw new IllegalArgumentException(\"ä½•æ–¹ç¥åœ£ï¼Ÿ\"); &#125; if(age &gt; 18) &#123; return \"å¤§å®¶éƒ½æ˜¯æˆå¹´äºº\"; &#125; else &#123; return \"æœªæˆå¹´ç¦æ­¢å…¥å†…\"; &#125;&#125;).thenApply((str) -&gt; &#123; log.info(\"æ¸¸æˆå¼€å§‹\"); return str;&#125;).exceptionally(ex -&gt; &#123; log.info(\"å¿…æœ‰è¹Šè··ï¼Œæ¥è€…\" + ex.getMessage()); return \"Unknown!\";&#125;);log.info(maturityFuture.get()); exceptionally å°±ç›¸å½“äº catchï¼Œå‡ºç°å¼‚å¸¸ï¼Œå°†ä¼šè·³è¿‡ thenApply çš„åç»­æ“ä½œï¼Œç›´æ¥æ•è·å¼‚å¸¸ï¼Œè¿›è¡Œä¸€åœºå¤„ç† handleç”¨å¤šçº¿ç¨‹ï¼Œè‰¯å¥½çš„ä¹ æƒ¯æ˜¯ä½¿ç”¨ try/finally èŒƒå¼ï¼Œhandle å°±å¯ä»¥èµ·åˆ° finally çš„ä½œç”¨ï¼Œå¯¹ä¸Šè¿°ç¨‹åºåšä¸€ä¸ªå°å°çš„æ›´æ”¹ï¼Œ handle æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯æ­£å¸¸è¿”å›å€¼ï¼Œä¸€ä¸ªæ˜¯å¼‚å¸¸ æ³¨æ„ï¼šhandleçš„å†™æ³•ä¹Ÿç®—æ˜¯èŒƒå¼çš„ä¸€ç§ 1234567891011121314151617181920212223Integer age = -1;CompletableFuture&lt;String&gt; maturityFuture = CompletableFuture.supplyAsync(() -&gt; &#123; if( age &lt; 0 ) &#123; throw new IllegalArgumentException(\"ä½•æ–¹ç¥åœ£ï¼Ÿ\"); &#125; if(age &gt; 18) &#123; return \"å¤§å®¶éƒ½æ˜¯æˆå¹´äºº\"; &#125; else &#123; return \"æœªæˆå¹´ç¦æ­¢å…¥å†…\"; &#125;&#125;).thenApply((str) -&gt; &#123; log.info(\"æ¸¸æˆå¼€å§‹\"); return str;&#125;).handle((res, ex) -&gt; &#123; if(ex != null) &#123; log.info(\"å¿…æœ‰è¹Šè··ï¼Œæ¥è€…\" + ex.getMessage()); return \"Unknown!\"; &#125; return res;&#125;);log.info(maturityFuture.get()); åˆ°è¿™é‡Œï¼Œå…³äº CompletableFuture çš„åŸºæœ¬ä½¿ç”¨ä½ å·²ç»äº†è§£çš„å·®ä¸å¤šäº†ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦æ³¨æ„ï¼Œæˆ‘ä»¬å‰é¢è¯´çš„å¸¦æœ‰ Sync çš„æ–¹æ³•æ˜¯å•ç‹¬èµ·ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰åˆ›å»ºçº¿ç¨‹ï¼Œè¿™æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ ç»†å¿ƒçš„æœ‹å‹å¦‚æœä»”ç»†çœ‹æ¯ä¸ªå˜ç§å‡½æ•°çš„ç¬¬ä¸‰ä¸ªæ–¹æ³•ä¹Ÿè®¸ä¼šå‘ç°é‡Œé¢éƒ½æœ‰ä¸€ä¸ª Executor ç±»å‹çš„å‚æ•°ï¼Œç”¨äºæŒ‡å®šçº¿ç¨‹æ± ï¼Œå› ä¸ºå®é™…ä¸šåŠ¡ä¸­æˆ‘ä»¬æ˜¯ä¸¥è°¨æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹çš„ï¼Œè¿™åœ¨ æˆ‘ä¼šæ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ?æ–‡ç« ä¸­æ˜ç¡®è¯´æ˜è¿‡ï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šçº¿ç¨‹æ± ï¼Œé‚£è‡ªç„¶å°±ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„çº¿ç¨‹æ± ï¼Œä¹Ÿå°±æ˜¯ ForkJoinPool 12private static final Executor ASYNC_POOL = USE_COMMON_POOL ? ForkJoinPool.commonPool() : new ThreadPerTaskExecutor(); ForkJoinPool çš„çº¿ç¨‹æ•°é»˜è®¤æ˜¯ CPU çš„æ ¸å¿ƒæ•°ã€‚ä½†æ˜¯ï¼Œåœ¨å‰åºæ–‡ç« ä¸­æ˜ç¡®è¯´æ˜è¿‡ï¼š ä¸è¦æ‰€æœ‰ä¸šåŠ¡å…±ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå› ä¸ºï¼Œä¸€æ—¦æœ‰ä»»åŠ¡æ‰§è¡Œä¸€äº›å¾ˆæ…¢çš„ I/O æ“ä½œï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½é˜»å¡åœ¨ I/O æ“ä½œä¸Šï¼Œä»è€Œé€ æˆçº¿ç¨‹é¥¥é¥¿ï¼Œè¿›è€Œå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ æ€»ç»“CompletableFuture çš„æ–¹æ³•å¹¶æ²¡æœ‰å…¨éƒ¨ä»‹ç»å®Œå…¨ï¼Œä¹Ÿæ²¡å¿…è¦å…¨éƒ¨ä»‹ç»ï¼Œç›¸ä¿¡å¤§å®¶æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥ç†è§£ CompletableFuture ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆå¤§é—®é¢˜äº†ï¼Œå‰©ä¸‹çš„å°±äº¤ç»™å®è·µ/æ—¶é—´ä»¥åŠè‡ªå·±çš„ä½“ä¼šäº† åè®°ä½ ä»¥ä¸º JDK1.8 CompletableFuture å·²ç»å¾ˆå®Œç¾äº†æ˜¯ä¸æ˜¯ï¼Œä½†è¿½å»å®Œç¾çš„é“è·¯ä¸Šæ°¸æ— æ­¢å¢ƒï¼ŒJava 9 å¯¹CompletableFuture åˆåšäº†éƒ¨åˆ†å‡çº§å’Œæ”¹é€  æ·»åŠ äº†æ–°çš„å·¥å‚æ–¹æ³• æ”¯æŒå»¶è¿Ÿå’Œè¶…æ—¶å¤„ç† 12orTimeout()completeOnTimeout() æ”¹è¿›äº†å¯¹å­ç±»çš„æ”¯æŒ è¯¦æƒ…å¯ä»¥æŸ¥çœ‹ï¼š Java 9 CompletableFuture API Improvements. æ€æ ·å¿«é€Ÿçš„åˆ‡æ¢ä¸åŒ Java ç‰ˆæœ¬æ¥å°é²œï¼ŸSDKMAN ç»Ÿä¸€çµæ´»ç®¡ç†å¤šç‰ˆæœ¬Java è¿™ç¯‡æ–‡ç« çš„æ–¹æ³•é€ç»™ä½  æœ€åå’±ä»¬å†æ³¡ä¸€å£¶èŒ¶ï¼Œæ„Ÿå—ä¸€ä¸‹æ–°å˜åŒ–å§ çµé­‚è¿½é—® å¬è¯´ ForkJoinPool çº¿ç¨‹æ± æ•ˆç‡æ›´é«˜ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ å¦‚æœæ‰¹é‡å¤„ç†å¼‚æ­¥ç¨‹åºï¼Œæœ‰ä»€ä¹ˆå¯ç”¨çš„æ–¹æ¡ˆå—ï¼Ÿ å‚è€ƒ Java å¹¶å‘ç¼–ç¨‹å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ Java å¹¶å‘ç¼–ç¨‹ä¹‹ç¾ https://www.baeldung.com/java-completablefuture https://www.callicoder.com/java-8-completablefuture-tutorial/","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"Java Futureè¯¦è§£ä¸ä½¿ç”¨","slug":"Java-Futureè¯¦è§£ä¸ä½¿ç”¨","date":"2020-07-07T00:00:28.000Z","updated":"2020-07-07T11:34:11.916Z","comments":true,"path":"/p/java-future-and-callable.html","link":"","permalink":"https://dayarch.top/p/java-future-and-callable.html","excerpt":"å‰è¨€ åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§æ–¹å¼ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆåº”è¯¥æ˜¯å¯ä»¥è„±å£è€Œå‡ºçš„å§ * ç»§æ‰¿ Thread ç±» * å®ç° Runnable æ¥å£ ä½†è¿™ä¸¤ç§æ–¹å¼åˆ›å»ºçš„çº¿ç¨‹æ˜¯å±äºâ€ä¸‰æ— äº§å“â€œï¼š * æ²¡æœ‰å‚æ•° * æ²¡æœ‰è¿”å›å€¼ * æ²¡åŠæ³•æŠ›å‡ºå¼‚å¸¸ 1 2 3 4 5 6 class MyThread implements Runnable{ @Override public void run() { log.info(\"my thread\"); } } Runnable æ¥å£æ˜¯ JDK1.0 çš„æ ¸å¿ƒäº§ç‰© 1 2 3 4 5 6 7 /** * @since","text":"å‰è¨€åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§æ–¹å¼ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆåº”è¯¥æ˜¯å¯ä»¥è„±å£è€Œå‡ºçš„å§ ç»§æ‰¿ Thread ç±» å®ç° Runnable æ¥å£ ä½†è¿™ä¸¤ç§æ–¹å¼åˆ›å»ºçš„çº¿ç¨‹æ˜¯å±äºâ€ä¸‰æ— äº§å“â€œï¼š æ²¡æœ‰å‚æ•° æ²¡æœ‰è¿”å›å€¼ æ²¡åŠæ³•æŠ›å‡ºå¼‚å¸¸ 123456class MyThread implements Runnable&#123; @Override public void run() &#123; log.info(\"my thread\"); &#125;&#125; Runnable æ¥å£æ˜¯ JDK1.0 çš„æ ¸å¿ƒäº§ç‰© 1234567 /** * @since JDK1.0 */@FunctionalInterfacepublic interface Runnable &#123; public abstract void run();&#125; ç”¨ç€ â€œä¸‰æ— äº§å“â€ æ€»æ˜¯æœ‰ä¸€äº›å¼Šç«¯ï¼Œå…¶ä¸­æ²¡åŠæ³•æ‹¿åˆ°è¿”å›å€¼æ˜¯æœ€è®©äººä¸èƒ½å¿çš„ï¼Œäºæ˜¯ Callable å°±è¯ç”Ÿäº† Callableåˆæ˜¯ Doug Lea å¤§å¸ˆï¼Œåˆæ˜¯ Java 1.5 è¿™ä¸ªç¥å¥‡çš„ç‰ˆæœ¬ 1234567891011 /** * @see Executor * @since 1.5 * @author Doug Lea * @param &lt;V&gt; the result type of method &#123;@code call&#125; */@FunctionalInterfacepublic interface Callable&lt;V&gt; &#123; V call() throws Exception;&#125; Callable æ˜¯ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œé‡Œé¢åªæœ‰ä¸€ä¸ª call() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥è¿”å›æ³›å‹å€¼ V ï¼Œä½¿ç”¨èµ·æ¥å°±åƒè¿™æ ·ï¼š 12345Callable&lt;String&gt; callable = () -&gt; &#123; // Perform some computation Thread.sleep(2000); return \"Return some result\";&#125;; äºŒè€…éƒ½æ˜¯å‡½æ•°å¼æ¥å£ï¼Œé‡Œé¢éƒ½ä»…æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œä½¿ç”¨ä¸Šåˆæ˜¯å¦‚æ­¤ç›¸ä¼¼ï¼Œé™¤äº†æœ‰æ— è¿”å›å€¼ï¼ŒRunnable ä¸ Callable å°±ç‚¹å·®åˆ«å—ï¼Ÿ Runnable VS Callableä¸¤ä¸ªæ¥å£éƒ½æ˜¯ç”¨äºå¤šçº¿ç¨‹æ‰§è¡Œä»»åŠ¡çš„ï¼Œä½†ä»–ä»¬è¿˜æ˜¯æœ‰å¾ˆæ˜æ˜¾çš„å·®åˆ«çš„ æ‰§è¡Œæœºåˆ¶å…ˆä»æ‰§è¡Œæœºåˆ¶ä¸Šæ¥çœ‹ï¼ŒRunnable ä½ å¤ªæ¸…æ¥šäº†ï¼Œå®ƒæ—¢å¯ä»¥ç”¨åœ¨ Thread ç±»ä¸­ï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨ ExecutorService ç±»ä¸­é…åˆçº¿ç¨‹æ± çš„ä½¿ç”¨ï¼›Buï½ï½ï½ï½tï¼Œ Callable åªèƒ½åœ¨ ExecutorService ä¸­ä½¿ç”¨ï¼Œä½ ç¿»é Thread ç±»ï¼Œä¹Ÿæ‰¾ä¸åˆ°Callable çš„èº«å½± å¼‚å¸¸å¤„ç†Runnable æ¥å£ä¸­çš„ run æ–¹æ³•ç­¾åä¸Šæ²¡æœ‰ throws ï¼Œè‡ªç„¶ä¹Ÿå°±æ²¡åŠæ³•å‘ä¸Šä¼ æ’­å—æ£€å¼‚å¸¸ï¼›è€Œ Callable çš„ call() æ–¹æ³•ç­¾åå´æœ‰ throwsï¼Œæ‰€ä»¥å®ƒå¯ä»¥å¤„ç†å—æ£€å¼‚å¸¸ï¼› æ‰€ä»¥å½’çº³èµ·æ¥çœ‹ä¸»è¦æœ‰è¿™å‡ å¤„ä¸åŒç‚¹ï¼š æ•´ä½“å·®åˆ«è™½ç„¶ä¸å¤§ï¼Œä½†æ˜¯è¿™ç‚¹å·®åˆ«ï¼Œå´å…·æœ‰é‡å¤§æ„ä¹‰ è¿”å›å€¼å’Œå¤„ç†å¼‚å¸¸å¾ˆå¥½ç†è§£ï¼Œå¦å¤–ï¼Œåœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¦ä½¿ç”¨çº¿ç¨‹æ± æ¥ç®¡ç†çº¿ç¨‹ï¼ˆåŸå› å·²ç»åœ¨ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ? ä¸­æ˜ç¡®è¯´æ˜ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ ExecutorService ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨äºŒè€…çš„ ExecutorServiceå…ˆæ¥çœ‹ä¸€ä¸‹ ExecutorService ç±»å›¾ æˆ‘å°†ä¸Šå›¾æ ‡è®°çš„æ–¹æ³•å•ç‹¬æ”¾åœ¨æ­¤å¤„ 12345void execute(Runnable command);&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task);&lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result);Future&lt;?&gt; submit(Runnable task); å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨ExecutorService çš„ execute() æ–¹æ³•ä¾æ—§å¾—ä¸åˆ°è¿”å›å€¼ï¼Œè€Œ submit() æ–¹æ³•æ¸…ä¸€è‰²çš„è¿”å› Future ç±»å‹çš„è¿”å›å€¼ ç»†å¿ƒçš„æœ‹å‹å¯èƒ½å·²ç»å‘ç°ï¼Œ submit() æ–¹æ³•å·²ç»åœ¨ CountDownLatch å’Œ CyclicBarrier å‚»å‚»çš„åˆ†ä¸æ¸…æ¥šï¼Ÿ æ–‡ç« ä¸­å¤šæ¬¡ä½¿ç”¨äº†ï¼Œåªä¸è¿‡æˆ‘ä»¬æ²¡æœ‰è·å–å…¶è¿”å›å€¼ç½¢äº†ï¼Œé‚£ä¹ˆ Future åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æ€ä¹ˆé€šè¿‡å®ƒè·å–è¿”å›å€¼å‘¢ï¼Ÿ æˆ‘ä»¬å¸¦ç€è¿™äº›ç–‘é—®ä¸€ç‚¹ç‚¹æ¥çœ‹ FutureFuture åˆæ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢åªæœ‰äº”ä¸ªæ–¹æ³•ï¼š ä»æ–¹æ³•åç§°ä¸Šç›¸ä¿¡ä½ å·²ç»èƒ½çœ‹å‡ºè¿™äº›æ–¹æ³•çš„ä½œç”¨ 1234567891011121314// å–æ¶ˆä»»åŠ¡boolean cancel(boolean mayInterruptIfRunning);// è·å–ä»»åŠ¡æ‰§è¡Œç»“æœV get() throws InterruptedException, ExecutionException;// è·å–ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œå¸¦æœ‰è¶…æ—¶æ—¶é—´é™åˆ¶V get(long timeout, TimeUnit unit) throws InterruptedException, ExecutionException, TimeoutException;// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»å–æ¶ˆboolean isCancelled();// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»ç»“æŸboolean isDone(); é“ºå«äº†è¿™ä¹ˆå¤šï¼Œçœ‹åˆ°è¿™ä½ ä¹Ÿè®¸æœ‰äº›ä¹±äº†ï¼Œå’±ä»¬èµ¶ç´§çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæ¼”ç¤ºä¸€ä¸‹å‡ ä¸ªæ–¹æ³•çš„ä½œç”¨ 12345678910111213141516171819202122232425262728@Slf4jpublic class FutureAndCallableExample &#123; public static void main(String[] args) throws InterruptedException, ExecutionException &#123; ExecutorService executorService = Executors.newSingleThreadExecutor(); // ä½¿ç”¨ Callable ï¼Œå¯ä»¥è·å–è¿”å›å€¼ Callable&lt;String&gt; callable = () -&gt; &#123; log.info(\"è¿›å…¥ Callable çš„ call æ–¹æ³•\"); // æ¨¡æ‹Ÿå­çº¿ç¨‹ä»»åŠ¡ï¼Œåœ¨æ­¤ç¡çœ  2sï¼Œ // å°ç»†èŠ‚ï¼šç”±äº call æ–¹æ³•ä¼šæŠ›å‡º Exceptionï¼Œè¿™é‡Œä¸ç”¨åƒä½¿ç”¨ Runnable çš„run æ–¹æ³•é‚£æ · try/catch äº† Thread.sleep(5000); return \"Hello from Callable\"; &#125;; log.info(\"æäº¤ Callable åˆ°çº¿ç¨‹æ± \"); Future&lt;String&gt; future = executorService.submit(callable); log.info(\"ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ\"); log.info(\"ä¸»çº¿ç¨‹ç­‰å¾…è·å– Future ç»“æœ\"); // Future.get() blocks until the result is available String result = future.get(); log.info(\"ä¸»çº¿ç¨‹è·å–åˆ° Future ç»“æœ: &#123;&#125;\", result); executorService.shutdown(); &#125;&#125; ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š å¦‚æœä½ è¿è¡Œä¸Šè¿°ç¤ºä¾‹ä»£ç ï¼Œä¸»çº¿ç¨‹è°ƒç”¨ future.get() æ–¹æ³•ä¼šé˜»å¡è‡ªå·±ï¼Œç›´åˆ°å­ä»»åŠ¡å®Œæˆã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Future æ–¹æ³•æä¾›çš„ isDone æ–¹æ³•ï¼Œå®ƒå¯ä»¥ç”¨æ¥æ£€æŸ¥ task æ˜¯å¦å·²ç»å®Œæˆäº†ï¼Œæˆ‘ä»¬å°†ä¸Šé¢ç¨‹åºåšç‚¹å°ä¿®æ”¹ï¼š 12345// å¦‚æœå­çº¿ç¨‹æ²¡æœ‰ç»“æŸï¼Œåˆ™ç¡çœ  1s é‡æ–°æ£€æŸ¥while(!future.isDone()) &#123; System.out.println(\"Task is still not done...\"); Thread.sleep(1000);&#125; æ¥çœ‹è¿è¡Œç»“æœï¼š å¦‚æœå­ç¨‹åºè¿è¡Œæ—¶é—´è¿‡é•¿ï¼Œæˆ–è€…å…¶ä»–åŸå› ï¼Œæˆ‘ä»¬æƒ³ cancel å­ç¨‹åºçš„è¿è¡Œï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Future æä¾›çš„ cancel æ–¹æ³•ï¼Œç»§ç»­å¯¹ç¨‹åºåšä¸€äº›ä¿®æ”¹ 1234567891011while(!future.isDone()) &#123; System.out.println(\"å­çº¿ç¨‹ä»»åŠ¡è¿˜æ²¡æœ‰ç»“æŸ...\"); Thread.sleep(1000); double elapsedTimeInSec = (System.nanoTime() - startTime)/1000000000.0; // å¦‚æœç¨‹åºè¿è¡Œæ—¶é—´å¤§äº 1sï¼Œåˆ™å–æ¶ˆå­çº¿ç¨‹çš„è¿è¡Œ if(elapsedTimeInSec &gt; 1) &#123; future.cancel(true); &#125;&#125; æ¥çœ‹è¿è¡Œç»“æœï¼š ä¸ºä»€ä¹ˆè°ƒç”¨ cancel æ–¹æ³•ç¨‹åºä¼šå‡ºç° CancellationException å‘¢ï¼Ÿ æ˜¯å› ä¸ºè°ƒç”¨ get() æ–¹æ³•æ—¶ï¼Œæ˜ç¡®è¯´æ˜äº†ï¼š è°ƒç”¨ get() æ–¹æ³•æ—¶ï¼Œå¦‚æœè®¡ç®—ç»“æœè¢«å–æ¶ˆäº†ï¼Œåˆ™æŠ›å‡º CancellationException ï¼ˆå…·ä½“åŸå› ï¼Œä½ ä¼šåœ¨ä¸‹é¢çš„æºç åˆ†æä¸­çœ‹åˆ°ï¼‰ æœ‰å¼‚å¸¸ä¸å¤„ç†æ˜¯éå¸¸ä¸ä¸“ä¸šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥ä¿®æ”¹ç¨‹åºï¼Œä»¥æ›´å‹å¥½çš„æ–¹å¼å¤„ç†å¼‚å¸¸ 12345678// é€šè¿‡ isCancelled æ–¹æ³•åˆ¤æ–­ç¨‹åºæ˜¯å¦è¢«å–æ¶ˆï¼Œå¦‚æœè¢«å–æ¶ˆï¼Œåˆ™æ‰“å°æ—¥å¿—ï¼Œå¦‚æœæ²¡è¢«å–æ¶ˆï¼Œåˆ™æ­£å¸¸è°ƒç”¨ get() æ–¹æ³•if (!future.isCancelled())&#123; log.info(\"å­çº¿ç¨‹ä»»åŠ¡å·²å®Œæˆ\"); String result = future.get(); log.info(\"ä¸»çº¿ç¨‹è·å–åˆ° Future ç»“æœ: &#123;&#125;\", result);&#125;else &#123; log.warn(\"å­çº¿ç¨‹ä»»åŠ¡è¢«å–æ¶ˆ\");&#125; æŸ¥çœ‹ç¨‹åºè¿è¡Œç»“æœï¼š ç›¸ä¿¡åˆ°è¿™é‡Œä½ å·²ç»å¯¹ Future çš„å‡ ä¸ªæ–¹æ³•æœ‰äº†åŸºæœ¬çš„ä½¿ç”¨å°è±¡ï¼Œä½† Future æ˜¯æ¥å£ï¼Œå…¶å®ä½¿ç”¨ ExecutorService.submit() æ–¹æ³•è¿”å›çš„ä¸€ç›´éƒ½æ˜¯ Future çš„å®ç°ç±» FutureTask æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¿›å…¥è¿™ä¸ªæ ¸å¿ƒå®ç°ç±»ä¸€æ¢ç©¶ç«Ÿ FutureTaskåŒæ ·å…ˆæ¥çœ‹ç±»ç»“æ„ 123public interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; &#123; void run();&#125; å¾ˆç¥å¥‡çš„ä¸€ä¸ªæ¥å£ï¼ŒFutureTask å®ç°äº† RunnableFuture æ¥å£ï¼Œè€Œ RunnableFuture æ¥å£åˆåˆ†åˆ«å®ç°äº† Runnable å’Œ Future æ¥å£ï¼Œæ‰€ä»¥å¯ä»¥æ¨æ–­å‡º FutureTask å…·æœ‰è¿™ä¸¤ç§æ¥å£çš„ç‰¹æ€§ï¼š æœ‰ Runnable ç‰¹æ€§ï¼Œæ‰€ä»¥å¯ä»¥ç”¨åœ¨ ExecutorService ä¸­é…åˆçº¿ç¨‹æ± ä½¿ç”¨ æœ‰ Future ç‰¹æ€§ï¼Œæ‰€ä»¥å¯ä»¥ä»ä¸­è·å–åˆ°æ‰§è¡Œç»“æœ FutureTaskæºç åˆ†æå¦‚æœä½ å®Œæ•´çš„çœ‹è¿‡ AQS ç›¸å…³åˆ†æçš„æ–‡ç« ï¼Œä½ ä¹Ÿè®¸ä¼šå‘ç°ï¼Œé˜…è¯» Java å¹¶å‘å·¥å…·ç±»æºç ï¼Œæˆ‘ä»¬æ— éå°±æ˜¯è¦å…³æ³¨ä»¥ä¸‹è¿™ä¸‰ç‚¹ï¼š - çŠ¶æ€ ï¼ˆä»£ç é€»è¾‘çš„ä¸»è¦æ§åˆ¶ï¼‰ - é˜Ÿåˆ— ï¼ˆç­‰å¾…æ’é˜Ÿé˜Ÿåˆ—ï¼‰ - CAS ï¼ˆå®‰å…¨çš„set å€¼ï¼‰ è„‘æµ·ä¸­ç‰¢è®°è¿™ä¸‰ç‚¹ï¼Œå’±ä»¬å¼€å§‹çœ‹ FutureTask æºç ï¼Œçœ‹ä¸€ä¸‹å®ƒæ˜¯å¦‚ä½•å›´ç»•è¿™ä¸‰ç‚¹å®ç°ç›¸åº”çš„é€»è¾‘çš„ æ–‡ç« å¼€å¤´å·²ç»æåˆ°ï¼Œå®ç° Runnable æ¥å£å½¢å¼åˆ›å»ºçš„çº¿ç¨‹å¹¶ä¸èƒ½è·å–åˆ°è¿”å›å€¼ï¼Œè€Œå®ç° Callable çš„æ‰å¯ä»¥ï¼Œæ‰€ä»¥ FutureTask æƒ³è¦è·å–è¿”å›å€¼ï¼Œå¿…å®šæ˜¯å’Œ Callable æœ‰è”ç³»çš„ï¼Œè¿™ä¸ªæ¨æ–­ä¸€ç‚¹éƒ½æ²¡é”™ï¼Œä»æ„é€ æ–¹æ³•ä¸­å°±å¯ä»¥çœ‹å‡ºæ¥ï¼š 123456public FutureTask(Callable&lt;V&gt; callable) &#123; if (callable == null) throw new NullPointerException(); this.callable = callable; this.state = NEW; // ensure visibility of callable&#125; å³ä¾¿åœ¨ FutureTask æ„é€ æ–¹æ³•ä¸­ä¼ å…¥çš„æ˜¯ Runnable å½¢å¼çš„çº¿ç¨‹ï¼Œè¯¥æ„é€ æ–¹æ³•ä¹Ÿä¼šé€šè¿‡ Executors.callable å·¥å‚æ–¹æ³•å°†å…¶è½¬æ¢ä¸º Callable ç±»å‹ï¼š 1234public FutureTask(Runnable runnable, V result) &#123; this.callable = Executors.callable(runnable, result); this.state = NEW; // ensure visibility of callable&#125; ä½†æ˜¯ FutureTask å®ç°çš„æ˜¯ Runnable æ¥å£ï¼Œä¹Ÿå°±æ˜¯åªèƒ½é‡å†™ run() æ–¹æ³•ï¼Œrun() æ–¹æ³•åˆæ²¡æœ‰è¿”å›å€¼ï¼Œé‚£é—®é¢˜æ¥äº†ï¼š FutureTask æ˜¯æ€æ ·åœ¨ run() æ–¹æ³•ä¸­è·å–è¿”å›å€¼çš„ï¼Ÿ å®ƒå°†è¿”å›å€¼æ”¾åˆ°å“ªé‡Œäº†ï¼Ÿ get() æ–¹æ³•åˆæ˜¯æ€æ ·æ‹¿åˆ°è¿™ä¸ªè¿”å›å€¼çš„å‘¢ï¼Ÿ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ run() æ–¹æ³•ï¼ˆå…³é”®ä»£ç éƒ½å·²æ ‡è®°æ³¨é‡Šï¼‰ 1234567891011121314151617181920212223242526272829303132333435public void run() &#123; // å¦‚æœçŠ¶æ€ä¸æ˜¯ NEWï¼Œè¯´æ˜ä»»åŠ¡å·²ç»æ‰§è¡Œè¿‡æˆ–è€…å·²ç»è¢«å–æ¶ˆï¼Œç›´æ¥è¿”å› // å¦‚æœçŠ¶æ€æ˜¯ NEWï¼Œåˆ™å°è¯•æŠŠæ‰§è¡Œçº¿ç¨‹ä¿å­˜åœ¨ runnerOffsetï¼ˆrunnerå­—æ®µï¼‰ï¼Œå¦‚æœèµ‹å€¼å¤±è´¥ï¼Œåˆ™ç›´æ¥è¿”å› if (state != NEW || !UNSAFE.compareAndSwapObject(this, runnerOffset, null, Thread.currentThread())) return; try &#123; // è·å–æ„é€ å‡½æ•°ä¼ å…¥çš„ Callable å€¼ Callable&lt;V&gt; c = callable; if (c != null &amp;&amp; state == NEW) &#123; V result; boolean ran; try &#123; // æ­£å¸¸è°ƒç”¨ Callable çš„ call æ–¹æ³•å°±å¯ä»¥è·å–åˆ°è¿”å›å€¼ result = c.call(); ran = true; &#125; catch (Throwable ex) &#123; result = null; ran = false; // ä¿å­˜ call æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ setException(ex); &#125; if (ran) // ä¿å­˜ call æ–¹æ³•çš„æ‰§è¡Œç»“æœ set(result); &#125; &#125; finally &#123; runner = null; int s = state; // å¦‚æœä»»åŠ¡è¢«ä¸­æ–­ï¼Œåˆ™æ‰§è¡Œä¸­æ–­å¤„ç† if (s &gt;= INTERRUPTING) handlePossibleCancellationInterrupt(s); &#125;&#125; run() æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œè‡³äº run() æ–¹æ³•æ˜¯å¦‚ä½•å°† call() æ–¹æ³•çš„è¿”å›ç»“æœå’Œå¼‚å¸¸éƒ½ä¿å­˜èµ·æ¥çš„å‘¢ï¼Ÿå…¶å®éå¸¸ç®€å•, å°±æ˜¯é€šè¿‡ set(result) ä¿å­˜æ­£å¸¸ç¨‹åºè¿è¡Œç»“æœï¼Œæˆ–é€šè¿‡ setException(ex) ä¿å­˜ç¨‹åºå¼‚å¸¸ä¿¡æ¯ 1234567891011121314151617181920/** The result to return or exception to throw from get() */private Object outcome; // non-volatile, protected by state reads/writes// ä¿å­˜å¼‚å¸¸ç»“æœprotected void setException(Throwable t) &#123; if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) &#123; outcome = t; UNSAFE.putOrderedInt(this, stateOffset, EXCEPTIONAL); // final state finishCompletion(); &#125;&#125;// ä¿å­˜æ­£å¸¸ç»“æœprotected void set(V v) &#123; if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) &#123; outcome = v; UNSAFE.putOrderedInt(this, stateOffset, NORMAL); // final state finishCompletion(); &#125;&#125; setException å’Œ set æ–¹æ³•éå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯å°†å¼‚å¸¸æˆ–è€…ç»“æœä¿å­˜åœ¨ Object ç±»å‹çš„ outcome å˜é‡ä¸­ï¼Œoutcome æ˜¯æˆå‘˜å˜é‡ï¼Œå°±è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥ä»–ä»¬è¦é€šè¿‡ CASæ–¹å¼è®¾ç½® outcome å˜é‡çš„å€¼ï¼Œæ—¢ç„¶æ˜¯åœ¨ CAS æˆåŠŸå æ›´æ”¹ outcome çš„å€¼ï¼Œè¿™ä¹Ÿå°±æ˜¯ outcome æ²¡æœ‰è¢« volatile ä¿®é¥°çš„åŸå› æ‰€åœ¨ã€‚ ä¿å­˜æ­£å¸¸ç»“æœå€¼ï¼ˆsetæ–¹æ³•ï¼‰ä¸ä¿å­˜å¼‚å¸¸ç»“æœå€¼ï¼ˆsetExceptionæ–¹æ³•ï¼‰ä¸¤ä¸ªæ–¹æ³•ä»£ç é€»è¾‘ï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯ CAS ä¼ å…¥çš„ state ä¸åŒã€‚æˆ‘ä»¬ä¸Šé¢æåˆ°ï¼Œstate å¤šæ•°ç”¨äºæ§åˆ¶ä»£ç é€»è¾‘ï¼ŒFutureTask ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ‰€ä»¥è¦ææ¸…ä»£ç é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹ state çš„çŠ¶æ€å˜åŒ–æœ‰æ‰€äº†è§£ 12345678910111213141516 /* * * Possible state transitions: * NEW -&gt; COMPLETING -&gt; NORMAL //æ‰§è¡Œè¿‡ç¨‹é¡ºåˆ©å®Œæˆ * NEW -&gt; COMPLETING -&gt; EXCEPTIONAL //æ‰§è¡Œè¿‡ç¨‹å‡ºç°å¼‚å¸¸ * NEW -&gt; CANCELLED // æ‰§è¡Œè¿‡ç¨‹ä¸­è¢«å–æ¶ˆ * NEW -&gt; INTERRUPTING -&gt; INTERRUPTED //æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹è¢«ä¸­æ–­ */private volatile int state;private static final int NEW = 0;private static final int COMPLETING = 1;private static final int NORMAL = 2;private static final int EXCEPTIONAL = 3;private static final int CANCELLED = 4;private static final int INTERRUPTING = 5;private static final int INTERRUPTED = 6; 7ç§çŠ¶æ€ï¼Œåƒä¸‡åˆ«æ…Œï¼Œæ•´ä¸ªçŠ¶æ€æµè½¬å…¶å®åªæœ‰å››ç§çº¿è·¯ FutureTask å¯¹è±¡è¢«åˆ›å»ºå‡ºæ¥ï¼Œstate çš„çŠ¶æ€å°±æ˜¯ NEW çŠ¶æ€ï¼Œä»ä¸Šé¢çš„æ„é€ å‡½æ•°ä¸­ä½ åº”è¯¥å·²ç»å‘ç°äº†ï¼Œå››ä¸ªæœ€ç»ˆçŠ¶æ€ NORMAL ï¼ŒEXCEPTIONAL ï¼Œ CANCELLED ï¼Œ INTERRUPTED ä¹Ÿéƒ½å¾ˆå¥½ç†è§£ï¼Œä¸¤ä¸ªä¸­é—´çŠ¶æ€ç¨ç¨æœ‰ç‚¹è®©äººå›°æƒ‘: COMPLETING: outcome æ­£åœ¨è¢«set å€¼çš„æ—¶å€™ INTERRUPTINGï¼šé€šè¿‡ cancel(true) æ–¹æ³•æ­£åœ¨ä¸­æ–­çº¿ç¨‹çš„æ—¶å€™ æ€»çš„æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªä¸­é—´çŠ¶æ€éƒ½è¡¨ç¤ºä¸€ç§ç¬æ—¶çŠ¶æ€ï¼Œæˆ‘ä»¬å°†å‡ ç§çŠ¶æ€å›¾å½¢åŒ–å±•ç¤ºä¸€ä¸‹ï¼š æˆ‘ä»¬çŸ¥é“äº† run() æ–¹æ³•æ˜¯å¦‚ä½•ä¿å­˜ç»“æœçš„ï¼Œä»¥åŠçŸ¥é“äº†å°†æ­£å¸¸ç»“æœ/å¼‚å¸¸ç»“æœä¿å­˜åˆ°äº† outcome å˜é‡é‡Œï¼Œé‚£å°±éœ€è¦çœ‹ä¸€ä¸‹ FutureTask æ˜¯å¦‚ä½•é€šè¿‡ get() æ–¹æ³•è·å–ç»“æœçš„ï¼š 12345678public V get() throws InterruptedException, ExecutionException &#123; int s = state; // å¦‚æœ state è¿˜æ²¡åˆ° set outcome ç»“æœçš„æ—¶å€™ï¼Œåˆ™è°ƒç”¨ awaitDone() æ–¹æ³•é˜»å¡è‡ªå·± if (s &lt;= COMPLETING) s = awaitDone(false, 0L); // è¿”å›ç»“æœ return report(s);&#125; awaitDone æ–¹æ³•æ˜¯ FutureTask æœ€æ ¸å¿ƒçš„ä¸€ä¸ªæ–¹æ³• 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// get æ–¹æ³•æ”¯æŒè¶…æ—¶é™åˆ¶ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥è¶…æ—¶æ—¶é—´ï¼Œåˆ™æ¥å—çš„å‚æ•°æ˜¯ false å’Œ 0L// æœ‰ç­‰å¾…å°±ä¼šæœ‰é˜Ÿåˆ—æ’é˜Ÿæˆ–è€…å¯å“åº”ä¸­æ–­ï¼Œä»æ–¹æ³•ç­¾åä¸Šçœ‹æœ‰ InterruptedExceptionï¼Œè¯´æ˜è¯¥æ–¹æ³•è¿™æ˜¯å¯ä»¥è¢«ä¸­æ–­çš„private int awaitDone(boolean timed, long nanos) throws InterruptedException &#123; // è®¡ç®—ç­‰å¾…æˆªæ­¢æ—¶é—´ final long deadline = timed ? System.nanoTime() + nanos : 0L; WaitNode q = null; boolean queued = false; for (;;) &#123; // å¦‚æœå½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™åœ¨ç­‰å¾…å¯¹ç«‹ä¸­åˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œå¹¶æŠ›å‡º InterruptedException if (Thread.interrupted()) &#123; removeWaiter(q); throw new InterruptedException(); &#125; int s = state; // çŠ¶æ€å¤§äº COMPLETING è¯´æ˜å·²ç»è¾¾åˆ°æŸä¸ªæœ€ç»ˆçŠ¶æ€ï¼ˆæ­£å¸¸ç»“æŸ/å¼‚å¸¸ç»“æŸ/å–æ¶ˆï¼‰ // æŠŠ thread åªä¸ºç©ºï¼Œå¹¶è¿”å›ç»“æœ if (s &gt; COMPLETING) &#123; if (q != null) q.thread = null; return s; &#125; // å¦‚æœæ˜¯COMPLETING çŠ¶æ€ï¼ˆä¸­é—´çŠ¶æ€ï¼‰ï¼Œè¡¨ç¤ºä»»åŠ¡å·²ç»“æŸï¼Œä½† outcome èµ‹å€¼è¿˜æ²¡ç»“æŸï¼Œè¿™æ—¶ä¸»åŠ¨è®©å‡ºæ‰§è¡Œæƒï¼Œè®©å…¶ä»–çº¿ç¨‹ä¼˜å…ˆæ‰§è¡Œï¼ˆåªæ˜¯å‘å‡ºè¿™ä¸ªä¿¡å·ï¼Œè‡³äºæ˜¯å¦åˆ«çš„çº¿ç¨‹æ‰§è¡Œä¸€å®šä¼šæ‰§è¡Œå¯æ˜¯ä¸ä¸€å®šçš„ï¼‰ else if (s == COMPLETING) // cannot time out yet Thread.yield(); // ç­‰å¾…èŠ‚ç‚¹ä¸ºç©º else if (q == null) // å°†å½“å‰çº¿ç¨‹æ„é€ èŠ‚ç‚¹ q = new WaitNode(); // å¦‚æœè¿˜æ²¡æœ‰å…¥é˜Ÿåˆ—ï¼Œåˆ™æŠŠå½“å‰èŠ‚ç‚¹åŠ å…¥waitersé¦–èŠ‚ç‚¹å¹¶æ›¿æ¢åŸæ¥waiters else if (!queued) queued = UNSAFE.compareAndSwapObject(this, waitersOffset, q.next = waiters, q); // å¦‚æœè®¾ç½®è¶…æ—¶æ—¶é—´ else if (timed) &#123; nanos = deadline - System.nanoTime(); // æ—¶é—´åˆ°ï¼Œåˆ™ä¸å†ç­‰å¾…ç»“æœ if (nanos &lt;= 0L) &#123; removeWaiter(q); return state; &#125; // é˜»å¡ç­‰å¾…ç‰¹å®šæ—¶é—´ LockSupport.parkNanos(this, nanos); &#125; else // æŒ‚èµ·å½“å‰çº¿ç¨‹ï¼ŒçŸ¥é“è¢«å…¶ä»–çº¿ç¨‹å”¤é†’ LockSupport.park(this); &#125;&#125; æ€»çš„æ¥è¯´ï¼Œè¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼Œé€šå¸¸ä¼šç»å†ä¸‰è½®å¾ªç¯ ç¬¬ä¸€è½®forå¾ªç¯ï¼Œæ‰§è¡Œçš„é€»è¾‘æ˜¯ q == null, è¿™æ—¶å€™ä¼šæ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ q, ç¬¬ä¸€è½®å¾ªç¯ç»“æŸã€‚ ç¬¬äºŒè½®forå¾ªç¯ï¼Œæ‰§è¡Œçš„é€»è¾‘æ˜¯ !queueï¼Œè¿™ä¸ªæ—¶å€™ä¼šæŠŠç¬¬ä¸€è½®å¾ªç¯ä¸­ç”Ÿæˆçš„èŠ‚ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘waitersï¼Œç„¶åCASçš„æŠŠèŠ‚ç‚¹q æ›¿æ¢waiters, ä¹Ÿå°±æ˜¯æŠŠæ–°ç”Ÿæˆçš„èŠ‚ç‚¹æ·»åŠ åˆ°waiters ä¸­çš„é¦–èŠ‚ç‚¹ã€‚å¦‚æœæ›¿æ¢æˆåŠŸï¼Œqueued=trueã€‚ç¬¬äºŒè½®å¾ªç¯ç»“æŸã€‚ ç¬¬ä¸‰è½®forå¾ªç¯ï¼Œè¿›è¡Œé˜»å¡ç­‰å¾…ã€‚è¦ä¹ˆé˜»å¡ç‰¹å®šæ—¶é—´ï¼Œè¦ä¹ˆä¸€ç›´é˜»å¡çŸ¥é“è¢«å…¶ä»–çº¿ç¨‹å”¤é†’ã€‚ å¯¹äºç¬¬äºŒè½®å¾ªç¯ï¼Œå¤§å®¶å¯èƒ½ç¨ç¨æœ‰ç‚¹è¿·ç³Šï¼Œæˆ‘ä»¬å‰é¢è¯´è¿‡ï¼Œæœ‰é˜»å¡ï¼Œå°±ä¼šæ’é˜Ÿï¼Œæœ‰æ’é˜Ÿè‡ªç„¶å°±æœ‰é˜Ÿåˆ—ï¼ŒFutureTask å†…éƒ¨åŒæ ·ç»´æŠ¤äº†ä¸€ä¸ªé˜Ÿåˆ— 12/** Treiber stack of waiting threads */private volatile WaitNode waiters; è¯´æ˜¯ç­‰å¾…é˜Ÿåˆ—ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ª Treiber ç±»å‹ stackï¼Œæ—¢ç„¶æ˜¯ stackï¼Œ é‚£å°±åƒæ‰‹æªçš„å¼¹å¤¹ä¸€æ ·ï¼ˆè„‘è¡¥ä¸€ä¸‹å­å¼¹æ”¾å…¥å¼¹å¤¹çš„æƒ…å½¢ï¼‰ï¼Œåè¿›å…ˆå‡ºï¼Œæ‰€ä»¥åˆšåˆšè¯´çš„ç¬¬äºŒè½®å¾ªç¯ï¼Œä¼šæŠŠæ–°ç”Ÿæˆçš„èŠ‚ç‚¹æ·»åŠ åˆ° waiters stack çš„é¦–èŠ‚ç‚¹ å¦‚æœç¨‹åºè¿è¡Œæ­£å¸¸ï¼Œé€šå¸¸è°ƒç”¨ get() æ–¹æ³•ï¼Œä¼šå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œé‚£è°æ¥å”¤é†’å‘¢ï¼Ÿè‡ªç„¶æ˜¯ run() æ–¹æ³•è¿è¡Œå®Œä¼šå”¤é†’ï¼Œè®¾ç½®è¿”å›ç»“æœï¼ˆsetæ–¹æ³•ï¼‰/å¼‚å¸¸çš„æ–¹æ³•(setExceptionæ–¹æ³•) ä¸¤ä¸ªæ–¹æ³•ä¸­éƒ½ä¼šè°ƒç”¨ finishCompletion æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°±ä¼šå”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ 12345678910111213141516171819202122232425private void finishCompletion() &#123; // assert state &gt; COMPLETING; for (WaitNode q; (q = waiters) != null;) &#123; if (UNSAFE.compareAndSwapObject(this, waitersOffset, q, null)) &#123; for (;;) &#123; Thread t = q.thread; if (t != null) &#123; q.thread = null; // å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ LockSupport.unpark(t); &#125; WaitNode next = q.next; if (next == null) break; q.next = null; // unlink to help gc q = next; &#125; break; &#125; &#125; done(); callable = null; // to reduce footprint&#125; å°†ä¸€ä¸ªä»»åŠ¡çš„çŠ¶æ€è®¾ç½®æˆç»ˆæ­¢æ€åªæœ‰ä¸‰ç§æ–¹æ³•ï¼š set setException cancel å‰ä¸¤ç§æ–¹æ³•å·²ç»åˆ†æå®Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±çœ‹ä¸€ä¸‹ cancel æ–¹æ³• æŸ¥çœ‹ Future cancel()ï¼Œè¯¥æ–¹æ³•æ³¨é‡Šä¸Šæ˜ç¡®è¯´æ˜ä¸‰ç§ cancel æ“ä½œä¸€å®šå¤±è´¥çš„æƒ…å½¢ ä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæˆäº† ä»»åŠ¡å·²ç»è¢«å–æ¶ˆè¿‡äº† ä»»åŠ¡å› ä¸ºæŸç§åŸå› ä¸èƒ½è¢«å–æ¶ˆ å…¶å®ƒæƒ…å†µä¸‹ï¼Œcancelæ“ä½œå°†è¿”å›trueã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œcancelæ“ä½œè¿”å› true å¹¶ä¸ä»£è¡¨ä»»åŠ¡çœŸçš„å°±æ˜¯è¢«å–æ¶ˆ, è¿™å–å†³äºå‘åŠ¨cancelçŠ¶æ€æ—¶ï¼Œä»»åŠ¡æ‰€å¤„çš„çŠ¶æ€ å¦‚æœå‘èµ·cancelæ—¶ä»»åŠ¡è¿˜æ²¡æœ‰å¼€å§‹è¿è¡Œï¼Œåˆ™éšåä»»åŠ¡å°±ä¸ä¼šè¢«æ‰§è¡Œï¼› å¦‚æœå‘èµ·cancelæ—¶ä»»åŠ¡å·²ç»åœ¨è¿è¡Œäº†ï¼Œåˆ™è¿™æ—¶å°±éœ€è¦çœ‹ mayInterruptIfRunning å‚æ•°äº†ï¼š å¦‚æœmayInterruptIfRunning ä¸ºtrue, åˆ™å½“å‰åœ¨æ‰§è¡Œçš„ä»»åŠ¡ä¼šè¢«ä¸­æ–­ å¦‚æœmayInterruptIfRunning ä¸ºfalse, åˆ™å¯ä»¥å…è®¸æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ç»§ç»­è¿è¡Œï¼Œç›´åˆ°å®ƒæ‰§è¡Œå®Œ æœ‰äº†è¿™äº›é“ºå«ï¼Œçœ‹ä¸€ä¸‹ cancel ä»£ç çš„é€»è¾‘å°±ç§’æ‡‚äº† 12345678910111213141516171819202122232425public boolean cancel(boolean mayInterruptIfRunning) &#123; if (!(state == NEW &amp;&amp; UNSAFE.compareAndSwapInt(this, stateOffset, NEW, mayInterruptIfRunning ? INTERRUPTING : CANCELLED))) return false; try &#123; // in case call to interrupt throws exception // éœ€è¦ä¸­æ–­ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹ if (mayInterruptIfRunning) &#123; try &#123; Thread t = runner; // ä¸­æ–­çº¿ç¨‹ if (t != null) t.interrupt(); &#125; finally &#123; // final state // ä¿®æ”¹ä¸ºæœ€ç»ˆçŠ¶æ€ INTERRUPTED UNSAFE.putOrderedInt(this, stateOffset, INTERRUPTED); &#125; &#125; &#125; finally &#123; // å”¤é†’ç­‰å¾…ä¸­çš„çº¿ç¨‹ finishCompletion(); &#125; return true;&#125; æ ¸å¿ƒæ–¹æ³•ç»ˆäºåˆ†æå®Œäº†ï¼Œåˆ°è¿™å’±ä»¬å–å£èŒ¶ä¼‘æ¯ä¸€ä¸‹å§ æˆ‘æ˜¯æƒ³è¯´ï¼Œä½¿ç”¨ FutureTask æ¥æ¼”ç»ƒçƒ§æ°´æ³¡èŒ¶ç»å…¸ç¨‹åº å¦‚ä¸Šå›¾ï¼š æ´—æ°´å£¶ 1 åˆ†é’Ÿ çƒ§å¼€æ°´ 15 åˆ†é’Ÿ æ´—èŒ¶å£¶ 1 åˆ†é’Ÿ æ´—èŒ¶æ¯ 1 åˆ†é’Ÿ æ‹¿èŒ¶å¶ 2 åˆ†é’Ÿ æœ€ç»ˆæ³¡èŒ¶ è®©æˆ‘å¿ƒç®—ä¸€ä¸‹ï¼Œå¦‚æœä¸²è¡Œæ€»å…±éœ€è¦ 20 åˆ†é’Ÿï¼Œä½†å¾ˆæ˜¾ç„¶åœ¨çƒ§å¼€æ°´æœŸé—´ï¼Œæˆ‘ä»¬å¯ä»¥æ´—èŒ¶å£¶/æ´—èŒ¶æ¯/æ‹¿èŒ¶å¶ è¿™æ ·æ€»å…±éœ€è¦ 16 åˆ†é’Ÿï¼ŒèŠ‚çº¦äº† 4åˆ†é’Ÿæ—¶é—´ï¼Œçƒ§æ°´æ³¡èŒ¶å°šä¸”å¦‚æ­¤ï¼Œåœ¨ç°åœ¨é«˜å¹¶å‘çš„æ—¶ä»£ï¼Œ4åˆ†é’Ÿå¯ä»¥åšçš„äº‹å¤ªå¤šäº†ï¼Œå­¦ä¼šä½¿ç”¨ Future ä¼˜åŒ–ç¨‹åºæ˜¯å¿…ç„¶ï¼ˆå…¶å®ä¼˜åŒ–ç¨‹åºå°±æ˜¯å¯»æ‰¾å…³é”®è·¯å¾„ï¼Œå…³é”®è·¯å¾„æ‰¾åˆ°äº†ï¼Œéå…³é”®è·¯å¾„çš„ä»»åŠ¡é€šå¸¸å°±å¯ä»¥å’Œå…³é”®è·¯å¾„çš„å†…å®¹å¹¶è¡Œæ‰§è¡Œäº†ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@Slf4jpublic class MakeTeaExample &#123; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; ExecutorService executorService = Executors.newFixedThreadPool(2); // åˆ›å»ºçº¿ç¨‹1çš„FutureTask FutureTask&lt;String&gt; ft1 = new FutureTask&lt;String&gt;(new T1Task()); // åˆ›å»ºçº¿ç¨‹2çš„FutureTask FutureTask&lt;String&gt; ft2 = new FutureTask&lt;String&gt;(new T2Task()); executorService.submit(ft1); executorService.submit(ft2); log.info(ft1.get() + ft2.get()); log.info(\"å¼€å§‹æ³¡èŒ¶\"); executorService.shutdown(); &#125; static class T1Task implements Callable&lt;String&gt; &#123; @Override public String call() throws Exception &#123; log.info(\"T1:æ´—æ°´å£¶...\"); TimeUnit.SECONDS.sleep(1); log.info(\"T1:çƒ§å¼€æ°´...\"); TimeUnit.SECONDS.sleep(15); return \"T1:å¼€æ°´å·²å¤‡å¥½\"; &#125; &#125; static class T2Task implements Callable&lt;String&gt; &#123; @Override public String call() throws Exception &#123; log.info(\"T2:æ´—èŒ¶å£¶...\"); TimeUnit.SECONDS.sleep(1); log.info(\"T2:æ´—èŒ¶æ¯...\"); TimeUnit.SECONDS.sleep(2); log.info(\"T2:æ‹¿èŒ¶å¶...\"); TimeUnit.SECONDS.sleep(1); return \"T2:ç¦é¼ç™½èŒ¶æ‹¿åˆ°äº†\"; &#125; &#125;&#125; ä¸Šé¢çš„ç¨‹åºæ˜¯ä¸»çº¿ç¨‹ç­‰å¾…ä¸¤ä¸ª FutureTask çš„æ‰§è¡Œç»“æœï¼Œçº¿ç¨‹1 çƒ§å¼€æ°´æ—¶é—´æ›´é•¿ï¼Œçº¿ç¨‹1å¸Œæœ›åœ¨æ°´çƒ§å¼€çš„é‚£ä¸€åˆ¹é‚£å°±å¯ä»¥æ‹¿åˆ°èŒ¶å¶ç›´æ¥æ³¡èŒ¶ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ é‚£åªéœ€è¦åœ¨çº¿ç¨‹ 1 çš„FutureTask ä¸­è·å– çº¿ç¨‹ 2 FutureTask çš„è¿”å›ç»“æœå°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬ç¨ç¨ä¿®æ”¹ä¸€ä¸‹ç¨‹åºï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253@Slf4jpublic class MakeTeaExample1 &#123; public static void main(String[] args) throws ExecutionException, InterruptedException &#123; ExecutorService executorService = Executors.newFixedThreadPool(2); // åˆ›å»ºçº¿ç¨‹2çš„FutureTask FutureTask&lt;String&gt; ft2 = new FutureTask&lt;String&gt;(new T2Task()); // åˆ›å»ºçº¿ç¨‹1çš„FutureTask FutureTask&lt;String&gt; ft1 = new FutureTask&lt;String&gt;(new T1Task(ft2)); executorService.submit(ft1); executorService.submit(ft2); executorService.shutdown(); &#125; static class T1Task implements Callable&lt;String&gt; &#123; private FutureTask&lt;String&gt; ft2; public T1Task(FutureTask&lt;String&gt; ft2) &#123; this.ft2 = ft2; &#125; @Override public String call() throws Exception &#123; log.info(\"T1:æ´—æ°´å£¶...\"); TimeUnit.SECONDS.sleep(1); log.info(\"T1:çƒ§å¼€æ°´...\"); TimeUnit.SECONDS.sleep(15); String t2Result = ft2.get(); log.info(\"T1 æ‹¿åˆ°T2çš„ &#123;&#125;ï¼Œ å¼€å§‹æ³¡èŒ¶\", t2Result); return \"T1: ä¸ŠèŒ¶ï¼ï¼ï¼\"; &#125; &#125; static class T2Task implements Callable&lt;String&gt; &#123; @Override public String call() throws Exception &#123; log.info(\"T2:æ´—èŒ¶å£¶...\"); TimeUnit.SECONDS.sleep(1); log.info(\"T2:æ´—èŒ¶æ¯...\"); TimeUnit.SECONDS.sleep(2); log.info(\"T2:æ‹¿èŒ¶å¶...\"); TimeUnit.SECONDS.sleep(1); return \"ç¦é¼ç™½èŒ¶\"; &#125; &#125;&#125; æ¥çœ‹ç¨‹åºè¿è¡Œç»“æœï¼š çŸ¥é“è¿™ä¸ªå˜åŒ–åæˆ‘ä»¬å†å›å¤´çœ‹ ExecutorService çš„ä¸‰ä¸ª submit æ–¹æ³•ï¼š 123&lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result);Future&lt;?&gt; submit(Runnable task);&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task); ç¬¬ä¸€ç§æ–¹æ³•ï¼Œé€å±‚ä»£ç æŸ¥çœ‹åˆ°è¿™é‡Œï¼š ä½ ä¼šå‘ç°ï¼Œå’Œæˆ‘ä»¬æ”¹é€ çƒ§æ°´æ³¡èŒ¶çš„ç¨‹åºæ€ç»´æ˜¯ç›¸ä¼¼çš„ï¼Œå¯ä»¥ä¼ è¿›å»ä¸€ä¸ª resultï¼Œresult ç›¸å½“äºä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹ä¹‹é—´çš„æ¡¥æ¢ï¼Œé€šè¿‡å®ƒä¸»å­çº¿ç¨‹å¯ä»¥å…±äº«æ•°æ® ç¬¬äºŒä¸ªæ–¹æ³•å‚æ•°æ˜¯ Runnable ç±»å‹å‚æ•°ï¼Œå³ä¾¿è°ƒç”¨ get() æ–¹æ³•ä¹Ÿæ˜¯è¿”å› nullï¼Œæ‰€ä»¥ä»…æ˜¯å¯ä»¥ç”¨æ¥æ–­è¨€ä»»åŠ¡å·²ç»ç»“æŸäº†ï¼Œç±»ä¼¼ Thread.join() ç¬¬ä¸‰ä¸ªæ–¹æ³•å‚æ•°æ˜¯ Callable ç±»å‹å‚æ•°ï¼Œé€šè¿‡get() æ–¹æ³•å¯ä»¥æ˜ç¡®è·å– call() æ–¹æ³•çš„è¿”å›å€¼ åˆ°è¿™é‡Œï¼Œå…³äº Future çš„æ•´å—è®²è§£å°±ç»“æŸäº†ï¼Œè¿˜æ˜¯éœ€è¦ç®€å•æ¶ˆåŒ–ä¸€ä¸‹çš„ æ€»ç»“å¦‚æœç†Ÿæ‚‰ Javascript çš„æœ‹å‹ï¼ŒFuture çš„ç‰¹æ€§å’Œ Javascript çš„ Promise æ˜¯ç±»ä¼¼çš„ï¼Œç§ä¸‹å¼€ç©ç¬‘é€šå¸¸å°†å…¶æ¯”å–»æˆç”·æœ‹å‹çš„æ‰¿è¯º å›å½’åˆ°Javaï¼Œæˆ‘ä»¬ä» JDK çš„æ¼”å˜å†å²ï¼Œè°ˆåŠ Callable çš„è¯ç”Ÿï¼Œå®ƒå¼¥è¡¥äº† Runnable æ²¡æœ‰è¿”å›å€¼çš„ç©ºç¼ºï¼Œé€šè¿‡ç®€å•çš„ demo äº†è§£ Callable ä¸ Future çš„ä½¿ç”¨ã€‚ FutureTask åˆæ˜¯ Futureæ¥å£çš„æ ¸å¿ƒå®ç°ç±»ï¼Œé€šè¿‡é˜…è¯»æºç äº†è§£äº†æ•´ä¸ªå®ç°é€»è¾‘ï¼Œæœ€åç»“åˆFutureTask å’Œçº¿ç¨‹æ± æ¼”ç¤ºçƒ§æ°´æ³¡èŒ¶ç¨‹åºï¼Œç›¸ä¿¡åˆ°è¿™é‡Œï¼Œä½ å·²ç»å¯ä»¥è½»æ¾è·å–çº¿ç¨‹ç»“æœäº† çƒ§æ°´æ³¡èŒ¶æ˜¯éå¸¸ç®€å•çš„ï¼Œå¦‚æœæ›´å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼Œä»¥è¿™ç§æ–¹å¼ä½¿ç”¨ Future å¿…å®šä¼šå¸¦æ¥å¾ˆå¤§çš„ä¼šä¹±ï¼ˆç¨‹åºç»“æŸæ²¡åŠæ³•ä¸»åŠ¨é€šçŸ¥ï¼ŒFuture çš„é“¾æ¥å’Œæ•´åˆéƒ½éœ€è¦æ‰‹åŠ¨æ“ä½œï¼‰ä¸ºäº†è§£å†³è¿™ä¸ªçŸ­æ¿ï¼Œæ²¡é”™ï¼Œåˆæ˜¯é‚£ä¸ªç”·äºº Doug Lea, CompletableFuture å·¥å…·ç±»åœ¨ Java1.8 çš„ç‰ˆæœ¬å‡ºç°äº†ï¼Œæ­é… Lambda çš„ä½¿ç”¨ï¼Œè®©æˆ‘ä»¬ç¼–å†™å¼‚æ­¥ç¨‹åºä¹Ÿåƒå†™ä¸²è¡Œä»£ç é‚£æ ·ç®€å•ï¼Œçºµäº«ä¸æ»‘ æ¥ä¸‹æ¥æˆ‘ä»¬å°±äº†è§£ä¸€ä¸‹ CompletableFuture çš„ä½¿ç”¨ æˆ‘è¿˜è¦å•°å—¦ä¸€å¥ï¼šçƒ§æ°´æ³¡èŒ¶åªæ˜¯æŠ›å‡ºå»çš„ç –ï¼Œæ— è®ºç”Ÿæ´»è¿˜æ˜¯å·¥ä½œéƒ½è¦æ€è€ƒï¼Œå¯»æ‰¾ä»»åŠ¡å…³é”®è·¯å¾„ï¼Œæå‡è‡ªå·±çš„æ•ˆç‡ çµé­‚è¿½é—® ä½ åœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­æ˜¯æ€æ ·å°†æ•´å—ä»»åŠ¡åšåˆ°åˆ†å·¥ä¸åä½œçš„å‘¢ï¼Ÿæœ‰ä»€ä¹ˆåŸºæœ¬å‡†åˆ™å—ï¼Ÿ å¦‚ä½•æ‰¹é‡çš„æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡å‘¢ï¼Ÿ å‚è€ƒ Java å¹¶å‘ç¼–ç¨‹å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ Java å¹¶å‘ç¼–ç¨‹ä¹‹ç¾","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"CountDownLatch å’Œ CyclicBarrier å‚»å‚»çš„åˆ†ä¸æ¸…æ¥šï¼Ÿ","slug":"CountDownLatch-å’Œ-CyclicBarrier-å‚»å‚»çš„åˆ†ä¸æ¸…æ¥šï¼Ÿ","date":"2020-06-28T08:07:57.000Z","updated":"2020-06-28T08:22:00.998Z","comments":true,"path":"/p/java-countdownlatch-vs-cyclicbarrier.html","link":"","permalink":"https://dayarch.top/p/java-countdownlatch-vs-cyclicbarrier.html","excerpt":"å‰è¨€ å¹¶å‘ç¼–ç¨‹çš„ä¸‰å¤§æ ¸å¿ƒæ˜¯åˆ†å·¥ï¼ŒåŒæ­¥å’Œäº’æ–¥ã€‚åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šç¢°åˆ°éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­å¼€å¯å¤šä¸ªå­çº¿ç¨‹å»å¹¶è¡Œçš„æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶ä¸”ä¸»çº¿ç¨‹éœ€è¦ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å†è¿›è¡Œæ±‡æ€»çš„åœºæ™¯ï¼Œè¿™å°±æ¶‰åŠåˆ°åˆ†å·¥ä¸åŒæ­¥çš„å†…å®¹äº† åœ¨è®² æœ‰åºæ€§å¯è§æ€§ï¼ŒHappens-beforeæ¥æå®š æ—¶ï¼Œæåˆ°è¿‡ join() è§„åˆ™ï¼Œä½¿ç”¨ join() å°±å¯ä»¥ç®€å•çš„å®ç°ä¸Šè¿°åœºæ™¯ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 @Slf4j public class JoinExample { pub","text":"å‰è¨€å¹¶å‘ç¼–ç¨‹çš„ä¸‰å¤§æ ¸å¿ƒæ˜¯åˆ†å·¥ï¼ŒåŒæ­¥å’Œäº’æ–¥ã€‚åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šç¢°åˆ°éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­å¼€å¯å¤šä¸ªå­çº¿ç¨‹å»å¹¶è¡Œçš„æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶ä¸”ä¸»çº¿ç¨‹éœ€è¦ç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å†è¿›è¡Œæ±‡æ€»çš„åœºæ™¯ï¼Œè¿™å°±æ¶‰åŠåˆ°åˆ†å·¥ä¸åŒæ­¥çš„å†…å®¹äº† åœ¨è®² æœ‰åºæ€§å¯è§æ€§ï¼ŒHappens-beforeæ¥æå®š æ—¶ï¼Œæåˆ°è¿‡ join() è§„åˆ™ï¼Œä½¿ç”¨ join() å°±å¯ä»¥ç®€å•çš„å®ç°ä¸Šè¿°åœºæ™¯ï¼š 123456789101112131415161718192021222324252627282930313233@Slf4jpublic class JoinExample &#123; public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(() -&gt; &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; log.info(\"Thread-1 æ‰§è¡Œå®Œæ¯•\"); &#125; &#125;, \"Thread-1\"); Thread thread2 = new Thread(() -&gt; &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; log.info(\"Thread-2 æ‰§è¡Œå®Œæ¯•\"); &#125; &#125;, \"Thread-2\"); thread1.start(); thread2.start(); thread1.join(); thread2.join(); log.info(\"ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•\"); &#125;&#125; è¿è¡Œç»“æœï¼š æ•´ä¸ªè¿‡ç¨‹å¯ä»¥è¿™ä¹ˆç†è§£ æˆ‘ä»¬æ¥æŸ¥çœ‹ join() çš„å®ç°æºç ï¼š å…¶å®ç°åŸç†æ˜¯ä¸åœçš„æ£€æŸ¥ join çº¿ç¨‹æ˜¯å¦å­˜æ´»ï¼Œå¦‚æœ join çº¿ç¨‹å­˜æ´»ï¼Œåˆ™ wait(0) æ°¸è¿œçš„ç­‰ä¸‹å»ï¼Œç›´è‡³ join çº¿ç¨‹ç»ˆæ­¢åï¼Œçº¿ç¨‹çš„ this.notifyAll() æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼ˆè¯¥æ–¹æ³•æ˜¯åœ¨ JVM ä¸­å®ç°çš„ï¼ŒJDK ä¸­å¹¶ä¸ä¼šçœ‹åˆ°æºç ï¼‰ï¼Œé€€å‡ºå¾ªç¯æ¢å¤ä¸»çº¿ç¨‹æ‰§è¡Œã€‚å¾ˆæ˜¾ç„¶è¿™ç§å¾ªç¯æ£€æŸ¥çš„æ–¹å¼æ¯”è¾ƒä½æ•ˆ é™¤æ­¤ä¹‹å¤–ï¼Œä½¿ç”¨ join() ç¼ºå°‘å¾ˆå¤šçµæ´»æ€§ï¼Œæ¯”å¦‚å®é™…é¡¹ç›®ä¸­å¾ˆå°‘è®©è‡ªå·±å•ç‹¬åˆ›å»ºçº¿ç¨‹ï¼ˆåŸå› åœ¨ æˆ‘ä¼šæ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ? ä¸­è¯´è¿‡ï¼‰è€Œæ˜¯ä½¿ç”¨ Executor, è¿™è¿›ä¸€æ­¥å‡å°‘äº† join() çš„ä½¿ç”¨åœºæ™¯ï¼Œæ‰€ä»¥ join() çš„ä½¿ç”¨åœ¨å¤šæ•°æ˜¯åœç•™åœ¨ demo æ¼”ç¤ºä¸Š é‚£å¦‚ä½•å®ç°æ–‡ä¸­å¼€å¤´æåˆ°çš„åœºæ™¯å‘¢ï¼Ÿ CountDownLatchCountDownLatch, ç›´è¯‘è¿‡æ¥ã€æ•°é‡å‘ä¸‹é—¨é—©ã€‘ï¼Œé‚£è‚¯å®šé‡Œé¢æœ‰è®¡æ•°å™¨çš„å­˜åœ¨äº†ã€‚æˆ‘ä»¬å°†ä¸Šè¿°ç¨‹åºç”¨ CountDownLatch å®ç°ä¸€ä¸‹ï¼Œå…ˆè®©å¤§å®¶æœ‰ä¸ªç›´è§‚å°è±¡ 1234567891011121314151617181920212223242526272829303132333435363738394041@Slf4jpublic class CountDownLatchExample &#123; private static CountDownLatch countDownLatch = new CountDownLatch(2); public static void main(String[] args) throws InterruptedException &#123; // è¿™é‡Œä¸æ¨èè¿™æ ·åˆ›å»ºçº¿ç¨‹æ± ï¼Œæœ€å¥½é€šè¿‡ ThreadPoolExecutor æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æ±  ExecutorService executorService = Executors.newFixedThreadPool(2); executorService.submit(() -&gt; &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; log.info(\"Thread-1 æ‰§è¡Œå®Œæ¯•\"); //è®¡æ•°å™¨å‡1 countDownLatch.countDown(); &#125; &#125;); executorService.submit(() -&gt; &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; log.info(\"Thread-2 æ‰§è¡Œå®Œæ¯•\"); //è®¡æ•°å™¨å‡1 countDownLatch.countDown(); &#125; &#125;); log.info(\"ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•\"); log.info(\"è®¡æ•°å™¨å€¼ä¸ºï¼š\" + countDownLatch.getCount()); countDownLatch.await(); log.info(\"è®¡æ•°å™¨å€¼ä¸ºï¼š\" + countDownLatch.getCount()); log.info(\"ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•\"); executorService.shutdown(); &#125;&#125; è¿è¡Œç»“æœå¦‚ä¸‹ï¼š ç»“åˆä¸Šè¿°ç¤ºä¾‹çš„è¿è¡Œç»“æœï¼Œç›¸ä¿¡ä½ ä¹Ÿèƒ½çŒœå‡º CountDownLatch çš„å®ç°åŸç†äº†ï¼š åˆå§‹åŒ–è®¡æ•°å™¨æ•°å€¼ï¼Œæ¯”å¦‚ä¸º2 å­çº¿ç¨‹æ‰§è¡Œå®Œåˆ™è°ƒç”¨ countDownLatch.countDown() æ–¹æ³•å°†è®¡æ•°å™¨æ•°å€¼å‡1 ä¸»çº¿ç¨‹è°ƒç”¨ await() æ–¹æ³•é˜»å¡è‡ªå·±ï¼Œç›´è‡³è®¡æ•°å™¨æ•°å€¼ä¸º0ï¼ˆå³å­çº¿ç¨‹å…¨éƒ¨æ‰§è¡Œç»“æŸï¼‰ ä¸çŸ¥é“ä½ æ˜¯å¦æ³¨æ„ï¼ŒcountDownLatch.countDown(); è¿™è¡Œä»£ç å¯ä»¥å†™åœ¨å­çº¿ç¨‹æ‰§è¡Œçš„ä»»æ„ä½ç½®ï¼Œä¸åƒ join() è¦å®Œå…¨ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œï¼Œè¿™ä¹Ÿæ˜¯ CountDownLatch çµæ´»æ€§çš„ä¸€ç§ä½“ç° ä¸Šè¿°çš„ä¾‹å­è¿˜æ˜¯è¿‡äºç®€å•ï¼ŒOracle å®˜ç½‘ CountDownLatch è¯´æ˜ æœ‰ä¸¤ä¸ªéå¸¸ç»å…¸çš„ä½¿ç”¨åœºæ™¯ï¼Œç¤ºä¾‹å¾ˆç®€å•ï¼Œå¼ºçƒˆå»ºè®®æŸ¥çœ‹ç›¸å…³ç¤ºä¾‹ä»£ç ï¼Œæ‰“å¼€ä½¿ç”¨æ€è·¯ã€‚æˆ‘å°†ä¸¤ä¸ªç¤ºä¾‹ä»£ç ä»¥å›¾ç‰‡çš„å½¢å¼å±•ç¤ºåœ¨æ­¤å¤„ï¼š å®˜ç½‘ç¤ºä¾‹1 ç¬¬ä¸€ä¸ªæ˜¯å¼€å§‹ä¿¡å· startSignalï¼Œé˜»æ­¢ä»»ä½•å·¥äºº Worker ç»§ç»­å·¥ä½œï¼Œç›´åˆ°å¸æœº Driver å‡†å¤‡å¥½è®©ä»–ä»¬ç»§ç»­å·¥ä½œ ç¬¬äºŒä¸ªæ˜¯å®Œæˆä¿¡å· doneSignalï¼Œå…è®¸å¸æœº Driver ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰çš„å·¥äºº Worker å®Œæˆã€‚ å®˜ç½‘ç¤ºä¾‹2å¦ä¸€ç§å…¸å‹çš„ç”¨æ³•æ˜¯å°†ä¸€ä¸ªé—®é¢˜åˆ†æˆ N ä¸ªéƒ¨åˆ† ï¼ˆæ¯”å¦‚å°†ä¸€ä¸ªå¤§çš„ list æ‹†åˆ†æˆå¤šåˆ†ï¼Œæ¯ä¸ª Worker å¹²ä¸€éƒ¨åˆ†ï¼‰ï¼ŒWorker æ‰§è¡Œå®Œè‡ªå·±æ‰€å¤„ç†çš„éƒ¨åˆ†åï¼Œè®¡æ•°å™¨å‡1ï¼Œå½“æ‰€æœ‰å­éƒ¨åˆ†å®Œæˆåï¼ŒDriver æ‰ç»§ç»­å‘ä¸‹æ‰§è¡Œ ç»“åˆå®˜ç½‘ç¤ºä¾‹ï¼Œç›¸ä¿¡ä½ å·²ç»å¯ä»¥ç»“åˆä½ è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯è§£ï¼Œé€šè¿‡ CountDownLatch è§£å†³ä¸€äº›ä¸²è¡Œç“¶é¢ˆæ¥æé«˜è¿è¡Œæ•ˆç‡äº†ï¼Œä¼šç”¨è¿˜è¿œè¿œä¸å¤Ÿï¼Œå’±å¾—çŸ¥é“ CountDownLatch çš„å®ç°åŸç† æºç åˆ†æCountDownLatch æ˜¯ AQS å®ç°ä¸­çš„æœ€åä¸€ä¸ªå†…å®¹ï¼Œæœ‰äº†å‰åºæ–‡ç« çš„çŸ¥è¯†é“ºå«ï¼š Java AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨ Java AQSå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€åŠSemaphoreçš„åº”ç”¨åˆ†æ å½“ä½ çœ‹åˆ° CountDownLatch çš„æºç å†…å®¹ï¼Œä½ ä¼šé«˜å…´çš„ç¬‘èµ·æ¥ï¼Œå†…å®¹çœŸæ˜¯å¤ªå°‘äº† å±•å¼€ç±»ç»“æ„å…¨éƒ¨å†…å®¹å°±è¿™ç‚¹ä¸œè¥¿ æ—¢ç„¶ CountDownLatch æ˜¯åŸºäº AQS å®ç°çš„ï¼Œé‚£è‚¯å®šä¹Ÿç¦»ä¸å¼€å¯¹åŒæ­¥çŠ¶æ€å˜é‡ state çš„æ“ä½œï¼Œæˆ‘ä»¬åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±å°†è®¡æ•°å™¨çš„å€¼èµ‹å€¼ç»™äº†state å¦å¤–ï¼Œå®ƒå¯ä»¥å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–ï¼Œé‚£ä¸€å®šæ˜¯åŸºäºå…±äº«å¼è·å–åŒæ­¥å˜é‡çš„ç”¨æ³•äº†ï¼Œæ‰€ä»¥å®ƒéœ€è¦é€šè¿‡é‡å†™ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•æ§åˆ¶åŒæ­¥çŠ¶æ€å˜é‡ state ï¼š tryAcquireShared() tryReleaseShared() CountDownLatch æš´éœ²ç»™ä½¿ç”¨è€…çš„åªæœ‰ await() å’Œ countDown() ä¸¤ä¸ªæ–¹æ³•ï¼Œå‰è€…æ˜¯é˜»å¡è‡ªå·±ï¼Œå› ä¸ºåªæœ‰è·å–åŒæ­¥çŠ¶æ€æ‰ä¼šæ‰ä¼šå‡ºç°é˜»å¡çš„æƒ…å†µï¼Œé‚£è‡ªç„¶æ˜¯åœ¨ await() çš„æ–¹æ³•å†…éƒ¨ä¼šç”¨åˆ° tryAcquireShared()ï¼›æœ‰è·å–å°±è¦æœ‰é‡Šæ”¾ï¼Œé‚£åè€… countDown() æ–¹æ³•å†…éƒ¨è‡ªç„¶æ˜¯è¦ç”¨åˆ° tryReleaseShared() æ–¹æ³•äº† PSï¼šå¦‚æœä½ å¯¹ä¸Šé¢è¿™ä¸ªå¾ˆè‡ªç„¶çš„æ¨æ–­ç†è§£æœ‰å›°éš¾ï¼Œå¼ºçƒˆå»ºè®®ä½ çœ‹ä¸€ä¸‹å‰åºæ–‡ç« çš„é“ºå«ï¼Œä»¥é˜²æ­¢çŸ¥è¯†æ–­å±‚å¸¦æ¥çš„å›°æ‰° await()å…ˆæ¥çœ‹ await() æ–¹æ³•, ä»æ–¹æ³•ç­¾åä¸Šçœ‹ï¼Œè¯¥æ–¹æ³•ä¼šæŠ›å‡º InterruptedException, æ‰€ä»¥å®ƒæ˜¯å¯ä»¥å“åº”ä¸­æ–­çš„ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨ Javaå¤šçº¿ç¨‹ä¸­æ–­æœºåˆ¶ ä¸­æ˜ç¡®è¯´æ˜è¿‡ 123public void await() throws InterruptedException &#123; sync.acquireSharedInterruptibly(1);&#125; å…¶å†…éƒ¨è°ƒç”¨äº†åŒæ­¥å™¨æä¾›çš„æ¨¡ç‰ˆæ–¹æ³• acquireSharedInterruptibly 12345678910public final void acquireSharedInterruptibly(int arg) throws InterruptedException &#123; // å¦‚æœç›‘æµ‹åˆ°ä¸­æ–­æ ‡è¯†ä¸ºtrue,ä¼šé‡ç½®æ ‡è¯†ï¼Œç„¶åæŠ›å‡º InterruptedException if (Thread.interrupted()) throw new InterruptedException(); // è°ƒç”¨é‡å†™çš„ tryAcquireShared æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç»“æœå¦‚æœå¤§äºé›¶åˆ™ç›´æ¥è¿”å›ï¼Œç¨‹åºç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œå¦‚æœå°äºé›¶ï¼Œåˆ™ä¼šé˜»å¡è‡ªå·± if (tryAcquireShared(arg) &lt; 0) // stateä¸ç­‰äº0ï¼Œåˆ™å°è¯•é˜»å¡è‡ªå·± doAcquireSharedInterruptibly(arg);&#125; é‡å†™çš„ tryAcquireShared æ–¹æ³•éå¸¸ç®€å•, å°±æ˜¯åˆ¤æ–­åŒæ­¥çŠ¶æ€å˜é‡ state çš„å€¼æ˜¯å¦ä¸º 0ï¼Œ å¦‚æœä¸ºé›¶ ï¼ˆå­çº¿ç¨‹å·²ç»å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼‰åˆ™è¿”å›1ï¼Œ å¦åˆ™è¿”å› -1 123protected int tryAcquireShared(int acquires) &#123; return (getState() == 0) ? 1 : -1;&#125; å¦‚æœå­çº¿ç¨‹æ²¡æœ‰å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™ä¼šé€šè¿‡ doAcquireSharedInterruptibly æ–¹æ³•é˜»å¡è‡ªå·±ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ Java AQSå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€åŠSemaphoreçš„åº”ç”¨åˆ†æ ä¸­å·²ç»ä»”ç»†åˆ†æè¿‡äº†ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº† 123456789101112131415161718192021222324252627private void doAcquireSharedInterruptibly(int arg) throws InterruptedException &#123; final Node node = addWaiter(Node.SHARED); boolean failed = true; try &#123; for (;;) &#123; final Node p = node.predecessor(); if (p == head) &#123; // å†æ¬¡å°è¯•è·å–åŒæ­¥è£…é˜¿åšï¼Œå¦‚æœå¤§äº0ï¼Œè¯´æ˜å­çº¿ç¨‹å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œç›´æ¥è¿”å› int r = tryAcquireShared(arg); if (r &gt;= 0) &#123; setHeadAndPropagate(node, r); p.next = null; // help GC failed = false; return; &#125; &#125; // é˜»å¡è‡ªå·± if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; parkAndCheckInterrupt()) throw new InterruptedException(); &#125; &#125; finally &#123; if (failed) cancelAcquire(node); &#125;&#125; await() æ–¹æ³•çš„å®ç°å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹ countDown() çš„å®ç°åŸç† countDown()123public void countDown() &#123; sync.releaseShared(1);&#125; åŒæ ·æ˜¯è°ƒç”¨åŒæ­¥å™¨æä¾›çš„æ¨¡ç‰ˆæ–¹æ³• releaseShared 123456789public final boolean releaseShared(int arg) &#123; // è°ƒç”¨è‡ªå·±é‡å†™çš„åŒæ­¥å™¨æ–¹æ³• if (tryReleaseShared(arg)) &#123; // å”¤é†’è°ƒç”¨ await() è¢«é˜»å¡çš„çº¿ç¨‹ doReleaseShared(); return true; &#125; return false;&#125; é‡å†™çš„ tryReleaseShared åŒæ ·å¾ˆç®€å• 12345678910111213protected boolean tryReleaseShared(int releases) &#123; // Decrement count; signal when transition to zero for (;;) &#123; int c = getState(); // å¦‚æœå½“å‰çŠ¶æ€å€¼ä¸º0ï¼Œåˆ™ç›´æ¥è¿”å› ï¼ˆ1ï¼‰ if (c == 0) return false; // ä½¿ç”¨ CAS è®©è®¡æ•°å™¨çš„å€¼å‡1 ï¼ˆ2ï¼‰ int nextc = c-1; if (compareAndSetState(c, nextc)) return nextc == 0; &#125;&#125; ä»£ç  ï¼ˆ1ï¼‰ åˆ¤æ–­å½“å‰åŒæ­¥çŠ¶æ€å€¼ï¼Œå¦‚æœä¸º0 åˆ™ç›´æ¥è¿”å› falseï¼›å¦åˆ™æ‰§è¡Œä»£ç  ï¼ˆ2ï¼‰ï¼Œä½¿ç”¨ CAS å°†è®¡æ•°å™¨å‡1ï¼Œå¦‚æœ CAS å¤±è´¥ï¼Œåˆ™å¾ªç¯é‡è¯•ï¼Œæœ€ç»ˆè¿”å› nextc == 0 çš„ç»“æœå€¼ï¼Œå¦‚æœè¯¥å€¼è¿”å› trueï¼Œè¯´æ˜æœ€åä¸€ä¸ªçº¿ç¨‹å·²è°ƒç”¨ countDown() æ–¹æ³•ï¼Œç„¶åå°±è¦å”¤é†’è°ƒç”¨ await() æ–¹æ³•è¢«é˜»å¡çš„çº¿ç¨‹ï¼ŒåŒæ ·ç”±äºåˆ†æè¿‡ AQS çš„æ¨¡ç‰ˆæ–¹æ³• doReleaseShared æ•´ä¸ªé‡Šæ”¾åŒæ­¥çŠ¶æ€ä»¥åŠå”¤é†’çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥è¿™é‡ŒåŒæ ·ä¸å†èµ˜è¿°äº† ä»”ç»†çœ‹CountDownLatché‡å†™çš„ tryReleaseShared æ–¹æ³•ï¼Œæœ‰ä¸€ç‚¹éœ€è¦å’Œå¤§å®¶è¯´æ˜ï¼š ä»£ç  ï¼ˆ1ï¼‰ if (c == 0) çœ‹ä¼¼æ²¡ä»€ä¹ˆç”¨å¤„ï¼Œå…¶å®ç”¨å¤„å¤§å¤§æ»´ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªåˆ¤æ–­ï¼Œå½“è®¡æ•°å™¨å€¼å·²ç»ä¸ºé›¶äº†ï¼Œå…¶ä»–çº¿ç¨‹å†è°ƒç”¨ countDown æ–¹æ³•ä¼šå°†è®¡æ•°å™¨å€¼å˜ä¸ºè´Ÿå€¼ ç°åœ¨å°±å·® await(long timeout, TimeUnit unit) æ–¹æ³•æ²¡ä»‹ç»äº† await(long timeout, TimeUnit unit)1234public boolean await(long timeout, TimeUnit unit) throws InterruptedException &#123; return sync.tryAcquireSharedNanos(1, unit.toNanos(timeout));&#125; è¯¥æ–¹æ³•ç­¾ååŒæ ·æŠ›å‡º InterruptedExceptionï¼Œæ„æ€å¯å“åº”ä¸­æ–­ã€‚å®ƒå…¶å®å°±æ˜¯ await() æ›´å®Œå–„çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œç®€å•æ¥è¯´å°±æ˜¯ ä¸»çº¿ç¨‹è®¾å®šç­‰å¾…è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¯¥æ—¶é—´å†…å­çº¿ç¨‹æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œä¸»çº¿ç¨‹ä¹Ÿä¼šç›´æ¥è¿”å› æˆ‘ä»¬å°†ä¸Šé¢çš„ä¾‹å­ç¨ç¨ä¿®æ”¹ä¸€ä¸‹ä½ å°±ä¼šæ˜ç™½(ä¸»çº¿ç¨‹è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º 2 ç§’ï¼Œè€Œå­çº¿ç¨‹è¦ sleep 5 ç§’) 1234567891011121314151617181920212223242526272829303132333435363738394041@Slf4jpublic class CountDownLatchTimeoutExample &#123; private static CountDownLatch countDownLatch = new CountDownLatch(2); public static void main(String[] args) throws InterruptedException &#123; // è¿™é‡Œä¸æ¨èè¿™æ ·åˆ›å»ºçº¿ç¨‹æ± ï¼Œæœ€å¥½é€šè¿‡ ThreadPoolExecutor æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æ±  ExecutorService executorService = Executors.newFixedThreadPool(2); executorService.submit(() -&gt; &#123; try &#123; Thread.sleep(5000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; log.info(\"Thread-1 æ‰§è¡Œå®Œæ¯•\"); //è®¡æ•°å™¨å‡1 countDownLatch.countDown(); &#125; &#125;); executorService.submit(() -&gt; &#123; try &#123; Thread.sleep(5000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; log.info(\"Thread-2 æ‰§è¡Œå®Œæ¯•\"); //è®¡æ•°å™¨å‡1 countDownLatch.countDown(); &#125; &#125;); log.info(\"ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•\"); log.info(\"è®¡æ•°å™¨å€¼ä¸ºï¼š\" + countDownLatch.getCount()); countDownLatch.await(2, TimeUnit.SECONDS); log.info(\"è®¡æ•°å™¨å€¼ä¸ºï¼š\" + countDownLatch.getCount()); log.info(\"ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•\"); executorService.shutdown(); &#125;&#125; è¿è¡Œç»“æœå¦‚ä¸‹ï¼š å½¢è±¡åŒ–çš„å±•ç¤ºä¸Šè¿°ç¤ºä¾‹çš„è¿è¡Œè¿‡ç¨‹ å°ç»“CountDownLatch çš„å®ç°åŸç†å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œäº†è§£äº†æ•´ä¸ªå®ç°è¿‡ç¨‹åï¼Œä½ ä¹Ÿè®¸å‘ç°äº†ä½¿ç”¨ CountDownLatch çš„ä¸€ä¸ªé—®é¢˜ï¼š è®¡æ•°å™¨å‡ 1 æ“ä½œæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å½“è®¡æ•°å™¨å‡åˆ° 0ï¼Œ å†æœ‰çº¿ç¨‹è°ƒç”¨ await() æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ä¼šç›´æ¥é€šè¿‡ï¼Œä¸ä¼šå†èµ·åˆ°ç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œç»“æœèµ·åˆ°åŒæ­¥çš„ä½œç”¨äº† ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè´´å¿ƒçš„ Doug Lea å¤§å¸ˆæ—©å·²ç»™æˆ‘ä»¬å‡†å¤‡å¥½ç›¸åº”ç­–ç•¥ CyclicBarrier æœ¬æ¥æƒ³å°† CyclicBarrier çš„å†…å®¹æ”¾åˆ°ä¸‹ä¸€ä¸ªç« èŠ‚ï¼Œä½†æ˜¯ CountDownLatch çš„å†…å®¹ç€å®æœ‰äº›å°‘ï¼Œä¸å¤Ÿè§£æ¸´ï¼Œå¦å¤–æœ‰å¯¹æ¯”æ‰æœ‰ä¼¤å®³ï¼Œæ‰€ä»¥å†…å®¹æ²¡ç»“æŸï¼Œå’±å¾—ç»§ç»­çœ‹ CyclicBarrierï¼‰ CyclicBarrierä¸Šé¢ç®€å•è¯´äº†ä¸€ä¸‹ CyclicBarrier è¢«åˆ›é€ å‡ºæ¥çš„ç†ç”±ï¼Œè¿™é‡Œå…ˆçœ‹ä¸€ä¸‹å®ƒçš„å­—é¢è§£é‡Šï¼š æ¦‚å¿µæ€»æ˜¯æœ‰äº›æŠ½è±¡ï¼Œæˆ‘ä»¬å°†ä¸Šé¢çš„ä¾‹å­ç”¨ CyclicBarrier å†åšä¸ªæ”¹åŠ¨ï¼Œå…ˆè®©å¤§å®¶æœ‰ä¸ªç›´è§‚çš„ä½¿ç”¨æ¦‚å¿µ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647@Slf4jpublic class CyclicBarrierExample &#123; // åˆ›å»º CyclicBarrier å®ä¾‹ï¼Œè®¡æ•°å™¨çš„å€¼è®¾ç½®ä¸º2 private static CyclicBarrier cyclicBarrier = new CyclicBarrier(2); public static void main(String[] args) &#123; ExecutorService executorService = Executors.newFixedThreadPool(2); int breakCount = 0; // å°†çº¿ç¨‹æäº¤åˆ°çº¿ç¨‹æ±  executorService.submit(() -&gt; &#123; try &#123; log.info(Thread.currentThread() + \"ç¬¬ä¸€å›åˆ\"); Thread.sleep(1000); cyclicBarrier.await(); log.info(Thread.currentThread() + \"ç¬¬äºŒå›åˆ\"); Thread.sleep(2000); cyclicBarrier.await(); log.info(Thread.currentThread() + \"ç¬¬ä¸‰å›åˆ\"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;); executorService.submit(() -&gt; &#123; try &#123; log.info(Thread.currentThread() + \"ç¬¬ä¸€å›åˆ\"); Thread.sleep(2000); cyclicBarrier.await(); log.info(Thread.currentThread() + \"ç¬¬äºŒå›åˆ\"); Thread.sleep(1000); cyclicBarrier.await(); log.info(Thread.currentThread() + \"ç¬¬ä¸‰å›åˆ\"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;); executorService.shutdown(); &#125;&#125; è¿è¡Œç»“æœï¼š ç»“åˆç¨‹åºä»£ç ä¸è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå­çº¿ç¨‹æ‰§è¡Œå®Œç¬¬ä¸€å›åˆåï¼ˆæ‰§è¡Œå›åˆæ‰€éœ€æ—¶é—´ä¸åŒï¼‰ï¼Œéƒ½ä¼šè°ƒç”¨ await() æ–¹æ³•ï¼Œç­‰æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœç‚¹åï¼Œä¼šçªç ´å±éšœç»§è€Œæ‰§è¡Œç¬¬äºŒå›åˆï¼ŒåŒæ ·çš„é“ç†æœ€ç»ˆåˆ°è¾¾ç¬¬ä¸‰å›åˆ å½¢è±¡åŒ–çš„å±•ç¤ºä¸Šè¿°ç¤ºä¾‹çš„è¿è¡Œè¿‡ç¨‹ çœ‹åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥æ˜ç™½ CyclicBarrier çš„åŸºæœ¬ç”¨æ³•ï¼Œä½†éšä¹‹ä½ å†…å¿ƒä¹Ÿåº”è¯¥æœ‰äº†ä¸€äº›ç–‘é—®ï¼š æ€ä¹ˆåˆ¤æ–­æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœç‚¹çš„ï¼Ÿ çªç ´æŸä¸€å±éšœåï¼Œåˆæ˜¯æ€ä¹ˆé‡ç½® CyclicBarrier è®¡æ•°å™¨ï¼Œç­‰å¾…çº¿ç¨‹å†ä¸€æ¬¡çªç ´å±éšœå‘¢ï¼Ÿ å¸¦ç€è¿™äº›é—®é¢˜æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹æºç  æºç åˆ†æåŒæ ·å…ˆæ‰“å¼€ CyclicBarrier çš„ç±»ç»“æ„ï¼Œå±•å¼€ç±»å…¨éƒ¨å†…å®¹ï¼Œå…¶å®ä¹Ÿæ²¡å¤šå°‘å†…å®¹ ä»ç±»ç»“æ„ä¸­çœ‹åˆ°æœ‰ï¼š await() æ–¹æ³•ï¼ŒçŒœæµ‹åº”è¯¥å’Œ CountDownLatch æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯è·å–åŒæ­¥çŠ¶æ€ï¼Œé˜»å¡è‡ªå·± ReentrantLockï¼ŒCyclicBarrier å†…éƒ¨ç«Ÿç„¶ä¹Ÿç”¨åˆ°äº†æˆ‘ä»¬ä¹‹å‰è®²è¿‡çš„ ReentrantLockï¼ŒçŒœæµ‹è¿™ä¸ªé”ä¸€å®šä¿æŠ¤ CyclicBarrier çš„æŸä¸ªå˜é‡ï¼Œé‚£è‚¯å®šä¹Ÿæ˜¯åŸºäº AQS ç›¸å…³çŸ¥è¯†äº† Conditionï¼Œå­˜åœ¨æ¡ä»¶ï¼ŒçŒœæµ‹ä¼šæœ‰ç­‰å¾…/é€šçŸ¥æœºåˆ¶çš„è¿ç”¨ æˆ‘ä»¬ç»§ç»­å¸¦ç€è¿™äº›çŒœæµ‹ï¼Œç»“åˆä¸Šé¢çš„å®ä¾‹ä»£ç ä¸€ç‚¹ç‚¹æ¥éªŒè¯ 12// åˆ›å»º CyclicBarrier å®ä¾‹ï¼Œè®¡æ•°å™¨çš„å€¼è®¾ç½®ä¸º2private static CyclicBarrier cyclicBarrier = new CyclicBarrier(2); æŸ¥çœ‹æ„é€ å‡½æ•° (è¿™é‡Œçš„è‹±æ–‡æ³¨é‡Šèˆä¸å¾—åˆ æ‰ï¼Œå› ä¸ºè¯´çš„å¤ªæ¸…æ¥šäº†ï¼Œæˆ‘æ¥ç»“åˆæ³¨é‡Šæ¥è¯´æ˜ä¸€ä¸‹)ï¼š 12345678910111213141516171819202122232425private final int parties;private int count;public CyclicBarrier(int parties) &#123; this(parties, null);&#125; /** * Creates a new &#123;@code CyclicBarrier&#125; that will trip when the * given number of parties (threads) are waiting upon it, and which * will execute the given barrier action when the barrier is tripped, * performed by the last thread entering the barrier. * * @param parties the number of threads that must invoke &#123;@link #await&#125; * before the barrier is tripped * @param barrierAction the command to execute when the barrier is * tripped, or &#123;@code null&#125; if there is no action * @throws IllegalArgumentException if &#123;@code parties&#125; is less than 1 */ public CyclicBarrier(int parties, Runnable barrierAction) &#123; if (parties &lt;= 0) throw new IllegalArgumentException(); this.parties = parties; this.count = parties; this.barrierCommand = barrierAction; &#125; æ ¹æ®æ³¨é‡Šè¯´æ˜ï¼Œparties ä»£è¡¨å†²ç ´å±éšœä¹‹å‰è¦è§¦å‘çš„çº¿ç¨‹æ€»æ•°ï¼Œcount æœ¬èº«åˆæ˜¯è®¡æ•°å™¨ï¼Œé‚£é—®é¢˜æ¥äº† ç›´æ¥å°±ç”¨ count ä¸å°±å¯ä»¥äº†å˜›ï¼Ÿä¸ºå•¥åŒæ ·ç”¨äºåˆå§‹åŒ–è®¡æ•°å™¨ï¼Œè¦ç»´æŠ¤ä¸¤ä¸ªå˜é‡å‘¢ï¼Ÿ ä» parties å’Œ count çš„å˜é‡å£°æ˜ä¸­ï¼Œä½ ä¹Ÿèƒ½çœ‹å‡ºä¸€äº›é—¨é“ï¼Œå‰è€…æœ‰ final ä¿®é¥°ï¼Œåˆå§‹åŒ–åå°±ä¸å¯ä»¥æ”¹å˜äº†ï¼Œå› ä¸º CyclicBarrier çš„è®¾è®¡ç›®çš„æ˜¯å¯ä»¥å¾ªç¯åˆ©ç”¨çš„ï¼Œæ‰€ä»¥å§‹ç»ˆç”¨ parties æ¥è®°å½•çº¿ç¨‹æ€»æ•°ï¼Œå½“ count è®¡æ•°å™¨å˜ä¸º 0 åï¼Œå¦‚æœæ²¡æœ‰ parties çš„å€¼èµ‹ç»™å®ƒï¼Œæ€ä¹ˆè¿›è¡Œé‡æ–°å¤ç”¨å†æ¬¡è®¡æ•°å‘¢ï¼Œæ‰€ä»¥è¿™é‡Œç»´æŠ¤ä¸¤ä¸ªå˜é‡å¾ˆæœ‰å¿…è¦ æ¥ä¸‹æ¥å°±çœ‹çœ‹ await() åˆ°åº•æ˜¯æ€ä¹ˆå®ç°çš„ 123456789// ä»æ–¹æ³•ç­¾åä¸Šå¯ä»¥çœ‹å‡ºï¼Œè¯¥æ–¹æ³•åŒæ ·å¯ä»¥è¢«ä¸­æ–­ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ª BrokenBarrierException å¼‚å¸¸ï¼Œæˆ‘ä»¬ä¸€ä¼šçœ‹public int await() throws InterruptedException, BrokenBarrierException &#123; try &#123; // è°ƒç”¨å†…éƒ¨ dowait æ–¹æ³•ï¼Œ ç¬¬ä¸€ä¸ªå‚æ•°ä¸º falseï¼Œè¡¨ç¤ºä¸è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¹Ÿå°±æ²¡äº†æ„ä¹‰ return dowait(false, 0L); &#125; catch (TimeoutException toe) &#123; throw new Error(toe); // cannot happen &#125;&#125; æ¥ä¸‹æ¥çœ‹çœ‹ dowait(false, 0L) åšäº†å“ªäº›äº‹æƒ… ï¼ˆè¿™ä¸ªæ–¹æ³•å†…å®¹æœ‰ç‚¹å¤šï¼Œåˆ«æ‹…å¿ƒï¼Œé€»è¾‘å¹¶ä¸å¤æ‚ï¼Œè¯·çœ‹å…³é”®ä»£ç æ³¨é‡Šï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102private int dowait(boolean timed, long nanos) throws InterruptedException, BrokenBarrierException, TimeoutException &#123; final ReentrantLock lock = this.lock; // è¿˜è®°å¾—ä¹‹å‰è¯´è¿‡çš„ Lock æ ‡å‡†èŒƒå¼å—ï¼Ÿ JDK å†…éƒ¨éƒ½æ˜¯è¿™ä¹ˆä½¿ç”¨çš„ï¼Œä½ ä¸€å®šä¹Ÿè¦éµå¾ªèŒƒå¼ lock.lock(); try &#123; final Generation g = generation; // broken æ˜¯é™æ€å†…éƒ¨ç±» Generationå”¯ä¸€çš„ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œç”¨äºè®°å½•å½“å‰å±éšœæ˜¯å¦è¢«æ‰“ç ´ï¼Œå¦‚æœæ‰“ç ´ï¼Œåˆ™æŠ›å‡º BrokenBarrierException å¼‚å¸¸ // è¿™é‡Œæ„Ÿè§‰æŒºå›°æƒ‘çš„ï¼Œæˆ‘ä»¬è¦ã€å†²ç ´ã€‘å±éšœï¼Œè¿™é‡Œã€æ‰“ç ´ã€‘å±éšœå´æŠ›å‡ºå¼‚å¸¸ï¼Œæ³¨æ„æˆ‘è¿™é‡Œçš„ç”¨è¯ if (g.broken) throw new BrokenBarrierException(); // å¦‚æœçº¿ç¨‹è¢«ä¸­æ–­ï¼Œåˆ™ä¼šé€šè¿‡ breakBarrier æ–¹æ³•å°† broken è®¾ç½®ä¸ºtrueï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰çº¿ç¨‹æ”¶åˆ°ä¸­æ–­é€šçŸ¥ï¼Œç›´æ¥å°±æ‰“ç ´å±éšœï¼Œåœæ­¢ CyclicBarrierï¼Œ å¹¶å”¤é†’æ‰€æœ‰çº¿ç¨‹ if (Thread.interrupted()) &#123; breakBarrier(); throw new InterruptedException(); &#125; // ************************************ // å› ä¸º breakBarrier æ–¹æ³•åœ¨è¿™é‡Œä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼Œä¸ºäº†ä¾¿äºå¤§å®¶ç†è§£ï¼Œæˆ‘ç›´æ¥å°† breakBarrier ä»£ç æ’å…¥åˆ°è¿™é‡Œ private void breakBarrier() &#123; // å°†æ‰“ç ´å±éšœæ ‡è¯† è®¾ç½®ä¸º true generation.broken = true; // é‡ç½®è®¡æ•°å™¨ count = parties; // å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ trip.signalAll(); &#125; // ************************************ // æ¯å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ await æ–¹æ³•ï¼Œè®¡æ•°å™¨ count å°±ä¼šå‡1 int index = --count; // å½“ count å€¼å‡åˆ° 0 æ—¶ï¼Œè¯´æ˜è¿™æ˜¯æœ€åä¸€ä¸ªè°ƒç”¨ await() çš„å­çº¿ç¨‹ï¼Œåˆ™ä¼šçªç ´å±éšœ if (index == 0) &#123; // tripped boolean ranAction = false; try &#123; // è·å–æ„é€ å‡½æ•°ä¸­çš„ barrierCommandï¼Œå¦‚æœæœ‰å€¼ï¼Œåˆ™è¿è¡Œè¯¥æ–¹æ³• final Runnable command = barrierCommand; if (command != null) command.run(); ranAction = true; // æ¿€æ´»å…¶ä»–å› è°ƒç”¨ await æ–¹æ³•è€Œè¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå¹¶é‡ç½® CyclicBarrier nextGeneration(); // ************************************ // ä¸ºäº†ä¾¿äºå¤§å®¶ç†è§£ï¼Œæˆ‘ç›´æ¥å°† nextGeneration å®ç°æ’å…¥åˆ°è¿™é‡Œ private void nextGeneration() &#123; // signal completion of last generation trip.signalAll(); // set up next generation count = parties; generation = new Generation(); &#125; // ************************************ return 0; &#125; finally &#123; if (!ranAction) breakBarrier(); &#125; &#125; // index ä¸ç­‰äº0ï¼Œ è¯´æ˜å½“å‰ä¸æ˜¯æœ€åä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ await æ–¹æ³• // loop until tripped, broken, interrupted, or timed out for (;;) &#123; try &#123; // æ²¡æœ‰è®¾ç½®è¶…æ—¶æ—¶é—´ if (!timed) // è¿›å…¥æ¡ä»¶ç­‰å¾… trip.await(); else if (nanos &gt; 0L) // å¦åˆ™ï¼Œåˆ¤æ–­è¶…æ—¶æ—¶é—´ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨ AQS ä¸­æœ‰è¯´æ˜è¿‡ï¼ŒåŒ…æ‹¬ä¸ºä»€ä¹ˆæœ€åè¶…æ—¶é˜ˆå€¼ spinForTimeoutThreshold ä¸å†æ¯”è¾ƒçš„åŸå› ï¼Œå¤§å®¶ä¼šçœ‹å°±å¥½ nanos = trip.awaitNanos(nanos); &#125; catch (InterruptedException ie) &#123; // æ¡ä»¶ç­‰å¾…è¢«ä¸­æ–­ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹å·²ç»ä½¿å±éšœç ´åã€‚è‹¥æ²¡æœ‰åˆ™è¿›è¡Œå±éšœç ´åå¤„ç†ï¼Œå¹¶æŠ›å‡ºå¼‚å¸¸ï¼›å¦åˆ™å†æ¬¡ä¸­æ–­å½“å‰çº¿ç¨‹ if (g == generation &amp;&amp; ! g.broken) &#123; breakBarrier(); throw ie; &#125; else &#123; Thread.currentThread().interrupt(); &#125; &#125; if (g.broken) throw new BrokenBarrierException(); // å¦‚æœæ–°ä¸€è½®å›ç¯ç»“æŸï¼Œä¼šé€šè¿‡ nextGeneration æ–¹æ³•æ–°å»º generation å¯¹è±¡ if (g != generation) return index; if (timed &amp;&amp; nanos &lt;= 0L) &#123; breakBarrier(); throw new TimeoutException(); &#125; &#125; &#125; finally &#123; lock.unlock(); &#125;&#125; doWait å°±æ˜¯ CyclicBarrier çš„æ ¸å¿ƒé€»è¾‘ï¼Œ å¯ä»¥çœ‹å‡ºï¼Œè¯¥æ–¹æ³•å…¥å£ä½¿ç”¨äº† ReentrantLockï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ Generation broken å˜é‡æ²¡æœ‰è¢«å£°æ˜ä¸º volatile ç±»å‹ä¿æŒå¯è§æ€§ï¼Œå› ä¸ºå¯¹å…¶çš„æ›´æ”¹éƒ½æ˜¯åœ¨é”çš„å†…éƒ¨ï¼ŒåŒæ ·åœ¨é”çš„å†…éƒ¨å¯¹è®¡æ•°å™¨ count åšæ›´æ–°ï¼Œä¹Ÿä¿è¯äº†åŸå­æ€§ doWait æ–¹æ³•ä¸­ï¼Œæ˜¯é€šè¿‡ nextGeneration æ–¹æ³•æ¥é‡æ–°åˆå§‹åŒ–/é‡ç½® CyclicBarrier çŠ¶æ€çš„ï¼Œè¯¥ç±»ä¸­è¿˜æœ‰ä¸€ä¸ª reset() æ–¹æ³•ï¼Œä¹Ÿæ˜¯é‡ç½® CyclicBarrier çŠ¶æ€çš„ 12345678910public void reset() &#123; final ReentrantLock lock = this.lock; lock.lock(); try &#123; breakBarrier(); // break the current generation nextGeneration(); // start a new generation &#125; finally &#123; lock.unlock(); &#125;&#125; ä½† reset() æ–¹æ³•å¹¶æ²¡æœ‰åœ¨ CyclicBarrier å†…éƒ¨è¢«è°ƒç”¨ï¼Œæ˜¾ç„¶æ˜¯ç»™ CyclicBarrier ä½¿ç”¨è€…æ¥è°ƒç”¨çš„ï¼Œé‚£é—®é¢˜æ¥äº† ä»€ä¹ˆæ—¶å€™è°ƒç”¨ reset() æ–¹æ³•å‘¢ æ­£å¸¸æƒ…å†µä¸‹ï¼ŒCyclicBarrier æ˜¯ä¼šè¢«è‡ªåŠ¨é‡ç½®çŠ¶æ€çš„ï¼Œä» reset çš„æ–¹æ³•å®ç°ä¸­å¯ä»¥çœ‹å‡ºè°ƒç”¨äº† breakBarrier æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒç”¨ reset ä¼šä½¿å½“å‰å¤„åœ¨ç­‰å¾…ä¸­çš„çº¿ç¨‹æœ€ç»ˆæŠ›å‡º BrokenBarrierException å¹¶ç«‹å³è¢«å”¤é†’ï¼Œæ‰€ä»¥è¯´ reset() åªä¼šåœ¨ä½ æƒ³æ‰“ç ´å±éšœæ—¶æ‰ä¼šä½¿ç”¨ ä¸Šè¿°ç¤ºä¾‹ï¼Œæˆ‘ä»¬æ„å»º CyclicBarrier å¯¹è±¡æ—¶ï¼Œå¹¶æ²¡æœ‰ä¼ é€’ barrierCommand å¯¹è±¡ï¼Œ æˆ‘ä»¬ä¿®æ”¹ç¤ºä¾‹ä¼ å…¥ä¸€ä¸ª barrierCommand å¯¹è±¡ï¼Œçœ‹çœ‹ä¼šæœ‰ä»€ä¹ˆç»“æœï¼š 1234// åˆ›å»º CyclicBarrier å®ä¾‹ï¼Œè®¡æ•°å™¨çš„å€¼è®¾ç½®ä¸º2private static CyclicBarrier cyclicBarrier = new CyclicBarrier(2, () -&gt; &#123; log.info(\"å…¨éƒ¨è¿è¡Œç»“æŸ\");&#125;); è¿è¡Œç»“æœï¼š ä»è¿è¡Œç»“æœä¸­æ¥çœ‹ï¼Œæ¯æ¬¡å†²ç ´å±éšœåéƒ½ä¼šæ‰§è¡Œ CyclicBarrier åˆå§‹åŒ– barrierCommand çš„æ–¹æ³•ï¼Œ è¿™ä¸æˆ‘ä»¬å¯¹ doWait() æ–¹æ³•çš„åˆ†æå®Œå…¨å»åˆï¼Œä»ä¸Šé¢çš„è¿è¡Œç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œæœ€åä¸€ä¸ªçº¿ç¨‹æ˜¯è¿è¡Œ barrierCommand run() æ–¹æ³•çš„çº¿ç¨‹ï¼Œæˆ‘ä»¬å†æ¥å½¢è±¡åŒ–çš„å±•ç¤ºä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒbarrierAction ä¸æ¯æ¬¡çªç ´å±éšœæ˜¯ä¸²è¡ŒåŒ–çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå‡å¦‚ barrierAction æ˜¯å¾ˆè€—æ—¶çš„æ±‡æ€»æ“ä½œï¼Œé‚£è¿™å°±æ˜¯å¯ä»¥ä¼˜åŒ–çš„ç‚¹äº†ï¼Œæˆ‘ä»¬ç»§ç»­ä¿®æ”¹ä»£ç  12345678910111213141516// åˆ›å»ºå•çº¿ç¨‹çº¿ç¨‹æ± private static Executor executor = Executors.newSingleThreadExecutor();// åˆ›å»º CyclicBarrier å®ä¾‹ï¼Œè®¡æ•°å™¨çš„å€¼è®¾ç½®ä¸º2private static CyclicBarrier cyclicBarrier = new CyclicBarrier(2, () -&gt; &#123; executor.execute(() -&gt; gather());&#125;);private static void gather() &#123; try &#123; Thread.sleep(2000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; log.info(\"å…¨éƒ¨è¿è¡Œç»“æŸ\");&#125; æˆ‘ä»¬è¿™é‡Œå°† CyclicBarrier çš„å›è°ƒå‡½æ•° barrierActionä½¿ç”¨å•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œè¿™æ ·æœ€åä¸€ä¸ªå†²ç ´å±éšœçš„çº¿ç¨‹å°±ä¸ç”¨ç­‰å¾… barrierAction çš„æ‰§è¡Œï¼Œç›´æ¥åˆ†é…ä¸ªçº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹å¼‚æ­¥æ‰§è¡Œï¼Œè¿›ä¸€æ­¥æå‡æ•ˆç‡ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š æˆ‘ä»¬å†å½¢è±¡åŒ–çš„çœ‹ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼š è¿™é‡Œä½¿ç”¨äº†å•ä¸€çº¿ç¨‹æ± ï¼Œå¢åŠ äº†å¹¶è¡Œæ“ä½œï¼Œæé«˜äº†ç¨‹åºè¿è¡Œæ•ˆç‡ï¼Œé‚£é—®é¢˜æ¥äº†ï¼š å¦‚æœ barrierAction éå¸¸éå¸¸è€—æ—¶ï¼Œå†²ç ´å±éšœçš„ä»»åŠ¡å°±å¯èƒ½å †ç§¯åœ¨å•ä¸€çº¿ç¨‹æ± çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œå°±å­˜åœ¨ OOM çš„é£é™©ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™æ˜¯å°±è¦éœ€è¦ä¸€å®šçš„é™æµç­–ç•¥æˆ–è€…ä½¿ç”¨çº¿ç¨‹æ± çš„æ‹’ç»çš„ç•¥ç­‰ é‚£æŠŠå•ä¸€çº¿ç¨‹æ± æ¢æˆéå•ä¸€çš„å›ºå®šçº¿ç¨‹æ± ä¸å°±å¯ä»¥äº†å˜›ï¼Ÿæ¯”å¦‚ fixed(5) ä¹ä¸€çœ‹ç¡®å®èƒ½ç¼“è§£å•çº¿ç¨‹æ± å¯èƒ½å¼•èµ·çš„ä»»åŠ¡å †ç§¯é—®é¢˜ï¼Œä¸Šé¢ä»£ç æˆ‘ä»¬çœ‹åˆ°çš„ gather() æ–¹æ³•ï¼Œå‡å¦‚è¯¥æ–¹æ³•å†…éƒ¨æ²¡æœ‰ä½¿ç”¨é”æˆ–è€…è¯´å­˜åœ¨ç«Ÿæ€æ¡ä»¶ï¼Œé‚£ CyclicBarrier çš„å›è°ƒå‡½æ•° barrierAction ä½¿ç”¨å¤šçº¿ç¨‹å¿…å®šå¼•èµ·ç»“æœçš„ä¸å‡†ç¡® æ‰€ä»¥åœ¨å®é™…ä½¿ç”¨ä¸­è¿˜è¦ç»“åˆå…·ä½“çš„ä¸šåŠ¡åœºæ™¯ä¸æ–­ä¼˜åŒ–ä»£ç ï¼Œä½¿ä¹‹æ›´åŠ å¥å£® æ€»ç»“æœ¬æ–‡è®²è§£äº† CountDownLatch å’Œ CyclicBarrier çš„ç»å…¸ä½¿ç”¨åœºæ™¯ä»¥åŠå®ç°åŸç†ï¼Œä»¥åŠåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼Œæ¯”å¦‚å°†å¤§çš„ list æ‹†åˆ†ä½œä¸šå°±å¯ä»¥ç”¨åˆ°å‰è€…ï¼Œè¯»å–å¤šä¸ª Excel çš„sheet é¡µï¼Œæœ€åè¿›è¡Œç»“æœæ±‡æ€»å°±å¯ä»¥ç”¨åˆ°åè€… ï¼ˆæ–‡ä¸­å®Œæ•´ç¤ºä¾‹ä»£ç å·²ä¸Šä¼ ï¼‰ æœ€åï¼Œå†å½¢è±¡åŒ–çš„æ¯”å–»ä¸€ä¸‹ CountDownLatch ä¸»è¦ç”¨æ¥è§£å†³ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¤šä¸ªçº¿ç¨‹çš„åœºæ™¯ï¼Œå¯ä»¥ç±»æ¯”æ—…æ¸¸å›¢å›¢é•¿è¦ç­‰å¾…æ‰€æœ‰æ¸¸å®¢åˆ°é½æ‰èƒ½å»ä¸‹ä¸€ä¸ªæ™¯ç‚¹ è€Œ CyclicBarrier æ˜¯ä¸€ç»„çº¿ç¨‹ä¹‹é—´çš„ç›¸äº’ç­‰å¾…ï¼Œå¯ä»¥ç±»æ¯”å‡ ä¸ªé©´å‹ä¹‹é—´çš„ä¸ç¦»ä¸å¼ƒï¼Œå…±åŒåˆ°è¾¾æŸä¸ªåœ°æ–¹ï¼Œå†ç»§ç»­å‡ºå‘ï¼Œè¿™æ ·åå¤ çµé­‚è¿½é—® æ€æ ·æ‹¿åˆ° CyclicBarrier çš„æ±‡æ€»ç»“æœå‘¢ï¼Ÿ çº¿ç¨‹æ± ä¸­çš„ Future ç‰¹æ€§ä½ æœ‰ä½¿ç”¨è¿‡å—ï¼Ÿ æ¥ä¸‹æ¥ï¼Œå’±ä»¬å°±èŠèŠé‚£äº›å¯ä»¥ä½¿ç”¨çš„ Future ç‰¹æ€§ å‚è€ƒ Java å¹¶å‘ç¼–ç¨‹å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ Java å¹¶å‘ç¼–ç¨‹ä¹‹ç¾ When to reset CyclicBarrier in java multithreading","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"Github UI å¸ƒå±€è®¾è®¡æ›´æ–°äº†ï¼Œä½ å‘ç°äº†å—ï¼Ÿ","slug":"Github-UI-å¸ƒå±€è®¾è®¡æ›´æ–°äº†ï¼Œä½ å‘ç°äº†å—ï¼Ÿ","date":"2020-06-24T08:10:04.000Z","updated":"2020-06-24T08:13:24.997Z","comments":true,"path":"/p/github-new-ui.html","link":"","permalink":"https://dayarch.top/p/github-new-ui.html","excerpt":"è¯ä¸å¤šè¯´ï¼Œå…ˆçœ‹å›¾ï¼Œä½ ä¸€çœ¼åº”è¯¥å°±èƒ½çœ‹å‡ºå˜åŒ–äº† Github ä¸»è¦å¯¹ UI è®¾è®¡ä»¥åŠ Repository å¸ƒå±€è¿›è¡Œäº†æ›´æ–°ï¼Œæ”¹å–„äº†è®¿é—®å’Œç»´æŠ¤ Repository çš„ä½“éªŒï¼Œå…¶å®ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹æ›´æ–°ï¼š 1. å“åº”å¼çš„å¸ƒå±€ä»¥åŠæ”¹è¿›äº†ç§»åŠ¨ç«¯ Web çš„ä½“éªŒ 2. é€šè¿‡ Repository ä¾§è¾¹æ æ˜¾ç¤ºæ›´å¤šå†…å®¹ 3. èƒ½å¤Ÿåœ¨ Repository ä¾§è¾¹æ ç°å®/éšè— Release ç‰ˆæœ¬ä»¥åŠ Packages å’Œ Environments ç›®å‰æ•´ä½“æ”¹åŠ¨è™½ç„¶ä¸å¤§ï¼Œä½†è¿™äº›æ›´æ”¹ä¼šä¸ºå°†æ¥çš„æ¸è¿›å¼æ”¹è¿›å¥ å®šåŸºç¡€ï¼Œæ¥ä¸‹æ¥ä¹Ÿä¼šæ¨å‡ºæš—é»‘æ¨¡å¼ç­‰å†…å®¹ é¡ºä¾¿è¦è¯´ä¸€ä¸‹ï¼Œæµè§ˆ Github å¿…é¡»è¦æœ‰çš„ç¥å™¨ O","text":"è¯ä¸å¤šè¯´ï¼Œå…ˆçœ‹å›¾ï¼Œä½ ä¸€çœ¼åº”è¯¥å°±èƒ½çœ‹å‡ºå˜åŒ–äº† Github ä¸»è¦å¯¹ UI è®¾è®¡ä»¥åŠ Repository å¸ƒå±€è¿›è¡Œäº†æ›´æ–°ï¼Œæ”¹å–„äº†è®¿é—®å’Œç»´æŠ¤ Repository çš„ä½“éªŒï¼Œå…¶å®ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹æ›´æ–°ï¼š å“åº”å¼çš„å¸ƒå±€ä»¥åŠæ”¹è¿›äº†ç§»åŠ¨ç«¯ Web çš„ä½“éªŒ é€šè¿‡ Repository ä¾§è¾¹æ æ˜¾ç¤ºæ›´å¤šå†…å®¹ èƒ½å¤Ÿåœ¨ Repository ä¾§è¾¹æ ç°å®/éšè— Release ç‰ˆæœ¬ä»¥åŠ Packages å’Œ Environments ç›®å‰æ•´ä½“æ”¹åŠ¨è™½ç„¶ä¸å¤§ï¼Œä½†è¿™äº›æ›´æ”¹ä¼šä¸ºå°†æ¥çš„æ¸è¿›å¼æ”¹è¿›å¥ å®šåŸºç¡€ï¼Œæ¥ä¸‹æ¥ä¹Ÿä¼šæ¨å‡ºæš—é»‘æ¨¡å¼ç­‰å†…å®¹ é¡ºä¾¿è¦è¯´ä¸€ä¸‹ï¼Œæµè§ˆ Github å¿…é¡»è¦æœ‰çš„ç¥å™¨ Octotree ï¼ˆä¸€æ¬¾ Chrome æ’ä»¶ https://www.octotree.io/ ï¼‰ï¼Œé€šè¿‡è¯¥æ’ä»¶å¯ä»¥å¿«é€Ÿæµè§ˆæŸä¸ª Repository çš„ç»“æ„ä»¥åŠåšåˆ°å¿«é€Ÿè·³è½¬ï¼Œè¯¥æ’ä»¶åŒæ ·æ”¯æŒæš—é»‘æ¨¡å¼ å¸¦ç€è¿™ä¸ªæ’ä»¶å»ä½“éªŒä¸€ä¸‹æ–°ç‰ˆ Github å§ å®˜åšï¼šhttps://github.blog/changelog/2020-06-23-design-updates-to-repositories-and-github-ui/","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Others","slug":"Coding/Others","permalink":"https://dayarch.top/categories/Coding/Others/"}],"tags":[{"name":"Github","slug":"Github","permalink":"https://dayarch.top/tags/Github/"}]},{"title":"æå®šReentrantReadWriteLock å‡ é“å°å°æ•°å­¦é¢˜å°±å¤Ÿäº†","slug":"æå®šReentrantReadWriteLock-å‡ ä¸ªå°å°æ•°å­¦é¢˜å°±å¤Ÿäº†","date":"2020-06-21T11:20:28.000Z","updated":"2020-06-24T08:12:56.938Z","comments":true,"path":"/p/java-reentrant-read-write-lock.html","link":"","permalink":"https://dayarch.top/p/java-reentrant-read-write-lock.html","excerpt":"å‰è¨€ * æ–‡ç«  Java AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨ ä»‹ç»äº†AQSç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„å®ç°ï¼Œå¹¶ä»¥ ReentrantLock ä¸ºä¾‹è¯´æ˜å…¶æ˜¯å¦‚ä½•è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°äº’æ–¥é”çš„ * æ–‡ç«  Java AQSå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€åŠSemaphoreçš„åº”ç”¨åˆ†æ ä»‹ç» AQS å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„å®ç°ï¼Œå¹¶è¯´æ˜äº† Semaphore æ˜¯å¦‚ä½•è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°ç®€å•é™æµä½œç”¨çš„ æœ‰äº†ä»¥ä¸Šä¸¤ç¯‡æ–‡ç« çš„é“ºå«ï¼Œæ¥ç†è§£æœ¬æ–‡è¦ä»‹ç»çš„æ—¢æœ‰ç‹¬å å¼ï¼Œåˆæœ‰å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„ ReadWriteLockï¼Œå°±éå¸¸è½»æ¾äº† ReadWriteLock ReadWriteLock ç›´è¯‘è¿‡æ¥ä¸ºã€è¯»å†™é”ã€‘ã€‚ç°å®ä¸­ï¼Œè¯»","text":"å‰è¨€ æ–‡ç«  Java AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨ ä»‹ç»äº†AQSç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„å®ç°ï¼Œå¹¶ä»¥ ReentrantLock ä¸ºä¾‹è¯´æ˜å…¶æ˜¯å¦‚ä½•è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°äº’æ–¥é”çš„ æ–‡ç«  Java AQSå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€åŠSemaphoreçš„åº”ç”¨åˆ†æ ä»‹ç» AQS å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„å®ç°ï¼Œå¹¶è¯´æ˜äº† Semaphore æ˜¯å¦‚ä½•è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°ç®€å•é™æµä½œç”¨çš„ æœ‰äº†ä»¥ä¸Šä¸¤ç¯‡æ–‡ç« çš„é“ºå«ï¼Œæ¥ç†è§£æœ¬æ–‡è¦ä»‹ç»çš„æ—¢æœ‰ç‹¬å å¼ï¼Œåˆæœ‰å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„ ReadWriteLockï¼Œå°±éå¸¸è½»æ¾äº† ReadWriteLockReadWriteLock ç›´è¯‘è¿‡æ¥ä¸ºã€è¯»å†™é”ã€‘ã€‚ç°å®ä¸­ï¼Œè¯»å¤šå†™å°‘çš„ä¸šåŠ¡åœºæ™¯æ˜¯éå¸¸æ™®éçš„ï¼Œæ¯”å¦‚åº”ç”¨ç¼“å­˜ ä¸€ä¸ªçº¿ç¨‹å°†æ•°æ®å†™å…¥ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥ç›´æ¥è¯»å–ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œæé«˜æ•°æ®æŸ¥è¯¢æ•ˆç‡ ä¹‹å‰æåˆ°çš„äº’æ–¥é”éƒ½æ˜¯æ’ä»–é”ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè®¿é—®ï¼Œå½“é¢å¯¹å¯å…±äº«è¯»çš„ä¸šåŠ¡åœºæ™¯ï¼Œäº’æ–¥é”æ˜¾ç„¶æ˜¯æ¯”è¾ƒä½æ•ˆçš„ä¸€ç§å¤„ç†æ–¹å¼ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¯»å†™é”æ¨¡å‹å°±è¯ç”Ÿäº† æ•ˆç‡æå‡æ˜¯ä¸€æ–¹é¢ï¼Œä½†å¹¶å‘ç¼–ç¨‹æ›´é‡è¦çš„æ˜¯åœ¨ä¿è¯å‡†ç¡®æ€§çš„å‰æä¸‹æé«˜æ•ˆç‡ ä¸€ä¸ªå†™çº¿ç¨‹æ”¹å˜äº†ç¼“å­˜ä¸­çš„å€¼ï¼Œå…¶ä»–è¯»çº¿ç¨‹ä¸€å®šæ˜¯å¯ä»¥ â€œæ„ŸçŸ¥â€ åˆ°çš„ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æŸ¥è¯¢åˆ°çš„å€¼ä¸å‡†ç¡® æ‰€ä»¥å…³äºè¯»å†™é”æ¨¡å‹å°±äº†ä¸‹é¢è¿™ 3 æ¡è§„å®šï¼š å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å…±äº«å˜é‡ åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å†™å…±äº«å˜é‡ å¦‚æœå†™çº¿ç¨‹æ­£åœ¨æ‰§è¡Œå†™æ“ä½œï¼Œæ­¤æ—¶åˆ™ç¦æ­¢å…¶ä»–è¯»çº¿ç¨‹è¯»å…±äº«å˜é‡ ReadWriteLock æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶å†…éƒ¨åªæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š 1234567public interface ReadWriteLock &#123; // è¿”å›ç”¨äºè¯»çš„é” Lock readLock(); // è¿”å›ç”¨äºå†™çš„é” Lock writeLock();&#125; æ‰€ä»¥è¦äº†è§£æ•´ä¸ªè¯»/å†™é”çš„æ•´ä¸ªåº”ç”¨è¿‡ç¨‹ï¼Œéœ€è¦ä»å®ƒçš„å®ç°ç±» ReentrantReadWriteLock è¯´èµ· ReentrantReadWriteLock ç±»ç»“æ„ç›´æ¥å¯¹æ¯”ReentrantReadWriteLock ä¸ ReentrantLockçš„ç±»ç»“æ„ ä»–ä»¬åˆå¾ˆç›¸ä¼¼å§ï¼Œæ ¹æ®ç±»åç§°ä»¥åŠç±»ç»“æ„ï¼ŒæŒ‰ç…§å’±ä»¬å‰åºæ–‡ç« çš„åˆ†æï¼Œä½ ä¹Ÿå°±èƒ½çœ‹å‡º ReentrantReadWriteLock çš„åŸºæœ¬ç‰¹æ€§ï¼š å…¶ä¸­é»„é¢œè‰²æ ‡è®°çš„çš„ é”é™çº§ æ˜¯çœ‹ä¸å‡ºæ¥çš„ï¼Œ è¿™é‡Œå…ˆæœ‰ä¸ªå°è±¡ï¼Œä¸‹é¢ä¼šå•ç‹¬è¯´æ˜ å¦å¤–ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦è¿˜è®°å¾—ï¼ŒJava AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨ è¯´è¿‡ï¼ŒLock å’Œ AQS åŒæ­¥å™¨æ˜¯ä¸€ç§ç»„åˆå½¢å¼çš„å­˜åœ¨ï¼Œæ—¢ç„¶è¿™é‡Œæ˜¯è¯»/å†™ä¸¤ç§é”ï¼Œä»–ä»¬çš„ç»„åˆæ¨¡å¼ä¹Ÿå°±åˆ†æˆäº†ä¸¤ç§ï¼š è¯»é”ä¸è‡ªå®šä¹‰åŒæ­¥å™¨çš„èšåˆ å†™é”ä¸è‡ªå®šä¹‰åŒæ­¥å™¨çš„èšåˆ 12345public ReentrantReadWriteLock(boolean fair) &#123; sync = fair ? new FairSync() : new NonfairSync(); readerLock = new ReadLock(this); writerLock = new WriteLock(this);&#125; è¿™é‡Œåªæ˜¯æé†’å¤§å®¶ï¼Œæ¨¡å¼æ²¡æœ‰å˜ï¼Œä¸è¦è¢«è¯»/å†™ä¸¤ç§é”è¿·æƒ‘ åŸºæœ¬ç¤ºä¾‹è¯´äº†è¿™ä¹ˆå¤šï¼Œå¦‚æœä½ å¿˜äº†å‰åºçŸ¥è¯†ï¼Œæ•´ä½“ç†è§£æ„Ÿè§‰åº”è¯¥æ˜¯æœ‰æ–­æ¡£çš„ï¼Œæ‰€ä»¥å…ˆæ¥çœ‹ä¸ªç¤ºä¾‹ï¼ˆæ¨¡æ‹Ÿä½¿ç”¨ç¼“å­˜ï¼‰è®©å¤§å®¶å¯¹ ReentrantReadWriteLock æœ‰ä¸ªç›´è§‚çš„ä½¿ç”¨å°è±¡ 1234567891011121314151617181920212223242526272829public class ReentrantReadWriteLockCache &#123; // å®šä¹‰ä¸€ä¸ªéçº¿ç¨‹å®‰å…¨çš„ HashMap ç”¨äºç¼“å­˜å¯¹è±¡ static Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;(); // åˆ›å»ºè¯»å†™é”å¯¹è±¡ static ReadWriteLock readWriteLock = new ReentrantReadWriteLock(); // æ„å»ºè¯»é” static Lock rl = readWriteLock.readLock(); // æ„å»ºå†™é” static Lock wl = readWriteLock.writeLock(); public static final Object get(String key) &#123; rl.lock(); try&#123; return map.get(key); &#125;finally &#123; rl.unlock(); &#125; &#125; public static final Object put(String key, Object value)&#123; wl.lock(); try&#123; return map.put(key, value); &#125;finally &#123; wl.unlock(); &#125; &#125;&#125; ä½ ç§ï¼Œä½¿ç”¨å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚ä½†æ˜¯ä½ çŸ¥é“çš„ï¼ŒAQS çš„æ ¸å¿ƒæ˜¯é”çš„å®ç°ï¼Œå³æ§åˆ¶åŒæ­¥çŠ¶æ€ state çš„å€¼ï¼ŒReentrantReadWriteLock ä¹Ÿæ˜¯åº”ç”¨AQSçš„ state æ¥æ§åˆ¶åŒæ­¥çŠ¶æ€çš„ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š ä¸€ä¸ª int ç±»å‹çš„ state æ€ä¹ˆæ—¢æ§åˆ¶è¯»çš„åŒæ­¥çŠ¶æ€ï¼Œåˆå¯ä»¥æ§åˆ¶å†™çš„åŒæ­¥çŠ¶æ€å‘¢ï¼Ÿ æ˜¾ç„¶éœ€è¦ä¸€ç‚¹è®¾è®¡äº† è¯»å†™çŠ¶æ€è®¾è®¡å¦‚æœè¦åœ¨ä¸€ä¸ª int ç±»å‹å˜é‡ä¸Šç»´æŠ¤å¤šä¸ªçŠ¶æ€ï¼Œé‚£è‚¯å®šå°±éœ€è¦æ‹†åˆ†äº†ã€‚æˆ‘ä»¬çŸ¥é“ int ç±»å‹æ•°æ®å 32ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æœ‰æœºä¼šæŒ‰ä½åˆ‡å‰²ä½¿ç”¨stateäº†ã€‚æˆ‘ä»¬å°†å…¶åˆ‡å‰²æˆä¸¤éƒ¨åˆ†ï¼š é«˜16ä½è¡¨ç¤ºè¯» ä½16ä½è¡¨ç¤ºå†™ æ‰€ä»¥ï¼Œè¦æƒ³å‡†ç¡®çš„è®¡ç®—è¯»/å†™å„è‡ªçš„çŠ¶æ€å€¼ï¼Œè‚¯å®šå°±è¦åº”ç”¨ä½è¿ç®—äº†ï¼Œä¸‹é¢ä»£ç æ˜¯ JDK1.8ï¼ŒReentrantReadWriteLock è‡ªå®šä¹‰åŒæ­¥å™¨ Sync çš„ä½æ“ä½œ 1234567891011121314151617abstract static class Sync extends AbstractQueuedSynchronizer &#123; static final int SHARED_SHIFT = 16; static final int SHARED_UNIT = (1 &lt;&lt; SHARED_SHIFT); static final int MAX_COUNT = (1 &lt;&lt; SHARED_SHIFT) - 1; static final int EXCLUSIVE_MASK = (1 &lt;&lt; SHARED_SHIFT) - 1; static int sharedCount(int c) &#123; return c &gt;&gt;&gt; SHARED_SHIFT; &#125; static int exclusiveCount(int c) &#123; return c &amp; EXCLUSIVE_MASK; &#125;&#125; ä¹ä¸€çœ‹çœŸæ˜¯æœ‰äº›å¤æ‚çš„å¯æ€•ï¼Œåˆ«æ…Œï¼Œå’±ä»¬é€šè¿‡å‡ é“å°å°æ•°å­¦é¢˜å°±å¯ä»¥æå®šæ•´ä¸ªä½è¿ç®—è¿‡ç¨‹ æ•´ä¸ª ReentrantReadWriteLock ä¸­ è¯»/å†™çŠ¶æ€çš„è®¡ç®—å°±æ˜¯åå¤åº”ç”¨è¿™å‡ é“æ•°å­¦é¢˜ï¼Œæ‰€ä»¥ï¼Œåœ¨é˜…è¯»ä¸‹é¢å†…å®¹ä¹‹å‰ï¼Œå¸Œæœ›ä½ ææ‡‚è¿™ç®€å•çš„è¿ç®— åŸºç¡€é“ºå«è¶³å¤Ÿäº†ï¼Œæˆ‘ä»¬è¿›å…¥æºç åˆ†æå§ æºç åˆ†æå†™é”åˆ†æç”±äºå†™é”æ˜¯æ’ä»–çš„ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯è¦é‡å†™ AQS ä¸­ tryAcquire æ–¹æ³• 123456789101112131415161718192021222324protected final boolean tryAcquire(int acquires) &#123; Thread current = Thread.currentThread(); // è·å– state æ•´ä½“çš„å€¼ int c = getState(); // è·å–å†™çŠ¶æ€çš„å€¼ int w = exclusiveCount(c); if (c != 0) &#123; // w=0: æ ¹æ®æ¨ç†äºŒï¼Œæ•´ä½“çŠ¶æ€ä¸ç­‰äºé›¶ï¼Œå†™çŠ¶æ€ç­‰äºé›¶ï¼Œæ‰€ä»¥ï¼Œè¯»çŠ¶æ€å¤§äº0ï¼Œå³å­˜åœ¨è¯»é” // æˆ–è€…å½“å‰çº¿ç¨‹ä¸æ˜¯å·²è·å–å†™é”çš„çº¿ç¨‹ // äºŒè€…ä¹‹ä¸€æ¡ä»¶æˆçœŸï¼Œåˆ™è·å–å†™çŠ¶æ€å¤±è´¥ if (w == 0 || current != getExclusiveOwnerThread()) return false; if (w + exclusiveCount(acquires) &gt; MAX_COUNT) throw new Error(\"Maximum lock count exceeded\"); // æ ¹æ®æ¨ç†ä¸€ç¬¬ 1 æ¡ï¼Œæ›´æ–°å†™çŠ¶æ€å€¼ setState(c + acquires); return true; &#125; if (writerShouldBlock() || !compareAndSetState(c, c + acquires)) return false; setExclusiveOwnerThread(current); return true;&#125; ä¸Šè¿°ä»£ç  ç¬¬ 19 è¡Œ writerShouldBlock ä¹Ÿå¹¶æ²¡æœ‰ä»€ä¹ˆç¥ç§˜çš„ï¼Œåªä¸è¿‡æ˜¯å…¬å¹³/éå…¬å¹³è·å–é”æ–¹å¼çš„åˆ¤æ–­ï¼ˆæ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹æ¥åˆ¤æ–­ï¼‰ ä½ ç§ï¼Œå†™é”è·å–æ–¹å¼å°±æ˜¯è¿™ä¹ˆç®€å• è¯»é”åˆ†æç”±äºè¯»é”æ˜¯å…±äº«å¼çš„ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯è¦é‡å†™ AQS ä¸­ tryAcquireShared æ–¹æ³• 12345678910111213141516171819202122232425262728293031protected final int tryAcquireShared(int unused) &#123; Thread current = Thread.currentThread(); int c = getState(); // å†™çŠ¶æ€ä¸ç­‰äº0ï¼Œå¹¶ä¸”é”çš„æŒæœ‰è€…ä¸æ˜¯å½“å‰çº¿ç¨‹ï¼Œæ ¹æ®çº¦å®š 3ï¼Œåˆ™è·å–è¯»é”å¤±è´¥ if (exclusiveCount(c) != 0 &amp;&amp; getExclusiveOwnerThread() != current) return -1; // è·å–è¯»çŠ¶æ€å€¼ int r = sharedCount(c); // è¿™ä¸ªåœ°æ–¹æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬å•ç‹¬è¯´æ˜ if (!readerShouldBlock() &amp;&amp; r &lt; MAX_COUNT &amp;&amp; compareAndSetState(c, c + SHARED_UNIT)) &#123; if (r == 0) &#123; firstReader = current; firstReaderHoldCount = 1; &#125; else if (firstReader == current) &#123; firstReaderHoldCount++; &#125; else &#123; HoldCounter rh = cachedHoldCounter; if (rh == null || rh.tid != getThreadId(current)) cachedHoldCounter = rh = readHolds.get(); else if (rh.count == 0) readHolds.set(rh); rh.count++; &#125; return 1; &#125; // å¦‚æœè·å–è¯»é”å¤±è´¥åˆ™è¿›å…¥è‡ªæ—‹è·å– return fullTryAcquireShared(current);&#125; readerShouldBlock å’Œ writerShouldBlock åœ¨å…¬å¹³é”çš„å®ç°ä¸Šéƒ½æ˜¯åˆ¤æ–­æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹ï¼Œä½†æ˜¯åœ¨éå…¬å¹³é”çš„å®ç°ä¸Šï¼Œå‰è€…æ˜¯è¿™æ ·çš„ï¼š 12345678910111213final boolean readerShouldBlock() &#123; return apparentlyFirstQueuedIsExclusive();&#125;final boolean apparentlyFirstQueuedIsExclusive() &#123; Node h, s; return (h = head) != null &amp;&amp; // ç­‰å¾…é˜Ÿåˆ—å¤´èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ (s = h.next) != null &amp;&amp; // å¦‚æœæ˜¯æ’ä»–å¼çš„èŠ‚ç‚¹ !s.isShared() &amp;&amp; s.thread != null;&#125; ç®€å•æ¥è¯´ï¼Œå¦‚æœè¯·æ±‚è¯»é”çš„å½“å‰çº¿ç¨‹å‘ç°åŒæ­¥é˜Ÿåˆ—çš„ head èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ºæ’ä»–å¼èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±è¯´æ˜æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…è·å–å†™é”ï¼ˆäº‰æŠ¢å†™é”å¤±è´¥ï¼Œè¢«æ”¾å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ï¼‰ï¼Œé‚£ä¹ˆè¯·æ±‚è¯»é”çš„çº¿ç¨‹å°±è¦é˜»å¡ï¼Œæ¯•ç«Ÿè¯»å¤šå†™å°‘ï¼Œå¦‚æœè¿˜æ²¡æœ‰è¿™ç‚¹åˆ¤æ–­æœºåˆ¶ï¼Œå†™é”å¯èƒ½ä¼šå‘ç”Ÿã€é¥¥é¥¿ã€‘ ä¸Šè¿°æ¡ä»¶éƒ½æ»¡è¶³äº†ï¼Œä¹Ÿå°±ä¼šè¿›å…¥ tryAcquireShared ä»£ç çš„ç¬¬ 14 è¡Œåˆ°ç¬¬ 25 è¡Œï¼Œè¿™æ®µä»£ç ä¸»è¦æ˜¯ä¸ºäº†è®°å½•çº¿ç¨‹æŒæœ‰é”çš„æ¬¡æ•°ã€‚è¯»é”æ˜¯å…±äº«å¼çš„ï¼Œè¿˜æƒ³è®°å½•æ¯ä¸ªçº¿ç¨‹æŒæœ‰è¯»é”çš„æ¬¡æ•°ï¼Œå°±è¦ç”¨åˆ° ThreadLocal äº†ï¼Œå› ä¸ºè¿™ä¸å½±å“åŒæ­¥çŠ¶æ€ state çš„å€¼ï¼Œæ‰€ä»¥å°±ä¸åˆ†æäº†, åªæŠŠå…³ç³»æ”¾åœ¨è¿™å§ åˆ°è¿™é‡Œè¯»é”çš„è·å–ä¹Ÿå°±ç»“æŸäº†ï¼Œæ¯”å†™é”ç¨ç¨å¤æ‚é‚£ä¹ˆä¸€ä¸¢ä¸¢ï¼Œæ¥ä¸‹æ¥å°±è¯´æ˜ä¸€ä¸‹é‚£ä¸ªå¯èƒ½è®©ä½ è¿·æƒ‘çš„é”å‡çº§/é™çº§é—®é¢˜å§ è¯»å†™é”çš„å‡çº§ä¸é™çº§ä¸ªäººç†è§£ï¼šè¯»é”æ˜¯å¯ä»¥è¢«å¤šçº¿ç¨‹å…±äº«çš„ï¼Œå†™é”æ˜¯å•çº¿ç¨‹ç‹¬å çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å†™é”çš„å¹¶å‘é™åˆ¶æ¯”è¯»é”é«˜ï¼Œæ‰€ä»¥ åœ¨çœŸæ­£äº†è§£è¯»å†™é”çš„å‡çº§ä¸é™çº§ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®Œå–„ä¸€ä¸‹æœ¬æ–‡å¼€å¤´ ReentrantReadWriteLock çš„ä¾‹å­ 12345678910111213141516171819202122232425262728293031public static final Object get(String key) &#123; Object obj = null; rl.lock(); try&#123; // è·å–ç¼“å­˜ä¸­çš„å€¼ obj = map.get(key); &#125;finally &#123; rl.unlock(); &#125; // ç¼“å­˜ä¸­å€¼ä¸ä¸ºç©ºï¼Œç›´æ¥è¿”å› if (obj!= null) &#123; return obj; &#125; // ç¼“å­˜ä¸­å€¼ä¸ºç©ºï¼Œåˆ™é€šè¿‡å†™é”æŸ¥è¯¢DBï¼Œå¹¶å°†å…¶å†™å…¥åˆ°ç¼“å­˜ä¸­ wl.lock(); try&#123; // å†æ¬¡å°è¯•è·å–ç¼“å­˜ä¸­çš„å€¼ obj = map.get(key); // å†æ¬¡è·å–ç¼“å­˜ä¸­å€¼è¿˜æ˜¯ä¸ºç©º if (obj == null) &#123; // æŸ¥è¯¢DB obj = getDataFromDB(key); // ä¼ªä»£ç ï¼šgetDataFromDB // å°†å…¶æ”¾å…¥åˆ°ç¼“å­˜ä¸­ map.put(key, obj); &#125; &#125;finally &#123; wl.unlock(); &#125; return obj;&#125; æœ‰ç«¥é‹å¯èƒ½ä¼šæœ‰ç–‘é—® åœ¨å†™é”é‡Œé¢ï¼Œä¸ºä»€ä¹ˆä»£ç ç¬¬19è¡Œè¿˜è¦å†æ¬¡è·å–ç¼“å­˜ä¸­çš„å€¼å‘¢ï¼Ÿä¸æ˜¯å¤šæ­¤ä¸€ä¸¾å—ï¼Ÿ å…¶å®è¿™é‡Œå†æ¬¡å°è¯•è·å–ç¼“å­˜ä¸­çš„å€¼æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œ get æ–¹æ³•ï¼Œå¹¶ä¸”å‚æ•° key ä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œæ‰§è¡Œåˆ°ä»£ç ç¬¬ 16 è¡Œ wl.lock() ,æ¯”å¦‚è¿™æ ·ï¼š çº¿ç¨‹ Aï¼ŒBï¼ŒC åŒæ—¶æ‰§è¡Œåˆ°ä¸´ç•ŒåŒº wl.lock()ï¼Œ åªæœ‰çº¿ç¨‹ A è·å–å†™é”æˆåŠŸï¼Œçº¿ç¨‹Bï¼ŒCåªèƒ½é˜»å¡ï¼Œç›´åˆ°çº¿ç¨‹A é‡Šæ”¾å†™é”ã€‚è¿™æ—¶ï¼Œå½“çº¿ç¨‹B æˆ–è€… C å†æ¬¡è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œçº¿ç¨‹ A å·²ç»å°†å€¼æ›´æ–°åˆ°ç¼“å­˜ä¸­äº†ï¼Œæ‰€ä»¥çº¿ç¨‹Bï¼ŒCæ²¡å¿…è¦å†æŸ¥è¯¢ä¸€æ¬¡DBï¼Œè€Œæ˜¯å†æ¬¡å°è¯•æŸ¥è¯¢ç¼“å­˜ä¸­çš„å€¼ æ—¢ç„¶å†æ¬¡è·å–ç¼“å­˜å¾ˆæœ‰å¿…è¦ï¼Œæˆ‘èƒ½å¦åœ¨è¯»é”é‡Œç›´æ¥åˆ¤æ–­ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰å€¼ï¼Œé‚£å°±å†æ¬¡è·å–å†™é”æ¥æŸ¥è¯¢DBä¸å°±å¯ä»¥äº†å˜›ï¼Œå°±åƒè¿™æ ·ï¼š 1234567891011121314151617181920212223public static final Object getLockUpgrade(String key) &#123; Object obj = null; rl.lock(); try&#123; obj = map.get(key); if (obj == null)&#123; wl.lock(); try&#123; obj = map.get(key); if (obj == null) &#123; obj = getDataFromDB(key); // ä¼ªä»£ç ï¼šgetDataFromDB map.put(key, obj); &#125; &#125;finally &#123; wl.unlock(); &#125; &#125; &#125;finally &#123; rl.unlock(); &#125; return obj;&#125; è¿™è¿˜çœŸæ˜¯ä¸å¯ä»¥çš„ï¼Œå› ä¸ºè·å–ä¸€ä¸ªå†™å…¥é”éœ€è¦å…ˆé‡Šæ”¾æ‰€æœ‰çš„è¯»å–é”ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªè¯»å–é”è¯•å›¾è·å–å†™å…¥é”ï¼Œä¸”éƒ½ä¸é‡Šæ”¾è¯»å–é”æ—¶ï¼Œå°±ä¼šå‘ç”Ÿæ­»é”ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œé”çš„å‡çº§æ˜¯ä¸è¢«å…è®¸çš„ è¯»å†™é”çš„å‡çº§æ˜¯ä¸å¯ä»¥çš„ï¼Œé‚£ä¹ˆé”çš„é™çº§æ˜¯å¯ä»¥çš„å˜›ï¼Ÿè¿™ä¸ªæ˜¯ Oracle å®˜ç½‘å…³äºé”é™çº§çš„ç¤ºä¾‹ ï¼Œæˆ‘å°†ä»£ç ç²˜è´´åœ¨æ­¤å¤„ï¼Œå¤§å®¶æœ‰å…´è¶£å¯ä»¥ç‚¹è¿›å»è¿æ¥çœ‹æ›´å¤šå†…å®¹ 1234567891011121314151617181920212223242526272829303132class CachedData &#123; Object data; volatile boolean cacheValid; final ReentrantReadWriteLock rwl = new ReentrantReadWriteLock(); void processCachedData() &#123; rwl.readLock().lock(); if (!cacheValid) &#123; // å¿…é¡»åœ¨è·å–å†™é”ä¹‹å‰é‡Šæ”¾è¯»é”ï¼Œå› ä¸ºé”çš„å‡çº§æ˜¯ä¸è¢«å…è®¸çš„ rwl.readLock().unlock(); rwl.writeLock().lock(); try &#123; // å†æ¬¡æ£€æŸ¥ï¼ŒåŸå› å¯èƒ½æ˜¯å…¶ä»–çº¿ç¨‹å·²ç»æ›´æ–°è¿‡ç¼“å­˜ if (!cacheValid) &#123; data = ... cacheValid = true; &#125; //åœ¨é‡Šæ”¾å†™é”å‰ï¼Œé™çº§ä¸ºè¯»é” rwl.readLock().lock(); &#125; finally &#123; //é‡Šæ”¾å†™é”ï¼Œæ­¤æ—¶æŒæœ‰è¯»é” rwl.writeLock().unlock(); &#125; &#125; try &#123; use(data); &#125; finally &#123; rwl.readLock().unlock(); &#125; &#125;&#125; ä»£ç ä¸­å£°æ˜äº†ä¸€ä¸ª volatile ç±»å‹çš„ cacheValid å˜é‡ï¼Œä¿è¯å…¶å¯è§æ€§ã€‚ é¦–å…ˆè·å–è¯»é”ï¼Œå¦‚æœcacheä¸å¯ç”¨ï¼Œåˆ™é‡Šæ”¾è¯»é” ç„¶åè·å–å†™é” åœ¨æ›´æ”¹æ•°æ®ä¹‹å‰ï¼Œå†æ£€æŸ¥ä¸€æ¬¡cacheValidçš„å€¼ï¼Œç„¶åä¿®æ”¹æ•°æ®ï¼Œå°†cacheValidç½®ä¸ºtrue ç„¶ååœ¨é‡Šæ”¾å†™é”å‰è·å–è¯»é” æ­¤æ—¶ cacheä¸­æ•°æ®å¯ç”¨ï¼Œå¤„ç†cacheä¸­æ•°æ®ï¼Œæœ€åé‡Šæ”¾è¯»é” è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„é”é™çº§çš„è¿‡ç¨‹ï¼Œç›®çš„æ˜¯ä¿è¯æ•°æ®å¯è§æ€§ï¼Œå¬èµ·æ¥å¾ˆæœ‰é“ç†çš„æ ·å­ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š ä¸Šè¿°ä»£ç ä¸ºä»€ä¹ˆåœ¨é‡Šæ”¾å†™é”ä¹‹å‰è¦è·å–è¯»é”å‘¢ï¼Ÿ å¦‚æœå½“å‰çš„çº¿ç¨‹Aåœ¨ä¿®æ”¹å®Œcacheä¸­çš„æ•°æ®åï¼Œæ²¡æœ‰è·å–è¯»é”è€Œæ˜¯ç›´æ¥é‡Šæ”¾äº†å†™é”ï¼›å‡è®¾æ­¤æ—¶å¦ä¸€ä¸ªçº¿ç¨‹B è·å–äº†å†™é”å¹¶ä¿®æ”¹äº†æ•°æ®ï¼Œé‚£ä¹ˆçº¿ç¨‹Aæ— æ³•æ„ŸçŸ¥åˆ°æ•°æ®å·²è¢«ä¿®æ”¹ï¼Œä½†çº¿ç¨‹Aè¿˜åº”ç”¨äº†ç¼“å­˜æ•°æ®ï¼Œæ‰€ä»¥å°±å¯èƒ½å‡ºç°æ•°æ®é”™è¯¯ å¦‚æœéµå¾ªé”é™çº§çš„æ­¥éª¤ï¼Œçº¿ç¨‹A åœ¨é‡Šæ”¾å†™é”ä¹‹å‰è·å–è¯»é”ï¼Œé‚£ä¹ˆçº¿ç¨‹Båœ¨è·å–å†™é”æ—¶å°†è¢«é˜»å¡ï¼Œç›´åˆ°çº¿ç¨‹Aå®Œæˆæ•°æ®å¤„ç†è¿‡ç¨‹ï¼Œé‡Šæ”¾è¯»é”ï¼Œä»è€Œä¿è¯æ•°æ®çš„å¯è§æ€§ é‚£é—®é¢˜åˆæ¥äº†ï¼š ä½¿ç”¨å†™é”ä¸€å®šè¦é™çº§å—ï¼Ÿ å¦‚æœä½ ç†è§£äº†ä¸Šé¢çš„é—®é¢˜ï¼Œç›¸ä¿¡è¿™ä¸ªé—®é¢˜å·²ç»æœ‰äº†ç­”æ¡ˆã€‚å‡å¦‚çº¿ç¨‹Aä¿®æ”¹å®Œæ•°æ®ä¹‹åï¼Œ ç»è¿‡è€—æ—¶æ“ä½œåæƒ³è¦å†ä½¿ç”¨æ•°æ®æ—¶ï¼Œå¸Œæœ›ä½¿ç”¨çš„æ˜¯è‡ªå·±ä¿®æ”¹åçš„æ•°æ®ï¼Œè€Œä¸æ˜¯å…¶ä»–çº¿ç¨‹ä¿®æ”¹åçš„æ•°æ®ï¼Œè¿™æ ·çš„è¯ç¡®å®æ˜¯éœ€è¦é”é™çº§ï¼›å¦‚æœåªæ˜¯å¸Œæœ›æœ€åä½¿ç”¨æ•°æ®çš„æ—¶å€™ï¼Œæ‹¿åˆ°çš„æ˜¯æœ€æ–°çš„æ•°æ®ï¼Œè€Œä¸ä¸€å®šæ˜¯è‡ªå·±åˆšä¿®æ”¹è¿‡çš„æ•°æ®ï¼Œé‚£ä¹ˆå…ˆé‡Šæ”¾å†™é”ï¼Œå†è·å–è¯»é”ï¼Œç„¶åä½¿ç”¨æ•°æ®ä¹Ÿæ— å¦¨ åœ¨è¿™é‡Œæˆ‘è¦é¢å¤–è¯´æ˜ä¸€ä¸‹ä½ å¯èƒ½å­˜åœ¨çš„è¯¯è§£ï¼š å¦‚æœå·²ç»é‡Šæ”¾äº†è¯»é”å†è·å–å†™é”ä¸å«é”çš„å‡çº§ å¦‚æœå·²ç»é‡Šæ”¾äº†å†™é”åœ¨è·å–è¯»é”ä¹Ÿä¸å«é”çš„é™çº§ ç›¸ä¿¡ä½ åˆ°è¿™é‡Œä¹Ÿç†è§£äº†é”çš„å‡çº§ä¸é™çº§è¿‡ç¨‹ï¼Œä»¥åŠä»–ä»¬è¢«å…è®¸æˆ–è¢«ç¦æ­¢çš„åŸå› äº† æ€»ç»“æœ¬æ–‡ä¸»è¦è¯´æ˜äº† ReentrantReadWriteLock æ˜¯å¦‚ä½•åº”ç”¨ state åšä½æ‹†åˆ†å®ç°è¯»/å†™ä¸¤ç§åŒæ­¥çŠ¶æ€çš„ï¼Œå¦å¤–ä¹Ÿé€šè¿‡æºç åˆ†æäº†è¯»/å†™é”è·å–åŒæ­¥çŠ¶æ€çš„è¿‡ç¨‹ï¼Œæœ€ååˆäº†è§£äº†è¯»å†™é”çš„å‡çº§/é™çº§æœºåˆ¶ï¼Œç›¸ä¿¡åˆ°è¿™é‡Œä½ å¯¹è¯»å†™é”å·²ç»æœ‰äº†ä¸€å®šçš„ç†è§£ã€‚å¦‚æœä½ å¯¹æ–‡ä¸­çš„å“ªäº›åœ°æ–¹è§‰å¾—ç†è§£æœ‰äº›å›°éš¾ï¼Œå¼ºçƒˆå»ºè®®ä½ å›çœ‹æœ¬æ–‡å¼€å¤´çš„ä¸¤ç¯‡æ–‡ç« ï¼Œé‚£é‡Œé“ºå«äº†éå¸¸å¤šçš„å†…å®¹ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±çœ‹çœ‹åœ¨åº”ç”¨AQSçš„æœ€åä¸€ä¸ªå¹¶å‘å·¥å…·ç±» CountDownLatch å§ çµé­‚è¿½é—® è¯»é”ä¹Ÿæ²¡ä¿®æ”¹æ•°æ®ï¼Œè¿˜å…è®¸å…±äº«å¼è·å–ï¼Œé‚£è¿˜æœ‰å¿…è¦è®¾ç½®è¯»é”å—ï¼Ÿ åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œä½ æ˜¯å¦‚ä½•ä¿è¯ç¼“å­˜æ•°æ®ä¸€è‡´æ€§çš„å‘¢ï¼Ÿ å½“ä½ æ‰“å¼€çœ‹ReentrantReadWriteLockæºç æ—¶ï¼Œä½ ä¼šå‘ç°ï¼ŒWriteLock ä¸­å¯ä»¥ä½¿ç”¨ Conditionï¼Œä½†æ˜¯ReadLock ä½¿ç”¨Conditionå´ä¼šæŠ›å‡ºUnsupportedOperationExceptionï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ 123456789// WriteLockpublic Condition newCondition() &#123; return sync.newCondition();&#125;// ReadLockpublic Condition newCondition() &#123; throw new UnsupportedOperationException();&#125; å‚è€ƒ Java å¹¶å‘å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ https://www.jianshu.com/p/58697bb2243e","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"Java AQSå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€åŠSemaphoreçš„åº”ç”¨åˆ†æ","slug":"AQSå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€åŠSemaphoreçš„åº”ç”¨åˆ†æ","date":"2020-06-13T07:05:28.000Z","updated":"2020-06-14T04:23:39.525Z","comments":true,"path":"/p/java-aqs-acquireshared-and-semaphore.html","link":"","permalink":"https://dayarch.top/p/java-aqs-acquireshared-and-semaphore.html","excerpt":"ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ çœ‹åˆ°æœ¬æœŸå†…å®¹è¿™ä¹ˆå°‘ï¼Œæ˜¯ä¸æ˜¯å¿ƒåŠ¨äº†å‘¢ï¼Ÿ å‰è¨€ ä¸Šä¸€ç¯‡ä¸‡å­—é•¿æ–‡ Java AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨ ä¸ºæˆ‘ä»¬è¯» JUC æºç ä»¥åŠå…¶è®¾è®¡æ€æƒ³åšäº†è¶³å¤Ÿå¤šçš„é“ºå«ï¼Œæ¥ä¸‹æ¥çš„å†…å®¹æˆ‘å°†é‡ç‚¹è¯´æ˜å·®å¼‚åŒ–ï¼Œå¦‚æœæœ‰äº›ç«¥é‹ä¸æ˜¯èƒ½å¾ˆå¥½çš„ç†è§£æ–‡ä¸­çš„ä¸€äº›å†…å®¹ï¼Œå¼ºçƒˆå»ºè®®å›çœ‹ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œææ‡‚åŸºç¡€å†…å®¹ï¼Œæ¥ä¸‹æ¥çš„é˜…è¯»çœŸä¼šè½»æ¾åŠ æ„‰å¿« AQS ä¸­æˆ‘ä»¬ä»‹ç»äº†ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„å¤šç§æƒ…å½¢ï¼š * ç‹¬å å¼è·å–é” * å¯å“åº”ä¸­æ–­çš„ç‹¬å å¼è·å–é” * æœ‰è¶…æ—¶é™åˆ¶çš„ç‹¬å å¼è·","text":"ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ çœ‹åˆ°æœ¬æœŸå†…å®¹è¿™ä¹ˆå°‘ï¼Œæ˜¯ä¸æ˜¯å¿ƒåŠ¨äº†å‘¢ï¼Ÿ å‰è¨€ä¸Šä¸€ç¯‡ä¸‡å­—é•¿æ–‡ Java AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨ ä¸ºæˆ‘ä»¬è¯» JUC æºç ä»¥åŠå…¶è®¾è®¡æ€æƒ³åšäº†è¶³å¤Ÿå¤šçš„é“ºå«ï¼Œæ¥ä¸‹æ¥çš„å†…å®¹æˆ‘å°†é‡ç‚¹è¯´æ˜å·®å¼‚åŒ–ï¼Œå¦‚æœæœ‰äº›ç«¥é‹ä¸æ˜¯èƒ½å¾ˆå¥½çš„ç†è§£æ–‡ä¸­çš„ä¸€äº›å†…å®¹ï¼Œå¼ºçƒˆå»ºè®®å›çœ‹ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œææ‡‚åŸºç¡€å†…å®¹ï¼Œæ¥ä¸‹æ¥çš„é˜…è¯»çœŸä¼šè½»æ¾åŠ æ„‰å¿« AQS ä¸­æˆ‘ä»¬ä»‹ç»äº†ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„å¤šç§æƒ…å½¢ï¼š ç‹¬å å¼è·å–é” å¯å“åº”ä¸­æ–­çš„ç‹¬å å¼è·å–é” æœ‰è¶…æ—¶é™åˆ¶çš„ç‹¬å å¼è·å–é” AQS æä¾›çš„æ¨¡ç‰ˆæ–¹æ³•é‡Œé¢è¿˜å·®å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€æ²¡æœ‰ä»‹ç»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»Šå¤©æ¥æ­å¼€è¿™ä¸ªçœ‹ä¼¼ç¥ç§˜çš„é¢çº± AQS ä¸­çš„å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€ç‹¬å å¼æ˜¯ä½ ä¸­æ²¡æˆ‘ï¼Œæˆ‘ä¸­æ²¡ä½ çš„çš„ä¸€ç§äº’æ–¥å½¢å¼ï¼Œå…±äº«å¼æ˜¾ç„¶å°±ä¸æ˜¯è¿™æ ·äº†ï¼Œæ‰€ä»¥ä»–ä»¬çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯ï¼š åŒä¸€æ—¶åˆ»èƒ½å¦æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–åˆ°åŒæ­¥çŠ¶æ€ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¿™æ ·æ»´ï¼š æˆ‘ä»¬çŸ¥é“åŒæ­¥çŠ¶æ€ state æ˜¯ç»´æŠ¤åœ¨ AQS ä¸­çš„ï¼ŒæŠ›å¼€å¯é‡å…¥é”çš„æ¦‚å¿µï¼Œæˆ‘åœ¨ä¸Šç¯‡æ–‡ç« ä¸­ä¹Ÿæåˆ°äº†ï¼Œç‹¬å å¼å’Œå…±äº«å¼æ§åˆ¶åŒæ­¥çŠ¶æ€ state çš„åŒºåˆ«ä»…ä»…æ˜¯è¿™æ ·ï¼š æ‰€ä»¥è¯´æƒ³äº†è§£ AQS çš„ xxxShared çš„æ¨¡ç‰ˆæ–¹æ³•ï¼Œåªéœ€è¦çŸ¥é“å®ƒæ˜¯æ€ä¹ˆæ§åˆ¶ state çš„å°±å¥½äº† AQSå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€æºç åˆ†æä¸ºäº†å¸®åŠ©å¤§å®¶æ›´å¥½çš„å›å¿†å†…å®¹ï¼Œæˆ‘å°†ä¸Šä¸€ç¯‡æ–‡ç« çš„ä¸¤ä¸ªå…³é”®å†…å®¹ç²˜è´´åœ¨æ­¤å¤„ï¼Œå¸®åŠ©å¤§å®¶å¿«é€Ÿå›å¿†ï¼Œå…³äºå…±äº«å¼ï¼Œå¤§å®¶åªéœ€è¦å…³æ³¨ã€éªšç´«è‰²ã€‘å°±å¯ä»¥äº† è‡ªå®šä¹‰åŒæ­¥å™¨éœ€è¦é‡å†™çš„æ–¹æ³• AQS æä¾›çš„æ¨¡ç‰ˆæ–¹æ³• æ•…äº‹å°±ä»è¿™é‡Œè¯´èµ·å§ (ä½ ä¼šå‘ç°å’Œç‹¬å å¼æƒŠäººçš„ç›¸ä¼¼)ï¼Œå…³é”®ä»£ç éƒ½åŠ äº†æ³¨é‡Š 123456public final void acquireShared(int arg) &#123; // åŒæ ·è°ƒç”¨è‡ªå®šä¹‰åŒæ­¥å™¨éœ€è¦é‡å†™çš„æ–¹æ³•ï¼Œéé˜»å¡å¼çš„å°è¯•è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœç»“æœå°äºé›¶ï¼Œåˆ™è·å–åŒæ­¥çŠ¶æ€å¤±è´¥ if (tryAcquireShared(arg) &lt; 0) // è°ƒç”¨ AQS æä¾›çš„æ¨¡ç‰ˆæ–¹æ³•ï¼Œè¿›å…¥ç­‰å¾…é˜Ÿåˆ— doAcquireShared(arg);&#125; è¿›å…¥ doAcquireShared æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334private void doAcquireShared(int arg) &#123; // åˆ›å»ºå…±äº«èŠ‚ç‚¹ã€ŒSHAREDã€ï¼ŒåŠ åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ final Node node = addWaiter(Node.SHARED); boolean failed = true; try &#123; boolean interrupted = false; // è¿›å…¥â€œè‡ªæ—‹â€ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯çº¯ç²¹æ„ä¹‰ä¸Šçš„æ­»å¾ªç¯ï¼Œåœ¨ç‹¬å å¼å·²ç»è¯´æ˜è¿‡ for (;;) &#123; // åŒæ ·å°è¯•è·å–å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ final Node p = node.predecessor(); // å¦‚æœå‰é©±èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹ï¼Œå°è¯•å†æ¬¡è·å–åŒæ­¥çŠ¶æ€ if (p == head) &#123; // åœ¨æ­¤ä»¥éé˜»å¡å¼è·å–åŒæ­¥çŠ¶æ€ int r = tryAcquireShared(arg); // å¦‚æœè¿”å›ç»“æœå¤§äºç­‰äºé›¶ï¼Œæ‰èƒ½è·³å‡ºå¤–å±‚å¾ªç¯è¿”å› if (r &gt;= 0) &#123; // è¿™é‡Œæ˜¯å’Œç‹¬å å¼çš„åŒºåˆ« setHeadAndPropagate(node, r); p.next = null; // help GC if (interrupted) selfInterrupt(); failed = false; return; &#125; &#125; if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; parkAndCheckInterrupt()) interrupted = true; &#125; &#125; finally &#123; if (failed) cancelAcquire(node); &#125;&#125; ä¸Šé¢ä»£ç ç¬¬ 18 è¡Œæˆ‘ä»¬æåˆ°å’Œç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„åŒºåˆ«ï¼Œè´´å¿ƒçš„ç»™å¤§å®¶ä¸€ä¸ªæ›´ç›´è§‚çš„å¯¹æ¯”ï¼š å·®åˆ«åªåœ¨è¿™é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ setHeadAndPropagate(node, r) åˆ°åº•å¹²äº†ä»€ä¹ˆï¼Œæˆ‘ä¹‹å‰è¯´è¿‡ JDK æºç ä¸­çš„æ–¹æ³•å‘½åç»å¤§å¤šæ•°è¿˜æ˜¯éå¸¸ç›´è§‚çš„ï¼Œè¯¥æ–¹æ³•ç›´è¯‘è¿‡æ¥å°±æ˜¯ ã€è®¾ç½®å¤´å¹¶ä¸”ä¼ æ’­/ç¹è¡ã€‘ã€‚ç‹¬å å¼åªæ˜¯è®¾ç½®äº†å¤´ï¼Œå…±äº«å¼é™¤äº†è®¾ç½®å¤´è¿˜å¤šäº†ä¸€ä¸ªä¼ æ’­ï¼Œä½ çš„ç–‘é—®åº”è¯¥å·²ç»æ¥äº†ï¼š å•¥æ˜¯ä¼ æ’­ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ä¼ æ’­è¿™ä¸ªè®¾ç½®å‘¢ï¼Ÿ æƒ³äº†è§£è¿™ä¸ªé—®é¢˜ï¼Œä½ éœ€è¦å…ˆçŸ¥é“éé˜»å¡å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€è¿”å›å€¼çš„å«ä¹‰ï¼š è¿™é‡Œè¯´çš„ä¼ æ’­å…¶å®è¯´çš„æ˜¯ propagate &gt; 0 çš„æƒ…å†µï¼Œé“ç†ä¹Ÿå¾ˆç®€å•ï¼Œå½“å‰çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€æˆåŠŸäº†ï¼Œè¿˜æœ‰å‰©ä½™çš„åŒæ­¥çŠ¶æ€å¯ç”¨äºå…¶ä»–çº¿ç¨‹è·å–ï¼Œé‚£å°±è¦é€šçŸ¥åœ¨ç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹ï¼Œè®©ä»–ä»¬å°è¯•è·å–å‰©ä½™çš„åŒæ­¥çŠ¶æ€ å¦‚æœè¦è®©ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹è·å–åˆ°é€šçŸ¥ï¼Œéœ€è¦çº¿ç¨‹è°ƒç”¨ release æ–¹æ³•å®ç°çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬èµ°è¿‘ setHeadAndPropagate ä¸€æ¢ç©¶ç«Ÿï¼ŒéªŒè¯ä¸€ä¸‹ 123456789101112131415161718 // å…¥å‚ï¼Œnodeï¼š å½“å‰èŠ‚ç‚¹// å…¥å‚ï¼Œpropagateï¼šè·å–åŒæ­¥çŠ¶æ€çš„ç»“æœå€¼ï¼Œå³ä¸Šé¢æ–¹æ³•ä¸­çš„å˜é‡ rprivate void setHeadAndPropagate(Node node, int propagate) &#123; // è®°å½•æ—§çš„å¤´éƒ¨èŠ‚ç‚¹ï¼Œç”¨äºä¸‹é¢çš„check Node h = head; // å°†å½“å‰èŠ‚ç‚¹è®¾ç½®ä¸ºå¤´èŠ‚ç‚¹ setHead(node); // é€šè¿‡ propagate çš„å€¼å’Œ waitStatus çš„å€¼æ¥åˆ¤æ–­æ˜¯å¦å¯ä»¥è°ƒç”¨ doReleaseShared æ–¹æ³• if (propagate &gt; 0 || h == null || h.waitStatus &lt; 0 || (h = head) == null || h.waitStatus &lt; 0) &#123; Node s = node.next; // å¦‚æœåç»§èŠ‚ç‚¹ä¸ºç©ºæˆ–è€…åç»§èŠ‚ç‚¹ä¸ºå…±äº«ç±»å‹ï¼Œåˆ™è¿›è¡Œå”¤é†’åç»§èŠ‚ç‚¹ // è¿™é‡Œåç»§èŠ‚ç‚¹ä¸ºç©ºæ„æ€æ˜¯åªå‰©ä¸‹å½“å‰å¤´èŠ‚ç‚¹äº†ï¼Œå¦å¤–è¿™é‡Œçš„ s == null ä¹Ÿæ˜¯åˆ¤æ–­ç©ºæŒ‡é’ˆçš„æ ‡å‡†å†™æ³• if (s == null || s.isShared()) doReleaseShared(); &#125; &#125; ä¸Šé¢æ–¹æ³•çš„å¤§æ–¹å‘ä½œç”¨æˆ‘ä»¬äº†è§£äº†ï¼Œä½†æ˜¯ä»£ç ä¸­ä½•æ—¶è°ƒç”¨ doReleaseShared çš„åˆ¤æ–­é€»è¾‘è¿˜æ˜¯æŒºè®©äººè´¹è§£çš„ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆä¸€å¤§å †çš„åˆ¤æ–­ï¼Œæˆ‘ä»¬æ¥é€ä¸ªåˆ†æä¸€ä¸‹ï¼š è¿™é‡Œçš„ç©ºåˆ¤æ–­æœ‰ç‚¹è®©äººå¤´å¤§ï¼Œæˆ‘ä»¬å…ˆæŒ‘å‡ºæ¥è¯´æ˜ä¸€ä¸‹ï¼š æ’é™¤äº†å…¶ä»–åˆ¤æ–­æ¡ä»¶çš„å¹²æ‰°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸“æ³¨åˆ†æ propagate å’Œ waitStatus ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶å°±å¯ä»¥äº†ï¼Œè¿™é‡Œå†å°† waitStatus çš„å‡ ç§çŠ¶æ€å±•ç¤ºåœ¨è¿™é‡Œï¼Œå¸®åŠ©å¤§å®¶ç†è§£ï¼Œã€éªšç²‰è‰²ã€‘æ˜¯æˆ‘ä»¬ä¸€ä¼šè¦ç”¨åˆ°çš„ï¼š propagate &gt; 0 ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œå¦‚æœæˆç«‹ï¼Œç›´æ¥çŸ­è·¯åç»­åˆ¤æ–­ï¼Œç„¶åæ ¹æ® doReleaseShared çš„åˆ¤æ–­æ¡ä»¶è¿›è¡Œé‡Šæ”¾ propagate &gt; 0 ä¸æˆç«‹ï¼Œ h.waitStatus &lt; 0 æˆç«‹ ï¼ˆæ³¨æ„è¿™é‡Œçš„hæ˜¯æ—§çš„å¤´èŠ‚ç‚¹ï¼‰ ä»€ä¹ˆæ—¶å€™ h.waitStatus &lt; 0 å‘¢ï¼ŸæŠ›å¼€ CONDITION çš„ä½¿ç”¨ï¼Œåªå‰©ä¸‹ SIGNAL å’Œ PROPAGATEï¼Œæƒ³çŸ¥é“è¿™ä¸ªç­”æ¡ˆï¼Œéœ€è¦æå‰çœ‹ä¸€ä¸‹ doReleaseShared() æ–¹æ³•äº†ï¼š 123456789101112131415161718192021private void doReleaseShared() &#123; for (;;) &#123; Node h = head; if (h != null &amp;&amp; h != tail) &#123; int ws = h.waitStatus; if (ws == Node.SIGNAL) &#123; // CAS å°†å¤´èŠ‚ç‚¹çš„çŠ¶æ€è®¾ç½®ä¸º0 if (!compareAndSetWaitStatus(h, Node.SIGNAL, 0)) continue; // loop to recheck cases // è®¾ç½®æˆåŠŸåæ‰èƒ½è·³å‡ºå¾ªç¯å”¤é†’å¤´èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ unparkSuccessor(h); &#125; else if (ws == 0 &amp;&amp; // å°†å¤´èŠ‚ç‚¹çŠ¶æ€CASè®¾ç½®æˆ PROPAGATE çŠ¶æ€ !compareAndSetWaitStatus(h, 0, Node.PROPAGATE)) continue; // loop on failed CAS &#125; if (h == head) // loop if head changed break; &#125;&#125; ä» doReleaseShared() æ–¹æ³•ä¸­å¯ä»¥çœ‹å‡ºï¼š å¦‚æœè®© h.waitStatus &lt; 0 æˆç«‹ï¼Œåªèƒ½å°†å…¶è®¾ç½®æˆ PROPAGATE = -3 çš„æƒ…å†µï¼Œè®¾ç½®æˆåŠŸçš„å‰ææ˜¯ h å¤´èŠ‚ç‚¹ expected çš„çŠ¶æ€æ˜¯ 0ï¼› å¦‚æœ h.waitStatus = 0ï¼Œæ˜¯ä¸Šè¿°ä»£ç ç¬¬ 8 è¡Œ CAS è®¾ç½®æˆåŠŸï¼Œç„¶åå”¤é†’ç­‰å¾…ä¸­çš„çº¿ç¨‹ æ‰€ä»¥çŒœæµ‹ï¼Œå½“å‰çº¿ç¨‹æ‰§è¡Œåˆ° h.waitStatus &lt; 0 çš„åˆ¤æ–­å‰ï¼Œæœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹åˆšå¥½æ‰§è¡Œäº† doReleaseShared() æ–¹æ³•ï¼Œå°† waitStatus åˆè®¾ç½®æˆPROPAGATE = -3 è¿™ä¸ªç†è§£æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ¥ç”»ä¸ªå›¾ç†è§£ä¸€ä¸‹å§ï¼š å¯èƒ½æœ‰åŒå­¦è¿˜æ˜¯ä¸å¤ªèƒ½ç†è§£è¿™ä¹ˆå†™çš„é“ç†ï¼Œæˆ‘ä»¬ä¸€ç›´è¯´ propagate &lt;&gt; = 0 çš„æƒ…å†µï¼Œpropagate = 0 ä»£è¡¨çš„æ˜¯å½“æ—¶/å½“æ—¶/å½“æ—¶ å°è¯•è·å–åŒæ­¥çŠ¶æ€æ²¡æˆåŠŸï¼Œä½†æ˜¯ä¹‹åå¯èƒ½åˆæœ‰å…±äº«çŠ¶æ€è¢«é‡Šæ”¾äº†ï¼Œæ‰€ä»¥ä¸Šé¢çš„é€»è¾‘æ˜¯ä»¥é˜²è¿™ç§ä¸‡ä¸€ï¼Œä½ æ‡‚çš„ï¼Œä¸¥è°¨çš„å¹¶å‘å°±æ˜¯è¦é˜²æ­¢ä¸€åˆ‡ä¸‡ä¸€ï¼Œç°åœ¨ç»“åˆè¿™ä¸ªæƒ…æ™¯å†æ¥ç†è§£ä¸Šé¢çš„åˆ¤æ–­ä½ æ˜¯å¦è±ç„¶å¼€æœ—äº†å‘¢ï¼Ÿ ç»§ç»­å‘ä¸‹çœ‹ï¼Œ å‰åºæ¡ä»¶ä¸æˆç«‹ï¼Œ(h = head) == null || h.waitStatus &lt; 0 æ³¨æ„è¿™é‡Œçš„hæ˜¯æ–°çš„å¤´èŠ‚ç‚¹ï¼‰ æœ‰äº†ä¸Šé¢é“ºå«ï¼Œè¿™ä¸ªå°±ç›´æ¥ç”»ä¸ªå›¾å°±æ›´å¥½ç†è§£å•¦ï¼Œå…¶å®å°±æ˜¯æ²¡æœ‰é‚£ä¹ˆå·§æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹æºåˆäº† ç›¸ä¿¡åˆ°è¿™é‡Œä½ åº”è¯¥ç†è§£å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„å…¨éƒ¨è¿‡ç¨‹äº†å§ï¼Œè‡³äºéé˜»å¡å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€å’Œå¸¦æœ‰è¶…æ—¶æ—¶é—´è·å–åŒæ­¥çŠ¶æ€ï¼Œç»“åˆæœ¬æ–‡è®²çš„ setHeadAndPropagate é€»è¾‘å’Œç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„å®ç°è¿‡ç¨‹è¿‡ç¨‹æ¥çœ‹ï¼ŒçœŸæ˜¯ä¸€æ¯›ä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸å†ç´¯è¿°äº†ï¼Œèµ¶ç´§æ‰“å¼€ä½ çš„ IDE å»éªŒè¯ä¸€ä¸‹å§ æˆ‘ä»¬åˆ†æäº†AQS çš„æ¨¡ç‰ˆæ–¹æ³•ï¼Œè¿˜ä¸€ç›´æ²¡è¯´ tryAcquireShared(arg) è¿™ä¸ªæ–¹æ³•æ˜¯å¦‚ä½•è¢«é‡å†™çš„ï¼Œæƒ³è¦äº†è§£è¿™ä¸ªï¼Œæˆ‘ä»¬å°±æ¥çœ‹ä¸€çœ‹å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„ç»å…¸åº”ç”¨ Semaphore Semaphore çš„åº”ç”¨åŠæºç åˆ†æSemaphore æ¦‚å¿µSemaphore ä¸­æ–‡å¤šç¿»è¯‘ä¸º ã€ä¿¡å·é‡ã€‘ï¼Œæˆ‘è¿˜ç‰¹æ„æŸ¥äº†ä¸€ä¸‹å‰‘æ¡¥è¾å…¸çš„è‹±æ–‡è§£é‡Šï¼š å…¶å®å°±æ˜¯ä¿¡å·æ ‡å¿—ï¼ˆtwo flagsï¼‰ï¼Œæ¯”å¦‚çº¢ç»¿ç¯ï¼Œæ¯ä¸ªäº¤é€šç¯äº§ç”Ÿä¸¤ç§ä¸åŒè¡Œä¸º Flag1-çº¢ç¯ï¼šåœè½¦ Flag2-ç»¿ç¯ï¼šè¡Œè½¦ åœ¨ Semaphore é‡Œé¢ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯çº¢ç¯ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯ç»¿ç¯ï¼Œå…¶å®å°±æ˜¯é  tryAcquireShared(arg) çš„ç»“æœæ¥è¡¨ç¤ºçš„ è·å–ä¸åˆ°å…±äº«çŠ¶æ€ï¼Œå³ä¸ºçº¢ç¯ è·å–åˆ°å…±äº«çŠ¶æ€ï¼Œå³ä¸ºç»¿ç¯ æ‰€ä»¥æˆ‘ä»¬èµ°è¿‘ Semaphore ï¼Œæ¥çœ‹çœ‹å®ƒåˆ°åº•æ˜¯æ€ä¹ˆåº”ç”¨ AQS çš„ï¼Œåˆæ˜¯æ€æ ·é‡å†™ tryAcquireShared(arg) æ–¹æ³•çš„ Semaphore æºç åˆ†æå…ˆçœ‹ä¸€ä¸‹ç±»ç»“æ„ çœ‹åˆ°è¿™é‡Œä½ æ˜¯å¦æœ‰ç‚¹è·Œçœ¼é•œï¼Œå’Œ ReentrantLock ç›¸ä¼¼çš„å¯æ€•å§ï¼Œå¦‚æœä½ æœ‰äº›é™Œç”Ÿï¼Œå†æ¬¡å¼ºçƒˆå»ºè®®ä½ å›çœ‹ä¸Šä¸€ç¯‡æ–‡ç«  Java AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨ ï¼Œè¿™é‡Œç›´æ¥æé€Ÿå¯¹æ¯”çœ‹å…¬å¹³å’Œéå…¬å¹³ä¸¤ç§é‡å†™çš„ tryAcquireShared(arg) æ–¹æ³•ï¼Œæ²¡æœ‰æ„å¤–ï¼Œå…¬å¹³ä¸å¦ï¼Œå°±æ˜¯åˆ¤æ–­æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹ æ–¹æ³•å†…éƒ¨åªæ˜¯è®¡ç®— state çš„å‰©ä½™å€¼ï¼Œé‚£ state çš„åˆå§‹å€¼æ˜¯å¤šå°‘æ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿå½“ç„¶ä¹Ÿå°±æ˜¯æ„é€ æ–¹æ³•äº†ï¼š 12345678public Semaphore(int permits) &#123; // é»˜è®¤ä»æ˜¯éå…¬å¹³çš„åŒæ­¥å™¨ï¼Œè‡³äºä¸ºä»€ä¹ˆé»˜è®¤æ˜¯éå…¬å¹³çš„ï¼Œåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä¹Ÿç‰¹æ„è¯´æ˜è¿‡ sync = new NonfairSync(permits); &#125; NonfairSync(int permits) &#123; super(permits); &#125; super æ–¹æ³•ï¼Œå°±ä¼šå°†åˆå§‹å€¼ç»™åˆ° AQS ä¸­çš„ state ä¹Ÿè®¸ä½ å‘ç°äº†ï¼Œå½“æˆ‘ä»¬æŠŠ permits è®¾ç½®ä¸º1 çš„æ—¶å€™ï¼Œä¸å°±æ˜¯ ReentrantLock çš„äº’æ–¥é”äº†å˜›ï¼Œè¯´çš„ä¸€ç‚¹ä¹Ÿæ²¡é”™ï¼Œæˆ‘ä»¬ç”¨ Semaphore ä¹Ÿèƒ½å®ç°åŸºæœ¬äº’æ–¥é”çš„æ•ˆæœ 1234567891011121314static int count;//åˆå§‹åŒ–ä¿¡å·é‡static final Semaphore s = new Semaphore(1);//ç”¨ä¿¡å·é‡ä¿è¯äº’æ–¥ static void addOne() &#123; s.acquire(); try &#123; count+=1; &#125; finally &#123; s.release(); &#125;&#125; Butï¼ˆè‹±æ–‡å¬åŠ›ä¸­çš„é‡ç‚¹ï¼‰ï¼ŒSemaphore è‚¯å®šä¸æ˜¯ä¸ºè¿™ç§ç‰¹ä¾‹å­˜åœ¨çš„ï¼Œå®ƒæ˜¯å…±äº«å¼è·å–åŒæ­¥çŠ¶æ€çš„ä¸€ç§å®ç°ã€‚å¦‚æœä½¿ç”¨ä¿¡å·é‡ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°† permits è®¾ç½®æˆå¤§äº1çš„å€¼ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦è¿˜è®°å¾—æˆ‘æ›¾åœ¨ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ? ä¸€æ–‡ä¸­è¯´åˆ°çš„æ± åŒ–æ¦‚å¿µï¼Œåœ¨åŒä¸€æ—¶åˆ»ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹ä½¿ç”¨è¿æ¥æ± ï¼Œæ¯ä¸ªè¿æ¥è¢«é‡Šæ”¾ä¹‹å‰ï¼Œä¸å…è®¸å…¶ä»–çº¿ç¨‹ä½¿ç”¨ã€‚æ‰€ä»¥è¯´ Semaphore å¯ä»¥å…è®¸å¤šä¸ªçº¿ç¨‹è®¿é—®ä¸€ä¸ªä¸´ç•ŒåŒºï¼Œæœ€ç»ˆå¾ˆå¥½çš„åšåˆ°ä¸€ä¸ªé™æµ/é™æµ/é™æµ çš„ä½œç”¨ è™½ç„¶ Semaphore èƒ½å¾ˆå¥½çš„æä¾›é™æµä½œç”¨ï¼Œè¯´å®è¯ï¼ŒSemaphore çš„é™æµä½œç”¨æ¯”è¾ƒå•ä¸€ï¼Œæˆ‘åœ¨å®é™…å·¥ä½œä¸­ä½¿ç”¨ Semaphore å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œå¦‚æœçœŸçš„è¦ç”¨é«˜æ€§èƒ½é™æµå™¨ï¼ŒGuava RateLimiter æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„é€‰æ‹©ï¼Œæˆ‘ä»¬åé¢ä¼šåšåˆ†æï¼Œæœ‰å…´è¶£çš„å¯ä»¥æå‰äº†è§£ä¸€ä¸‹ å…³äº Semaphore æºç ï¼Œå°±è¿™ä¹ˆä¸‰ä¸‹äº”é™¤äºŒçš„ç»“æŸäº† æ€»ç»“ä¸çŸ¥ä½ æœ‰æ²¡æœ‰æ„Ÿè§‰åˆ°ï¼Œæˆ‘ä»¬çš„èŠ‚å¥æ˜æ˜¾åŠ å¿«äº†ï¼Œå¥½å¤šåŸæ¥åˆ†æ•£çš„ç‚¹åœ¨è¢«ç–¯ç‹‚çš„ä¸²è”èµ·æ¥ï¼Œå¦‚æœæŒ‰ç…§è¿™ä¸ªæ–¹å¼æ¥é˜…è¯» JUC æºç ï¼Œç›¸ä¿¡ä½ ä¹Ÿä¸ä¼šä¸€å¤´æ‰è¿›å»è¿·å¤±æ–¹å‘ï¼Œç„¶åæ²®ä¸§çš„é€€å‡º JUC å§ï¼Œç„¶åé¢è¯•èƒŒè¯µç­”æ¡ˆï¼Œç„¶åå¿˜è®°ï¼Œç„¶åå†èƒŒè¯µï¼Ÿ è·Ÿä¸ŠèŠ‚å¥ï¼Œå…³äºå…±äº«å¼è·å–åŒæ­¥çŠ¶æ€ï¼ŒSemaphore åªä¸è¿‡æ˜¯éå¸¸ç»å…¸çš„åº”ç”¨ï¼ŒReadWriteLock å’Œ CountDownLatch æ—¥å¸¸åº”ç”¨è¿˜æ˜¯éå¸¸å¹¿æ³›çš„ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±é™†ç»­èŠèŠå®ƒä»¬å§ çµé­‚è¿½é—® Semaphore çš„ permits è®¾ç½®æˆ1 â€œç­‰åŒäºâ€ ç®€å•çš„äº’æ–¥é”å®ç°ï¼Œé‚£å®ƒå’Œ ReentrantLock çš„åŒºåˆ«è¿˜æ˜¯æŒºå¤§çš„ï¼Œéƒ½æœ‰å“ªäº›åŒºåˆ«å‘¢ï¼Ÿ ä½ åœ¨é¡¹ç›®ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨ Semaphore çš„å‘¢ï¼Ÿ å‚è€ƒ Java å¹¶å‘å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ https://blog.csdn.net/anlian523/article/details/106319294","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"Java AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨","slug":"Java-AQSé˜Ÿåˆ—åŒæ­¥å™¨ä»¥åŠReentrantLockçš„åº”ç”¨","date":"2020-05-31T12:26:08.000Z","updated":"2020-06-02T11:41:19.518Z","comments":true,"path":"/p/java-aqs-and-reentrantlock.html","link":"","permalink":"https://dayarch.top/p/java-aqs-and-reentrantlock.html","excerpt":"å†™åœ¨å‰é¢ è¿›å…¥æºç é˜¶æ®µäº†ï¼Œå†™äº†åå‡ ç¯‡çš„ å¹¶å‘ç³»åˆ— çŸ¥è¯†é“ºå«ç»ˆäºè¦æ´¾ä¸Šç”¨åœºäº†ã€‚ç›¸ä¿¡å¾ˆå¤šäººå·²ç»å¿˜äº†å…¶ä¸­çš„ä¸€äº›ç†è®ºçŸ¥è¯†ï¼Œåˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šåœ¨æºç ç¯èŠ‚å¸¦å…¥ç›¸åº”çš„ç†è®ºçŸ¥è¯†ç‚¹å¸®åŠ©å¤§å®¶å›å¿†ï¼Œåšåˆ°ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œå¦å¤–è¿™æ˜¯è¶…é•¿å›¾æ–‡ï¼Œå»ºè®®æ”¶è—ï¼Œå¦‚æœå¯¹ä½ æœ‰ç”¨è¿˜è¯·ç‚¹èµè®©æ›´å¤šäººçœ‹åˆ° Java SDK ä¸ºä»€ä¹ˆè¦è®¾è®¡ Lock æ›¾å‡ ä½•æ—¶å¹»æƒ³è¿‡ï¼Œå¦‚æœ Java å¹¶å‘æ§åˆ¶åªæœ‰ synchronized å¤šå¥½ï¼Œåªæœ‰ä¸‹é¢ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼Œç®€å•æ–¹ä¾¿ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 public class ThreeSync { private static fina","text":"å†™åœ¨å‰é¢è¿›å…¥æºç é˜¶æ®µäº†ï¼Œå†™äº†åå‡ ç¯‡çš„ å¹¶å‘ç³»åˆ— çŸ¥è¯†é“ºå«ç»ˆäºè¦æ´¾ä¸Šç”¨åœºäº†ã€‚ç›¸ä¿¡å¾ˆå¤šäººå·²ç»å¿˜äº†å…¶ä¸­çš„ä¸€äº›ç†è®ºçŸ¥è¯†ï¼Œåˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šåœ¨æºç ç¯èŠ‚å¸¦å…¥ç›¸åº”çš„ç†è®ºçŸ¥è¯†ç‚¹å¸®åŠ©å¤§å®¶å›å¿†ï¼Œåšåˆ°ç†è®ºä¸å®è·µç›¸ç»“åˆï¼Œå¦å¤–è¿™æ˜¯è¶…é•¿å›¾æ–‡ï¼Œå»ºè®®æ”¶è—ï¼Œå¦‚æœå¯¹ä½ æœ‰ç”¨è¿˜è¯·ç‚¹èµè®©æ›´å¤šäººçœ‹åˆ° Java SDK ä¸ºä»€ä¹ˆè¦è®¾è®¡ Lockæ›¾å‡ ä½•æ—¶å¹»æƒ³è¿‡ï¼Œå¦‚æœ Java å¹¶å‘æ§åˆ¶åªæœ‰ synchronized å¤šå¥½ï¼Œåªæœ‰ä¸‹é¢ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼Œç®€å•æ–¹ä¾¿ 123456789101112131415161718public class ThreeSync &#123; private static final Object object = new Object(); public synchronized void normalSyncMethod()&#123; //ä¸´ç•ŒåŒº &#125; public static synchronized void staticSyncMethod()&#123; //ä¸´ç•ŒåŒº &#125; public void syncBlockMethod()&#123; synchronized (object)&#123; //ä¸´ç•ŒåŒº &#125; &#125;&#125; å¦‚æœåœ¨ Java 1.5ä¹‹å‰ï¼Œç¡®å®æ˜¯è¿™æ ·ï¼Œè‡ªä» 1.5 ç‰ˆæœ¬ Doug Lea å¤§å¸ˆå°±é‡æ–°é€ äº†ä¸€ä¸ªè½®å­ Lock æˆ‘ä»¬å¸¸è¯´ï¼šâ€œé¿å…é‡å¤é€ è½®å­â€ï¼Œå¦‚æœæœ‰äº†è½®å­è¿˜æ˜¯è¦åšæŒå†é€ ä¸ªè½®å­ï¼Œé‚£ä¹ˆè‚¯å®šä¼ ç»Ÿçš„è½®å­åœ¨æŸäº›åº”ç”¨åœºæ™¯ä¸­ä¸èƒ½å¾ˆå¥½çš„è§£å†³é—®é¢˜ ä¸çŸ¥ä½ æ˜¯å¦è¿˜è®°å¾— Coffman æ€»ç»“çš„å››ä¸ªå¯ä»¥å‘ç”Ÿæ­»é”çš„æƒ…å½¢ ï¼Œå…¶ä¸­ã€ä¸å¯å‰¥å¤ºæ¡ä»¶ã€‘æ˜¯æŒ‡ï¼š çº¿ç¨‹å·²ç»è·å¾—èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½è¢«å‰¥å¤ºï¼Œåªèƒ½åœ¨ä½¿ç”¨å®Œæ—¶è‡ªå·±é‡Šæ”¾ è¦æƒ³ç ´åè¿™ä¸ªæ¡ä»¶ï¼Œå°±éœ€è¦å…·æœ‰ç”³è¯·ä¸åˆ°è¿›ä¸€æ­¥èµ„æºå°±é‡Šæ”¾å·²æœ‰èµ„æºçš„èƒ½åŠ› å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªèƒ½åŠ›æ˜¯ synchronized ä¸å…·å¤‡çš„ï¼Œä½¿ç”¨ synchronized ï¼Œå¦‚æœçº¿ç¨‹ç”³è¯·ä¸åˆ°èµ„æºå°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œæˆ‘ä»¬åšä»€ä¹ˆä¹Ÿæ”¹å˜ä¸äº†å®ƒçš„çŠ¶æ€ï¼Œè¿™æ˜¯ synchronized è½®å­çš„è‡´å‘½å¼±ç‚¹ï¼Œè¿™å°±å¼ºæœ‰åŠ›çš„ç»™äº†é‡é€ è½®å­ Lock çš„ç†ç”± æ˜¾å¼é” Lockæ—§è½®å­æœ‰å¼±ç‚¹ï¼Œæ–°è½®å­å°±è¦è§£å†³è¿™äº›é—®é¢˜ï¼Œæ‰€ä»¥è¦å…·å¤‡ä¸ä¼šé˜»å¡çš„åŠŸèƒ½ï¼Œä¸‹é¢çš„ä¸‰ä¸ªæ–¹æ¡ˆéƒ½æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„å¥½åŠæ³•ï¼ˆçœ‹ä¸‹é¢è¡¨æ ¼æè¿°ä½ å°±æ˜ç™½ä¸‰ä¸ªæ–¹æ¡ˆçš„å«ä¹‰äº†ï¼‰ ç‰¹æ€§ æè¿° API èƒ½å“åº”ä¸­æ–­ å¦‚æœä¸èƒ½è‡ªå·±é‡Šæ”¾ï¼Œé‚£å¯ä»¥å“åº”ä¸­æ–­ä¹Ÿæ˜¯å¾ˆå¥½çš„ã€‚Javaå¤šçº¿ç¨‹ä¸­æ–­æœºåˆ¶ ä¸“é—¨æè¿°äº†ä¸­æ–­è¿‡ç¨‹ï¼Œç›®çš„æ˜¯é€šè¿‡ä¸­æ–­ä¿¡å·æ¥è·³å‡ºæŸç§çŠ¶æ€ï¼Œæ¯”å¦‚é˜»å¡ lockInterruptbly() éé˜»å¡å¼çš„è·å–é” å°è¯•è·å–ï¼Œè·å–ä¸åˆ°ä¸ä¼šé˜»å¡ï¼Œç›´æ¥è¿”å› tryLock() æ”¯æŒè¶…æ—¶ ç»™å®šä¸€ä¸ªæ—¶é—´é™åˆ¶ï¼Œå¦‚æœä¸€æ®µæ—¶é—´å†…æ²¡è·å–åˆ°ï¼Œä¸æ˜¯è¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒåŒæ ·ç›´æ¥è¿”å› tryLock(long time, timeUnit) å¥½çš„æ–¹æ¡ˆæœ‰äº†ï¼Œä½†é±¼å’Œç†ŠæŒä¸å¯å…¼å¾—ï¼ŒLock å¤šäº† synchronized ä¸å…·å¤‡çš„ç‰¹æ€§ï¼Œè‡ªç„¶ä¸ä¼šåƒ synchronized é‚£æ ·ä¸€ä¸ªå…³é”®å­—ä¸‰ä¸ªç©æ³•èµ°éå…¨å¤©ä¸‹ï¼Œåœ¨ä½¿ç”¨ä¸Šä¹Ÿç›¸å¯¹å¤æ‚äº†ä¸€ä¸¢ä¸¢ Lock ä½¿ç”¨èŒƒå¼synchronized æœ‰æ ‡å‡†ç”¨æ³•ï¼Œè¿™æ ·çš„ä¼˜è‰¯ä¼ ç»Ÿå’± Lock ä¹Ÿå¾—æœ‰ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½çŸ¥é“ä½¿ç”¨ Lock çš„ä¸€ä¸ªèŒƒå¼ 1234567Lock lock = new ReentrantLock();lock.lock();try&#123; ...&#125;finally&#123; lock.unlock();&#125; æ—¢ç„¶æ˜¯èŒƒå¼ï¼ˆæ²¡äº‹ä¸è¦æŒ‘æˆ˜æ›´æ”¹å†™æ³•çš„é‚£ç§ï¼‰ï¼Œè‚¯å®šæœ‰å…¶ç†ç”±ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ æ ‡å‡†1â€”finally ä¸­é‡Šæ”¾é”è¿™ä¸ªå¤§å®¶åº”è¯¥éƒ½ä¼šæ˜ç™½ï¼Œåœ¨ finally ä¸­é‡Šæ”¾é”ï¼Œç›®çš„æ˜¯ä¿è¯åœ¨è·å–åˆ°é”ä¹‹åï¼Œæœ€ç»ˆèƒ½è¢«é‡Šæ”¾ æ ‡å‡†2â€”åœ¨ try{} å¤–é¢è·å–é”ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰æ ‡å‡† 2 çš„å­˜åœ¨ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯â€œå–œæ¬¢â€ try ä½æ‰€æœ‰å†…å®¹ï¼Œç”Ÿæ€•å‘ç”Ÿå¼‚å¸¸ä¸èƒ½æ•è·çš„ åœ¨ try{} å¤–è·å–é”ä¸»è¦è€ƒè™‘ä¸¤ä¸ªæ–¹é¢ï¼š å¦‚æœæ²¡æœ‰è·å–åˆ°é”å°±æŠ›å‡ºå¼‚å¸¸ï¼Œæœ€ç»ˆé‡Šæ”¾é”è‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºè¿˜æœªæ›¾æ‹¥æœ‰é”è°ˆä½•é‡Šæ”¾é”å‘¢ å¦‚æœåœ¨è·å–é”æ—¶æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯å½“å‰çº¿ç¨‹å¹¶æœªè·å–åˆ°é”ï¼Œä½†æ‰§è¡Œåˆ° finally ä»£ç æ—¶ï¼Œå¦‚æœæ°å·§åˆ«çš„çº¿ç¨‹è·å–åˆ°äº†é”ï¼Œåˆ™ä¼šè¢«é‡Šæ”¾æ‰ï¼ˆæ— æ•…é‡Šæ”¾ï¼‰ ä¸åŒé”çš„å®ç°æ–¹å¼ç•¥æœ‰ä¸åŒï¼ŒèŒƒå¼çš„å­˜åœ¨å°±æ˜¯è¦é¿å…ä¸€åˆ‡é—®é¢˜çš„å‡ºç°ï¼Œæ‰€ä»¥å¤§å®¶å°½é‡éµå®ˆèŒƒå¼ Lock æ˜¯æ€æ ·èµ·åˆ°é”çš„ä½œç”¨å‘¢ï¼Ÿå¦‚æœä½ ç†Ÿæ‚‰ synchronizedï¼Œä½ çŸ¥é“ç¨‹åºç¼–è¯‘æˆ CPU æŒ‡ä»¤åï¼Œåœ¨ä¸´ç•ŒåŒºä¼šæœ‰ moniterenter å’Œ moniterexit æŒ‡ä»¤çš„å‡ºç°ï¼Œå¯ä»¥ç†è§£æˆè¿›å‡ºä¸´ç•ŒåŒºçš„æ ‡è¯† ä»èŒƒå¼ä¸Šæ¥çœ‹ï¼š lock.lock() è·å–é”ï¼Œâ€œç­‰åŒäºâ€ synchronized çš„ moniterenteræŒ‡ä»¤ lock.unlock() é‡Šæ”¾é”ï¼Œâ€œç­‰åŒäºâ€ synchronized çš„ moniterexit æŒ‡ä»¤ é‚£ Lock æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿ è¿™é‡Œå…ˆç®€å•è¯´æ˜ä¸€ä¸‹ï¼Œè¿™æ ·ä¸€ä¼šåˆ°æºç åˆ†ææ—¶ï¼Œä½ å¯ä»¥è¿œè§‚è®¾è®¡è½®å»“ï¼Œè¿‘è§‚å®ç°ç»†èŠ‚ï¼Œä¼šå˜å¾—è¶Šå‘è½»æ¾ å…¶å®å¾ˆç®€å•ï¼Œæ¯”å¦‚åœ¨ ReentrantLock å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª volatile ä¿®é¥°çš„å˜é‡ stateï¼Œé€šè¿‡ CAS æ¥è¿›è¡Œè¯»å†™ï¼ˆæœ€åº•å±‚è¿˜æ˜¯äº¤ç»™ç¡¬ä»¶æ¥ä¿è¯åŸå­æ€§å’Œå¯è§æ€§ï¼‰ï¼Œå¦‚æœCASæ›´æ”¹æˆåŠŸï¼Œå³è·å–åˆ°é”ï¼Œçº¿ç¨‹è¿›å…¥åˆ° try ä»£ç å—ç»§ç»­æ‰§è¡Œï¼›å¦‚æœæ²¡æœ‰æ›´æ”¹æˆåŠŸï¼Œçº¿ç¨‹ä¼šè¢«ã€æŒ‚èµ·ã€‘ï¼Œä¸ä¼šå‘ä¸‹æ‰§è¡Œ ä½† Lock æ˜¯ä¸€ä¸ªæ¥å£ï¼Œé‡Œé¢æ ¹æœ¬æ²¡æœ‰ state è¿™ä¸ªå˜é‡çš„å­˜åœ¨ï¼š å®ƒæ€ä¹ˆå¤„ç†è¿™ä¸ª state å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶éœ€è¦ä¸€ç‚¹è®¾è®¡çš„åŠ æˆäº†ï¼Œæ¥å£å®šä¹‰è¡Œä¸ºï¼Œå…·ä½“éƒ½æ˜¯éœ€è¦å®ç°ç±»çš„ Lock æ¥å£çš„å®ç°ç±»åŸºæœ¬éƒ½æ˜¯é€šè¿‡ã€èšåˆã€‘äº†ä¸€ä¸ªã€é˜Ÿåˆ—åŒæ­¥å™¨ã€‘çš„å­ç±»å®Œæˆçº¿ç¨‹è®¿é—®æ§åˆ¶çš„ é‚£ä»€ä¹ˆæ˜¯é˜Ÿåˆ—åŒæ­¥å™¨å‘¢ï¼Ÿ ï¼ˆè¿™åº”è¯¥æ˜¯ä½ è§è¿‡çš„æœ€å¼ºæ ‡é¢˜å…šï¼ŒèŠäº†åŠä¸ªä¸–çºªæ‰å…¥æ­£é¢˜ï¼Œè¯„è®ºåŒºç•™è¨€éª‚æˆ‘ï¼‰ é˜Ÿåˆ—åŒæ­¥å™¨ AQSé˜Ÿåˆ—åŒæ­¥å™¨ ï¼ˆAbstractQueuedSynchronizerï¼‰ï¼Œç®€ç§°åŒæ­¥å™¨æˆ–AQSï¼Œå°±æ˜¯æˆ‘ä»¬ä»Šå¤©çš„ä¸»äººå…¬ é—®ï¼šä¸ºä»€ä¹ˆä½ åˆ†æ JUC æºç ï¼Œè¦ä» AQS è¯´èµ·å‘¢ï¼Ÿ ç­”ï¼šçœ‹ä¸‹å›¾ ç›¸ä¿¡çœ‹åˆ°è¿™ä¸ªæˆªå›¾ä½ å°±æ˜ç™½ä¸€äºŒäº†ï¼Œä½ å¬è¿‡çš„ï¼Œé¢è¯•å¸¸è¢«é—®èµ·çš„ï¼Œå·¥ä½œä¸­å¸¸ç”¨çš„ ReentrantLock ReentrantReadWriteLock Semaphore(ä¿¡å·é‡) CountDownLatch å…¬å¹³é” éå…¬å¹³é” ThreadPoolExecutor (å…³äºçº¿ç¨‹æ± çš„ç†è§£ï¼Œå¯ä»¥æŸ¥çœ‹ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ? ) éƒ½å’Œ AQS æœ‰ç›´æ¥å…³ç³»ï¼Œæ‰€ä»¥äº†è§£ AQS çš„æŠ½è±¡å®ç°ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå†ç¨ç¨æŸ¥çœ‹ä¸Šè¿°å„ç±»çš„å®ç°ç»†èŠ‚ï¼Œå¾ˆå¿«å°±å¯ä»¥å…¨éƒ¨æå®šï¼Œä¸è‡³äºæŸ¥çœ‹æºç æ—¶ä¸€å¤´é›¾æ°´ï¼Œä¸¢å¤±ä¸»çº¿ ä¸Šé¢æåˆ°ï¼Œåœ¨é”çš„å®ç°ç±»ä¸­ä¼šèšåˆåŒæ­¥å™¨ï¼Œç„¶ååˆ©åŒæ­¥å™¨å®ç°é”çš„è¯­ä¹‰ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š ä¸ºä»€ä¹ˆè¦ç”¨èšåˆæ¨¡å¼ï¼Œæ€ä¹ˆè¿›ä¸€æ­¥ç†è§£é”å’ŒåŒæ­¥å™¨çš„å…³ç³»å‘¢ï¼Ÿ æˆ‘ä»¬ç»å¤§å¤šæ•°éƒ½æ˜¯åœ¨ä½¿ç”¨é”ï¼Œå®ç°é”ä¹‹åï¼Œå…¶æ ¸å¿ƒå°±æ˜¯è¦ä½¿ç”¨æ–¹ä¾¿ ä» AQS çš„ç±»åç§°å’Œä¿®é¥°ä¸Šæ¥çœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥ä»è®¾è®¡æ¨¡å¼çš„è§’åº¦æ¥çœ‹åŒæ­¥å™¨ä¸€å®šæ˜¯åŸºäºã€æ¨¡ç‰ˆæ¨¡å¼ã€‘æ¥è®¾è®¡çš„ï¼Œä½¿ç”¨è€…éœ€è¦ç»§æ‰¿åŒæ­¥å™¨ï¼Œå®ç°è‡ªå®šä¹‰åŒæ­¥å™¨ï¼Œå¹¶é‡å†™æŒ‡å®šæ–¹æ³•ï¼Œéšåå°†åŒæ­¥å™¨ç»„åˆåœ¨è‡ªå®šä¹‰çš„åŒæ­¥ç»„ä»¶ä¸­ï¼Œå¹¶è°ƒç”¨åŒæ­¥å™¨çš„æ¨¡ç‰ˆæ–¹æ³•ï¼Œè€Œè¿™äº›æ¨¡ç‰ˆæ–¹æ³•åˆå›è°ƒç”¨ä½¿ç”¨è€…é‡å†™çš„æ–¹æ³• æˆ‘ä¸æƒ³å°†ä¸Šé¢çš„è§£é‡Šè¯´çš„è¿™ä¹ˆæŠ½è±¡ï¼Œå…¶å®æƒ³ç†è§£ä¸Šé¢è¿™å¥è¯ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ä¸‹é¢ä¸¤ä¸ªé—®é¢˜å°±å¥½äº† å“ªäº›æ˜¯è‡ªå®šä¹‰åŒæ­¥å™¨å¯é‡å†™çš„æ–¹æ³•ï¼Ÿ å“ªäº›æ˜¯æŠ½è±¡åŒæ­¥å™¨æä¾›çš„æ¨¡ç‰ˆæ–¹æ³•ï¼Ÿ åŒæ­¥å™¨å¯é‡å†™çš„æ–¹æ³•åŒæ­¥å™¨æä¾›çš„å¯é‡å†™æ–¹æ³•åªæœ‰5ä¸ªï¼Œè¿™å¤§å¤§æ–¹ä¾¿äº†é”çš„ä½¿ç”¨è€…ï¼š æŒ‰ç†è¯´ï¼Œéœ€è¦é‡å†™çš„æ–¹æ³•ä¹Ÿåº”è¯¥æœ‰ abstract æ¥ä¿®é¥°çš„ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œæ²¡æœ‰ï¼ŸåŸå› å…¶å®å¾ˆç®€å•ï¼Œä¸Šé¢çš„æ–¹æ³•æˆ‘å·²ç»ç”¨é¢œè‰²åŒºåˆ†æˆäº†ä¸¤ç±»ï¼š ç‹¬å å¼ å…±äº«å¼ è‡ªå®šä¹‰çš„åŒæ­¥ç»„ä»¶æˆ–è€…é”ä¸å¯èƒ½æ—¢æ˜¯ç‹¬å å¼åˆæ˜¯å…±äº«å¼ï¼Œä¸ºäº†é¿å…å¼ºåˆ¶é‡å†™ä¸ç›¸å¹²æ–¹æ³•ï¼Œæ‰€ä»¥å°±æ²¡æœ‰ abstract æ¥ä¿®é¥°äº†ï¼Œä½†è¦æŠ›å‡ºå¼‚å¸¸å‘ŠçŸ¥ä¸èƒ½ç›´æ¥ä½¿ç”¨è¯¥æ–¹æ³•ï¼š 123protected boolean tryAcquire(int arg) &#123; throw new UnsupportedOperationException();&#125; æš–æš–çš„å¾ˆè´´å¿ƒï¼ˆå¦‚æœä½ æœ‰ç±»ä¼¼çš„éœ€æ±‚ä¹Ÿå¯ä»¥ä»¿ç…§è¿™æ ·çš„è®¾è®¡ï¼‰ è¡¨æ ¼æ–¹æ³•æè¿°ä¸­æ‰€è¯´çš„åŒæ­¥çŠ¶æ€å°±æ˜¯ä¸Šæ–‡æåˆ°çš„æœ‰ volatile ä¿®é¥°çš„ stateï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é‡å†™ä¸Šé¢å‡ ä¸ªæ–¹æ³•æ—¶ï¼Œè¿˜è¦é€šè¿‡åŒæ­¥å™¨æä¾›çš„ä¸‹é¢ä¸‰ä¸ªæ–¹æ³•ï¼ˆAQS æä¾›çš„ï¼‰æ¥è·å–æˆ–ä¿®æ”¹åŒæ­¥çŠ¶æ€ï¼š è€Œç‹¬å å¼å’Œå…±äº«å¼æ“ä½œ state å˜é‡çš„åŒºåˆ«ä¹Ÿå°±å¾ˆç®€å•äº† æ‰€ä»¥ä½ çœ‹åˆ°çš„ ReentrantLock ReentrantReadWriteLock Semaphore(ä¿¡å·é‡) CountDownLatch è¿™å‡ ä¸ªç±»å…¶å®ä»…ä»…æ˜¯åœ¨å®ç°ä»¥ä¸Šå‡ ä¸ªæ–¹æ³•ä¸Šç•¥æœ‰å·®åˆ«ï¼Œå…¶ä»–çš„å®ç°éƒ½æ˜¯é€šè¿‡åŒæ­¥å™¨çš„æ¨¡ç‰ˆæ–¹æ³•æ¥å®ç°çš„ï¼Œåˆ°è¿™é‡Œæ˜¯ä¸æ˜¯å¿ƒæƒ…æ”¾æ¾äº†è®¸å¤šå‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹æ¨¡ç‰ˆæ–¹æ³•ï¼š åŒæ­¥å™¨æä¾›çš„æ¨¡ç‰ˆæ–¹æ³•ä¸Šé¢æˆ‘ä»¬å°†åŒæ­¥å™¨çš„å®ç°æ–¹æ³•åˆ†ä¸ºç‹¬å å¼å’Œå…±äº«å¼ä¸¤ç±»ï¼Œæ¨¡ç‰ˆæ–¹æ³•å…¶å®é™¤äº†æä¾›ä»¥ä¸Šä¸¤ç±»æ¨¡ç‰ˆæ–¹æ³•ä¹‹å¤–ï¼Œåªæ˜¯å¤šäº†å“åº”ä¸­æ–­å’Œè¶…æ—¶é™åˆ¶ çš„æ¨¡ç‰ˆæ–¹æ³•ä¾› Lock ä½¿ç”¨ï¼Œæ¥çœ‹ä¸€ä¸‹ å…ˆä¸ç”¨è®°ä¸Šè¿°æ–¹æ³•çš„åŠŸèƒ½ï¼Œç›®å‰ä½ åªéœ€è¦äº†è§£ä¸ªå¤§æ¦‚åŠŸèƒ½å°±å¥½ã€‚å¦å¤–ï¼Œç›¸ä¿¡ä½ ä¹Ÿæ³¨æ„åˆ°äº†ï¼š ä¸Šé¢çš„æ–¹æ³•éƒ½æœ‰ final å…³é”®å­—ä¿®é¥°ï¼Œè¯´æ˜å­ç±»ä¸èƒ½é‡å†™è¿™ä¸ªæ–¹æ³• çœ‹åˆ°è¿™ä½ ä¹Ÿè®¸æœ‰ç‚¹ä¹±äº†ï¼Œæˆ‘ä»¬ç¨å¾®å½’çº³ä¸€ä¸‹ï¼š ç¨‹åºå‘˜è¿˜æ˜¯çœ‹ä»£ç å¿ƒé‡Œè¸å®ä¸€ç‚¹ï¼Œæˆ‘ä»¬å†æ¥ç”¨ä»£ç è¯´æ˜ä¸€ä¸‹ä¸Šé¢çš„å…³ç³»ï¼ˆæ³¨æ„ä»£ç ä¸­çš„æ³¨é‡Šï¼Œä»¥ä¸‹çš„ä»£ç å¹¶ä¸æ˜¯å¾ˆä¸¥è°¨ï¼Œåªæ˜¯ä¸ºäº†ç®€å•è¯´æ˜ä¸Šå›¾çš„ä»£ç å®ç°ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596package top.dayarch.myjuc;import java.util.concurrent.TimeUnit;import java.util.concurrent.locks.AbstractQueuedSynchronizer;import java.util.concurrent.locks.Condition;import java.util.concurrent.locks.Lock;/** * è‡ªå®šä¹‰äº’æ–¥é” * * @author tanrgyb * @date 2020/5/23 9:33 PM */public class MyMutex implements Lock &#123; // é™æ€å†…éƒ¨ç±»-è‡ªå®šä¹‰åŒæ­¥å™¨ private static class MySync extends AbstractQueuedSynchronizer&#123; @Override protected boolean tryAcquire(int arg) &#123; // è°ƒç”¨AQSæä¾›çš„æ–¹æ³•ï¼Œé€šè¿‡CASä¿è¯åŸå­æ€§ if (compareAndSetState(0, arg))&#123; // æˆ‘ä»¬å®ç°çš„æ˜¯äº’æ–¥é”ï¼Œæ‰€ä»¥æ ‡è®°è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼ˆæ›´æ–°stateæˆåŠŸï¼‰çš„çº¿ç¨‹ï¼Œ // ä¸»è¦ä¸ºäº†åˆ¤æ–­æ˜¯å¦å¯é‡å…¥ï¼ˆä¸€ä¼šå„¿ä¼šè¯´æ˜ï¼‰ setExclusiveOwnerThread(Thread.currentThread()); //è·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œè¿”å› true return true; &#125; // è·å–åŒæ­¥çŠ¶æ€å¤±è´¥ï¼Œè¿”å› false return false; &#125; @Override protected boolean tryRelease(int arg) &#123; // æœªæ‹¥æœ‰é”å´è®©é‡Šæ”¾ï¼Œä¼šæŠ›å‡ºIMSE if (getState() == 0)&#123; throw new IllegalMonitorStateException(); &#125; // å¯ä»¥é‡Šæ”¾ï¼Œæ¸…ç©ºæ’å®ƒçº¿ç¨‹æ ‡è®° setExclusiveOwnerThread(null); // è®¾ç½®åŒæ­¥çŠ¶æ€ä¸º0ï¼Œè¡¨ç¤ºé‡Šæ”¾é” setState(0); return true; &#125; // æ˜¯å¦ç‹¬å å¼æŒæœ‰ @Override protected boolean isHeldExclusively() &#123; return getState() == 1; &#125; // åç»­ä¼šç”¨åˆ°ï¼Œä¸»è¦ç”¨äºç­‰å¾…/é€šçŸ¥æœºåˆ¶ï¼Œæ¯ä¸ªconditionéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—ï¼Œåœ¨é”æ¨¡å‹ä¸­è¯´æ˜è¿‡ Condition newCondition() &#123; return new ConditionObject(); &#125; &#125; // èšåˆè‡ªå®šä¹‰åŒæ­¥å™¨ private final MySync sync = new MySync(); @Override public void lock() &#123; // é˜»å¡å¼çš„è·å–é”ï¼Œè°ƒç”¨åŒæ­¥å™¨æ¨¡ç‰ˆæ–¹æ³•ç‹¬å å¼ï¼Œè·å–åŒæ­¥çŠ¶æ€ sync.acquire(1); &#125; @Override public void lockInterruptibly() throws InterruptedException &#123; // è°ƒç”¨åŒæ­¥å™¨æ¨¡ç‰ˆæ–¹æ³•å¯ä¸­æ–­å¼è·å–åŒæ­¥çŠ¶æ€ sync.acquireInterruptibly(1); &#125; @Override public boolean tryLock() &#123; // è°ƒç”¨è‡ªå·±é‡å†™çš„æ–¹æ³•ï¼Œéé˜»å¡å¼çš„è·å–åŒæ­¥çŠ¶æ€ return sync.tryAcquire(1); &#125; @Override public boolean tryLock(long time, TimeUnit unit) throws InterruptedException &#123; // è°ƒç”¨åŒæ­¥å™¨æ¨¡ç‰ˆæ–¹æ³•ï¼Œå¯å“åº”ä¸­æ–­å’Œè¶…æ—¶æ—¶é—´é™åˆ¶ return sync.tryAcquireNanos(1, unit.toNanos(time)); &#125; @Override public void unlock() &#123; // é‡Šæ”¾é” sync.release(1); &#125; @Override public Condition newCondition() &#123; // ä½¿ç”¨è‡ªå®šä¹‰çš„æ¡ä»¶ return sync.newCondition(); &#125;&#125; å¦‚æœä½ ç°åœ¨æ‰“å¼€ IDEï¼Œ ä½ ä¼šå‘ç°ä¸Šæ–‡æåˆ°çš„ ReentrantLock ReentrantReadWriteLock Semaphore(ä¿¡å·é‡) CountDownLatch éƒ½æ˜¯æŒ‰ç…§è¿™ä¸ªç»“æ„å®ç°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ¥çœ‹ä¸€çœ‹ AQS çš„æ¨¡ç‰ˆæ–¹æ³•åˆ°åº•æ˜¯æ€ä¹ˆå®ç°é” AQSå®ç°åˆ†æä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä½ åº”è¯¥ç†è§£äº†lock.tryLock() éé˜»å¡å¼è·å–é”å°±æ˜¯è°ƒç”¨è‡ªå®šä¹‰åŒæ­¥å™¨é‡å†™çš„ tryAcquire() æ–¹æ³•ï¼Œé€šè¿‡ CAS è®¾ç½®state çŠ¶æ€ï¼Œä¸ç®¡æˆåŠŸä¸å¦éƒ½ä¼šé©¬ä¸Šè¿”å›ï¼›é‚£ä¹ˆ lock.lock() è¿™ç§é˜»å¡å¼çš„é”æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ æœ‰é˜»å¡å°±éœ€è¦æ’é˜Ÿï¼Œå®ç°æ’é˜Ÿå¿…ç„¶éœ€è¦é˜Ÿåˆ— CLHï¼šCraigã€Landin and Hagersten é˜Ÿåˆ—ï¼Œæ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ï¼ŒAQSä¸­çš„é˜Ÿåˆ—æ˜¯CLHå˜ä½“çš„è™šæ‹ŸåŒå‘é˜Ÿåˆ—ï¼ˆFIFOï¼‰â€”â€”æ¦‚å¿µäº†è§£å°±å¥½ï¼Œä¸è¦è®° é˜Ÿåˆ—ä¸­æ¯ä¸ªæ’é˜Ÿçš„ä¸ªä½“å°±æ˜¯ä¸€ä¸ª Nodeï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ Node çš„ç»“æ„ Node èŠ‚ç‚¹AQS å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—ï¼Œç”¨äºç®¡ç†åŒæ­¥çŠ¶æ€ã€‚ å½“çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€å¤±è´¥æ—¶ï¼Œå°±ä¼šå°†å½“å‰çº¿ç¨‹ä»¥åŠç­‰å¾…çŠ¶æ€ç­‰ä¿¡æ¯æ„é€ æˆä¸€ä¸ª Node èŠ‚ç‚¹ï¼Œå°†å…¶åŠ å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­å°¾éƒ¨ï¼Œé˜»å¡è¯¥çº¿ç¨‹ å½“åŒæ­¥çŠ¶æ€è¢«é‡Šæ”¾æ—¶ï¼Œä¼šå”¤é†’åŒæ­¥é˜Ÿåˆ—ä¸­â€œé¦–èŠ‚ç‚¹â€çš„çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€ ä¸ºäº†å°†ä¸Šè¿°æ­¥éª¤å¼„æ¸…æ¥šï¼Œæˆ‘ä»¬éœ€è¦æ¥çœ‹ä¸€çœ‹ Node ç»“æ„ ï¼ˆå¦‚æœä½ èƒ½æ‰“å¼€ IDE ä¸€èµ·çœ‹é‚£æ˜¯æå¥½çš„ï¼‰ ä¹ä¸€çœ‹æœ‰ç‚¹æ‚ä¹±ï¼Œæˆ‘ä»¬è¿˜æ˜¯å°†å…¶å½’ç±»è¯´æ˜ä¸€ä¸‹ï¼š ä¸Šé¢è¿™å‡ ä¸ªçŠ¶æ€è¯´æ˜æœ‰ä¸ªå°è±¡å°±å¥½ï¼Œæœ‰äº†Node çš„ç»“æ„è¯´æ˜é“ºå«ï¼Œä½ ä¹Ÿå°±èƒ½æƒ³è±¡åŒæ­¥é˜Ÿåˆ—çš„æ¥æœ¬ç»“æ„äº†ï¼š å‰ç½®çŸ¥è¯†åŸºæœ¬é“ºå«å®Œæ¯•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„æ•´ä¸ªè¿‡ç¨‹ ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€æ•…äº‹è¦ä»èŒƒå¼lock.lock() å¼€å§‹ 1234public void lock() &#123; // é˜»å¡å¼çš„è·å–é”ï¼Œè°ƒç”¨åŒæ­¥å™¨æ¨¡ç‰ˆæ–¹æ³•ï¼Œè·å–åŒæ­¥çŠ¶æ€ sync.acquire(1);&#125; è¿›å…¥AQSçš„æ¨¡ç‰ˆæ–¹æ³• acquire() 123456public final void acquire(int arg) &#123; // è°ƒç”¨è‡ªå®šä¹‰åŒæ­¥å™¨é‡å†™çš„ tryAcquire æ–¹æ³• if (!tryAcquire(arg) &amp;&amp; acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) selfInterrupt();&#125; é¦–å…ˆï¼Œä¹Ÿä¼šå°è¯•éé˜»å¡çš„è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœè·å–å¤±è´¥ï¼ˆtryAcquireè¿”å›falseï¼‰ï¼Œåˆ™ä¼šè°ƒç”¨ addWaiter æ–¹æ³•æ„é€  Node èŠ‚ç‚¹ï¼ˆNode.EXCLUSIVE ç‹¬å å¼ï¼‰å¹¶å®‰å…¨çš„ï¼ˆCASï¼‰åŠ å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ã€å°¾éƒ¨ã€‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647private Node addWaiter(Node mode) &#123; // æ„é€ NodeèŠ‚ç‚¹ï¼ŒåŒ…å«å½“å‰çº¿ç¨‹ä¿¡æ¯ä»¥åŠèŠ‚ç‚¹æ¨¡å¼ã€ç‹¬å /å…±äº«ã€‘ Node node = new Node(Thread.currentThread(), mode); // æ–°å»ºå˜é‡ pred å°†æŒ‡é’ˆæŒ‡å‘tailæŒ‡å‘çš„èŠ‚ç‚¹ Node pred = tail; // å¦‚æœå°¾èŠ‚ç‚¹ä¸ä¸ºç©º if (pred != null) &#123; // æ–°åŠ å…¥çš„èŠ‚ç‚¹å‰é©±èŠ‚ç‚¹æŒ‡å‘å°¾èŠ‚ç‚¹ node.prev = pred; // å› ä¸ºå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–åŒæ­¥çŠ¶æ€å¤±è´¥éƒ½ä¼šæ‰§è¡Œè¿™æ®µä»£ç  // æ‰€ä»¥ï¼Œé€šè¿‡ CAS æ–¹å¼ç¡®ä¿å®‰å…¨çš„è®¾ç½®å½“å‰èŠ‚ç‚¹ä¸ºæœ€æ–°çš„å°¾èŠ‚ç‚¹ if (compareAndSetTail(pred, node)) &#123; // æ›¾ç»çš„å°¾èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘å½“å‰èŠ‚ç‚¹ pred.next = node; // è¿”å›æ–°æ„å»ºçš„èŠ‚ç‚¹ return node; &#125; &#125; // å°¾èŠ‚ç‚¹ä¸ºç©ºï¼Œè¯´æ˜å½“å‰èŠ‚ç‚¹æ˜¯ç¬¬ä¸€ä¸ªè¢«åŠ å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ // éœ€è¦ä¸€ä¸ªå…¥é˜Ÿæ“ä½œ enq(node); return node;&#125;private Node enq(final Node node) &#123; // é€šè¿‡â€œæ­»å¾ªç¯â€ç¡®ä¿èŠ‚ç‚¹è¢«æ­£ç¡®æ·»åŠ ï¼Œæœ€ç»ˆå°†å…¶è®¾ç½®ä¸ºå°¾èŠ‚ç‚¹ä¹‹åæ‰ä¼šè¿”å›ï¼Œè¿™é‡Œä½¿ç”¨ CAS çš„ç†ç”±å’Œä¸Šé¢ä¸€æ · for (;;) &#123; Node t = tail; // ç¬¬ä¸€æ¬¡å¾ªç¯ï¼Œå¦‚æœå°¾èŠ‚ç‚¹ä¸º null if (t == null) &#123; // Must initialize // æ„å»ºä¸€ä¸ªå“¨å…µèŠ‚ç‚¹ï¼Œå¹¶å°†å¤´éƒ¨æŒ‡é’ˆæŒ‡å‘å®ƒ if (compareAndSetHead(new Node())) // å°¾éƒ¨æŒ‡é’ˆåŒæ ·æŒ‡å‘å“¨å…µèŠ‚ç‚¹ tail = head; &#125; else &#123; // ç¬¬äºŒæ¬¡å¾ªç¯ï¼Œå°†æ–°èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘t node.prev = t; // å°†æ–°èŠ‚ç‚¹åŠ å…¥åˆ°é˜Ÿåˆ—å°¾èŠ‚ç‚¹ if (compareAndSetTail(t, node)) &#123; // å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘å½“å‰æ–°èŠ‚ç‚¹ï¼Œå®ŒæˆåŒå‘é˜Ÿåˆ— t.next = node; return t; &#125; &#125; &#125;&#125; ä½ å¯èƒ½æ¯”è¾ƒè¿·æƒ‘ enq() çš„å¤„ç†æ–¹å¼ï¼Œè¿›å…¥è¯¥æ–¹æ³•å°±æ˜¯ä¸€ä¸ªâ€œæ­»å¾ªç¯â€ï¼Œæˆ‘ä»¬å°±ç”¨å›¾æ¥æè¿°å®ƒæ˜¯æ€æ ·è·³å‡ºå¾ªç¯çš„ æœ‰äº›åŒå­¦å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰å“¨å…µèŠ‚ç‚¹ï¼Ÿ å“¨å…µï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ç”¨æ¥è§£å†³å›½å®¶ä¹‹é—´è¾¹ç•Œé—®é¢˜çš„ï¼Œä¸ç›´æ¥å‚ä¸ç”Ÿäº§æ´»åŠ¨ã€‚åŒæ ·ï¼Œè®¡ç®—æœºç§‘å­¦ä¸­æåˆ°çš„å“¨å…µï¼Œä¹Ÿç”¨æ¥è§£å†³è¾¹ç•Œé—®é¢˜ï¼Œå¦‚æœæ²¡æœ‰è¾¹ç•Œï¼ŒæŒ‡å®šç¯èŠ‚ï¼ŒæŒ‰ç…§åŒæ ·ç®—æ³•å¯èƒ½ä¼šåœ¨è¾¹ç•Œå¤„å‘ç”Ÿå¼‚å¸¸ï¼Œæ¯”å¦‚è¦ç»§ç»­å‘ä¸‹åˆ†æçš„ acquireQueued() æ–¹æ³• 123456789101112131415161718192021222324252627282930final boolean acquireQueued(final Node node, int arg) &#123; boolean failed = true; try &#123; boolean interrupted = false; // \"æ­»å¾ªç¯\"ï¼Œå°è¯•è·å–é”ï¼Œæˆ–è€…æŒ‚èµ· for (;;) &#123; // è·å–å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ final Node p = node.predecessor(); // åªæœ‰å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯å¤´èŠ‚ç‚¹ï¼Œæ‰ä¼šå°è¯•è·å–é” // çœ‹åˆ°è¿™ä½ åº”è¯¥ç†è§£æ·»åŠ å“¨å…µèŠ‚ç‚¹çš„å«ä¹‰äº†å§ if (p == head &amp;&amp; tryAcquire(arg)) &#123; // è·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œå°†è‡ªå·±è®¾ç½®ä¸ºå¤´ setHead(node); // å°†å“¨å…µèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ç½®ä¸ºç©ºï¼Œæ–¹ä¾¿GC p.next = null; // help GC failed = false; // è¿”å›ä¸­æ–­æ ‡è¯† return interrupted; &#125; // å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ä¸æ˜¯å¤´èŠ‚ç‚¹ //ã€æˆ–è€…ã€‘å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯å¤´èŠ‚ç‚¹ä½†è·å–åŒæ­¥çŠ¶æ€å¤±è´¥ if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; parkAndCheckInterrupt()) interrupted = true; &#125; &#125; finally &#123; if (failed) cancelAcquire(node); &#125;&#125; è·å–åŒæ­¥çŠ¶æ€æˆåŠŸä¼šè¿”å›å¯ä»¥ç†è§£äº†ï¼Œä½†æ˜¯å¦‚æœå¤±è´¥å°±ä¼šä¸€ç›´é™·å…¥åˆ°â€œæ­»å¾ªç¯â€ä¸­æµªè´¹èµ„æºå—ï¼Ÿå¾ˆæ˜¾ç„¶ä¸æ˜¯ï¼ŒshouldParkAfterFailedAcquire(p, node) å’Œ parkAndCheckInterrupt() å°±ä¼šå°†çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€å¤±è´¥çš„çº¿ç¨‹æŒ‚èµ·ï¼Œæˆ‘ä»¬ç»§ç»­å‘ä¸‹çœ‹ 123456789101112131415161718192021private static boolean shouldParkAfterFailedAcquire(Node pred, Node node) &#123; // è·å–å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€ int ws = pred.waitStatus; // å¦‚æœæ˜¯ SIGNAL çŠ¶æ€ï¼Œå³ç­‰å¾…è¢«å ç”¨çš„èµ„æºé‡Šæ”¾ï¼Œç›´æ¥è¿”å› true // å‡†å¤‡ç»§ç»­è°ƒç”¨ parkAndCheckInterrupt æ–¹æ³• if (ws == Node.SIGNAL) return true; // ws å¤§äº0è¯´æ˜æ˜¯CANCELLEDçŠ¶æ€ï¼Œ if (ws &gt; 0) &#123; // å¾ªç¯åˆ¤æ–­å‰é©±èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯å¦ä¹Ÿä¸ºCANCELLEDçŠ¶æ€ï¼Œå¿½ç•¥è¯¥çŠ¶æ€çš„èŠ‚ç‚¹ï¼Œé‡æ–°è¿æ¥é˜Ÿåˆ— do &#123; node.prev = pred = pred.prev; &#125; while (pred.waitStatus &gt; 0); pred.next = node; &#125; else &#123; // å°†å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹è®¾ç½®ä¸ºè®¾ç½®ä¸º SIGNAL çŠ¶æ€ï¼Œç”¨äºåç»­å”¤é†’æ“ä½œ // ç¨‹åºç¬¬ä¸€æ¬¡æ‰§è¡Œåˆ°è¿™è¿”å›ä¸ºfalseï¼Œè¿˜ä¼šè¿›è¡Œå¤–å±‚ç¬¬äºŒæ¬¡å¾ªç¯ï¼Œæœ€ç»ˆä»ä»£ç ç¬¬7è¡Œè¿”å› compareAndSetWaitStatus(pred, ws, Node.SIGNAL); &#125; return false;&#125; åˆ°è¿™é‡Œä½ ä¹Ÿè®¸æœ‰ä¸ªé—®é¢˜ï¼š è¿™ä¸ªåœ°æ–¹è®¾ç½®å‰é©±èŠ‚ç‚¹ä¸º SIGNAL çŠ¶æ€åˆ°åº•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ ä¿ç•™è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é™†ç»­æ­æ™“ å¦‚æœå‰é©±èŠ‚ç‚¹çš„ waitStatus æ˜¯ SIGNALçŠ¶æ€ï¼Œå³ shouldParkAfterFailedAcquire æ–¹æ³•ä¼šè¿”å› true ï¼Œç¨‹åºä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œ parkAndCheckInterrupt æ–¹æ³•ï¼Œç”¨äºå°†å½“å‰çº¿ç¨‹æŒ‚èµ· 123456789101112private final boolean parkAndCheckInterrupt() &#123; // çº¿ç¨‹æŒ‚èµ·ï¼Œç¨‹åºä¸ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œ LockSupport.park(this); // æ ¹æ® park æ–¹æ³• APIæè¿°ï¼Œç¨‹åºåœ¨ä¸‹è¿°ä¸‰ç§æƒ…å†µä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œ // 1. è¢« unpark // 2. è¢«ä¸­æ–­(interrupt) // 3. å…¶ä»–ä¸åˆé€»è¾‘çš„è¿”å›æ‰ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œ // å› ä¸Šè¿°ä¸‰ç§æƒ…å†µç¨‹åºæ‰§è¡Œè‡³æ­¤ï¼Œè¿”å›å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå¹¶æ¸…ç©ºä¸­æ–­çŠ¶æ€ // å¦‚æœç”±äºè¢«ä¸­æ–­ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å› true return Thread.interrupted();&#125; è¢«å”¤é†’çš„ç¨‹åºä¼šç»§ç»­æ‰§è¡Œ acquireQueued æ–¹æ³•é‡Œçš„å¾ªç¯ï¼Œå¦‚æœè·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œåˆ™ä¼šè¿”å› interrupted = true çš„ç»“æœ ç¨‹åºç»§ç»­å‘è°ƒç”¨æ ˆä¸Šå±‚è¿”å›ï¼Œæœ€ç»ˆå›åˆ° AQS çš„æ¨¡ç‰ˆæ–¹æ³• acquire 12345public final void acquire(int arg) &#123; if (!tryAcquire(arg) &amp;&amp; acquireQueued(addWaiter(Node.EXCLUSIVE), arg)) selfInterrupt();&#125; ä½ ä¹Ÿè®¸ä¼šæœ‰ç–‘æƒ‘: ç¨‹åºå·²ç»æˆåŠŸè·å–åˆ°åŒæ­¥çŠ¶æ€å¹¶è¿”å›äº†ï¼Œæ€ä¹ˆä¼šæœ‰ä¸ªè‡ªæˆ‘ä¸­æ–­å‘¢ï¼Ÿ 123static void selfInterrupt() &#123; Thread.currentThread().interrupt();&#125; å¦‚æœä½ ä¸èƒ½ç†è§£ä¸­æ–­ï¼Œå¼ºçƒˆå»ºè®®ä½ å›çœ‹ Javaå¤šçº¿ç¨‹ä¸­æ–­æœºåˆ¶ åˆ°è¿™é‡Œå…³äºè·å–åŒæ­¥çŠ¶æ€æˆ‘ä»¬è¿˜é—æ¼äº†ä¸€æ¡çº¿ï¼ŒacquireQueued çš„ finally ä»£ç å—å¦‚æœä½ ä»”ç»†çœ‹ä½ ä¹Ÿè®¸é©¬ä¸Šå°±ä¼šæœ‰ç–‘æƒ‘: åˆ°åº•ä»€ä¹ˆæƒ…å†µæ‰ä¼šæ‰§è¡Œ if(failed) é‡Œé¢çš„ä»£ç  ï¼Ÿ 12if (failed) cancelAcquire(node); è¿™æ®µä»£ç è¢«æ‰§è¡Œçš„æ¡ä»¶æ˜¯ failed ä¸º trueï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœè·³å‡ºå¾ªç¯ï¼Œfailed çš„å€¼ä¸ºfalseï¼Œå¦‚æœä¸èƒ½è·³å‡ºå¾ªç¯è²Œä¼¼æ€ä¹ˆä¹Ÿä¸èƒ½æ‰§è¡Œåˆ°è¿™é‡Œï¼Œæ‰€ä»¥åªæœ‰ä¸æ­£å¸¸çš„æƒ…å†µæ‰ä¼šæ‰§è¡Œåˆ°è¿™é‡Œï¼Œä¹Ÿå°±æ˜¯ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œæ‰ä¼šæ‰§è¡Œåˆ°æ­¤å¤„ æŸ¥çœ‹ try ä»£ç å—ï¼Œåªæœ‰ä¸¤ä¸ªæ–¹æ³•ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š node.processor() æ–¹æ³• è‡ªå·±é‡å†™çš„ tryAcquire() æ–¹æ³• å…ˆçœ‹å‰è€…ï¼š å¾ˆæ˜¾ç„¶ï¼Œè¿™é‡ŒæŠ›å‡ºçš„å¼‚å¸¸ä¸æ˜¯é‡ç‚¹ï¼Œé‚£å°±ä»¥ ReentrantLock é‡å†™çš„ tryAcquire() æ–¹æ³•ä¸ºä¾‹ å¦å¤–ï¼Œä¸Šé¢åˆ†æ shouldParkAfterFailedAcquire æ–¹æ³•è¿˜å¯¹ CANCELLED çš„çŠ¶æ€è¿›è¡Œäº†åˆ¤æ–­ï¼Œé‚£ä¹ˆ ä»€ä¹ˆæ—¶å€™ä¼šç”Ÿæˆå–æ¶ˆçŠ¶æ€çš„èŠ‚ç‚¹å‘¢ï¼Ÿ ç­”æ¡ˆå°±åœ¨ cancelAcquire æ–¹æ³•ä¸­ï¼Œ æˆ‘ä»¬æ¥çœ‹çœ‹ cancelAcquireåˆ°åº•æ€ä¹ˆè®¾ç½®/å¤„ç† CANNELLED çš„ 12345678910111213141516171819202122232425262728293031323334353637383940414243private void cancelAcquire(Node node) &#123; // å¿½ç•¥æ— æ•ˆèŠ‚ç‚¹ if (node == null) return; // å°†å…³è”çš„çº¿ç¨‹ä¿¡æ¯æ¸…ç©º node.thread = null; // è·³è¿‡åŒæ ·æ˜¯å–æ¶ˆçŠ¶æ€çš„å‰é©±èŠ‚ç‚¹ Node pred = node.prev; while (pred.waitStatus &gt; 0) node.prev = pred = pred.prev; // è·³å‡ºä¸Šé¢å¾ªç¯åæ‰¾åˆ°å‰é©±æœ‰æ•ˆèŠ‚ç‚¹ï¼Œå¹¶è·å–è¯¥æœ‰æ•ˆèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ Node predNext = pred.next; // å°†å½“å‰èŠ‚ç‚¹çš„çŠ¶æ€ç½®ä¸º CANCELLED node.waitStatus = Node.CANCELLED; // å¦‚æœå½“å‰èŠ‚ç‚¹å¤„åœ¨å°¾èŠ‚ç‚¹ï¼Œç›´æ¥ä»é˜Ÿåˆ—ä¸­åˆ é™¤è‡ªå·±å°±å¥½ if (node == tail &amp;&amp; compareAndSetTail(node, pred)) &#123; compareAndSetNext(pred, predNext, null); &#125; else &#123; int ws; // 1. å¦‚æœå½“å‰èŠ‚ç‚¹çš„æœ‰æ•ˆå‰é©±èŠ‚ç‚¹ä¸æ˜¯å¤´èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰èŠ‚ç‚¹ä¸æ˜¯å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ if (pred != head &amp;&amp; // 2. åˆ¤æ–­å½“å‰èŠ‚ç‚¹æœ‰æ•ˆå‰é©±èŠ‚ç‚¹çš„çŠ¶æ€æ˜¯å¦ä¸º SIGNAL ((ws = pred.waitStatus) == Node.SIGNAL || // 3. å¦‚æœä¸æ˜¯ï¼Œå°è¯•å°†å‰é©±èŠ‚ç‚¹çš„çŠ¶æ€ç½®ä¸º SIGNAL (ws &lt;= 0 &amp;&amp; compareAndSetWaitStatus(pred, ws, Node.SIGNAL))) &amp;&amp; // åˆ¤æ–­å½“å‰èŠ‚ç‚¹æœ‰æ•ˆå‰é©±èŠ‚ç‚¹çš„çº¿ç¨‹ä¿¡æ¯æ˜¯å¦ä¸ºç©º pred.thread != null) &#123; // ä¸Šè¿°æ¡ä»¶æ»¡è¶³ Node next = node.next; // å°†å½“å‰èŠ‚ç‚¹æœ‰æ•ˆå‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ if (next != null &amp;&amp; next.waitStatus &lt;= 0) compareAndSetNext(pred, predNext, next); &#125; else &#123; // å¦‚æœå½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯å¤´èŠ‚ç‚¹ï¼Œæˆ–è€…ä¸Šè¿°å…¶ä»–æ¡ä»¶ä¸æ»¡è¶³ï¼Œå°±å”¤é†’å½“å‰èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ unparkSuccessor(node); &#125; node.next = node; // help GC &#125; çœ‹åˆ°è¿™ä¸ªæ³¨é‡Šä½ å¯èƒ½æœ‰äº›ä¹±äº†ï¼Œå…¶æ ¸å¿ƒç›®çš„å°±æ˜¯ä»ç­‰å¾…é˜Ÿåˆ—ä¸­ç§»é™¤ CANCELLED çš„èŠ‚ç‚¹ï¼Œå¹¶é‡æ–°æ‹¼æ¥æ•´ä¸ªé˜Ÿåˆ—ï¼Œæ€»ç»“æ¥çœ‹ï¼Œå…¶å®è®¾ç½® CANCELLED çŠ¶æ€èŠ‚ç‚¹åªæ˜¯æœ‰ä¸‰ç§æƒ…å†µï¼Œæˆ‘ä»¬é€šè¿‡ç”»å›¾æ¥åˆ†æä¸€ä¸‹ï¼š è‡³æ­¤ï¼Œè·å–åŒæ­¥çŠ¶æ€çš„è¿‡ç¨‹å°±ç»“æŸäº†ï¼Œæˆ‘ä»¬ç®€å•çš„ç”¨æµç¨‹å›¾è¯´æ˜ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ è·å–é”çš„è¿‡ç¨‹å°±è¿™æ ·çš„ç»“æŸäº†ï¼Œå…ˆæš‚åœå‡ åˆ†é’Ÿæ•´ç†ä¸€ä¸‹è‡ªå·±çš„æ€è·¯ã€‚æˆ‘ä»¬ä¸Šé¢è¿˜æ²¡æœ‰è¯´æ˜ SIGNAL çš„ä½œç”¨ï¼Œ SIGNAL çŠ¶æ€ä¿¡å·åˆ°åº•æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿè¿™å°±æ¶‰åŠåˆ°é”çš„é‡Šæ”¾äº†ï¼Œæˆ‘ä»¬æ¥ç»§ç»­äº†è§£ï¼Œæ•´ä½“æ€è·¯å’Œé”çš„è·å–æ˜¯ä¸€æ ·çš„ï¼Œ ä½†æ˜¯é‡Šæ”¾è¿‡ç¨‹å°±ç›¸å¯¹ç®€å•å¾ˆå¤šäº† ç‹¬å å¼é‡Šæ”¾åŒæ­¥çŠ¶æ€æ•…äº‹è¦ä» unlock() æ–¹æ³•è¯´èµ· 1234public void unlock() &#123; // é‡Šæ”¾é” sync.release(1);&#125; è°ƒç”¨ AQS æ¨¡ç‰ˆæ–¹æ³• releaseï¼Œè¿›å…¥è¯¥æ–¹æ³• 1234567891011121314public final boolean release(int arg) &#123; // è°ƒç”¨è‡ªå®šä¹‰åŒæ­¥å™¨é‡å†™çš„ tryRelease æ–¹æ³•å°è¯•é‡Šæ”¾åŒæ­¥çŠ¶æ€ if (tryRelease(arg)) &#123; // é‡Šæ”¾æˆåŠŸï¼Œè·å–å¤´èŠ‚ç‚¹ Node h = head; // å­˜åœ¨å¤´èŠ‚ç‚¹ï¼Œå¹¶ä¸”waitStatusä¸æ˜¯åˆå§‹çŠ¶æ€ // é€šè¿‡è·å–çš„è¿‡ç¨‹æˆ‘ä»¬å·²ç»åˆ†æäº†ï¼Œåœ¨è·å–çš„è¿‡ç¨‹ä¸­ä¼šå°† waitStatusçš„å€¼ä»åˆå§‹çŠ¶æ€æ›´æ–°æˆ SIGNAL çŠ¶æ€ if (h != null &amp;&amp; h.waitStatus != 0) // è§£é™¤çº¿ç¨‹æŒ‚èµ·çŠ¶æ€ unparkSuccessor(h); return true; &#125; return false;&#125; æŸ¥çœ‹ unparkSuccessor æ–¹æ³•ï¼Œå®é™…æ˜¯è¦å”¤é†’å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ 12345678910111213141516171819202122private void unparkSuccessor(Node node) &#123; // è·å–å¤´èŠ‚ç‚¹çš„waitStatus int ws = node.waitStatus; if (ws &lt; 0) // æ¸…ç©ºå¤´èŠ‚ç‚¹çš„waitStatuså€¼ï¼Œå³ç½®ä¸º0 compareAndSetWaitStatus(node, ws, 0); // è·å–å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ Node s = node.next; // åˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ˜¯å¦æ˜¯å–æ¶ˆçŠ¶æ€ï¼Œå¦‚æœæ˜¯ï¼Œéœ€è¦ç§»é™¤ï¼Œé‡æ–°è¿æ¥é˜Ÿåˆ— if (s == null || s.waitStatus &gt; 0) &#123; s = null; // ä»å°¾èŠ‚ç‚¹å‘å‰æŸ¥æ‰¾ï¼Œæ‰¾åˆ°é˜Ÿåˆ—ç¬¬ä¸€ä¸ªwaitStatusçŠ¶æ€å°äº0çš„èŠ‚ç‚¹ for (Node t = tail; t != null &amp;&amp; t != node; t = t.prev) // å¦‚æœæ˜¯ç‹¬å å¼ï¼Œè¿™é‡Œå°äº0ï¼Œå…¶å®å°±æ˜¯ SIGNAL if (t.waitStatus &lt;= 0) s = t; &#125; if (s != null) // è§£é™¤çº¿ç¨‹æŒ‚èµ·çŠ¶æ€ LockSupport.unpark(s.thread);&#125; æœ‰åŒå­¦å¯èƒ½æœ‰ç–‘é—®ï¼š ä¸ºä»€ä¹ˆè¿™ä¸ªåœ°æ–¹æ˜¯ä»é˜Ÿåˆ—å°¾éƒ¨å‘å‰æŸ¥æ‰¾ä¸æ˜¯ CANCELLED çš„èŠ‚ç‚¹ï¼Ÿ åŸå› æœ‰ä¸¤ä¸ªï¼š ç¬¬ä¸€ï¼Œå…ˆå›çœ‹èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—çš„æƒ…æ™¯ï¼š 1234567891011121314private Node addWaiter(Node mode) &#123; Node node = new Node(Thread.currentThread(), mode); // Try the fast path of enq; backup to full enq on failure Node pred = tail; if (pred != null) &#123; node.prev = pred; if (compareAndSetTail(pred, node)) &#123; pred.next = node; return node; &#125; &#125; enq(node); return node;&#125; èŠ‚ç‚¹å…¥é˜Ÿå¹¶ä¸æ˜¯åŸå­æ“ä½œï¼Œä»£ç ç¬¬6ã€7è¡Œ 12node.prev = pred; compareAndSetTail(pred, node) è¿™ä¸¤ä¸ªåœ°æ–¹å¯ä»¥çœ‹ä½œæ˜¯å°¾èŠ‚ç‚¹å…¥é˜Ÿçš„åŸå­æ“ä½œï¼Œå¦‚æœæ­¤æ—¶ä»£ç è¿˜æ²¡æ‰§è¡Œåˆ° pred.next = node; è¿™æ—¶åˆæ°å·§æ‰§è¡Œäº†unparkSuccessoræ–¹æ³•ï¼Œå°±æ²¡åŠæ³•ä»å‰å¾€åæ‰¾äº†ï¼Œå› ä¸ºåç»§æŒ‡é’ˆè¿˜æ²¡æœ‰è¿æ¥èµ·æ¥ï¼Œæ‰€ä»¥éœ€è¦ä»åå¾€å‰æ‰¾ ç¬¬äºŒç‚¹åŸå› ï¼Œåœ¨ä¸Šé¢å›¾è§£äº§ç”Ÿ CANCELLED çŠ¶æ€èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå…ˆæ–­å¼€çš„æ˜¯ Next æŒ‡é’ˆï¼ŒPrevæŒ‡é’ˆå¹¶æœªæ–­å¼€ï¼Œå› æ­¤è¿™ä¹Ÿæ˜¯å¿…é¡»è¦ä»åå¾€å‰éå†æ‰èƒ½å¤Ÿéå†å®Œå…¨éƒ¨çš„Node åŒæ­¥çŠ¶æ€è‡³æ­¤å°±å·²ç»æˆåŠŸé‡Šæ”¾äº†ï¼Œä¹‹å‰è·å–åŒæ­¥çŠ¶æ€è¢«æŒ‚èµ·çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’ï¼Œç»§ç»­ä»ä¸‹é¢ä»£ç ç¬¬ 3 è¡Œè¿”å›æ‰§è¡Œï¼š 1234private final boolean parkAndCheckInterrupt() &#123; LockSupport.park(this); return Thread.interrupted();&#125; ç»§ç»­è¿”å›ä¸Šå±‚è°ƒç”¨æ ˆ, ä»ä¸‹é¢ä»£ç 15è¡Œå¼€å§‹æ‰§è¡Œï¼Œé‡æ–°æ‰§è¡Œå¾ªç¯ï¼Œå†æ¬¡å°è¯•è·å–åŒæ­¥çŠ¶æ€ 123456789101112131415161718192021final boolean acquireQueued(final Node node, int arg) &#123; boolean failed = true; try &#123; boolean interrupted = false; for (;;) &#123; final Node p = node.predecessor(); if (p == head &amp;&amp; tryAcquire(arg)) &#123; setHead(node); p.next = null; // help GC failed = false; return interrupted; &#125; if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; parkAndCheckInterrupt()) interrupted = true; &#125; &#125; finally &#123; if (failed) cancelAcquire(node); &#125;&#125; åˆ°è¿™é‡Œï¼Œå…³äºç‹¬å å¼è·å–/é‡Šæ”¾é”çš„æµç¨‹å·²ç»é—­ç¯äº†ï¼Œä½†æ˜¯å…³äº AQS çš„å¦å¤–ä¸¤ä¸ªæ¨¡ç‰ˆæ–¹æ³•è¿˜æ²¡æœ‰ä»‹ç» å“åº”ä¸­æ–­ è¶…æ—¶é™åˆ¶ ç‹¬å å¼å“åº”ä¸­æ–­è·å–åŒæ­¥çŠ¶æ€æ•…äº‹è¦ä»lock.lockInterruptibly() æ–¹æ³•è¯´èµ· 1234public void lockInterruptibly() throws InterruptedException &#123; // è°ƒç”¨åŒæ­¥å™¨æ¨¡ç‰ˆæ–¹æ³•å¯ä¸­æ–­å¼è·å–åŒæ­¥çŠ¶æ€ sync.acquireInterruptibly(1);&#125; æœ‰äº†å‰é¢çš„ç†è§£ï¼Œç†è§£ç‹¬å å¼å¯å“åº”ä¸­æ–­çš„è·å–åŒæ­¥çŠ¶æ€æ–¹å¼ï¼ŒçœŸæ˜¯ä¸€çœ¼å°±èƒ½æ˜ç™½äº†ï¼š 12345678public final void acquireInterruptibly(int arg) throws InterruptedException &#123; if (Thread.interrupted()) throw new InterruptedException(); // å°è¯•éé˜»å¡å¼è·å–åŒæ­¥çŠ¶æ€å¤±è´¥ï¼Œå¦‚æœæ²¡æœ‰è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œæ‰§è¡Œä»£ç 7è¡Œ if (!tryAcquire(arg)) doAcquireInterruptibly(arg);&#125; ç»§ç»­æŸ¥çœ‹ doAcquireInterruptibly æ–¹æ³•ï¼š 1234567891011121314151617181920212223private void doAcquireInterruptibly(int arg) throws InterruptedException &#123; final Node node = addWaiter(Node.EXCLUSIVE); boolean failed = true; try &#123; for (;;) &#123; final Node p = node.predecessor(); if (p == head &amp;&amp; tryAcquire(arg)) &#123; setHead(node); p.next = null; // help GC failed = false; return; &#125; if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; parkAndCheckInterrupt()) // è·å–ä¸­æ–­ä¿¡å·åï¼Œä¸å†è¿”å› interrupted = true çš„å€¼ï¼Œè€Œæ˜¯ç›´æ¥æŠ›å‡º InterruptedException throw new InterruptedException(); &#125; &#125; finally &#123; if (failed) cancelAcquire(node); &#125;&#125; æ²¡æƒ³åˆ° JDK å†…éƒ¨ä¹Ÿæœ‰å¦‚æ­¤ç›¸è¿‘çš„ä»£ç ï¼Œå¯å“åº”ä¸­æ–­è·å–é”æ²¡ä»€ä¹ˆæ·±å¥¥çš„ï¼Œå°±æ˜¯è¢«ä¸­æ–­æŠ›å‡º InterruptedException å¼‚å¸¸ï¼ˆä»£ç ç¬¬17è¡Œï¼‰ï¼Œè¿™æ ·å°±é€å±‚è¿”å›ä¸Šå±‚è°ƒç”¨æ ˆæ•è·è¯¥å¼‚å¸¸è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œäº† è¶çƒ­æ‰“é“ï¼Œæ¥çœ‹çœ‹å¦å¤–ä¸€ä¸ªæ¨¡ç‰ˆæ–¹æ³•ï¼š ç‹¬å å¼è¶…æ—¶é™åˆ¶è·å–åŒæ­¥çŠ¶æ€è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ç»™å®šä¸€ä¸ªæ—¶é™ï¼Œåœ¨è¯¥æ—¶é—´æ®µå†…è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œå°±è¿”å› trueï¼Œ å¦åˆ™ï¼Œè¿”å› falseã€‚å¥½æ¯”çº¿ç¨‹ç»™è‡ªå·±å®šäº†ä¸€ä¸ªé—¹é’Ÿï¼Œé—¹é“ƒä¸€å“ï¼Œçº¿ç¨‹å°±è‡ªå·±è¿”å›äº†ï¼Œè¿™å°±ä¸ä¼šä½¿è‡ªå·±æ˜¯é˜»å¡çŠ¶æ€äº† æ—¢ç„¶æ¶‰åŠåˆ°è¶…æ—¶é™åˆ¶ï¼Œå…¶æ ¸å¿ƒé€»è¾‘è‚¯å®šæ˜¯è®¡ç®—æ—¶é—´é—´éš”ï¼Œå› ä¸ºåœ¨è¶…æ—¶æ—¶é—´å†…ï¼Œè‚¯å®šæ˜¯å¤šæ¬¡å°è¯•è·å–é”çš„ï¼Œæ¯æ¬¡è·å–é”è‚¯å®šæœ‰æ—¶é—´æ¶ˆè€—ï¼Œæ‰€ä»¥è®¡ç®—æ—¶é—´é—´éš”çš„é€»è¾‘å°±åƒæˆ‘ä»¬åœ¨ç¨‹åºæ‰“å°ç¨‹åºè€—æ—¶ log é‚£ä¹ˆç®€å• nanosTimeout = deadline - System.nanoTime() æ•…äº‹è¦ä» lock.tryLock(time, unit) æ–¹æ³•è¯´èµ· 1234public boolean tryLock(long time, TimeUnit unit) throws InterruptedException &#123; // è°ƒç”¨åŒæ­¥å™¨æ¨¡ç‰ˆæ–¹æ³•ï¼Œå¯å“åº”ä¸­æ–­å’Œè¶…æ—¶æ—¶é—´é™åˆ¶ return sync.tryAcquireNanos(1, unit.toNanos(time));&#125; æ¥çœ‹ tryAcquireNanos æ–¹æ³• 1234567public final boolean tryAcquireNanos(int arg, long nanosTimeout) throws InterruptedException &#123; if (Thread.interrupted()) throw new InterruptedException(); return tryAcquire(arg) || doAcquireNanos(arg, nanosTimeout);&#125; æ˜¯ä¸æ˜¯å’Œä¸Šé¢ acquireInterruptibly æ–¹æ³•é•¿ç›¸å¾ˆè¯¦ç»†äº†ï¼Œç»§ç»­æŸ¥çœ‹æ¥ doAcquireNanos æ–¹æ³•ï¼Œçœ‹ç¨‹åº, è¯¥æ–¹æ³•ä¹Ÿæ˜¯ throws InterruptedExceptionï¼Œæˆ‘ä»¬åœ¨ä¸­æ–­æ–‡ç« ä¸­è¯´è¿‡ï¼Œæ–¹æ³•æ ‡è®°ä¸Šæœ‰ throws InterruptedException è¯´æ˜è¯¥æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥å“åº”ä¸­æ–­çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç†è§£è¶…æ—¶é™åˆ¶æ˜¯ acquireInterruptibly æ–¹æ³•çš„åŠ å¼ºç‰ˆï¼Œå…·æœ‰è¶…æ—¶å’Œéé˜»å¡æ§åˆ¶çš„åŒä¿é™© 12345678910111213141516171819202122232425262728293031323334353637private boolean doAcquireNanos(int arg, long nanosTimeout) throws InterruptedException &#123; // è¶…æ—¶æ—¶é—´å†…ï¼Œä¸ºè·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œç›´æ¥è¿”å›false if (nanosTimeout &lt;= 0L) return false; // è®¡ç®—è¶…æ—¶æˆªæ­¢æ—¶é—´ final long deadline = System.nanoTime() + nanosTimeout; // ä»¥ç‹¬å æ–¹å¼åŠ å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ final Node node = addWaiter(Node.EXCLUSIVE); boolean failed = true; try &#123; for (;;) &#123; final Node p = node.predecessor(); if (p == head &amp;&amp; tryAcquire(arg)) &#123; setHead(node); p.next = null; // help GC failed = false; return true; &#125; // è®¡ç®—æ–°çš„è¶…æ—¶æ—¶é—´ nanosTimeout = deadline - System.nanoTime(); // å¦‚æœè¶…æ—¶ï¼Œç›´æ¥è¿”å› false if (nanosTimeout &lt;= 0L) return false; if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; // åˆ¤æ–­æ˜¯æœ€æ–°è¶…æ—¶æ—¶é—´æ˜¯å¦å¤§äºé˜ˆå€¼ 1000 nanosTimeout &gt; spinForTimeoutThreshold) // æŒ‚èµ·çº¿ç¨‹ nanosTimeout é•¿æ—¶é—´ï¼Œæ—¶é—´åˆ°ï¼Œè‡ªåŠ¨è¿”å› LockSupport.parkNanos(this, nanosTimeout); if (Thread.interrupted()) throw new InterruptedException(); &#125; &#125; finally &#123; if (failed) cancelAcquire(node); &#125;&#125; ä¸Šé¢çš„æ–¹æ³•åº”è¯¥ä¸æ˜¯å¾ˆéš¾æ‡‚ï¼Œä½†æ˜¯åˆåŒå­¦å¯èƒ½åœ¨ç¬¬ 27 è¡Œä¸Šæœ‰æ‰€å›°æƒ‘ ä¸ºä»€ä¹ˆ nanosTimeout å’Œ è‡ªæ—‹è¶…æ—¶é˜ˆå€¼1000è¿›è¡Œæ¯”è¾ƒï¼Ÿ 123456/** * The number of nanoseconds for which it is faster to spin * rather than to use timed park. A rough estimate suffices * to improve responsiveness with very short timeouts. */static final long spinForTimeoutThreshold = 1000L; å…¶å® doc è¯´çš„å¾ˆæ¸…æ¥šï¼Œè¯´ç™½äº†ï¼Œ1000 nanoseconds æ—¶é—´å·²ç»éå¸¸éå¸¸çŸ­æš‚äº†ï¼Œæ²¡å¿…è¦å†æ‰§è¡ŒæŒ‚èµ·å’Œå”¤é†’æ“ä½œäº†ï¼Œä¸å¦‚ç›´æ¥å½“å‰çº¿ç¨‹ç›´æ¥è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ MyMutex åªå·® Condition æ²¡æœ‰è¯´æ˜äº†ï¼Œä¸çŸ¥é“ä½ ç´¯äº†å—ï¼Ÿæˆ‘è¿˜åœ¨åšæŒ Conditionå¦‚æœä½ çœ‹è¿‡ä¹‹å‰å†™çš„ å¹¶å‘ç¼–ç¨‹ä¹‹ç­‰å¾…é€šçŸ¥æœºåˆ¶ ï¼Œä½ åº”è¯¥å¯¹ä¸‹é¢è¿™ä¸ªå›¾æ˜¯æœ‰å°è±¡çš„ï¼š å¦‚æœå½“æ—¶ä½ ç†è§£äº†è¿™ä¸ªæ¨¡å‹ï¼Œå†çœ‹ Condition çš„å®ç°ï¼Œæ ¹æœ¬å°±ä¸æ˜¯é—®é¢˜äº†ï¼Œé¦–å…ˆ Condition è¿˜æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè‚¯å®šä¹Ÿæ˜¯éœ€è¦æœ‰å®ç°ç±»çš„ é‚£æ•…äº‹å°±ä» lock.newnewCondition è¯´èµ·å§ 1234public Condition newCondition() &#123; // ä½¿ç”¨è‡ªå®šä¹‰çš„æ¡ä»¶ return sync.newCondition();&#125; è‡ªå®šä¹‰åŒæ­¥å™¨é‡å°è£…äº†è¯¥æ–¹æ³•ï¼š 123Condition newCondition() &#123; return new ConditionObject();&#125; ConditionObject å°±æ˜¯ Condition çš„å®ç°ç±»ï¼Œè¯¥ç±»å°±å®šä¹‰åœ¨äº† AQS ä¸­ï¼Œåªæœ‰ä¸¤ä¸ªæˆå‘˜å˜é‡ï¼š 1234/** First node of condition queue. */private transient Node firstWaiter;/** Last node of condition queue. */private transient Node lastWaiter; æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ¥çœ‹ä¸€ä¸‹ ConditionObject å®ç°çš„ await / signal æ–¹æ³•æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªæˆå‘˜å˜é‡å°±å¯ä»¥äº† 123456789101112131415161718192021public final void await() throws InterruptedException &#123; if (Thread.interrupted()) throw new InterruptedException(); // åŒæ ·æ„å»º Node èŠ‚ç‚¹ï¼Œå¹¶åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ Node node = addConditionWaiter(); // é‡Šæ”¾åŒæ­¥çŠ¶æ€ int savedState = fullyRelease(node); int interruptMode = 0; while (!isOnSyncQueue(node)) &#123; // æŒ‚èµ·å½“å‰çº¿ç¨‹ LockSupport.park(this); if ((interruptMode = checkInterruptWhileWaiting(node)) != 0) break; &#125; if (acquireQueued(node, savedState) &amp;&amp; interruptMode != THROW_IE) interruptMode = REINTERRUPT; if (node.nextWaiter != null) // clean up if cancelled unlinkCancelledWaiters(); if (interruptMode != 0) reportInterruptAfterWait(interruptMode);&#125; è¿™é‡Œæ³¨æ„ç”¨è¯ï¼Œåœ¨ä»‹ç»è·å–åŒæ­¥çŠ¶æ€æ—¶ï¼ŒaddWaiter æ˜¯åŠ å…¥åˆ°ã€åŒæ­¥é˜Ÿåˆ—ã€‘ï¼Œå°±æ˜¯ä¸Šå›¾è¯´çš„å…¥å£ç­‰å¾…é˜Ÿåˆ—ï¼Œè¿™é‡Œè¯´çš„æ˜¯ã€ç­‰å¾…é˜Ÿåˆ—ã€‘ï¼Œæ‰€ä»¥ addConditionWaiter è‚¯å®šæ˜¯æ„å»ºäº†ä¸€ä¸ªè‡ªå·±çš„é˜Ÿåˆ—ï¼š 1234567891011121314151617private Node addConditionWaiter() &#123; Node t = lastWaiter; if (t != null &amp;&amp; t.waitStatus != Node.CONDITION) &#123; unlinkCancelledWaiters(); t = lastWaiter; &#125; // æ–°æ„å»ºçš„èŠ‚ç‚¹çš„ waitStatus æ˜¯ CONDITIONï¼Œæ³¨æ„ä¸æ˜¯ 0 æˆ– SIGNAL äº† Node node = new Node(Thread.currentThread(), Node.CONDITION); // æ„å»ºå•å‘åŒæ­¥é˜Ÿåˆ— if (t == null) firstWaiter = node; else t.nextWaiter = node; lastWaiter = node; return node;&#125; è¿™é‡Œæœ‰æœ‹å‹å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼š ä¸ºä»€ä¹ˆè¿™é‡Œæ˜¯å•å‘é˜Ÿåˆ—ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨CAS æ¥ä¿è¯åŠ å…¥é˜Ÿåˆ—çš„å®‰å…¨æ€§å‘¢ï¼Ÿ å› ä¸º await æ˜¯ Lock èŒƒå¼ try ä¸­ä½¿ç”¨çš„ï¼Œè¯´æ˜å·²ç»è·å–åˆ°é”äº†ï¼Œæ‰€ä»¥å°±æ²¡å¿…è¦ä½¿ç”¨ CAS äº†ï¼Œè‡³äºæ˜¯å•å‘ï¼Œå› ä¸ºè¿™é‡Œè¿˜ä¸æ¶‰åŠåˆ°ç«äº‰é”ï¼Œåªæ˜¯åšä¸€ä¸ªæ¡ä»¶ç­‰å¾…é˜Ÿåˆ— åœ¨ Lock ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªæ¡ä»¶ï¼Œæ¯ä¸ªæ¡ä»¶éƒ½ä¼šå¯¹åº”ä¸€ä¸ª æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—ï¼Œæ‰€ä»¥å°†ä¸Šå›¾ä¸°å¯Œè¯´æ˜ä¸€ä¸‹å°±å˜æˆäº†è¿™ä¸ªæ ·å­ï¼š çº¿ç¨‹å·²ç»æŒ‰ç›¸åº”çš„æ¡ä»¶åŠ å…¥åˆ°äº†æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œé‚£å¦‚ä½•å†å°è¯•è·å–é”å‘¢ï¼Ÿsignal / signalAll æ–¹æ³•å°±å·²ç»æ’ä¸Šç”¨åœºäº† 1234567public final void signal() &#123; if (!isHeldExclusively()) throw new IllegalMonitorStateException(); Node first = firstWaiter; if (first != null) doSignal(first);&#125; Signal æ–¹æ³•é€šè¿‡è°ƒç”¨ doSignal æ–¹æ³•ï¼Œåªå”¤é†’æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ 123456789private void doSignal(Node first) &#123; do &#123; if ( (firstWaiter = first.nextWaiter) == null) lastWaiter = null; first.nextWaiter = null; // è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°†æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹èŠ‚ç‚¹ç§»åŠ¨åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ &#125; while (!transferForSignal(first) &amp;&amp; (first = firstWaiter) != null);&#125; ç»§ç»­çœ‹ transferForSignal æ–¹æ³• 123456789101112final boolean transferForSignal(Node node) &#123; if (!compareAndSetWaitStatus(node, Node.CONDITION, 0)) return false; // é‡æ–°è¿›è¡Œå…¥é˜Ÿæ“ä½œ Node p = enq(node); int ws = p.waitStatus; if (ws &gt; 0 || !compareAndSetWaitStatus(p, ws, Node.SIGNAL)) // å”¤é†’åŒæ­¥é˜Ÿåˆ—ä¸­è¯¥çº¿ç¨‹ LockSupport.unpark(node.thread); return true;&#125; æ‰€ä»¥æˆ‘ä»¬å†ç”¨å›¾è§£ä¸€ä¸‹å”¤é†’çš„æ•´ä¸ªè¿‡ç¨‹ åˆ°è¿™é‡Œï¼Œç†è§£ signalAll å°±éå¸¸ç®€å•äº†ï¼Œåªä¸è¿‡å¾ªç¯åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ nextWaiterï¼Œå¦‚æœæœ‰å°±åƒ signal æ“ä½œä¸€æ ·ï¼Œå°†å…¶ä»æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—ä¸­ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ 123456789private void doSignalAll(Node first) &#123; lastWaiter = firstWaiter = null; do &#123; Node next = first.nextWaiter; first.nextWaiter = null; transferForSignal(first); first = next; &#125; while (first != null);&#125; ä¸çŸ¥ä½ è¿˜æ˜¯å¦è®°å¾—ï¼Œæˆ‘åœ¨å¹¶å‘ç¼–ç¨‹ä¹‹ç­‰å¾…é€šçŸ¥æœºåˆ¶ ä¸­è¿˜è¯´è¿‡ä¸€å¥è¯ æ²¡æœ‰ç‰¹æ®ŠåŸå› å°½é‡ç”¨ signalAll æ–¹æ³• ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ signal æ–¹æ³•ä¹Ÿåœ¨å…¶ä¸­åšäº†è¯´æ˜ï¼Œè¯·å¤§å®¶è‡ªè¡ŒæŸ¥çœ‹å§ è¿™é‡Œæˆ‘è¿˜è¦å¤šè¯´ä¸€ä¸ªç»†èŠ‚ï¼Œä»æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—ç§»åˆ°åŒæ­¥é˜Ÿåˆ—æ˜¯æœ‰æ—¶é—´å·®çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ await() æ–¹æ³•ä¹Ÿæ˜¯èŒƒå¼çš„ï¼Œ åŒæ ·åœ¨è¯¥æ–‡ç« ä¸­åšäº†è§£é‡Š æœ‰æ—¶é—´å·®ï¼Œå°±ä¼šæœ‰å…¬å¹³å’Œä¸å…¬å¹³çš„é—®é¢˜ï¼Œæƒ³è¦å…¨é¢äº†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±è¦èµ°è¿‘ ReentrantLock ä¸­æ¥çœ‹äº†ï¼Œé™¤äº†äº†è§£å…¬å¹³/ä¸å…¬å¹³é—®é¢˜ï¼ŒæŸ¥çœ‹ ReentrantLock çš„åº”ç”¨è¿˜æ˜¯è¦åè¿‡æ¥éªŒè¯å®ƒä½¿ç”¨çš„AQSçš„ï¼Œæˆ‘ä»¬ç»§ç»­å§ ReentrantLock æ˜¯å¦‚ä½•åº”ç”¨çš„AQSç‹¬å å¼çš„å…¸å‹åº”ç”¨å°±æ˜¯ ReentrantLock äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•é‡å†™è¿™ä¸ªæ–¹æ³•çš„ ä¹ä¸€çœ‹æŒºå¥‡æ€ªçš„ï¼Œæ€ä¹ˆé‡Œé¢è‡ªå®šä¹‰äº†ä¸‰ä¸ªåŒæ­¥å™¨ï¼šå…¶å® NonfairSyncï¼ŒFairSync åªæ˜¯å¯¹ Sync åšäº†è¿›ä¸€æ­¥åˆ’åˆ†ï¼š ä»åç§°ä¸Šä½ åº”è¯¥ä¹ŸçŸ¥é“äº†ï¼Œè¿™å°±æ˜¯ä½ å¬åˆ°è¿‡çš„ å…¬å¹³é”/éå…¬å¹³é”äº† ä½•ä¸ºå…¬å¹³é”/éå…¬å¹³é”ï¼Ÿç”Ÿæ´»ä¸­ï¼Œæ’é˜Ÿè®²æ±‚å…ˆæ¥ååˆ°è§†ä¸ºå…¬å¹³ã€‚ç¨‹åºä¸­çš„å…¬å¹³æ€§ä¹Ÿæ˜¯ç¬¦åˆè¯·æ±‚é”çš„ç»å¯¹æ—¶é—´çš„ï¼Œå…¶å®å°±æ˜¯ FIFOï¼Œå¦åˆ™è§†ä¸ºä¸å…¬å¹³ æˆ‘ä»¬æ¥å¯¹æ¯”ä¸€ä¸‹ ReentrantLock æ˜¯å¦‚ä½•å®ç°å…¬å¹³é”å’Œéå…¬å¹³é”çš„ å…¶å®æ²¡ä»€ä¹ˆå¤§ä¸äº†ï¼Œå…¬å¹³é”å°±æ˜¯åˆ¤æ–­åŒæ­¥é˜Ÿåˆ—æ˜¯å¦è¿˜æœ‰å…ˆé©±èŠ‚ç‚¹çš„å­˜åœ¨ï¼Œåªæœ‰æ²¡æœ‰å…ˆé©±èŠ‚ç‚¹æ‰èƒ½è·å–é”ï¼›è€Œéå…¬å¹³é”æ˜¯ä¸ç®¡è¿™ä¸ªäº‹çš„ï¼Œèƒ½è·å–åˆ°åŒæ­¥çŠ¶æ€å°±å¯ä»¥ï¼Œå°±è¿™ä¹ˆç®€å•ï¼Œé‚£é—®é¢˜æ¥äº†ï¼š ä¸ºä»€ä¹ˆä¼šæœ‰å…¬å¹³é”/éå…¬å¹³é”çš„è®¾è®¡ï¼Ÿè€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€é‡æ–°å›å¿†ä¸Šé¢çš„é”è·å–å®ç°å›¾äº†ï¼Œå…¶å®ä¸Šé¢æˆ‘å·²ç»é€éœ²äº†ä¸€ç‚¹ ä¸»è¦æœ‰ä¸¤ç‚¹åŸå› ï¼š åŸå› ä¸€ï¼šæ¢å¤æŒ‚èµ·çš„çº¿ç¨‹åˆ°çœŸæ­£é”çš„è·å–è¿˜æ˜¯æœ‰æ—¶é—´å·®çš„ï¼Œä»äººç±»çš„è§’åº¦æ¥çœ‹è¿™ä¸ªæ—¶é—´å¾®ä¹å…¶å¾®ï¼Œä½†æ˜¯ä»CPUçš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ªæ—¶é—´å·®å­˜åœ¨çš„è¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚æ‰€ä»¥éå…¬å¹³é”èƒ½æ›´å……åˆ†çš„åˆ©ç”¨ CPU çš„æ—¶é—´ç‰‡ï¼Œå°½é‡å‡å°‘ CPU ç©ºé—²çŠ¶æ€æ—¶é—´ ####åŸå› äºŒï¼š ä¸çŸ¥ä½ æ˜¯å¦è¿˜è®°å¾—æˆ‘åœ¨ é¢è¯•é—®ï¼Œåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿ æ–‡ç« ä¸­åå¤æåˆ°è¿‡ï¼Œä½¿ç”¨å¤šçº¿ç¨‹å¾ˆé‡è¦çš„è€ƒé‡ç‚¹æ˜¯çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœé‡‡ç”¨éå…¬å¹³é”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚é”è·å–åŒæ­¥çŠ¶æ€ï¼Œç„¶åé‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œå› ä¸ºä¸éœ€è¦è€ƒè™‘æ˜¯å¦è¿˜æœ‰å‰é©±èŠ‚ç‚¹ï¼Œæ‰€ä»¥åˆšé‡Šæ”¾é”çš„çº¿ç¨‹åœ¨æ­¤åˆ»å†æ¬¡è·å–åŒæ­¥çŠ¶æ€çš„å‡ ç‡å°±å˜å¾—éå¸¸å¤§ï¼Œæ‰€ä»¥å°±å‡å°‘äº†çº¿ç¨‹çš„å¼€é”€ ç›¸ä¿¡åˆ°è¿™é‡Œï¼Œä½ ä¹Ÿå°±æ˜ç™½äº†ï¼Œä¸ºä»€ä¹ˆ ReentrantLock é»˜è®¤æ„é€ å™¨ç”¨çš„æ˜¯éå…¬å¹³é”åŒæ­¥å™¨ 123public ReentrantLock() &#123; sync = new NonfairSync();&#125; çœ‹åˆ°è¿™é‡Œï¼Œæ„Ÿè§‰éå…¬å¹³é” perfectï¼Œéä¹Ÿï¼Œæœ‰å¾—å¿…æœ‰å¤± ä½¿ç”¨å…¬å¹³é”ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ å…¬å¹³é”ä¿è¯äº†æ’é˜Ÿçš„å…¬å¹³æ€§ï¼Œéå…¬å¹³é”éœ¸æ°”çš„å¿½è§†è¿™ä¸ªè§„åˆ™ï¼Œæ‰€ä»¥å°±æœ‰å¯èƒ½å¯¼è‡´æ’é˜Ÿçš„é•¿æ—¶é—´åœ¨æ’é˜Ÿï¼Œä¹Ÿæ²¡æœ‰æœºä¼šè·å–åˆ°é”ï¼Œè¿™å°±æ˜¯ä¼ è¯´ä¸­çš„ â€œé¥¥é¥¿â€ å¦‚ä½•é€‰æ‹©å…¬å¹³é”/éå…¬å¹³é”ï¼Ÿç›¸ä¿¡åˆ°è¿™é‡Œï¼Œç­”æ¡ˆå·²ç»åœ¨ä½ å¿ƒä¸­äº†ï¼Œå¦‚æœä¸ºäº†æ›´é«˜çš„ååé‡ï¼Œå¾ˆæ˜¾ç„¶éå…¬å¹³é”æ˜¯æ¯”è¾ƒåˆé€‚çš„ï¼Œå› ä¸ºèŠ‚çœå¾ˆå¤šçº¿ç¨‹åˆ‡æ¢æ—¶é—´ï¼Œååé‡è‡ªç„¶å°±ä¸Šå»äº†ï¼Œå¦åˆ™é‚£å°±ç”¨å…¬å¹³é”è¿˜å¤§å®¶ä¸€ä¸ªå…¬å¹³ æˆ‘ä»¬è¿˜å·®æœ€åä¸€ä¸ªç¯èŠ‚ï¼ŒçœŸçš„è¦æŒºä½ å¯é‡å…¥é”åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜æ²¡åˆ†æ ReentrantLock çš„åå­—ï¼ŒJDK èµ·åè¿™ä¹ˆæœ‰è®²ç©¶ï¼Œè‚¯å®šæœ‰å…¶å«ä¹‰ï¼Œç›´è¯‘è¿‡æ¥ã€å¯é‡å…¥é”ã€‘ ä¸ºä»€ä¹ˆè¦æ”¯æŒé”çš„é‡å…¥ï¼Ÿ è¯•æƒ³ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªæœ‰ synchronized ä¿®é¥°çš„é€’å½’è°ƒç”¨æ–¹æ³•ï¼Œç¨‹åºç¬¬äºŒæ¬¡è¿›å…¥è¢«è‡ªå·±é˜»å¡äº†å²‚ä¸æ˜¯å¾ˆå¤§çš„ç¬‘è¯ï¼Œæ‰€ä»¥ synchronized æ˜¯æ”¯æŒé”çš„é‡å…¥çš„ Lock æ˜¯æ–°è½®å­ï¼Œè‡ªç„¶ä¹Ÿè¦æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œå…¶å®ç°ä¹Ÿå¾ˆç®€å•ï¼Œè¯·æŸ¥çœ‹å…¬å¹³é”å’Œéå…¬å¹³é”å¯¹æ¯”å›¾ï¼Œå…¶ä¸­æœ‰ä¸€æ®µä»£ç ï¼š 12// åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦å’Œå·²å ç”¨é”çš„çº¿ç¨‹æ˜¯åŒä¸€ä¸ªelse if (current == getExclusiveOwnerThread()) ä»”ç»†çœ‹ä»£ç ï¼Œ ä½ ä¹Ÿè®¸å‘ç°ï¼Œæˆ‘å‰é¢çš„ä¸€ä¸ªè¯´æ˜æ˜¯é”™è¯¯çš„ï¼Œæˆ‘è¦é‡æ–°è§£é‡Šä¸€ä¸‹ é‡å…¥çš„çº¿ç¨‹ä¼šä¸€ç›´å°† state + 1ï¼Œ é‡Šæ”¾é”ä¼š state - 1ç›´è‡³ç­‰äº0ï¼Œä¸Šé¢è¿™æ ·å†™ä¹Ÿæ˜¯æƒ³å¸®åŠ©å¤§å®¶å¿«é€Ÿçš„åŒºåˆ† æ€»ç»“æœ¬æ–‡æ˜¯ä¸€ä¸ªé•¿æ–‡ï¼Œè¯´æ˜äº†ä¸ºä»€ä¹ˆè¦é€  Lock æ–°è½®å­ï¼Œå¦‚ä½•æ ‡å‡†çš„ä½¿ç”¨ Lockï¼ŒAQS æ˜¯ä»€ä¹ˆï¼Œæ˜¯å¦‚ä½•å®ç°é”çš„ï¼Œç»“åˆ ReentrantLock åæ¨ AQS ä¸­çš„ä¸€äº›åº”ç”¨ä»¥åŠå…¶ç‹¬æœ‰çš„ä¸€äº›ç‰¹æ€§ ç‹¬å å¼è·å–é”å°±è¿™æ ·ä»‹ç»å®Œäº†ï¼Œæˆ‘ä»¬è¿˜å·® AQS å…±äº«å¼ xxxShared æ²¡æœ‰åˆ†æï¼Œç»“åˆå…±äº«å¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥é˜…è¯»ä¸€ä¸‹ Semaphoreï¼ŒReentrantReadWriteLock å’Œ CountLatch ç­‰ å¦å¤–ä¹Ÿæ¬¢è¿å¤§å®¶çš„ç•™è¨€ï¼Œå¦‚æœ‰é”™è¯¯ä¹‹å¤„è¿˜è¯·æŒ‡å‡ºï¼Œæˆ‘çš„æ‰‹é…¸äº†ï¼Œçœ¼ç›å¹²äº†ï¼Œæˆ‘å»å‡†å¤‡æ’¸ä¸‹ä¸€ç¯‡â€¦.. çµé­‚è¿½é—® ä¸ºä»€ä¹ˆæ›´æ”¹ state æœ‰ setState() , compareAndSetState() ä¸¤ç§æ–¹å¼ï¼Œæ„Ÿè§‰åè€…æ›´å®‰å…¨ï¼Œä½†æ˜¯é”çš„è§†çº¿ä¸­æœ‰å¥½å¤šåœ°æ–¹éƒ½ä½¿ç”¨äº† setState()ï¼Œå®‰å…¨å—ï¼Ÿ ä¸‹é¢ä»£ç æ˜¯ä¸€ä¸ªè½¬è´¦ç¨‹åºï¼Œæ˜¯å¦å­˜åœ¨æ­»é”æˆ–è€…é”çš„å…¶ä»–é—®é¢˜å‘¢ï¼Ÿ 12345678910111213141516171819202122232425class Account &#123; private int balance; private final Lock lock = new ReentrantLock(); // è½¬è´¦ void transfer(Account tar, int amt)&#123; while (true) &#123; if(this.lock.tryLock()) &#123; try &#123; if (tar.lock.tryLock()) &#123; try &#123; this.balance -= amt; tar.balance += amt; &#125; finally &#123; tar.lock.unlock(); &#125; &#125;//if &#125; finally &#123; this.lock.unlock(); &#125; &#125;//if &#125;//while &#125;//transfer&#125; å‚è€ƒ Java å¹¶å‘å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ https://tech.meituan.com/2019/12/05/aqs-theory-and-apply.html","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"Javaå¤šçº¿ç¨‹ä¸­æ–­æœºåˆ¶","slug":"Javaå¤šçº¿ç¨‹ä¸­æ–­æœºåˆ¶","date":"2020-05-17T05:50:15.000Z","updated":"2020-05-17T06:09:50.249Z","comments":true,"path":"/p/java-concurrency-interrupt-mechnism.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-interrupt-mechnism.html","excerpt":"| å¥½çœ‹è¯·èµï¼Œå…»æˆä¹ æƒ¯ * ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ * If you can NOT explain it simply, you do NOT understand it well enough ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ æ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œè¿œè¿‘é«˜ä½å„ä¸åŒï¼Œå¹¶å‘ç¼–ç¨‹ç†è®ºç³»åˆ—åŸºæœ¬å·²ç»ç»“æŸï¼Œç›¸ä¿¡å¤§å®¶æœ‰äº†ç†è®ºçš„é“ºå«ï¼Œè¿‘çœ‹æºç æ‰èƒ½å‘ç°å…¶è®¾è®¡ä¹‹ç¾ï¼Œä¸ä¼šä¸€å¤´é›¾æ°´ æœ¬æ¥æ˜¯è¦ä»‹ç» AQS ä½œä¸ºæˆ‘ä»¬èµ°è¿›å¹¶å‘ç¼–ç¨‹æºç ç¯èŠ‚çš„","text":"| å¥½çœ‹è¯·èµï¼Œå…»æˆä¹ æƒ¯ ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ If you can NOT explain it simply, you do NOT understand it well enough ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ æ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œè¿œè¿‘é«˜ä½å„ä¸åŒï¼Œå¹¶å‘ç¼–ç¨‹ç†è®ºç³»åˆ—åŸºæœ¬å·²ç»ç»“æŸï¼Œç›¸ä¿¡å¤§å®¶æœ‰äº†ç†è®ºçš„é“ºå«ï¼Œè¿‘çœ‹æºç æ‰èƒ½å‘ç°å…¶è®¾è®¡ä¹‹ç¾ï¼Œä¸ä¼šä¸€å¤´é›¾æ°´ æœ¬æ¥æ˜¯è¦ä»‹ç» AQS ä½œä¸ºæˆ‘ä»¬èµ°è¿›å¹¶å‘ç¼–ç¨‹æºç ç¯èŠ‚çš„ç¬¬ä¸€æ­¥ï¼Œä½† AQS æ¶‰åŠçš„çŸ¥è¯†ç‚¹ä¹Ÿè¿˜çœŸæœ‰ç‚¹å¤šï¼Œæ¯ä¸€ä¸ªéƒ½å¤Ÿå•ç‹¬æ‹¿å‡ºæ¥è¯´ä¸€è¯´ï¼Œæ°å·§æœ‰æœ‹å‹ç§ä¿¡æˆ‘â€œä¸ç†è§£çº¿ç¨‹çš„ä¸­æ–­æœºåˆ¶â€ï¼Œä¸­æ–­æœºåˆ¶åˆæ°å·§æ˜¯ AQS APIå®ç°çš„ä¸€éƒ¨åˆ†ï¼Œæ›´è´¯ç©¿äºæ•´ä¸ªå¹¶å‘ç¼–ç¨‹å†…å®¹ä¸­ã€‚äºæ˜¯å°±æ‰“ç®—å•ç‹¬è¯´ä¸€è¯´è¿™ä¸ªå°æœºåˆ¶ï¼Œå…ˆè®©å¤§å®¶åšåˆ°å¿ƒä¸­æœ‰ number åœ¨å­¦ä¹ /ç¼–å†™å¹¶å‘ç¨‹åºæ—¶ï¼Œæ€»ä¼šå¬åˆ°/çœ‹åˆ°å¦‚ä¸‹è¯æ±‡ï¼š çº¿ç¨‹è¢«ä¸­æ–­æˆ–æŠ›å‡ºInterruptedException è®¾ç½®äº†ä¸­æ–­æ ‡è¯† æ¸…ç©ºäº†ä¸­æ–­æ ‡è¯† åˆ¤æ–­çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ åœ¨ Java Thread ç±»åˆæä¾›äº†é•¿ç›¸é…·ä¼¼ï¼Œè®©äººå‚»å‚»åˆ†ä¸æ¸…çš„ä¸‰ä¸ªæ–¹æ³•æ¥å¤„ç†å¹¶å‘ä¸­æ–­é—®é¢˜ï¼š interrupt() interrupted() isInterrupted() çœ‹åˆ°è¿™æˆ‘ä¸ç¦ä¼šé—®è‡ªå·±ï¼š ä»€ä¹ˆæ˜¯ä¸­æ–­æœºåˆ¶ï¼Ÿ åˆšåˆšæ¥è§¦ã€ä¸­æ–­ã€‘è¿™ä¸ªè¯æ—¶ï¼Œå…ˆå…¥ä¸ºä¸»çš„æ¦‚å¿µå°±æ˜¯â€œç›´æ¥ä¸­æ–­/æ‰“æ–­â€æ­£åœ¨åšçš„äº‹ï¼Œä½¿å…¶åœæ­¢ã€‚æˆ‘çš„ç†è§£æ˜¯è¿™æ ·çš„ï¼š ä½ ï¼šåœ¨æ‰“æ¸¸æˆ å¥³æœ‹å‹ï¼šåˆ«æ‰“æ¸¸æˆäº†ï¼Œèµ¶å¿«è¿‡æ¥åƒé¥­ ä½ ï¼šå¬åˆ°å¥³æœ‹å‹æ‹›å‘¼ä¹‹åç«‹é©¬ä¸­æ–­æ‰‹ä¸­çš„æ¸¸æˆä¹–ä¹–è¿‡å»åƒé¥­ åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œä¸­æ–­æ˜¯ä¸€ç§ã€ååŒã€‘æœºåˆ¶ï¼Œæ€ä¹ˆç†è§£è¿™ä¹ˆé«˜å¤§ä¸Šçš„è¯å‘¢ï¼Ÿå°±æ˜¯å¥³æœ‹å‹å«ä½ åƒé¥­ï¼Œä½ æ”¶åˆ°äº†ä¸­æ–­æ¸¸æˆé€šçŸ¥ï¼Œä½†æ˜¯å¦é©¬ä¸Šæ”¾ä¸‹æ‰‹ä¸­çš„æ¸¸æˆå»åƒé¥­çœ‹ä½ å¿ƒæƒ… ã€‚åœ¨ç¨‹åºä¸­æ€æ ·æ¼”ç»è¿™ä¸ªå¿ƒæƒ…å°±çœ‹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘äº†ï¼ŒJava çš„ä¸­æ–­æœºåˆ¶å°±æ˜¯è¿™ä¹ˆç®€å• å¦‚æœè¿˜æ²¡æ”¹å˜è¿™ä¸ªå…ˆå…¥ä¸ºä¸»çš„æ¦‚å¿µï¼Œæˆ‘æ€€ä½ ä½ æ²¡æœ‰å¥³æœ‹å‹ï¼ˆğŸ˜­ï¼‰æˆ‘ä»¬æ‹¥æŠ±ä¸€ä¸‹ ä¸ºä»€ä¹ˆä¼šæœ‰ä¸­æ–­æœºåˆ¶ï¼Ÿä¸­æ–­æ˜¯ä¸€ç§ååŒæœºåˆ¶ï¼Œæˆ‘è§‰å¾—å°±æ˜¯è§£å†³ã€å½“å±€è€…è¿·ã€‘çš„çŠ¶å†µ ç°å®ä¸­ï¼Œä½ åŠªåŠ›å¿˜æˆ‘æ²¡æœ‰æ˜¼å¤œçš„å·¥ä½œï¼Œå¦‚æœå†æ²¡æœ‰äººå‘ŠçŸ¥ä½ ä¸­æ–­ï¼Œä½ èº«ä½“æ˜¯åƒä¸æ¶ˆçš„ã€‚ åœ¨å¤šçº¿ç¨‹çš„åœºæ™¯ä¸­ï¼Œæœ‰çš„çº¿ç¨‹å¯èƒ½è¿·å¤±åœ¨æ€ªåœˆæ— æ³•è‡ªæ‹”ï¼ˆè‡ªæ—‹æµªè´¹èµ„æºï¼‰ï¼Œè¿™æ—¶å°±å¯ä»¥ç”¨å…¶ä»–çº¿ç¨‹åœ¨æ°å½“çš„æ—¶æœºç»™å®ƒä¸ªä¸­æ–­é€šçŸ¥ï¼Œè¢«â€œä¸­æ–­â€çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©åœ¨æ°å½“çš„æ—¶æœºé€‰æ‹©è·³å‡ºæ€ªåœˆï¼Œæœ€å¤§åŒ–çš„åˆ©ç”¨èµ„æº é‚£ç¨‹åºä¸­å¦‚ä½•ä¸­æ–­ï¼Ÿæ€æ ·è¯†åˆ«æ˜¯å¦ä¸­æ–­ï¼Ÿåˆå¦‚ä½•å¤„ç†ä¸­æ–­å‘¢ï¼Ÿè¿™å°±ä¸ä¸Šæ–‡æåˆ°çš„ä¸‰ä¸ªæ–¹æ³•æœ‰å…³äº† interrupt() VS isInterrupted() VS interrupted()Java çš„æ¯ä¸ªçº¿ç¨‹å¯¹è±¡é‡Œéƒ½æœ‰ä¸€ä¸ª boolean ç±»å‹çš„æ ‡è¯†ï¼Œä»£è¡¨æ˜¯å¦æœ‰ä¸­æ–­è¯·æ±‚ï¼Œå¯ä½ å¯»é Thread ç±»ä½ ä¹Ÿä¸ä¼šæ‰¾åˆ°è¿™ä¸ªæ ‡è¯†ï¼Œå› ä¸ºè¿™æ˜¯é€šè¿‡åº•å±‚ native æ–¹æ³•å®ç°çš„ã€‚ interrupt()interrupt() æ–¹æ³•æ˜¯ å”¯ä¸€ä¸€ä¸ª å¯ä»¥å°†ä¸Šé¢æåˆ°ä¸­æ–­æ ‡å¿—è®¾ç½®ä¸º true çš„æ–¹æ³•ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ª Thread ç±» public çš„å¯¹è±¡æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥æ¨æ–­å‡ºä»»ä½•çº¿ç¨‹å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨è¯¥æ–¹æ³•ï¼Œè¿›ä¸€æ­¥è¯´æ˜å°±æ˜¯å¯ä»¥ä¸€ä¸ªçº¿ç¨‹ interrupt å…¶ä»–çº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥ interrupt è‡ªå·±ã€‚å…¶ä¸­ï¼Œä¸­æ–­æ ‡è¯†çš„è®¾ç½®æ˜¯é€šè¿‡ native æ–¹æ³• interrupt0 å®Œæˆçš„ åœ¨ Java ä¸­ï¼Œçº¿ç¨‹è¢«ä¸­æ–­çš„ååº”æ˜¯ä¸ä¸€æ ·çš„ï¼Œè„¾æ°”ä¸å¥½çš„ç›´æ¥å°±æŠ›å‡ºäº† InterruptedException() ï¼Œ è¯¥æ–¹æ³•æ³¨é‡Šä¸Šå†™çš„å¾ˆæ¸…æ¥šï¼Œå½“çº¿ç¨‹è¢«é˜»å¡åœ¨ï¼š wait() join() sleep() è¿™äº›æ–¹æ³•æ—¶ï¼Œå¦‚æœè¢«ä¸­æ–­ï¼Œå°±ä¼šæŠ›å‡º InterruptedException å—æ£€å¼‚å¸¸ï¼ˆä¹Ÿå°±æ˜¯å¿…é¡»è¦æ±‚æˆ‘ä»¬ catch è¿›è¡Œå¤„ç†çš„ï¼‰ ç†Ÿæ‚‰ JUC çš„æœ‹å‹å¯èƒ½çŸ¥é“ï¼Œå…¶å®è¢«ä¸­æ–­æŠ›å‡º InterruptedException çš„è¿œè¿œä¸æ­¢è¿™å‡ ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚ï¼š åå‘æ¨ç†ï¼Œè¿™äº›å¯èƒ½é˜»å¡çš„æ–¹æ³•å¦‚æœå£°æ˜æœ‰ throws InterruptedException ï¼Œ ä¹Ÿå°±æš—ç¤ºæˆ‘ä»¬å®ƒä»¬æ˜¯å¯ä¸­æ–­çš„ è°ƒç”¨ interrput() æ–¹æ³•åï¼Œä¸­æ–­æ ‡è¯†å°±è¢«è®¾ç½®ä¸º true äº†ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªä¸­æ–­æ ‡è¯†ï¼Œæ¥åˆ¤æ–­æŸä¸ªçº¿ç¨‹ä¸­æ–­æ ‡è¯†åˆ°åº•ä»€ä¹ˆçŠ¶æ€å‘¢ï¼Ÿ isInterrupted() è¿™ä¸ªæ–¹æ³•åèµ·çš„éå¸¸å¥½ï¼Œå› ä¸ºæ¯”è¾ƒç¬¦åˆæˆ‘ä»¬ bean boolean ç±»å‹å­—æ®µçš„ get æ–¹æ³•è§„èŒƒï¼Œæ²¡é”™ï¼Œè¯¥æ–¹æ³•å°±æ˜¯è¿”å›ä¸­æ–­æ ‡è¯†çš„ç»“æœï¼š trueï¼šçº¿ç¨‹è¢«ä¸­æ–­ï¼Œ falseï¼šçº¿ç¨‹æ²¡è¢«ä¸­æ–­æˆ–è¢«æ¸…ç©ºäº†ä¸­æ–­æ ‡è¯†ï¼ˆå¦‚ä½•æ¸…ç©ºæˆ‘ä»¬ä¸€ä¼šçœ‹ï¼‰ æ‹¿åˆ°è¿™ä¸ªæ ‡è¯†åï¼Œçº¿ç¨‹å°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªæ ‡è¯†æ¥æ‰§è¡Œåç»­çš„é€»è¾‘äº†ã€‚æœ‰èµ·åå¥½çš„ï¼Œä¹Ÿæœ‰èµ·åä¸å¥½çš„ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š interrupted()æŒ‰ç…§å¸¸è§„ç¿»è¯‘ï¼Œè¿‡å»æ—¶æ—¶æ€ï¼Œè¿™å°±æ˜¯â€œè¢«æ‰“æ–­äº†/è¢«æ‰“æ–­çš„â€ï¼Œå…¶å®å’Œä¸Šé¢çš„ isInterrupted() æ–¹æ³•å·®ä¸å¤šï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯è°ƒç”¨ private çš„ isInterrupted() æ–¹æ³•ï¼Œ å”¯ä¸€å·®åˆ«å°±æ˜¯ä¼šæ¸…ç©ºä¸­æ–­æ ‡è¯†ï¼ˆè¿™æ˜¯ä»æ–¹æ³•åä¸­æ€ä¹ˆä¹Ÿçœ‹ä¸å‡ºæ¥çš„ï¼‰ å› ä¸ºè°ƒç”¨è¯¥æ–¹æ³•ï¼Œä¼šè¿”å›å½“å‰ä¸­æ–­æ ‡è¯†ï¼ŒåŒæ—¶ä¼šæ¸…ç©ºä¸­æ–­æ ‡è¯†ï¼Œå°±æœ‰äº†é‚£ä¸€æ®µæœ‰ç‚¹è®©äººè¿·æƒ‘çš„æ–¹æ³•æ³¨é‡Šï¼š æ¥æ®µç¨‹åºä½ å°±ä¼šæ˜ç™½ä¸Šé¢æ³¨é‡Šçš„æ„æ€äº†ï¼š 1234Thread.currentThread().isInterrupted(); // trueThread.interrupted() // trueï¼Œè¿”å›trueåæ¸…ç©ºäº†ä¸­æ–­æ ‡è¯†å°†å…¶ç½®ä¸º falseThread.currentThread().isInterrupted(); // falseThread.interrupted() // false è¿™ä¸ªæ–¹æ³•æ€»è§‰å¾—å¾ˆå¥‡æ€ªï¼Œç°å®ä¸­æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ å½“ä½ å¯èƒ½è¦è¢«å¤§é‡ä¸­æ–­å¹¶ä¸”ä½ æƒ³ç¡®ä¿åªå¤„ç†ä¸€æ¬¡ä¸­æ–­æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•äº† è¯¥æ–¹æ³•åœ¨ JDK æºç ä¸­åº”ç”¨ä¹Ÿéå¸¸å¤šï¼Œæ¯”å¦‚ï¼ˆåç»­æ–‡ç« ä¼šå…·ä½“åˆ†æï¼Œè¿™é‡ŒçŸ¥é“è¯¥æ–¹æ³•çš„ä½œç”¨å’Œä½¿ç”¨åœºæ™¯å°±å¥½ï¼‰ï¼š ç›¸ä¿¡åˆ°è¿™é‡Œä½ å·²ç»èƒ½æ˜ç¡®åˆ†è¾¨ä¸‰èƒèƒéƒ½æ˜¯è°ï¼Œå¹¶å‘æŒ¥æ€æ ·çš„ä½œç”¨äº†ï¼Œé‚£ä¹ˆæœ‰å“ªäº›åœºæ™¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸­æ–­æœºåˆ¶å‘¢ï¼Ÿ ä¸­æ–­æœºåˆ¶çš„ä½¿ç”¨åœºæ™¯é€šå¸¸ï¼Œä¸­æ–­çš„ä½¿ç”¨åœºæ™¯æœ‰ä»¥ä¸‹å‡ ä¸ª ç‚¹å‡»æŸä¸ªæ¡Œé¢åº”ç”¨ä¸­çš„å…³é—­æŒ‰é’®æ—¶ï¼ˆæ¯”å¦‚ä½ å…³é—­ IDEAï¼Œä¸ä¿å­˜æ•°æ®ç›´æ¥ä¸­æ–­å¥½å—ï¼Ÿï¼‰ï¼› æŸä¸ªæ“ä½œè¶…è¿‡äº†ä¸€å®šçš„æ‰§è¡Œæ—¶é—´é™åˆ¶éœ€è¦ä¸­æ­¢æ—¶ï¼› å¤šä¸ªçº¿ç¨‹åšç›¸åŒçš„äº‹æƒ…ï¼Œåªè¦ä¸€ä¸ªçº¿ç¨‹æˆåŠŸå…¶å®ƒçº¿ç¨‹éƒ½å¯ä»¥å–æ¶ˆæ—¶ï¼› ä¸€ç»„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‡ºç°é”™è¯¯å¯¼è‡´æ•´ç»„éƒ½æ— æ³•ç»§ç»­æ—¶ï¼› å› ä¸ºä¸­æ–­æ˜¯ä¸€ç§ååŒæœºåˆ¶ï¼Œæä¾›äº†æ›´ä¼˜é›…ä¸­æ–­æ–¹å¼ï¼Œä¹Ÿæä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œæ‰€ä»¥å½“é‡åˆ°å¦‚ä¸Šåœºæ™¯ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸­æ–­æœºåˆ¶äº† ä½¿ç”¨ä¸­æ–­æœºåˆ¶æœ‰å“ªäº›æ³¨æ„äº‹é¡¹å…¶å®ä½¿ç”¨ä¸­æ–­æœºåˆ¶æ— éå°±æ˜¯æ³¨æ„ä¸Šé¢è¯´çš„ä¸¤é¡¹å†…å®¹ï¼š ä¸­æ–­æ ‡è¯† InterruptedException å‰æµªå·²ç»å°†å…¶æ€»ç»“ä¸ºä¸¤ä¸ªé€šç”¨åŸåˆ™ï¼Œæˆ‘ä»¬åæµªç›´æ¥ç«™åœ¨è‚©è†€ä¸Šç”¨å°±å¯ä»¥äº†ï¼Œæ¥çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªåŸåˆ™æ˜¯ä»€ä¹ˆï¼š åŸåˆ™-1 å¦‚æœé‡åˆ°çš„æ˜¯å¯ä¸­æ–­çš„é˜»å¡æ–¹æ³•, å¹¶æŠ›å‡º InterruptedExceptionï¼Œå¯ä»¥ç»§ç»­å‘æ–¹æ³•è°ƒç”¨æ ˆçš„ä¸Šå±‚æŠ›å‡ºè¯¥å¼‚å¸¸ï¼›å¦‚æœæ£€æµ‹åˆ°ä¸­æ–­ï¼Œåˆ™å¯æ¸…é™¤ä¸­æ–­çŠ¶æ€å¹¶æŠ›å‡º InterruptedExceptionï¼Œä½¿å½“å‰æ–¹æ³•ä¹Ÿæˆä¸ºä¸€ä¸ªå¯ä¸­æ–­çš„æ–¹æ³• åŸåˆ™-2 è‹¥æœ‰æ—¶å€™ä¸å¤ªæ–¹ä¾¿åœ¨æ–¹æ³•ä¸ŠæŠ›å‡º InterruptedExceptionï¼Œæ¯”å¦‚è¦å®ç°çš„æŸä¸ªæ¥å£ä¸­çš„æ–¹æ³•ç­¾åä¸Šæ²¡æœ‰ throws InterruptedExceptionï¼Œè¿™æ—¶å°±å¯ä»¥æ•è·å¯ä¸­æ–­æ–¹æ³•çš„ InterruptedException å¹¶é€šè¿‡ Thread.currentThread.interrupt() æ¥é‡æ–°è®¾ç½®ä¸­æ–­çŠ¶æ€ã€‚ å†é€šè¿‡ä¸ªä¾‹å­æ¥åŠ æ·±ä¸€ä¸‹ç†è§£ï¼š æœ¬æ„æ˜¯å½“å‰çº¿ç¨‹è¢«ä¸­æ–­ä¹‹åï¼Œé€€å‡ºwhile(true), ä½ è§‰å¾—ä»£ç æœ‰é—®é¢˜å—ï¼Ÿï¼ˆå…ˆä¸è¦å‘ä¸‹çœ‹ï¼‰ 123456789101112Thread th = Thread.currentThread();while(true) &#123; if(th.isInterrupted()) &#123; break; &#125; // çœç•¥ä¸šåŠ¡ä»£ç  try &#123; Thread.sleep(100); &#125;catch (InterruptedException e)&#123; e.printStackTrace(); &#125;&#125; æ‰“å¼€ Thread.sleep æ–¹æ³•ï¼š sleep æ–¹æ³•æŠ›å‡º InterruptedExceptionåï¼Œä¸­æ–­æ ‡è¯†ä¹Ÿè¢«æ¸…ç©ºç½®ä¸º falseï¼Œæˆ‘ä»¬åœ¨catch æ²¡æœ‰é€šè¿‡è°ƒç”¨ th.interrupt() æ–¹æ³•å†æ¬¡å°†ä¸­æ–­æ ‡è¯†ç½®ä¸º trueï¼Œè¿™å°±å¯¼è‡´æ— é™å¾ªç¯äº† è¿™ä¸¤ä¸ªåŸåˆ™å¾ˆå¥½ç†è§£ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬åº”è¯¥ç•™æ„ InterruptedExceptionï¼Œå½“æˆ‘ä»¬æ•è·åˆ°è¯¥å¼‚å¸¸æ—¶ï¼Œç»ä¸å¯ä»¥é»˜é»˜çš„åæ‰å®ƒï¼Œä»€ä¹ˆä¹Ÿä¸åšï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´ä¸Šå±‚è°ƒç”¨æ ˆä»€ä¹ˆä¿¡æ¯ä¹Ÿè·å–ä¸åˆ°ã€‚å…¶å®åœ¨ç¼–å†™ç¨‹åºæ—¶ï¼Œæ•è·çš„ä»»ä½•å—æ£€å¼‚å¸¸æˆ‘ä»¬éƒ½ä¸åº”è¯¥åæ‰ JDK ä¸­æœ‰å“ªäº›ä½¿ç”¨ä¸­æ–­æœºåˆ¶çš„åœ°æ–¹å‘¢ï¼Ÿä¸­æ–­æœºåˆ¶è´¯ç©¿æ•´ä¸ªå¹¶å‘ç¼–ç¨‹ä¸­ï¼Œè¿™é‡Œåªç®€å•åˆ—è§‰å¤§å®¶ç»å¸¸ä¼šä½¿ç”¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é˜…è¯»JDKæºç æ¥è¿›ä¸€æ­¥äº†è§£ä¸­æ–­æœºåˆ¶ä»¥åŠå­¦ä¹ å¦‚ä½•ä½¿ç”¨ä¸­æ–­æœºåˆ¶ ThreadPoolExecutorThreadPoolExecutor ä¸­çš„ shutdownNow æ–¹æ³•ä¼šéå†çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹å¹¶è°ƒç”¨çº¿ç¨‹çš„ interrupt æ–¹æ³•æ¥ä¸­æ–­çº¿ç¨‹ FutureTaskFutureTask ä¸­çš„ cancel æ–¹æ³•ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°ä¸º trueï¼Œå®ƒå°†ä¼šåœ¨æ­£åœ¨è¿è¡Œå¼‚æ­¥ä»»åŠ¡çš„çº¿ç¨‹ä¸Šè°ƒç”¨ interrupt æ–¹æ³•ï¼Œå¦‚æœæ­£åœ¨æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡ä¸­çš„ä»£ç æ²¡æœ‰å¯¹ä¸­æ–­åšå‡ºå“åº”ï¼Œé‚£ä¹ˆ cancel æ–¹æ³•ä¸­çš„å‚æ•°å°†ä¸ä¼šèµ·åˆ°ä»€ä¹ˆæ•ˆæœ æ€»ç»“åˆ°è¿™é‡Œä½ åº”è¯¥ç†è§£Java å¹¶å‘ç¼–ç¨‹ä¸­æ–­æœºåˆ¶çš„å«ä¹‰äº†ï¼Œå®ƒæ˜¯ä¸€ç§ååŒæœºåˆ¶ï¼Œå’Œä½ å…ˆå…¥ä¸ºä¸»çš„æ¦‚å¿µå®Œå…¨ä¸ä¸€æ ·ã€‚åŒºåˆ†äº†ä¸‰ä¸ªç›¸è¿‘æ–¹æ³•ï¼Œè¯´æ˜äº†ä½¿ç”¨åœºæ™¯ä»¥åŠä½¿ç”¨åŸåˆ™ï¼ŒåŒæ—¶åˆç»™å‡ºJDKæºç ä¸€äº›å¸¸è§æ¡ˆä¾‹ï¼Œç›¸ä¿¡ä½ å·²ç»èƒ¸ä¸­æœ‰æ²Ÿå£‘äº†ï¼Œæ¥ä¸‹æ¥ï¼Œè·Ÿä¸ŠèŠ‚å¥ï¼Œæˆ‘ä»¬é™†ç»­èµ°è¿›æºç å§ çµé­‚è¿½é—® æŠ›å‡º InterruptedException åï¼Œä¸­æ–­æ ‡è¯†å°±ä¸€å®šè¢«æ¸…ç©ºå—ï¼Ÿ å¤„åœ¨æ­»é”çŠ¶æ€çš„çº¿ç¨‹æ˜¯å¦å¯ä»¥è¢«ä¸­æ–­å‘¢ï¼Ÿ è¿›å…¥ä¸´ç•ŒåŒºçš„çº¿ç¨‹èƒ½å¦è¢«ä¸­æ–­å‘¢ï¼Ÿå¦‚æœä¸èƒ½æœ‰ä»€ä¹ˆåŠæ³•èƒ½å“åº”ä¸­æ–­å—ï¼Ÿ ä¸ªäººæ„Ÿè§‰interruptedè¿™ä¸ªæ–¹æ³•åç§°ä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œå¦‚æœä½ ä¹Ÿè§‰å¾—ä¸å¥½ï¼Œè®©ä½ è®¾è®¡è¿™ä¸ªåœ°æ–¹ï¼Œä½ æœ‰ä»€ä¹ˆæƒ³æ³•ï¼Ÿ æœ‰æœ‹å‹å¯èƒ½ä¼šé—®æ–‡ç« å¼€å¤´çš„å›¾ï¼ŒåŒæ—¶çœ‹ä¸€ä¸ªç±»çš„ä¸åŒéƒ¨åˆ†æ€ä¹ˆå®ç°çš„ï¼Ÿä¸ç­‰æ‚¨å¼€å£ï¼Œæˆ‘å°±å…¨ç›˜çš„æ‹›äº†ï¼Œå…¶å®å°±æ˜¯å±å¹•åˆ†å‰²ï¼ˆåœ¨æ–‡ä»¶ä¸Šé¼ æ ‡å³é”®-&gt;é€‰æ‹©æ°´å¹³/å‚ç›´åˆ†å‰²ï¼‰ï¼Œè¿™æ ·åœ¨åŒæ—¶æŸ¥çœ‹æŸäº›ä»£ç æ—¶è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼ˆå¸¦é±¼å±å‚ç›´åˆ†å‰²çœŸæ˜¯çˆ½ç¿»å¤©ï¼‰ï¼Œä¿å§†å¼æ¼”ç¤ºå¦‚ä¸‹ï¼š å‚è€ƒ Java å¹¶å‘ç¼–ç¨‹å®æˆ˜ Javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ https://www.infoq.cn/article/java-interrupt-mechanism https://coderanch.com/t/237332/certification/explain-interrupt-isInterrupted-interrupted-method https://dzone.com/articles/waiting-for-coroutines","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"Intellij IDEA é…ç½®å’Œæ’ä»¶åˆé›†","slug":"Intellij-IDEA-é…ç½®å’Œæ’ä»¶åˆé›†","date":"2020-05-03T01:43:47.000Z","updated":"2020-05-03T03:06:59.310Z","comments":true,"path":"/p/intellij-idea-configuration-and-plugins.html","link":"","permalink":"https://dayarch.top/p/intellij-idea-configuration-and-plugins.html","excerpt":"æœ€è¿‘åœ¨é™†ç»­å†™ Java å¹¶å‘ç¼–ç¨‹ç³»åˆ—ï¼Œå¥½å¤šæœ‹ç§ä¿¡é—®æˆ‘çš„ä¸æ˜¯å¹¶å‘å†…å®¹æœ¬èº«ï¼Œè€Œæ˜¯æˆ‘çš„ IDEA ä¸»é¢˜é…ç½®ã€‚æˆ‘å°±å§‘ä¸”è®¤ä¸ºå¥½çš„ä¸»é¢˜é…ç½®å¯ä»¥å†™å‡ºæ›´å¥½çš„å¹¶å‘ç¨‹åºå§ å³ä¾¿è¿™ç§å¯èƒ½æ€§åªæœ‰ä¸‡åˆ†ä¹‹ä¸€ï¼Œæˆ‘ä¹Ÿè¦æŠŠæˆ‘çš„ IDEA ç›¸å…³å€¼å¾—é…ç½®çš„å†…å®¹/æ’ä»¶å’Œå¤§å®¶åˆ†äº«å‡ºæ¥ å…ˆæ¥ä¸€å¼ æˆ‘çš„ IDE æˆªå›¾ï¼Œæœ‰ä½ çœ‹ä¸­çš„åœ°æ–¹å—ï¼Ÿ æ’ä»¶ç¯‡ å¥½ç”¨çš„æ’ä»¶æ€»æ˜¯è®©äººï¼š ç¥æ¸…æ°”çˆ½ï¼Œç²¾ç¥æŠ–æ“ ï¼Œä¸°ç¥å¼‚å½©ï¼Œç‚¯ç‚¯æœ‰ç¥ï¼Œç¥é‡‡å¥•å¥•ï¼Œæ°”è´¯é•¿è™¹ ï¼Œè‹±å§¿é£’çˆ½ï¼Œç²¾ç¥ç„•å‘ ä¸‹é¢æ‰€æœ‰æ’ä»¶éƒ½å¯ä»¥æŒ‰ç…§æ–‡ä¸­æ ‡æ³¨çš„åç§°åœ¨ IDEA æ’ä»¶å¸‚åœºä¸­ç›´æ¥æœç´¢å¹¶å®‰è£… Material Theme UI Material Theme UI åœ¨ä¸»é¢˜ä¸‹è½½é‡æ’è¡Œæ¦œä¸­é«˜å±…ç¬¬ä¸€","text":"æœ€è¿‘åœ¨é™†ç»­å†™ Java å¹¶å‘ç¼–ç¨‹ç³»åˆ—ï¼Œå¥½å¤šæœ‹ç§ä¿¡é—®æˆ‘çš„ä¸æ˜¯å¹¶å‘å†…å®¹æœ¬èº«ï¼Œè€Œæ˜¯æˆ‘çš„ IDEA ä¸»é¢˜é…ç½®ã€‚æˆ‘å°±å§‘ä¸”è®¤ä¸ºå¥½çš„ä¸»é¢˜é…ç½®å¯ä»¥å†™å‡ºæ›´å¥½çš„å¹¶å‘ç¨‹åºå§ å³ä¾¿è¿™ç§å¯èƒ½æ€§åªæœ‰ä¸‡åˆ†ä¹‹ä¸€ï¼Œæˆ‘ä¹Ÿè¦æŠŠæˆ‘çš„ IDEA ç›¸å…³å€¼å¾—é…ç½®çš„å†…å®¹/æ’ä»¶å’Œå¤§å®¶åˆ†äº«å‡ºæ¥ å…ˆæ¥ä¸€å¼ æˆ‘çš„ IDE æˆªå›¾ï¼Œæœ‰ä½ çœ‹ä¸­çš„åœ°æ–¹å—ï¼Ÿ æ’ä»¶ç¯‡å¥½ç”¨çš„æ’ä»¶æ€»æ˜¯è®©äººï¼š ç¥æ¸…æ°”çˆ½ï¼Œç²¾ç¥æŠ–æ“ ï¼Œä¸°ç¥å¼‚å½©ï¼Œç‚¯ç‚¯æœ‰ç¥ï¼Œç¥é‡‡å¥•å¥•ï¼Œæ°”è´¯é•¿è™¹ ï¼Œè‹±å§¿é£’çˆ½ï¼Œç²¾ç¥ç„•å‘ ä¸‹é¢æ‰€æœ‰æ’ä»¶éƒ½å¯ä»¥æŒ‰ç…§æ–‡ä¸­æ ‡æ³¨çš„åç§°åœ¨ IDEA æ’ä»¶å¸‚åœºä¸­ç›´æ¥æœç´¢å¹¶å®‰è£… Material Theme UIMaterial Theme UI åœ¨ä¸»é¢˜ä¸‹è½½é‡æ’è¡Œæ¦œä¸­é«˜å±…ç¬¬ä¸€ã€‚å®‰è£…ä¸»é¢˜åï¼ˆåœ¨é¡µé¢åº•éƒ¨å°±ä¼šæœ‰è¿›å…¥ä¸»é¢˜çš„å¿«æ·å…¥å£ï¼‰ï¼Œé€‰æ‹©è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜è¿›è¡Œå¾®è°ƒå°±å¯ä»¥å•¦ï¼Œå¦‚æœæ‡’å¾—åšé…ç½®ï¼ŒæŒ‰ç…§ä¸‹å›¾å‹¾é€‰ç›¸åº”è®¾ç½®å°±å’Œæˆ‘çš„ä¸€æ ·äº†ï¼š Rainbow Bracketsç¿»è¯‘è¿‡æ¥å«ã€å½©è™¹æ‹¬å·ã€‘ï¼Œè¯¥æ’ä»¶é™¤äº†å¯ä»¥å®ç°å¤šå½©çš„æ‹¬å·åŒ¹é…å¤–ï¼Œæˆ‘ä½¿ç”¨æ›´å¤šçš„æ˜¯å…¶ã€åŒºåŸŸä»£ç é«˜äº®ã€‘åŠŸèƒ½ ï¼Œè¿™æ ·å¯ä»¥æ¸…æ™°å®šä½åŒºåŸŸä»£ç å†…å®¹ Mac å¿«æ·é”®ï¼šcmd + é¼ æ ‡å³é”®; Windows å¿«æ·é”®ï¼šctrl + é¼ æ ‡å³é”® ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨éé€‰ä¸­éƒ¨åˆ†æš—æ·¡æ•ˆæœ å¿«æ·é”®ï¼šalt + é¼ æ ‡å³é”® ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘æ›´å–œæ¬¢ç¬¬ä¸€ç§é«˜äº®æ•ˆæœ CodotaCodota æ€»ç»“èµ·æ¥æœ‰ä¸‰å¤§åŠŸèƒ½ï¼š 1. æ™ºèƒ½è‡ªåŠ¨è¡¥å…¨è®©ç¼–ç é€Ÿåº¦æ›´å¿«å½“ç¼–å†™ä»£ç æ—¶ï¼ŒCodota å¯ä»¥å¿«é€Ÿçš„å®Œæˆæ™ºèƒ½è¡¥å…¨ä»¥åŠé«˜é¢‘ç”¨æ³•æç¤º 2. ä»ç»è¿‡æµ‹è¯•æˆ–è¯æ˜è¿‡çš„ç¨‹åºä¸­è·å¾—ç¼–ç å»ºè®®å¦‚æœæˆ‘ä»¬è§‰å¾—ç»™å‡ºçš„æç¤ºä¸å¤Ÿæ¸…æ™°ï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”®ï¼š ctrl + shift + o ï¼Œ å¿«é€ŸæŸ¥è¯¢ç›¸å…³ä½¿ç”¨æ¡ˆä¾‹ï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡æ·»åŠ å…³é”®å­—è¿›è¡Œè¿‡æ»¤ï¼ŒæŸ¥æ‰¾åˆ°æ›´åŠ ç²¾ç¡®çš„ä»£ç æ ·ä¾‹ 3. ä¸è„±ç¦»IDEå‘ç°å¹¶åˆ©ç”¨æ›´å¤šå¼€æºä»£ç å½“ä½ ä¸çŸ¥é“æŸä¸ªç±»å¦‚ä½•ä½¿ç”¨æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¿«æ·é”®ï¼šctrl + shift + y ï¼Œ ç„¶åè¾“å…¥å…³é”®å­—ï¼Œä¼šæŸ¥è¯¢åˆ°å¾ˆå¤šã€å¼€æºæ¡†æ¶ã€‘ä¸­ä½¿ç”¨è¯¥ç±»çš„ç»å…¸æ¡ˆä¾‹ã€‚ä¸ç”¨è„±ç¦» IDEï¼Œæ²¡æœ‰å¹¿å‘Šï¼Œæ²¡æœ‰åºŸè¯ï¼Œåªæœ‰ç»å…¸çš„ä»£ç æ ·ä¾‹ï¼Œä½ è¯´çˆ½ä¸çˆ½ï¼Ÿ å¦‚æœä½ ç”¨ Eclipse ï¼ŒCodota ä¹Ÿæ˜¯å®Œç¾æ”¯æŒçš„ Key Promoter Xé«˜æ•ˆçš„ç¼–ç è„±ç¦»ä¸å¼€å¿«æ·é”®çš„ä½¿ç”¨ï¼Œä½†æ˜¯ IDEA ä¸­çš„å¿«æ·é”®å®åœ¨å¤ªå¤šäº†ï¼Œä¸æ˜¯å¾ˆæ–¹ä¾¿è®°å¿†ï¼ŒKey Promoter X ä¼šæ ¹æ®ä½ ä½¿ç”¨çš„åŠŸèƒ½æç¤ºä½ è®¾ç½®å¿«æ·é”® è®¾ç½®å®Œåï¼Œå¦‚æœä½ å¿˜è®°äº†è¯¥å¿«æ·é”®ï¼Œå†æ¬¡é€šè¿‡é¼ æ ‡ç‚¹å‡»è¯¥åŠŸèƒ½æ—¶ï¼Œè®¾ç½®å¥½çš„å¿«æ·é”®å°±ä¼šç›¸åº”çš„æç¤ºå‡ºæ¥ï¼ŒçœŸæ˜¯æ·±çŸ¥ç å†œè‹¦å•Š Alibaba Java Code Guidelineå®‰è£…è¯¥æ’ä»¶åï¼Œä½ ç¼–å†™çš„ä»£ç å°±ä¼šæŒ‰ç…§ Alibaba ç¼–ç è§„çº¦è§„èŒƒæˆ‘ä»¬ç¼–å†™çš„ä»£ç ï¼ˆè°è¯´æˆ‘ä»¬ä¸èƒ½å†™å‡ºå’Œå¤§å‚ä¸€æ ·è§„èŒƒçš„ä»£ç ï¼Ÿï¼‰ æ¯”å¦‚é€šè¿‡Executors å¿«é€Ÿåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± æ˜¯ä¸è¢«å…è®¸çš„ï¼Œå…·ä½“åŸå› å·²ç»åœ¨æˆ‘ä¼šæ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ? ä¸­è¯´æ˜ï¼Œå½“æ£€æµ‹å‡ºä¹‹åï¼Œé¼ æ ‡æ‚¬æµ®åœ¨ä¸Šé¢ä¼šç»™å‡ºæç¤ºï¼ŒæŒ‰å¿«æ·é”® cmd + F1 ä¼šæ›´å®Œæ•´çš„å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆä¸å¯ä»¥ï¼ŒåŒæ—¶è¿˜ç»™å‡ºä½ åº”è¯¥æ€æ ·ç¼–å†™çš„æ ·ä¾‹ ï¼ˆæš–æš–çš„ï¼Œå¾ˆè´´å¿ƒï¼‰ CodeGlanceè‹±æ–‡ç›´è¯‘ã€ä»£ç ä¸€ç¥ã€‘ï¼Œç»†å¿ƒçš„æœ‹å‹å·²ç»åœ¨å¼€ç¯‡çš„å›¾ä¸­çœ‹åˆ°äº†è¿™ä¸ªè®¾ç½®ï¼Œå®‰è£…è¯¥æ’ä»¶åï¼ŒIDEå³ä¾§ä¼šå‡ºç°ä¸€ä¸ªmini è§†å›¾ï¼Œæ¯”å¦‚çœ‹ ConcurrentHashMap æºç ï¼Œé‚£ä¹ˆé•¿çš„å†…å®¹ï¼Œå¯ä»¥é€šè¿‡è¯¥æ’ä»¶å¿«é€Ÿçš„æ‹–åŠ¨åˆ°å¤§æ¦‚ä½ç½®ï¼Œæ–¹ä¾¿å¾ˆå¤š Restful Tookitè¿™ä¸ªæ’ä»¶ä¹‹å‰æˆ‘æœ‰ä»‹ç»è¿‡ï¼Œç¼–å†™ RESTful æ¥å£å¿…ä¸å¯å°‘çš„æ’ä»¶ï¼Œç¼–å†™å®Œæ¥å£å½“ç„¶è¿˜éœ€è¦è°ƒè¯•ï¼Œæ­é…HTTP Client ä¸€èµ·ä½¿ç”¨æ‰æ›´é¦™ IntelliJ IDEA HTTP Clienté«˜çº§ä½¿ç”¨è¯¦è§£ï¼Œç›¸ä¿¡ä½ å­¦ä¼šä½¿ç”¨è¿™ä¸ªï¼Œä¸å•å•æ˜¯ä½ ä¸ªäººï¼Œä½ ä»¬æ•´ä¸ªå°ç»„éƒ½ä¼šå› æ­¤å—ç›Š CamelCaseç¼–ç ç¦»ä¸å¼€å­—ç¬¦ä¸²çš„ä½¿ç”¨ï¼Œå®‰è£…è¯¥æ’ä»¶åï¼Œå¯ä»¥é€šè¿‡å¿«æ·é”® shift + alt + U å¿«é€Ÿçš„åˆ‡æ¢å­—ç¬¦ä¸²æ ¼å¼ï¼Œå½“ç„¶å¦‚æœä½ åªæ˜¯å•çº¯çš„åˆ‡æ¢å¤§å°å†™ï¼Œä½¿ç”¨ shift + cmd + U æ›´ä¾¿æ·ä¸€äº› è®¾ç½®ç¯‡æ–¹æ³•åˆ†å‰²çº¿ä»¥åŠå­—ç¬¦ç¼©è¿›é€šè¿‡æ–¹æ³•åˆ†å‰²çº¿å¯ä»¥æ›´æ¸…æ™°æ˜äº†çš„åŒºåˆ†æ–¹æ³•çš„è¾¹ç•Œï¼Œé€šè¿‡å­—ç¬¦ç¼©è¿›ä¹Ÿå¯ä»¥è®©ä»£ç çš„å±‚æ¬¡æ„Ÿæ›´åŠ æ˜æ˜¾ï¼Œå…ˆæ¥çœ‹æ•´ä½“æ•ˆæœ åªéœ€è¦æŒ‰ç…§ä¸‹å›¾å‹¾é€‰ç›¸åº”é€‰é¡¹å°±å¯ä»¥äº† ï¼ˆç°åœ¨æ˜¯ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Ÿï¼‰ Editor è¾¹æ ä½ç½®è®¾ç½®å¦‚æœä½ ä¸èƒ½ç†Ÿæ‚‰çš„ä½¿ç”¨ cmd + E å¿«æ·é”®ï¼ˆä¸€ä¸å°å¿ƒç»™äº†æç¤ºï¼‰æ‰“å¼€ä½ æœ€è¿‘å¸¸ç”¨çš„æ–‡ä»¶ï¼Œé¡¶éƒ¨ä½ç½®å¯æ˜¾ç¤ºçš„æ‰“å¼€çš„ç±»åç§°å°‘ä¹‹åˆå°‘ï¼Œæ‰€ä»¥é€šè¿‡æŒªåŠ¨ Editor çš„æ˜¾ç¤ºä½ç½®ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªç—›ç‚¹é—®é¢˜ï¼Œç°åœ¨æ˜¯ä¸æ˜¯æåº¦èˆ’é€‚äº†å‘¢ï¼Ÿ å½“ä½ è§‰å¾—éœ€è¦ IDEA å¸®åŠ©ä½ æ›´é«˜æ•ˆçš„å·¥ä½œæ—¶ï¼Œä¸å¦¨å»æ’ä»¶å¸‚åœºæœæœçœ‹ï¼Œæ²¡å‡†å°±æœ‰æ„æƒ³ä¸åˆ°çš„æƒŠå–œã€‚å¦å¤–ï¼Œè¿™æ˜¯ä¸€ä¸ª IDEA è®¾ç½®ç¯‡çš„åˆé›†ï¼Œæˆ‘ä¼šé™†ç»­å°†æ›´å¤šè®¾ç½®å’Œå¥½ç”¨çš„æ’ä»¶æ•´åˆåˆ°è¿™ä¸€ç¯‡æ–‡ç« å½“ä¸­ï¼Œä¸ºäº†ä¸é”™è¿‡æ›´å¤šç²¾å½©å†…å®¹ï¼Œä½ å¯ä»¥ç›´æ¥é€‰æ‹©æ”¶è—å•¦ æœ€åï¼Œæˆ‘ä¹Ÿæ•´ç†äº†å¾ˆå¤šå¯ä»¥å¸®ä½ é«˜æ•ˆå·¥ä½œçš„å·¥å…·ï¼Œå…¬ä¼—å·å›å¤ã€å·¥å…·ã€‘å³å¯","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"IntelliJ IDEA","slug":"IntelliJ-IDEA","permalink":"https://dayarch.top/tags/IntelliJ-IDEA/"}]},{"title":"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ?","slug":"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ","date":"2020-04-19T07:17:38.000Z","updated":"2020-04-22T00:29:08.547Z","comments":true,"path":"/p/why-we-need-to-use-threadpool.html","link":"","permalink":"https://dayarch.top/p/why-we-need-to-use-threadpool.html","excerpt":"ä¸Šä¸€ç¯‡æ–‡ç«  é¢è¯•é—®æˆ‘ï¼Œåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿæˆ‘è¯¥æ€ä¹ˆè¯´ ä»å®šæ€§åˆ°å®šé‡çš„åˆ†æäº†å¦‚ä½•åˆ›å»ºæ­£ç¡®ä¸ªæ•°çš„çº¿ç¨‹æ¥æœ€å¤§åŒ–åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼ˆå…¶å®å°±æ˜¯å‡ é“å°å­¦æ•°å­¦é¢˜ï¼‰ã€‚é€šå¸¸æ¥è®²ï¼Œæœ‰äº†ä¸ªè¿™ä¸ªçŸ¥è¯†ç‚¹å‚èº«ï¼ŒæŒ‰éœ€æ‰‹åŠ¨åˆ›å»ºç›¸åº”ä¸ªæ•°çš„çº¿ç¨‹å°±å¥½ ä½†æ˜¯ç°å®ä¸­ï¼Œä½ ä¹Ÿè®¸å¬è¿‡æˆ–è€…è¢«è¦æ±‚ï¼š å°½é‡é¿å…æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼Œåº”ä½¿ç”¨çº¿ç¨‹æ± ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„è¦æ±‚ï¼ŸèƒŒåçš„é“ç†åˆæ˜¯æ€æ ·çš„å‘¢ï¼Ÿé¡ºç€è¿™ä¸ªç»éªŒç†è®ºæ¥æ¨æ–­ï¼Œé‚£è‚¯å®šæ˜¯æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æœ‰ç¼ºç‚¹ æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ 1. ä¸å—æ§é£é™© 2. é¢‘ç¹åˆ›å»ºå¼€é”€å¤§ ä¸å—æ§é£é™© è¿™ä¸ªç¼ºç‚¹ï¼Œç›¸ä¿¡ä½ ä¹Ÿå¯ä»¥è¯´å‡ºä¸€äºŒ ç³»ç»Ÿèµ„æºæœ‰é™ï¼Œæ¯ä¸ªäººé’ˆå¯¹ä¸åŒä¸šåŠ¡éƒ½å¯ä»¥æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼Œå¹¶ä¸”åˆ›å»ºæ ‡å‡†ä¸ä¸€æ ·ï¼ˆæ¯”å¦‚çº¿ç¨‹æ²¡æœ‰","text":"ä¸Šä¸€ç¯‡æ–‡ç«  é¢è¯•é—®æˆ‘ï¼Œåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿæˆ‘è¯¥æ€ä¹ˆè¯´ ä»å®šæ€§åˆ°å®šé‡çš„åˆ†æäº†å¦‚ä½•åˆ›å»ºæ­£ç¡®ä¸ªæ•°çš„çº¿ç¨‹æ¥æœ€å¤§åŒ–åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼ˆå…¶å®å°±æ˜¯å‡ é“å°å­¦æ•°å­¦é¢˜ï¼‰ã€‚é€šå¸¸æ¥è®²ï¼Œæœ‰äº†ä¸ªè¿™ä¸ªçŸ¥è¯†ç‚¹å‚èº«ï¼ŒæŒ‰éœ€æ‰‹åŠ¨åˆ›å»ºç›¸åº”ä¸ªæ•°çš„çº¿ç¨‹å°±å¥½ ä½†æ˜¯ç°å®ä¸­ï¼Œä½ ä¹Ÿè®¸å¬è¿‡æˆ–è€…è¢«è¦æ±‚ï¼š å°½é‡é¿å…æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼Œåº”ä½¿ç”¨çº¿ç¨‹æ± ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„è¦æ±‚ï¼ŸèƒŒåçš„é“ç†åˆæ˜¯æ€æ ·çš„å‘¢ï¼Ÿé¡ºç€è¿™ä¸ªç»éªŒç†è®ºæ¥æ¨æ–­ï¼Œé‚£è‚¯å®šæ˜¯æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æœ‰ç¼ºç‚¹ æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ ä¸å—æ§é£é™© é¢‘ç¹åˆ›å»ºå¼€é”€å¤§ ä¸å—æ§é£é™©è¿™ä¸ªç¼ºç‚¹ï¼Œç›¸ä¿¡ä½ ä¹Ÿå¯ä»¥è¯´å‡ºä¸€äºŒ ç³»ç»Ÿèµ„æºæœ‰é™ï¼Œæ¯ä¸ªäººé’ˆå¯¹ä¸åŒä¸šåŠ¡éƒ½å¯ä»¥æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹ï¼Œå¹¶ä¸”åˆ›å»ºæ ‡å‡†ä¸ä¸€æ ·ï¼ˆæ¯”å¦‚çº¿ç¨‹æ²¡æœ‰åå­—ï¼‰ã€‚å½“ç³»ç»Ÿè¿è¡Œèµ·æ¥ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨ç–¯ç‹‚æŠ¢å èµ„æºï¼Œæ— ç»„ç»‡æ— çºªå¾‹ï¼Œæ··ä¹±åœºé¢å¯æƒ³è€ŒçŸ¥ï¼ˆå‡ºç°é—®é¢˜ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸å¯èƒ½è½»æ˜“çš„å‘ç°å’Œè§£å†³ï¼‰ å¦‚æœæœ‰ä½ç¥å¥‡çš„å°ä¼™ä¼´ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚éƒ½åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå½“å¤§é‡è¯·æ±‚é“ºé¢è€Œæ¥çš„æ—¶å€™ï¼Œè¿™å¥½æ¯”ä¸€ä¸ªæ­£è§„æœ¨é©¬ç¨‹åºï¼Œå†…å­˜è¢«æ— æƒ…æ¦¨å¹²è€—å°½ï¼ˆä½ æ— æƒ…ï¼Œä½ å†·é…·ï¼Œä½ æ— ç†å–é—¹ï¼‰ å¦å¤–ï¼Œè¿‡å¤šçš„çº¿ç¨‹è‡ªç„¶ä¹Ÿä¼šå¼•èµ·ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ æ€»çš„æ¥è¯´ï¼Œä¸å—æ§é£é™©å¾ˆå¤§ é¢‘ç¹åˆ›å»ºå¼€é”€å¤§ é¢è¯•é—®ï¼šé¢‘ç¹æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ ç­”ï¼šå¼€é”€å¤§ è¿™è²Œä¼¼æ˜¯ä¸€ä¸ªä¸å‡æ€ç´¢å°±å¯ä»¥å›ç­”å‡ºæ¥çš„æ­£ç¡®ç­”æ¡ˆã€‚é‚£æˆ‘è¦ç»§ç»­é—®äº† é¢è¯•å®˜ï¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹²äº†ä»€ä¹ˆå°±å¼€é”€å¤§äº†ï¼Ÿå’Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ™®é€š Java å¯¹è±¡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ ç­”ï¼š â€¦ å—¯â€¦å•Š æŒ‰ç…§å¸¸è§„ç†è§£ new Thread() åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å’Œ new Object() æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ã€‚Javaä¸­ä¸‡ç‰©æ¥å¯¹è±¡ï¼Œå› ä¸º Thread çš„è€ç¥–å®—ä¹Ÿæ˜¯ Object å¦‚æœä½ çœŸæ˜¯è¿™ä¹ˆç†è§£çš„ï¼Œè¯´æ˜ä½ å¯¹çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸè¿˜ä¸æ˜¯å¾ˆç†è§£ï¼Œè¯·å›çœ‹ä¹‹å‰çš„ Javaçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸè¿™æ ·ç†è§£æŒºç®€å•çš„ åœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬æ˜ç¡®è¯´æ˜ï¼Œnew Thread() åœ¨æ“ä½œç³»ç»Ÿå±‚é¢å¹¶æ²¡æœ‰åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œè¿™æ˜¯ç¼–ç¨‹è¯­è¨€ç‰¹æœ‰çš„ã€‚çœŸæ­£è½¬æ¢ä¸ºæ“ä½œç³»ç»Ÿå±‚é¢åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿˜è¦è°ƒç”¨æ“ä½œç³»ç»Ÿå†…æ ¸çš„APIï¼Œç„¶åæ“ä½œç³»ç»Ÿè¦ä¸ºè¯¥çº¿ç¨‹åˆ†é…ä¸€ç³»åˆ—çš„èµ„æº åºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬å°†äºŒè€…åšä¸ªå¯¹æ¯”ï¼š new Object() è¿‡ç¨‹1Object obj = new Object(); å½“æˆ‘éœ€è¦ã€å¯¹è±¡ã€‘æ—¶ï¼Œæˆ‘å°±ä¼šç»™è‡ªå·± new ä¸€ä¸ªï¼ˆä¸çŸ¥ä½ æ˜¯å¦å’Œæˆ‘ä¸€æ ·ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹ä½ åº”è¯¥å¾ˆç†Ÿæ‚‰äº†ï¼š åˆ†é…ä¸€å—å†…å­˜ M åœ¨å†…å­˜ M ä¸Šåˆå§‹åŒ–è¯¥å¯¹è±¡ å°†å†…å­˜ M çš„åœ°å€èµ‹å€¼ç»™å¼•ç”¨å˜é‡ obj å°±æ˜¯è¿™ä¹ˆç®€å• åˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„è¿‡ç¨‹ä¸Šé¢å·²ç»æåˆ°äº†ï¼Œåˆ›å»ºä¸€ä¸ªçº¿ç¨‹è¿˜è¦è°ƒç”¨æ“ä½œç³»ç»Ÿå†…æ ¸APIã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹çš„å¼€é”€ï¼Œæˆ‘ä»¬éœ€è¦çœ‹çœ‹ JVM åœ¨èƒŒåå¸®æˆ‘ä»¬åšäº†å“ªäº›äº‹æƒ…ï¼š å®ƒä¸ºä¸€ä¸ªçº¿ç¨‹æ ˆåˆ†é…å†…å­˜ï¼Œè¯¥æ ˆä¸ºæ¯ä¸ªçº¿ç¨‹æ–¹æ³•è°ƒç”¨ä¿å­˜ä¸€ä¸ªæ ˆå¸§ æ¯ä¸€æ ˆå¸§ç”±ä¸€ä¸ªå±€éƒ¨å˜é‡æ•°ç»„ã€è¿”å›å€¼ã€æ“ä½œæ•°å †æ ˆå’Œå¸¸é‡æ± ç»„æˆ ä¸€äº›æ”¯æŒæœ¬æœºæ–¹æ³•çš„ jvm ä¹Ÿä¼šåˆ†é…ä¸€ä¸ªæœ¬æœºå †æ ˆ æ¯ä¸ªçº¿ç¨‹è·å¾—ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œå‘Šè¯‰å®ƒå½“å‰å¤„ç†å™¨æ‰§è¡Œçš„æŒ‡ä»¤æ˜¯ä»€ä¹ˆ ç³»ç»Ÿåˆ›å»ºä¸€ä¸ªä¸Javaçº¿ç¨‹å¯¹åº”çš„æœ¬æœºçº¿ç¨‹ å°†ä¸çº¿ç¨‹ç›¸å…³çš„æè¿°ç¬¦æ·»åŠ åˆ°JVMå†…éƒ¨æ•°æ®ç»“æ„ä¸­ çº¿ç¨‹å…±äº«å †å’Œæ–¹æ³•åŒºåŸŸ è¿™æ®µæè¿°ç¨ç¨æœ‰ç‚¹æŠ½è±¡ï¼Œç”¨æ•°æ®æ¥è¯´æ˜åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼ˆå³ä¾¿ä¸å¹²ä»€ä¹ˆï¼‰éœ€è¦å¤šå¤§ç©ºé—´å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¤§çº¦ 1M å·¦å³ 1java -XX:+UnlockDiagnosticVMOptions -XX:NativeMemoryTracking=summary -XX:+PrintNMTStatistics -version ä¸Šå›¾æ˜¯æˆ‘ç”¨ Java8 çš„æµ‹è¯•ç»“æœï¼Œ19ä¸ªçº¿ç¨‹ï¼Œé¢„ç•™å’Œæäº¤çš„å¤§æ¦‚éƒ½æ˜¯19000+KBï¼Œå¹³å‡æ¯ä¸ªçº¿ç¨‹å¤§æ¦‚éœ€è¦ 1M å·¦å³çš„å¤§å°ï¼ˆJava11çš„ç»“æœå®Œå…¨ä¸åŒï¼Œè¿™ä¸ªå¤§å®¶è‡ªè¡Œæµ‹è¯•å§ï¼‰ ç›¸ä¿¡åˆ°è¿™é‡Œä½ å·²ç»æ˜ç™½äº†ï¼Œå¯¹äºæ€§èƒ½è¦æ±‚ä¸¥è‹›çš„ç°åœ¨ï¼Œé¢‘ç¹æ‰‹åŠ¨åˆ›å»º/é”€æ¯çº¿ç¨‹çš„ä»£ä»·æ˜¯éå¸¸å·¨å¤§çš„ï¼Œè§£å†³æ–¹æ¡ˆè‡ªç„¶ä¹Ÿæ˜¯ä½ çŸ¥é“çš„çº¿ç¨‹æ± äº† ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿä½ å¸¸è§çš„æ•°æ®åº“è¿æ¥æ± ï¼Œå®ä¾‹æ± ï¼Œè¿˜æœ‰XXæ± ï¼ŒOOæ± ï¼Œå„ç§æ± ï¼Œéƒ½æ˜¯ä¸€ç§æ± åŒ–ï¼ˆpoolingï¼‰æ€æƒ³ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯ä¸ºäº†æœ€å¤§åŒ–æ”¶ç›Šï¼Œå¹¶æœ€å°åŒ–é£é™©ï¼Œå°†èµ„æºç»Ÿä¸€åœ¨ä¸€èµ·ç®¡ç†çš„æ€æƒ³ Java ä¹Ÿæä¾›äº†å®ƒè‡ªå·±å®ç°çš„çº¿ç¨‹æ± æ¨¡å‹â€”â€” ThreadPoolExecutorã€‚å¥—ç”¨ä¸Šé¢æ± åŒ–çš„æƒ³è±¡æ¥è¯´ï¼ŒJavaçº¿ç¨‹æ± å°±æ˜¯ä¸ºäº†æœ€å¤§åŒ–é«˜å¹¶å‘å¸¦æ¥çš„æ€§èƒ½æå‡ï¼Œå¹¶æœ€å°åŒ–æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹çš„é£é™©ï¼Œå°†å¤šä¸ªçº¿ç¨‹ç»Ÿä¸€åœ¨ä¸€èµ·ç®¡ç†çš„æ€æƒ³ ä¸ºäº†äº†è§£è¿™ä¸ªç®¡ç†æ€æƒ³ï¼Œæˆ‘ä»¬å½“å‰åªéœ€è¦å…³æ³¨ ThreadPoolExecutor æ„é€ æ–¹æ³•å°±å¯ä»¥äº† 123456789101112131415161718192021222324public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) &#123; if (corePoolSize &lt; 0 || maximumPoolSize &lt;= 0 || maximumPoolSize &lt; corePoolSize || keepAliveTime &lt; 0) throw new IllegalArgumentException(); if (workQueue == null || threadFactory == null || handler == null) throw new NullPointerException(); this.acc = System.getSecurityManager() == null ? null : AccessController.getContext(); this.corePoolSize = corePoolSize; this.maximumPoolSize = maximumPoolSize; this.workQueue = workQueue; this.keepAliveTime = unit.toNanos(keepAliveTime); this.threadFactory = threadFactory; this.handler = handler;&#125; è¿™ä¹ˆå¤æ‚çš„æ„é€ æ–¹æ³•åœ¨JDKä¸­è¿˜çœŸæ˜¯ä¸å¤šè§ï¼Œä¸ºäº†ä¸ªæ›´å½¢è±¡åŒ–çš„è®©å¤§å®¶ç†è§£è¿™å‡ ä¸ªæ ¸å¿ƒå‚æ•°ï¼Œæˆ‘ä»¬ä»¥å¤šæ•°äººéƒ½ç»å†è¿‡çš„æ˜¥è¿ï¼ˆåŒ—äº¬â€”â€”ä¸Šæµ·ï¼‰æ¥è¯´æ˜ åºå· å‚æ•°åç§° å‚æ•°è§£é‡Š æ˜¥è¿å½¢è±¡è¯´æ˜ 1 corePoolSize è¡¨ç¤ºå¸¸é©»æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœå¤§äº0ï¼Œå³ä½¿æœ¬åœ°ä»»åŠ¡æ‰§è¡Œå®Œä¹Ÿä¸ä¼šè¢«é”€æ¯ æ—¥å¸¸å›ºå®šçš„åˆ—è½¦æ•°è¾†ï¼ˆä¸ç®¡æ˜¯ä¸æ˜¯æ˜¥è¿ï¼Œéƒ½è¦æœ‰å›ºå®šè¿™äº›è½¦æ¬¡è¿è¡Œï¼‰ 2 maximumPoolSize è¡¨ç¤ºçº¿ç¨‹æ± èƒ½å¤Ÿå®¹çº³å¯åŒæ—¶æ‰§è¡Œçš„æœ€å¤§çº¿ç¨‹æ•° æ˜¥è¿å®¢æµé‡å¤§ï¼Œä¸´æ—¶åŠ è½¦ï¼ŒåŠ è½¦åï¼Œæ€»åˆ—è½¦æ¬¡æ•°ä¸èƒ½è¶…è¿‡è¿™ä¸ªæœ€å¤§å€¼ï¼Œå¦åˆ™å°±ä¼šå‡ºç°è°ƒåº¦ä¸å¼€ç­‰é—®é¢˜ ï¼ˆç»“åˆworkqueueï¼‰ 3 keepAliveTime è¡¨ç¤ºçº¿ç¨‹æ± ä¸­çº¿ç¨‹ç©ºé—²çš„æ—¶é—´ï¼Œå½“ç©ºé—²æ—¶é—´è¾¾åˆ°è¯¥å€¼æ—¶ï¼Œçº¿ç¨‹ä¼šè¢«é”€æ¯ï¼Œåªå‰©ä¸‹ corePoolSize ä¸ªçº¿ç¨‹ä½ç½® æ˜¥è¿å‹åŠ›è¿‡åï¼Œä¸´æ—¶çš„åŠ è½¦ï¼ˆå¦‚æœç©ºé—²æ—¶é—´è¶…è¿‡keepAliveTimeï¼‰å°±ä¼šè¢«æ’¤æ‰ï¼Œåªä¿ç•™æ—¥å¸¸å›ºå®šçš„åˆ—è½¦è½¦æ¬¡æ•°é‡ç”¨äºæ—¥å¸¸è¿è¥ 4 unit keepAliveTime çš„æ—¶é—´å•ä½ï¼Œæœ€ç»ˆéƒ½ä¼šè½¬æ¢æˆã€çº³ç§’ã€‘ï¼Œå› ä¸ºCPUçš„æ‰§è¡Œé€Ÿåº¦æ æ æ»´ keepAliveTime çš„å•ä½ï¼Œæ˜¥è¿ä»¥ã€å¤©ã€‘ä¸ºè®¡ç®—å•ä½ 5 workQueue å½“è¯·æ±‚çš„çº¿ç¨‹æ•°å¤§äº corePoolSize æ—¶ï¼Œçº¿ç¨‹è¿›å…¥è¯¥é˜»å¡é˜Ÿåˆ— æ˜¥è¿å‹åŠ›å¼‚å¸¸å¤§ï¼Œï¼ˆè¾¾åˆ°corePoolSizeï¼‰ä¹Ÿä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œæ‰€æœ‰ä¹˜åè¯·æ±‚éƒ½ä¼šè¿›å…¥è¯¥é˜»å¡é˜Ÿåˆ—ä¸­æ’é˜Ÿ, é˜Ÿåˆ—æ»¡ï¼Œè¿˜æœ‰é¢å¤–è¯·æ±‚ï¼Œå°±éœ€è¦åŠ è½¦äº† 6 threadFactory é¡¾åæ€ä¹‰ï¼Œçº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥ç”Ÿäº§ä¸€ç»„ç›¸åŒä»»åŠ¡çš„çº¿ç¨‹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡å®ƒå¢åŠ å‰ç¼€åï¼Œè™šæ‹Ÿæœºæ ˆåˆ†ææ—¶æ›´æ¸…æ™° æ¯”å¦‚ï¼ˆåŒ—äº¬â€”â€”ä¸Šæµ·ï¼‰å°±å±äºè¯¥æ®µåˆ—è½¦æ‰€æœ‰å‰ç¼€ï¼Œè¡¨æ˜åˆ—è½¦è¿è¾“èŒè´£ 7 handler æ‰§è¡Œæ‹’ç»ç­–ç•¥ï¼Œå½“ workQueue è¾¾åˆ°ä¸Šé™ï¼ŒåŒæ—¶ä¹Ÿè¾¾åˆ° maximumPoolSize å°±è¦é€šè¿‡è¿™ä¸ªæ¥å¤„ç†ï¼Œæ¯”å¦‚æ‹’ç»ï¼Œä¸¢å¼ƒç­‰ï¼Œè¿™æ˜¯ä¸€ç§é™æµçš„ä¿æŠ¤æªæ–½ å½“workQueueæ’é˜Ÿä¹Ÿè¾¾åˆ°é˜Ÿåˆ—æœ€å¤§ä¸Šçº¿ï¼ŒmaximumPoolSize å°±è¦æç¤ºæ— ç¥¨ç­‰æ‹’ç»ç­–ç•¥äº†,å› ä¸ºæˆ‘ä»¬ä¸èƒ½åŠ è½¦äº†ï¼Œå½“å‰æ‰€æœ‰è½¦æ¬¡å·²ç»æ»¡è´Ÿè½½ æ•´ä½“æ¥çœ‹å°±æ˜¯è¿™æ ·ï¼š è¯•æƒ³ï¼Œå¦‚æœæœ‰è¯·æ±‚å°±æ–°å»ºä¸€è¶Ÿåˆ—è½¦ï¼Œè¯·æ±‚ç»“æŸå°±â€œé”€æ¯â€è¿™è¶Ÿåˆ—è½¦ï¼Œé¢‘ç¹å¾€å¤è¿™æ ·æ“ä½œï¼Œè¿™æ ·çš„ä»£ä»·è‚¯å®šæ˜¯ä¸èƒ½æ¥å—çš„ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨çº¿ç¨‹æ± ä¸ä½†èƒ½å®Œæˆæ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹å¯ä»¥åšåˆ°çš„å·¥ä½œï¼ŒåŒæ—¶ä¹Ÿå¡«è¡¥äº†æ‰‹åŠ¨çº¿ç¨‹ä¸èƒ½åšåˆ°çš„ç©ºç™½ã€‚å½’çº³èµ·æ¥è¯´ï¼Œçº¿ç¨‹æ± çš„ä½œç”¨åŒ…æ‹¬ï¼š åˆ©ç”¨çº¿ç¨‹æ± ç®¡ç†å¹¶æœç”¨çº¿ç¨‹ï¼Œæ§åˆ¶æœ€å¤§å¹¶å‘æ•°ï¼ˆæ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹å¾ˆéš¾å¾—åˆ°ä¿è¯ï¼‰ å®ç°ä»»åŠ¡çº¿ç¨‹é˜Ÿåˆ—ç¼“å­˜ç­–ç•¥å’Œæ‹’ç»æœºåˆ¶ å®ç°æŸäº›ä¸å®è·µç›¸å…³çš„åŠŸèƒ½ï¼Œå¦‚å®šæ—¶æ‰§è¡Œï¼Œå‘¨æœŸæ‰§è¡Œç­‰ï¼ˆæ¯”å¦‚åˆ—è½¦æŒ‡å®šæ—¶é—´è¿è¡Œï¼‰ éš”ç¦»çº¿ç¨‹ç¯å¢ƒï¼Œæ¯”å¦‚ï¼Œäº¤æ˜“æœåŠ¡å’Œæœç´¢æœåŠ¡åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œåˆ†åˆ«å¼€å¯ä¸¤ä¸ªçº¿ç¨‹æ± ï¼Œäº¤æ˜“çº¿ç¨‹çš„èµ„æºæ¶ˆè€—æ˜æ˜¾è¦å¤§ã€‚å› æ­¤ï¼Œé€šè¿‡é…ç½®ç‹¬ç«‹çš„çº¿ç¨‹æ± ï¼Œå°†è¾ƒæ…¢çš„äº¤æ˜“æœåŠ¡ä¸æœç´¢æœåŠ¡ä¸ªç¦»å¼€ï¼Œé¿å…ä¸ªæœåŠ¡çº¿ç¨‹äº’ç›¸å½±å“ ç›¸ä¿¡åˆ°è¿™é‡Œï¼Œä½ å·²ç»äº†è§£çº¿ç¨‹æ± çš„åŸºæœ¬æ€æƒ³äº†ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­è¿˜æ˜¯æœ‰å‡ ä¸ªæ³¨æ„äº‹é¡¹è¦è¯´æ˜ä¸€ä¸‹çš„ çº¿ç¨‹æ± ä½¿ç”¨æ€æƒ³/æ³¨æ„äº‹é¡¹ä¸èƒ½å¿½ç•¥çš„çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥æˆ‘ä»¬å¾ˆéš¾å‡†ç¡®çš„é¢„æµ‹æœªæ¥çš„æœ€å¤§å¹¶å‘é‡ï¼Œæ‰€ä»¥å®šåˆ¶åˆç†çš„æ‹’ç»ç­–ç•¥æ˜¯å¿…ä¸å¯å°‘çš„æ­¥éª¤ã€‚é»˜è®¤æƒ…å†µï¼Œ ThreadPoolExecutor æä¾›äº†å››ç§æ‹’ç»ç­–ç•¥ï¼š AbortPolicyï¼šé»˜è®¤çš„æ‹’ç»ç­–ç•¥ï¼Œä¼š throw RejectedExecutionException æ‹’ç» CallerRunsPolicyï¼šæäº¤ä»»åŠ¡çš„çº¿ç¨‹è‡ªå·±å»æ‰§è¡Œè¯¥ä»»åŠ¡ DiscardOldestPolicyï¼šä¸¢å¼ƒæœ€è€çš„ä»»åŠ¡ï¼Œå…¶å®å°±æ˜¯æŠŠæœ€æ—©è¿›å…¥å·¥ä½œé˜Ÿåˆ—çš„ä»»åŠ¡ä¸¢å¼ƒï¼Œç„¶åæŠŠæ–°ä»»åŠ¡åŠ å…¥åˆ°å·¥ä½œé˜Ÿåˆ— DiscardPolicyï¼šç›¸å½“å¤§èƒ†çš„ç­–ç•¥ï¼Œç›´æ¥ä¸¢å¼ƒä»»åŠ¡ï¼Œæ²¡æœ‰ä»»ä½•å¼‚å¸¸æŠ›å‡º ä¸åŒçš„æ¡†æ¶ï¼ˆNettyï¼ŒDubboï¼‰éƒ½æœ‰ä¸åŒçš„æ‹’ç»ç­–ç•¥ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å®ç° RejectedExecutionHandler è‡ªå®šä¹‰çš„æ‹’ç»ç­–ç•¥ å¯¹äºé‡‡ç”¨ä½•ç§ç­–ç•¥ï¼Œå…·ä½“è¦çœ‹æ‰§è¡Œçš„ä»»åŠ¡é‡è¦ç¨‹åº¦ã€‚å¦‚æœæ˜¯ä¸€äº›ä¸é‡è¦ä»»åŠ¡ï¼Œå¯ä»¥é€‰æ‹©ç›´æ¥ä¸¢å¼ƒï¼›å¦‚æœæ˜¯é‡è¦ä»»åŠ¡ï¼Œå¯ä»¥é‡‡ç”¨é™çº§ï¼ˆæ‰€è°“é™çº§å°±æ˜¯åœ¨æœåŠ¡æ— æ³•æ­£å¸¸æä¾›åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œé‡‡å–çš„è¡¥æ•‘æªæ–½ã€‚å…·ä½“é‡‡ç”¨ä½•ç§é™çº§æ‰‹æ®µï¼Œè¿™ä¹Ÿæ˜¯è¦çœ‹å…·ä½“åœºæ™¯ï¼‰å¤„ç†ï¼Œä¾‹å¦‚å°†ä»»åŠ¡ä¿¡æ¯æ’å…¥æ•°æ®åº“æˆ–è€…æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¯ç”¨ä¸€ä¸ªä¸“é—¨ç”¨ä½œè¡¥å¿çš„çº¿ç¨‹æ± å»è¿›è¡Œè¡¥å¿ æ²¡æœ‰ç»å¯¹çš„æ‹’ç»ç­–ç•¥ï¼Œåªæœ‰é€‚åˆé‚£ä¸€ä¸ªï¼Œä½†åœ¨è®¾è®¡è¿‡ç¨‹ä¸­åƒä¸‡ä¸è¦å¿½ç•¥æ‰æ‹’ç»ç­–ç•¥å°±å¯ä»¥ ç¦æ­¢ä½¿ç”¨Executorsåˆ›å»ºçº¿ç¨‹æ± ç›¸ä¿¡å¾ˆå¤šäººéƒ½çœ‹åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼ˆé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œè¯´æ˜ç¦æ­¢ä½¿ç”¨ Executors åˆ›å»ºçº¿ç¨‹æ± ï¼‰ï¼Œæˆ‘æŠŠå‡ºå¤„ï¼ˆP247ï¼‰æˆªå›¾åœ¨æ­¤ï¼š Executors å¤§å¤§çš„ç®€åŒ–äº†æˆ‘ä»¬åˆ›å»ºå„ç§ç±»å‹çº¿ç¨‹æ± çš„æ–¹å¼ï¼Œä¸ºä»€ä¹ˆè¿˜ä¸è®©ä½¿ç”¨å‘¢ï¼Ÿ å…¶å®ï¼Œåªè¦ä½ æ‰“å¼€çœ‹çœ‹å®ƒçš„é™æ€æ–¹æ³•å‚æ•°å°±ä¼šæ˜ç™½äº† ä¼ å…¥çš„workQueue æ˜¯ä¸€ä¸ªè¾¹ç•Œä¸º Integer.MAX_VALUE é˜Ÿåˆ—ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å˜ç›¸çš„ç§°ä¹‹ä¸ºæ— ç•Œé˜Ÿåˆ—äº†ï¼Œå› ä¸ºè¾¹ç•Œå¤ªå¤§äº†ï¼Œè¿™ä¹ˆå¤§çš„ç­‰å¾…é˜Ÿåˆ—ä¹Ÿæ˜¯éå¸¸æ¶ˆè€—å†…å­˜çš„ 1234567/** * Creates a &#123;@code LinkedBlockingQueue&#125; with a capacity of * &#123;@link Integer#MAX_VALUE&#125;. */public LinkedBlockingQueue() &#123; this(Integer.MAX_VALUE);&#125; å¦å¤–è¯¥ ThreadPoolExecutoræ–¹æ³•ä½¿ç”¨çš„æ˜¯é»˜è®¤æ‹’ç»ç­–ç•¥ï¼ˆç›´æ¥æ‹’ç»ï¼‰ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰ä¸šåŠ¡åœºæ™¯éƒ½é€‚åˆä½¿ç”¨è¿™ä¸ªç­–ç•¥ï¼Œå½“å¾ˆé‡è¦çš„è¯·æ±‚è¿‡æ¥ç›´æ¥é€‰æ‹©æ‹’ç»æ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ æ€»çš„æ¥è¯´ï¼Œä½¿ç”¨ Executors åˆ›å»ºçš„çº¿ç¨‹æ± å¤ªè¿‡äºç†æƒ³åŒ–ï¼Œå¹¶ä¸èƒ½æ»¡è¶³å¾ˆå¤šç°å®ä¸­çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ‰€ä»¥è¦æ±‚æˆ‘ä»¬é€šè¿‡ ThreadPoolExecutoræ¥åˆ›å»ºï¼Œå¹¶ä¼ å…¥åˆé€‚çš„å‚æ•° æ€»ç»“å½“æˆ‘ä»¬éœ€è¦é¢‘ç¹çš„åˆ›å»ºçº¿ç¨‹æ—¶ï¼Œæˆ‘ä»¬è¦è€ƒè™‘åˆ°é€šè¿‡çº¿ç¨‹æ± ç»Ÿä¸€ç®¡ç†çº¿ç¨‹èµ„æºï¼Œé¿å…ä¸å¯æ§é£é™©ä»¥åŠé¢å¤–çš„å¼€é”€ äº†è§£äº†çº¿ç¨‹æ± çš„å‡ ä¸ªæ ¸å¿ƒå‚æ•°æ¦‚å¿µåï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ç»è¿‡è°ƒä¼˜çš„è¿‡ç¨‹æ¥è®¾ç½®æœ€ä½³çº¿ç¨‹å‚æ•°å€¼ï¼ˆè¿™ä¸ªè¿‡ç¨‹æ—¶å¿…ä¸å¯å°‘çš„ï¼‰ çº¿ç¨‹æ± è™½ç„¶å¼¥è¡¥äº†æ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹çš„ç¼ºé™·å’Œç©ºç™½ï¼ŒåŒæ—¶ï¼Œåˆç†çš„é™çº§ç­–ç•¥èƒ½å¤§å¤§å¢åŠ ç³»ç»Ÿçš„ç¨³å®šæ€§ é˜¿é‡Œå·´å·´æ‰‹å†Œéƒ½æ˜¯å‰è¾ˆä»¬æ— æ•°å¡«å‘åæ€»ç»“çš„ç²¾åï¼Œä½ ä¹Ÿåº”è¯¥éµå®ˆç›¸åº”çš„æŒ‡ç¤ºï¼Œç»“åˆè‡ªå·±çš„å®é™…ä¸šåŠ¡åœºæ™¯ï¼Œè®¾å®šåˆé€‚çš„å‚æ•°æ¥åˆ›å»ºçº¿ç¨‹æ±  çµé­‚è¿½é—® æˆ‘ä»¬è¯´äº†è¿™ä¹ˆå¤šçº¿ç¨‹æ± çš„å¥½ï¼Œé‚£ä½¿ç”¨çº¿ç¨‹æ± æœ‰å“ªäº›ç¼ºç‚¹æˆ–é™åˆ¶å‘¢ï¼Ÿ ä¸ºä»€ä¹ˆä¸å»ºè®®æ‰€æœ‰ä¸šåŠ¡å…±ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼Ÿæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ ç»™çº¿ç¨‹æ± è®¾ç½®æŒ‡å®šå‰ç¼€ï¼Œæœ‰å“ªäº›æ–¹å¼ï¼Ÿ å‚è€ƒæ„Ÿè°¢å‰è¾ˆä»¬æ€»ç»“çš„ç²¾åï¼Œè‡ªå·±æ‰€å†™çš„å¹¶å‘ç³»åˆ—å¥½å¤šéƒ½å‚è€ƒäº†ä»¥ä¸‹èµ„æ–™ Java å¹¶å‘ç¼–ç¨‹å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹ä¹‹ç¾ ç å‡ºé«˜æ•ˆ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ ifeve ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"å¦‚ä½•æ¸…çˆ½çš„å®‰æ’æ—¥å¸¸ï¼Ÿ","slug":"å¦‚ä½•åˆç†çš„å®‰æ’æ—¥å¸¸ï¼Ÿ","date":"2020-04-12T08:01:18.000Z","updated":"2020-04-15T00:16:02.641Z","comments":true,"path":"/p/how-to-organize-your-day.html","link":"","permalink":"https://dayarch.top/p/how-to-organize-your-day.html","excerpt":"æœ‰æœ‹å‹ç§ä¿¡é—®æˆ‘å¦‚ä½•å®‰æ’æ—¥å¸¸ï¼Œä»¥åŠç›¸å¯¹é«˜æ•ˆçš„å†™ä¸œè¥¿ï¼Ÿæˆ‘è§‰å¾—æœ‰å¿…è¦å•ç‹¬å†™ä¸€ç¯‡æ–‡ç« æ¥å’Œå¤§å®¶äº¤æµè¿™ä¸ªäº‹ ä¸åšæ²¡æœ‰çµé­‚çš„ TODO List æˆ‘ä»¬éƒ½æ˜¯ä¸Šè¿›çš„å¥½é’å¹´ï¼Œå¤§å®¶æ‰‹é‡Œåº”è¯¥éƒ½æœ‰è‡ªå·±çš„ TODO listï¼Œæˆ‘é€šå¸¸ä¼šç”¨ Microsoft To Do è¿™æ¬¾è½¯ä»¶åšç®€å•çš„æ—¥å¸¸å®‰æ’ æ±‚å­¦æœŸé—´ï¼Œæ¯ä¸ªå¯’æš‘å‡ä¸´è¿‘ï¼Œæˆ‘éƒ½å¯ä»¥æŠŠåšå„ç§ planï¼Œç«‹å„ç§ flag çš„æ°”è´¨æ‹¿æçš„æ­»æ­»çš„ã€‚å¦‚ä½ æ‰€æ–™ï¼Œå‡æœŸè¿‡åä¸€ä¸ª plan éƒ½æ²¡æœ‰åšï¼Œä¸€ä¸ª flag éƒ½æ²¡æœ‰å®Œæˆã€‚ è¿™ç§è¡¨é¢é£å…‰ï¼Œå®åˆ™æ²¡æœ‰äº†çµé­‚TODO list åªæ˜¯çŸ­æœŸå¿ƒç†æ…°è—‰ï¼Œå½“éœ€è¦éªŒè¯ç»“æœæ—¶ï¼Œæƒ…ç»ªè½»åˆ™ä½è½ä¸€ä¼šï¼Œé‡åˆ™ç„¦è™‘åŠå¤© é€ æˆè¿™ç§é—®é¢˜çš„åŸå› å¾ˆç®€å• * å¤§æ‚","text":"æœ‰æœ‹å‹ç§ä¿¡é—®æˆ‘å¦‚ä½•å®‰æ’æ—¥å¸¸ï¼Œä»¥åŠç›¸å¯¹é«˜æ•ˆçš„å†™ä¸œè¥¿ï¼Ÿæˆ‘è§‰å¾—æœ‰å¿…è¦å•ç‹¬å†™ä¸€ç¯‡æ–‡ç« æ¥å’Œå¤§å®¶äº¤æµè¿™ä¸ªäº‹ ä¸åšæ²¡æœ‰çµé­‚çš„ TODO Listæˆ‘ä»¬éƒ½æ˜¯ä¸Šè¿›çš„å¥½é’å¹´ï¼Œå¤§å®¶æ‰‹é‡Œåº”è¯¥éƒ½æœ‰è‡ªå·±çš„ TODO listï¼Œæˆ‘é€šå¸¸ä¼šç”¨ Microsoft To Do è¿™æ¬¾è½¯ä»¶åšç®€å•çš„æ—¥å¸¸å®‰æ’ æ±‚å­¦æœŸé—´ï¼Œæ¯ä¸ªå¯’æš‘å‡ä¸´è¿‘ï¼Œæˆ‘éƒ½å¯ä»¥æŠŠåšå„ç§ planï¼Œç«‹å„ç§ flag çš„æ°”è´¨æ‹¿æçš„æ­»æ­»çš„ã€‚å¦‚ä½ æ‰€æ–™ï¼Œå‡æœŸè¿‡åä¸€ä¸ª plan éƒ½æ²¡æœ‰åšï¼Œä¸€ä¸ª flag éƒ½æ²¡æœ‰å®Œæˆã€‚ è¿™ç§è¡¨é¢é£å…‰ï¼Œå®åˆ™æ²¡æœ‰äº†çµé­‚TODO list åªæ˜¯çŸ­æœŸå¿ƒç†æ…°è—‰ï¼Œå½“éœ€è¦éªŒè¯ç»“æœæ—¶ï¼Œæƒ…ç»ªè½»åˆ™ä½è½ä¸€ä¼šï¼Œé‡åˆ™ç„¦è™‘åŠå¤© é€ æˆè¿™ç§é—®é¢˜çš„åŸå› å¾ˆç®€å• å¤§æ‚çƒ© TODO æ²¡æœ‰è½»é‡ç¼“æ€¥ æ²¡æœ‰å¯ä»¥è½åœ°çš„æ‰§è¡Œè®¡åˆ’å’Œè‡ªæˆ‘çº¦æŸèƒ½åŠ› å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ ç­›é€‰åšäº‹æˆ‘ä»¬çŸ¥é“ä¸‰æ€è€Œåè¡Œï¼Œåš plan å¥½åƒæ²¡æœ‰æˆæœ¬ä¸€æ ·ï¼Œæˆ‘å´å¿˜è®°äº†ä¸‰æ€è€Œåè¡Œçš„é“ç†ã€‚å¯¼è‡´ todo list åˆè‡­åˆé•¿çš„åŸå› å¤šæ•°å‡ºäºå†²åŠ¨æ€§æ€ç»´ï¼Œè¿™æ˜¯äººæ€§ï¼Œä½†æˆ‘ä¸æ‰“ç®—é€†äººæ€§è€Œä¸ºä¹‹ï¼Œæˆ‘é€‰æ‹©åœ¨åŸæœ‰åŸºç¡€ä¸Šï¼Œå†å¤šåšä¸¤ä¸ª todo listï¼ˆä½ æ²¡çœ‹é”™ï¼‰ æ¸…å•Bï¼ˆAgile Backlogï¼‰ï¼šæ—¥å¸¸å¤©é©¬è¡Œç©ºçš„ï¼Œæ„æ·«çš„ï¼Œä¸´æ—¶æƒ³åˆ°çš„ï¼Œæˆ‘éƒ½ä¼šæ”¾åˆ°è¿™ä¸ªæ¸…å•é‡Œé¢ï¼Œæ»¡è¶³äº†æˆ‘è¿™ã€æ”¶è—ã€‘æ¢¦ æ¸…å•Gï¼ˆAgile Groomingï¼‰: åå¤æŸ¥çœ‹æ¸…å•Aï¼Œè‡ªæˆ‘åé—®ï¼ŒæŸä¸€é¡¹æ˜¯ä½ æƒ³è¦çš„å—ï¼Ÿæœ€ç»ˆåœ¨è¯¥æ¸…å•Gä¸­ç•™ä¸‹3åˆ°7ä¸ªé€‰é¡¹ æ¸…å•Sï¼ˆAgile Sprintï¼‰ï¼šçµé­‚æ‹·é—®è‡ªå·±ï¼Œåšå‡ºå–èˆï¼Œæœ€å¤šèƒ½ç•™ä¸‹ 1åˆ°3ä¸ª è¿™æ ·æˆ‘ä»¬åªéœ€åœ¨çŸ­æ—¶é—´å†…å…³æ³¨æ¸…å•Sçš„å†…å®¹ï¼Œå½“æ¸…å•Sçš„å†…å®¹åšå®Œï¼Œé‡å¤è¿™ä¸ªç­›é€‰æ­¥éª¤å³å¯ã€‚æˆ‘çš„æ¬²æœ›æ¸…å•å¹¶æ²¡æœ‰åˆ å‡ï¼Œåªæ˜¯æ¢äº†ä¸ªè§†è§’ï¼Œæ„Ÿè§‰å®Œå…¨ä¸ä¸€æ ·äº† ä¼˜å…ˆçº§äº‹æœ‰ã€è½»é‡ç¼“æ€¥ã€‘ï¼Œè¿™å››ä¸ªå­—çš„æ’åˆ—ç»„åˆå°±æ˜¯ä½ ç†Ÿæ‚‰çš„è±¡é™å›¾äº† æ’åˆ—ä¼˜å…ˆçº§æ˜¯åŸºæœ¬æŠ€èƒ½ï¼Œæ³¨æ„è¿™ä¸ªå›¾æ˜¯è¦æŒç»­æ›´æ–°çš„ï¼Œè€Œä¸æ˜¯ä¸€æˆä¸å˜çš„ Tips: ç”Ÿæ´»ä¸­æ€»ä¼šæœ‰å¾ˆå¤šæ’æ›²æ¥æ‰“æ–­æˆ‘ä»¬çš„è®¡åˆ’ï¼Œæ‰€ä»¥æˆ‘å¹¶ä¸ä¼šå°†æ—¶é—´æ’çš„å¾ˆæ»¡ï¼Œä¸€å®šè¦ç»™è‡ªå·±ç•™æœ‰ä¸€äº›bufferï¼Œè¿™æ ·ä¸è‡³äºè¢«å…¶ä»–äº‹æ‰“æ–­ï¼Œå¯¼è‡´åŸæœ‰äº‹æƒ…åšä¸å®Œè€Œå¸¦æ¥çš„æŒ«è´¥æ„Ÿï¼Œä½†ä¹Ÿä¸èƒ½ç•™å¤ªå¤šbufferï¼Œå› ä¸ºæˆ‘ä»¬éƒ½æœ‰æ‹–å»¶ç—‡/æƒ°æ€§ å¦å¤–ï¼Œç”Ÿæ´»ä¸­çš„å¤§å¤šæ•°äº‹æƒ…éƒ½å¤„åœ¨ç¬¬äºŒè±¡é™ã€é‡è¦ &amp; ä¸ç´§æ€¥ã€‘ï¼Œæ‰€ä»¥å¦‚ä½•åˆ†è§£ä»»åŠ¡ï¼Œåˆ¶å®šè®¡åˆ’ï¼Œå¹¶æŒ‰éƒ¨å°±ç­æ‰§è¡Œå°±æ˜¾å¾—å¾ˆé‡è¦äº† ä¸è¦å°†æ•´å—æ—¶é—´ç¢ç‰‡åŒ–éƒ½çŸ¥é“æœ‰è¿ç»­æ€§çš„åšäº‹ä¼šæ¯”è¾ƒé«˜æ•ˆï¼Œè¿™å°±éœ€è¦æ•´å—çš„æ—¶é—´ï¼Œä½†å½“æˆ‘æœ‰æ•´å—æ—¶é—´æ—¶ï¼Œè²Œä¼¼å¹¶ä¸çæƒœè¿™ä¸ªç¦åˆ©ï¼Œä¸€ä¼šçœ‹æ‰‹æœºèŠå¤©ï¼Œä¸€ä¼šè¯»ä¹¦ï¼Œä¸€ä¼šçœ‹è§†é¢‘ã€‚æ„Ÿè§‰è‡ªå·±å¿™å¿™ç¢Œç¢Œï¼Œå®åˆ™ä»€ä¹ˆéƒ½æ²¡åšæˆï¼Œè¿‡åéœ€è¦éªŒè¯æˆæœæ—¶ï¼Œä¸€ç‰‡èŒ«ç„¶ï¼ŒåŸå› æ˜¯æˆ‘ä»¬å°†æ—¶é—´ç¢ç‰‡åŒ–äº† æˆ‘ä»¬èƒ½ä¿æŒä¸“æ³¨çš„æ—¶é—´æœ‰é™ï¼Œè¿‡é•¿æ—¶é—´çš„çº¦æŸè‡ªå·±åè€Œæ˜¯é€†äººæ€§çš„è¡Œä¸ºï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦åœ¨ä¸“æ³¨å’Œæ”¾æ¾ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹ ç•ªèŒ„å·¥ä½œæ³• æŒ‰ç…§ç•ªèŒ„å·¥ä½œæ³•ï¼Œä¸€ä¸ªç•ªèŒ„é’Ÿæ˜¯25åˆ†é’Ÿï¼Œç•ªèŒ„é’Ÿé“ƒå“ï¼Œä¼‘æ¯3ï½5åˆ†é’Ÿï¼Œç»§ç»­ä¸‹ä¸€ä¸ªç•ªèŒ„é’Ÿã€‚ç•ªèŒ„é’Ÿå†…ç§‘å­¦çš„è®©æˆ‘ä¿æŒä¸“æ³¨ï¼›ä¼‘æ¯æ—¶é—´åˆè®©æˆ‘ç®€å•æŠŠç©æ‰‹æœºã€‚æ›´é‡è¦çš„æ˜¯å¯ä»¥å°†æ•´å—äº‹æƒ…æŒ‰ç…§ç•ªèŒ„é’Ÿè¿›è¡Œç»†åˆ†ï¼Œå½¢æˆå¯æ‰§è¡Œçš„è®¡åˆ’ï¼ˆChromeæµè§ˆå™¨å°±æœ‰ç›¸åº”çš„ç•ªèŒ„æ’ä»¶ï¼Œæ¯”å¦‚æˆ‘ç”¨çš„è¿™ä¸ªï¼‰ æœ€å¤§åŒ–åˆ©ç”¨ç¢ç‰‡åŒ–æ—¶é—´å¤§å®¶çš„ç¢ç‰‡åŒ–æ—¶é—´çœŸçš„éå¸¸å¤šï¼Œæ„Ÿè§‰å¯ä»¥ç©æ‰‹æœºçš„æ—¶é—´éƒ½æ˜¯æˆ‘ä»¬çš„ç¢ç‰‡åŒ–æ—¶é—´ï¼ˆä½ è„‘è¡¥ä¸€ä¸‹ä½ é€šå¸¸éƒ½åœ¨ä»€ä¹ˆæ—¶å€™ç©æ‰‹æœºï¼‰ è¿™ä¸ªæ—¶é—´æˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Ÿ ç®€å•æ‹‰ä¼¸åŠ¨ä½œå’Œæ‰©å±•è¿åŠ¨ å›é¡¾è¿‡å»ä¸€ä¸¤å¤©çš„ç‚¹ç‚¹æ»´æ»´åšä¸ªå¤ç›˜æ€»ç»“ï¼Œåšåˆ°å¿ƒä¸­æœ‰æ•° å¹³æ—¶è®¢é˜…çš„é«˜è´¨é‡å…¬ä¼—å·é›†ä¸­é˜…è¯»ï¼ˆæ¯”å¦‚æ—¥æ‹±ä¸€å…µï¼Œè¿™ä¸ªå¹¿å‘Šæ‰“çš„è¿æˆ‘è‡ªå·±éƒ½çŒä¸åŠé˜²ï¼‰ ç»™å®¶äººæœ‹å‹ä¸€äº›é—®å€™ â€¦â€¦ ä½ ä¼šå‘ç°ï¼Œç”Ÿæ´»ä¸­çš„ä¸€äº›ç»†ææœ«èŠ‚å°äº‹ï¼Œéƒ½å¯ä»¥é€šè¿‡ç¢ç‰‡åŒ–æ—¶é—´æ¥å®Œæˆï¼Œä¸ä¼šå¿™å¿™ç¢Œç¢Œ åˆ†æ¸…ä¸»æ¬¡å¤§å®¶éƒ½æ˜¯æˆå¹´äººï¼Œç”Ÿæ´»ä¸­è‚¯å®šä¸æ­¢ä¸€ä¸¤ä»¶äº‹éœ€è¦ä½ ç…§é¡¾ã€‚å³ä¾¿åŒæ ·å¤šçš„äº‹ï¼Œæ¯ä¸ªäººç…§é¡¾çš„æ–¹å¼å’Œé¡ºåºä¸ä¸€æ ·ï¼Œå¾—åˆ°çš„ç»“æœå’Œæ„Ÿå—è‡ªç„¶ä¹Ÿå°±ä¸ä¸€æ ·ï¼Œä¸ºäº†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æŠŠå¾ˆä¹…ä»¥å‰çœ‹è¿‡çš„ä¸€ä¸ªè§†é¢‘æ”¾åˆ°è¿™é‡Œã€å¦‚æœè§†é¢‘æ‰“ä¸å¼€ï¼Œå¯ä»¥ç‚¹å¼€æ‰“å¼€å¦‚ä½•æ¸…çˆ½çš„å®‰æ’æ—¥å¸¸ï¼Ÿ æŸ¥çœ‹ã€‘ åƒè§†é¢‘ä¸­è¯´çš„ä¸€æ ·ï¼Œå¶å°”ç»™è‡ªå·±å‡ æ¯å•¤é…’ï¼ˆæˆ‘é…’ç²¾è¿‡æ•å°±ä¸å–äº†ï¼‰ å¯»æ‰¾æˆ‘ä»¬éƒ½æ˜¯ç¨‹åºå‘˜ï¼Œæˆ‘å°±æ‹¿ç¨‹åºå·¥ä½œçš„äº‹æƒ…ä¸¾ä¾‹å­ï¼š ä½ å†™äº†æ— æ•°ä¸ªCRUDï¼Œå¸¦ç»™ä½ çš„æ˜¯ä»€ä¹ˆæ„Ÿè§‰ï¼Ÿ ä½ åšäº†ç®€å•çš„è°ƒä¼˜ï¼Œæ€§èƒ½æå‡äº†å‡ ä¸ªç™¾åˆ†æ¯”ï¼Œå¸¦ç»™çš„æ˜¯ä»€ä¹ˆæ„Ÿè§‰ï¼Ÿ ä½ é€šè¿‡åŠªåŠ›ï¼Œå…‹æœä¸€äº›å›°éš¾ï¼Œå®Œæˆä¸€äº›ä½ ä¹‹å‰çœ‹ä¼¼å¾ˆéš¾å¾—çš„é—®é¢˜ï¼Œå¸¦ç»™ä½ çš„æ˜¯ä»€ä¹ˆæ„Ÿè§‰ï¼Ÿ æˆ‘ä»¬æ— æ—¶æ— åˆ»ä¸éœ€è¦è‡ªèº«çš„æˆå°±æ„Ÿæ¥é©±åŠ¨è‡ªæˆ‘ï¼Œä¸‹é¢è¿™å¥è¯æ˜¯æˆ‘ç„¦è™‘çš„æ—¶å€™å‘ç»™æˆ‘çš„æœ‹å‹ä½³å…´å¤§ä½¬å¾—åˆ°çš„å›å¤ï¼Œå¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ© æœ€åï¼Œéƒ½è¯´æ‰§è¡Œå›°éš¾ï¼Œå¦‚æœä½ æ²¡æœ‰è¡Œä¹‹æœ‰æ•ˆçš„æ–¹æ³•ï¼Œè¯·æŒ‰ç…§ä¸Šé¢è¿™äº›æ–¹æ³•è¿›è¡Œé€æ­¥æ”¹å–„ï¼Œè‡ªç„¶ä¼šç»™ä½ å¸¦æ¥å¹¸ç¦æ„Ÿå’Œæˆå°±æ„Ÿï¼Œä¹Ÿå°±è‡ªç„¶ä¼šæ¨åŠ¨ä½ åšä¸‹ä¸€æ­¥æ‰§è¡Œ æˆ‘ä¹Ÿåœ¨æ”¹å˜æ€ç»´å’Œæ–¹å¼çš„è·¯ä¸Šâ€¦ æˆ‘ä»¬ä¸€èµ· æœ€åå¦‚æœä½ é€šè¿‡è¿™ä¸ªæ–¹æ³•æ”¹å˜äº†å¾ˆå¤šï¼Œä¸€å®šè¦è®°å¾—å›æ¥å‘Šè¯‰æˆ‘ï¼Œè¿™ä¼šç»™æˆ‘å¸¦æ¥å¾ˆå¤§æˆå°±æ„Ÿâ€‹","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"å…¶ä»–","slug":"Life/å…¶ä»–","permalink":"https://dayarch.top/categories/Life/%E5%85%B6%E4%BB%96/"}],"tags":[{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://dayarch.top/tags/%E6%80%BB%E7%BB%93/"}]},{"title":"é¢è¯•é—®ï¼Œåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿ","slug":"é¢è¯•é—®ï¼Œåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿ","date":"2020-04-06T13:02:39.000Z","updated":"2020-04-08T08:58:56.737Z","comments":true,"path":"/p/how-many-threads-should-be-created.html","link":"","permalink":"https://dayarch.top/p/how-many-threads-should-be-created.html","excerpt":"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ é˜²æ­¢å¹¶å‘ç¼–ç¨‹å‡ºé”™æœ€å¥½çš„åŠæ³•å°±æ˜¯ä¸å†™å¹¶å‘ç¨‹åº æ—¢ç„¶å¤šçº¿ç¨‹ç¼–ç¨‹å®¹æ˜“å‡ºé”™ï¼Œä¸ºä»€ä¹ˆå®ƒè¿˜ç»ä¹…ä¸è¡°å‘¢ï¼Ÿ Aï¼šé‚£è¿˜ç”¨è¯´ï¼Œè‚¯å®šåœ¨æŸäº›æ–¹é¢æœ‰ç‰¹é•¿å‘—ï¼Œæ¯”å¦‚ä½ çŸ¥é“çš„ã€å®ƒå¾ˆå¿«ï¼Œéå¸¸å¿«ã€‘ æˆ‘ä¹Ÿå¾ˆèµåŒè¿™ä¸ªç­”æ¡ˆï¼Œä½†è¯´çš„ä¸å¤Ÿå…·ä½“ å¹¶å‘ç¼–ç¨‹é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿ å¦‚æœé—®ä½ é€‰æ‹©å¤šçº¿ç¨‹çš„åŸå› å°±æ˜¯ä¸€ä¸ªã€å¿«ã€‘å­—ï¼Œé¢è¯•ä¹Ÿå°±ä¸ä¼šå‡ºé‚£ä¹ˆå¤šå¹ºè›¾å­äº†ã€‚ä½ æœ‰æ²¡æœ‰é—®è¿‡ä½ è‡ªå·± 1. å¹¶å‘ç¼–ç¨‹åœ¨æ‰€æœ‰åœºæ™¯ä¸‹éƒ½æ˜¯å¿«çš„å—ï¼Ÿ 2. çŸ¥é“å®ƒå¾ˆå¿«ï¼Œä½•ä¸ºå¿«ï¼Ÿæ€æ ·åº¦é‡ï¼Ÿ æƒ³çŸ¥é“è¿™ä¸¤ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä»ã€å®šæ€§ã€‘åˆ°ã€å®šé‡ã€‘çš„åˆ†æè¿‡ç¨‹ ä½¿ç”¨å¤šçº¿ç¨‹å°±æ˜¯åœ¨æ­£ç¡®çš„åœºæ™¯ä¸‹é€šè¿‡è®¾ç½®æ­£ç¡®ä¸ªæ•°çš„çº¿ç¨‹æ¥æœ€å¤§åŒ–ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ï¼ˆæˆ‘æ„Ÿè§‰ä½ è¿˜æ˜¯å•¥ä¹Ÿæ²¡","text":"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ é˜²æ­¢å¹¶å‘ç¼–ç¨‹å‡ºé”™æœ€å¥½çš„åŠæ³•å°±æ˜¯ä¸å†™å¹¶å‘ç¨‹åº æ—¢ç„¶å¤šçº¿ç¨‹ç¼–ç¨‹å®¹æ˜“å‡ºé”™ï¼Œä¸ºä»€ä¹ˆå®ƒè¿˜ç»ä¹…ä¸è¡°å‘¢ï¼Ÿ Aï¼šé‚£è¿˜ç”¨è¯´ï¼Œè‚¯å®šåœ¨æŸäº›æ–¹é¢æœ‰ç‰¹é•¿å‘—ï¼Œæ¯”å¦‚ä½ çŸ¥é“çš„ã€å®ƒå¾ˆå¿«ï¼Œéå¸¸å¿«ã€‘ æˆ‘ä¹Ÿå¾ˆèµåŒè¿™ä¸ªç­”æ¡ˆï¼Œä½†è¯´çš„ä¸å¤Ÿå…·ä½“ å¹¶å‘ç¼–ç¨‹é€‚ç”¨äºä»€ä¹ˆåœºæ™¯ï¼Ÿå¦‚æœé—®ä½ é€‰æ‹©å¤šçº¿ç¨‹çš„åŸå› å°±æ˜¯ä¸€ä¸ªã€å¿«ã€‘å­—ï¼Œé¢è¯•ä¹Ÿå°±ä¸ä¼šå‡ºé‚£ä¹ˆå¤šå¹ºè›¾å­äº†ã€‚ä½ æœ‰æ²¡æœ‰é—®è¿‡ä½ è‡ªå·± å¹¶å‘ç¼–ç¨‹åœ¨æ‰€æœ‰åœºæ™¯ä¸‹éƒ½æ˜¯å¿«çš„å—ï¼Ÿ çŸ¥é“å®ƒå¾ˆå¿«ï¼Œä½•ä¸ºå¿«ï¼Ÿæ€æ ·åº¦é‡ï¼Ÿ æƒ³çŸ¥é“è¿™ä¸¤ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä»ã€å®šæ€§ã€‘åˆ°ã€å®šé‡ã€‘çš„åˆ†æè¿‡ç¨‹ ä½¿ç”¨å¤šçº¿ç¨‹å°±æ˜¯åœ¨æ­£ç¡®çš„åœºæ™¯ä¸‹é€šè¿‡è®¾ç½®æ­£ç¡®ä¸ªæ•°çš„çº¿ç¨‹æ¥æœ€å¤§åŒ–ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ï¼ˆæˆ‘æ„Ÿè§‰ä½ è¿˜æ˜¯å•¥ä¹Ÿæ²¡è¯´ï¼‰ å°†è¿™å¥è¯ç¿»è¯‘åˆ°ç¡¬ä»¶çº§åˆ«å°±æ˜¯è¦å……åˆ†çš„åˆ©ç”¨ CPU å’Œ I/O çš„åˆ©ç”¨ç‡ ä¸¤ä¸ªæ­£ç¡®å¾—åˆ°ä¿è¯ï¼Œä¹Ÿå°±èƒ½è¾¾åˆ°æœ€å¤§åŒ–åˆ©ç”¨ CPU å’Œ I/Oçš„ç›®çš„äº†ã€‚æœ€å…³é”®æ˜¯ï¼Œå¦‚ä½•åšåˆ°ä¸¤ä¸ªã€æ­£ç¡®ã€‘ï¼Ÿ åœ¨èŠå…·ä½“åœºæ™¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»è¦æ‹¿å‡ºæˆ‘ä»¬çš„ä¸“ä¸šæ€§æ¥ã€‚é€ä½ ä¸¤ä¸ªåè¯ buff åŠ æˆ CPU å¯†é›†å‹ç¨‹åº I/O å¯†é›†å‹ç¨‹åº CPU å¯†é›†å‹ç¨‹åº ä¸€ä¸ªå®Œæ•´è¯·æ±‚ï¼ŒI/Oæ“ä½œå¯ä»¥åœ¨å¾ˆçŸ­æ—¶é—´å†…å®Œæˆï¼Œ CPUè¿˜æœ‰å¾ˆå¤šè¿ç®—è¦å¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´ CPU è®¡ç®—çš„æ¯”ä¾‹å å¾ˆå¤§ä¸€éƒ¨åˆ† å‡å¦‚æˆ‘ä»¬è¦è®¡ç®— 1+2+â€¦.100äº¿ çš„æ€»å’Œï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™å°±æ˜¯ä¸€ä¸ª CPU å¯†é›†å‹ç¨‹åº åœ¨ã€å•æ ¸ã€‘CPUä¸‹ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»º 4 ä¸ªçº¿ç¨‹æ¥åˆ†æ®µè®¡ç®—ï¼Œå³ï¼š çº¿ç¨‹1è®¡ç®— [1,25äº¿ï¼‰ â€¦â€¦ ä»¥æ­¤ç±»æ¨ çº¿ç¨‹4è®¡ç®— [75äº¿ï¼Œ100äº¿] æˆ‘ä»¬æ¥çœ‹ä¸‹å›¾ä»–ä»¬ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ ç”±äºæ˜¯å•æ ¸ CPUï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨ç­‰å¾… CPU æ—¶é—´ç‰‡ã€‚æŒ‰ç…§ç†æƒ³æƒ…å†µæ¥çœ‹ï¼Œå››ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´æ€»å’Œä¸ä¸€ä¸ªçº¿ç¨‹5ç‹¬è‡ªå®Œæˆæ˜¯ç›¸ç­‰çš„ï¼Œå®é™…ä¸Šæˆ‘ä»¬è¿˜å¿½ç•¥äº†å››ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ æ‰€ä»¥ï¼Œå•æ ¸CPUå¤„ç†CPUå¯†é›†å‹ç¨‹åºï¼Œè¿™ç§æƒ…å†µå¹¶ä¸å¤ªé€‚åˆä½¿ç”¨å¤šçº¿ç¨‹ æ­¤æ—¶å¦‚æœåœ¨ 4 æ ¸CPUä¸‹ï¼ŒåŒæ ·åˆ›å»ºå››ä¸ªçº¿ç¨‹æ¥åˆ†æ®µè®¡ç®—ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ CPU æ¥è¿è¡Œï¼Œå¹¶ä¸ä¼šå‘ç”Ÿç­‰å¾… CPU æ—¶é—´ç‰‡çš„æƒ…å†µï¼Œä¹Ÿæ²¡æœ‰çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ã€‚ç†è®ºæƒ…å†µæ¥çœ‹æ•ˆç‡æå‡äº† 4 å€ æ‰€ä»¥ï¼Œå¦‚æœæ˜¯å¤šæ ¸CPU å¤„ç† CPU å¯†é›†å‹ç¨‹åºï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æœ€å¤§åŒ–çš„åˆ©ç”¨ CPU æ ¸å¿ƒæ•°ï¼Œåº”ç”¨å¹¶å‘ç¼–ç¨‹æ¥æé«˜æ•ˆç‡ I/Oå¯†é›†å‹ç¨‹åº ä¸ CPU å¯†é›†å‹ç¨‹åºç›¸å¯¹ï¼Œä¸€ä¸ªå®Œæ•´è¯·æ±‚ï¼ŒCPUè¿ç®—æ“ä½œå®Œæˆä¹‹åè¿˜æœ‰å¾ˆå¤š I/O æ“ä½œè¦åšï¼Œä¹Ÿå°±æ˜¯è¯´ I/O æ“ä½œå æ¯”å¾ˆå¤§éƒ¨åˆ† æˆ‘ä»¬éƒ½çŸ¥é“åœ¨è¿›è¡Œ I/O æ“ä½œæ—¶ï¼ŒCPUæ˜¯ç©ºé—²çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœ€å¤§åŒ–çš„åˆ©ç”¨ CPUï¼Œä¸èƒ½è®©å…¶æ˜¯ç©ºé—²çŠ¶æ€ åŒæ ·åœ¨å•æ ¸ CPU çš„æƒ…å†µä¸‹ï¼š ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œäº†ç›¸åŒé•¿åº¦çš„ CPU è€—æ—¶å’Œ I/O è€—æ—¶ï¼Œå¦‚æœä½ å°†ä¸Šé¢çš„å›¾å¤šç”»å‡ ä¸ªå‘¨æœŸï¼ŒCPUæ“ä½œè€—æ—¶å›ºå®šï¼Œå°† I/O æ“ä½œè€—æ—¶å˜ä¸º CPU è€—æ—¶çš„ 3 å€ï¼Œä½ ä¼šå‘ç°ï¼ŒCPUåˆæœ‰ç©ºé—²äº†ï¼Œè¿™æ—¶ä½ å°±å¯ä»¥æ–°å»ºçº¿ç¨‹ 4ï¼Œæ¥ç»§ç»­æœ€å¤§åŒ–çš„åˆ©ç”¨ CPUã€‚ ç»¼ä¸Šä¸¤ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥åšå‡ºè¿™æ ·çš„æ€»ç»“ï¼š çº¿ç¨‹ç­‰å¾…æ—¶é—´æ‰€å æ¯”ä¾‹è¶Šé«˜ï¼Œéœ€è¦è¶Šå¤šçº¿ç¨‹ï¼›çº¿ç¨‹CPUæ—¶é—´æ‰€å æ¯”ä¾‹è¶Šé«˜ï¼Œéœ€è¦è¶Šå°‘çº¿ç¨‹ã€‚ åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å·²ç»çŸ¥é“ç¬¬ä¸€ä¸ªã€æ­£ç¡®ã€‘ä½¿ç”¨å¤šçº¿ç¨‹çš„åœºæ™¯äº†ï¼Œé‚£åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿ åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿé¢è¯•å¦‚æœé—®åˆ°è¿™ä¸ªé—®é¢˜ï¼Œè¿™å¯æ˜¯å¯¹ä½ ç†è®ºå’Œå®è·µçš„ç»Ÿè€ƒã€‚æƒ³å®Œå…¨ç­”å¯¹ï¼Œä½ å¿…é¡»è¦ã€ç²¾é€š/ç²¾é€š/ç²¾é€šã€‘å°å­¦ç®—æœ¯ ä»ä¸Šé¢çŸ¥é“ï¼Œæˆ‘ä»¬æœ‰ CPU å¯†é›†å‹å’Œ I/O å¯†é›†å‹ä¸¤ä¸ªåœºæ™¯ï¼Œä¸åŒçš„åœºæ™¯å½“ç„¶éœ€è¦çš„çº¿ç¨‹æ•°ä¹Ÿå°±ä¸ä¸€æ ·äº† CPU å¯†é›†å‹ç¨‹åºåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿæœ‰äº›åŒå­¦æ—©å·²ç»å‘ç°ï¼Œå¯¹äº CPU å¯†é›†å‹æ¥è¯´ï¼Œç†è®ºä¸Š çº¿ç¨‹æ•°é‡ = CPU æ ¸æ•°ï¼ˆé€»è¾‘ï¼‰ å°±å¯ä»¥äº†ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œæ•°é‡ä¸€èˆ¬ä¼šè®¾ç½®ä¸º CPU æ ¸æ•°ï¼ˆé€»è¾‘ï¼‰+ 1ï¼Œ ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹è¿™ä¹ˆè¯´ï¼š è®¡ç®—ï¼ˆCPUï¼‰å¯†é›†å‹çš„çº¿ç¨‹æ°å¥½åœ¨æŸæ—¶å› ä¸ºå‘ç”Ÿä¸€ä¸ªé¡µé”™è¯¯æˆ–è€…å› å…¶ä»–åŸå› è€Œæš‚åœï¼Œåˆšå¥½æœ‰ä¸€ä¸ªâ€œé¢å¤–â€çš„çº¿ç¨‹ï¼Œå¯ä»¥ç¡®ä¿åœ¨è¿™ç§æƒ…å†µä¸‹CPUå‘¨æœŸä¸ä¼šä¸­æ–­å·¥ä½œã€‚ æ‰€ä»¥å¯¹äºCPUå¯†é›†å‹ç¨‹åºï¼Œ CPU æ ¸æ•°ï¼ˆé€»è¾‘ï¼‰+ 1 ä¸ªçº¿ç¨‹æ•°æ˜¯æ¯”è¾ƒå¥½çš„ç»éªŒå€¼çš„åŸå› äº† I/Oå¯†é›†å‹ç¨‹åºåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚ï¼Ÿä¸Šé¢å·²ç»è®©å¤§å®¶æŒ‰ç…§å›¾å¤šç”»å‡ ä¸ªå‘¨æœŸï¼ˆä½ å¯ä»¥åŠ¨æ‰‹å°†I/Oè€—æ—¶ä¸CPUè€—æ—¶æ¯”ä¾‹è°ƒå¤§ï¼Œæ¯”å¦‚6å€æˆ–7å€ï¼‰ï¼Œè¿™æ ·ä½ å°±ä¼šå¾—åˆ°ä¸€ä¸ªç»“è®ºï¼Œå¯¹äº I/O å¯†é›†å‹ç¨‹åºï¼š æœ€ä½³çº¿ç¨‹æ•° = (1/CPUåˆ©ç”¨ç‡) = 1 + (I/Oè€—æ—¶/CPUè€—æ—¶) æˆ‘è¿™ä¹ˆä½“è´´ï¼Œå½“ç„¶æ‹…å¿ƒæœ‰äº›åŒå­¦ä¸ç†è§£è¿™ä¸ªå…¬å¼ï¼Œæˆ‘ä»¬å°†ä¸Šå›¾çš„æ¯”ä¾‹æ‰‹åŠ¨å¸¦å…¥åˆ°ä¸Šé¢çš„å…¬å¼ä¸­ï¼š è¿™æ˜¯ä¸€ä¸ªCPUæ ¸å¿ƒçš„æœ€ä½³çº¿ç¨‹æ•°ï¼Œå¦‚æœå¤šä¸ªæ ¸å¿ƒï¼Œé‚£ä¹ˆ I/O å¯†é›†å‹ç¨‹åºçš„æœ€ä½³çº¿ç¨‹æ•°å°±æ˜¯ï¼š æœ€ä½³çº¿ç¨‹æ•° = CPUæ ¸å¿ƒæ•° * (1/CPUåˆ©ç”¨ç‡) = CPUæ ¸å¿ƒæ•° * ï¼ˆ1 + ï¼ˆI/Oè€—æ—¶/CPUè€—æ—¶)ï¼‰ è¯´åˆ°è¿™ï¼Œæœ‰äº›åŒå­¦å¯èƒ½æœ‰ç–‘é—®äº†ï¼Œè¦è®¡ç®— I/O å¯†é›†å‹ç¨‹åºï¼Œæ˜¯è¦çŸ¥é“ CPU åˆ©ç”¨ç‡çš„ï¼Œå¦‚æœæˆ‘ä¸çŸ¥é“è¿™äº›ï¼Œé‚£è¦æ€æ ·ç»™å‡ºä¸€ä¸ªåˆå§‹å€¼å‘¢ï¼Ÿ æŒ‰ç…§ä¸Šé¢å…¬å¼ï¼Œå‡å¦‚å‡ ä¹å…¨æ˜¯ I/Oè€—æ—¶ï¼Œæ‰€ä»¥çº¯ç†è®ºä½ å°±å¯ä»¥è¯´æ˜¯ 2Nï¼ˆN=CPUæ ¸æ•°ï¼‰ï¼Œå½“ç„¶ä¹Ÿæœ‰è¯´ 2N + 1çš„ï¼Œï¼ˆæˆ‘çŒœè¿™ä¸ª 1 ä¹Ÿæ˜¯ backupï¼‰ï¼Œæ²¡æœ‰æ‰¾åˆ°å…·ä½“çš„æ¨å€’è¿‡ç¨‹ï¼Œåœ¨ã€å¹¶å‘ç¼–ç¨‹å®æˆ˜-8.2ç« èŠ‚ã€‘æˆªå›¾åœ¨æ­¤ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±çœ‹çœ‹ ç†è®ºä¸Šæ¥è¯´ï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œè¿™æ ·å°±èƒ½è¾¾åˆ° CPU 100% çš„åˆ©ç”¨ç‡ å¦‚æœç†è®ºéƒ½å¥½ç”¨ï¼Œé‚£å°±ç”¨ä¸ç€å®è·µäº†ï¼Œä¹Ÿå°±æ›´ä¸ä¼šæœ‰è°ƒä¼˜çš„äº‹å‡ºç°äº†ã€‚ä¸è¿‡åœ¨åˆå§‹é˜¶æ®µï¼Œæˆ‘ä»¬ç¡®å®å¯ä»¥æŒ‰ç…§è¿™ä¸ªç†è®ºä¹‹ä½œä¸ºä¼ªæ ‡å‡†ï¼Œ æ¯•ç«Ÿå·®ä¹Ÿå¯èƒ½ä¸ä¼šå·®å¤ªå¤šï¼Œè¿™æ ·è°ƒä¼˜ä¹Ÿä¼šæ›´å¥½ä¸€äº› è°ˆå®Œç†è®ºï¼Œå’±ä»¬è¯´ç‚¹å®é™…çš„ï¼Œå…¬å¼æˆ‘çœ‹æ‡‚äº†ï¼ˆå®šæ€§é˜¶æ®µç»“æŸï¼‰ï¼Œä½†æ˜¯æˆ‘æœ‰ä¸¤ä¸ªç–‘é—®ï¼š æˆ‘æ€ä¹ˆçŸ¥é“å…·ä½“çš„ I/Oè€—æ—¶å’ŒCPUè€—æ—¶å‘¢ï¼Ÿ æ€ä¹ˆæŸ¥çœ‹CPUåˆ©ç”¨ç‡ï¼Ÿ æ²¡é”™ï¼Œæˆ‘ä»¬éœ€è¦å®šé‡åˆ†æäº† å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªåƒèƒèŸ¹çš„ä»”å„¿ï¼Œå…¶å®æœ‰å¾ˆå¤š APM ï¼ˆApplication Performance Managerï¼‰å·¥å…·å¯ä»¥å¸®æˆ‘ä»¬å¾—åˆ°å‡†ç¡®çš„æ•°æ®ï¼Œå­¦ä¼šä½¿ç”¨è¿™ç±»å·¥å…·ï¼Œä¹Ÿå°±å¯ä»¥ç»“åˆç†è®ºï¼Œåœ¨è°ƒä¼˜çš„è¿‡ç¨‹å¾—åˆ°æ›´ä¼˜çš„çº¿ç¨‹ä¸ªæ•°äº†ã€‚æˆ‘è¿™é‡Œç®€å•åˆ—ä¸¾å‡ ä¸ªï¼Œå…·ä½“ä½¿ç”¨å“ªä¸€ä¸ªï¼Œå…·ä½“åº”ç”¨è¿˜éœ€è¦ä½ è‡ªå·±å»è°ƒç ”é€‰æ‹©ï¼Œå—ç¯‡å¹…é™åˆ¶ï¼Œæš‚ä¸å±•å¼€è®¨è®ºäº† SkyWalking CAT zipkin ä¸Šé¢äº†è§£äº†åŸºæœ¬çš„ç†è®ºçŸ¥è¯†ï¼Œé‚£é¢è¯•æœ‰å¯èƒ½é—®ä»€ä¹ˆï¼Ÿåˆå¯èƒ½ä¼šä»¥æ€æ ·çš„æ–¹å¼æé—®å‘¢ï¼Ÿ é¢è¯•å°é—®å°é—®ä¸€ å‡è®¾è¦æ±‚ä¸€ä¸ªç³»ç»Ÿçš„ TPSï¼ˆTransaction Per Second æˆ–è€… Task Per Secondï¼‰è‡³å°‘ä¸º20ï¼Œç„¶åå‡è®¾æ¯ä¸ªTransactionç”±ä¸€ä¸ªçº¿ç¨‹å®Œæˆï¼Œç»§ç»­å‡è®¾å¹³å‡æ¯ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªTransactionçš„æ—¶é—´ä¸º4s å¦‚ä½•è®¾è®¡çº¿ç¨‹ä¸ªæ•°ï¼Œä½¿å¾—å¯ä»¥åœ¨1så†…å¤„ç†å®Œ20ä¸ªTransactionï¼Ÿ ä½†æ˜¯ï¼Œä½†æ˜¯ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰è€ƒè™‘åˆ°CPUæ•°ç›®ã€‚å®¶é‡Œåˆæ²¡çŸ¿ï¼Œä¸€èˆ¬æœåŠ¡å™¨çš„CPUæ ¸æ•°ä¸º16æˆ–è€…32ï¼Œå¦‚æœæœ‰80ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆè‚¯å®šä¼šå¸¦æ¥å¤ªå¤šä¸å¿…è¦çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼ˆå¸Œæœ›è¿™å¥è¯ä½ å¯ä»¥ä¸»åŠ¨è¯´å‡ºæ¥ï¼‰ï¼Œè¿™å°±éœ€è¦è°ƒä¼˜äº†ï¼Œæ¥åšåˆ°æœ€ä½³ balance å°é—®äºŒ è®¡ç®—æ“ä½œéœ€è¦5msï¼ŒDBæ“ä½œéœ€è¦ 100msï¼Œå¯¹äºä¸€å° 8ä¸ªCPUçš„æœåŠ¡å™¨ï¼Œæ€ä¹ˆè®¾ç½®çº¿ç¨‹æ•°å‘¢ï¼Ÿ å¦‚æœä¸çŸ¥é“è¯·æ‹¿ä¸‰å¹´çº§æœŸæœ«è€ƒè¯•é¢˜é‡æ–°åšï¼ˆä»Šå¤©æ™šè‡ªä¹ ç•™ä¸‹æ¥ï¼‰ï¼Œç­”æ¡ˆæ˜¯ï¼š çº¿ç¨‹æ•° = 8 * (1 + 100/5) = 168 (ä¸ª) é‚£å¦‚æœDBçš„ QPSï¼ˆQuery Per Secondï¼‰ä¸Šé™æ˜¯1000ï¼Œæ­¤æ—¶è¿™ä¸ªçº¿ç¨‹æ•°åˆè¯¥è®¾ç½®ä¸ºå¤šå¤§å‘¢ï¼Ÿ åŒæ ·ï¼Œè¿™æ˜¯æ²¡æœ‰è€ƒè™‘ CPU æ•°ç›®ï¼Œæ¥ä¸‹æ¥å°±åˆæ˜¯ç»†èŠ‚è°ƒä¼˜çš„é˜¶æ®µäº† å› ä¸ºä¸€æ¬¡è¯·æ±‚ä¸ä»…ä»…åŒ…æ‹¬ CPU å’Œ I/Oæ“ä½œï¼Œå…·ä½“çš„è°ƒä¼˜è¿‡ç¨‹è¿˜è¦è€ƒè™‘å†…å­˜èµ„æºï¼Œç½‘ç»œç­‰å…·ä½“å†…å®¹ å¢åŠ  CPU æ ¸æ•°ä¸€å®šèƒ½è§£å†³é—®é¢˜å—ï¼Ÿçœ‹åˆ°è¿™ï¼Œæœ‰äº›åŒå­¦å¯èƒ½ä¼šè®¤ä¸ºï¼Œå³ä¾¿æˆ‘ç®—å‡ºäº†ç†è®ºçº¿ç¨‹æ•°ï¼Œä½†å®é™…CPUæ ¸æ•°ä¸å¤Ÿï¼Œä¼šå¸¦æ¥çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥å°±éœ€è¦å¢åŠ  CPU æ ¸æ•°ï¼Œé‚£æˆ‘ä»¬ç›²ç›®çš„å¢åŠ  CPU æ ¸æ•°å°±ä¸€å®šèƒ½è§£å†³é—®é¢˜å—ï¼Ÿ åœ¨è®²äº’æ–¥é”çš„å†…å®¹æ˜¯ï¼Œæˆ‘æ•…æ„é—ç•™äº†ä¸€ä¸ªçŸ¥è¯†: æ€ä¹ˆç†è§£è¿™ä¸ªå…¬å¼å‘¢ï¼Ÿ è¿™ä¸ªç»“è®ºå‘Šè¯‰æˆ‘ä»¬ï¼Œå‡å¦‚æˆ‘ä»¬çš„ä¸²è¡Œç‡æ˜¯ 5%ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ— è®ºé‡‡ç”¨ä»€ä¹ˆæŠ€æœ¯ï¼Œæœ€é«˜ä¹Ÿå°±åªèƒ½æé«˜ 20 å€çš„æ€§èƒ½ã€‚ å¦‚ä½•ç®€å•ç²—æš´çš„ç†è§£ä¸²è¡Œç™¾åˆ†æ¯”ï¼ˆå…¶å®éƒ½å¯ä»¥é€šè¿‡å·¥å…·å¾—å‡ºè¿™ä¸ªç»“æœçš„ï¼‰å‘¢ï¼Ÿæ¥çœ‹ä¸ªå° Tipsï¼š Tips: ä¸´ç•ŒåŒºéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œéä¸´ç•ŒåŒºéƒ½æ˜¯å¹¶è¡Œçš„ï¼Œç”¨å•çº¿ç¨‹æ‰§è¡Œä¸´ç•ŒåŒºçš„æ—¶é—´/ç”¨å•çº¿ç¨‹æ‰§è¡Œ(ä¸´ç•ŒåŒº+éä¸´ç•ŒåŒº)çš„æ—¶é—´å°±æ˜¯ä¸²è¡Œç™¾åˆ†æ¯” ç°åœ¨ä½ åº”è¯¥ç†è§£æˆ‘åœ¨è®²è§£ synchronized å…³é”®å­—æ—¶æ‰€è¯´çš„ï¼š æœ€å°åŒ–ä¸´ç•ŒåŒºèŒƒå›´ï¼Œå› ä¸ºä¸´ç•ŒåŒºçš„å¤§å°å¾€å¾€å°±æ˜¯ç“¶é¢ˆé—®é¢˜çš„æ‰€åœ¨ï¼Œä¸è¦åƒä¹±ç”¨try catché‚£æ ·ä¸€é”…ç«¯ æ€»ç»“å¤šçº¿ç¨‹ä¸ä¸€å®šå°±æ¯”å•çº¿ç¨‹é«˜æ•ˆï¼Œæ¯”å¦‚å¤§åé¼é¼çš„ Redis ï¼ˆåé¢ä¼šåˆ†æï¼‰ï¼Œå› ä¸ºå®ƒæ˜¯åŸºäºå†…å­˜æ“ä½œï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå•çº¿ç¨‹å¯ä»¥å¾ˆé«˜æ•ˆçš„åˆ©ç”¨CPUã€‚è€Œå¤šçº¿ç¨‹çš„ä½¿ç”¨åœºæ™¯ä¸€èˆ¬æ—¶å­˜åœ¨ç›¸å½“æ¯”ä¾‹çš„I/Oæˆ–ç½‘ç»œæ“ä½œ å¦å¤–ï¼Œç»“åˆå°å­¦æ•°å­¦é¢˜ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•ä»å®šæ€§åˆ°å®šé‡çš„åˆ†æçš„è¿‡ç¨‹ï¼Œåœ¨å¼€å§‹æ²¡æœ‰ä»»ä½•æ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šæ–‡æåˆ°çš„ç»éªŒå€¼ä½œä¸ºä¸€ä¸ªä¼ªæ ‡å‡†ï¼Œå…¶æ¬¡å°±æ˜¯ç»“åˆå®é™…æ¥é€æ­¥çš„è°ƒä¼˜ï¼ˆç»¼åˆ CPUï¼Œå†…å­˜ï¼Œç¡¬ç›˜è¯»å†™é€Ÿåº¦ï¼Œç½‘ç»œçŠ¶å†µç­‰ï¼‰äº† æœ€åï¼Œç›²ç›®çš„å¢åŠ  CPU æ ¸æ•°ä¹Ÿä¸ä¸€å®šèƒ½è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬ä¸¥æ ¼çš„ç¼–å†™å¹¶å‘ç¨‹åºä»£ç äº† çµé­‚è¿½é—® æˆ‘ä»¬å·²ç»çŸ¥é“åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹åˆé€‚äº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦æä¸€ä¸ªçº¿ç¨‹æ± å‡ºæ¥ï¼Ÿ åˆ›å»ºä¸€ä¸ªçº¿ç¨‹éƒ½è¦åšå“ªäº›äº‹æƒ…ï¼Ÿä¸ºä»€ä¹ˆè¯´é¢‘ç¹çš„åˆ›å»ºçº¿ç¨‹å¼€é”€å¾ˆå¤§ï¼Ÿ å¤šçº¿ç¨‹é€šå¸¸è¦æ³¨æ„å…±äº«å˜é‡é—®é¢˜ï¼Œä¸ºä»€ä¹ˆå±€éƒ¨å˜é‡å°±æ²¡æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜å‘¢ï¼Ÿ â€¦â€¦ å‚è€ƒæ„Ÿè°¢å‰è¾ˆä»¬æ€»ç»“çš„ç²¾åï¼Œè‡ªå·±æ‰€å†™çš„å¹¶å‘ç³»åˆ—å¥½å¤šéƒ½å‚è€ƒäº†ä»¥ä¸‹èµ„æ–™ Java å¹¶å‘ç¼–ç¨‹å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹ä¹‹ç¾ ç å‡ºé«˜æ•ˆ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ ifeve ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±æ¥è¯´è¯´ï¼Œä½ ç†Ÿæ‚‰åˆé™Œç”Ÿçš„çº¿ç¨‹æ± é—®é¢˜","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"Javaçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸè¿™æ ·ç†è§£æŒºç®€å•çš„","slug":"Javaçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸè¿™æ ·ç†è§£æŒºç®€å•çš„","date":"2020-03-25T06:32:03.000Z","updated":"2020-03-25T07:19:39.290Z","comments":true,"path":"/p/java-thread-life-cycle.html","link":"","permalink":"https://dayarch.top/p/java-thread-life-cycle.html","excerpt":"ä¸ºä»€ä¹ˆè¦äº†è§£çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ ä¹‹å‰å†™è¿‡ Spring Bean ç”Ÿå‘½å‘¨æœŸä¸‰éƒ¨æ›²ï¼š 1. Spring Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· 2. Spring Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜å°½ 3. Spring Aware åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ æœ‰æœ‹å‹ç•™è¨€è¯´ï¼šâ€œäº†è§£äº†å®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸåï¼Œä½¿ç”¨ Spring Bean å¥½æ¯”çœ‹åˆ°å®ƒä»¬çš„è¡ŒåŠ¨è½¨è¿¹ï¼Œç°åœ¨ä½¿ç”¨å°±ä¸€ç‚¹éƒ½ä¸æ…Œäº†â€ã€‚æˆ‘å’Œä»–ä¸€æ ·ï¼Œäº†è§£äº‹ç‰©çš„ç”Ÿå‘½å‘¨æœŸç›®çš„å¾ˆç®€å•ï¼Œå”¯ã€ä¸æ…Œã€‘ä¹Ÿ Java å¹¶å‘ç³»åˆ— å·²ç»å†™äº†å¾ˆå¤šï¼Œä»æ¥è¿˜æ²¡æèµ·è¿‡é‚£ä¸ªå®ƒã€Javaçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸã€‘ã€‚æœ‰äº†å‰åºç†è®ºå›¾æ–‡çš„é“ºå«ï¼Œåœ¨èµ°è¿›æºç ä¸–ç•Œä¹‹å‰ï¼Œè°ˆè®ºå®ƒçš„æ—¶æœºæ°å¥½åˆ°äº†ã€‚å› ä¸ºï¼Œç¼–å†™å¹¶å‘ç¨‹åºçš„æ ¸å¿ƒä¹‹ä¸€å°±æ˜¯æ­£ç¡®çš„æ‘†å¼„çº¿ç¨‹","text":"ä¸ºä»€ä¹ˆè¦äº†è§£çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿä¹‹å‰å†™è¿‡ Spring Bean ç”Ÿå‘½å‘¨æœŸä¸‰éƒ¨æ›²ï¼š Spring Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· Spring Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜å°½ Spring Aware åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ æœ‰æœ‹å‹ç•™è¨€è¯´ï¼šâ€œäº†è§£äº†å®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸåï¼Œä½¿ç”¨ Spring Bean å¥½æ¯”çœ‹åˆ°å®ƒä»¬çš„è¡ŒåŠ¨è½¨è¿¹ï¼Œç°åœ¨ä½¿ç”¨å°±ä¸€ç‚¹éƒ½ä¸æ…Œäº†â€ã€‚æˆ‘å’Œä»–ä¸€æ ·ï¼Œäº†è§£äº‹ç‰©çš„ç”Ÿå‘½å‘¨æœŸç›®çš„å¾ˆç®€å•ï¼Œå”¯ã€ä¸æ…Œã€‘ä¹Ÿ Java å¹¶å‘ç³»åˆ— å·²ç»å†™äº†å¾ˆå¤šï¼Œä»æ¥è¿˜æ²¡æèµ·è¿‡é‚£ä¸ªå®ƒã€Javaçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸã€‘ã€‚æœ‰äº†å‰åºç†è®ºå›¾æ–‡çš„é“ºå«ï¼Œåœ¨èµ°è¿›æºç ä¸–ç•Œä¹‹å‰ï¼Œè°ˆè®ºå®ƒçš„æ—¶æœºæ°å¥½åˆ°äº†ã€‚å› ä¸ºï¼Œç¼–å†™å¹¶å‘ç¨‹åºçš„æ ¸å¿ƒä¹‹ä¸€å°±æ˜¯æ­£ç¡®çš„æ‘†å¼„çº¿ç¨‹çŠ¶æ€ çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„å‡ ç§çŠ¶æ€åˆšæ¥è§¦çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œæˆ‘æ€»æ˜¯è®°ä¸ä½ï¼Œä¹Ÿç†è§£ä¸äº†ä»–ä»¬çš„çŠ¶æ€ï¼Œå¯ä»¥è¯´æ˜¯æ¯”è¾ƒæ··ä¹±ï¼Œæ›´åˆ«è¯´å®ƒä»¬ä¹‹é—´æ˜¯å¦‚ä½•è¿›è¡ŒçŠ¶æ€è½¬æ¢çš„äº†ã€‚åŸå› æ˜¯æˆ‘æŠŠæ“ä½œç³»ç»Ÿé€šç”¨çº¿ç¨‹çŠ¶æ€å’Œç¼–ç¨‹è¯­è¨€å°è£…åçš„çº¿ç¨‹çŠ¶æ€ æ¦‚å¿µæ··æ·†åœ¨ä¸€èµ·äº† æ“ä½œç³»ç»Ÿé€šç”¨çº¿ç¨‹çŠ¶æ€ä¸ªäººè§‰å¾—é€šç”¨çº¿ç¨‹çŠ¶æ€æ›´ç¬¦åˆæˆ‘ä»¬çš„æ€è€ƒä¹ æƒ¯ã€‚å…¶çŠ¶æ€æ€»å…±æœ‰ 5 ç§ ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚å¯¹äºç»å¸¸å†™å¹¶å‘ç¨‹åºçš„åŒå­¦æ¥è¯´ï¼Œå…¶å˜´é‡Œç»å¸¸å¿µçš„éƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„è¿™äº›é€šç”¨çº¿ç¨‹çŠ¶æ€ï¼Œä¸”çœ‹ é™¤å»ç”Ÿã€åˆå§‹çŠ¶æ€ã€‘æ­»ã€ç»ˆæ­¢çŠ¶æ€ã€‘ï¼Œå…¶å®åªæ˜¯ä¸‰ç§çŠ¶æ€çš„å„ç§è½¬æ¢ï¼Œå¬åˆ°è¿™å¥è¯æ˜¯ä¸æ˜¯å¿ƒæƒ…æ”¾æ¾äº†å¾ˆå¤šå‘¢ï¼Ÿ ä¸ºäº†æ›´å¥½çš„è¯´æ˜é€šç”¨çº¿ç¨‹çŠ¶æ€å’Œ Java è¯­è¨€ä¸­çš„çº¿ç¨‹çŠ¶æ€ï¼Œè¿™é‡Œè¿˜æ˜¯å…ˆå¯¹å‰è€…è¿›è¡Œç®€çŸ­çš„è¯´æ˜ åˆå§‹çŠ¶æ€ çº¿ç¨‹å·²è¢«åˆ›å»ºï¼Œä½†æ˜¯è¿˜ä¸è¢«å…è®¸åˆ†é…CPUæ‰§è¡Œã€‚æ³¨æ„ï¼Œè¿™ä¸ªè¢«åˆ›å»ºå…¶å®æ˜¯å±äºç¼–ç¨‹è¯­è¨€å±‚é¢çš„ï¼Œå®é™…åœ¨æ“ä½œç³»ç»Ÿé‡Œï¼ŒçœŸæ­£çš„çº¿ç¨‹è¿˜æ²¡è¢«åˆ›å»ºï¼Œ æ¯”å¦‚ Java è¯­è¨€ä¸­çš„ new Thread()ã€‚ å¯è¿è¡ŒçŠ¶æ€ çº¿ç¨‹å¯ä»¥åˆ†é…CPUæ‰§è¡Œï¼Œè¿™æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸­çº¿ç¨‹å·²ç»è¢«åˆ›å»ºæˆåŠŸäº† è¿è¡ŒçŠ¶æ€ æ“ä½œç³»ç»Ÿä¼šä¸ºå¤„åœ¨å¯è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹åˆ†é…CPUæ—¶é—´ç‰‡ï¼Œè¢« CPU ä¸´å¹¸åï¼Œå¤„åœ¨å¯è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹å°±ä¼šå˜ä¸ºè¿è¡ŒçŠ¶æ€ ä¼‘çœ çŠ¶æ€ å¦‚æœå¤„åœ¨è¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹è°ƒç”¨æŸä¸ªé˜»å¡çš„APIæˆ–ç­‰å¾…æŸä¸ªäº‹ä»¶æ¡ä»¶å¯ç”¨ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±ä¼šè½¬æ¢åˆ°ä¼‘çœ çŠ¶æ€ï¼Œæ³¨æ„ï¼šæ­¤æ—¶çº¿ç¨‹ä¼šé‡Šæ”¾CPUä½¿ç”¨æƒï¼Œä¼‘çœ çš„çº¿ç¨‹æ°¸è¿œæ²¡æœ‰æœºä¼šè·å¾—CPUä½¿ç”¨æƒï¼Œåªæœ‰å½“ç­‰å¾…äº‹ä»¶å‡ºç°åï¼Œçº¿ç¨‹ä¼šä»ä¼‘çœ çŠ¶æ€è½¬æ¢åˆ°å¯è¿è¡ŒçŠ¶æ€ ç»ˆæ­¢çŠ¶æ€ çº¿ç¨‹æ‰§è¡Œå®Œæˆ–è€…å‡ºç°å¼‚å¸¸ (è¢«interrupté‚£ç§ä¸ç®—çš„å“ˆï¼Œåç»­ä¼šè¯´)å°±ä¼šè¿›å…¥ç»ˆæ­¢çŠ¶æ€ï¼Œæ­£å¼èµ°åˆ°ç”Ÿå‘½çš„å°½å¤´ï¼Œæ²¡æœ‰èµ·æ­»å›ç”Ÿçš„æœºä¼š æ¥ä¸‹æ¥å°±æ¥çœ‹çœ‹ä½ ç†Ÿæ‚‰åˆé™Œç”Ÿï¼Œé¢è¯•åˆç»å¸¸è¢«é—®åˆ°çš„Java çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸå§ Javaè¯­è¨€çº¿ç¨‹çŠ¶æ€åœ¨ Thread çš„æºç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªæšä¸¾ç±» Stateï¼Œé‡Œé¢æ¸…æ™°æ˜äº†çš„å†™äº†Javaè¯­è¨€ä¸­çº¿ç¨‹çš„6ç§çŠ¶æ€ï¼š NEW RUNNABLE BLOCKED WAITING TIMED_WAITING TERMINATED è¿™é‡Œè¦åšä¸€ä¸ªå°è°ƒæŸ¥äº†ï¼Œä½ æœ‰æŸ¥çœ‹è¿‡è¿™ä¸ªç±»å’Œè¯»è¿‡å…¶æ³¨é‡Šè¯´æ˜å—ï¼Ÿï¼ˆæ¬¢è¿ç•™è¨€è„šå°å“¦ï¼‰ è€³è¾¹å“èµ·äº”ç¯ä¹‹æ­Œï¼ŒJavaä¸­çº¿ç¨‹çŠ¶æ€ç«Ÿç„¶æ¯”é€šç”¨çº¿ç¨‹çŠ¶æ€çš„ 5 ç§å¤š1ç§ï¼Œå˜æˆäº† 6 ç§ã€‚è¿™ä¸ªçœ‹ä¼¼å¤æ‚ï¼Œå…¶å®å¹¶ä¸æ˜¯ä½ æƒ³çš„é‚£æ ·ï¼ŒJavaåœ¨é€šç”¨çº¿ç¨‹çŠ¶æ€çš„åŸºç¡€ä¸Šï¼Œæœ‰è£å‰ªï¼Œä¹Ÿæœ‰ä¸°å¯Œï¼Œæ•´ä½“æ¥è¯´æ˜¯å°‘ä¸€ç§ã€‚å†æ¥çœ‹ä¸ªå›¾ï¼Œæ³¨æ„é¢œè‰²åŒºåˆ†å“¦ Java è¯­è¨€ä¸­ å°†é€šç”¨çº¿ç¨‹çŠ¶æ€çš„å¯è¿è¡ŒçŠ¶æ€å’Œè¿è¡ŒçŠ¶æ€åˆå¹¶ä¸º Runnableï¼Œ å°†ä¼‘çœ çŠ¶æ€ç»†åˆ†ä¸ºä¸‰ç§ (BLOCKED/WAITING/TIMED_WAITING); åè¿‡æ¥ç†è§£è¿™å¥è¯ï¼Œå°±æ˜¯è¿™ä¸‰ç§çŠ¶æ€åœ¨æ“ä½œç³»ç»Ÿçš„çœ¼ä¸­éƒ½æ˜¯ä¼‘çœ çŠ¶æ€ï¼ŒåŒæ ·ä¸ä¼šè·å¾—CPUä½¿ç”¨æƒ çœ‹ä¸Šå›¾å³ä¾§ã€Javaè¯­è¨€ä¸­çš„çº¿ç¨‹çŠ¶æ€ã€‘ï¼Œè¿›ä¸€æ­¥ç®€æ´çš„è¯´ï¼Œé™¤å»çº¿ç¨‹ç”Ÿæ­»ï¼Œæˆ‘ä»¬åªè¦ç©è½¬ RUNNABLE å’Œä¼‘çœ çŠ¶æ€çš„è½¬æ¢å°±å¯ä»¥äº†ï¼Œç¼–å†™å¹¶å‘ç¨‹åºä¹Ÿå¤šæ•°æ˜¯è¿™ä¸¤ç§çŠ¶æ€çš„è½¬æ¢ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦äº†è§£ï¼Œæœ‰å“ªäº›æ—¶æœºï¼Œä¼šè§¦å‘è¿™äº›çŠ¶æ€è½¬æ¢ è¿œçœ‹çœ‹è½®å»“ï¼Œ è¿‘çœ‹çœ‹ç»†èŠ‚ã€‚æˆ‘ä»¬å°†ä¸Šé¢Javaè¯­è¨€ä¸­çš„å›¾è¿›è¡Œç»†åŒ–ï¼Œå°†è§¦å‘çš„èŠ‚ç‚¹æ”¾åˆ°å›¾ä¸­ (è¿™çœ‹ä¼¼å¤æ‚çš„å›¾ï¼Œå…¶å®ä¸‰å¥è¯å°±èƒ½åˆ†è§£çš„ï¼Œæ‰€ä»¥åˆ«æ…Œ)ï¼Œä¸”çœ‹ï¼š RUNNABLEä¸BLOCKEDçŠ¶æ€è½¬æ¢å½“ä¸”ä»…æœ‰ï¼ˆjust onlyï¼‰ä¸€ç§æƒ…å†µä¼šä» RUNNABLE çŠ¶æ€è¿›å…¥åˆ° BLOCKED çŠ¶æ€ï¼Œå°±æ˜¯çº¿ç¨‹åœ¨ç­‰å¾… synchronized å†…ç½®éšå¼é”ï¼›å¦‚æœç­‰å¾…çš„çº¿ç¨‹è·å–åˆ°äº† synchronized å†…ç½®éšå¼é”ï¼Œä¹Ÿå°±ä¼šä» BLOCKED çŠ¶æ€å˜ä¸º RUNNABLE çŠ¶æ€äº† æ³¨æ„ï¼š ä¸Šé¢æåˆ°ï¼Œä»¥æ“ä½œç³»ç»Ÿé€šç”¨çŠ¶æ€æ¥çœ‹ï¼Œçº¿ç¨‹è°ƒç”¨é˜»å¡å¼ APIï¼Œä¼šå˜ä¸ºä¼‘çœ çŠ¶æ€ï¼ˆé‡Šæ”¾CPUä½¿ç”¨æƒï¼‰ï¼Œä½†åœ¨JVMå±‚é¢ï¼ŒJavaçº¿ç¨‹çŠ¶æ€ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´Javaçº¿ç¨‹çš„çŠ¶æ€ä¾æ—§ä¼šä¿æŒåœ¨ RUNNABLE çŠ¶æ€ã€‚JVMå¹¶ä¸å…³å¿ƒæ“ä½œç³»ç»Ÿè°ƒåº¦çš„çŠ¶æ€ã€‚åœ¨JVMçœ‹æ¥ï¼Œç­‰å¾…CPUä½¿ç”¨æƒï¼ˆæ“ä½œç³»ç»Ÿé‡Œæ˜¯å¤„åœ¨å¯æ‰§è¡ŒçŠ¶æ€ï¼‰ä¸ç­‰å¾…I/Oï¼ˆæ“ä½œç³»ç»Ÿæ˜¯å¤„åœ¨ä¼‘çœ çŠ¶æ€ï¼‰ï¼Œéƒ½æ˜¯ç­‰å¾…æŸä¸ªèµ„æºï¼Œæ‰€ä»¥éƒ½å½’å…¥äº†RUNNABLE çŠ¶æ€ â€‹ â€”â€” æ‘˜è‡ªã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ RUNNABLEä¸WAITINGçŠ¶æ€è½¬æ¢è°ƒç”¨ä¸å¸¦æ—¶é—´å‚æ•°çš„ç­‰å¾…APIï¼Œå°±ä¼šä»RUNNABLEçŠ¶æ€è¿›å…¥åˆ°WAITINGçŠ¶æ€ï¼›å½“è¢«å”¤é†’å°±ä¼šä»WAITINGè¿›å…¥RUNNABLEçŠ¶æ€ RUNNABLEä¸ TIMED-WAITING çŠ¶æ€è½¬æ¢è°ƒç”¨å¸¦æ—¶é—´å‚æ•°çš„ç­‰å¾…APIï¼Œè‡ªç„¶å°±ä» RUNNABLE çŠ¶æ€è¿›å…¥ TIMED-WAITING çŠ¶æ€ï¼›å½“è¢«å”¤é†’æˆ–è¶…æ—¶æ—¶é—´åˆ°å°±ä¼šä»TIMED_WAITINGè¿›å…¥RUNNABLEçŠ¶æ€ çœ‹å›¾ä¸­çš„è½¬æ¢ API æŒºå¤šçš„ï¼Œå…¶å®ä¸ç”¨æ‹…å¿ƒï¼Œåç»­åˆ†ææºç ç« èŠ‚ï¼Œè‡ªç„¶å°±ä¼šè®°ä½çš„ï¼Œç°åœ¨æœ‰ä¸ªå°è±¡ä»¥åŠçŸ¥é“çŠ¶æ€è½¬æ¢çš„èŠ‚ç‚¹å°±å¥½äº† ç›¸ä¿¡åˆ°è¿™é‡Œï¼Œä½ çœ‹Javaçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„çœ¼ç¥å°±æ²¡é‚£ä¹ˆè¿·æƒ‘äº†ï¼Œé‡ç‚¹å°±æ˜¯RUNNABLEä¸ä¼‘çœ çŠ¶æ€çš„åˆ‡æ¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€çœ‹ï¼Œå¦‚ä½•æŸ¥çœ‹çº¿ç¨‹ä¸­çš„çŠ¶æ€ï¼Œä»¥åŠå…·ä½“çš„ä»£ç è§¦å‘ç‚¹ å¦‚ä½•æŸ¥çœ‹çº¿ç¨‹å¤„åœ¨ä»€ä¹ˆçŠ¶æ€ç¨‹åºä¸­è°ƒç”¨ getState() æ–¹æ³•Thread ç±»ä¸­åŒæ ·å­˜åœ¨ getState() æ–¹æ³•ç”¨äºæŸ¥çœ‹å½“å‰çº¿ç¨‹çŠ¶æ€ï¼Œè¯¥æ–¹æ³•å°±æ˜¯è¿”å›ä¸Šé¢æåˆ°çš„æšä¸¾ç±» State NEWå°±æ˜¯ä¸Šé¢æåˆ°ï¼Œ ç¼–ç¨‹è¯­è¨€ä¸­ç‰¹æœ‰çš„ï¼Œé€šè¿‡ç»§æ‰¿ Thread æˆ–å®ç° Runnable æ¥å£å®šä¹‰çº¿ç¨‹åï¼Œè¿™æ—¶çš„çŠ¶æ€éƒ½æ˜¯ NEW 12Thread thread = new Thread(() -&gt; &#123;&#125;);System.out.println(thread.getState()); RUNNABLEè°ƒç”¨äº† start() æ–¹æ³•ä¹‹åï¼Œçº¿ç¨‹å°±å¤„åœ¨ RUNNABLE çŠ¶æ€äº† 1234Thread thread = new Thread(() -&gt; &#123;&#125;);thread.start();//Thread.sleep(1000);System.out.println(thread.getState()); BLOCKEDç­‰å¾… synchronized å†…ç½®é”ï¼Œå°±ä¼šå¤„åœ¨ BLOCKED çŠ¶æ€ 12345678910111213141516171819202122232425262728public class ThreadStateTest &#123; public static void main(String[] args) throws InterruptedException &#123; Thread t1 = new Thread(new DemoThreadB()); Thread t2 = new Thread(new DemoThreadB()); t1.start(); t2.start(); Thread.sleep(1000); System.out.println((t2.getState())); System.exit(0); &#125;&#125;class DemoThreadB implements Runnable &#123; @Override public void run() &#123; commonResource(); &#125; public static synchronized void commonResource() &#123; while(true) &#123; &#125; &#125;&#125; WAITINGè°ƒç”¨çº¿ç¨‹çš„ join() ç­‰æ–¹æ³•ï¼Œä» RUNNABLE å˜ä¸º WAITING çŠ¶æ€ 123456789101112131415public static void main(String[] args) throws InterruptedException &#123; Thread main = Thread.currentThread(); Thread thread2 = new Thread(() -&gt; &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; Thread.currentThread().interrupt(); e.printStackTrace(); &#125; System.out.println(main.getState()); &#125;); thread2.start(); thread2.join(); &#125; TIMED-WAITINGè°ƒç”¨äº† sleep(long) ç­‰æ–¹æ³•ï¼Œçº¿ç¨‹ä» RUNNABLE å˜ä¸º TIMED-WAITING çŠ¶æ€ 123456789101112131415public static void main(String[] args) throws InterruptedException &#123; Thread thread3 = new Thread(() -&gt; &#123; try &#123; Thread.sleep(3000); &#125; catch (InterruptedException e) &#123; // ä¸ºä»€ä¹ˆè¦è°ƒç”¨interruptæ–¹æ³•ï¼Ÿ Thread.currentThread().interrupt(); e.printStackTrace(); &#125; &#125;); thread3.start(); Thread.sleep(1000); System.out.println(thread3.getState()); &#125; TERMINATEDçº¿ç¨‹æ‰§è¡Œå®Œè‡ªç„¶å°±åˆ°äº† TERMINATED çŠ¶æ€äº† 1234Thread thread = new Thread(() -&gt; &#123;&#125;);thread.start();Thread.sleep(1000);System.out.println(thread.getState()); ä»¥ä¸Šæ˜¯ç¨‹åºä¸­æŸ¥çœ‹çº¿ç¨‹ï¼Œè‡ªå·±å†™å†™æµ‹è¯•çœ‹çœ‹çŠ¶æ€è¿˜å¥½ï¼Œç°å®ä¸­çš„ç¨‹åºæ€ä¹ˆå¯èƒ½å…è®¸ä½ åŠ è¿™ä¹ˆå¤šæ— ç”¨ä»£ç ï¼Œæ‰€ä»¥ï¼Œç¿ èŠ±ï¼Œä¸Šé…¸èœï¼ˆjstackï¼‰ jstack å‘½ä»¤æŸ¥çœ‹ç›¸ä¿¡ä½ å¬è¯´è¿‡è¿™ç©æ„ï¼Œjstack å‘½ä»¤å°±æ¯”è¾ƒå¼ºå¤§äº†ï¼Œä¸ä»…èƒ½æŸ¥çœ‹çº¿ç¨‹å½“å‰çŠ¶æ€ï¼Œè¿˜èƒ½çœ‹è°ƒç”¨æ ˆï¼Œé”ç­‰çº¿ç¨‹æ ˆä¿¡æ¯ å¤§å®¶å¯ä»¥éšæ„å†™ä¸€äº›ç¨‹åºï¼Œè¿™é‡Œæˆ‘ç”¨äº†ä¸Šé¢ WAITING çŠ¶æ€çš„ä»£ç , ä¿®æ”¹ç¡çœ æ—¶é—´ Thread.sleep(100000)ï¼Œç„¶ååœ¨ç»ˆç«¯æŒ‰ç…§ä¸‹å›¾æ ‡ç¤ºä¾æ¬¡æ‰§è¡Œä¸‹å›¾å‘½ä»¤ æ›´å¤šåŠŸèƒ½è¿˜è¯·å¤§å®¶è‡ªè¡ŒæŸ¥çœ‹ï¼Œåç»­ä¼šå•ç‹¬å†™æ–‡ç« æ¥æ•™å¤§å®¶å¦‚ä½•ä½¿ç”¨jstackæŸ¥çœ‹çº¿ç¨‹æ ˆä¿¡æ¯ Arthasè¿™ä¸ªåˆ©å™¨ï¼Œæ— é¡»å¤šè¨€å§ï¼Œçº¿ä¸Šæ‰¾èŒ¬ç›‘æ§æ²¡æ¯›ç—…ï¼Œå¸Œæœ›ä½ å¯ä»¥çµæ´»ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œæ”»å…‹ç–‘éš¾æ‚ç—‡ æŸ¥çœ‹çº¿ç¨‹æ ˆè¯¦ç»†ä¿¡æ¯ï¼Œéå¸¸æ–¹ä¾¿ï¼šhttps://alibaba.github.io/arthas/thread.html ç›¸ä¿¡ä½ å·²ç»å’ŒArthasç¡®è®¤äº†çœ¼ç¥ å…³äºçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æ•´ä½“å°±ç®—è¯´å®Œäº†ï¼Œç¼–å†™å¹¶å‘ç¨‹åºæ—¶å¤šé—®ä¸€é—®è‡ªå·±ï¼š è°ƒç”¨æŸä¸ªAPIä¼šå°†ä½ çš„çº¿ç¨‹ç½®ä¸ºç”šä¹ˆçŠ¶æ€ï¼Ÿ å¤šé—®è‡ªå·±å‡ æ¬¡ï¼Œè‡ªç„¶å°±è®°ä½ä¸Šé¢çš„å›¾äº† çµé­‚è¿½é—® ä¸ºä»€ä¹ˆè°ƒç”¨ Thread.sleep, catchå¼‚å¸¸åï¼Œè°ƒç”¨äº†Thread.currentThread().interrupt(); è¿›å…¥ BLOCKEDåªæœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ç­‰å¾… synchronized ç›‘è§†å™¨é”ï¼Œé‚£è°ƒç”¨ JUC ä¸­çš„ Lock.lock() æ–¹æ³•ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹ç­‰å¾…è¿™ä¸ªé”ï¼Œè¿™ä¸ªçº¿ç¨‹çŠ¶æ€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ 1234567891011121314151617181920212223242526272829303132333435363738394041public class ThreadStateTest &#123;public static void main(String[] args) throws InterruptedException &#123; TestLock testLock = new TestLock(); Thread thread2 = new Thread(() -&gt; &#123; testLock.myTestLock(); &#125;, \"thread2\"); Thread thread1 = new Thread(() -&gt; &#123; testLock.myTestLock(); &#125;, \"thread1\"); thread1.start(); Thread.sleep(1000); thread2.start(); Thread.sleep(1000); System.out.println(\"****\" + (thread2.getState())); Thread.sleep(20000); &#125; &#125;@Slf4jclass TestLock&#123; private final Lock lock = new ReentrantLock(); public void myTestLock()&#123; lock.lock(); try&#123; Thread.sleep(10000); log.info(\"testLock status\"); &#125; catch (InterruptedException e) &#123; log.error(e.getMessage()); &#125; finally &#123; lock.unlock(); &#125; &#125;&#125; synchronized å’Œ Lock æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ æˆ‘è¿™é¢ä¹Ÿåœ¨é€æ­¥æ€»ç»“å¸¸è§çš„å¹¶å‘é¢è¯•é—®é¢˜ï¼ˆæ€»ç»“ingâ€¦â€¦ï¼‰ç­”æ¡ˆæ•´ç†å¥½åä¼šé€šçŸ¥å¤§å®¶ï¼Œè¯·æŒç»­å…³æ³¨ åŒæ—¶ï¼Œè¿™é‡Œä¹Ÿæ•´ç†äº†ä¸€ç‚¹ Java ç¡¬æ ¸èµ„æ–™ï¼Œæœ‰éœ€è¦çš„å°±å…¬ä¼—å·å›å¤ã€èµ„æ–™ã€‘/ã€666ã€‘å§","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"å¹¶å‘ç¼–ç¨‹ä¹‹ç­‰å¾…é€šçŸ¥æœºåˆ¶","slug":"å¹¶å‘ç¼–ç¨‹ä¹‹ç­‰å¾…é€šçŸ¥æœºåˆ¶","date":"2020-03-15T07:47:24.000Z","updated":"2020-03-15T08:07:45.452Z","comments":true,"path":"/p/waiting-notification-mechanism.html","link":"","permalink":"https://dayarch.top/p/waiting-notification-mechanism.html","excerpt":"å¹¶å‘ç¼–ç¨‹ä¸ºä»€ä¹ˆä¼šæœ‰ç­‰å¾…é€šçŸ¥æœºåˆ¶ ä¸Šä¸€ç¯‡æ–‡ç« è¯´æ˜äº† Javaå¹¶å‘æ­»é”è§£å†³æ€è·¯ ï¼Œ è§£å†³æ­»é”çš„æ€è·¯ä¹‹ä¸€å°±æ˜¯ ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶, æ‰€æœ‰æŸœå‘˜éƒ½è¦é€šè¿‡å”¯ä¸€çš„è´¦æœ¬ç®¡ç†å‘˜ä¸€æ¬¡æ€§æ‹¿åˆ°æ‰€æœ‰è½¬è´¦ä¸šåŠ¡éœ€è¦çš„è´¦æœ¬ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š æ²¡æœ‰ç­‰å¾…/é€šçŸ¥æœºåˆ¶ä¹‹å‰ï¼Œæ‰€æœ‰æŸœå‘˜éƒ½é€šè¿‡æ­»å¾ªç¯çš„æ–¹å¼ä¸æ–­å‘è´¦æœ¬ç®¡ç†å‘˜ç”³è¯·æ‰€æœ‰è´¦æœ¬ï¼Œç¨‹åºçš„ä½“ç°å°±æ˜¯è¿™æ ·ï¼š 1 2 while(!accountBookManager.getAllRequiredAccountBook(this, target)) ï¼› å‡å¦‚è´¦æœ¬ç®¡ç†å‘˜æ˜¯å¹´è½»å°ä¼™ï¼Œè…¿è„šåˆ©è½ï¼ˆå³æ‰§è¡Œ getAllRequiredAccountBookæ–¹æ³•è€—æ—¶çŸ­ï¼‰ï¼Œå¹¶ä¸”å¤šä¸ªæŸœå‘˜è½¬è´¦","text":"å¹¶å‘ç¼–ç¨‹ä¸ºä»€ä¹ˆä¼šæœ‰ç­‰å¾…é€šçŸ¥æœºåˆ¶ä¸Šä¸€ç¯‡æ–‡ç« è¯´æ˜äº† Javaå¹¶å‘æ­»é”è§£å†³æ€è·¯ ï¼Œ è§£å†³æ­»é”çš„æ€è·¯ä¹‹ä¸€å°±æ˜¯ ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶, æ‰€æœ‰æŸœå‘˜éƒ½è¦é€šè¿‡å”¯ä¸€çš„è´¦æœ¬ç®¡ç†å‘˜ä¸€æ¬¡æ€§æ‹¿åˆ°æ‰€æœ‰è½¬è´¦ä¸šåŠ¡éœ€è¦çš„è´¦æœ¬ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š æ²¡æœ‰ç­‰å¾…/é€šçŸ¥æœºåˆ¶ä¹‹å‰ï¼Œæ‰€æœ‰æŸœå‘˜éƒ½é€šè¿‡æ­»å¾ªç¯çš„æ–¹å¼ä¸æ–­å‘è´¦æœ¬ç®¡ç†å‘˜ç”³è¯·æ‰€æœ‰è´¦æœ¬ï¼Œç¨‹åºçš„ä½“ç°å°±æ˜¯è¿™æ ·ï¼š 12while(!accountBookManager.getAllRequiredAccountBook(this, target)) ï¼› å‡å¦‚è´¦æœ¬ç®¡ç†å‘˜æ˜¯å¹´è½»å°ä¼™ï¼Œè…¿è„šåˆ©è½ï¼ˆå³æ‰§è¡Œ getAllRequiredAccountBookæ–¹æ³•è€—æ—¶çŸ­ï¼‰ï¼Œå¹¶ä¸”å¤šä¸ªæŸœå‘˜è½¬è´¦çš„ä¸šåŠ¡å†²çªé‡ä¸å¤§ï¼Œè¿™ä¸ªæ–¹æ¡ˆç®€å•ç²—æš´ä¸”æœ‰æ•ˆï¼ŒæŸœå‘˜åªéœ€è¦å°è¯•å‡ æ¬¡å°±å¯ä»¥æˆåŠŸï¼ˆå³é€šè¿‡å°‘é‡çš„å¾ªç¯å¯ä»¥å®ç°ï¼‰ è¿‡äº†å¥½å¤šå¹´ï¼Œå¹´è½»çš„è´¦æœ¬ç®¡ç†å‘˜å˜æˆäº†å¹´è¿ˆçš„è€äººï¼Œè¡ŒåŠ¨è¿Ÿç¼“ï¼ˆå³æ‰§è¡Œ getAllRequiredAccountBook è€—æ—¶é•¿ï¼‰ï¼ŒåŒæ—¶ï¼Œå¤šä¸ªæŸœå‘˜è½¬è´¦çš„ä¸šåŠ¡å†²çªé‡ä¹Ÿå˜å¤§ï¼Œä¹‹å‰å‡ åæ¬¡å¾ªç¯èƒ½åšåˆ°çš„ï¼Œç°åœ¨å¯èƒ½å°±è¦ç”³è¯·æˆåƒä¸Šç™¾ï¼Œç”šè‡³ä¸Šä¸‡æ¬¡æ‰èƒ½å®Œæˆä¸€æ¬¡è½¬è´¦ äººå·¥æ— é™ç”³è¯·æµªè´¹å£èˆŒï¼Œ ç¨‹åºæ— é™ç”³è¯·æµªè´¹CPUã€‚èªæ˜çš„äººå°±æƒ³åˆ°äº† ç­‰å¾…/é€šçŸ¥ æœºåˆ¶ ç­‰å¾…/é€šçŸ¥æœºåˆ¶æ— é™å¾ªç¯å®åœ¨å¤ªæµªè´¹CPUï¼Œè€Œç†æƒ³æƒ…å†µåº”è¯¥æ˜¯è¿™æ ·ï¼š æŸœå‘˜Aå¦‚æœæ‹¿ä¸åˆ°æ‰€æœ‰è´¦æœ¬ï¼Œå°±å‚²å¨‡çš„ä¸å†ç»§ç»­é—®äº†ï¼ˆçº¿ç¨‹é˜»å¡è‡ªå·± waitï¼‰ æŸœå‘˜Bå½’è¿˜äº†æŸœå‘˜Aéœ€è¦çš„è´¦æœ¬ä¹‹åå°±ä¸»åŠ¨é€šçŸ¥æŸœå‘˜Aè´¦æœ¬å¯ç”¨ï¼ˆé€šçŸ¥ç­‰å¾…çš„çº¿ç¨‹ notify/notifyAllï¼‰ åšåˆ°è¿™æ ·ï¼Œå°±èƒ½é¿å…å¾ªç¯ç­‰å¾…æ¶ˆè€—CPUçš„é—®é¢˜äº† ç°å®ä¸­æœ‰å¤ªå¤šåœºæ™¯éƒ½åœ¨åº”ç”¨ç­‰å¾…/é€šçŸ¥æœºåˆ¶ã€‚æ¬¢è¿è§‚ä¸´çº¢æµªæ¼«ï¼Œæ¯”å¦‚å»XXåŠè¯ï¼Œå»åŒ»é™¢å°±åŒ»/ä½“æ£€ã€‚ ä¸‹é¢è¯·è‡ªè¡Œè„‘è¡¥ä¸€ä¸‹å»åŒ»é™¢å°±åŒ»æˆ–ä½“æ£€çš„ç”»é¢, æ•´ä½“æµç¨‹ç±»ä¼¼è¿™æ ·ï¼š åºå· å°±åŒ» ç¨‹åºè§£é‡Šï¼ˆè‡ªå·±çš„è§†è§’ï¼‰ 1 æŒ‚å·æˆåŠŸï¼Œåˆ°è¯Šå®¤é—¨å£æ’å·å€™è¯Š æ’å·çš„æ‚£è€…ï¼ˆçº¿ç¨‹ï¼‰å°è¯•è·å–ã€äº’æ–¥é”ã€‘ 2 å¤§å¤«å«åˆ°è‡ªå·±ï¼Œè¿›å…¥è¯Šå®¤å°±è¯Š è‡ªå·±ã€è·å–åˆ°äº’æ–¥é”ã€‘ 3 å¤§å¤«ç®€å•è¯¢é—®ï¼Œè¦æ±‚åšæ£€æŸ¥ï¼ˆæ‚£è€…ç¼ºä¹æŠ¥å‘Šä¸èƒ½è¯Šæ–­ç—…å› ï¼‰ è¿›è¡Œã€æ¡ä»¶åˆ¤æ–­ã€‘ï¼Œçº¿ç¨‹è¦æ±‚çš„æ¡ä»¶ã€æ²¡æ»¡è¶³ã€‘ 4 è‡ªå·±å‡ºå»åšæ£€æŸ¥ çº¿ç¨‹ã€ä¸»åŠ¨é‡Šæ”¾ã€‘æŒæœ‰çš„äº’æ–¥é” 5 å¤§å¤«å«ä¸‹ä¸€ä½æ‚£è€… å¦ä¸€ä½æ‚£è€…ï¼ˆçº¿ç¨‹ï¼‰è·å–åˆ°äº’æ–¥é” 6 è‡ªå·±æ‹¿åˆ°æ£€æµ‹æŠ¥å‘Š çº¿ç¨‹ã€æ›¾ç»ã€‘è¦æ±‚çš„æ¡ä»¶å¾—åˆ°æ»¡è¶³ï¼ˆå®åˆ™ã€è¢«é€šçŸ¥ã€‘ï¼‰ 7 å†æ¬¡åœ¨è¯Šå®¤é—¨å£æ’å·å€™è¯Š å†æ¬¡å°è¯•è·å–äº’æ–¥é” 8 â€¦ â€¦ åœ¨ã€ç¨‹åºè§£é‡Šã€‘ä¸€åˆ—ï¼Œæˆ‘å°†å…³é”®å­—ï¼ˆæ’é˜Ÿã€é”ã€ç­‰å¾…ã€é‡Šæ”¾â€¦.ï¼‰å·²ç»ç”¨ ã€ã€‘ æ¡†äº†èµ·æ¥ã€‚Java è¯­è¨€ä¸­ï¼Œå…¶å†…ç½®çš„å…³é”®å­— synchronized å’Œ æ–¹æ³•wait()ï¼Œnotify()/notifyAll() å°±èƒ½å®ç°ä¸Šé¢æåˆ°çš„ç­‰å¾…/é€šçŸ¥æœºåˆ¶ï¼Œæˆ‘ä»¬å°†è¿™å‡ ä¸ªå…³é”®å­—å®ç°æµç¨‹ç°å½¢è±¡åŒ–çš„è¡¨ç¤ºä¸€ä¸‹ï¼š è¿™å¯ä¸æ˜¯ä¸€ä¸ªç®€å•çš„å›¾ï¼Œä¸‹é¢è¿˜è¦å›´ç»•è¿™ä¸ªå›¾åšå¾ˆå¤šæ–‡ç« ï¼Œä¸è¿‡è¿™é‡Œæˆ‘å¿…é¡»è¦æ’æ’­å‡ ä¸ªé¢è¯•åŸºç¡€çŸ¥è¯†ç‚¹äº†ï¼š ä¸€ä¸ªé”å¯¹åº”ä¸€ä¸ªã€å…¥å£ç­‰å¾…é˜Ÿåˆ—ã€‘ï¼Œä¸åŒé”çš„å…¥å£ç­‰å¾…é˜Ÿåˆ—æ²¡ä»»ä½•å…³ç³»ï¼Œè¯´ç™½äº†ä»–ä»¬å°±ä¸å­˜åœ¨ç«äº‰å…³ç³»ã€‚ä½ æƒ³å‘€ï¼Œä¸åŒæ‚£è€…è¿›å…¥çœ¼ç§‘å’Œè€³é¼»å–‰ç§‘çœ‹å¤§å¤«ä¸€ç‚¹å†²çªéƒ½æ²¡æœ‰ wait(), notify()/notifyAll() è¦åœ¨ synchronized å†…éƒ¨è¢«ä½¿ç”¨ï¼Œå¹¶ä¸”ï¼Œå¦‚æœé”çš„å¯¹è±¡æ˜¯thisï¼Œå°±è¦ this.wait()ï¼Œthis.notify()/this.notifyAll() , å¦åˆ™JVMå°±ä¼šæŠ›å‡º java.lang.IllegalMonitorStateException çš„ã€‚ä½ æƒ³å‘€ï¼Œç­‰å¾…/é€šçŸ¥æœºåˆ¶å°±æ˜¯ä»ã€ç«äº‰ã€‘ç¯å¢ƒé€æ¸è¡ç”Ÿå‡ºæ¥çš„ç­–ç•¥ï¼Œä¸åœ¨é”ç«äº‰å†…éƒ¨ä½¿ç”¨æˆ–ç­‰å¾…/é€šçŸ¥é”™äº†å¯¹è±¡ï¼Œ è‡ªç„¶æ˜¯ä¸ç¬¦åˆå¸¸ç†çš„ æœ‰äº†ä¸Šé¢çŸ¥è¯†çš„é“ºå«ï¼Œè¦æƒ³å°†æ— é™å¾ªç¯ç­–ç•¥æ”¹ä¸ºç­‰å¾…é€šçŸ¥ç­–ç•¥ï¼Œä½ è¿˜éœ€è¦é—®è‡ªå·±å››ä¸ªé—®é¢˜ï¼š çµé­‚ 4 é—® æˆ‘ä»¬æ‹¿é’±åº„è´¦æœ¬ç®¡ç†å‘˜çš„ä¾‹å­ä¾ä¾åšä»¥ä¸Šå›ç­”ï¼š æˆ‘ä»¬ä¼˜åŒ–é’±åº„è½¬è´¦çš„ç¨‹åºï¼š 12345678910111213141516171819202122232425public class AccountBookManager &#123; List&lt;Object&gt; accounts = new ArrayList&lt;&gt;(2); synchronized boolean getAllRequiredAccountBook( Object from, Object to)&#123; if(accounts.contains(from) || accounts.contains(to))&#123; try&#123; this.wait(); &#125;catch(Exception e)&#123; &#125; &#125; else&#123; accounts.add(from); accounts.add(to); return true; &#125; &#125; // å½’è¿˜èµ„æº synchronized void releaseObtainedAccountBook(Object from, Object to)&#123; accounts.remove(from); accounts.remove(to); notify(); &#125;&#125; å°±è¿™æ ·ã€çœ‹ã€‘ ã€ä¼¼ã€‘ ã€å®Œã€‘ ã€ç¾ã€‘çš„è§£å†³äº†ï¼Œå…¶å®ä¸Šé¢çš„ç¨‹åºæœ‰ä¸¤ä¸ªå¤§å‘ï¼š å‘ä¸€åœ¨ä¸Šé¢ this.wait() å¤„ï¼Œä½¿ç”¨äº† if æ¡ä»¶åˆ¤æ–­ï¼Œä¼šå‡ºç°å¤©å¤§çš„éº»çƒ¦ï¼Œæ¥çœ‹ä¸‹å›¾ï¼ˆä»ä¸‹å¾€ä¸Šçœ‹ï¼‰ï¼š notify å”¤é†’çš„é‚£ä¸€åˆ»ï¼Œçº¿ç¨‹ã€æ›¾ç»/æ›¾ç»/æ›¾ç»ã€‘è¦æ±‚çš„æ¡ä»¶å¾—åˆ°äº†æ»¡è¶³ï¼Œä»è¿™ä¸€åˆ»å¼€å§‹ï¼Œåˆ°å»æ¡ä»¶ç­‰é˜Ÿåˆ—ä¸­å”¤é†’çº¿ç¨‹ï¼Œå†åˆ°å†æ¬¡å°è¯•è·å–é”æ˜¯æœ‰æ—¶é—´å·®çš„ï¼Œå½“å†æ¬¡è·å–åˆ°é”æ—¶ï¼Œçº¿ç¨‹æ›¾ç»è¦æ±‚çš„æ¡ä»¶æ˜¯ä¸ä¸€å®šæ»¡è¶³ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œæ‰€ä»¥éœ€è¦å°† if åˆ¤æ–­æ”¹æˆ while åˆ¤æ–­ 1234567891011121314synchronized boolean getAllRequiredAccountBook( Object from, Object to)&#123; while(accounts.contains(from) || accounts.contains(to))&#123; try&#123; this.wait(); &#125;catch(Exception e)&#123; &#125; &#125; else&#123; accounts.add(from); accounts.add(to); return true; &#125;&#125; ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ä»æŒ‚èµ·çŠ¶æ€å˜ä¸ºå¯è¿è¡ŒçŠ¶æ€ï¼ˆä¹Ÿå°±æ˜¯è¢«å”¤é†’ï¼‰ï¼Œå³ä½¿çº¿ç¨‹æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹è°ƒç”¨notify()/notifyAll() æ–¹æ³•è¿›è¡Œé€šçŸ¥ï¼Œæˆ–è¢«ä¸­æ–­ï¼Œæˆ–è€…ç­‰å¾…è¶…æ—¶ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ã€è™šå‡å”¤é†’ã€‘ã€‚è™½ç„¶è™šå‡å”¤é†’å¾ˆå°‘å‘ç”Ÿï¼Œä½†è¦é˜²æ‚£äºæœªç„¶ï¼Œåšæ³•å°±æ˜¯ä¸åœçš„å»æµ‹è¯•è¯¥çº¿ç¨‹è¢«å”¤é†’æ¡ä»¶æ˜¯å¦æ»¡è¶³ â€”â€”æ‘˜è‡ªã€ŠJavaå¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€‹ æœ‰åŒå­¦å¯èƒ½è¿˜ä¼šäº§ç”Ÿç–‘é—®ï¼Œä¸ºä»€ä¹ˆwhileå°±å¯ä»¥ï¼Ÿ å› ä¸ºè¢«å”¤é†’çš„çº¿ç¨‹å†æ¬¡è·å–åˆ°é”ä¹‹åæ˜¯ä»åŸæ¥çš„ wait ä¹‹åå¼€å§‹æ‰§è¡Œçš„ï¼Œwaitåœ¨å¾ªç¯é‡Œé¢ï¼Œæ‰€ä»¥ä¼šå†æ¬¡è¿›å…¥å¾ªç¯æ¡ä»¶é‡æ–°è¿›è¡Œæ¡ä»¶åˆ¤æ–­ã€‚ å¦‚æœä¸ç†è§£è¿™ä¸ªé“ç†å°±è®°ä½ä¸€å¥è¯ï¼š ä»å“ªé‡Œè·Œå€’å°±ä»å“ªé‡Œçˆ¬èµ·æ¥ï¼›åœ¨å“ªé‡Œwaitï¼Œå°±ä»waité‚£é‡Œç»§ç»­å‘åæ‰§è¡Œ æ‰€ä»¥ï¼Œè¿™ä¹Ÿå°±æˆäº†ä½¿ç”¨wait()çš„æ ‡å‡†èŒƒå¼ è‡³äºå‘äºŒï¼Œæ˜¯çº¿ç¨‹å½’è¿˜æ‰€ä½¿ç”¨çš„è´¦æˆ·ä¹‹åä½¿ç”¨ notify è€Œä¸æ˜¯ notifyAll è¿›è¡Œé€šçŸ¥ï¼Œç”±äºå‘å¾ˆå¤§ï¼Œéœ€è¦ä¸€äº›çŸ¥è¯†é“ºå«æ¥è¯´æ˜ ä¸ºä»€ä¹ˆè¯´å°½é‡ä½¿ç”¨ notifyAll()notify() å’Œ notifyAll() åˆ°åº•å•¥åŒºåˆ«ï¼Ÿ notify() å‡½æ•° éšæœºå”¤é†’ä¸€ä¸ªï¼šä¸€ä¸ªçº¿ç¨‹è°ƒç”¨å…±äº«å¯¹è±¡çš„ notify() æ–¹æ³•ï¼Œä¼šå”¤é†’ä¸€ä¸ªåœ¨è¯¥å…±äº«å˜é‡ä¸Šè°ƒç”¨ wait() æ–¹æ³•åè¢«æŒ‚èµ·çš„çº¿ç¨‹ï¼Œä¸€ä¸ªå…±äº«å˜é‡ä¸Šå¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ï¼Œå…·ä½“å”¤é†’é‚£ä¸€ä¸ªï¼Œæ˜¯éšæœºçš„ notifyAll() å‡½æ•° å”¤é†’æ‰€æœ‰ï¼š ä¸notify() ä¸åŒï¼ŒnotifyAll() ä¼šå”¤é†’åœ¨è¯¥å…±äº«å˜é‡ä¸Šç”±äºè°ƒç”¨wait() æ–¹æ³•è€Œè¢«æŒ‚èµ·çš„æ‰€æœ‰çº¿ç¨‹ çœ‹ä¸ªéå¸¸ç®€å•çš„ç¨‹åºä¾‹å­å§ ç¤ºä¾‹ç¨‹åºä¸€ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455@Slf4jpublic class NotifyTest &#123; private static volatile Object resourceA = new Object(); public static void main(String[] args) throws InterruptedException &#123; Thread threadA = new Thread(() -&gt; &#123; synchronized (resourceA)&#123; log.info(\"threadA get resourceA lock\"); try&#123; log.info(\"threadA begins to wait\"); resourceA.wait(); log.info(\"threadA ends wait\"); &#125;catch (InterruptedException e)&#123; log.error(e.getMessage()); &#125; &#125; &#125;); Thread threadB = new Thread(() -&gt; &#123; synchronized (resourceA)&#123; log.info(\"threadB get resourceA lock\"); try&#123; log.info(\"threadB begins to wait\"); resourceA.wait(); log.info(\"threadB ends wait\"); &#125;catch (InterruptedException e)&#123; log.error(e.getMessage()); &#125; &#125; &#125;); Thread threadC = new Thread(() -&gt; &#123; synchronized (resourceA)&#123; log.info(\"threadC begin to notify\"); resourceA.notify(); &#125; &#125;); threadA.start(); threadB.start(); Thread.sleep(1000); threadC.start(); threadA.join(); threadB.join(); threadC.join(); log.info(\"main thread over now\"); &#125;&#125; æ¥çœ‹è¿è¡Œç»“æœ ç¨‹åºä¸­æˆ‘ä»¬ä½¿ç”¨notify()éšæœºé€šçŸ¥resourceAçš„ç­‰å¾…é˜Ÿåˆ—çš„ä¸€ä¸ªçº¿ç¨‹ï¼ŒthreadAè¢«å”¤é†’ï¼ŒthreadBå´æ²¡æœ‰æ‰“å°å‡º threadB ends wait è¿™å¥è¯ï¼Œé—æ†¾çš„æ­»æ‰äº† å°† notify() æ¢æˆ notifyAll() çš„ç»“æœæƒ³å¿…ä½ å·²ç»çŸ¥é“äº† ä½¿ç”¨ notifyAll() ç¡®å®ä¸ä¼šé—è½ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ï¼Œä½†ä¹Ÿäº§ç”Ÿäº†æ¯”è¾ƒå¼ºçƒˆçš„ç«äº‰ï¼Œå¦‚æœnotify() è®¾è®¡çš„æœ¬èº«å°±æ˜¯ bugï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°åº”è¯¥æ—©å°±ä» JDK ä¸­ç§»é™¤äº†ï¼Œå®ƒéšæœºé€šçŸ¥ä¸€ä¸ªçº¿ç¨‹çš„å½¢å¼å¿…å®šæ˜¯æœ‰ç”¨æ­¦ä¹‹åœ°çš„ ä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨ notify() notify() çš„å…¸å‹çš„åº”ç”¨å°±æ˜¯çº¿ç¨‹æ± ï¼ˆæŒ‰ç…§ä¸Šé¢çš„ä¸‰ä¸ªæ¡ä»¶ä½ è‡ªé—®è‡ªç­”éªŒè¯ä¸€ä¸‹æ˜¯è¿™æ ·å—ï¼Ÿï¼‰ è¿™é‡Œæˆ‘ä»¬æ‹¿ä¸€ä¸ª JUC ä¸‹çš„ç±»æ¥çœ‹çœ‹ notify() çš„ç”¨å¤„ Tips: notify() ç­‰åŒäº signal() wait() ç­‰åŒäº await() åœ¨IDEä¸­ï¼Œæ‰“å¼€ ArrayBlockingQueue.java æ‰€æœ‰çš„å…¥é˜Ÿ public æ–¹æ³•offer()/put() å†…éƒ¨éƒ½è°ƒç”¨äº† private çš„ enqueue() æ–¹æ³• æ‰€æœ‰çš„å‡ºé˜Ÿ public æ–¹æ³•poll()/take() å†…éƒ¨éƒ½è°ƒç”¨äº† private çš„ dequeue() æ–¹æ³• å°†è¿™ä¸ªæ¨¡å‹è¿›è¡Œç²¾ç®€å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839public class SimpleBlockingQueue&lt;T&gt; &#123; final Lock lock = new ReentrantLock(); // æ¡ä»¶å˜é‡ï¼šé˜Ÿåˆ—ä¸æ»¡ final Condition notFull = lock.newCondition(); // æ¡ä»¶å˜é‡ï¼šé˜Ÿåˆ—ä¸ç©º final Condition notEmpty = lock.newCondition(); // å…¥é˜Ÿ void enq(T x) &#123; lock.lock(); try &#123; while (é˜Ÿåˆ—å·²æ»¡)&#123; // ç­‰å¾…é˜Ÿåˆ—ä¸æ»¡ notFull.await(); &#125; // çœç•¥å…¥é˜Ÿæ“ä½œ... //å…¥é˜Ÿå,é€šçŸ¥å¯å‡ºé˜Ÿ notEmpty.signal(); &#125;finally &#123; lock.unlock(); &#125; &#125; // å‡ºé˜Ÿ void deq()&#123; lock.lock(); try &#123; while (é˜Ÿåˆ—å·²ç©º)&#123; // ç­‰å¾…é˜Ÿåˆ—ä¸ç©º notEmpty.await(); &#125; // çœç•¥å‡ºé˜Ÿæ“ä½œ... //å‡ºé˜Ÿåï¼Œé€šçŸ¥å¯å…¥é˜Ÿ notFull.signal(); &#125;finally &#123; lock.unlock(); &#125; &#125;&#125; å¦‚æœæ»¡è¶³ä¸Šé¢è¿™ä¸‰ä¸ªæ¡ä»¶ï¼Œnotify() çš„ä½¿ç”¨å°±æ°åˆ°å¥½å¤„ï¼›æˆ‘ä»¬ç”¨ä½¿ç”¨ notify()çš„æ¡ä»¶è¿›è¡ŒéªŒè¯ æœ‰çš„åŒå­¦çœ‹åˆ°è¿™é‡Œå¯èƒ½ä¼šç¨ç¨æœ‰ä¸€äº›ç–‘æƒ‘ï¼Œawait()/signal() å’Œ wait()/notify() ç»„åˆçš„ç©æ³•çœ‹ç€ä¸å¤ªä¸€æ ·å‘¢ï¼Œä½ ç–‘æƒ‘çš„æ²¡æœ‰é”™ å› ä¸º Java å†…ç½®çš„ç›‘è§†å™¨é”æ¨¡å‹æ˜¯ MESA æ¨¡å‹çš„ç²¾ç®€ç‰ˆ MESAæ¨¡å‹MESA ç›‘è§†å™¨æ¨¡å‹ä¸­è¯´ï¼Œæ¯ä¸€ä¸ªæ¡ä»¶å˜é‡éƒ½å¯¹åº”ä¸€ä¸ªæ¡ä»¶ç­‰å¾…é˜Ÿåˆ— å¯¹åº”åˆ°ä¸Šé¢ç¨‹åºï¼š é˜Ÿåˆ—å·²æ»¡æ˜¯å‰ææ¡ä»¶ï¼Œæ¡ä»¶å˜é‡Aå°±æ˜¯notFullï¼Œä¹Ÿå°±æ˜¯notFull.await; notFull.signal é˜Ÿåˆ—å·²ç©ºæ˜¯å‰ææ¡ä»¶ï¼Œæ¡ä»¶å˜é‡Bå°±æ˜¯notEmptyï¼Œä¹Ÿå°±æ˜¯notEmpty.await; notEmpty.signal/sign å³ä¾¿notFull.signalAll, ä¹Ÿå’Œawaitåœ¨notEmpty æ¡ä»¶å˜é‡é˜Ÿåˆ—çš„çº¿ç¨‹æ²¡åŠæ¯›é’±å…³ç³» è€ŒJavaå†…ç½®ç›‘è§†å™¨æ¨¡å‹å°±åªä¼šæœ‰ä¸€ä¸ªã€éšå½¢çš„ã€‘æ¡ä»¶å˜é‡ å¦‚æœæ˜¯synchronizedä¿®é¥°çš„æ™®é€šæ–¹æ³•ï¼Œæ¡ä»¶å˜é‡å°±æ˜¯ this å¦‚æœæ˜¯synchronizedä¿®é¥°çš„é™æ€æ–¹æ³•ï¼Œæ¡ä»¶å˜é‡å°±æ˜¯ç±» å¦‚æœæ˜¯synchronizedå—ï¼Œæ¡ä»¶å˜é‡å°±æ˜¯å—ä¸­çš„å†…å®¹äº† è¯´å®Œäº†è¿™äº›ï¼Œä½ æœ‰æ²¡æœ‰æç„¶å¤§æ‚Ÿçš„æ„Ÿè§‰å‘¢ æ€»ç»“å¦‚æœä¸šåŠ¡å†²çªä¸å¤§ï¼Œå¾ªç¯ç­‰å¾…æ˜¯ä¸€ç§ç®€å•ç²—æš´ä¸”æœ‰æ•ˆçš„æ–¹å¼ï¼›ä½†æ˜¯å½“ä¸šåŠ¡å†²çªå¤§ä¹‹åï¼Œé€šçŸ¥/ç­‰å¾…æœºåˆ¶æ˜¯å¿…ä¸å¯å°‘çš„ä½¿ç”¨ç­–ç•¥ é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡ä½ å·²ç»å¯ä»¥é€šè¿‡çµé­‚4é—®ï¼ŒçŸ¥é“å¦‚ä½•å°†å¾ªç¯ç­‰å¾…æ”¹å–„æˆé€šçŸ¥/ç­‰å¾…æ¨¡å‹äº†ï¼›å¦å¤–ä¹ŸçŸ¥é“å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨é€šçŸ¥/ç­‰å¾…æœºåˆ¶äº† çµé­‚è¿½é—® é’±åº„è½¬è´¦çš„ä¸šåŠ¡ï¼Œæ¡ä»¶éƒ½æ˜¯åˆ¤æ–­è´¦æˆ·æ˜¯å¦è¢«æ”¯é…ï¼Œéƒ½æ˜¯æ‰§è¡Œç›¸åŒçš„è½¬è´¦ä¸šåŠ¡ï¼Œä¸ºä»€ä¹ˆå°±ä¸å¯ä»¥ç”¨notify() è€Œåªèƒ½ç”¨notifyAll() å‘¢ ResourceAçš„ä¾‹å­ï¼Œä¸ºä»€ä¹ˆä½¿ç”¨notifyé€šçŸ¥ï¼Œç¨‹åºæ²¡æœ‰æ‰“å°å‡º main thread over nowï¼Œ è€Œä½¿ç”¨notifyAll() å´æ‰“å°å‡ºæ¥äº†å‘¢ï¼Ÿ å‚è€ƒæ„Ÿè°¢å‰è¾ˆä»¬æ€»ç»“çš„ç²¾åï¼Œè‡ªå·±æ‰€å†™çš„å¹¶å‘ç³»åˆ—å¥½å¤šéƒ½å‚è€ƒäº†ä»¥ä¸‹èµ„æ–™ Java å¹¶å‘ç¼–ç¨‹å®æˆ˜ Java å¹¶å‘ç¼–ç¨‹ä¹‹ç¾ ç å‡ºé«˜æ•ˆ Java å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ https://www.geeksforgeeks.org/difference-notify-notifyall-java/ â€¦ ä¸‹é¢çš„æ–‡ç« ï¼Œå°±éœ€è¦èŠèŠã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‘äº†ï¼Œåªæœ‰ç†ŸçŸ¥çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œä½ æ‰èƒ½æ›´å¥½çš„ç¼–å†™å¹¶å‘ç¨‹åºã€‚ æˆ‘è¿™é¢ä¹Ÿåœ¨é€æ­¥æ€»ç»“å¸¸è§çš„å¹¶å‘é¢è¯•é—®é¢˜ï¼ˆæ€»ç»“ingâ€¦â€¦ï¼‰ç­”æ¡ˆæ•´ç†å¥½åä¼šé€šçŸ¥å¤§å®¶ï¼Œè¯·æŒç»­å…³æ³¨ åŒæ—¶ï¼Œè¿™é‡Œä¹Ÿæ•´ç†äº†ä¸€ç‚¹ Java ç¡¬æ ¸èµ„æ–™ï¼Œæœ‰éœ€è¦çš„å°±å…¬ä¼—å·å›å¤ã€èµ„æ–™ã€‘/ã€666ã€‘å§","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"volatileå’Œsynchronizedå›¾æ–‡é€å½»è®²è§£","slug":"volatileå’Œsynchronizedå…³é”®å­—å›¾æ–‡è®²è§£ä¸åŒ","date":"2020-03-04T03:37:38.000Z","updated":"2020-03-04T03:51:00.887Z","comments":true,"path":"/p/difference-between-volatile-and-synchronized-keyword.html","link":"","permalink":"https://dayarch.top/p/difference-between-volatile-and-synchronized-keyword.html","excerpt":"* ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ * If you can NOT explain it simply, you do NOT understand it well enough ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ ä¹‹å‰å†™äº†å‡ ç¯‡ Javaå¹¶å‘ç¼–ç¨‹çš„ç³»åˆ— æ–‡ç« ï¼Œæœ‰ä¸ªæœ‹å‹å¾®ç¾¤é‡Œé—®æˆ‘ï¼Œè¿˜æ˜¯ä¸èƒ½ç†è§£ volatile å’Œ synchronized äºŒè€…çš„åŒºåˆ«, ä»–çš„é—®é¢˜ä¸»è¦å¯ä»¥å½’çº³ä¸ºè¿™å‡ ä¸ªï¼š * volatile ä¸ synchron","text":"ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ If you can NOT explain it simply, you do NOT understand it well enough ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ ä¹‹å‰å†™äº†å‡ ç¯‡ Javaå¹¶å‘ç¼–ç¨‹çš„ç³»åˆ— æ–‡ç« ï¼Œæœ‰ä¸ªæœ‹å‹å¾®ç¾¤é‡Œé—®æˆ‘ï¼Œè¿˜æ˜¯ä¸èƒ½ç†è§£ volatile å’Œ synchronized äºŒè€…çš„åŒºåˆ«, ä»–çš„é—®é¢˜ä¸»è¦å¯ä»¥å½’çº³ä¸ºè¿™å‡ ä¸ªï¼š volatile ä¸ synchronized åœ¨å¤„ç†å“ªäº›é—®é¢˜æ˜¯ç›¸å¯¹ç­‰ä»·çš„ï¼Ÿ ä¸ºä»€ä¹ˆè¯´ volatile æ˜¯ synchronized å¼±åŒæ­¥çš„æ–¹å¼ï¼Ÿ volatile é™¤äº†å¯è§æ€§é—®é¢˜ï¼Œè¿˜èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ äºŒè€…æˆ‘è¦å¦‚ä½•é€‰æ‹©ä½¿ç”¨ï¼Ÿ å¦‚æœä½ ä¸èƒ½å›ç­”ä¸Šé¢çš„å‡ ä¸ªé—®é¢˜ï¼Œè¯´æ˜ä½ å¯¹äºŒè€…çš„åŒºåˆ«è¿˜æœ‰ä¸€äº›å«æ··ã€‚æœ¬æ–‡å°±é€šè¿‡å›¾æ–‡çš„æ–¹å¼å¥½å¥½è¯´è¯´ä»–ä»¬å¾®å¦™çš„å…³ç³» éƒ½å¬è¿‡ã€å¤©ä¸Šä¸€å¤©ï¼Œåœ°ä¸‹ä¸€å¹´ã€‘ï¼Œå‡è®¾ CPU æ‰§è¡Œä¸€æ¡æ™®é€šæŒ‡ä»¤éœ€è¦ä¸€å¤©ï¼Œé‚£ä¹ˆ CPU è¯»å†™å†…å­˜å°±å¾—ç­‰å¾…ä¸€å¹´çš„æ—¶é—´ã€‚ å—ã€æœ¨æ¡¶åŸç†ã€‘çš„é™åˆ¶ï¼Œåœ¨CPUçœ¼é‡Œï¼Œç¨‹åºçš„æ•´ä½“æ€§èƒ½éƒ½è¢«å†…å­˜çš„åŠäº‹æ•ˆç‡æ‹‰ä½äº†ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªçŸ­æ¿ï¼Œç¡¬ä»¶åŒå­¦ä¹Ÿä½¿ç”¨äº†æˆ‘ä»¬åšè½¯ä»¶å¸¸ç”¨çš„æé€Ÿç­–ç•¥â€”â€”ä½¿ç”¨ç¼“å­˜Cacheï¼ˆå®åˆ™æ˜¯ç¡¬ä»¶åŒå­¦ç»™è½¯ä»¶åŒå­¦æŒ–çš„å‘ï¼‰ Java å†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰CPU å¢åŠ äº†ç¼“å­˜å‡è¡¡äº†ä¸å†…å­˜çš„é€Ÿåº¦å·®å¼‚ï¼Œè¿™ä¸€å¢åŠ è¿˜æ˜¯å¥½å‡ å±‚ã€‚ æ­¤æ—¶å†…å­˜çš„çŸ­æ¿ä¸å†é‚£ä¹ˆæ˜æ˜¾ï¼ŒCPUç”šå–œã€‚ä½†éšä¹‹å´å¸¦æ¥å¾ˆå¤šé—®é¢˜ çœ‹ä¸Šå›¾ï¼Œæ¯ä¸ªæ ¸éƒ½æœ‰è‡ªå·±çš„ä¸€çº§ç¼“å­˜ï¼ˆL1 Cacheï¼‰ï¼Œæœ‰çš„æ¶æ„é‡Œé¢è¿˜æœ‰æ‰€æœ‰æ ¸å…±ç”¨çš„äºŒçº§ç¼“å­˜ï¼ˆL2 Cacheï¼‰ã€‚ä½¿ç”¨ç¼“å­˜ä¹‹åï¼Œå½“çº¿ç¨‹è¦è®¿é—®å…±äº«å˜é‡æ—¶ï¼Œå¦‚æœ L1 ä¸­å­˜åœ¨è¯¥å…±äº«å˜é‡ï¼Œå°±ä¸ä¼šå†é€çº§è®¿é—®ç›´è‡³ä¸»å†…å­˜äº†ã€‚æ‰€ä»¥ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°±è¡¥ä¸Šäº†è®¿é—®å†…å­˜æ…¢çš„çŸ­æ¿ å…·ä½“æ¥è¯´ï¼Œçº¿ç¨‹è¯»/å†™å…±äº«å˜é‡çš„æ­¥éª¤æ˜¯è¿™æ ·ï¼š ä»ä¸»å†…å­˜å¤åˆ¶å…±äº«å˜é‡åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ åœ¨å·¥ä½œå†…å­˜ä¸­å¯¹å˜é‡è¿›è¡Œå¤„ç† å¤„ç†å®Œåï¼Œå°†å˜é‡å€¼æ›´æ–°å›ä¸»å†…å­˜ å‡è®¾ç°åœ¨ä¸»å†…å­˜ä¸­æœ‰å…±äº«å˜é‡ Xï¼Œ å…¶åˆå§‹å€¼ä¸º 0 çº¿ç¨‹1å…ˆè®¿é—®å˜é‡ Xï¼Œ å¥—ç”¨ä¸Šé¢çš„æ­¥éª¤å°±æ˜¯è¿™æ ·ï¼š L1 å’Œ L2 ä¸­éƒ½æ²¡æœ‰å‘ç°å˜é‡ Xï¼Œç›´åˆ°åœ¨ä¸»å†…å­˜ä¸­æ‰¾åˆ° æ‹·è´å˜é‡ X åˆ° L1 å’Œ L2 ä¸­ åœ¨ L1 ä¸­å°† X çš„å€¼ä¿®æ”¹ä¸º1ï¼Œå¹¶é€å±‚å†™å›åˆ°ä¸»å†…å­˜ä¸­ æ­¤æ—¶ï¼Œåœ¨çº¿ç¨‹ 1 çœ¼ä¸­ï¼ŒX çš„å€¼æ˜¯è¿™æ ·çš„ï¼š æ¥ä¸‹æ¥ï¼Œçº¿ç¨‹ 2 åŒæ ·æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤è®¿é—®å˜é‡ X L1 ä¸­æ²¡æœ‰å‘ç°å˜é‡ X L2 ä¸­å‘ç°äº†å˜é‡X ä»L2ä¸­æ‹·è´å˜é‡åˆ°L1ä¸­ åœ¨L1ä¸­å°†X çš„å€¼ä¿®æ”¹ä¸º2ï¼Œå¹¶é€å±‚å†™å›åˆ°ä¸»å†…å­˜ä¸­ æ­¤æ—¶ï¼Œçº¿ç¨‹ 2 çœ¼ä¸­ï¼ŒX çš„å€¼æ˜¯è¿™æ ·çš„ï¼š ç»“åˆåˆšåˆšçš„ä¸¤æ¬¡æ“ä½œï¼Œå½“çº¿ç¨‹1å†è®¿é—®å˜é‡xï¼Œæˆ‘ä»¬çœ‹çœ‹æœ‰ä»€ä¹ˆé—®é¢˜ï¼š æ­¤åˆ»ï¼Œå¦‚æœçº¿ç¨‹ 1 å†æ¬¡å°† x=1å›å†™ï¼Œå°±ä¼šè¦†ç›–çº¿ç¨‹2 x=2 çš„ç»“æœï¼ŒåŒæ ·çš„å…±äº«å˜é‡ï¼Œçº¿ç¨‹æ‹¿åˆ°çš„ç»“æœå´ä¸ä¸€æ ·ï¼ˆçº¿ç¨‹1çœ¼ä¸­x=1ï¼›çº¿ç¨‹2çœ¼ä¸­x=2ï¼‰ï¼Œè¿™å°±æ˜¯å…±äº«å˜é‡å†…å­˜ä¸å¯è§çš„é—®é¢˜ã€‚ æ€ä¹ˆè¡¥å‘å‘¢ï¼Ÿä»Šå¤©çš„ä¸¤ä½ä¸»è§’é—ªäº®ç™»åœºï¼Œä¸è¿‡åœ¨è¯´æ˜ volatileå…³é”®å­—ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è¯´è¯´ä½ æœ€ç†Ÿæ‚‰çš„ synchronized å…³é”®å­— synchronizedé‡åˆ°çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜ï¼Œä¹ æƒ¯æ€§çš„ä¼šæƒ³åˆ°ç”¨ synchronized å…³é”®å­—æ¥è§£å†³é—®é¢˜ï¼Œæš‚ä¸”å…ˆä¸è®ºè¯¥åŠæ³•æ˜¯å¦åˆç†ï¼Œæˆ‘ä»¬æ¥çœ‹ synchronized å…³é”®å­—æ˜¯æ€ä¹ˆè§£å†³ä¸Šé¢æåˆ°çš„å…±äº«å˜é‡å†…å­˜å¯è§æ€§é—®é¢˜çš„ ã€è¿›å…¥ã€‘synchronized å—çš„å†…å­˜è¯­ä¹‰æ˜¯æŠŠåœ¨ synchronized å—å†…ä½¿ç”¨çš„å˜é‡ä»çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­æ¸…é™¤ï¼Œä»ä¸»å†…å­˜ä¸­è¯»å– ã€é€€å‡ºã€‘synchronized å—çš„å†…å­˜è¯­ä¹‰äº‹æŠŠåœ¨ synchronized å—å†…å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ äºŒè¯ä¸è¯´ï¼Œæ— æƒ…å‘ä¸‹çœ‹ volatile volatileå½“ä¸€ä¸ªå˜é‡è¢«å£°æ˜ä¸º volatile æ—¶ï¼š çº¿ç¨‹åœ¨ã€è¯»å–ã€‘å…±äº«å˜é‡æ—¶ï¼Œä¼šå…ˆæ¸…ç©ºæœ¬åœ°å†…å­˜å˜é‡å€¼ï¼Œå†ä»ä¸»å†…å­˜è·å–æœ€æ–°å€¼ çº¿ç¨‹åœ¨ã€å†™å…¥ã€‘å…±äº«å˜é‡æ—¶ï¼Œä¸ä¼šæŠŠå€¼ç¼“å­˜åœ¨å¯„å­˜å™¨æˆ–å…¶ä»–åœ°æ–¹ï¼ˆå°±æ˜¯åˆšåˆšè¯´çš„æ‰€è°“çš„ã€Œå·¥ä½œå†…å­˜ã€ï¼‰ï¼Œè€Œæ˜¯ä¼šæŠŠå€¼åˆ·æ–°å›ä¸»å†…å­˜ æœ‰ç§æ¢æ±¤ä¸æ¢è¯çš„æ„Ÿè§‰ï¼Œä½ çœ‹çš„ä¸€ç‚¹éƒ½æ²¡é”™ æ‰€ä»¥ï¼Œå½“ä½¿ç”¨ synchronized æˆ– volatile åï¼Œå¤šçº¿ç¨‹æ“ä½œå…±äº«å˜é‡çš„æ­¥éª¤å°±å˜æˆäº†è¿™æ ·ï¼š ç®€å•ç‚¹æ¥è¯´å°±æ˜¯ä¸å†å‚è€ƒ L1 å’Œ L2 ä¸­å…±äº«å˜é‡çš„å€¼ï¼Œè€Œæ˜¯ç›´æ¥è®¿é—®ä¸»å†…å­˜ æ¥ç‚¹è¸å®çš„ï¼Œä¸Šä¾‹å­ğŸŒ° 1234567891011121314public class ThreadNotSafeInteger &#123; /** * å…±äº«å˜é‡ value */ private int value; public int getValue() &#123; return value; &#125; public void setValue(int value) &#123; this.value = value; &#125;&#125; ç»è¿‡å‰åºåˆ†æé“ºå«ï¼Œå¾ˆæ˜æ˜¾ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œå…±äº«å˜é‡ value å­˜åœ¨å¤§å¤§çš„éšæ‚£ï¼Œå°è¯•å¯¹å…¶ä½œå‡ºä¸€äº›æ”¹å˜ å…ˆä½¿ç”¨ volatile å…³é”®å­—æ”¹é€ ï¼š 1234567891011121314public class ThreadSafeInteger &#123; /** * å…±äº«å˜é‡ value */ private volatile int value; public int getValue() &#123; return value; &#125; public void setValue(int value) &#123; this.value = value; &#125;&#125; å†ä½¿ç”¨ synchronized å…³é”®å­—æ”¹é€  1234567891011121314public class ThreadSafeInteger &#123; /** * å…±äº«å˜é‡ value */ private int value; public synchronized int getValue() &#123; return value; &#125; public synchronized void setValue(int value) &#123; this.value = value; &#125;&#125; è¿™ä¸¤ä¸ªç»“æœæ˜¯å®Œå…¨ç›¸åŒï¼Œåœ¨è§£å†³ã€å½“å‰ã€‘å…±äº«å˜é‡æ•°æ®å¯è§æ€§çš„é—®é¢˜ä¸Šï¼ŒäºŒè€…ç®—æ˜¯ç­‰åŒçš„ å¦‚æœè¯´ synchronized å’Œ volatile æ˜¯å®Œå…¨ç­‰åŒçš„ï¼Œé‚£å°±æ²¡å¿…è¦è®¾è®¡ä¸¤ä¸ªå…³é”®å­—äº†ï¼Œç»§ç»­çœ‹ä¸ªä¾‹å­ 1234567891011121314151617181920212223242526272829303132333435@Slf4jpublic class VisibilityIssue &#123; private static final int TOTAL = 10000;// å³ä¾¿åƒä¸‹é¢è¿™æ ·åŠ äº† volatile å…³é”®å­—ä¿®é¥°ä¸ä¼šè§£å†³é—®é¢˜ï¼Œå› ä¸ºå¹¶æ²¡æœ‰è§£å†³åŸå­æ€§é—®é¢˜ private volatile int count; public static void main(String[] args) &#123; VisibilityIssue visibilityIssue = new VisibilityIssue(); Thread thread1 = new Thread(() -&gt; visibilityIssue.add10KCount()); Thread thread2 = new Thread(() -&gt; visibilityIssue.add10KCount()); thread1.start(); thread2.start(); try &#123; thread1.join(); thread2.join(); &#125; catch (InterruptedException e) &#123; log.error(e.getMessage()); &#125; log.info(\"count å€¼ä¸ºï¼š&#123;&#125;\", visibilityIssue.count); &#125; private void add10KCount()&#123; int start = 0; while (start ++ &lt; TOTAL)&#123; this.count ++; &#125; &#125;&#125; å…¶å®å°±æ˜¯å°†ä¸Šé¢setValue ç®€å•èµ‹å€¼æ“ä½œ ï¼ˆthis.value = value;ï¼‰å˜æˆäº† ï¼ˆthis.count ++;ï¼‰å½¢å¼ï¼Œå¦‚æœä½ è¿è¡Œä»£ç ï¼Œä½ ä¼šå‘ç°ï¼Œcountçš„å€¼å§‹ç»ˆæ˜¯å¤„äº1wå’Œ2wä¹‹é—´çš„ å°†ä¸Šé¢æ–¹æ³•å†ä»¥ synchronized çš„å½¢å¼åšæ”¹åŠ¨ 123456789101112131415@Slf4jpublic class VisibilityIssue &#123; private static final int TOTAL = 10000; private int count; //... åŒä¸Š private synchronized void add10KCount()&#123; int start = 0; while (start ++ &lt; TOTAL)&#123; this.count ++; &#125; &#125;&#125; å†æ¬¡è¿è¡Œä»£ç ï¼Œcount ç»“æœå°±æ˜¯ 2w ä¸¤ç»„ä»£ç ï¼Œéƒ½é€šè¿‡ volatile å’Œ synchronized å…³é”®å­—ä»¥åŒæ ·å½¢å¼ä¿®é¥°ï¼Œæ€ä¹ˆæœ‰çš„å¯ä»¥å¸¦æ¥ç›¸åŒç»“æœï¼Œæœ‰çš„å´ä¸èƒ½å‘¢ï¼Ÿ è¿™å°±è¦è¯´è¯´äºŒè€…çš„ä¸åŒäº† count++ ç¨‹åºä»£ç æ˜¯ä¸€è¡Œï¼Œä½†æ˜¯ç¿»è¯‘æˆ CPU æŒ‡ä»¤ç¡®æ˜¯ä¸‰è¡Œ( ä¸ä¿¡ä½ ç”¨ javap -c å‘½ä»¤è¯•è¯•) synchronized æ˜¯ç‹¬å é”/æ’ä»–é”ï¼ˆå°±æ˜¯æœ‰ä½ æ²¡æˆ‘çš„æ„æ€ï¼‰ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ add10KCount æ–¹æ³•ï¼Œå…¶ä»–è°ƒç”¨çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚æ‰€ä»¥ä¸‰è¡Œ CPU æŒ‡ä»¤éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œä¹‹ååˆ«çš„çº¿ç¨‹æ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯é€šå¸¸è¯´è¯´çš„ åŸå­æ€§ ï¼ˆçº¿ç¨‹æ‰§è¡Œå¤šæ¡æŒ‡ä»¤ä¸è¢«ä¸­æ–­ï¼‰ ä½† volatile æ˜¯éé˜»å¡ç®—æ³•ï¼ˆä¹Ÿå°±æ˜¯ä¸æ’ä»–ï¼‰ï¼Œå½“é‡åˆ°ä¸‰è¡Œ CPU æŒ‡ä»¤è‡ªç„¶å°±ä¸èƒ½ä¿è¯åˆ«çš„çº¿ç¨‹ä¸æ’è¶³äº†ï¼Œè¿™å°±æ˜¯é€šå¸¸æ‰€è¯´çš„ï¼Œvolatile èƒ½ä¿è¯å†…å­˜å¯è§æ€§ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯åŸå­æ€§ ä¸€å¥è¯ï¼Œé‚£ä»€ä¹ˆæ—¶å€™æ‰èƒ½ç”¨volatileå…³é”®å­—å‘¢ï¼Ÿï¼ˆåƒä¸‡è®°ä½äº†ï¼Œé‡è¦äº‹æƒ…è¯´ä¸‰éï¼Œæ„Ÿè§‰è¿™å¥è¯è¿‡æ—¶äº†ï¼‰ å¦‚æœå†™å…¥å˜é‡å€¼ä¸ä¾èµ–å˜é‡å½“å‰å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ volatile å¦‚æœå†™å…¥å˜é‡å€¼ä¸ä¾èµ–å˜é‡å½“å‰å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ volatile å¦‚æœå†™å…¥å˜é‡å€¼ä¸ä¾èµ–å˜é‡å½“å‰å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ volatile æ¯”å¦‚ä¸Šé¢ count++ ï¼Œæ˜¯è·å–-è®¡ç®—-å†™å…¥ä¸‰æ­¥æ“ä½œï¼Œä¹Ÿå°±æ˜¯ä¾èµ–å½“å‰å€¼çš„ï¼Œæ‰€ä»¥ä¸èƒ½é volatile è§£å†³é—®é¢˜ åˆ°è¿™é‡Œï¼Œæ–‡ç« å¼€å¤´ç¬¬ä¸€ä¸ªé—®é¢˜ã€volatile ä¸ synchronized åœ¨å¤„ç†å“ªäº›é—®é¢˜æ˜¯ç›¸å¯¹ç­‰ä»·çš„ï¼Ÿã€‘ç­”æ¡ˆå·²ç»æ­æ™“äº† å…ˆè‡ªå·±è„‘è¡¥ä¸€ä¸‹ï¼Œå¦‚æœè®©ä½ åŒä¸€æ®µæ—¶é—´å†…ã€å†™å‡ è¡Œä»£ç ã€‘å°±è¦å»ã€æ•°é’±ã€‘ï¼Œæ•°å‡ ä¸‹é’±å°±è¦å»ã€å”±æ­Œã€‘ï¼Œå”±å®Œæ­Œåˆè¦å»ã€å†™ä»£ç ã€‘ï¼Œåå¤é¢‘ç¹è¿™æ ·æ“ä½œï¼Œè¿˜è¦æ¥ä¸Šä¸Šä¸€æ¬¡çš„æ“ä½œï¼ˆä»£ç æ¥ç€å†™ï¼Œé’±ç´¯åŠ ç€æ•°ï¼Œæ­Œæ¥ç€å”±ï¼‰è¿˜éœ€è¦ä¿è¯ä¸å‡ºé”™ï¼Œä½ ç´¯ä¸ç´¯ï¼Ÿ synchronized æ˜¯æ’ä»–çš„ï¼Œçº¿ç¨‹æ’é˜Ÿå°±è¦æœ‰åˆ‡æ¢ï¼Œè¿™ä¸ªåˆ‡æ¢å°±å¥½æ¯”ä¸Šé¢çš„ä¾‹å­ï¼Œè¦å®Œæˆåˆ‡æ¢ï¼Œè¿˜å¾—è®°å‡†çº¿ç¨‹ä¸Šä¸€æ¬¡çš„æ“ä½œï¼Œå¾ˆç´¯CPUå¤§è„‘ï¼Œè¿™å°±æ˜¯é€šå¸¸è¯´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ä¼šå¸¦æ¥å¾ˆå¤§å¼€é”€ volatile å°±ä¸ä¸€æ ·äº†ï¼Œå®ƒæ˜¯éé˜»å¡çš„æ–¹å¼ï¼Œæ‰€ä»¥åœ¨è§£å†³å…±äº«å˜é‡å¯è§æ€§é—®é¢˜çš„æ—¶å€™ï¼Œvolatile å°±æ˜¯ synchronized çš„å¼±åŒæ­¥ä½“ç°äº† åˆ°è¿™ï¼Œæ–‡ç« çš„ç¬¬äºŒä¸ªé—®é¢˜ã€ä¸ºä»€ä¹ˆè¯´ volatile æ˜¯ synchronized å¼±åŒæ­¥çš„æ–¹å¼ï¼Ÿã€‘ä½ ä¹Ÿåº”è¯¥æ˜ç™½äº†å§ volatile é™¤äº†è¿˜èƒ½è§£å†³å¯è§æ€§é—®é¢˜ï¼Œè¿˜èƒ½è§£å†³ç¼–è¯‘ä¼˜åŒ–é‡æ’åºé—®é¢˜ï¼Œä¹‹å‰çš„æ–‡ç« å·²ç»ä»‹ç»è¿‡ï¼Œè¯·å¤§å®¶ç‚¹å‡»é“¾æ¥è‡ªè¡ŒæŸ¥çœ‹å°±å¥½ï¼ˆé¢è¯•å¸¸é—®çš„åŒé‡æ£€æŸ¥é”å•ä¾‹æ¨¡å¼ä¸ºä»€ä¹ˆä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ä¹Ÿå¯ä»¥åœ¨é‡Œé¢æ‰¾åˆ°ç­”æ¡ˆå“¦ï¼‰ï¼š æœ‰åºæ€§å¯è§æ€§ï¼ŒHappens-beforeæ¥æå®š é¢è¯•volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ çœ‹å®Œè¿™ä¸¤ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡ç¬¬ä¸‰ä¸ªé—®é¢˜ä¹Ÿå°±è¿åˆƒè€Œè§£äº† äº†è§£äº†è¿™äº›ï¼Œç›¸ä¿¡ä½ ä¹Ÿå°±æ‡‚å¾—å¦‚ä½•ä½¿ç”¨äº† ç²¾æŒ‘ç»†é€‰ï¼Œç»ˆäºæ•´ç†å®Œåˆç‰ˆ Java æŠ€æœ¯æ ˆç¡¬æ ¸èµ„æ–™ï¼ŒæŠ¢å…ˆçœ‹å°±å…¬ä¼—å·å›å¤ã€èµ„æ–™ã€‘/ã€666ã€‘å§ çµé­‚è¿½é—® ä½ äº†è§£çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿä¸åŒçš„çŠ¶æ€æµè½¬æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ ä¸ºä»€ä¹ˆçº¿ç¨‹æœ‰é€šçŸ¥å”¤é†’æœºåˆ¶ï¼Ÿ ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬æ¥è¯´è¯´ã€å”¤é†’çº¿ç¨‹ä¸ºä»€ä¹ˆå»ºè®®ç”¨notifyAllè€Œä¸å»ºè®®ç”¨notifyå‘¢ï¼Ÿã€‘","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"},{"name":"volatile","slug":"volatile","permalink":"https://dayarch.top/tags/volatile/"},{"name":"synchronized","slug":"synchronized","permalink":"https://dayarch.top/tags/synchronized/"}]},{"title":"Javaåç«¯çš„æˆ‘åœ¨å­¦Node.js ä½ æ•¢ä¿¡ï¼Ÿ","slug":"Javaåç«¯çš„æˆ‘åœ¨å­¦Node-js-ä½ æ•¢ä¿¡ï¼Ÿ","date":"2020-02-27T00:40:40.482Z","updated":"2020-02-27T01:01:23.540Z","comments":true,"path":"/p/start-to-learn-nodejs.html","link":"","permalink":"https://dayarch.top/p/start-to-learn-nodejs.html","excerpt":"é¡¹ç›®éœ€è¦ï¼Œæˆ‘éœ€è¦å‚¨å¤‡ä¸€äº›Node.js ç›¸å…³çš„çŸ¥è¯†äº†ï¼Œæ•´ä½“æ„Ÿè§‰æ˜¯ä¸€ä»¶å¥½äº‹ èƒŒæ™¯ ä»å‰ï¼Œæˆ‘ä¹Ÿå†™è¿‡å‰ç«¯ï¼Œä¸è¿‡é‚£ä¼šæœ€å¤šç”¨åˆ°HTML5 +jQueryç›¸å…³æŠ€æœ¯ã€‚ä¹Ÿæ²¡æœ‰å‡†ç¡®çš„æ—¶é—´ç‚¹æ¥åˆ’åˆ†ï¼Œæˆ‘å°±å¿½å¿½æ‚ æ‚ çš„ä¸“æ³¨äºJavaåç«¯äº† åƒç°åœ¨çš„å¤§å‰ç«¯Angularã€VUEã€REACTè¿™äº›å¤§å‰ç«¯æ¡†æ¶æˆ‘åªæ˜¯ç•¥æœ‰äº†è§£ï¼Œå®Œå…¨æ²¡æœ‰ç”¨è¿‡ï¼Œç”¨Nodeä½œä¸ºä¸­é—´æœåŠ¡å™¨ä¹Ÿæ˜¯ç›¸å¯¹é™Œç”ŸçŠ¶æ€ï¼Œé¡¹ç›®ä¸­éœ€è¦ï¼Œæˆ‘æ˜¯ä¸€å®šä¸ä¼šæ”¾è¿‡è¿™ä¸ªå¯ä»¥æ‰å¤´å‘çš„è‰¯æœºï¼ˆæƒ³æ³•å¾ˆç®€ç­”ï¼Œ è·³å‡ºè‡ªå·±çš„èˆ’é€‚åŒºï¼‰ æ¯•ç«Ÿè¦åœ¨å®é™…é¡¹ç›®ä¸­å†™Nodeä»£ç çš„ï¼Œè¿™ä¹ˆä¸¥å³»çš„é—®é¢˜æˆ‘æ˜¯è¦è®¤çœŸå¯¹å¾…çš„ï¼Œè¦ä¸ç„¶ä¼šè®©é˜Ÿå‹æ¶ˆè€—å¤ªå¤š WTFs/min èƒ½é‡ï¼ˆè¿™æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Ÿè¯·çœ‹ã€è¯»ã€ŠClean C","text":"é¡¹ç›®éœ€è¦ï¼Œæˆ‘éœ€è¦å‚¨å¤‡ä¸€äº›Node.js ç›¸å…³çš„çŸ¥è¯†äº†ï¼Œæ•´ä½“æ„Ÿè§‰æ˜¯ä¸€ä»¶å¥½äº‹ èƒŒæ™¯ä»å‰ï¼Œæˆ‘ä¹Ÿå†™è¿‡å‰ç«¯ï¼Œä¸è¿‡é‚£ä¼šæœ€å¤šç”¨åˆ°HTML5 +jQueryç›¸å…³æŠ€æœ¯ã€‚ä¹Ÿæ²¡æœ‰å‡†ç¡®çš„æ—¶é—´ç‚¹æ¥åˆ’åˆ†ï¼Œæˆ‘å°±å¿½å¿½æ‚ æ‚ çš„ä¸“æ³¨äºJavaåç«¯äº† åƒç°åœ¨çš„å¤§å‰ç«¯Angularã€VUEã€REACTè¿™äº›å¤§å‰ç«¯æ¡†æ¶æˆ‘åªæ˜¯ç•¥æœ‰äº†è§£ï¼Œå®Œå…¨æ²¡æœ‰ç”¨è¿‡ï¼Œç”¨Nodeä½œä¸ºä¸­é—´æœåŠ¡å™¨ä¹Ÿæ˜¯ç›¸å¯¹é™Œç”ŸçŠ¶æ€ï¼Œé¡¹ç›®ä¸­éœ€è¦ï¼Œæˆ‘æ˜¯ä¸€å®šä¸ä¼šæ”¾è¿‡è¿™ä¸ªå¯ä»¥æ‰å¤´å‘çš„è‰¯æœºï¼ˆæƒ³æ³•å¾ˆç®€ç­”ï¼Œ è·³å‡ºè‡ªå·±çš„èˆ’é€‚åŒºï¼‰ æ¯•ç«Ÿè¦åœ¨å®é™…é¡¹ç›®ä¸­å†™Nodeä»£ç çš„ï¼Œè¿™ä¹ˆä¸¥å³»çš„é—®é¢˜æˆ‘æ˜¯è¦è®¤çœŸå¯¹å¾…çš„ï¼Œè¦ä¸ç„¶ä¼šè®©é˜Ÿå‹æ¶ˆè€—å¤ªå¤š WTFs/min èƒ½é‡ï¼ˆè¿™æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Ÿè¯·çœ‹ã€è¯»ã€ŠClean Code ä»£ç æ•´æ´ä¹‹é“ã€‹ä¹‹æ„Ÿæ‚Ÿã€‘ï¼‰ï¼Œä½œä¸ºä¸€ä¸ªå°ç™½ï¼Œé€šè¿‡å­¦ä¹ ä¸€å°æ®µæ—¶é—´è¿˜æ˜¯æœ‰æ‰€æ”¶è·çš„ï¼Œä¸‹é¢ä¸»è¦è¯´ä¸€ä¸‹æˆ‘çš„å­¦ä¹ è¿‡ç¨‹ï¼Œè¯·æœ‰ç»éªŒçš„å¤§ä½¬å¤šæŒ‡æ­£ï¼Œè®©ä¿ºå°‘èµ°ç‚¹å¼¯è·¯å¤šç•™å‡ æ ¹å¤´å‘ Node.js å­¦ä¹ å’Œå¤§å®¶ä¸€æ ·ï¼Œæˆ‘ä¹Ÿæ˜¯å„ç§ä¸Šç½‘æŸ¥é˜…èµ„æ–™ï¼Œè¿™é‡Œå°†ç›®å‰çš„å­¦ä¹ è¿‡ç¨‹åšä¸ªç®€å•çš„è®°å½• Node.js å®˜ç½‘å­¦ä¹ ä¸€æ ·ä¸œè¥¿ï¼Œç¬¬ä¸€æ­¥è‡ªç„¶æ˜¯å…ˆæ‰“å¼€å®˜ç½‘ï¼Œè¿™é‡Œæ ¹æ­£è‹—çº¢ï¼Œä¸ä¼—ä¸åŒ ä¼˜ç‚¹ï¼šå¾ˆå¿«å¯ä»¥æœ‰ä¸€ä¸ªç›¸å¯¹ç›´è§‚çš„äº†è§£ï¼Œæ–‡æ¡£ä¸APIé½å…¨ ç¼ºç‚¹ï¼šè¿™é‡Œçš„è‹—å¤ªæ­£äº†ï¼Œã€äº‹ä»¶é©±åŠ¨ã€æ„å»ºåœ¨V8å¼•æ“ã€‘ç­‰é™Œç”Ÿè¯æ±‡ç›´æ¥è®©æˆ‘çœ¼å†’é‡‘æ˜Ÿï¼Œè¿™ç±»è¯è¯­å°±å¥½æ¯”å°æ—¶å€™çˆ¶æ¯å¯¹æˆ‘ä»¬è¯´çš„è¯æ±‡ï¼Œåªæœ‰é•¿å¤§ä¹‹åæ‰ä¼šæ˜ç™½ é¢å¯¹è¿™äº›é™Œç”Ÿçš„å†…å®¹ï¼Œæˆ‘å¹¶ä¸æ˜¯å¾ˆæ‹…å¿ƒï¼ˆå†…å¿ƒæ‡µçš„ä¸€Pï¼‰ï¼Œç›¸ä¿¡é•¿å¤§åä¼šæ˜ç™½çš„ï¼Œéšæ‰‹æ¯«ä¸ç•™æƒ…æŠŠç½‘ç«™å…³æ‰ tutorialspointtutorialspoint æ˜¯æˆ‘éå¸¸å–œæ¬¢çš„å­¦ä¹ ç½‘ç«™ï¼Œä¸Šé¢æœ‰å¾ˆå¤šæŠ€æœ¯æ•™ç¨‹ï¼Œå…ˆæ¥ä¸ªæˆªå›¾ç§ç§ ä¼˜ç‚¹ï¼šæ•™ç¨‹å†…å®¹ç®€å•æ˜äº†ï¼Œå¾ªåºæ¸è¿›ï¼Œæ¡ˆä¾‹ä»£ç é½å…¨ ç¼ºç‚¹ï¼šè¿™æ˜¯ä¸€ä¸ªè‹±æ–‡ç½‘ç«™ ï¼ˆTips: çœ‹è‹±æ–‡æ–‡æ¡£åº”è¯¥æˆä¸ºæˆ‘ä»¬çš„å¿…å¤‡æŠ€èƒ½ä¹‹ä¸€ï¼‰ ä¸è¦è¢«è‹±æ–‡ç½‘ç«™å“åˆ°ï¼Œå…¶å®æ²¡ä»€ä¹ˆé™Œç”Ÿè¯æ±‡ï¼ŒæŒ‰ç…§Node.js æ•™ç¨‹ ä»å¤´åˆ°å°¾æ’¸äº†ä¸€éï¼Œæœ‰äº†ç›¸å¯¹å…¨é¢çš„äº†è§£ï¼ŒçŸ¥é“äº†åŸºæœ¬éª¨æ¶å†…å®¹, ä¸€è¾¹æ’¸ä¸€éè®°ç¬”è®°ï¼ˆå¿½ç•¥ç€æ½¦è‰çš„å­—ï¼‰ ä¸­é€”è¿˜æ˜¯æœ‰å¾ˆå¤šä¸ç†è§£çš„å†…å®¹ï¼Œéƒ½ç”¨é»„è‰²çš„ç¬”åœˆäº†å‡ºæ¥ï¼Œæ”¾åœ¨åé¢æ…¢æ…¢æŸ¥é˜…ï¼Œç´§è·Ÿä¸»çº¿ï¼Œä»¥é˜²è‡ªå·±è·‘å æå®¢æ—¶é—´/æ…•è¯¾ç½‘æ•™å­¦è§†é¢‘æ˜¯å‰è¾ˆå¤šå¹´æµ“ç¼©çš„ç²¾åï¼Œæœ‰äº†ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œæˆ‘ä¼šé€‰æ‹©ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæ•´ä½“çœ‹ä¸€ä¸‹ã€‚æ—¥å¸¸ä¸»è¦é€šè¿‡ã€æå®¢æ—¶é—´ã€‘å’Œã€æ…•è¯¾ç½‘ã€‘è¿™ä¸¤ä¸ªç½‘ç«™æœç´¢è§†é¢‘èµ„æ–™ï¼Œå…¶ä¸­è¿˜åœ¨æå®¢æ—¶é—´è´­ä¹°äº†ä¸‹é¢çš„è¿™é—¨è¯¾ è¿™é—¨è¯¾çš„åŸºç¡€çŸ¥è¯†è®²çš„ä¸ç®—å¤šï¼Œå‰åºç« èŠ‚ä»¥çŸ³å¤´å‰ªåˆ€å¸ƒçš„ç®€å•æ¸¸æˆæ¥è¯´æ˜Node.jsä¸€äº›ç‰¹æ€§ï¼Œåé¢å®æˆ˜å®ç°æå®¢æ—¶é—´ã€è¯¦æƒ…/åˆ—è¡¨/è¯„è®ºã€‘ç­‰é¡µé¢ æ¨æµ©è€å¸ˆè®²è§£çš„å¾ˆæ¸…æ™°ï¼Œä¸­é—´ç©¿æ’ç€å¾ˆå¤šå†·å¹½é»˜ï¼Œä½†å¯¹äºå°ç™½çš„æˆ‘æ¥è¯´ï¼Œè¿™é—¨è¯¾çœ‹æ—©äº†ï¼Œé‡Œé¢è®²çš„å¾ˆå¤šå†…å®¹æˆ‘è¿˜ä¸èƒ½ç†è§£ï¼Œä½†æ˜¯é‡Œé¢è¯´çš„ä¸€äº›æ„å»ºæ€æƒ³ï¼Œæ¯”å¦‚CommonJSï¼Œè¿™äº›å†…å®¹è¿˜æ˜¯ååˆ†å—ç”¨çš„ï¼Œè§†é¢‘è¯¾ç¨‹ç›®å‰çœ‹äº†è¶…è¿‡2/3ï¼Œæˆ‘é€‰æ‹©æŒ‰ä¸‹æš‚åœé”®ï¼Œè§‰å¾—æœ‰å¿…è¦å†™ä¸€äº›Demoæ¥ä½¿ç”¨ä¸Šé¢å­¦åˆ°çš„ä¸€äº›çŸ¥è¯†ç‚¹äº†ï¼Œæˆ‘ç›¸ä¿¡å½“æˆ‘å†å›å¤´è¿‡æ¥çœ‹è¿™ä¸ªè§†é¢‘çš„æ”¶è·ä¸€å®šæ˜¯ä¸ä¸€æ ·çš„ Githubæ¬¢è¿æ¥åˆ°ä¸–ç•Œæœ€å¤§çš„åŒæ€§äº¤å‹ç½‘ç«™ï¼Œæƒ³ä¸åˆ°è¦å†™ä¸€ä¸ªä»€ä¹ˆæ ·çš„Demoï¼Œäºæ˜¯æ¥è¿™é‡Œæœç´¢ä¸€ä¸‹ï¼Œè¿˜çœŸæ‰¾åˆ°äº†è‡ªå»ºåšå®¢çš„å­¦ä¹ æ€§é¡¹ç›®N-Blog ï¼ˆä½ æœ‰ä»€ä¹ˆéœ€æ±‚å®Œå…¨å¯ä»¥å…ˆæ¥ä¸Šé¢æ‰¾æ‰¾è½®å­çš„ï¼‰ æ‰¾é¡¹ç›®æœ‰å‡ çœ‹ï¼š commitsçš„æ´»è·ƒåº¦ æ˜Ÿæ ‡/forkæ•°é‡ README/wikiç¼–å†™è´¨é‡ Issueså¤„ç†æƒ…å†µ æŒ‰ç…§ä¸Šè¿°å‡ ä¸ªæ ‡å‡†ç¡®è®¤è¿‡çœ¼ç¥ï¼Œè¿™æ˜¯æˆ‘è¦æ‰¾çš„å§‘å¨˜ è¯¥é¡¹ç›®ä¸»è¦åº”ç”¨ä¸‹é¢å‡ é¡¹æŠ€æœ¯ï¼š Node.js: 8.9.1 MongoDB: 3.4.10 Express: 4.16.2 çœ‹æŠ€æœ¯æ ˆï¼Œå°±å¯ä»¥è®¤å®šï¼Œè¿™æ˜¯æ¥è¿‘çœŸå®é¡¹ç›®çš„å­˜åœ¨ï¼Œäºæ˜¯ï¼ŒæŒ‰éƒ¨å°±ç­çš„æ•²ä»£ç ï¼Œæ•²ä»£ç ï¼Œæ•²ä»£ç ï¼ˆä¸æ˜¯å¤åˆ¶ç²˜è´´ï¼‰ï¼Œå› ä¸ºæ•²ä»£ç å°±å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼Œè¿™æ ·ä¹Ÿåœ¨å­¦ä¹ ä¸­é€æ­¥å­¦ä¼šäº†è°ƒè¯• é€šè¿‡ä¸¤å¤©æ—¶é—´ä¹Ÿç»ˆäºåšå‡ºäº†æœ€ç»ˆçš„æ•ˆæœ éº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨ï¼Œåœ¨å®ç°è¿‡ç¨‹é‡åˆ°äº†å¤ªå¤šé—®é¢˜ï¼Œæ¯”å¦‚ï¼š npmå…¨å±€å®‰è£…æƒé™é—®é¢˜ Homebrew å®‰è£…MongoDBä¸æ”¯æŒservicesæŒ‡ä»¤é—®é¢˜ é™Œç”Ÿçš„APIä½¿ç”¨é—®é¢˜ â€¦â€¦ åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­æˆ‘éƒ½æœ‰åšè®°å½•ï¼ŒåŒæ—¶ç»“åˆé¡¹ç›®å†…å®¹åšäº†ä¸‹é¢è¿™å¼ æ€ç»´å¯¼å›¾ï¼Œåªæœ‰å…¨éƒ¨ç‚¹äº®è¿™äº›å¶å­ï¼Œæ‰èƒ½ç®—æ˜¯åšå®Œäº†è¿™ä¸ªDemoï¼ˆæ›´å¤šç»†èŠ‚å†…å®¹éšè—åœ¨äº†èŠ‚ç‚¹notesé‡Œé¢ï¼‰ è¿™ä¸ªæ€ç»´å¯¼å›¾è‚¯å®šä¸æ˜¯æ ‡å‡†çš„Node.js å­¦ä¹ å†…å®¹ï¼Œåªä¸è¿‡æ˜¯åº”å¯¹æˆ‘æœ¬æ¬¡åŸºç¡€çš„å­¦ä¹ ï¼Œåç»­çš„å­¦ä¹ ä¼šä¸æ–­å¯¹è¿™ä¸ªæ€ç»´å¯¼å›¾è¿›è¡Œä¿®æ­£çš„ æ€»ç»“ä½ ä»¥ä¸ºæˆ‘ä»¬å°±å¯ä»¥å½»åº•æŠ›å¼ƒå®˜ç½‘äº†å—ï¼Ÿåœ¨è°ƒè¯•ä¸ç¼–å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°æŸä¸ªçŸ¥è¯†ç‚¹ï¼Œå°±è¦æœæ–­å›åˆ°å®˜ç½‘æŸ¥çœ‹ï¼Œé‚£é‡Œæœ‰æœ€æƒå¨çš„è§£é‡Šã€‚å¦å¤–ï¼Œå¸¦æœ‰ç›®çš„æ€§çš„æŸ¥çœ‹å®˜ç½‘æ€»æ¯”ä¸€å¤´æ‰è¿›å»èˆ’æœçš„å¤šï¼Œä½ è§‰å¾—å‘¢ ä¸å…¶è¯´è¿™æ˜¯æˆ‘è¿™å‡ å¤©å­¦ä¹ Node.js æ–¹å¼ï¼Œä¸å¦‚è¯´è¿™æ˜¯æˆ‘å­¦ä¹ æ–°ä¸œè¥¿çš„æ•´ä½“æ–¹æ³•å’Œè·¯çº¿ï¼Œå†™è¿™ç¯‡æ–‡ç« ä¹Ÿæƒ³å€Ÿæ­¤å½“ä¸ªè¯é¢˜å’Œå¤§å®¶èŠèŠï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€æˆ–è¿›ç¾¤åˆ†äº«å½¼æ­¤çš„å­¦ä¹ æ–¹æ³•/è¯»ä¹¦ç¬”è®°/æŠ€æœ¯äº¤æµç­‰ï¼Œå…±åŒè¿›æ­¥ éš”ä¸‰å·®äº”ï¼Œæˆ‘ä¹Ÿä¼šè¾“å‡ºä¸€äº›Node.js ç›¸å…³çš„å†…å®¹ï¼Œä½ ä»¥ä¸ºæˆ‘å–œæ–°åŒæ—§äº†ï¼Ÿåœ¨æˆ‘å¿ƒä¸­ï¼ŒJavaä¾æ—§æ˜¯æˆ‘æ€¡çº¢é™¢çš„å¤´ç‰Œï¼ˆæˆ‘å¿…é¡»å® å¥¹ï¼‰ æœ€åï¼Œä¸è¦æ°¸è¿œå‘†åœ¨è‡ªå·±çš„èˆ’é€‚åŒºï¼Œstay hungryï¼Œ stay foolish","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Node.js","slug":"Coding/Node-js","permalink":"https://dayarch.top/categories/Coding/Node-js/"}],"tags":[]},{"title":"é—²ç€æ— èŠè€ƒä¸ªPMPç©ç©","slug":"é—²ç€æ— èŠè€ƒä¸ªPMPç©ç©","date":"2020-02-11T03:17:05.000Z","updated":"2020-02-11T03:18:15.436Z","comments":true,"path":"/p/pmp-certificate.html","link":"","permalink":"https://dayarch.top/p/pmp-certificate.html","excerpt":"æœ¬å·²å°†PMPè€ƒè¯•è®°å½•åœ¨2019å¹´å¹´ç»ˆæ€»ç»“çš„äº‹ä»¶ä¹‹ä¸€é‡Œäº†ï¼Œæ˜¥èŠ‚æœ‰æœ‹å‹é—®æˆ‘ï¼Œæƒ³è®©æˆ‘åˆ†äº«ä¸€ä¸‹ï¼Œæˆ‘å›æƒ³äº†æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æŒºæœ‰è¶£çš„ï¼Œäºæ˜¯æœ¬æ–‡å°±ä»¥çºªå®çš„å½¢å¼å†™å†™è€ƒPMPçš„é‚£ç‚¹äº‹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ç§èŠï¼Œé¿å…è¯´å¹¿å‘Š PMPï¼ˆProject Management Professionalï¼‰å­¦åã€Œé¡¹ç›®ç®¡ç†ä¸“å®¶ã€ï¼Œæˆ‘å«å®ƒã€Œæ‹é©¬å±ã€ã€‚2019å¹´4æœˆçš„æ—¶å€™åœ¨æœ‹å‹åœˆçœ‹åˆ°æœ‰ä¸¤ä½æœ‹å‹å…ˆåã€æ³¨æ„æ˜¯å…ˆåï¼Œæœ‰åŸ‹ä¼ã€‘æ™’å‡ºæ¥PMPçš„è¯ä»¶å‡ºæ¥ï¼Œçœ‹ç€æŒºå¥½çœ‹çš„ï¼ˆæ–‡æœ«æœ‰ï¼Œè¿˜æ˜¯çºªå¿µç‰ˆï¼Œè¿™ä¸ªç†ç”±å¥½ç‰µå¼ºï¼‰ï¼Œå°±æœæ–­å»éªšæ‰°äº†ä»–ä»¬è¯¢é—®å…·ä½“æƒ…å†µ æœ‹å‹Aï¼šæœ‰çš„å…¬å¸è®¤å¯è¿™ä¸ªè¯ä»¶ï¼Œæ²¡äº‹è€ƒä¸ªè¿˜æŒºæœ‰ç”¨çš„ã€‚ æœ‹å‹Bï¼šè€ƒè¯•é™©è¿‡ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨ï¼Œæœ‰æœ‹å‹è€ƒï¼Œä¸€èµ·è·Ÿç€è€ƒäº† å¿ƒ","text":"æœ¬å·²å°†PMPè€ƒè¯•è®°å½•åœ¨2019å¹´å¹´ç»ˆæ€»ç»“çš„äº‹ä»¶ä¹‹ä¸€é‡Œäº†ï¼Œæ˜¥èŠ‚æœ‰æœ‹å‹é—®æˆ‘ï¼Œæƒ³è®©æˆ‘åˆ†äº«ä¸€ä¸‹ï¼Œæˆ‘å›æƒ³äº†æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æŒºæœ‰è¶£çš„ï¼Œäºæ˜¯æœ¬æ–‡å°±ä»¥çºªå®çš„å½¢å¼å†™å†™è€ƒPMPçš„é‚£ç‚¹äº‹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ç§èŠï¼Œé¿å…è¯´å¹¿å‘Š PMPï¼ˆProject Management Professionalï¼‰å­¦åã€Œé¡¹ç›®ç®¡ç†ä¸“å®¶ã€ï¼Œæˆ‘å«å®ƒã€Œæ‹é©¬å±ã€ã€‚2019å¹´4æœˆçš„æ—¶å€™åœ¨æœ‹å‹åœˆçœ‹åˆ°æœ‰ä¸¤ä½æœ‹å‹å…ˆåã€æ³¨æ„æ˜¯å…ˆåï¼Œæœ‰åŸ‹ä¼ã€‘æ™’å‡ºæ¥PMPçš„è¯ä»¶å‡ºæ¥ï¼Œçœ‹ç€æŒºå¥½çœ‹çš„ï¼ˆæ–‡æœ«æœ‰ï¼Œè¿˜æ˜¯çºªå¿µç‰ˆï¼Œè¿™ä¸ªç†ç”±å¥½ç‰µå¼ºï¼‰ï¼Œå°±æœæ–­å»éªšæ‰°äº†ä»–ä»¬è¯¢é—®å…·ä½“æƒ…å†µ æœ‹å‹Aï¼šæœ‰çš„å…¬å¸è®¤å¯è¿™ä¸ªè¯ä»¶ï¼Œæ²¡äº‹è€ƒä¸ªè¿˜æŒºæœ‰ç”¨çš„ã€‚ æœ‹å‹Bï¼šè€ƒè¯•é™©è¿‡ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨ï¼Œæœ‰æœ‹å‹è€ƒï¼Œä¸€èµ·è·Ÿç€è€ƒäº† å¿ƒæƒ³ï¼Œæ¯•ä¸šåå¥½ä¹…éƒ½æ²¡è€ƒè¿‡è¯•ï¼Œä¸èƒ½è‡ªåºŸæ­¦åŠŸï¼ŒæŠŠä»å°åŸ¹å…»çš„è€ƒè¯•æŠ€èƒ½ï¼ˆè€ƒè¯•åº”è¯¥æ˜¯ä¸­å›½å­©å­çš„ç«¥å­åŠŸå§ï¼‰è’åºŸæ‰ï¼Œå°±è¿™æ ·åœ¨å†…å¿ƒä¸­äº†è¦è€ƒè¿™ä¸ªè¯ä»¶çš„è‰ äººéš¾å…æœ‰å†²åŠ¨å’Œæ‹–å»¶ç—‡ï¼Œæˆ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œè½¬çœ¼é—´æ¥åˆ°äº†8æœˆï¼Œå…¬å¸é£˜æ¥ä¸€å°é‚®ä»¶ï¼Œè€ƒXXè¯ä»¶å¯ä»¥æŠ¥é”€ï¼Œç‚çƒ­çš„å¤å­£æˆ‘ç¬é—´ç²¾ç¥äº†ä¸€ç‚¹ï¼Œæˆ‘æ˜¯ä¸ªä¿—äººï¼Œè€ƒè¯•è´¹ç”¨æŒºè´µçš„ï¼Œå¥½å‡ Kå‘¢ï¼Œæ—¢ç„¶å…¬å¸èƒ½ç»™æŠ¥é”€å¾ˆå¤šï¼Œé‚£å°±ç€æ‰‹å®‰æ’å‘— æˆ‘è¿˜æ˜¯æƒ³çœç‚¹è´¹ç”¨ï¼Œæˆ‘å°±åˆæ‰¾æœ‹å‹Aç¡®è®¤æ˜¯å¦å¯ä»¥è‡ªå­¦ æœ‹å‹Aï¼šèƒ½è‡ªå­¦ï¼Œä½†æ˜¯å¾ˆéš¾ï¼ˆè¿™å¥è¯å¾ˆPMPå“²å­¦å•Šï¼Œåé¢ä½ å°±æ‡‚äº†ï¼‰ æˆ‘å†…å¿ƒå…¶å®æ˜¯æŠµè§¦åŸ¹è®­ç­çš„ï¼Œæ¯”å¦‚å‰æ®µæ—¶é—´é‚£ä¹ˆå¤§çš„XXè‹±è¯­åŸ¹è®­æœºæ„å°±è·‘è·¯äº†ï¼Œæˆ‘å¤©èµ„å’Œèªæ•ä¸æ­è¾¹ï¼Œé‚£å°±æŒºç€æŠ¥ä¸ªåŸ¹è®­ç­å§ï¼Œæ‰¾åˆ°åŸ¹è®­æœºæ„çš„äººï¼Œç›´æ¥å¾®ä¿¡è½¬è´¦å°±æˆäº†ï¼Œè½¬è´¦çš„é‚£ä¸€åˆ»ï¼Œå†…å¿ƒå¼ºçƒˆçš„ç—›äº†ä¸€ä¸‹ è¿™ä¸ªèŠ‚ç‚¹æŠ¥åï¼Œåªèƒ½æŠ¥è€ƒ12æœˆ7å·çš„è€ƒè¯•äº†ï¼ˆåº”è¯¥æ˜¯æ¯å¹´3/6/9/12æœˆä»½éƒ½æœ‰è€ƒè¯•ï¼‰ï¼Œè¢«åŸ¹è®­è€å¸ˆæ‹‰åˆ°ä¸€ä¸ªå¾®ä¿¡ç¾¤ä¸­ï¼ŒæŒ‡å¯¼æˆ‘ä»¬å¦‚ä½•åœ¨PMIç½‘ç«™ä¸Šæ³¨å†ŒæŠ¥åç­‰ï¼Œé’±é‚£ä¹ˆè´µï¼Œå¡«å†™æŠ¥è€ƒä¿¡æ¯å¼‚å¸¸è°¨æ…ï¼Œé«˜è€ƒéƒ½æ˜¯éšä¾¿å¡«çš„ æ²¡å‡ å¤©ï¼Œå°±æ”¶åˆ°äº†åŸ¹è®­æœºæ„å‘æ¥çš„èµ„æ–™ï¼ˆå…¶å®ä¸»è¦æ˜¯ç”µå­ç‰ˆ/çº¸è´¨ç‰ˆçš„ä¹¦ï¼‰ï¼Œä½œä¸ºJavaç¨‹åºå‘˜ï¼Œæˆ‘ä¸€ç›´ä¿ç•™ç€é‚£æœ¬å·²ç»æ³›é»„çš„ç¥ä¹¦ã€ŠJavaç¼–ç¨‹æ€æƒ³ã€‹ï¼Œæˆ‘æŠŠPMPçš„ä¹¦å’Œè¿™æœ¬ä¹¦æ”¾åœ¨ä¸€èµ·å¯¹æ¯”ä¸€ä¸‹è‡ªå·±ä½“ä¼šå§ æœºæ„è€å¸ˆè¯´ï¼šå›½åº†å‡æœŸæœ€å¥½è‡ªå·±ä»å¤´åˆ°å°¾çœ‹ä¸€éï¼Œæœ€å·®ä¹Ÿè¦çœ‹å‰ä¸‰å¼ ï¼Œçœ‹ä¸æ‡‚ä¹Ÿè¦ç¡¬çœ‹ï¼ŒèŠ‚åå°±è¦å»æœºæ„ä¸Šè¯¾äº†ï¼Œè®²è¯¾èŠ‚å¥ä¼šå¾ˆå¿« åŸ¹è®­è´¹æ•™äº†è®©æˆ‘è‡ªå·±å­¦æˆ‘æ˜¯è‚¯å®šä¸å¹²çš„ï¼Œæˆ‘ä¸æ˜¯äºäº†ğŸ˜‚ï¼Œå…¶å®æˆ‘å‡æœŸçœŸçš„ç¡¬ç€å¤´çš®çœ‹äº†ï¼Œå‹‰å¼ºçœ‹å®Œç¬¬ä¸‰ç« ï¼Œä½†æ˜¯åˆ°åº•çœ‹äº†ä¸ªå•¥æˆ‘ä¹Ÿæµ‘ç„¶ä¸çŸ¥ï¼Œæˆ‘çš„å¤©èµ„æœçœŸæ— æƒ…çš„æ‰“æˆ‘ æ€»å…±æœ‰8èŠ‚çº¿ä¸‹è¯¾ç¨‹ï¼Œéƒ½æ˜¯å‘¨å…­å‘¨æ—¥çš„å…¨å¤©è¯¾ç¨‹ï¼Œé‚£æ®µæ—¶é—´é¡¹ç›®è¿˜ç‰¹åˆ«å¿™ï¼Œæœ‰ä¸¤æ¬¡å‘¨æœ«çš„åŠ ç­æˆ‘ä¹Ÿæ²¡æœ‰å»ï¼Œå†…å¿ƒè¿˜æ˜¯å¯¹ä¸ä½æˆ‘ç»„å†…çš„å…„å¼Ÿä»¬çš„ã€‚é‚£æ®µæ—¶é—´çš„èŠ‚å¥ï¼Œç®—æ˜¯9N7ï¼ˆNä¸å›ºå®šï¼‰å§ åŸ¹è®­è¯¾å¦‚æœŸå¼€å§‹ï¼Œæ¯å¤©å†…å®¹å¾ˆæ…¢ï¼ŒåŸ¹è®­è€å¸ˆçš„èƒ½åŠ›ä¸æ˜¯çèƒ¡é—¹çš„ï¼Œæ€»æ˜¯èƒ½å„ç§ç©¿é’ˆå¼•çº¿ï¼Œæ„Ÿè§‰è€å¸ˆéƒ½è¿™æ ·è®²è¯¾ï¼Œå­¦ç”Ÿåº”è¯¥ä¸ä¼šå›°å§ï¼Œåº”å¯¹è€ƒå‰çªå‡»ï¼Œåå‡ èŠ‚è¯¾å°±æ˜¯è¾¹è®²è¯¾è¾¹åšæ¨¡æ‹Ÿé¢˜äº† 12æœˆ7å·ï¼Œè€ƒè¯•ç»ˆäºåˆ°æ¥ï¼Œè¯´è¯´æœ‰å…³è€ƒè¯•ï¼š è€ƒè¯•æ—¶é—´ï¼š9:00amâ€”â€”13:pmï¼Œä¸­é€”æ²¡æœ‰æš‚åœï¼Œé¢˜å‹å…¨éƒ¨æ˜¯å•é¡¹é€‰æ‹©é¢˜ï¼Œæ€»å…±200é“é¢˜ï¼Œè€ƒè¯•åªéœ€è¦å¸¦èº«ä»½è¯ï¼ˆçº¸ï¼Œç¬”ï¼Œè®¡ç®—å™¨ï¼Œæ°´ï¼Œé’Ÿè¡¨ï¼Œè€ƒåœºéƒ½æä¾›ï¼‰ è€ƒè¯•è€ƒé¢˜éå¸¸çµæ´»ï¼Œç®€å•æ¥è¯´ï¼Œå¦‚æœå››ä¸ªé€‰é¡¹éƒ½å¯¹ï¼Œé€‰æ‹©æœ€å¯¹çš„ï¼›å¦‚æœå››ä¸ªé€‰é¡¹éƒ½é”™ï¼Œé€‰é”™æœ€å°‘çš„é‚£ä¸ªï¼Œç»è¿‡å››ä¸ªå°æ—¶çš„ç…ç†¬è‹¦æˆ˜ï¼Œä¸´è¿‘è€ƒè¯•ç»“æŸå‰10åˆ†é’Ÿæ¶‚å®Œç­”é¢˜å¡ï¼Œè€ƒå®Œå®Œå…¨æ‡µé€¼çŠ¶æ€ï¼Œå› ä¸ºæ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œå› ä¸ºå†å±Šè€ƒé¢˜éƒ½ä¸å‘å¸ƒæ ‡å‡†ç­”æ¡ˆï¼Œè€ƒå®Œé¥¿çš„ä¸è¡Œï¼Œå›å®¶ç‹ ç‹ çš„åƒäº†ä¸€é¡¿ï¼Œå…¶ä»–çš„ä¸€åˆ‡å°±çœ‹è¿æ°”å§ ä¸€ä¸ªæœˆåçš„æŸä¸ªæ—©æ™¨ï¼ŒåŸ¹è®­è€å¸ˆçªç„¶åœ¨ç¾¤é‡Œè¯´å¯ä»¥æŸ¥æˆç»©äº†ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯ä¸æ˜¯æ‰€æœ‰è€ƒç”Ÿä¸€ä¸‹éƒ½èƒ½æŸ¥åˆ°æˆç»©ï¼Œè€ƒè¯•æˆç»©åˆ†ä¸€å‘¨æ—¶é—´é™†ç»­å…¨éƒ¨å…¬å¸ƒï¼Œä½ å°±è¯´æœ‰å¤šå˜æ€å§ï¼Œç¾¤é‡Œå…¶ä»–æœ‹å‹å·²ç»å‡ºæˆç»©äº†ï¼Œæˆ‘å¿«æŠŠæ‰‹æœºåˆ·çˆ†ä¹Ÿæ²¡æœ‰å¾—åˆ°æˆ‘çš„æˆç»©ï¼Œå¸¦ç€ææ…Œå’Œæ‹…å¿§å¼€å§‹ç¡è§‰ æ•´å®¿éƒ½åœ¨åšæ¢¦ï¼Œä¸€ä¼šæ²¡è¿‡ï¼Œå“é†’ï¼Œåº†å¹¸è¿™æ˜¯æ¢¦ï¼Œè€ƒè¯•æˆç»©è¿˜æ²¡åˆ°å‘¢ï¼›ä¸€ä¼šè¿‡äº†ï¼Œé«˜å…´çš„é†’äº†ï¼Œé—æ†¾è¿™ä¸ºä»€ä¹ˆæ˜¯ä¸ªæ¢¦ï¼›å¤©è’™è’™äº®ï¼Œå·²å…¨ç„¶æ²¡æœ‰ç¡æ„ï¼Œç¥ˆç¥·å¼ç¿»çœ‹é‚®ä»¶ï¼Œä¸€å°æ–°é‚®ä»¶çš„åˆ°æ¥è®©æˆ‘å¿ƒè·³åŠ å€ï¼ŒCongraâ€¦â€¦ï¼Œç»ˆäºèƒ½è¿‡ä¸ªå¥½å¹´ï¼Œè€ƒè¯•æˆç»©è¿‡äº†ï¼Œè¿˜å¾ˆæ„å¤–ï¼Œå¾—äº†ä¸ª5Aï¼Œè¿˜æ˜¯æ™’ä¸€å¼ å›¾å§ èµ¶ä¸ŠPMPè€ƒè¯•å¤šå°‘å‘¨å¹´ï¼Œè¿™ä¸€ç‰ˆè¯ä¹¦å¾ˆç‰¹åˆ«ï¼Œæ˜¯çº¢è‰²æ»´ï¼Œå…¶ä»–çš„éƒ½æ˜¯è“è‰²çš„ï¼Œhiahia æ•´ä¸ªè¿‡ç¨‹åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥è¯´è¯´æˆ‘å¯¹PMPçš„çœ‹æ³•ï¼š ITè¡Œä¸šç®¡ç†æ¨¡å¼è¶Šæ¥è¶Šæ‰å¹³åŒ–ï¼Œå¾ˆå°‘æœ‰çº¯ç®¡ç†å²—ï¼Œä¹Ÿå¾ˆå°‘æœ‰çº¯æŠ€æœ¯å²—ï¼Œç›¸å¯¹æ¥è¯´æœ‰æŠ€æœ¯çš„ç®¡ç†å²—æ›´å¥½ä¸€äº›ï¼Œå› ä¸ºå¹²ä»€ä¹ˆäº‹å¿ƒä¸­éƒ½æ˜¯æœ‰åº•çš„ PMPè€ƒè¯•æœ¬èº«æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä½†æ˜¯åœ¨æ•´ä¸ªå¤‡è€ƒè¿‡ç¨‹é”»ç‚¼çš„é€»è¾‘æ€ç»´ï¼Œä»¥åŠè¦çŸ­æœŸå†…å­¦ä¹ é‚£ä¹ˆåšä¸€æœ¬ä¹¦çš„å†…å®¹çš„å½’çº³èƒ½åŠ›è¿™äº›è½¯æŠ€èƒ½éƒ½æ˜¯éå¸¸å€¼å¾—å­¦ä¹ çš„ï¼Œå•çº¯ç¼–å†™ä»£ç å¾ˆéš¾å­¦ä¹ åˆ°è¿™æ–¹é¢çš„æŠ€èƒ½ éƒ¨åˆ†å…¬å¸è®¤å¯ï¼Œè¿˜æ˜¯èƒ½åœ¨è–ªæ°´å’Œä¸€äº›å‘å±•ä¸Šå¸¦æ¥ä¸€å®šçš„å¸®åŠ©ï¼Œèƒ½æœ‰å¤šå°‘ï¼Œè¿˜çœ‹è‡ªå·±çš„å®é™…èƒ½åŠ›ï¼Œè€å¸ˆä¹Ÿè¯´ï¼Œæƒ³åšå¥½é¡¹ç›®ç®¡ç†ï¼Œä¸éœéœå‡ ä¸ªé¡¹ç›®ï¼Œå•çº¯è€ƒä¸€ä¸ªè¯å°±æ˜¯çº¸ä¸Šè°ˆå…µï¼Œä»»ä½•é¡¹ç›®è¿‡ç¨‹éƒ½å¾ˆå¤æ‚éš¾åŠ å›çœ‹æ•´ä¸ªè€ƒè¯•ï¼Œå…¶å®éš¾åº¦è§‰å¾—ä¸å¤§ï¼Œæˆ‘ä¹Ÿæ˜¯æƒ³å€Ÿæ­¤æœºä¼šé‡æ‹¾è€ƒè¯•æŠ€èƒ½åŒ…ï¼Œä¸ºæ¥ä¸‹æ¥çš„å‡ ä¸ªè€ƒè¯•è®¤è¯ï¼ŒåŒ…æ‹¬Elastic Search æˆ– AWS åšä¸€äº›é“ºå«ï¼Œæ‰¾æ‰¾æ„Ÿè§‰ï¼Œç®—æ˜¯è€ƒè¯•è¯•æ°´å§ æ¯•ç«Ÿæ˜¯ä¸ºäº†åº”å¯¹è€ƒè¯•æ‹¿ç»“æœï¼Œå¦‚æœæ—¶é—´ä¸å……è£•ï¼Œæ‰¾ä¸ªé è°±çš„åŸ¹è®­æœºæ„è¿˜æ˜¯å€¼å¾—çš„ï¼Œè‡ªå­¦æˆ‘è§‰å¾—æµªè´¹å¾ˆå¤šæ—¶é—´ï¼Œä¸å¦‚å¤šçœ‹çœ‹å…¶ä»–æ–¹ä¾¿çš„ä¸œè¥¿ åˆ°è¿™é‡Œäº†ï¼Œæœ‰å…´è¶£çš„ç§èŠå§ï¼Œæ¯•ç«Ÿæ¯ä¸ªäººçš„æƒ…å†µè¿˜æ˜¯ä¸ä¸€æ ·æ»´","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"å…¶ä»–","slug":"Life/å…¶ä»–","permalink":"https://dayarch.top/categories/Life/%E5%85%B6%E4%BB%96/"}],"tags":[{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://dayarch.top/tags/%E6%80%BB%E7%BB%93/"}]},{"title":"Java 12 æ–°ç‰¹æ€§ä¸€è§ˆ","slug":"Java-12-æ–°ç‰¹æ€§ä¸€è§ˆ","date":"2020-02-10T06:30:27.000Z","updated":"2020-02-10T06:45:45.751Z","comments":true,"path":"/p/jdk12-new-feature-overview.html","link":"","permalink":"https://dayarch.top/p/jdk12-new-feature-overview.html","excerpt":"* ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ * If you can NOT explain it simply, you do NOT understand it well enough ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ æ—¥å¸¸å·¥ä½œå¯¹é›†åˆæ“ä½œçœŸçš„å¤ªé¢‘ç¹äº†ï¼Œå‰ç«¯æ—¶é—´å°±å†™è¿‡ä¸€ç¯‡å…³äºJava 12 é›†åˆçš„æ–‡ç«  Java12 Collectors.teeing çš„ä½¿ç”¨è¯¦è§£ ï¼Œ æœ‰æœ‹å‹ç•™è¨€è¯´è¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒå¥½ç”¨ã€‚ä¸ªäººè§‰å¾— Java12è¿˜æœ‰å‡ ä¸ªç‰¹æ€§å¯ä»¥å°è¯•","text":"ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ If you can NOT explain it simply, you do NOT understand it well enough ç°é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ï¼Œæœ¬æ–‡åŒæ ·æ”¶å½•åœ¨æ­¤ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸ æ—¥å¸¸å·¥ä½œå¯¹é›†åˆæ“ä½œçœŸçš„å¤ªé¢‘ç¹äº†ï¼Œå‰ç«¯æ—¶é—´å°±å†™è¿‡ä¸€ç¯‡å…³äºJava 12 é›†åˆçš„æ–‡ç«  Java12 Collectors.teeing çš„ä½¿ç”¨è¯¦è§£ ï¼Œ æœ‰æœ‹å‹ç•™è¨€è¯´è¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒå¥½ç”¨ã€‚ä¸ªäººè§‰å¾— Java12è¿˜æœ‰å‡ ä¸ªç‰¹æ€§å¯ä»¥å°è¯•ä½¿ç”¨ï¼Œè¿™ç¯‡æ–‡ç« å°±å‡ºç‚‰äº† å¦‚æœä½ ç›®å‰ä½¿ç”¨çš„Javaç‰ˆæœ¬ä¸æ˜¯12ï¼Œä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œæ—©å·²ä¸ºä½ å‡†å¤‡å¥½è‰¯æ–¹ï¼ŒSDKMAN ç»Ÿä¸€çµæ´»ç®¡ç†å¤šç‰ˆæœ¬Java ï¼Œå¯ä»¥è®©ä½ å¿«é€Ÿå„ç§å°é²œæ–°ç‰¹æ€§ String API å˜åŒ–String.indent()indent ã€Œç¼©è¿›ã€è¿™ä¸ªå•è¯å¤§å®¶å¾ˆç†Ÿæ‚‰äº†ï¼Œè¿™æ˜¯Java12å¤„ç†å­—ç¬¦ä¸²çš„æ–°åŠŸèƒ½ï¼Œå…ˆæ¥çœ‹æ–¹æ³•å®šä¹‰ï¼š è¯¥æ–¹æ³•å¾ˆç®€å•ï¼Œåªæ¥æ”¶ä¸€ä¸ª int ç±»å‹çš„å‚æ•°è¡¨ç¤ºç¼©è¿›å€¼ï¼Œè¿™é‡Œçš„ n æ—¢å¯ä»¥æ˜¯æ­£æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼Œåªä¸è¿‡æ˜¯å¢åŠ ç©ºæ ¼ space å’Œç§»é™¤ç©ºæ ¼çš„å·®åˆ«ï¼Œæ¥çœ‹ä¸ªä¾‹å­ï¼š 12String result = \"foo\\nbar\\nbar2\".indent(4);System.out.println(result); æ‰“å°ç»“æœæ˜¯è¿™æ ·çš„ï¼ˆè€ƒéªŒçœ¼åŠ›çš„æ—¶å€™åˆ°äº†ï¼Œä»”ç»†çœ‹æˆªå›¾åœ¨IDEä¸­è®¾ç½®çš„ç¼©è¿›å°ç‚¹ç‚¹ğŸ˜œï¼‰ï¼š è°ƒç”¨ indent æ–¹æ³•ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦å· \\n ï¼Œåœ¨è¯¥æ–¹æ³•çš„å®ç°ä¸­ä¹Ÿæ˜ç¡®ç»™äº†æ³¨é‡Šè¯´æ˜ï¼Œç›®çš„æ˜¯ä¸ºäº†è¡Œç»ˆç»“ç¬¦çš„è§„èŒƒåŒ– æ³¨æ„ï¼šå¯¹äº Tab å°±æ˜¯å½“æˆä¸€ä¸ªå­—ç¬¦æ¥çœ‹åˆ°ï¼Œæ¯”å¦‚æˆ‘ä»¬æŠŠä¸Šé¢çš„ä¾‹å­ç¨ä½œä¿®æ”¹ï¼š 12String result = \"foo\\nbar\\n\\tbar2\".indent(4);System.out.println(result); æ¥çœ‹æ‰“å°ç»“æœï¼Œæ³¨æ„å’Œä¸Šé¢çš„ä¸åŒï¼š å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œæˆ‘ä»¬ç»§ç»­å‘ä¸‹çœ‹ String.transform()transform ã€Œè½¬æ¢ã€ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å­—ç¬¦ä¸²å½¢åŠ¿è½¬æ¢çš„éœ€æ±‚ï¼Œtransformæ–¹æ³•æ¥æ”¶ä¸€ä¸ª Function ç±»å‹çš„å‚æ•°ï¼Œ ç”Ÿæˆä¸€ä¸ªå…¨æ–°å½¢å¼çš„å­—ç¬¦ä¸² 12345678910List&lt;String&gt; names = List.of( \" Alex\", \"brian\");List&lt;String&gt; transformedNames = new ArrayList&lt;&gt;();for (String name : names)&#123; String transformedName = name.transform(String::strip) .transform(StringUtils::toCamelCase); transformedNames.add(transformedName);&#125; æœ‰æœ‹å‹å¯èƒ½ä¼šè¯´ï¼Œè¿™ä¸ªå’Œå•çº¯çš„å¯¹å­—ç¬¦ä¸² trim æˆ–è€…å…¶ä»–æ“ä½œæœ‰ä»€ä¹ˆåŒºåˆ«å•Šï¼Ÿå› ä¸ºæ¥å—çš„å‚æ•°æ˜¯ Functionç±»å‹ï¼Œå½“Functionç±»å‹ä½œä¸ºå…¥å‚æ—¶ï¼Œå†…éƒ¨çš„å¤„ç†é€»è¾‘å°†å¢åŠ æ›´å¤šçµæ´»æ€§ Files.mismatch(Path, Path)æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹æ˜¯å¦ç›¸åŒï¼Œè¿™ä¸ªAPIå°±æ´¾ä¸Šç”¨åœºäº†ï¼Œè¯¥æ–¹æ³•æ¯”è¾ƒä¸¤ä¸ª path ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ª long å€¼ï¼Œè¿™ä¸ªå€¼è¡¨ç¤ºç¬¬ä¸€å¤„ä¸åŒ¹é…çš„å­—èŠ‚ä½ç½®ã€‚å¦‚æœè¿”å›-1ï¼Œè¯´æ˜ä¸¤ä¸ªæ–‡ä»¶ç›¸ç­‰ï¼Œè¿˜æ˜¯æ¥çœ‹ä¸ªä¾‹å­ï¼š 12345678910Path file1 = Paths.get(\"/Users/fraser/Documents/projects/personal/learning-demo-collection/jdk12-demo/src/file1.txt\"); Path file2 = Paths.get(\"/Users/fraser/Documents/projects/personal/learning-demo-collection/jdk12-demo/src/file2.txt\"); try &#123; long mismatch = Files.mismatch(file1, file2); System.out.println(mismatch); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; ä¸¤ä¸ªæ–‡ä»¶å†…å®¹åˆ†åˆ«æ˜¯ï¼š 1234//file1.txtå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ—¥æ‹±ä¸€å…µï¼Œå«æˆ‘æ‹±å“¥å°±å¥½//file2.txtå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ—¥æ‹±ä¸€å…µï¼Œå«æˆ‘å…µå…µå°±å¥½ æŸ¥çœ‹è¿è¡Œç»“æœï¼š å»ºè®®å¤§å®¶æŸ¥çœ‹ä¸€ä¸‹ mismatch çš„å®ç°é€»è¾‘ï¼Œæœ‰ä¸ªå°ç®—æ³•åœ¨é‡Œé¢çš„ Support for Unicode 11 ï¼ˆå½“ä¸ªäº†è§£å°±å¥½äº†ï¼‰å½“ä¸‹ï¼ŒEmoji è¡¨æƒ…ç¬¦å·åœ¨ç¤¾äº¤åª’ä½“æ¸ é“ä¸Šæ‰®æ¼”ç€é‡è¦è§’è‰²ï¼Œæ‰€ä»¥æ”¯æŒæœ€æ–°çš„ Unicode è§„èŒƒæ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´é‡è¦ã€‚Java 12ä¿æŒäº†åŒæ­¥å¹¶æ”¯æŒUnicode 11ã€‚Unicode 11å¢åŠ äº†684ä¸ªå­—ç¬¦ï¼Œå…±137,374ä¸ªå­—ç¬¦ï¼Œå¢åŠ äº†7ä¸ªæ–°è„šæœ¬ï¼Œå…±146ä¸ªè„šæœ¬ã€‚ Switch Expressions(Preview)è¿™ä¸ªæ›´æ”¹æ‰©å±•äº†switchè¯­å¥ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Ÿ è¯­å¥ï¼ˆæˆ‘ä»¬åŸæ¥é‚£æ ·ä½¿ç”¨ï¼‰ è¡¨è¾¾å¼ï¼ˆä¸å¿…ä¸ºæ¯ä¸ªcaseå—å®šä¹‰ä¸€ä¸ªbreakè¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ç®­å¤´è¯­æ³•ï¼‰ å˜é‡èµ‹å€¼ï¼ˆä½¿ç”¨æ–°çš„switchè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†switchè¯­å¥åˆ†é…ç»™ä¸€ä¸ªå˜é‡ï¼‰ 12345678910boolean isWeekend = switch (day) &#123; case MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY -&gt; false; case SATURDAY, SUNDAY -&gt; true; default -&gt; throw new IllegalStateException(\"Illegal day entry :: \" + day);&#125;; System.out.println(isWeekend); æ³¨æ„ï¼š è¦ä½¿ç”¨æ­¤é¢„è§ˆç‰¹æ€§ï¼Œè¯·è®°ä½ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æœŸé—´ä½¿ç”¨-enable-previewæ ‡å¿—æ˜¾å¼åœ°æŒ‡ç¤ºJVMã€‚ Compact Number Formatting (ç´§å‡‘çš„æ•°æ®æ ¼å¼)ç”±ç”¨æˆ·ç•Œé¢æˆ–å‘½ä»¤è¡Œå·¥å…·å‘ˆç°çš„å¤§æ•°å­—æ€»æ˜¯å¾ˆéš¾å±•ç°ã€‚ä½¿ç”¨æ•°å­—çš„ç¼©å†™å½¢å¼åˆ™è¦ç›´è§‚å¾ˆå¤šã€‚å‰ç«¯ä¸ºäº†æ›´æœ‰å¥½çš„æ•°æ®å±•ç°å½¢å¼ï¼Œå¾ˆæ—©å°±æœ‰ç›¸åº”çš„ç»„ä»¶å®ç°äº†ã€‚ç°åœ¨åç«¯å°ä¼™ä¼´ä¹Ÿå¯ä»¥åœ¨java12ä¸­åº”ç”¨è¿™ä¸ªç‰¹æ€§äº† ç´§å‡‘çš„æ•°å­—è¡¨ç¤ºæ›´æ˜“äºé˜…è¯»ï¼Œå¹¶ä¸”åœ¨ä¸ä¸¢å¤±åŸå§‹å«ä¹‰çš„æƒ…å†µä¸‹ï¼Œåœ¨å±å¹•ä¸Šéœ€è¦æ›´å°‘çš„ç©ºé—´ã€‚ ä¾‹å­ï¼š3.6M æ¯” 3,600,000 å®¹æ˜“è¯»å¾—å¤š Java 12 å¼•å…¥äº†ä¸€ä¸ªå«åš NumberFormat.getCompactNumberInstance(Locale, NumberFormat.Style)çš„é™æ€æ–¹æ³•ã€‚ç”¨äºåˆ›å»ºç´§å‡‘æ•°å­—è¡¨ç¤ºå½¢å¼ï¼Œæ¥çœ‹ä¾‹å­ï¼š 1234NumberFormat formatter = NumberFormat.getCompactNumberInstance(Locale.US, NumberFormat.Style.SHORT);String formattedString = formatter.format(25000L);System.out.println(formattedString); æ¥çœ‹è¿è¡Œç»“æœï¼š å¦å¤–ï¼ŒCompactNumberFormat æ˜¯ NumberFormatçš„å­ç±»ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å®ƒçš„å®ä¾‹ï¼ˆå…¶å®å°±æ˜¯æ ¼å¼åŒ–æ ·å¼ç­‰ï¼‰ï¼Œå¾ˆç®€å•ï¼Œè¿™ä¸ªå¤§å®¶è‡ªè¡ŒæŸ¥çœ‹å§ æ€»ç»“Javaè¿‘ä¸¤å¹´å‡çº§çœŸæ˜¯å¤ªå¿«äº†ï¼Œäº†è§£ä¸€äº›æ–°åŠŸèƒ½æ€»æ˜¯æ²¡é”™çš„ï¼Œå¤§å®¶åŠ¨æ‰‹å®è·µè¯•è¯•å§ï¼Œä»¥åé‡åˆ°ç±»ä¼¼çš„éœ€æ±‚è‡³å°‘èƒ½é¿å…æˆ‘ä»¬é‡å¤é€ è½®å­äº†â€¦.. çµé­‚è¿½é—® ä½ ä»¬é¡¹ç›®ä¸­Javaçš„ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ é¡¹ç›®ä¸­ä½ ä¼šæ€æ ·å»ºè®®æŸäº›å·¥å…·çš„å‡çº§ï¼Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://dayarch.top/tags/Java/"}]},{"title":"IntelliJ IDEA HTTP Clienté«˜çº§ä½¿ç”¨è¯¦è§£","slug":"IntelliJ-IDEA-HTTP-Clienté«˜çº§ä½¿ç”¨è¯¦è§£","date":"2020-02-07T02:30:15.000Z","updated":"2020-02-27T00:54:29.557Z","comments":true,"path":"/p/http-client-advanced-usage.html","link":"","permalink":"https://dayarch.top/p/http-client-advanced-usage.html","excerpt":"* ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ * If you can NOT explain it simply, you do NOT understand it well enough é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ æŠ—å‡»ç–«æƒ…ï¼Œåœ¨å®¶åŠå…¬ã€‚å·¥ä½œç…§å¸¸å¹²ï¼Œé¢†å¯¼éœ€è¦å‡ ä¸ªæ–°åŠŸèƒ½æ¥å£å¼€å‘ã€‚ä»¥å‰åœ¨å…¬å¸åŠå…¬ï¼Œé€šå¸¸å¼€å‘å®Œçš„åŠŸèƒ½æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œæš´éœ²å‡º Swagger æ¥å£æ–‡æ¡£ï¼Œç›´æ¥æ‰¾æ—è¾¹çš„å‰ç«¯å¤§äººè”è°ƒæµ‹è¯•äº† å½“ä¸‹ï¼Œå›åœ¨é•¿æ±Ÿå¤´ï¼Œæˆ‘åœ¨é•¿æ±Ÿå°¾ï¼Œå¤œå¤œæ€å›ä¸æ•¢å‡ºé—¨è§","text":"ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰ä¸¤ä¸ªæ€æƒ³ If you can NOT explain it simply, you do NOT understand it well enough é™†ç»­å°†Demoä»£ç å’ŒæŠ€æœ¯æ–‡ç« æ•´ç†åœ¨ä¸€èµ· Githubå®è·µç²¾é€‰ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»æŸ¥çœ‹ï¼Œè§‰å¾—ä¸é”™ï¼Œè¿˜è¯·StarğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ æŠ—å‡»ç–«æƒ…ï¼Œåœ¨å®¶åŠå…¬ã€‚å·¥ä½œç…§å¸¸å¹²ï¼Œé¢†å¯¼éœ€è¦å‡ ä¸ªæ–°åŠŸèƒ½æ¥å£å¼€å‘ã€‚ä»¥å‰åœ¨å…¬å¸åŠå…¬ï¼Œé€šå¸¸å¼€å‘å®Œçš„åŠŸèƒ½æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œæš´éœ²å‡º Swagger æ¥å£æ–‡æ¡£ï¼Œç›´æ¥æ‰¾æ—è¾¹çš„å‰ç«¯å¤§äººè”è°ƒæµ‹è¯•äº† å½“ä¸‹ï¼Œå›åœ¨é•¿æ±Ÿå¤´ï¼Œæˆ‘åœ¨é•¿æ±Ÿå°¾ï¼Œå¤œå¤œæ€å›ä¸æ•¢å‡ºé—¨è§å›å•Šï¼Œä¸€åˆ‡æµ‹è¯•å…¨äº¤ç»™è‡ªå·±å§ï¼Œ è™½ç„¶æƒ³å¿µå‰ç«¯ï¼Œä½†æ˜¯åœ¨å®¶åŠå…¬ä¹Ÿç»å¯¹æ˜¯å’Œåœ¨å…¬å¸åŠå…¬ä¸€æ ·ä¸€æ ·çš„ï¼Œé«˜æ•ˆä¸ï¼ˆquï¼‰æ‘¸é±¼ æ’æ’­èƒŒæ™¯åœ¨å¤šä¸ªäº§å“çº¿ä¸Šæ¥å›ç©¿åˆ‡æ¢ç€å¼€å‘åŠŸèƒ½ï¼Œä»¥å‰ç”¨Postmançš„åœºæ™¯æ˜¯è¿™æ ·çš„: å®é™…è¿œè¿œä¸æ­¢è¿™å‡ ä¸ªæ–‡ä»¶å¤¹æ¥å½’ç±»å¤šä¸ªäº§å“çº¿çš„æ¥å£ï¼ŒPostmançš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œä½†æ˜¯é¢å¯¹ä»¥ä¸‹è¿™äº›çŠ¶å†µæ—¶ï¼Œæˆ‘è§‰å¾—è°ƒè¯•ä¸€ä¸ªæ¥å£å¤ªéº»çƒ¦äº† ï¼ˆè¿™é‡Œä¸è®¨è®ºå·¥å…·çš„å¥½åï¼Œå·¥å…·æ˜¯å¸®åŠ©æˆ‘ä»¬æé«˜æ•ˆç‡çš„ï¼Œæ¯ä¸ªäººçš„éœ€æ±‚ä¹Ÿä¸ä¸€æ ·ï¼Œæˆ‘åªè¯´æ˜æˆ‘ä¸ªäººé‡åˆ°çš„ä¸€äº›æƒ…å†µï¼Œä¸å–œè¯·å‹¿å–·ï¼‰ æŸ¥æ‰¾é…ç½®å¤šæ•°è¦é€šè¿‡é¼ æ ‡ç‚¹æ¥ç‚¹å», ä¸ä¹ æƒ¯æ–‡æœ¬å’Œå¿«æ·é”®æ“ä½œçš„ä¾¿æ·æ–¹å¼è¿èƒŒ è°ƒè¯•åˆ«äººæ¥å£è¦å¯¼å…¥ä»–ä»¬çš„ä¸€äº›æ•°æ®ï¼Œæ¯”è¾ƒéº»çƒ¦ å¤šä¸ªäº§å“çº¿ç¯å¢ƒå˜é‡æŸ¥çœ‹ä¸ç›´è§‚ å†™å®Œæ¥å£è¦æ¥å›åˆ‡æ¢åº”ç”¨è¿›è¡Œæµ‹è¯•ï¼Œæ¯”å¦‚ï¼ˆIDEA &lt;â€”â€”&gt; Postmanï¼‰ å¿«é€Ÿå®šä½æ¥å£æ¯”è¾ƒéº»çƒ¦ â€¦â€¦ æ— æ„é—´å‘ç° IntelliJ IDEA çš„ HTTP Client å·¥å…·åˆšå¥½èƒ½è§£å†³æˆ‘ä¸Šé¢æåˆ°çš„ä¸€äº›é—®é¢˜ï¼Œç®€å•çš„è¯´å°±æ˜¯èƒ½ç›´æ¥åœ¨ IDEA çš„ä»£ç ç¼–è¾‘å™¨ä¸­ åˆ›å»ºï¼Œç¼–è¾‘ï¼Œæ‰§è¡Œ HTTPè¯·æ±‚ï¼Œå°±åƒè¿™æ ·(å¦‚æœä½ å¿ƒåŠ¨äº†ï¼Œè¯·ç»§ç»­å‘ä¸‹çœ‹å§)ï¼š äºæ˜¯ï¼Œå»å®˜ç½‘æŸ¥çœ‹ä¸€ç•ªä½œå‡ºå¦‚ä¸‹æ•´ç†ï¼š èµ°è¿› Http ClientHTTP Client æ˜¯ IDEA é»˜è®¤ç»‘å®šå¥½å¹¶å¯ç”¨çš„æ’ä»¶ï¼Œå¦‚æœä½ é‚£é‡Œæ²¡æœ‰å¯ç”¨ï¼ŒæŒ‰ç…§ä¸‹å›¾å¯ç”¨å°±å¥½ ç‚¹å‡»èœå•ï¼šTools â€” HTTP Client â€” Test RESTful Web Service æ¥ä¸‹æ¥è¿›å…¥ä¸‹é¢çš„ç•Œé¢ï¼š ä¸Šå›¾å·²ç»™å‡ºæç¤ºï¼ŒREST Client æ˜¯è¢«å¼ƒç”¨çš„ï¼Œç‚¹å‡»å³ä¾§çš„ Convert request to new format , è¿›åˆ°ä¸‹é¢ç•Œé¢ï¼š é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªåä¸º rest-api.http çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶è¢«å­˜å‚¨åœ¨ Scratches æ–‡ä»¶å¤¹ä¸‹ï¼Œä¸ºäº†çªå‡ºä¸»è§’å…‰ç¯ï¼Œå…³äº Scratch Files è¯·å®˜ç½‘è‡ªè¡ŒæŸ¥çœ‹ ï¼ˆç»§ç»­å‘ä¸‹çœ‹ä¸å½±å“ç†è§£çš„ï¼‰ï¼Œé»„è‰²æ¡†çº¿çš„åŠŸèƒ½ä¹Ÿéå¸¸æœ‰ç”¨ï¼Œç»§ç»­å‘ä¸‹çœ‹ åˆ›å»º HTTP request æ–‡ä»¶åˆšåˆšæåˆ°çš„ rest-api.http å°±æ˜¯ HTTP request æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼åˆ›å»ºï¼š é€šè¿‡å¿«æ·é”® â‡§âŒ˜N ç„¶åé€‰æ‹© HTTP Request. ï¼ˆæ–‡ä»¶å­˜æ”¾åœ¨Scratches æ–‡ä»¶å¤¹ï¼‰ é€šè¿‡èœå•æ“ä½œ Fileâ€”Newâ€”HTTP Request ï¼ˆæ–‡ä»¶å­˜æ”¾åœ¨æˆ‘ä»¬æŒ‡å®šçš„ç›®å½•ä¸‹ï¼Œå°±å’Œæˆ‘ä»¬å¹³æ—¶åˆ›å»ºclass/packageæ˜¯ä¸€æ ·ä¸€æ ·æ»´ï¼‰ å¦‚æœåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œè¿™é‡Œæ¨èä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥ä½œä¸ºé¡¹ç›®æ–‡ä»¶ï¼Œé€šè¿‡ Git æäº¤åˆ°ä»“åº“ï¼Œå¤§å®¶å…±äº«æ–‡ä»¶ï¼Œå…±åŒç»´æŠ¤æ¥å£è¯·æ±‚æ•°æ®ï¼Œè‡ªç„¶å°±ä¸ä¼šå‡ºç°è°ƒè¯•åˆ«äººæ¥å£è¿˜è¦å¯¼å…¥ä»–äººæ•°æ®çš„æƒ…å†µå•¦ ç¼–è¾‘ HTTP request æ–‡ä»¶æˆ‘ä»¬æ¨¡æ‹Ÿå®é™…é¡¹ç›®ä¸­åœºæ™¯æ¥ç¼–è¾‘æ–‡ä»¶ ç”¨æˆ·ç™»å½•ï¼ŒæˆåŠŸåè·å– Tokenï¼Œé€šå¸¸æ˜¯ POST è¯·æ±‚ ç”¨æˆ·åç»­è®¿é—®è¡Œä¸ºéƒ½è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ç™»å½•æˆåŠŸè¿”å›çš„ Token é€šè¿‡ç‚¹å‡» Add Requestï¼Œé€‰æ‹©ç›¸åº”çš„æ–¹æ³•å°±å¯ä»¥ç¼–å†™å•¦ éƒ½çŸ¥é“ï¼Œé€šå¸¸å†™ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚éœ€è¦å†™å¥½å¤šå†…å®¹ï¼Œè´´å¿ƒçš„ IDEA ç»™æˆ‘ä»¬æä¾›äº†æ¨¡ç‰ˆï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ Examples ä¸­æ‰¾æ¨¡ç‰ˆå°±å¯ä»¥å•¦ï¼Œæ¯”å¦‚æ‰¾ POST è¯·æ±‚çš„æ¨¡ç‰ˆï¼Œé€‰å–åˆé€‚çš„æ‹·è´è¿‡å»å°±å¯ä»¥ï¼Œso easyï½ï½ï½ åˆ°è¿™é‡Œï¼Œå°±å¯ä»¥å‘é€åŸºæœ¬çš„è¯·æ±‚äº†ï¼Œä½†æ˜¯ï¼Œä¸€ä¸ªé¡¹ç›®ä¸­æ¥å£ä¼—å¤šï¼Œå¦‚ä½•å¿«é€Ÿç”Ÿæˆå‚æ•°ï¼Ÿå¦‚ä½•å¿«é€Ÿåˆ‡æ¢ç«¯å£ï¼Ÿå¦‚ä½•è®©ç™»å½•ä¹‹åçš„æ¯ä¸ªè¯·æ±‚è‡ªåŠ¨æºå¸¦æˆåŠŸè¿”å›çš„ Tokenï¼Ÿæˆ‘ä»¬éœ€è¦æ›´é«˜çº§çš„ç©æ³• HTTP Client è¿›é˜¶ç©æ³•ä½¿ç”¨ç¯å¢ƒå˜é‡åœ¨ç¼–å†™HTTPè¯·æ±‚æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å˜é‡å¯¹å…¶å…ƒç´ è¿›è¡Œå‚æ•°åŒ–ã€‚å˜é‡å¯ä»¥ä¿å­˜è¯·æ±‚çš„hostã€portå’Œpathã€æŸ¥è¯¢å‚æ•°æˆ–å€¼ã€è¯·æ±‚å¤´å€¼æˆ–è¯·æ±‚ä½“å€¼ç­‰. ä½¿ç”¨å˜é‡çš„æ–¹å¼éå¸¸ç®€å•ï¼Œå°±ç”¨ä¸¤ä¸ªå¤§æ‹¬å·åŒ…å›´å®šä¹‰å¥½çš„å˜é‡å°±å¯ä»¥äº†ï¼Œå°±åƒè¿™æ ·ï¼š å½“ç„¶æˆ‘ä»¬ä¹Ÿè¦æœ‰åœ°æ–¹å®šä¹‰å˜é‡ å®šä¹‰ç¯å¢ƒå˜é‡ç¯å¢ƒå˜é‡éœ€è¦å®šä¹‰åœ¨ç¯å¢ƒæ–‡ä»¶ä¸­ï¼Œç¯å¢ƒæ–‡ä»¶æœ‰ä¸¤ç§ï¼š åˆ›å»ºåä¸º rest-client.env.json æˆ–è€… http-client.env.json çš„ç¯å¢ƒæ–‡ä»¶(å…¶å®é‡Œé¢å°±æ˜¯ä¿å­˜ JSON æ•°æ®)ï¼Œè¯¥æ–‡ä»¶é‡Œå¯ä»¥å®šä¹‰ç”¨åœ¨æ•´ä¸ªé¡¹ç›®ä¸Šçš„æ‰€æœ‰å¸¸è§„å˜é‡ åˆ›å»ºåä¸ºrest-client.private.env.json æˆ–è€… http-client.private.env.jsonï¼Œ çœ‹æ–‡ä»¶åä½ åº”è¯¥ä¹ŸçŒœåˆ°è¿™æ˜¯ä¿å­˜æ•æ„Ÿæ•°æ®çš„ï¼Œæ¯”å¦‚å¯†ç ï¼Œtokenç­‰ï¼Œè¯¥æ–‡ä»¶é»˜è®¤æ˜¯è¢«åŠ å…¥åˆ° VCS çš„ ignoreæ–‡ä»¶ä¸­çš„ï¼ŒåŒæ—¶ä¼˜å…ˆçº§é«˜äºå…¶ä»–ç¯å¢ƒæ–‡ä»¶ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥æ–‡ä»¶çš„å˜é‡ä¼šè¦†ç›–å…¶ä»–ç¯å¢ƒæ–‡ä»¶ä¸­çš„å˜é‡å€¼ é‡Œé¢çš„æ–‡ä»¶å†…å®¹å°±åƒè¿™æ · 1234567891011121314&#123; \"dev\": &#123; \"host\": \"localhost\", \"port\": 8081, \"identifier\": \"tanrgyb\", \"password\": \"iloveu\" &#125;, \"prod\": &#123; \"host\": \"dayarch.top\", \"port\": 8080, \"identifier\": \"admin\", \"password\": \"admin\" &#125;&#125; è¿è¡Œä¸€ä¸‹æˆ‘ä»¬ç¼–å†™çš„è¯·æ±‚å§ï¼š IDEAè‡ªåŠ¨è¯†åˆ«å¤šä¸ªç¯å¢ƒï¼Œè¿™æ ·å°±å¯ä»¥è½»è€Œæ˜“ä¸¾çš„åˆ‡æ¢ç¯å¢ƒï¼Œä½¿ç”¨ä¸åŒçš„å˜é‡å€¼äº†ï¼ˆè¿™çš®é‹ï¼Œä½ è¯´äº®ä¸äº®ï¼Œè¿˜æœ‰æ›´äº®çš„ï¼‰ å·§ç”¨ response handler è„šæœ¬ä¸Šé¢æåˆ°ï¼Œæˆ‘ä»¬è¦è®©ç™»å½•æˆåŠŸåçš„æ‰€æœ‰è¯·æ±‚éƒ½è‡ªåŠ¨æºå¸¦æˆåŠŸè¿”å›çš„ Tokenï¼Œè¿™æ ·ä¸ç”¨æˆ‘ä»¬æ¯æ¬¡éƒ½æ‰‹åŠ¨å°†å…¶æ·»åŠ åˆ°headerä¸­ï¼ŒåŒæ ·æœ‰ä¸¤ç§æ–¹å¼å°†è„šæœ¬æ’å…¥åˆ°è¯·æ±‚ä¸­ å†…åµŒæ–¹å¼ 12345GET host/api/test&gt; &#123;%response è„šæœ¬%&#125; å¤–éƒ¨æ–‡ä»¶æ–¹å¼ï¼ˆå°±æ˜¯å°†å†…åµŒçš„è„šæœ¬æŠ½ç¦»å‡ºåˆ°æ–‡ä»¶ä¸­ï¼‰ 123GET host/api/test&gt; scripts/my-script.js ä»¥ç™»å½•è¿”å›è·å–çš„tokenè®¾ç½®åˆ°å˜é‡ä¸­ä¸ºä¾‹ï¼Œçœ‹ä»£ç ï¼š 1234567POST http://&#123;&#123;host&#125;&#125;:&#123;&#123;port&#125;&#125;/loginContent-Type: application/jsonAccept: application/json&gt; &#123;%client.global.set(\"auth_token\", response.body.result.token); %&#125; æ³¨æ„response.body.result.token æ˜¯æˆ‘æŒ‰ç…§æˆ‘ç™»å½•è¿”å›çš„æ•°æ®ç»“æ„å†™çš„ï¼Œä¸åŒç»“æ„ä¸ä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥æ˜¯è¿™æ ·çš„ response.body.token , response.body ä¹‹åæ ¹æ®ä½ çš„æ•°æ®ç»“æ„å‘æŒ¥å§ æˆ‘è¿˜æ˜¯ä¸æ”¾å¿ƒï¼ŒæŠŠæˆ‘çš„ç™»å½•è¿”å›ç»“æ„ï¼ˆé¡¹ç›®ä¸­æ€æ ·è®¾è®¡è¿™ç§ç»“æ„ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰å†™çš„Springbootè¿”å›ç»Ÿä¸€JSONæ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ )ç²˜è´´åœ¨æ­¤å¤„å§ï¼Œè¿™å›ç†è§£äº†å§ï¼Ÿ æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„åœ¨å…¶ä»–è¯·æ±‚ä¸Šæºå¸¦è¿™ä¸ª Token äº† æ³¨æ„è¿™é‡Œçš„Authorization ç±»å‹ï¼Œå¤§å®¶æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µåšä¿®æ”¹ï¼Œæ¯”å¦‚ï¼šAuthorization: Bearer ä»¥ä¸Šè¿™äº›å·²ç»æ»¡è¶³æˆ‘çš„æ—¥å¸¸ä½¿ç”¨ï¼Œæ²¡æœ‰è¿›ä¸€æ­¥äº†è§£æ›´å¤šï¼Œæ›´å¤šå…³äº Response è„šæœ¬çš„ç”¨æ³•è¯·å¤§å®¶æŸ¥çœ‹å®˜ç½‘ HTTP Response referenceå§ ä½ ä»¥ä¸ºåˆ°è¿™é‡Œç»“æŸäº†ï¼ˆOMGï¼‰ï¼Œè¿˜æœ‰é¦™æ–™éœ€è¦å’Œå¤§å®¶åˆ†äº«ï¼Œæ­é…ä¸Šé¢åŠŸèƒ½ä½¿ç”¨æ›´æ£’å“¦ è¾…åŠ©åŠŸèƒ½è¯´æ˜RestfulToolkitRestfulToolkit åŒæ ·æ˜¯ä¸ªæ’ä»¶ï¼Œåœ¨æ’ä»¶å¸‚åœºæœç´¢å®‰è£…å³å¯ å®‰è£…äº†è¿™ä¸ªæ’ä»¶åï¼Œæ‰“å¼€ä¾§è¾¹æ ï¼Œé¡¹ç›®çš„æ‰€æœ‰æ¥å£ä¿¡æ¯éƒ½ä¼šå±•ç°åœ¨æ­¤å¤„ï¼š æˆ‘å¸¸ç”¨çš„åŠŸèƒ½å°±æ˜¯æŠŠæŒ‡å®šæ¥å£ç”Ÿæˆçš„JSONæ•°æ®æ‹·è´åˆ° HTTP request æ–‡ä»¶ä¸­ï¼Œå…å»æ‰‹å†™çš„éº»çƒ¦äº†ï¼Œä½ è¯´æ–¹ä¾¿ä¸ï¼Ÿ é™¤æ­¤ä¹‹å¤–ï¼Œä½¿ç”¨å¿«æ·é”® cmd+\\, å¯ä»¥æ ¹æ®å…³é”®å­—å¿«é€Ÿæ‰¾åˆ°æ¥å£ï¼Œå›è½¦è¿…é€Ÿåˆ°è¾¾ä»£ç æ¥å£ä½ç½®ï¼Œè¿™ä¹Ÿæ˜¯å¸¦æ¥äº†æå¤§çš„ä¾¿åˆ© Live Templateé¡¹ç›®ä¸­è¯·æ±‚å†…å®¹å„æœ‰ä¸åŒï¼ŒIDEAæ ‡å‡†æä¾›çš„GET POST è¯·æ±‚æ¡ˆä¾‹å¯èƒ½è¿˜ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ Live Template å®šåˆ¶è‡ªå·±çš„æ¨¡ç‰ˆï¼Œè¿…é€Ÿç”Ÿæˆrequest å†…å®¹ï¼Œåƒè¿™æ ·ï¼š JSON ViewerJSON Vieweræ˜¯ä¸€æ¬¾ Chromeæµè§ˆå™¨æ’ä»¶ï¼Œåœ¨æµè§ˆå™¨ Omini-box ä¸­è¾“å…¥ json-viewer + Tab, ç²˜è´´jsonåœ¨æ­¤å¤„ï¼Œå°±å¯ä»¥å¯¹jsonæ•°æ®è¿›è¡Œæ ¼å¼åŒ–äº† æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåœ¨Networkä¸‹åŒå‡»æŸä¸ªHTTPè¯·æ±‚ï¼Œä¼šè‡ªåŠ¨åœ¨ new tabä¸‹æ ¼å¼åŒ–è¿”å›çš„jsonæ•°æ®ï¼Œå…å»äº†ç²˜è´´æ•°æ®ç„¶åæ ¼å¼åŒ–çš„çƒ¦æ¼ å…³äºè‡ªæµ‹æ¥å£çš„å¹²è´§æˆ‘æŠ–çš„å·®ä¸å¤šäº†ï¼ŒæŠ–æŠ–æ›´å¥åº· æ€»ç»“å†æ¬¡é‡ç”³ï¼Œä¸åšå·¥å…·å…šï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ‰¹åˆ¤ä¹‹æ„ï¼Œå·¥å…·åªæ˜¯ä¸ºäº†è®©æˆ‘ä»¬æ›´é«˜æ•ˆçš„å·¥ä½œï¼Œé€‰æ‹©é€‚åˆè‡ªå·±çš„ã€‚ä»ä¸Šé¢çš„ä»‹ç»ä¸­æ¥çœ‹ï¼ŒIDEA HTTP client æ­é…æˆ‘è¯´çš„å‡ ä¸ªè¾…åŠ©åŠŸèƒ½å¾ˆå¥½çš„è§£å†³äº†æ–‡ç« å¼€å¤´è¯´æ˜çš„å‡ ä¸ªé—®é¢˜ï¼Œå¯¹æˆ‘ä¸ªäººæƒ…å†µæ¥è¯´ï¼Œè¶³çŸ£ï¼ï¼ æˆªå›¾ç å­—ä¸æ˜“ å¦‚æœä½ è®¤ä¸ºæœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¿˜è¯·ã€Œåœ¨çœ‹/è½¬å‘/èµã€ï¼ˆè¿™å°±æ˜¯é€æˆ‘çš„å¤§ç«ç®­ğŸš€ï¼Œå¤§è·‘è½¦ğŸš—ï¼Œå¤§ç°æœºâœˆï¸ï¼‰ å¦‚æœä½ è¿˜å‘ç°äº†æ›´å¥½çš„åŠŸèƒ½è¿˜è¯·è¡¥å……åœ¨ç•™è¨€åŒºï¼Œæˆ‘å›å¤´ç»§ç»­è¡¥å……è¿™å—å†…å®¹ï¼Œä¸‡åˆ†æ„Ÿè°¢ å…¬ä¼—å·å›å¤ã€Œå·¥å…·ã€ï¼Œè¿˜æœ‰æ›´ç²¾å½©çš„ç­‰ç€ä½  çµé­‚è¿½é—® Kibanaçš„Dev Toolsç”¨æ¥è°ƒè¯•ESæ¥å£ï¼Œå¯ä»¥å»¶ä¼¸äº†è§£ä¸€ä¸‹ ä½ åœ¨é¡¹ç›®ä¸­å¦‚ä½•é«˜æ•ˆæµ‹è¯•æ¥å£ä¸è”è°ƒçš„å‘¢ï¼Ÿè¿˜è¯·å¤§æ–¹èµæ•™ åœ¨å®¶åŠå…¬å’Œå…¬å¸åŠå…¬å¯¹ä½ æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ å‚è€ƒ Testing RESTful web services","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"IntelliJ IDEA","slug":"IntelliJ-IDEA","permalink":"https://dayarch.top/tags/IntelliJ-IDEA/"}]},{"title":"è¯»ã€ŠClean Code ä»£ç æ•´æ´ä¹‹é“ã€‹ä¹‹æ„Ÿæ‚Ÿ","slug":"è¯»ã€ŠClean-Code-ä»£ç ç®€æ´ä¹‹é“ã€‹ä¹‹æ„Ÿæ‚Ÿ","date":"2020-02-05T03:35:46.000Z","updated":"2020-02-07T02:32:22.250Z","comments":true,"path":"/p/book-reviews-clean-code.html","link":"","permalink":"https://dayarch.top/p/book-reviews-clean-code.html","excerpt":"ç›²ç›®è‡ªä¿¡ï¼Œè‡ªè®¤ä¸ºå·²ç»æ•²äº†å‡ å¹´ä»£ç ï¼Œè¿˜çœ‹ä»€ä¹ˆæ•´æ´ä¹‹é“å•Šã€‚æˆ‘é‚£å¯çˆ±çš„ä¹¦æ¶è¯»æ‡‚äº†æˆ‘çš„å¿ƒæ€ï¼Œå¾ˆæ˜äº‹ç†çš„ä¿æŠ¤èµ·æ¥è¿™æœ¬å°å¯çˆ±ï¼Œæœªæ›¾è®©å®ƒä¸æˆ‘ç‰µæ‰‹ æœ€è¿‘é¡¹ç›®ä¸­çš„ bug æœ‰ç‚¹å¤šï¼Œæ”¹åŠ¨ä»£ç ååˆ†åƒåŠ›ï¼Œæ¯çœ‹ä¸€è¡Œä»£ç éƒ½å¸¦ä¸€å¥â€œè¿™æ˜¯ä»€ä¹ˆXXä»£ç å•Šï¼ŒçœŸXXéš¾æ”¹â€ï¼Œè¿™æ ·æŒç»­äº†å¥½å‡ å¤©ï¼Œæœ‰å¤©æ™šä¸Šååœ¨ä¹¦æˆ¿å›æƒ³è¿™å‡ å¤©å‘ç”Ÿçš„ä¸€åˆ‡ï¼Œä»°å¤´å®šç›æ€è€ƒï¼Œæˆ‘ç»ˆäºå’Œå®ƒé‡æ–°ç¡®è®¤äº†çœ¼ç¥ğŸ’— è‚¡ç¥¨è§æ¶¨ä½ çŸ¥é“ä¹°äº†, æ±½è½¦æ’å¢™çŸ¥é“æ‹äº†, å­©å­æ­»äº†ä½ æ¥å¥¶äº†, å¤§é¼»æ¶•åˆ°å˜´ä½ çŸ¥é“ç”©äº†, bugéš¾æ”¹çŸ¥é“æ„¤æ…¨äº† é©¬ä¸Šç¿»å¼€ä¹¦ï¼Œå‰è¨€ç« èŠ‚ï¼Œæ˜ å…¥çœ¼å¸˜çš„å°±æ˜¯ä¸‹é¢è¿™ä¸€å¼ å›¾ ä»£ç è´¨é‡çš„å”¯ä¸€æœ‰æ•ˆåº¦é‡æ˜¯ï¼šWTFsï¼ˆwhat the fuckï¼‰/minute çœŸçš„å¤ª","text":"ç›²ç›®è‡ªä¿¡ï¼Œè‡ªè®¤ä¸ºå·²ç»æ•²äº†å‡ å¹´ä»£ç ï¼Œè¿˜çœ‹ä»€ä¹ˆæ•´æ´ä¹‹é“å•Šã€‚æˆ‘é‚£å¯çˆ±çš„ä¹¦æ¶è¯»æ‡‚äº†æˆ‘çš„å¿ƒæ€ï¼Œå¾ˆæ˜äº‹ç†çš„ä¿æŠ¤èµ·æ¥è¿™æœ¬å°å¯çˆ±ï¼Œæœªæ›¾è®©å®ƒä¸æˆ‘ç‰µæ‰‹ æœ€è¿‘é¡¹ç›®ä¸­çš„ bug æœ‰ç‚¹å¤šï¼Œæ”¹åŠ¨ä»£ç ååˆ†åƒåŠ›ï¼Œæ¯çœ‹ä¸€è¡Œä»£ç éƒ½å¸¦ä¸€å¥â€œè¿™æ˜¯ä»€ä¹ˆXXä»£ç å•Šï¼ŒçœŸXXéš¾æ”¹â€ï¼Œè¿™æ ·æŒç»­äº†å¥½å‡ å¤©ï¼Œæœ‰å¤©æ™šä¸Šååœ¨ä¹¦æˆ¿å›æƒ³è¿™å‡ å¤©å‘ç”Ÿçš„ä¸€åˆ‡ï¼Œä»°å¤´å®šç›æ€è€ƒï¼Œæˆ‘ç»ˆäºå’Œå®ƒé‡æ–°ç¡®è®¤äº†çœ¼ç¥ğŸ’— è‚¡ç¥¨è§æ¶¨ä½ çŸ¥é“ä¹°äº†, æ±½è½¦æ’å¢™çŸ¥é“æ‹äº†, å­©å­æ­»äº†ä½ æ¥å¥¶äº†, å¤§é¼»æ¶•åˆ°å˜´ä½ çŸ¥é“ç”©äº†, bugéš¾æ”¹çŸ¥é“æ„¤æ…¨äº† é©¬ä¸Šç¿»å¼€ä¹¦ï¼Œå‰è¨€ç« èŠ‚ï¼Œæ˜ å…¥çœ¼å¸˜çš„å°±æ˜¯ä¸‹é¢è¿™ä¸€å¼ å›¾ ä»£ç è´¨é‡çš„å”¯ä¸€æœ‰æ•ˆåº¦é‡æ˜¯ï¼šWTFsï¼ˆwhat the fuckï¼‰/minute çœŸçš„å¤ªç²¾è¾Ÿäº†ï¼Œè¿™ä¸å°±æ˜¯è¿™å‡ å¤©æˆ‘ç™½å¤©ç»å†çš„å—ï¼Ÿä»£ç å·²ç„¶æ˜¯ bad code äº†ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆé¢å¯¹è¿™ç§æƒ…å†µå‘¢ï¼Ÿ æ¯ä¸ªå…¬å¸çš„è§„èŒƒè¿˜ä¸ä¸€æ ·ï¼Œæœ¬æ–‡æ˜¯è¯»ä¹¦ç¬”è®°ï¼Œä¸ä¼šè¯´æ˜å¤ªå¤šçš„ä»£ç è§„èŒƒï¼Œåªæ˜¯é˜æ˜æˆ‘ä»¬åº”è¯¥æ€æ ·åšæˆ–è€…æŠ±ç€ä»€ä¹ˆæ ·çš„å¿ƒæ€æ¥å†™ä»£ç å§ å¦‚æœä½ çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘è¦å¼•ç”¨ä¹¦ä¸­çš„ä¸€å¥è¯ï¼š ç¬¬ä¸€ï¼Œä½ æ˜¯ä¸ªç¨‹åºå‘˜ï¼›ç¬¬äºŒï¼›ä½ æƒ³æˆä¸ºæ›´å¥½çš„ç¨‹åºå‘˜ã€‚æˆ‘ä»¬éœ€è¦æ›´å¥½çš„ç¨‹åºå‘˜ ä¸“ä¸šçš„æ€åº¦åšå›½å†…é¡¹ç›®/äº§å“ï¼Œé€šå¸¸éƒ½æ˜¯æŒ‡æ˜deadlineçš„ï¼Œä½†æ˜¯æˆªæ­¢åˆ°deadlineä¹‹å‰ï¼Œéœ€æ±‚é‡çš„å¤šå°‘æ˜¯ä¸å›ºå®šçš„ï¼Œè¯´ç™½äº†æ˜¯â€œä»¥deadlineä¸å˜åº”éœ€æ±‚ä¸‡å˜â€ï¼Œç¾å…¶åæ›°ã€Œæ•æ·ã€ æˆ‘ä»¬ç»å¸¸è¦é¢å¯¹çŸ­æœŸå†…å¼€å‘å‡ºå¤§é‡éœ€æ±‚çš„è¯·æ±‚ï¼Œå¾ˆå¯èƒ½ä¸ºäº†å¿«é€Ÿå®Œæˆè¿™äº›éœ€æ±‚ï¼Œèƒ¡ä¹±çš„å †å ä»£ç ï¼Œä¸Šçº¿ä¹‹åä¸€å£°é•¿å¹åº†å¹¸è¿™ä¸ªåŠŸèƒ½å¼€å‘çš„ç»“æŸã€‚è¿‡äº†å¥½ä¹…ï¼Œæœ‰å…³è¿™ä¸ªåŠŸèƒ½çš„éœ€æ±‚æœ‰æ‰€å˜åŒ–ï¼Œé‡æ–°æŸ¥çœ‹ä»£ç æ—¶ï¼Œç›´æ¥å°± WTF äº†â€¦â€¦ï¼Œå†ä¸€çœ‹æ˜¯è‡ªå·±å†™çš„ï¼Œä½ è¯´å°´å°¬ä¸ï¼Ÿ å¦‚æœæ˜¯å› ä¸ºä»»åŠ¡å¤šèƒ¡ä¹±å åŠ ä»£ç ï¼Œæˆ‘ä»¬å°±åº”è¯¥åœ¨æ¥å—éœ€æ±‚çš„æ—¶å€™æå‡ºæˆ‘ä»¬çš„çœ‹æ³•ï¼š è¿‡å¤šçš„éœ€æ±‚åœ¨çŸ­æœŸå†…ä¸Šçº¿çš„ä»£ç è´¨é‡ä¸èƒ½å¾—åˆ°ä¿è¯ å‡å¦‚ä½ æ˜¯åŒ»ç”Ÿï¼Œç—…äººè¦æ±‚ä½ ä¸ç”¨æ´—æ‰‹å°±å¯ä»¥ç»™ä»–åšæ‰‹æœ¯ï¼Œå› ä¸ºæ´—æ‰‹æµªè´¹æ—¶é—´ï¼Œä½ ä¼šç­”åº”å—ï¼ŸåŒ»ç”Ÿç»å¯¹ä¼šæ‹’ç»ï¼Œå› ä¸ºä½ æ¯”ç—…äººæ›´äº†è§£ç–¾ç—…å’Œæ„ŸæŸ“çš„é£é™©ã€‚å¦‚æœåŒ»ç”Ÿç…§åšï¼Œé‚£æ˜¯ç»å¯¹ä¸ä¸“ä¸šçš„åšæ³• ä½œä¸ºç¨‹åºå‘˜ï¼Œå¦‚æœéµä»äº†ä¸äº†è§£æ··ä¹±é£é™©ç»ç†çš„æ„æ„¿ï¼Œä¹Ÿæ˜¯ä¸ä¸“ä¸šçš„åšæ³• â€œä½ ä»¥ä¸ºå¯ä»¥ä¸å¬ç»ç†çš„ï¼Ÿä¸å¬ç»ç†çš„ï¼Œæ˜¯ä¼šè¢«ç‚’é±¿é±¼çš„â€ï¼Œç»ç†èƒ½å¦å¬çš„è¿›å»ï¼Œæˆ‘ä»¬éƒ½è¦æå‡ºæˆ‘ä»¬çš„çœ‹æ³•ã€‚æå‡ºå¤šæ¬¡è¿˜è¢«æ— è§†ï¼Œä¹Ÿä¸è¦ç°å¿ƒä¸§æ°”ï¼Œç»§ç»­æå‡ºæˆ‘ä»¬ä¸“ä¸šçš„çœ‹æ³•â€¦ untile die, ä¸ºäº†éƒ¨è½ å¦‚æœä½ æœ‰åº•çº¿ï¼Œå®ˆä½å°±å¥½ï¼›å¦‚æœæ²¡æœ‰ï¼Œé€‚åº”å°±å¥½ã€‚åªä¸ºå¾ˆä¹…ä¹‹åçœ‹åˆ°ä»£ç è¯´ WTF æ—¶ï¼Œé¿å…ä¸»è§’æ˜¯è‡ªå·±çš„å°´å°¬ æˆ‘ä»¬æ˜¯ä½œè€…Javadoc ä¸­çš„@authorå­—æ®µå‘Šè¯‰æˆ‘ä»¬è‡ªå·±æ˜¯ä»€ä¹ˆèº«ä»½ï¼Œæˆ‘ä»¬æ˜¯ä½œè€…ã€‚å¦‚æœç±»ä¸Šæ²¡æœ‰æ ‡æ³¨æ—¥æœŸå’Œä½œè€…ï¼Œalibabaä»£ç æ£€æŸ¥å·¥å…·ä¼šç»™å‡ºæç¤ºï¼Œå°±åƒè¿™æ ·ï¼š è¿™é‡Œå»ºè®®å¤§å®¶åœ¨ IDE ä¸­å®‰è£…è¯¥æ’ä»¶ï¼Œå¦‚æœä½ ä¸çŸ¥é“ä½œä¸ºä½œè€…åº”æœ‰çš„è§„èŒƒï¼Œé‚£å°±è®©è¿™ä¸ªæ’ä»¶è¾…åŠ©ä½ å§ æ®ç»Ÿè®¡ï¼Œè¯»ä»£ç ä¸å†™ä»£ç èŠ±è´¹çš„æ—¶é—´æ¯”ä¾‹è¶…è¿‡ 10:1ï¼Œ å› ä¸ºæˆ‘ä»¬åœ¨å†™æ–°ä»£ç æ—¶ä¼šä¸€ç›´åœ¨è¯»æ—§ä»£ç ï¼Œé¡¹ç›®è¶Šåˆ°åæœŸè¿™ä¸ªæ¯”ä¾‹è¶Šæ˜æ˜¾ æˆ‘ä»¬æ˜¯ä½œè€…ï¼Œå°±æœ‰è´£ä»»å’Œè¯»è€…åšå¥½æ²Ÿé€šã€‚æ¯æ¬¡å†™ä»£ç çš„æ—¶å€™ï¼Œè®°å¾—è‡ªå·±æ˜¯ä½œè€…ï¼Œè¦ä¸ºè¯„åˆ¤ä½ å·¥ä½œçš„è¯»è€…å†™ä»£ç . è¿™äº›è¯»è€…å¯èƒ½æ˜¯ä½ ç°åœ¨ç»„å†…çš„ä¼™ä¼´ï¼Œä¹Ÿå¯èƒ½æ˜¯å°†æ¥è¦æ¥ç®¡ä½ çš„ä»»åŠ¡çš„æ–°ä¼™ä¼´ï¼Œé¿å…åˆ«äººå˜´é‡Œ WTF çš„ä¸»è§’æ˜¯ä½ ï¼Œå®šæœŸ Review è‡ªå·±çš„ä»£ç ï¼Œä½ å®šä¼šå‘ç°å¯ä»¥æ”¹å–„çš„åœ°æ–¹ï¼Œæ¯”å¦‚ç”¨ç­–ç•¥æ¨¡å¼æ›´æ”¹è¿‡å¤šçš„ if elseç­‰ï¼Œä»£ç æ•´æ´äº†ï¼Œåˆå­¦ä¼šäº†è®¾è®¡æ¨¡å¼ï¼Œå²‚ä¸æ˜¯ä¸¤å…¨å…¶ç¾ å¿ƒæœ‰ä½™ï¼ŒåŠ›è¦è¶³å¾ˆå¤šæœ‹å‹è¯´ï¼Œæˆ‘ä¹Ÿæƒ³å†™å‡ºæ•´æ´çš„ä»£ç ï¼Œä½†æ˜¯ç›®å‰å®åŠ›ä¸å…è®¸å•Šã€‚ å†™å‡ºæ•´æ´çš„ä»£ç çš„åŠŸåŠ›ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œéœ€è¦æŒç»­ä¸æ–­çš„å­¦ä¹ å’Œä¿®æ­£ å­¦ä¼šè®¾è®¡æ¨¡å¼ï¼Œäº†è§£ RESTful æ¥å£è§„èŒƒï¼Œäº†è§£å‘½åè§„èŒƒï¼Œæ³¨é‡Šï¼Œå‡½æ•°å¤§å°ç­‰ç­‰å¤ªå¤šçš„ä¸œè¥¿éƒ½æ˜¯ä¹¦å†™å‡ºæ•´æ´ä»£ç å¿…ä¸å¯å°‘çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ è¿˜è®°å¾—å°æ—¶å€™å†™ä½œæ–‡çš„è¯è—»ä¸å¤Ÿç”¨ï¼Œè€å¸ˆè®©æ‘˜æŠ„å¥½æ–‡å¥½å¥ã€‚å¦‚æœç¨‹åºå†™çš„ä¸å¤Ÿæ•´æ´ï¼Œæˆ‘ä»¬å¯ä»¥æ…¢æ…¢å­¦ä¹ å’Œæ¨¡ä»¿å¥½çš„å†™æ³•ä¸è®¾è®¡ï¼Œæ…¢æ…¢æ”¹å–„å’Œç§¯ç´¯ï¼Œæœ‰æœä¸€æ—¥è‚¯å®šèƒ½å†™å‡ºé«˜åˆ†ä½œæ–‡çš„ ä¸åšç ´çª—æ•ˆåº”ç¬¬ä¸€äººä¸è¦è¯´ç°åœ¨çš„ä»£ç å¾ˆçƒ‚äº†ï¼Œæ²¡å¿…è¦å†æ”¹å–„äº†ï¼Œå¦‚æœä½ æ˜¯è¿™æ ·çš„å¿ƒæ€ï¼Œå³ä¾¿ä¸€ä¸ªå…¨æ–°çš„é¡¹ç›®å¼€å§‹è®©ä½ å»åšï¼Œä½ ä¹Ÿå¾ˆå¯èƒ½ä¼šæˆä¸ºç¬¬ä¸€ä¸ªæ‰“ç¢ç»ç’ƒï¼Œå¸¦æ¥ç ´çª—æ•ˆåº”çš„äººã€‚ å¦‚æœä¸¥é‡ä¸€ç‚¹è¯´ï¼Œå¤§å®¶éƒ½çŸ¥é“ä½ å†™çš„ä»£ç å¸¦ç»™åˆ«äººçš„æ˜¯ä¸€ç§è´Ÿæ‹…ï¼Œä½ å¯èƒ½å¾ˆéš¾æœ‰å¼€å§‹ä¸€ä¸ªå…¨æ–°é¡¹ç›®çš„æœºä¼šäº† å¦‚æœåŒäº‹å› æ”¹å–„ä½ çš„ä»£ç å¸¦æ¥äº†ä¸€äº›æ„å¤–çš„å½±å“ï¼Œè¯·ä½ ä¸è¦æŠ±æ€¨ç”©é”…ï¼Œè¿™äº›æ”¹å–„å°±æ˜¯ä¿®å¤ç»ç’ƒçš„å¼€å§‹ï¼Œç»ˆå°†ä¼šç»™å›¢é˜Ÿå¸¦æ¥æå¤§çš„å¥½å¤„ æ€»ç»“ç¼–å†™æ•´æ´ä»£ç çš„è·¯é€”æ¼«æ¼«ï¼Œæˆ‘ä»¬ä¸€èµ·æ±‚ç´¢ï¼Œæ¨èå¤§å®¶çœ‹ä¸‹é¢è¿™ä¸¤æœ¬ä¹¦ï¼Œä½ ä¸€å®šæœ‰æœ‰è‡ªå·±çš„å‘ç°ï¼Œè®©æˆ‘ä»¬æ‚‰å¿ƒç…§æ–™æˆ‘ä»¬å†™çš„æ¯ä¸€è¡Œä»£ç  ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹ ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹ çµé­‚è¿½é—® å·¥ä½œä¸Šä½ æ¥åˆ°è¿‡ä»€ä¹ˆå¥‡è‘©è¦æ±‚ï¼Ÿ å·¥ä½œä¸­é‡åˆ°äº†å“ªäº›æ— å¥ˆæˆ–è€…ä½ è§‰å¾—XXçš„äº‹ï¼Ÿ ä½ æ˜¯æ€ä¹ˆåº”å¯¹é‚£äº›ä¸å¥½çš„é—®é¢˜çš„ï¼Ÿ æ¬¢è¿åœ¨ç•™è¨€åŒºè®¨è®ºï¼Œä½ ä»¬é¡¹ç›®ä¸­çš„æƒ…å†µï¼Œä½ æ˜¯æ€ä¹ˆçœ‹å¾…ä»£ç æ•´æ´è¿™ä¸ªé—®é¢˜çš„","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"Life/è¯»ä¹¦ç¬”è®°","permalink":"https://dayarch.top/categories/Life/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"IntelliJ IDEA","slug":"IntelliJ-IDEA","permalink":"https://dayarch.top/tags/IntelliJ-IDEA/"}]},{"title":"MySQL group_concat å‡½æ•°è¯¦è§£","slug":"Mysql-group-concat-å‡½æ•°è¯¦è§£","date":"2020-02-03T13:03:27.000Z","updated":"2020-02-03T13:14:01.495Z","comments":true,"path":"/p/mysql-group-concat-function-usage.html","link":"","permalink":"https://dayarch.top/p/mysql-group-concat-function-usage.html","excerpt":"ä¸Šä¸€ç¯‡æ–‡ç«  è·¨è¡¨æ›´æ–°ï¼Œçœ‹åˆ°è‡ªå·±å†™çš„SQLåƒä¸ªæ†¨æ†¨ å†™äº†å…³äºè·¨è¡¨ä¸ªæ›´æ–°çš„å†…å®¹ã€‚ä¸€å¹´è¿‡çš„å¾ˆå¿«ï¼Œæ–‡ä¸­åæ¥çš„ä¸¤ä½å‘˜å·¥ é¦®å¤§ å’Œ é¦®äºŒ ä¹Ÿè¦é¢å¯¹æ— æƒ…çš„ KPI è€ƒæ ¸äº†ï¼Œä»–ä»¬å·¥ä½œå¹²çš„å¾ˆä¸é”™ï¼Œperformance åˆ†åˆ«æ˜¯ 4 å’Œ 5 æ–°éœ€æ±‚æ¥äº†ï¼Œé™æ‚„æ‚„çš„æ¥äº†ï¼ï¼ï¼ é¢†å¯¼æƒ³è¦æŸ¥çœ‹æ¯ä¸ª performance ä¸‹éƒ½æœ‰è°ï¼ŒåŒæ—¶è¦æ±‚å°†è¿™äº›äººçš„åç§°è¦é€—å·æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´è¦å¾—åˆ°ä¸‹é¢çš„ç»“æœï¼š è¦å°†ç»“æœé›†ä¸­æŸä¸ªæŒ‡å®šçš„åˆ—è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè¿™è¦æ€ä¹ˆåšå‘¢ï¼Ÿä¸»è§’é—ªäº®âœ¨ç™»åœº GROUP_CONCAT(expr) åœ¨ Mysql å®˜æ–¹æ–‡æ¡£ ä¸­ï¼Œè¯¥å‡½æ•°è¢«æ”¾åœ¨èšåˆå‡½æ•°ç« èŠ‚ï¼Œå¦‚æœä½ è¦æŒ‰ç…§æŒ‡å®šå­—æ®µåˆ†ç»„æ‹¼æ¥ï¼Œå°±è¦é…åˆå…³é”®","text":"ä¸Šä¸€ç¯‡æ–‡ç«  è·¨è¡¨æ›´æ–°ï¼Œçœ‹åˆ°è‡ªå·±å†™çš„SQLåƒä¸ªæ†¨æ†¨ å†™äº†å…³äºè·¨è¡¨ä¸ªæ›´æ–°çš„å†…å®¹ã€‚ä¸€å¹´è¿‡çš„å¾ˆå¿«ï¼Œæ–‡ä¸­åæ¥çš„ä¸¤ä½å‘˜å·¥ é¦®å¤§ å’Œ é¦®äºŒ ä¹Ÿè¦é¢å¯¹æ— æƒ…çš„ KPI è€ƒæ ¸äº†ï¼Œä»–ä»¬å·¥ä½œå¹²çš„å¾ˆä¸é”™ï¼Œperformance åˆ†åˆ«æ˜¯ 4 å’Œ 5 æ–°éœ€æ±‚æ¥äº†ï¼Œé™æ‚„æ‚„çš„æ¥äº†ï¼ï¼ï¼ é¢†å¯¼æƒ³è¦æŸ¥çœ‹æ¯ä¸ª performance ä¸‹éƒ½æœ‰è°ï¼ŒåŒæ—¶è¦æ±‚å°†è¿™äº›äººçš„åç§°è¦é€—å·æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´è¦å¾—åˆ°ä¸‹é¢çš„ç»“æœï¼š è¦å°†ç»“æœé›†ä¸­æŸä¸ªæŒ‡å®šçš„åˆ—è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè¿™è¦æ€ä¹ˆåšå‘¢ï¼Ÿä¸»è§’é—ªäº®âœ¨ç™»åœº GROUP_CONCAT(expr)åœ¨ Mysql å®˜æ–¹æ–‡æ¡£ ä¸­ï¼Œè¯¥å‡½æ•°è¢«æ”¾åœ¨èšåˆå‡½æ•°ç« èŠ‚ï¼Œå¦‚æœä½ è¦æŒ‰ç…§æŒ‡å®šå­—æ®µåˆ†ç»„æ‹¼æ¥ï¼Œå°±è¦é…åˆå…³é”®å­— GROUP BY æ¥ä½¿ç”¨çš„ å®šä¹‰ è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœï¼Œè¯¥å­—ç¬¦ä¸²ç»“æœæ˜¯é€šè¿‡åˆ†ç»„ä¸²è”çš„éNULLå€¼ã€‚å¦‚æœæ²¡æœ‰éNULLå€¼ï¼Œåˆ™è¿”å›NULLã€‚å®Œæ•´è¯­æ³•å¦‚ä¸‹ï¼š 1234GROUP_CONCAT([DISTINCT] expr [,expr ...] [ORDER BY &#123;unsigned_integer | col_name | expr&#125; [ASC | DESC] [,col_name ...]] [SEPARATOR str_val]) What? è¿™ä¸ªè¯­æ³•çœ‹ç€å¤ªå¤æ‚äº†å§ï¼Œåˆ«ç€æ€¥ï¼Œä¸‹é¢ä¼šç”¨ä¾‹å­æ…¢æ…¢è¯´æ˜é€ä¸€éªŒè¯æ»´ ä½¿ç”¨æ¡ˆä¾‹å…ˆå®Œæˆæ–‡ç« å¼€å¤´çš„éœ€æ±‚ï¼š 123SELECT performance, GROUP_CONCAT(employee_name) AS employeesFROM employeesGROUP BY performance; zouæ˜¯è¿™ä¸ªç»“æœï¼š åˆ°è¿™é‡Œï¼Œé¢†å¯¼ç»™è¿‡æ¥çš„éœ€æ±‚å°±å®Œæˆäº†ğŸ˜œ å®¢å®˜è¯·ç•™æ­¥ï¼Œæ‚¨ç‚¹çš„èœè¿˜æ²¡ä¸Šå®Œå‘¢â€¦â€¦ æˆ‘ä»¬æ˜¯å›½é™…åŒ–çš„å›¢é˜Ÿï¼Œæˆ‘ä»¬çš„å®¶ä¹¡éå¸ƒäº”æ¹–å››æµ· é¢†å¯¼æƒ³å…³æ€€ä¸€ä¸‹å‘˜å·¥ï¼Œè¦æŸ¥çœ‹å…¬å¸å…¨éƒ¨å‘˜å·¥çš„å®¶ä¹¡éƒ½æœ‰å“ªäº›åœ°æ–¹ã€‚å‘˜å·¥ä»¬å¯èƒ½æ¥è‡ªåŒä¸€ä¸ªåœ°æ–¹ï¼Œæ‰€ä»¥è¦å°†ç»“æœé›†å»é‡å¤ï¼ŒDISTINCT å…³é”®å­—å°±æ´¾ä¸Šç”¨åœºäº† 12SELECT GROUP_CONCAT(DISTINCT home_town)FROM employees; æ¥çœ‹ç»“æœï¼š é¢†å¯¼çš„å…³æ€€éå¸ƒäº”æ¹–å››æµ·å•Šâ€¦â€¦ æ–‡æ¡ˆè¦æ”¹äº†ï¼Œé¢†å¯¼çš„å…³æ€€æ˜¯éå¸ƒå››æµ·äº”æ¹–çš„, é‚£ä¹ˆ ORDER BY å…³é”®å­—å°±æ´¾ä¸Šç”¨åœºäº† 1234SELECT GROUP_CONCAT(DISTINCT home_town ORDER BY home_town DESC) AS 'é¢†å¯¼å…³æ€€åœ°åŒº'FROM employees;-- æ²¡æˆ‘è¿™ä¹ˆèµ·å˜é‡çš„å“ˆï¼Œè¿˜æ˜¯æ±‰è¯­ï¼Œæˆ‘çœ‹ä½ æ˜¯ç–¯äº† è¿™é‡Œä½ çœ‹åˆ° GROUP_CONCAT å‡½æ•°æ‹¼æ¥å­—ç¬¦ä¸²é»˜è®¤çš„åˆ†éš”ç¬¦æ˜¯é€—å· ,, é¢†å¯¼ä¸å¼€å¿ƒï¼Œé€—å·ä¹ˆçš„æ„Ÿæƒ…ï¼Œè¦ç”¨â•æ‰èƒ½ä½“ç°å‡ºå…³æ€€çš„å¼ºçƒˆï¼Œ SEPARATOR å…³é”®å­—å°±æ´¾ä¸Šç”¨åœºäº† åˆ†ç»„æ‹¼æ¥çš„å€¼ä¹‹é—´é»˜è®¤åˆ†éš”ç¬¦æ˜¯é€—å·ï¼ˆï¼Œï¼‰ã€‚è¦æ˜ç¡®æŒ‡å®šåˆ†éš”ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ SEPARATOR å…³é”®å­—ï¼Œç´§è·Ÿå…¶åçš„æ˜¯ä½ æƒ³è®¾ç½®çš„åˆ†éš”ç¬¦ã€‚è¦å®Œå…¨æ¶ˆé™¤åˆ†éš”ç¬¦ï¼Œå°±åœ¨ SEPARATOR å…³é”®å­—åé¢å†™ â€˜â€™ å°±å¥½äº† 12SELECT GROUP_CONCAT(DISTINCT home_town ORDER BY home_town DESC SEPARATOR '!') AS 'é¢†å¯¼å…³æ€€åœ°åŒº'FROM employees; 12SELECT GROUP_CONCAT(DISTINCT home_town SEPARATOR '') AS 'é¢†å¯¼å…³æ€€åœ°åŒº'FROM employees; è¿™å…³æ€€åˆ°ä½äº†å§ï¼Œä½ å“ï¼Œä½ ç»†å“ï¼ï¼ï¼ é¢†å¯¼çš„å…³æ€€èƒ½åŠ›ä¹Ÿæœ‰é™ï¼Œæ‹¼æ¥çš„å­—ç¬¦ä¸²é»˜è®¤çš„æœ€å¤§é•¿åº¦æ˜¯1024ä¸ªå­—ç¬¦ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢è¯­å¥æŸ¥çœ‹å½“å‰é™åˆ¶æ˜¯å¤šå°‘ï¼š 1show variables like 'group_concat_max_len'; é¢†å¯¼çš„èƒ½åŠ›å¯æ˜¯é£˜å¿½ä¸å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çµæ´»çš„è®¾ç½®è¿™ä¸ªå€¼ 1SET [GLOBAL | SESSION] group_concat_max_len = val; SESSION: åœ¨å½“å‰å¯¹è¯ä¸­ç”Ÿæ•ˆ GLOBALï¼šå…¨å±€éƒ½ç”Ÿæ•ˆ è¯¥è¯­å¥åœ¨æ‰§è¡Œåï¼ŒMySQLé‡å¯ä¹‹å‰ä¸€ç›´æœ‰ä½œç”¨ï¼Œä¸€æ—¦é‡å¯ MySQLï¼Œåˆ™ä¼šæ¢å¤é»˜è®¤å€¼ æœ‰æ—¶å€™ GROUP_CONCAT() è¿˜è¦æ­é… CONCAT_WS() å‘æŒ¥å‡ºä¸€ç‚¹ç‚¹å¨åŠ›ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ å°†æ¶ˆè´¹è€…çš„åå’Œå§“ç”¨é€—å·è¿›è¡Œåˆ†éš”ï¼Œç„¶åå†ç”¨ ; è¿›è¡Œåˆ†éš” 123456SELECT GROUP_CONCAT( CONCAT_WS(', ', contactLastName, contactFirstName) SEPARATOR ';')FROM customers; è¿™é‡Œæ˜¯ CONCAT_WS()å‡½æ•°ç”¨æ³•, å¾ˆç®€å•ï¼Œè¯·è‡ªè¡ŒæŸ¥çœ‹å§â€¦â€¦ æ³¨æ„âš ï¸GROUP_CONCATï¼ˆï¼‰å‡½æ•°è¿”å›å•ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å€¼åˆ—è¡¨ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½åœ¨ IN è¿ç®—ç¬¦ä¸­ä½¿ç”¨GROUP_CONCATï¼ˆï¼‰å‡½æ•°çš„ç»“æœï¼Œä¾‹å¦‚ï¼Œåœ¨å­æŸ¥è¯¢ä¸­ï¼Œ åƒè¿™æ ·ï¼š 123456SELECT id, nameFROM table_nameWHERE id IN GROUP_CONCAT(id); æ€»ç»“åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åº”ç”¨GROUP_CONCATï¼ˆï¼‰å‡½æ•°äº§ç”Ÿå‡ºæœ‰ç”¨çš„ç»“æœï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç»“åˆå…¶ä»–å‡½æ•°å‘æŒ¥å‡ºæ›´å¤§çš„å¨åŠ›. å•æ‹›å­¦ä¼šäº†ï¼Œå°±è¦å­¦ä¼šè¿æ‹› combo äº† å¦‚æœä½ ä¹Ÿåƒæˆ‘ä¸€æ ·åˆšçŸ¥é“è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œè¿˜è¯·ç‚¹ä¸ªã€Œåœ¨çœ‹ã€ å¦‚æœä½ æ—©éƒ½çŸ¥é“è¿™ä¸ªå°å„¿ç§‘å†…å®¹ï¼Œè¿˜è¯·ç•™è¨€é€ä¸Šã€Œå˜˜å£°ã€","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"æ•°æ®åº“-æŒä¹…å±‚-SQL","slug":"Coding/æ•°æ®åº“-æŒä¹…å±‚-SQL","permalink":"https://dayarch.top/categories/Coding/%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%8C%81%E4%B9%85%E5%B1%82-SQL/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://dayarch.top/tags/MySQL/"}]},{"title":"è·¨è¡¨æ›´æ–°ï¼Œçœ‹åˆ°è‡ªå·±å†™çš„SQLåƒä¸ªæ†¨æ†¨","slug":"è·¨è¡¨æ›´æ–°ï¼Œçœ‹åˆ°è‡ªå·±å†™çš„SQLåƒä¸ªæ†¨æ†¨","date":"2020-01-22T02:09:02.000Z","updated":"2020-02-07T03:12:30.203Z","comments":true,"path":"/p/mysql-cross-table-update.html","link":"","permalink":"https://dayarch.top/p/mysql-cross-table-update.html","excerpt":"æœ‰ç‚¹ SQL åŸºç¡€çš„æœ‹å‹è‚¯å®šå¬è¿‡ ã€Œè·¨è¡¨æŸ¥è¯¢ã€ï¼Œé‚£å•¥æ˜¯è·¨è¡¨æ›´æ–°å•Šï¼Ÿ èƒŒæ™¯ é¡¹ç›®æ–°å¯¼å…¥äº†ä¸€æ‰¹äººå‘˜æ•°æ®ï¼Œè¿™äº›äººçš„æœ‰çš„éƒ¨é—¨åç§°å‘ç”Ÿäº†å˜åŒ–ï¼Œæœ‰çš„è”ç³»æ–¹å¼å‘ç”Ÿäº†å˜åŒ–ï¼Œæš‚ä¸”ç§°è¯¥è¡¨ä¸º t_dept_members, ç³»ç»Ÿä¸­æœ‰å¦å¤–ä¸€å¼ è¡¨ t_user_info è®°å½•äº†äººå‘˜ä¿¡æ¯ã€‚è¦æ±‚å°† t_dept_members ä¸­æœ‰å˜åŒ–çš„ä¿¡æ¯æ›´æ–°åˆ° t_user è¡¨ä¸­ï¼Œè¿™ä¸ªéœ€æ±‚å°±æ˜¯ã€Œè·¨è¡¨æ›´æ–°ã€å•¦ æ†¨B SQL ç›´æ¥è¢«ç§’æ€ ä¸å¸¦è„‘å­å‡ºé—¨çš„å°±å†™å‡ºäº†ä¸‹é¢çš„ SQL çœ‹åˆ°èº«å DBA å°æ®µæ€»åœ¨ä¿®ä»™ï¼Œæƒ³ç€è®©ä»–å¸®æ¶¦è‰²ä¸€ä¸‹ğŸ˜œï¼Œäºæ˜¯å‘ç»™äº†ä»–ï¼Œç„¶åç”©æ‰‹å›æ¥å°±æ˜¯è¿™ä¸ªæ ·å­ï¼š â€‹ çœ‹åˆ°è¿™ä¸ª SQL è¯­å¥æˆ‘éƒ½æƒŠå‘†äº†ï¼Œè¿˜èƒ½","text":"æœ‰ç‚¹ SQL åŸºç¡€çš„æœ‹å‹è‚¯å®šå¬è¿‡ ã€Œè·¨è¡¨æŸ¥è¯¢ã€ï¼Œé‚£å•¥æ˜¯è·¨è¡¨æ›´æ–°å•Šï¼Ÿ èƒŒæ™¯é¡¹ç›®æ–°å¯¼å…¥äº†ä¸€æ‰¹äººå‘˜æ•°æ®ï¼Œè¿™äº›äººçš„æœ‰çš„éƒ¨é—¨åç§°å‘ç”Ÿäº†å˜åŒ–ï¼Œæœ‰çš„è”ç³»æ–¹å¼å‘ç”Ÿäº†å˜åŒ–ï¼Œæš‚ä¸”ç§°è¯¥è¡¨ä¸º t_dept_members, ç³»ç»Ÿä¸­æœ‰å¦å¤–ä¸€å¼ è¡¨ t_user_info è®°å½•äº†äººå‘˜ä¿¡æ¯ã€‚è¦æ±‚å°† t_dept_members ä¸­æœ‰å˜åŒ–çš„ä¿¡æ¯æ›´æ–°åˆ° t_user è¡¨ä¸­ï¼Œè¿™ä¸ªéœ€æ±‚å°±æ˜¯ã€Œè·¨è¡¨æ›´æ–°ã€å•¦ æ†¨B SQL ç›´æ¥è¢«ç§’æ€ä¸å¸¦è„‘å­å‡ºé—¨çš„å°±å†™å‡ºäº†ä¸‹é¢çš„ SQL çœ‹åˆ°èº«å DBA å°æ®µæ€»åœ¨ä¿®ä»™ï¼Œæƒ³ç€è®©ä»–å¸®æ¶¦è‰²ä¸€ä¸‹ğŸ˜œï¼Œäºæ˜¯å‘ç»™äº†ä»–ï¼Œç„¶åç”©æ‰‹å›æ¥å°±æ˜¯è¿™ä¸ªæ ·å­ï¼š â€‹ çœ‹åˆ°è¿™ä¸ª SQL è¯­å¥æˆ‘éƒ½æƒŠå‘†äº†ï¼Œè¿˜èƒ½è¿™æ ·å†™ï¼Œåœ¨æ— æƒ…çš„å˜²ç¬‘ä¸‹ï¼Œä¸€å£° KO æˆ‘ç›´æ¥å€’ä¸‹ã€‚æ­»ä¹Ÿå¾—æ­»çš„æ˜ç™½ï¼Œå’±å¾—æŸ¥æŸ¥è¿™æ˜¯å’‹å›äº‹å•Š Mysql Update Joinæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ join æŸ¥è¯¢è¡¨ä¸­å…·æœ‰ï¼ˆåœ¨ INNER JOIN æƒ…å†µä¸‹ï¼‰æˆ–å¯èƒ½æ²¡æœ‰ï¼ˆåœ¨ LEFT JOIN æƒ…å†µä¸‹ï¼‰å¦ä¸€ä¸ªè¡¨ä¸­åŒ¹é…è¡Œçš„è¡¨ä¸­çš„è¡Œã€‚ åŒæ ·ï¼Œåœ¨ MySQL ä¸­, æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ UPDATE è¯­å¥ä¸­ä½¿ç”¨ JOIN å­å¥æ‰§è¡Œè·¨è¡¨æ›´æ–°ï¼Œè¯­æ³•å°±æ˜¯è¿™æ ·ï¼š 12345UPDATE T1, T2,[INNER JOIN | LEFT JOIN] T1 ON T1.C1 = T2. C1SET T1.C2 = T2.C2, T2.C3 = exprWHERE condition æˆ‘ä»¬è¿˜æ˜¯è¯¦ç»†çš„è¯´æ˜ä¸€ä¸‹ä¸Šé¢çš„è¯­æ³•ï¼š é¦–å…ˆï¼Œåœ¨ UPDATE å­å¥ä¹‹åï¼ŒæŒ‡å®šä¸»è¡¨ï¼ˆT1ï¼‰å’Œå¸Œæœ›ä¸»è¡¨è”æ¥åˆ°çš„è¡¨ï¼ˆT2ï¼‰ã€‚è¯·æ³¨æ„ï¼Œå¿…é¡»åœ¨UPDATE å­å¥ä¹‹åè‡³å°‘æŒ‡å®šä¸€ä¸ªè¡¨ æ¥ä¸‹æ¥ï¼ŒæŒ‡å®šä½ è¦ä½¿ç”¨çš„è”æ¥ç±»å‹ï¼Œå³ INNER JOIN æˆ– LEFT JOIN ä»¥åŠè”æ¥è°“è¯ã€‚ JOINå­å¥å¿…é¡»å‡ºç°åœ¨ UPDATE å­å¥ä¹‹åï¼ˆè¿™ä¸ªå¤§å®¶éƒ½æ˜¯çŸ¥é“çš„å“ˆï¼‰ ç„¶åï¼Œå°†æ–°å€¼åˆ†é…ç»™è¦æ›´æ–°çš„ T1æˆ– T2 è¡¨ä¸­çš„åˆ— æœ€åï¼Œåœ¨ WHERE å­å¥ä¸­æŒ‡å®šä¸€ä¸ªæ¡ä»¶ä»¥å°†è¡Œé™åˆ¶ä¸ºè¦æ›´æ–°çš„è¡Œ å¦‚æœä½ éµå¾ª update è¯­æ³•ï¼Œä½ ä¼šå‘ç°æœ‰å¦å¤–ä¸€ç§è¯­æ³•ä¹Ÿå¯ä»¥å®Œæˆè·¨è¡¨æ›´æ–° 1234UPDATE T1, T2SET T1.c2 = T2.c2, T2.c3 = exprWHERE T1.c1 = T2.c1 AND condition ä¸Šé¢çš„è¯­æ³•å…¶å®éšå¼ä½¿ç”¨äº† inner join å…³é”®å­—ï¼Œå®Œå…¨ç­‰åŒäºä¸‹é¢çš„æ ·å­ï¼š 12345UPDATE T1,T2INNER JOIN T2 ON T1.C1 = T2.C1SET T1.C2 = T2.C2, T2.C3 = exprWHERE condition ä¸ªäººå»ºè®®è¿˜æ˜¯åŠ ä¸Š inner join å…³é”®å­—å§ï¼Œè¿™æ ·å¯è¯»æ€§æ›´å¥½ï¼Œå°½äº«ä¸æ»‘ï¼Œä½ è§‰å¾—å‘¢ï¼Ÿ æˆ‘æ‘¸é±¼çœ‹åˆ°çš„ï¼Œè§‰å¾—æ˜¯çµé­‚ç¿»è¯‘ è°ˆå¤ªå»‰ï¼Œç§€ä½ ç  ï¼ˆTalk is cheapï¼Œshow me the codeï¼‰ Update Join ä¾‹å­å¹´åº•äº†ï¼Œåˆåˆ°äº†è¯„ç»©æ•ˆçš„æ—¶å€™äº†ï¼Œå°±æ˜¯é‚£ä¸ªå« KPI çš„ä¸œä¸œï¼ˆä½ ä»¬æœ‰å—ï¼‰ï¼Œå¬è¯´è¦æ ¹æ® KPI è°ƒå·¥èµ„äº†ã€‚æœ‰ä¸¤å¼ è¡¨ ç¬¬ä¸€å¼ è¡¨ã€Œemployees-å‘˜å·¥è¡¨ã€ å»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼š 12345678910create table employees( employee_id bigint auto_increment comment 'å‘˜å·¥IDï¼Œä¸»é”®', employee_name varchar(50) null comment 'å‘˜å·¥åç§°', performance int(4) null comment 'ç»©æ•ˆåˆ†æ•° 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5', salary float null comment 'å‘˜å·¥è–ªæ°´', constraint employees_pk primary key (employee_id))comment 'å‘˜å·¥è¡¨'; ç¬¬äºŒå¼ è¡¨ã€Œmerits-ç»©æ•ˆå­—å…¸è¡¨ã€ å»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼š 123456create table merits( performance int(4) null, percentage float null)comment 'ç»©æ•ˆå­—å…¸è¡¨'; å…ˆç”Ÿæˆä¸€äº›æ¨¡æ‹Ÿæ•°æ® 1234567891011121314151617-- ç»©æ•ˆå­—å…¸åˆå§‹åŒ–æ•°æ®INSERT INTO merits(performance, percentage)VALUES (1, 0), (2, 0.01), (3, 0.03), (4, 0.05), (5, 0.08);-- å‘˜å·¥è¡¨åˆå§‹åŒ–æ•°æ®INSERT INTO employees(employee_name, performance, salary)VALUES ('æ‹±å“¥', 1, 1000), ('å°æ®µæ€»', 3, 20000), ('å¤§äºº', 4, 18000), ('å¸ä»¤', 5, 28000), ('è€å…­', 2, 10000), ('ç½—è’™', 3, 20000); è°ƒè–ªè§„åˆ™ï¼š åŸæœ‰è–ªèµ„ + ï¼ˆåŸæœ‰è–ªèµ„ * å½“å‰ç»©æ•ˆå¯¹åº”çš„è°ƒè–ªç™¾åˆ†æ¯”ï¼‰ æŒ‰ç…§è°ƒè–ªè§„åˆ™å†™ update è¯­å¥ï¼š 1234UPDATE employees INNER JOIN merits ON employees.performance = merits.performanceSET salary = salary + salary * percentage; æ‹±å“¥ç»©æ•ˆä¸å¥½ï¼Œæ²¡ç»™æ¶¨å·¥èµ„â€¦â€¦ ä¸‰æ¨ªä¸€ç«–ä¸€å’•å˜ï¼Œå››ä¸ªå°çŒªğŸ·æ¥åƒzhaï¼Œå’•å˜å’•å˜åˆæ¥ä¿© ä¸´è¿‘å¹´åº•ï¼Œå…¬å¸åˆæ¥äº†ä¸¤ä½æ–°åŒäº‹, ä½†æ˜¯å…¬å¸å¹´åº¦ç»©æ•ˆå·²ç»è¯„å®Œï¼Œæ‰€ä»¥æ–°å‘˜å·¥ç»©æ•ˆä¸º NULL 123INSERT INTO employees(employee_name, performance, salary)VALUES ('é¦®å¤§', NULL, 8000), ('é¦®äºŒ', NULL, 5000); æ–°å‘˜å·¥å·¥ä½œå¹²çš„ä¸é”™ï¼Œä¹Ÿè¦ 1.5% æ¶¨ç‚¹å·¥èµ„çš„ã€‚å¦‚æœæˆ‘ä»¬è¿˜æ˜¯ç”¨ UPDATE INNER JOINï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ›´æ–°è¯­å¥æ˜¯ä¸å¯èƒ½å®Œæˆçš„ï¼Œå› ä¸ºæ¡ä»¶ç­‰å¼ä¸æˆç«‹ï¼Œè¿™æ˜¯æˆ‘ä»¬å°±è¦ç”¨åˆ° UPDATE LEFT JOIN äº† 12345UPDATE employees LEFT JOIN merits ON employees.performance = merits.performanceSET salary = salary + salary * 0.015WHERE merits.percentage IS NULL; åˆ°è¿™é‡Œï¼Œæ–°å‘˜å·¥çš„æ¶¨è–ªå·¥ä½œä¹Ÿåšå®Œï¼Œæ‹±å“¥ç”±äºçŸ¥è¯†ç‚¹äº†è§£ä¸é€å½»ï¼Œç°æºœæºœçš„å›å®¶è¿‡å¹´","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"æ•°æ®åº“-æŒä¹…å±‚-SQL","slug":"Coding/æ•°æ®åº“-æŒä¹…å±‚-SQL","permalink":"https://dayarch.top/categories/Coding/%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%8C%81%E4%B9%85%E5%B1%82-SQL/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://dayarch.top/tags/MySQL/"}]},{"title":"å¾®ä¿¡ä¸Šçº¿äº†10æ¬¾é»˜è®¤æ–°è¡¨æƒ…","slug":"å¾®ä¿¡ä¸Šçº¿äº†10æ¬¾é»˜è®¤æ–°è¡¨æƒ…","date":"2020-01-14T07:33:22.000Z","updated":"2020-01-19T14:17:14.057Z","comments":true,"path":"/p/wechat-new-expression.html","link":"","permalink":"https://dayarch.top/p/wechat-new-expression.html","excerpt":"å¾®ä¿¡æ–°å¢è¡¨æƒ… å¾®ä¿¡æ–°å¢åæ¬¾é»˜è®¤è¡¨æƒ…ï¼ å¾®ä¿¡æ–°å¢åæ¬¾é»˜è®¤è¡¨æƒ…ï¼ å¾®ä¿¡æ–°å¢åæ¬¾é»˜è®¤è¡¨æƒ…ï¼ å¾®ä¿¡ä»Šæ—¥æ‚„ç„¶ä¸Šçº¿äº†åæ¬¾æ–°é»˜è®¤è¡¨æƒ…ï¼Œ å…¶ä¸­åŒ…å«äº† \b 1. åƒç“œ 2. åŠ æ²¹ 3. æ±— 4. å¤©å•Š 5. Emm 6. ç¤¾ä¼šç¤¾ä¼š 7. æ—ºæŸ´ 8. å¥½çš„ 9. æ‰“è„¸ 10. å“‡ æ„Ÿè§‰æ¯”ç”¨äº†è¡¨æƒ…åŒ…è¿˜æ¿€åŠ¨ã€‚æ®æ‚‰ï¼Œç›®å‰è¿™åæ¬¾æ–°é»˜è®¤è¡¨æƒ…æ­£åœ¨è¿›è¡Œç°åº¦æµ‹è¯•ï¼Œéƒ¨åˆ†å¾®ä¿¡ç”¨æˆ·å¯èƒ½æ— æ³•æ­£å¸¸æ˜¾ç¤º ä¸€å›¾èƒœåƒè¨€ï¼Œå¯¹äºå–œæ¬¢ä½¿ç”¨è¡¨æƒ…çš„ä½ ï¼Œå¿«å¿«æ‰“å¼€ä½ çš„å¾®ä¿¡çœ‹çœ‹å§","text":"å¾®ä¿¡æ–°å¢è¡¨æƒ…å¾®ä¿¡æ–°å¢åæ¬¾é»˜è®¤è¡¨æƒ…ï¼å¾®ä¿¡æ–°å¢åæ¬¾é»˜è®¤è¡¨æƒ…ï¼å¾®ä¿¡æ–°å¢åæ¬¾é»˜è®¤è¡¨æƒ…ï¼ å¾®ä¿¡ä»Šæ—¥æ‚„ç„¶ä¸Šçº¿äº†åæ¬¾æ–°é»˜è®¤è¡¨æƒ…ï¼Œ å…¶ä¸­åŒ…å«äº†\b åƒç“œ åŠ æ²¹ æ±— å¤©å•Š Emm ç¤¾ä¼šç¤¾ä¼š æ—ºæŸ´ å¥½çš„ æ‰“è„¸ å“‡ æ„Ÿè§‰æ¯”ç”¨äº†è¡¨æƒ…åŒ…è¿˜æ¿€åŠ¨ã€‚æ®æ‚‰ï¼Œç›®å‰è¿™åæ¬¾æ–°é»˜è®¤è¡¨æƒ…æ­£åœ¨è¿›è¡Œç°åº¦æµ‹è¯•ï¼Œéƒ¨åˆ†å¾®ä¿¡ç”¨æˆ·å¯èƒ½æ— æ³•æ­£å¸¸æ˜¾ç¤º ä¸€å›¾èƒœåƒè¨€ï¼Œå¯¹äºå–œæ¬¢ä½¿ç”¨è¡¨æƒ…çš„ä½ ï¼Œå¿«å¿«æ‰“å¼€ä½ çš„å¾®ä¿¡çœ‹çœ‹å§","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"å…¶ä»–","slug":"Life/å…¶ä»–","permalink":"https://dayarch.top/categories/Life/%E5%85%B6%E4%BB%96/"}],"tags":[{"name":"å¾®ä¿¡","slug":"å¾®ä¿¡","permalink":"https://dayarch.top/tags/%E5%BE%AE%E4%BF%A1/"},{"name":"è¡¨æƒ…","slug":"è¡¨æƒ…","permalink":"https://dayarch.top/tags/%E8%A1%A8%E6%83%85/"}]},{"title":"2019å½’é›¶ï¼Œ2020èµ°ä½ ","slug":"2019å¹´æ€»ç»“","date":"2020-01-10T05:35:55.000Z","updated":"2020-02-10T12:07:59.784Z","comments":true,"path":"/p/2019-summary.html","link":"","permalink":"https://dayarch.top/p/2019-summary.html","excerpt":"ä½œä¸ºç”Ÿé•¿åœ¨å†…è’™çš„ï¼Œä¸ä¼šå¥—é©¬çš„ï¼Œé…’ç²¾è¿‡æ•çš„ï¼Œä¸åƒç¾Šè‚‰çš„ï¼Œä¹Ÿä¸é­æ¢§çš„å¥‡è‘©ï¼Œå•æ›²å¾ªç¯å¬ç€è…¾æ ¼å°”å¤§çˆ·çš„ç¿»å”±æ­Œæ›²ã€Œå¯èƒ½å¦ã€ï¼Œè¿˜æ˜¯å¼€å§‹å†™äº† 2019 å¹´æ€»ç»“ï¼Œè¿™ä¸ªæ€»ç»“æ¯” 2002 ğŸ˜† å¹´æ¥çš„æ›´æ™šä¸€äº›ï¼Œå› ä¸ºåœ¨ç­‰å¾… 2019 å¹´æœ«çš„ä¸€ä¸ª PMP(æ‹é©¬å±)çš„æˆç»©ï¼Œèµ¶ä¸ä¸Šå„ä¸ªå¹³å°çš„æ€»ç»“æ¯”èµ›äº†ï¼Œå†™ä¸‹æ¥ç»™è‡ªå·±ä¸ªç­”å¤ å¹´åˆçš„ä¸€æ¬¡æ—…è¡Œä¹‹åï¼Œå›æ¥å€æ„Ÿæƒ¶æï¼Œæ€»è§‰å¾—åº”è¯¥åšç‚¹ä»€ä¹ˆç»§ç»­å……å®è‡ªå·±çš„ç”Ÿæ´»ã€‚å†™åšå®¢è®°å½•å’Œç»´æŠ¤å…¬ä¼—å·çš„æƒ³æ³•ä¹Ÿå°±éšä¹‹æµ®ç°åœ¨è„‘æµ·ä¸­ ç¿»çœ‹å†å²è®°å½•ï¼Œåœ¨ 2015 å¹´å°±å·²ç»å°è¯•æ­å»ºè‡ªå·±çš„åšå®¢äº†ï¼Œå¥ˆä½•æ²¡æœ‰åšæŒåˆ†äº«ï¼Œä¸­é€”å¤­æŠ˜ã€‚ã€Œç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ã€ã€‚è¿™ä¸€åˆ»ï¼Œæˆ‘è¦ç§ä¸€æ£µæ ‘ï¼Œé™ªå¥¹é•¿å¤§ï¼Œæˆ‘å˜è€ï¼Œå¥¹èŒå£®","text":"ä½œä¸ºç”Ÿé•¿åœ¨å†…è’™çš„ï¼Œä¸ä¼šå¥—é©¬çš„ï¼Œé…’ç²¾è¿‡æ•çš„ï¼Œä¸åƒç¾Šè‚‰çš„ï¼Œä¹Ÿä¸é­æ¢§çš„å¥‡è‘©ï¼Œå•æ›²å¾ªç¯å¬ç€è…¾æ ¼å°”å¤§çˆ·çš„ç¿»å”±æ­Œæ›²ã€Œå¯èƒ½å¦ã€ï¼Œè¿˜æ˜¯å¼€å§‹å†™äº† 2019 å¹´æ€»ç»“ï¼Œè¿™ä¸ªæ€»ç»“æ¯” 2002 ğŸ˜† å¹´æ¥çš„æ›´æ™šä¸€äº›ï¼Œå› ä¸ºåœ¨ç­‰å¾… 2019 å¹´æœ«çš„ä¸€ä¸ª PMP(æ‹é©¬å±)çš„æˆç»©ï¼Œèµ¶ä¸ä¸Šå„ä¸ªå¹³å°çš„æ€»ç»“æ¯”èµ›äº†ï¼Œå†™ä¸‹æ¥ç»™è‡ªå·±ä¸ªç­”å¤ å¹´åˆçš„ä¸€æ¬¡æ—…è¡Œä¹‹åï¼Œå›æ¥å€æ„Ÿæƒ¶æï¼Œæ€»è§‰å¾—åº”è¯¥åšç‚¹ä»€ä¹ˆç»§ç»­å……å®è‡ªå·±çš„ç”Ÿæ´»ã€‚å†™åšå®¢è®°å½•å’Œç»´æŠ¤å…¬ä¼—å·çš„æƒ³æ³•ä¹Ÿå°±éšä¹‹æµ®ç°åœ¨è„‘æµ·ä¸­ ç¿»çœ‹å†å²è®°å½•ï¼Œåœ¨ 2015 å¹´å°±å·²ç»å°è¯•æ­å»ºè‡ªå·±çš„åšå®¢äº†ï¼Œå¥ˆä½•æ²¡æœ‰åšæŒåˆ†äº«ï¼Œä¸­é€”å¤­æŠ˜ã€‚ã€Œç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ã€ã€‚è¿™ä¸€åˆ»ï¼Œæˆ‘è¦ç§ä¸€æ£µæ ‘ï¼Œé™ªå¥¹é•¿å¤§ï¼Œæˆ‘å˜è€ï¼Œå¥¹èŒå£®é•¿é’ å…¬ä¼—å·ä¸åšå®¢ç£•ç£•ç¢°ç¢°ä¸€ç‚¹ç‚¹æ‘¸ç´¢ç€å®Œæˆäº†å…¬ä¼—å·çš„æ³¨å†Œã€Œæ—¥æ‹±ä¸€å…µã€ã€‚æ—¥æ‹±ä¸€å’ï¼ŒåŠŸä¸å”æï¼Œè¿™ä¸ªåå­—çœŸæ˜¯éå¸¸è´¨æœ´äº†ï¼Œå¥ˆä½•æ—¥æ‹±ä¸€å’è¢«æ³¨å†Œäº†ï¼Œä½†å¹¸è¿çš„æ˜¯æ—¥æ‹±ä¸€å…µæ²¡æœ‰è¢«æ³¨å†Œï¼Œå¦åˆ™æˆ‘å°±å¾—ã€Œè»Š/é¦¬/ç‚®ã€çš„å°è¯•ä¸‹å»äº†ï¼Œå¦‚æœåˆ°äº†æ—¥æ‹±ä¸€ paoçš„åœ°æ­¥æˆ‘åº”è¯¥å°±æ”¾å¼ƒè¿™ä¸ª ID äº†å§ ğŸ˜‚ æœæŸ¥è‚šå­é‡Œæœ‰é™çš„å¢¨æ°´ï¼Œ2019 å¹´ 5 æœˆ 22 å·ï¼Œæˆ‘æˆ˜æˆ˜å…¢å…¢åˆæ»¡æ€€æœŸå¾…çš„å‘å¸ƒäº†ç¬¬ä¸€ç¯‡æ–‡ç« å¦‚ä½•è®¾è®¡å¥½çš„ RESTful APIã€‚æˆ‘åƒåšä¼ é”€çš„ä¸€æ ·ï¼Œå…ˆä»äº²æœ‹å¥½å‹å¼€å§‹å‘ï¼Œè®©ä»–ä»¬å…³æ³¨è¯„è®ºï¼Œç°åœ¨ä¸€çœ‹å·²ç»æœ‰äº† 17 ä¸ªåœ¨çœ‹ï¼Œä»–ä»¬ä¸€å®šè´¡çŒ®å¾ˆå¤š ğŸ˜œ 2019 å¹´ 7 æœˆ 11 æ—¥ï¼Œçªç„¶æ”¶åˆ°ä¸€ä¸ªèµèµé€šçŸ¥ï¼Œå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯æœ‹å‹çš„å®‰æ…°ï¼Œåå¤ç¡®è®¤åï¼Œæ‰å‘ç°è¿™å°±æ˜¯è¯»è€…æœ‹å‹çš„èµèµï¼Œé‚£ä¸€åˆ»æˆ‘è§‰å¾—æˆ‘æ˜¯ç™¾ä¸‡å¯Œç¿ï¼Œæ€€ç€æ— æ¯”æ¿€åŠ¨çš„å¿ƒæƒ…å›å¤ã€Œæˆ‘ä¼šåŠªåŠ›è¾“å‡ºé«˜è´¨é‡åŸåˆ›å†…å®¹ã€ ç”Ÿå­©å­å®¹æ˜“ï¼Œå…»è‚²å­©å­éš¾ï¼Œä¸å…³æ³¨ç²‰ä¸çš„å¢é•¿ä¸€å®šæ˜¯å‡çš„ã€‚æˆ‘ä¹Ÿéœ€è¦å°å°çš„æˆå°±æ„Ÿæ¥é©±åŠ¨ï¼Œä¸€å¤©ä¸‹æ¥ï¼Œæ¯å¢é•¿ä¸€ä¸ªç²‰ä¸éƒ½ä½¿æˆ‘è¶³å¤Ÿå…´å¥‹ï¼Œç¬¬äºŒå¤©èµ·åºŠåˆç„¦è™‘çš„æœŸç›¼ç¬¬äºŒä¸ªç²‰ä¸çš„åˆ°æ¥ï¼Œå°±è¿™æ ·æœæœæš®æš®â€¦â€¦ ä¸ªäººåšå®¢é‡æ–°è¿è¥äº†èµ·æ¥ï¼Œåœ¨ç»´æŠ¤è¿‡ç¨‹ä¸­å·®ç‚¹è¿·å¤±åœ¨å®šåˆ¶ç‚«é…·çš„æ•ˆæœä¸­ï¼Œå¹¸äºæ²¡æœ‰èµ°ç«å¦‚é­”ï¼Œå›å½’åˆ°äº†åšæ–‡å†…å®¹æœ¬è´¨ä»¥åŠåšå®¢åŠŸèƒ½å¢å¼ºç­‰ï¼Œä½œä¸ºåç«¯ç¨‹åºçŒ¿çš„æˆ‘ï¼Œä¹Ÿä¸ºä¸»é¢˜åŠŸèƒ½è´¡çŒ®äº†ä¸ª PRï¼Œè¿˜è¯·å„ä½å¤§å£°å˜²ç¬‘ ä½çš„ç¦»å…¬å¸å¾ˆè¿‘ï¼Œæ— èŠçš„æ—¶å€™å°±å¯ä»¥è·‘åˆ°å…¬å¸å†™ç‚¹ä¸œè¥¿é™é™å¿ƒï¼Œä¸åˆ°ä¸€å¹´å†™äº† 39 ç¯‡åŸåˆ›æ–‡ç« ï¼Œä¸ç®—ä»£ç ï¼Œç´¯è®¡å­—æ•°å°†è¿‘ 10 ä¸‡å­—ï¼Œé•¿åº¦ä¸åˆ°åœ°çƒä¸€å‘¨ğŸ˜ ä¿¡ä»°ä¸ºäº†åšå¥½è¿™äº›å†…å®¹ï¼Œæˆ‘ä¸ºæˆ‘çš„æ€æƒ³æ³¨å…¥ä¸¤æ¡ä¿¡ä»°: ä½ æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬äº¤æ¢åï¼Œä¸€ä¸ªäººå°±æœ‰äº†ä¸¤ä¸ªæ€æƒ³è¿™ä¸ªä¿¡ä»°è®©æˆ‘å‹‡äºä¸ä»–äººäº¤æµï¼Œè¿›è¡Œæ€æƒ³ç¢°æ’ï¼Œç”šè‡³äº§ç”Ÿ 1+1&gt;2 çš„æ•ˆæœï¼Œä¹äºåˆ†äº«ä¹Ÿè®©æˆ‘æ”¶è·é¢‡å¤šå¿«ä¹ï¼Œä½ ä¼šå‘ç°ï¼Œæ¯ä¸ªä¸ªä½“çš„æ€æƒ³çœŸçš„å¾ˆå¥‡å¦™If you can NOT explain it simply, you do NOT understand it well enoughæŠ€æœ¯æœ‰æ—¶ä¼šæ¯ç‡¥ï¼Œæ‰€ä»¥æœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼Œå°†æŠ½è±¡é—®é¢˜å›¾å½¢åŒ–çš„æ–¹å¼æ¥è¾“å‡ºæ–‡ç« ã€‚åœ¨è®²è§£çš„è¿‡ç¨‹ä¸­ä¹ŸåŠ æ·±äº†æˆ‘å¯¹é—®é¢˜çš„ç†è§£å±‚æ¬¡ é˜…è¯»2019 å¹´è¯» 30 å¤šæœ¬æ‚ä¹¦ï¼Œå·²ç»æ”¾åˆ°äº†åšå®¢ä¹¦æ¶ï¼Œé—æ†¾çš„æ˜¯æ²¡æ€ä¹ˆå†™å®Œæ•´ä¹¦è¯„ï¼Œæˆ‘çƒ­è¡·äºçœ‹çº¸è´¨ä¹¦ç±ï¼Œéƒ½æ˜¯è¾¹è¯»è¾¹å†™è¾¹ç”»äº†ï¼Œè¿™é‡Œä»…ä»…è¯´å‡ ä¸ªå°è±¡æ·±åˆ»çš„æ„Ÿæ‚Ÿ å…¥ä¸€è¡Œï¼Œå…ˆåˆ«æƒ¦è®°ç€èƒ½èµšé’±ï¼Œå…ˆå­¦ç€è®©è‡ªå·±å€¼é’±ï¼Œå˜å†…è¡Œäººã€‚æ²¡æœ‰å“ªä¸ªè¡Œä¸šçš„é’±æ˜¯å¥½èµšçš„ï¼Œå­¦ä¹ æ˜¯è®©è‡ªå·±å¿«é€Ÿå¢å€¼çš„æœ€å¥½é€”å¾„ã€‚è®©äººè¿·èŒ«çš„åŸå› åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯æœ¬è¯¥æ‹¼æçš„å¹´çºªï¼Œå´æƒ³å¾—å¤ªå¤šï¼Œåšå¾—å¤ªå°‘â€”â€”æ‘˜è‡ªã€Œè¤šæ—¶å¥ä¼ ã€ å¿ƒç†å­¦ç›¸å…³çš„ä¹¦è§£è¯»äº†æˆ‘æ—¥å¸¸ä¸€äº›ç–¯ç‹‚çš„æ€æƒ³å’Œè¡Œä¸ºï¼Œå¦‚æœæ²¡æœ‰ä»–ä»¬çš„è§£è¯»ï¼Œæˆ‘å¯èƒ½è§‰å¾—æˆ‘æ˜¯ä¸ªå˜æ€ğŸ˜‚ï¼Œç°åœ¨å¿ƒå®‰äº†è®¸å¤š ä½ çš„ç¯è¿˜äº®ç€å—ï¼Ÿå§‹ç»ˆè®©æˆ‘å¸¦ç€è¿½é—®å»æ€è€ƒé—®é¢˜ï¼Œæ¯ç¯‡å…¬ä¼—å·æ¨æ–‡çš„ã€Œçµé­‚è¿½é—®ã€ç¯èŠ‚çš„çµæ„Ÿä¹Ÿæ¥æºäºæ­¤ è¯»ä¹¦åªä¸ºå–æ‚¦è‡ªå·± å·¥ä½œ2019 å¹´åœ¨å·¥ä½œä¸Šæ•´ä½“èŠ‚å¥ä¾ç„¶å¹³ç¨³ã€‚å’Œä¼™ä¼´ä»¬å¹¶è‚©æˆ˜æ–—ï¼Œå¤šä¸ªäº§å“çº¿ä¹Ÿå¦‚æœŸä¸Šçº¿ã€‚å¾ˆæ„å¤–ç”³è¯·ä¸‹æ¥ä¸€ä¸ªä¸“åˆ©ã€Œè¯ä»¶æ–‡å­—ä¿¡æ¯è·å–æ–¹æ³•ã€è£…ç½®ä»¥åŠç”µå­è®¾å¤‡ã€ï¼ŒåŒæ—¶æœ‰ä¸€ç¯‡æ–‡ç« å…¥é€‰å…¬å¸æŠ€æœ¯æœŸåˆŠã€‚è¯·å…è®¸æˆ‘éª„å‚²ä¸€ç§’é’Ÿ éª„å‚²ç»“æŸâ€¦â€¦ğŸ˜‚ ç›¸è¯†ï¼Œå¹¸è¿çš„èµ·ç‚¹ä¸šä½™æ—¶é—´ä¸º Spring4All ç¤¾åŒº è´¡çŒ®ç¿»è¯‘å†…å®¹ï¼Œæ…¢æ…¢ç»“è¯†äº†ç¨‹åºçŒ¿ DD å’Œ æ³¥ç“¦åŒ  BYSocketï¼Œè¢«å‰è¾ˆçš„æ€åº¦æŠ˜æœï¼Œæ›´è¢«ä¸€äº›æ•…äº‹æ„ŸåŠ¨ã€‚ä»–ä»¬è‡ªç„¶æ˜¯æˆ‘å­¦ä¹ å’Œè¿½èµ¶çš„æ¦œæ · ç»´æŠ¤ä¸ªäººåšå®¢å’Œå…¬ä¼—å·å°‘ä¸äº†å¹¶è‚©æˆ˜æ–—çš„ä¼™ä¼´ï¼Œä¹±æ•²ä»£ç ï¼Œç å†œå°èƒ–å“¥ï¼Œè¾‰å“¥ï¼Œé”…å¤–çš„å¤§ä½¬ï¼ŒäºŒå¸ˆå…„ç­‰ï¼Œæˆ‘å’Œç¾¤é‡Œå°ä¼™ä¼´æ— æ•°æ¬¡çš„æ¢è®¨æ–¹å‘å’Œä¿®è¡¥æ”¹è¿›æ–¹æ¡ˆç­‰ï¼Œå¢é•¿äº†è§è¯†åŒæ—¶ä¹Ÿåšå®šäº†åšå¥½çš„æ€åº¦å’Œä¿¡å¿µ è®¤è¯†äº†å„å¤§ç½‘ç«™çš„è¿è¥å°å§å§ï¼Œå°å“¥å“¥ï¼Œå¶å°”å‘çš„æ–‡ç« èƒ½è¢«ç¿»ç‰Œåˆ°é¦–é¡µã€Œä¾å¯ã€ç€å®å¹¸è¿ï¼Œæˆ‘äº²çˆ±çš„å°ä¼™ä¼´å’Œæœ‹å‹ä»¬ï¼Œæ„Ÿè°¢ä¸ä½ ç›¸é‡ï¼Œæ›´æ„Ÿæ©ç›¸é‡å’Œç›¸çŸ¥ğŸ™ PMPPMP(Project Management Professional)ï¼Œä¿—ç§°ã€Œæ‹é©¬å±ã€ï¼Œå’Œã€Œåˆ«æ‘¸æˆ‘ã€æœ‰å¼‚æ›²åŒå·¥ä¹‹å¤„ğŸ˜‚ã€‚æ¯•ä¸šåå°±æ²¡è€ƒè¿‡è¯•ï¼Œæ„Ÿè§‰å‰ 20 å¤šå¹´çš„æŠ€èƒ½åŒ…å¿«ä¸¢æ²¡äº†ï¼Œçœ‹åˆ°æœ‹å‹æœ‰æ‹¿åˆ°PMP è¯ä¹¦çš„ï¼Œæ°é€¢å…¬å¸è¿˜ç»™æŠ¥é”€éƒ¨åˆ†è´¹ç”¨(è¿™å¾ˆå…³é”®)ï¼Œå†³å®šå°è¯•ä¸€é­ï¼Œ2019 å¹´ 9 æœˆæŠ¥åï¼Œ12 æœˆ 7 æ—¥è€ƒè¯•ï¼Œ2020 å¹´ 1 æœˆ 17 æ—¥æ‹¿åˆ°ç»“æœï¼Œ5A é€šè¿‡è€ƒè¯•ï¼Œé¡ºåˆ©æ‹¿åˆ°çºªå¿µç‰ˆçº¢è‰²è¯ä¹¦ã€‚ è€ƒè¯•æœ¬èº«æ„Ÿè§‰æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œä½†æ˜¯æ„Ÿè§‰å­¦ä¹ è¿‡ç¨‹çš„æ€ç»´ï¼Œæ€è€ƒæ¨¡å¼ä»¥åŠä¸€äº›è½¯æŠ€èƒ½è¿˜æ˜¯å€¼å¾—é•¿æœŸæ·±å…¥æ€è€ƒç¢ç£¨çš„ã€‚æœ‰å…´è¶£çš„æœ‹å‹å’±ä»¬èŠä¸€èŠ è¿åŠ¨æ•´ä¸ªä¸€å¹´è¿˜æ˜¯ä¿æŒäº†ç›¸å¯¹è§„å¾‹çš„è¿åŠ¨èŠ‚å¥ï¼ŒåŸºæœ¬ä¸€å‘¨ä¸€åœºç¾½æ¯›çƒï¼ŒKeep æ™¨ç»ƒ(æ—©æ™¨ç»ƒä¸€ä¼šç‘œä¼½æ‹‰ä¼¸ä¸€ä¸‹ç­‹éª¨æ„Ÿè§‰ä¸€å¤©éƒ½è½»æ¾äº†è®¸å¤š)ã€‚æ¯å¤©å¤šå‡ ç§’çš„ç´¯åŠ è®­ç»ƒï¼Œå¹³æ¿æ”¯æ’‘ï¼ˆplankï¼‰å¯ä»¥åšåˆ°åšæŒ 12 åˆ†é’Ÿã€‚ ä»¥ä¸ºè‡ªå·±è¦èµ·é£ï¼Œä¹°äº†å¥è…¹è½®ï¼Œæ ¸å¿ƒåŠ›é‡è¿˜æ˜¯ä¸è¶³ï¼Œè…°éƒ¨å—ä¼¤ï¼Œä¸€ä¸‹å›åˆ°è§£æ”¾å‰ã€‚ç›®å‰å·²ç»æ¢å¤è®­ç»ƒäº†ã€‚é™¤äº†æŒ‡å®šå­£èŠ‚çš„è¿‡æ•æ€§é¼»ç‚å¤–(æœ‰è‰¯æ–¹ï¼Œè¿˜è¯·ä¼¸å‡ºæ´åŠ©ä¹‹æ‰‹)ï¼Œèº«ä½“åŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆé—®é¢˜ã€‚ é¸¡æ±¤é¸¡æ±¤ä¸å–ä¸è¡Œï¼Œä½†å–å¤šäº†æˆ‘è®¤ä¸ºä¼šä¸­æ¯’ï¼Œæˆ‘æ‰¾åˆ°äº†æˆ‘çš„ä¸“å±é¸¡æ±¤ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ¬¾å‘³é“é†‡é¦™çš„é¸¡æ±¤ï¼Œå–è¿‡ä¹‹åè®©æˆ‘é£˜é£˜æ¬²ä»™ è¿˜æœ‰è¿™ç¨å¾®å‘æ¶©çš„é¸¡æ±¤ï¼Œå–è¿‡ä¹‹åå›å‘³æ— ç©·å•ŠğŸ˜‚ é¸¡æ±¤å‘³é“ä¸åŒï¼Œéƒ½å¾ˆè¡¥äººã€‚å¾—åˆ°è‚¯å®šï¼Œä¿æŒèŠ‚å¥ç»§ç»­å‰è¿›ï¼›è·å¾—æ‰¹è¯„ï¼Œæ€»ç»“åæ€åŠ ä»¥æé«˜ å°æˆæœ 2019 è‡³æ­¤å½’é›¶â€¦â€¦ï¼Œã€Œå¹¸è¿ã€å’Œã€Œè¸å®ã€ 2020 èµ°ä½ ä¸æ•¢æ†§æ†¬å¤ªå¤šï¼Œå…ˆå¥–åŠ±è‡ªå·±ä¸€åŒç¾½æ¯›çƒé‹å§ï¼Œçƒåœºä¸å—ä¼¤ï¼Œç”Ÿæ´»ä¸æ„Ÿä¼¤ï¼Œè…¹è‚Œå†å‘ä¸‹æŒªä¸¤å—ï¼Œå…¨æ–°å‘µæŠ¤è¿™é¢— 2019 å¹´ç§ä¸‹çš„æ ‘ï¼Œè„šè¸å®åœ°â€¦â€¦ å•æ›²è¿˜åœ¨å¾ªç¯ï¼Œå†™åˆ°è¿™ä»€ä¹ˆå¿ƒæƒ…å‘¢ï¼Ÿçœ‹çœ‹è¿™é¦–æ­Œçš„è¯„è®ºå§ï¼Œå°±æ˜¯è¿™ç§æ’å—å¢™çš„å¿ƒæ€å§ å—å¢™æ’çš„è¿˜æ˜¯æŒºç–¼ï¼Œå†™åˆ°è¿™å§ï¼Œæ„Ÿè°¢çœ‹åˆ°è¿™é‡Œçš„å¸…å“¥ç¾å¥³ä»¬ï¼Œè¯šå®çš„ä¸ºè‡ªå·±æ‹‰ä¸Šä¸€ç¥¨ï¼Œå–œæ¬¢çš„è¯ç»™ä¸ªèµï¼Œåˆ†äº«ï¼Œå…³æ³¨(å¥¢æ±‚æœ‰ç‚¹å¤š)ï¼ŒèƒŒååˆ›ä½œä¸æ˜“ï¼ŒåšæŒåšä¼˜è€Œç¾çš„æŠ€æœ¯å…¬ä¼—å·ã€‚è‡´æ•¬æœ‹å‹ï¼Œå¹²æ¯ğŸº (è¿™æ˜¯é¥®æ–™ï¼Œæˆ‘é…’ç²¾è¿‡æ•) çœŸçš„åˆ°è¿™é‡Œäº†ï¼Œæˆ‘è¦æ’ç‰ˆäº†â€¦..","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"å…¶ä»–","slug":"Life/å…¶ä»–","permalink":"https://dayarch.top/categories/Life/%E5%85%B6%E4%BB%96/"}],"tags":[{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://dayarch.top/tags/%E6%80%BB%E7%BB%93/"}]},{"title":"å°å°TODOä¹Ÿæœ‰å¤§é“ç†","slug":"å°å°TODOä¹Ÿæœ‰å¤§é“ç†","date":"2020-01-09T02:50:07.000Z","updated":"2020-02-07T02:31:08.756Z","comments":true,"path":"/p/how-to-use-todo-feature.html","link":"","permalink":"https://dayarch.top/p/how-to-use-todo-feature.html","excerpt":"å‰è¨€ æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ ‡è®°éƒ¨åˆ†ä»£ç ä»¥ä¾›å°†æ¥å‚è€ƒï¼Œæ¯”å¦‚: ä¼˜åŒ–ï¼Œæ”¹è¿›ï¼Œå¯èƒ½çš„æ›´æ”¹ï¼Œè¦è®¨è®ºçš„é—®é¢˜ç­‰ã€‚ é€šå¸¸æˆ‘ä»¬ä¼šåœ¨ä»£ç ä¸­åŠ å…¥å¦‚ä¸‹çš„æ ‡è®°è¡¨ç¤ºå¾…åŠ: 1 //TODO æˆ‘å°†è¦åœ¨è¿™é‡Œåš xxx ä½ è¿™æ ·åšï¼Œåˆ«äººä¹Ÿä¼šè¿™æ ·åšã€‚ä¸€æ—¶é—´ï¼Œé¡¹ç›®ä¸­å¯èƒ½ä¼šå­˜åœ¨å¤§é‡çš„ TODOï¼Œå½“ä½ æœå¯»ä½ çš„ TODO æ—¶ä¹Ÿå°±å˜å¾—éå¸¸éº»çƒ¦ï¼Œå¦‚åŒçŸ³æ²‰å¤§æµ·ï¼Œä¹Ÿå°±å¤±å»äº†è¿™ä¸ªæ ‡è®°çš„æ„ä¹‰ã€‚ IntelliJ IDEAå…è®¸æˆ‘ä»¬æ·»åŠ ç‰¹æ®Šç±»å‹çš„æ³¨é‡Šï¼Œä½¿å¾—è¿™äº›æ³¨é‡Šåœ¨ç¼–è¾‘å™¨ä¸­çªå‡ºæ˜¾ç¤ºï¼Œå®ƒä»¬è¢«ç´¢å¼•ï¼Œå¹¶åœ¨ TODO å·¥å…·çª—å£ ä¸­åˆ—å‡ºã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®¹æ˜“è¿½è¸ªè‡ªå·±çš„ TODO äº†ã€‚ é»˜è®¤çš„ TODO é»˜è®¤æƒ…å†µä¸‹ï¼ŒIntelliJ IDEAè¯†åˆ«ä¸¤ç§æ¨¡å¼ï¼š","text":"å‰è¨€æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ ‡è®°éƒ¨åˆ†ä»£ç ä»¥ä¾›å°†æ¥å‚è€ƒï¼Œæ¯”å¦‚: ä¼˜åŒ–ï¼Œæ”¹è¿›ï¼Œå¯èƒ½çš„æ›´æ”¹ï¼Œè¦è®¨è®ºçš„é—®é¢˜ç­‰ã€‚ é€šå¸¸æˆ‘ä»¬ä¼šåœ¨ä»£ç ä¸­åŠ å…¥å¦‚ä¸‹çš„æ ‡è®°è¡¨ç¤ºå¾…åŠ: 1//TODO æˆ‘å°†è¦åœ¨è¿™é‡Œåš xxx ä½ è¿™æ ·åšï¼Œåˆ«äººä¹Ÿä¼šè¿™æ ·åšã€‚ä¸€æ—¶é—´ï¼Œé¡¹ç›®ä¸­å¯èƒ½ä¼šå­˜åœ¨å¤§é‡çš„ TODOï¼Œå½“ä½ æœå¯»ä½ çš„ TODO æ—¶ä¹Ÿå°±å˜å¾—éå¸¸éº»çƒ¦ï¼Œå¦‚åŒçŸ³æ²‰å¤§æµ·ï¼Œä¹Ÿå°±å¤±å»äº†è¿™ä¸ªæ ‡è®°çš„æ„ä¹‰ã€‚ IntelliJ IDEAå…è®¸æˆ‘ä»¬æ·»åŠ ç‰¹æ®Šç±»å‹çš„æ³¨é‡Šï¼Œä½¿å¾—è¿™äº›æ³¨é‡Šåœ¨ç¼–è¾‘å™¨ä¸­çªå‡ºæ˜¾ç¤ºï¼Œå®ƒä»¬è¢«ç´¢å¼•ï¼Œå¹¶åœ¨ TODO å·¥å…·çª—å£ ä¸­åˆ—å‡ºã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®¹æ˜“è¿½è¸ªè‡ªå·±çš„ TODO äº†ã€‚ é»˜è®¤çš„ TODOé»˜è®¤æƒ…å†µä¸‹ï¼ŒIntelliJ IDEAè¯†åˆ«ä¸¤ç§æ¨¡å¼ï¼šå°å†™å’Œå¤§å†™çš„ TODO å’Œ FIXME è¿™äº›æ¨¡å¼å¯åœ¨ä»»ä½•å—æ”¯æŒæ–‡ä»¶ç±»å‹çš„è¡Œæ³¨é‡Šå’Œå—æ³¨é‡Šå†…éƒ¨ä½¿ç”¨ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹é»˜è®¤æ¨¡å¼æˆ–æ·»åŠ è‡ªå·±çš„æ¨¡å¼ å¦‚ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šè¡Œçš„ TODO (ç±»ä¼¼ Spring Boot ä¸­çš„ YAML é…ç½®å¤šä¸ªå€¼)ï¼Œéœ€è¦ç¼©è¿›ç¬¬ä¸€è¡Œä¹‹åçš„æ³¨é‡Šè¡Œã€‚å¦‚æœæ²¡æœ‰ç¼©è¿›ï¼Œåˆ™å°†è¡Œè§†ä¸ºå¸¸è§„æ³¨é‡Šè¡Œ è¦ç¦ç”¨å¤šè¡Œ TODO é¡¹ç›®ï¼Œä½¿ç”¨å¿«æ·é”® âŒ˜ + , æ‰“å¼€ Preferencesï¼Œ æœç´¢ TODO (Editor | TODO), ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ è¦æŸ¥çœ‹ç³»ç»Ÿä¸­çš„æ‰€æœ‰ TODOï¼Œè¯·æ‰“å¼€ TODO å·¥å…·çª—å£ (å¿«æ·é”® âŒ˜ + 6 )ã€‚åˆ‡æ¢é€‰é¡¹æŸ¥çœ‹ TODO èŒƒå›´: ä»å½“å‰é¡¹ç›®ä¸­çš„æ‰€æœ‰æ–‡ä»¶ ä»…åŸºäºå½“å‰æ–‡ä»¶çš„èŒƒå›´ æŒ‡å®šèŒƒå›´çš„æ–‡ä»¶ æ´»åŠ¨çš„å˜æ›´åˆ—è¡¨ åˆ°è¿™é‡Œ Intellij IDEA é»˜è®¤æä¾›çš„ TODO å°±ä»‹ç»å®Œäº†ï¼Œä¸ºäº†èƒ½æ›´å¿«çš„æ‰¾åˆ°æˆ‘ä»¬è‡ªå·±çš„ TODOï¼Œæˆ‘ä»¬å°±éœ€è¦è¿›è¡Œè‡ªå®šä¹‰ è‡ªå®šä¹‰ TODOé‡æ–°æ‰“å¼€ TODO ä½ç½®ï¼Œæ–°å¢ TODO itemï¼Œè¿™é‡Œæ–°å¢ optimizeï¼Œç”¨äºæ ‡è¯†å¾…ä¼˜åŒ–å†…å®¹ æ·»åŠ ä¸ªè¿‡æ»¤å™¨ï¼Œç”¨äº TODO çš„åˆ†ç»„ éšä¾¿æ·»åŠ ä¸€ä¸ªä¼˜åŒ–å¤‡æ³¨ï¼Œé€šè¿‡ä»¥ä¸Šä»‹ç»çš„åŠŸèƒ½ï¼Œå¿«é€Ÿå®šä½åˆ°æˆ‘ä»¬è‡ªå·±çš„ TODO å¦‚æœä½ çš„å¾…åŠäº‹é¡¹é€šå¸¸æ˜¯ç›¸å¯¹å›ºå®šçš„æè¿°ï¼Œä½ ä¹Ÿå¯ä»¥é…åˆ Live Template å¿«é€Ÿç”Ÿæˆ TODO å†…å®¹ æ€»ç»“å½“å›¢é˜Ÿè§„æ¨¡å¾ˆå¤§ï¼Œä½ åˆåŒæ—¶æœ‰å¾ˆå¤šå¾…åŠçš„æ—¶å€™ï¼ŒTODO ç‰¹æ€§å¯ä»¥å¸®åŠ©æˆ‘ä»¬åšæ ‡è¯†ï¼Œè‡ªå®šä¹‰ TODO å¯ä»¥å¸®æˆ‘ä»¬å¿«é€Ÿå®šä½ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œä½†æ˜¯ å®šæœŸæ¸…ç† TODO çµé­‚è¿½é—® ä½ è§‰å¾—é¡¹ç›®ä¸­ä»£ç æœ‰å“ªäº›ä¸è§„èŒƒ/ä¸å¤Ÿæ•´æ´çš„åœ°æ–¹ï¼Ÿ(æ¬¢è¿åˆ°åšå®¢ä¸‹æ–¹ç•™è¨€è®¨è®º)","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"å®‰å…¨-åè®®-è§„èŒƒ","slug":"Coding/å®‰å…¨-åè®®-è§„èŒƒ","permalink":"https://dayarch.top/categories/Coding/%E5%AE%89%E5%85%A8-%E5%8D%8F%E8%AE%AE-%E8%A7%84%E8%8C%83/"}],"tags":[{"name":"IntelliJ IDEA","slug":"IntelliJ-IDEA","permalink":"https://dayarch.top/tags/IntelliJ-IDEA/"}]},{"title":"åœ¨Spring Bootå¯åŠ¨æ—¶æ‰§è¡Œä»£ç çš„å‡ ç§æ–¹æ³•","slug":"åœ¨Spring-Bootå¯åŠ¨æ—¶æ‰§è¡Œä»£ç çš„å‡ ç§æ–¹æ³•","date":"2019-12-25T08:13:15.000Z","updated":"2019-12-26T06:43:01.889Z","comments":true,"path":"/p/spring-boot-execute-on-startup.html","link":"","permalink":"https://dayarch.top/p/spring-boot-execute-on-startup.html","excerpt":"å‰è¨€ æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰§è¡Œä¸€äº›ä»£ç ç‰‡æ®µï¼Œè¿™äº›ç‰‡æ®µå¯èƒ½æ˜¯ä»…ä»…æ˜¯ä¸ºäº†è®°å½• logï¼Œä¹Ÿå¯èƒ½æ˜¯åœ¨å¯åŠ¨æ—¶æ£€æŸ¥ä¸å®‰è£…è¯ä¹¦ ï¼Œè¯¸å¦‚ä¸Šè¿°ä¸šåŠ¡è¦æ±‚æˆ‘ä»¬å¯èƒ½ä¼šç»å¸¸ç¢°åˆ° Spring Boot æä¾›äº†è‡³å°‘ 5 ç§æ–¹å¼ç”¨äºåœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰§è¡Œä»£ç ã€‚æˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿæœ¬æ–‡å°†ä¼šé€æ­¥è§£é‡Šä¸åˆ†æè¿™å‡ ç§ä¸åŒæ–¹å¼ CommandLineRunner CommandLineRunner æ˜¯ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡å®ç°å®ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Spring åº”ç”¨æˆåŠŸå¯åŠ¨ä¹‹å æ‰§è¡Œä¸€äº›ä»£ç ç‰‡æ®µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 @Slf4j @Component @Order(2) public cl","text":"å‰è¨€æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰§è¡Œä¸€äº›ä»£ç ç‰‡æ®µï¼Œè¿™äº›ç‰‡æ®µå¯èƒ½æ˜¯ä»…ä»…æ˜¯ä¸ºäº†è®°å½• logï¼Œä¹Ÿå¯èƒ½æ˜¯åœ¨å¯åŠ¨æ—¶æ£€æŸ¥ä¸å®‰è£…è¯ä¹¦ ï¼Œè¯¸å¦‚ä¸Šè¿°ä¸šåŠ¡è¦æ±‚æˆ‘ä»¬å¯èƒ½ä¼šç»å¸¸ç¢°åˆ° Spring Boot æä¾›äº†è‡³å°‘ 5 ç§æ–¹å¼ç”¨äºåœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰§è¡Œä»£ç ã€‚æˆ‘ä»¬åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿæœ¬æ–‡å°†ä¼šé€æ­¥è§£é‡Šä¸åˆ†æè¿™å‡ ç§ä¸åŒæ–¹å¼ CommandLineRunnerCommandLineRunner æ˜¯ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡å®ç°å®ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Spring åº”ç”¨æˆåŠŸå¯åŠ¨ä¹‹å æ‰§è¡Œä¸€äº›ä»£ç ç‰‡æ®µ 123456789101112131415@Slf4j@Component@Order(2)public class MyCommandLineRunner implements CommandLineRunner &#123; @Override public void run(String... args) throws Exception &#123; log.info(\"MyCommandLineRunner order is 2\"); if (args.length &gt; 0)&#123; for (int i = 0; i &lt; args.length; i++) &#123; log.info(\"MyCommandLineRunner current parameter is: &#123;&#125;\", args[i]); &#125; &#125; &#125;&#125; å½“ Spring Boot åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­æ‰¾åˆ° CommandLineRunner beanï¼Œå®ƒå°†ä¼šåœ¨åº”ç”¨æˆåŠŸå¯åŠ¨ä¹‹åè°ƒç”¨ run() æ–¹æ³•ï¼Œå¹¶ä¼ é€’ç”¨äºå¯åŠ¨åº”ç”¨ç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•° é€šè¿‡å¦‚ä¸‹ maven å‘½ä»¤ç”Ÿæˆ jar åŒ…: 1mvn clean package é€šè¿‡ç»ˆç«¯å‘½ä»¤å¯åŠ¨åº”ç”¨ï¼Œå¹¶ä¼ é€’å‚æ•°: 1java -jar springboot-application-startup-0.0.1-SNAPSHOT.jar --foo=bar --name=rgyb æŸ¥çœ‹è¿è¡Œç»“æœ: åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå‡ ä¸ªé—®é¢˜: å‘½ä»¤è¡Œä¼ å…¥çš„å‚æ•°å¹¶æ²¡æœ‰è¢«è§£æï¼Œè€Œåªæ˜¯æ˜¾ç¤ºå‡ºæˆ‘ä»¬ä¼ å…¥çš„å­—ç¬¦ä¸²å†…å®¹ --foo=barï¼Œ--name=rgybï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ApplicationRunner è§£æï¼Œæˆ‘ä»¬ç¨åçœ‹ åœ¨é‡å†™çš„ run() æ–¹æ³•ä¸Šæœ‰ throws Exception æ ‡è®°ï¼ŒSpring Boot ä¼šå°† CommandLineRunner ä½œä¸ºåº”ç”¨å¯åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœè¿è¡Œ run() æ–¹æ³•æ—¶æŠ›å‡º Exceptionï¼Œåº”ç”¨å°†ä¼šç»ˆæ­¢å¯åŠ¨ æˆ‘ä»¬åœ¨ç±»ä¸Šæ·»åŠ äº† @Order(2) æ³¨è§£ï¼Œå½“æœ‰å¤šä¸ª CommandLineRunner æ—¶ï¼Œå°†ä¼šæŒ‰ç…§ @Order æ³¨è§£ä¸­çš„æ•°å­—ä»å°åˆ°å¤§æ’åº (æ•°å­—å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å¤æ•°) âš ï¸ä¸è¦ä½¿ç”¨ @Order å¤ªå¤šçœ‹åˆ° order è¿™ä¸ª â€œé»‘ç§‘æŠ€â€ æˆ‘ä»¬ä¼šè§‰å¾—å®ƒå¯ä»¥éå¸¸æ–¹ä¾¿å°†å¯åŠ¨é€»è¾‘æŒ‰ç…§æŒ‡å®šé¡ºåºæ‰§è¡Œï¼Œä½†å¦‚æœä½ è¿™ä¹ˆå†™ï¼Œè¯´æ˜å¤šä¸ªä»£ç ç‰‡æ®µæ˜¯æœ‰ç›¸äº’ä¾èµ–å…³ç³»çš„ï¼Œä¸ºäº†è®©æˆ‘ä»¬çš„ä»£ç æ›´å¥½ç»´æŠ¤ï¼Œæˆ‘ä»¬åº”è¯¥å‡å°‘è¿™ç§ä¾èµ–ä½¿ç”¨ å°ç»“å¦‚æœæˆ‘ä»¬åªæ˜¯æƒ³ç®€å•çš„è·å–ä»¥ç©ºæ ¼åˆ†éš”çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œé‚£ MyCommandLineRunner å°±è¶³å¤Ÿä½¿ç”¨äº† ApplicationRunnerä¸Šé¢æåˆ°ï¼Œé€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨å¹¶ä¼ é€’å‚æ•°ï¼ŒMyCommandLineRunner ä¸èƒ½è§£æå‚æ•°ï¼Œå¦‚æœè¦è§£æå‚æ•°ï¼Œé‚£æˆ‘ä»¬å°±è¦ç”¨åˆ° ApplicationRunner å‚æ•°äº† 1234567891011@Component@Slf4j@Order(1)public class MyApplicationRunner implements ApplicationRunner &#123; @Override public void run(ApplicationArguments args) throws Exception &#123; log.info(\"MyApplicationRunner order is 1\"); log.info(\"MyApplicationRunner Current parameter is &#123;&#125;:\", args.getOptionValues(\"foo\")); &#125;&#125; é‡æ–°æ‰“ jar åŒ…ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤: 1java -jar springboot-application-startup-0.0.1-SNAPSHOT.jar --foo=bar,rgyb è¿è¡Œç»“æœå¦‚ä¸‹: åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹å‡º: åŒ MyCommandLineRunner ç›¸ä¼¼ï¼Œä½† ApplicationRunner å¯ä»¥é€šè¿‡ run æ–¹æ³•çš„ ApplicationArguments å¯¹è±¡è§£æå‡ºå‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶ä¸”æ¯ä¸ªå‚æ•°å¯ä»¥æœ‰å¤šä¸ªå€¼åœ¨é‡Œé¢ï¼Œå› ä¸º getOptionValues æ–¹æ³•è¿”å› List æ•°ç»„ åœ¨é‡å†™çš„ run() æ–¹æ³•ä¸Šæœ‰ throws Exception æ ‡è®°ï¼ŒSpring Boot ä¼šå°† CommandLineRunner ä½œä¸ºåº”ç”¨å¯åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœè¿è¡Œ run() æ–¹æ³•æ—¶æŠ›å‡º Exceptionï¼Œåº”ç”¨å°†ä¼šç»ˆæ­¢å¯åŠ¨ ApplicationRunner ä¹Ÿå¯ä»¥ä½¿ç”¨ @Order æ³¨è§£è¿›è¡Œæ’åºï¼Œä»å¯åŠ¨ç»“æœæ¥çœ‹ï¼Œå®ƒä¸ CommandLineRunner å…±äº« order çš„é¡ºåºï¼Œç¨åæˆ‘ä»¬é€šè¿‡æºç æ¥éªŒè¯è¿™ä¸ªç»“è®º å°ç»“å¦‚æœæˆ‘ä»¬æƒ³è·å–å¤æ‚çš„å‘½ä»¤è¡Œå‚æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ApplicationRunner ApplicationListenerå¦‚æœæˆ‘ä»¬ä¸éœ€è¦è·å–å‘½ä»¤è¡Œå‚æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯åŠ¨é€»è¾‘ç»‘å®šåˆ° Spring çš„ ApplicationReadyEvent ä¸Š 12345678910@Slf4j@Component@Order(0)public class MyApplicationListener implements ApplicationListener&lt;ApplicationReadyEvent&gt; &#123; @Override public void onApplicationEvent(ApplicationReadyEvent applicationReadyEvent) &#123; log.info(\"MyApplicationListener is started up\"); &#125;&#125; è¿è¡Œç¨‹åºæŸ¥çœ‹ç»“æœ: åˆ°è¿™æˆ‘ä»¬å¯ä»¥çœ‹å‡º: ApplicationReadyEvent å½“ä¸”ä»…å½“ åœ¨åº”ç”¨ç¨‹åºå°±ç»ªä¹‹åæ‰è¢«è§¦å‘ï¼Œç”šè‡³æ˜¯è¯´ä¸Šé¢çš„ Listener è¦åœ¨æœ¬æ–‡è¯´çš„æ‰€æœ‰è§£å†³æ–¹æ¡ˆéƒ½æ‰§è¡Œäº†ä¹‹åæ‰ä¼šè¢«è§¦å‘ï¼Œæœ€ç»ˆç»“è®ºè¯·ç¨åçœ‹ ä»£ç ä¸­æˆ‘ç”¨ Order(0) æ¥æ ‡è®°ï¼Œæ˜¾ç„¶ ApplicationListener ä¹Ÿæ˜¯å¯ä»¥ç”¨è¯¥æ³¨è§£è¿›è¡Œæ’åºçš„ï¼ŒæŒ‰æ•°å­—å¤§å°æ’åºï¼Œåº”è¯¥æ˜¯æœ€å…ˆæ‰§è¡Œã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªé¡ºåºä»…ç”¨äºåŒç±»å‹çš„ ApplicationListener ä¹‹é—´çš„æ’åºï¼Œä¸å‰é¢æåˆ°çš„ ApplicationRunners å’Œ CommandLineRunners çš„æ’åºå¹¶ä¸å…±äº« å°ç»“å¦‚æœæˆ‘ä»¬ä¸éœ€è¦è·å–å‘½ä»¤è¡Œå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ ApplicationListener&lt;ApplicationReadyEvent&gt; åˆ›å»ºä¸€äº›å…¨å±€çš„å¯åŠ¨é€»è¾‘ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å®ƒè·å– Spring Boot æ”¯æŒçš„ configuration properties ç¯å¢ƒå˜é‡å‚æ•° å¦‚æœä½ çœ‹è¿‡æˆ‘ä¹‹å‰å†™çš„ Spring Bean ç”Ÿå‘½å‘¨æœŸä¸‰éƒ¨æ›²: Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜å°½ Spring Aware åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ é‚£ä¹ˆä½ ä¼šå¯¹ä¸‹é¢ä¸¤ç§æ–¹å¼éå¸¸ç†Ÿæ‚‰äº† @PostConstructåˆ›å»ºå¯åŠ¨é€»è¾‘çš„å¦ä¸€ç§ç®€å•è§£å†³æ–¹æ¡ˆæ˜¯æä¾›ä¸€ç§åœ¨ bean åˆ›å»ºæœŸé—´ç”± Spring è°ƒç”¨çš„åˆå§‹åŒ–æ–¹æ³•ã€‚æˆ‘ä»¬è¦åšçš„å°±åªæ˜¯å°† @PostConstruct æ³¨è§£æ·»åŠ åˆ°æ–¹æ³•ä¸­ï¼š 12345678910@Component@Slf4j@DependsOn(\"myApplicationListener\")public class MyPostConstructBean &#123; @PostConstruct public void testPostConstruct()&#123; log.info(\"MyPostConstructBean\"); &#125;&#125; æŸ¥çœ‹è¿è¡Œç»“æœ: ä»ä¸Šé¢è¿è¡Œç»“æœå¯ä»¥çœ‹å‡º: Spring åˆ›å»ºå®Œ beanä¹‹å (åœ¨å¯åŠ¨ä¹‹å‰)ï¼Œä¾¿ä¼šç«‹å³è°ƒç”¨ @PostConstruct æ³¨è§£æ ‡è®°çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ä½¿ç”¨ @Order æ³¨è§£å¯¹å…¶è¿›è¡Œè‡ªç”±æ’åºï¼Œå› ä¸ºå®ƒå¯èƒ½ä¾èµ–äº @Autowired æ’å…¥åˆ°æˆ‘ä»¬ bean ä¸­çš„å…¶ä»– Spring beanã€‚ ç›¸åï¼Œå®ƒå°†åœ¨ä¾èµ–äºå®ƒçš„æ‰€æœ‰ bean è¢«åˆå§‹åŒ–ä¹‹åè¢«è°ƒç”¨ï¼Œå¦‚æœè¦æ·»åŠ äººä¸ºçš„ä¾èµ–å…³ç³»å¹¶ç”±æ­¤åˆ›å»ºä¸€ä¸ªæ’åºï¼Œåˆ™å¯ä»¥ä½¿ç”¨ @DependsOn æ³¨è§£ï¼ˆè™½ç„¶å¯ä»¥æ’åºï¼Œä½†æ˜¯ä¸å»ºè®®ä½¿ç”¨ï¼Œç†ç”±å’Œ @Order ä¸€æ ·ï¼‰ å°ç»“@PostConstruct æ–¹æ³•å›ºæœ‰åœ°ç»‘å®šåˆ°ç°æœ‰çš„ Spring beanï¼Œå› æ­¤åº”ä»…å°†å…¶ç”¨äºæ­¤å•ä¸ª bean çš„åˆå§‹åŒ–é€»è¾‘ï¼› InitializingBeanä¸ @PostConstruct è§£å†³æ–¹æ¡ˆéå¸¸ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥å®ç° InitializingBean æ¥å£ï¼Œå¹¶è®© Spring è°ƒç”¨æŸä¸ªåˆå§‹åŒ–æ–¹æ³•: 12345678910@Component@Slf4jpublic class MyInitializingBean implements InitializingBean &#123; @Override public void afterPropertiesSet() throws Exception &#123; log.info(\"MyInitializingBean.afterPropertiesSet()\"); &#125;&#125; æŸ¥çœ‹è¿è¡Œç»“æœ: ä»ä¸Šé¢çš„è¿è¡Œç»“æœä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å’Œ @PostConstruct ä¸€æ ·çš„æ•ˆæœï¼Œä½†äºŒè€…è¿˜æ˜¯æœ‰å·®åˆ«çš„ âš ï¸ @PostConstruct å’Œ afterPropertiesSet åŒºåˆ« afterPropertiesSetï¼Œé¡¾åæ€ä¹‰ã€Œåœ¨å±æ€§è®¾ç½®ä¹‹åã€ï¼Œè°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œè¯¥ bean çš„æ‰€æœ‰å±æ€§å·²ç»è¢« Spring å¡«å……ã€‚å¦‚æœæˆ‘ä»¬åœ¨æŸäº›å±æ€§ä¸Šä½¿ç”¨ @Autowiredï¼ˆå¸¸è§„æ“ä½œåº”è¯¥ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥ï¼‰ï¼Œé‚£ä¹ˆ Spring å°†åœ¨è°ƒç”¨afterPropertiesSet ä¹‹å‰å°† bean æ³¨å…¥è¿™äº›å±æ€§ã€‚ä½† @PostConstruct å¹¶æ²¡æœ‰è¿™äº›å±æ€§å¡«å……é™åˆ¶ æ‰€ä»¥ InitializingBean.afterPropertiesSet è§£å†³æ–¹æ¡ˆæ¯”ä½¿ç”¨ @PostConstruct æ›´å®‰å…¨ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬ä¾èµ–å°šæœªè‡ªåŠ¨æ³¨å…¥çš„ @Autowired å­—æ®µï¼Œåˆ™ @PostConstruct æ–¹æ³•å¯èƒ½ä¼šé‡åˆ° NullPointerExceptions å°ç»“å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥ï¼Œåˆ™è¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆéƒ½æ˜¯ç­‰æ•ˆçš„ æºç åˆ†æè¯·æ‰“å¼€ä½ çš„ IDE (é‡ç‚¹ä»£ç å·²æ ‡è®°æ³¨é‡Š): MyCommandLineRunner å’Œ ApplicationRunner æ˜¯åœ¨ä½•æ—¶è¢«è°ƒç”¨çš„å‘¢ï¼Ÿ æ‰“å¼€ SpringApplication.java ç±»ï¼Œé‡Œé¢æœ‰ callRunners æ–¹æ³• 123456789101112131415161718192021private void callRunners(ApplicationContext context, ApplicationArguments args) &#123; List&lt;Object&gt; runners = new ArrayList&lt;&gt;(); //ä»ä¸Šä¸‹æ–‡è·å– ApplicationRunner ç±»å‹çš„ bean runners.addAll(context.getBeansOfType(ApplicationRunner.class).values()); //ä»ä¸Šä¸‹æ–‡è·å– CommandLineRunner ç±»å‹çš„ bean runners.addAll(context.getBeansOfType(CommandLineRunner.class).values()); //å¯¹äºŒè€…è¿›è¡Œæ’åºï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆäºŒè€…çš„ order æ˜¯å¯ä»¥å…±äº«çš„äº† AnnotationAwareOrderComparator.sort(runners); //éå†å¯¹å…¶è¿›è¡Œè°ƒç”¨ for (Object runner : new LinkedHashSet&lt;&gt;(runners)) &#123; if (runner instanceof ApplicationRunner) &#123; callRunner((ApplicationRunner) runner, args); &#125; if (runner instanceof CommandLineRunner) &#123; callRunner((CommandLineRunner) runner, args); &#125; &#125;&#125; å¼ºçƒˆå»ºè®®å®Œæ•´çœ‹ä¸€ä¸‹ SpringApplication.java çš„å…¨éƒ¨ä»£ç ï¼ŒSpring Boot å¯åŠ¨è¿‡ç¨‹åŠåŸç†éƒ½å¯ä»¥ä»è¿™ä¸ªç±»ä¸­æ‰¾åˆ°ä¸€äº›ç­”æ¡ˆ çµé­‚è¿½é—® ä¸Šé¢ç¨‹åºè¿è¡Œç»“æœï¼Œ afterPropertiesSet æ–¹æ³•è°ƒç”¨å…ˆäº @PostConstruct æ–¹æ³•ï¼Œä½†è¿™å’Œæˆ‘ä»¬åœ¨ Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· ä¸­çš„è°ƒç”¨é¡ºåºæ°æ°ç›¸åï¼Œä½ çŸ¥é“ä¸ºä»€ä¹ˆå—ï¼Ÿ MyPostConstructBean é€šè¿‡ @DependsOn(&quot;myApplicationListener&quot;) ä¾èµ–äº† MyApplicationListenerï¼Œä¸ºä»€ä¹ˆè°ƒç”¨ç»“æœå‰è€…å…ˆä¸åè€…å‘¢ï¼Ÿ ä¸ºä»€ä¹ˆä¸å»ºè®® @Autowired å½¢å¼ä¾èµ–æ³¨å…¥ åœ¨å†™ Spring Bean ç”Ÿå‘½å‘¨æœŸæ—¶å°±æœ‰æœ‹å‹é—®æˆ‘ä¸ä¹‹ç›¸å…³çš„é—®é¢˜ï¼Œæ˜¾ç„¶ä»–ä»¬åœ¨æ¦‚å¿µä¸Šæœ‰ä¸€äº›å«æ··ï¼Œæ‰€ä»¥ï¼Œä»”ç»†ç†è§£ä¸Šé¢çš„é—®é¢˜å°†ä¼šå¸®åŠ©ä½ åŠ æ·±å¯¹ Spring Bean ç”Ÿå‘½å‘¨æœŸçš„ç†è§£ Spring Bootåº”ç”¨å¯åŠ¨æ‰§è¡Œä»£ç æ¦‚è§ˆå›¾æœ€åç”»ä¸€å¼ å›¾ç”¨æ¥æ€»ç»“è¿™å‡ ç§æ–¹å¼","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Bean","slug":"Spring-Bean","permalink":"https://dayarch.top/tags/Spring-Bean/"},{"name":"ç”Ÿå‘½å‘¨æœŸ","slug":"ç”Ÿå‘½å‘¨æœŸ","permalink":"https://dayarch.top/tags/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"}]},{"title":"Spring Boot @ConfigurationProperties æ³¨è§£æœ€å¼ºä½¿ç”¨è¯¦è§£","slug":"Spring-Boot-ConfigurationProperties-æ³¨è§£æœ€å¼ºä½¿ç”¨è¯¦è§£","date":"2019-12-23T13:43:55.000Z","updated":"2019-12-23T13:56:35.162Z","comments":true,"path":"/p/spring-boot-configurationProperties-usage.html","link":"","permalink":"https://dayarch.top/p/spring-boot-configurationProperties-usage.html","excerpt":"å‰è¨€ åœ¨ç¼–å†™é¡¹ç›®ä»£ç æ—¶ï¼Œæˆ‘ä»¬è¦æ±‚æ›´çµæ´»çš„é…ç½®ï¼Œæ›´å¥½çš„æ¨¡å—åŒ–æ•´åˆã€‚åœ¨ Spring Boot é¡¹ç›®ä¸­ï¼Œä¸ºæ»¡è¶³ä»¥ä¸Šè¦æ±‚ï¼Œæˆ‘ä»¬å°†å¤§é‡çš„å‚æ•°é…ç½®åœ¨ application.properties æˆ– application.yml æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ @ConfigurationProperties æ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„è·å–è¿™äº›å‚æ•°å€¼ ä½¿ç”¨ @ConfigurationProperties é…ç½®æ¨¡å— å‡è®¾æˆ‘ä»¬æ­£åœ¨æ­å»ºä¸€ä¸ªå‘é€é‚®ä»¶çš„æ¨¡å—ã€‚åœ¨æœ¬åœ°æµ‹è¯•ï¼Œæˆ‘ä»¬ä¸æƒ³è¯¥æ¨¡å—çœŸçš„å‘é€é‚®ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‚æ•°æ¥ã€Œå¼€å…³ã€ disable è¿™ä¸ªåŠŸèƒ½ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºè¿™äº›é‚®ä»¶é…ç½®ä¸€ä¸ªé»˜è®¤çš„ä¸»é¢˜ï¼Œè¿™æ ·ï¼Œå½“æˆ‘ä»¬æŸ¥çœ‹é‚®ä»¶æ”¶ä»¶ç®±ï¼Œé€šè¿‡","text":"å‰è¨€åœ¨ç¼–å†™é¡¹ç›®ä»£ç æ—¶ï¼Œæˆ‘ä»¬è¦æ±‚æ›´çµæ´»çš„é…ç½®ï¼Œæ›´å¥½çš„æ¨¡å—åŒ–æ•´åˆã€‚åœ¨ Spring Boot é¡¹ç›®ä¸­ï¼Œä¸ºæ»¡è¶³ä»¥ä¸Šè¦æ±‚ï¼Œæˆ‘ä»¬å°†å¤§é‡çš„å‚æ•°é…ç½®åœ¨ application.properties æˆ– application.yml æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ @ConfigurationProperties æ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„è·å–è¿™äº›å‚æ•°å€¼ ä½¿ç”¨ @ConfigurationProperties é…ç½®æ¨¡å—å‡è®¾æˆ‘ä»¬æ­£åœ¨æ­å»ºä¸€ä¸ªå‘é€é‚®ä»¶çš„æ¨¡å—ã€‚åœ¨æœ¬åœ°æµ‹è¯•ï¼Œæˆ‘ä»¬ä¸æƒ³è¯¥æ¨¡å—çœŸçš„å‘é€é‚®ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‚æ•°æ¥ã€Œå¼€å…³ã€ disable è¿™ä¸ªåŠŸèƒ½ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºè¿™äº›é‚®ä»¶é…ç½®ä¸€ä¸ªé»˜è®¤çš„ä¸»é¢˜ï¼Œè¿™æ ·ï¼Œå½“æˆ‘ä»¬æŸ¥çœ‹é‚®ä»¶æ”¶ä»¶ç®±ï¼Œé€šè¿‡é‚®ä»¶ä¸»é¢˜å¯ä»¥å¿«é€Ÿåˆ¤æ–­å‡ºè¿™æ˜¯æµ‹è¯•é‚®ä»¶ åœ¨ application.properties æ–‡ä»¶ä¸­åˆ›å»ºè¿™äº›å‚æ•°: æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ @Value æ³¨è§£æˆ–ç€ä½¿ç”¨ Spring Environment bean è®¿é—®è¿™äº›å±æ€§ï¼Œæ˜¯è¿™ç§æ³¨å…¥é…ç½®æ–¹å¼æœ‰æ—¶æ˜¾å¾—å¾ˆç¬¨é‡ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹å¼(@ConfigurationProperties )æ¥è·å–è¿™äº›å±æ€§ @ConfigurationProperties çš„åŸºæœ¬ç”¨æ³•éå¸¸ç®€å•:æˆ‘ä»¬ä¸ºæ¯ä¸ªè¦æ•è·çš„å¤–éƒ¨å±æ€§æä¾›ä¸€ä¸ªå¸¦æœ‰å­—æ®µçš„ç±»ã€‚è¯·æ³¨æ„ä»¥ä¸‹å‡ ç‚¹: å‰ç¼€å®šä¹‰äº†å“ªäº›å¤–éƒ¨å±æ€§å°†ç»‘å®šåˆ°ç±»çš„å­—æ®µä¸Š æ ¹æ® Spring Boot å®½æ¾çš„ç»‘å®šè§„åˆ™ï¼Œç±»çš„å±æ€§åç§°å¿…é¡»ä¸å¤–éƒ¨å±æ€§çš„åç§°åŒ¹é… æˆ‘ä»¬å¯ä»¥ç®€å•åœ°ç”¨ä¸€ä¸ªå€¼åˆå§‹åŒ–ä¸€ä¸ªå­—æ®µæ¥å®šä¹‰ä¸€ä¸ªé»˜è®¤å€¼ ç±»æœ¬èº«å¯ä»¥æ˜¯åŒ…ç§æœ‰çš„ ç±»çš„å­—æ®µå¿…é¡»æœ‰å…¬å…± setter æ–¹æ³• Spring å®½æ¾ç»‘å®šè§„åˆ™ (relaxed binding)Springä½¿ç”¨ä¸€äº›å®½æ¾çš„ç»‘å®šå±æ€§è§„åˆ™ã€‚å› æ­¤ï¼Œä»¥ä¸‹å˜ä½“éƒ½å°†ç»‘å®šåˆ° hostName å±æ€§ä¸Š: å¦‚æœæˆ‘ä»¬å°† MailModuleProperties ç±»å‹çš„ bean æ³¨å…¥åˆ°å¦ä¸€ä¸ª bean ä¸­ï¼Œè¿™ä¸ª bean ç°åœ¨å¯ä»¥ä»¥ç±»å‹å®‰å…¨çš„æ–¹å¼è®¿é—®é‚£äº›å¤–éƒ¨é…ç½®å‚æ•°çš„å€¼ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦è®© Spring çŸ¥é“æˆ‘ä»¬çš„ @ConfigurationProperties ç±»å­˜åœ¨ï¼Œä»¥ä¾¿å°†å…¶åŠ è½½åˆ°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­( é¢è¯•è¿˜ä¸çŸ¥é“ BeanFactory å’Œ ApplicationContext çš„åŒºåˆ«ï¼Ÿ æ¿€æ´» @ConfigurationPropertieså¯¹äº Spring Bootï¼Œåˆ›å»ºä¸€ä¸ª MailModuleProperties ç±»å‹çš„ beanï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢å‡ ç§æ–¹å¼å°†å…¶æ·»åŠ åˆ°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ  @Component æ³¨è§£è®© Component Scan æ‰«æåˆ° å¾ˆæ˜¾ç„¶ï¼Œåªæœ‰å½“ç±»æ‰€åœ¨çš„åŒ…è¢« Spring @ComponentScan æ³¨è§£æ‰«æåˆ°æ‰ä¼šç”Ÿæ•ˆï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥æ³¨è§£ä¼šæ‰«æåœ¨ä¸»åº”ç”¨ç±»ä¸‹çš„æ‰€æœ‰åŒ…ç»“æ„ æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ Spring çš„ Java Configuration ç‰¹æ€§å®ç°åŒæ ·çš„æ•ˆæœ: åªè¦ MailModuleConfiguration ç±»è¢« Spring Boot åº”ç”¨æ‰«æåˆ°ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­è®¿é—® MailModuleProperties bean æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ @EnableConfigurationProperties æ³¨è§£è®©æˆ‘ä»¬çš„ç±»è¢« Spring Boot æ‰€çŸ¥é“ï¼Œåœ¨è¯¥æ³¨è§£ä¸­å…¶å®æ˜¯ç”¨äº†@Import(EnableConfigurationPropertiesImportSelector.class) å®ç°ï¼Œå¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹ æ¿€æ´»ä¸€ä¸ª @ConfigurationProperties ç±»çš„æœ€ä½³æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿæ‰€æœ‰ä¸Šè¿°æ–¹æ³•éƒ½åŒæ ·æœ‰æ•ˆã€‚ç„¶è€Œï¼Œæˆ‘å»ºè®®æ¨¡å—åŒ–ä½ çš„åº”ç”¨ç¨‹åºï¼Œå¹¶è®©æ¯ä¸ªæ¨¡å—æä¾›è‡ªå·±çš„@ConfigurationProperties ç±»ï¼Œåªæä¾›å®ƒéœ€è¦çš„å±æ€§ï¼Œå°±åƒæˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­å¯¹é‚®ä»¶æ¨¡å—æ‰€åšçš„é‚£æ ·ã€‚è¿™ä½¿å¾—åœ¨ä¸å½±å“å…¶ä»–æ¨¡å—çš„æƒ…å†µä¸‹é‡æ„ä¸€ä¸ªæ¨¡å—ä¸­çš„å±æ€§å˜å¾—å®¹æ˜“ã€‚ å› æ­¤ï¼Œæˆ‘ä¸å»ºè®®åœ¨åº”ç”¨ç¨‹åºç±»æœ¬èº«ä¸Šä½¿ç”¨ @EnableConfigurationPropertiesï¼Œå¦‚è®¸å¤šå…¶ä»–æ•™ç¨‹ä¸­æ‰€ç¤ºï¼Œæ˜¯åœ¨ç‰¹å®šäºæ¨¡å—çš„ @Configuration ç±»ä¸Šä½¿ç”¨@EnableConfigurationPropertiesï¼Œè¯¥ç±»ä¹Ÿå¯ä»¥åˆ©ç”¨åŒ…ç§æœ‰çš„å¯è§æ€§å¯¹åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†éšè—å±æ€§ã€‚ æ— æ³•è½¬æ¢çš„å±æ€§å¦‚æœæˆ‘ä»¬åœ¨ application.properties å±æ€§ä¸Šå®šä¹‰çš„å±æ€§ä¸èƒ½è¢«æ­£ç¡®çš„è§£æä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå‡å¦‚æˆ‘ä»¬ä¸ºåŸæœ¬åº”è¯¥ä¸ºå¸ƒå°”å€¼çš„å±æ€§æä¾›çš„å€¼ä¸º â€˜fooâ€™: é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Boot å°†ä¼šå¯åŠ¨å¤±è´¥ï¼Œå¹¶æŠ›å‡ºå¼‚å¸¸: 123456Failed to bind properties under 'myapp.mail.enabled' to java.lang.Boolean: Property: myapp.mail.enabled Value: foo Origin: class path resource [application.properties]:1:20 Reason: failed to convert java.lang.String to java.lang.Boolean å½“æˆ‘ä»¬ä¸ºå±æ€§é…ç½®é”™è¯¯çš„å€¼æ—¶ï¼Œè€Œåˆä¸å¸Œæœ› Spring Boot åº”ç”¨å¯åŠ¨å¤±è´¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½® ignoreInvalidFields å±æ€§ä¸º true (é»˜è®¤ä¸º false) è¿™æ ·ï¼ŒSpring Boot å°†ä¼šè®¾ç½® enabled å­—æ®µä¸ºæˆ‘ä»¬åœ¨ Java ä»£ç é‡Œè®¾å®šå¥½çš„é»˜è®¤å€¼ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰è®¾ç½®é»˜è®¤å€¼ï¼Œenabled å°†ä¸º nullï¼Œå› ä¸ºè¿™é‡Œå®šä¹‰çš„æ˜¯ boolean çš„åŒ…è£…ç±» Boolean æœªçŸ¥çš„å±æ€§å’Œä¸Šé¢çš„æƒ…å†µæœ‰äº›ç›¸åï¼Œå¦‚æœæˆ‘ä»¬åœ¨ application.properties æ–‡ä»¶æä¾›äº† MailModuleProperties ç±»ä¸çŸ¥é“çš„å±æ€§ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Boot ä¼šå¿½ç•¥é‚£äº›ä¸èƒ½ç»‘å®šåˆ° @ConfigurationProperties ç±»å­—æ®µçš„å±æ€§ ç„¶è€Œï¼Œå½“é…ç½®æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªå±æ€§å®é™…ä¸Šæ²¡æœ‰ç»‘å®šåˆ° @ConfigurationProperties ç±»æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›å¯åŠ¨å¤±è´¥ã€‚ä¹Ÿè®¸æˆ‘ä»¬ä»¥å‰ä½¿ç”¨è¿‡è¿™ä¸ªé…ç½®å±æ€§ï¼Œä½†æ˜¯å®ƒå·²ç»è¢«åˆ é™¤äº†ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬å¸Œæœ›è¢«è§¦å‘å‘ŠçŸ¥æ‰‹åŠ¨ä» application.properties åˆ é™¤è¿™ä¸ªå±æ€§ ä¸ºäº†å®ç°ä¸Šè¿°æƒ…å†µï¼Œæˆ‘ä»¬ä»…éœ€è¦å°† ignoreUnknownFields å±æ€§è®¾ç½®ä¸º false (é»˜è®¤æ˜¯ true) ç°åœ¨ï¼Œåº”ç”¨å¯åŠ¨æ—¶ï¼Œæ§åˆ¶å°ä¼šåé¦ˆæˆ‘ä»¬å¼‚å¸¸ä¿¡æ¯ 123456Binding to target [Bindable@cf65451 type = com.example.configurationproperties.properties.MailModuleProperties, value = 'provided', annotations = array&lt;Annotation&gt;[@org.springframework.boot.context.properties.ConfigurationProperties(value=myapp.mail, prefix=myapp.mail, ignoreInvalidFields=false, ignoreUnknownFields=false)]] failed: Property: myapp.mail.unknown-property Value: foo Origin: class path resource [application.properties]:3:29 Reason: The elements [myapp.mail.unknown-property] were left unbound. å¼ƒç”¨è­¦å‘Šâš ï¸(Deprecation Warning) ignoreUnknownFields åœ¨æœªæ¥ Spring Boot çš„ç‰ˆæœ¬ä¸­ä¼šè¢«æ ‡è®°ä¸º deprecatedï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½æœ‰ä¸¤ä¸ªå¸¦æœ‰ @ConfigurationProperties çš„ç±»ï¼ŒåŒæ—¶ç»‘å®šåˆ°äº†åŒä¸€ä¸ªå‘½åç©ºé—´ (namespace) ä¸Šï¼Œå…¶ä¸­ä¸€ä¸ªç±»å¯èƒ½çŸ¥é“æŸä¸ªå±æ€§ï¼Œå¦ä¸€ä¸ªç±»å´ä¸çŸ¥é“æŸä¸ªå±æ€§ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å¯åŠ¨å¤±è´¥ å¯åŠ¨æ—¶æ ¡éªŒ @ConfigurationPropertieså¦‚æœæˆ‘ä»¬å¸Œæœ›é…ç½®å‚æ•°åœ¨ä¼ å…¥åˆ°åº”ç”¨ä¸­æ—¶æœ‰æ•ˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å­—æ®µä¸Šæ·»åŠ  bean validation æ³¨è§£ï¼ŒåŒæ—¶åœ¨ç±»ä¸Šæ·»åŠ  @Validated æ³¨è§£ å¦‚æœæˆ‘ä»¬å¿˜è®°åœ¨ application.properties æ–‡ä»¶è®¾ç½® enabled å±æ€§ï¼Œå¹¶ä¸”è®¾ç½® defaultSubject ä¸ºç©º åº”ç”¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°†ä¼šå¾—åˆ° BindValidationException 123456789Binding to target org.springframework.boot.context.properties.bind.BindException: Failed to bind properties under 'myapp.mail' to com.example.configurationproperties.properties.MailModuleProperties failed: Property: myapp.mail.enabled Value: null Reason: must not be null Property: myapp.mail.defaultSubject Value: null Reason: must not be empty å½“ç„¶è¿™äº›é»˜è®¤çš„éªŒè¯æ³¨è§£ä¸èƒ½æ»¡è¶³ä½ çš„éªŒè¯è¦æ±‚ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ³¨è§£ å¦‚æœä½ çš„éªŒè¯é€»è¾‘å¾ˆç‰¹æ®Šï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶ç”¨ @PostConstruct æ ‡è®°ï¼Œå¦‚æœéªŒè¯å¤±è´¥ï¼Œæ–¹æ³•æŠ›å‡ºå¼‚å¸¸å³å¯, å…³äº @PostConstructï¼Œå¯ä»¥æŸ¥çœ‹ Spring Bean çš„ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· å¤æ‚å±æ€§ç±»å‹å¤šæ•°æƒ…å†µï¼Œæˆ‘ä»¬ä¼ é€’ç»™åº”ç”¨çš„å‚æ•°æ˜¯åŸºæœ¬çš„å­—ç¬¦ä¸²æˆ–æ•°å­—ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¼ é€’è¯¸å¦‚ List çš„æ•°æ®ç±»å‹ List å’Œ Setå‡å¦‚ï¼Œæˆ‘ä»¬ä¸ºé‚®ä»¶æ¨¡å—æä¾›äº†ä¸€ä¸ª SMTP æœåŠ¡çš„åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è¯¥å±æ€§åˆ° MailModuleProperties ç±»ä¸­ æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼è®© Spring Boot è‡ªåŠ¨å¡«å……è¯¥ list å±æ€§ application.propertiesåœ¨ application.properties æ–‡ä»¶ä¸­ä»¥æ•°ç»„å½¢å¼ä¹¦å†™ application.ymlYAML æœ¬èº«æ”¯æŒ list ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ application.yml æ–‡ä»¶ä¸­æ·»åŠ : set é›†åˆä¹Ÿæ˜¯è¿™ç§æ–¹å¼çš„é…ç½®æ–¹å¼ï¼Œä¸å†é‡å¤ä¹¦å†™ã€‚å¦å¤–YAML æ˜¯æ›´å¥½çš„é˜…è¯»æ–¹å¼ï¼Œå±‚æ¬¡åˆ†æ˜ï¼Œæ‰€ä»¥åœ¨å®é™…åº”ç”¨ä¸­æ›´æ¨èå¤§å®¶ä½¿ç”¨è¯¥ç§æ–¹å¼åšæ•°æ®é…ç½® DurationSpring Boot å†…ç½®æ”¯æŒä»é…ç½®å‚æ•°ä¸­è§£æ durations (æŒç»­æ—¶é—´)ï¼Œå®˜ç½‘æ–‡æ¡£ ç»™å‡ºäº†æ˜ç¡®çš„è¯´æ˜ æˆ‘ä»¬æ—¢å¯ä»¥é…ç½®æ¯«ç§’æ•°æ•°å€¼ï¼Œä¹Ÿå¯é…ç½®å¸¦æœ‰å•ä½çš„æ–‡æœ¬: å®˜ç½‘ä¸Šå·²æ˜ç¡®è¯´æ˜ï¼Œé…ç½® duration ä¸å†™å•ä½ï¼Œé»˜è®¤æŒ‰ç…§æ¯«ç§’æ¥æŒ‡å®šï¼Œæˆ‘ä»¬ä¹Ÿå¯å·²é€šè¿‡ @DurationUnit æ¥æŒ‡å®šå•ä½: å¸¸ç”¨å•ä½å¦‚ä¸‹: ns for nanoseconds (çº³ç§’) us for microseconds (å¾®ç§’) ms for milliseconds (æ¯«ç§’) s for seconds (ç§’) m for minutes (åˆ†) h for hours (æ—¶) d for days (å¤©) DataSizeä¸ Duration çš„ç”¨æ³•ä¸€æ¯›ä¸€æ ·ï¼Œé»˜è®¤å•ä½æ˜¯ byte (å­—èŠ‚)ï¼Œå¯ä»¥é€šè¿‡ @DataSizeUnit å•ä½æŒ‡å®š: æ·»åŠ é…ç½® ä½†æ˜¯ï¼Œæˆ‘æµ‹è¯•çš„æ—¶å€™æ‰“å°å‡ºæ¥ç»“æœéƒ½æ˜¯ä»¥ B (bytes) æ¥æ˜¾ç¤º å¸¸è§å•ä½å¦‚ä¸‹: B for bytes KB for kilobytes MB for megabytes GB for gigabytes TB for terabytes è‡ªå®šä¹‰ç±»å‹æœ‰äº›æƒ…å†µï¼Œæˆ‘ä»¬æƒ³è§£æé…ç½®å‚æ•°åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„å¯¹è±¡ç±»å‹ä¸Šï¼Œå‡è®¾ï¼Œæˆ‘ä»¬æˆ‘ä»¬è®¾ç½®æœ€å¤§åŒ…è£¹é‡é‡: åœ¨ MailModuleProperties ä¸­æ·»åŠ  Weight å±æ€§ æˆ‘ä»¬å¯ä»¥æ¨¡ä»¿ DataSize å’Œ Duration åˆ›é€ è‡ªå·±çš„ converter (è½¬æ¢å™¨) å°†å…¶æ³¨å†Œåˆ° Spring Boot ä¸Šä¸‹æ–‡ä¸­ @ConfigurationPropertiesBinding æ³¨è§£æ˜¯è®© Spring Boot çŸ¥é“ä½¿ç”¨è¯¥è½¬æ¢å™¨åšæ•°æ®ç»‘å®š ä½¿ç”¨ Spring Boot Configuration Processor å®Œæˆè‡ªåŠ¨è¡¥å…¨æˆ‘ä»¬å‘é¡¹ç›®ä¸­æ·»åŠ ä¾èµ–: Maven Gradle é‡æ–° build é¡¹ç›®ä¹‹åï¼Œconfiguration processor ä¼šä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª JSON æ–‡ä»¶: è¿™æ ·ï¼Œå½“æˆ‘ä»¬åœ¨ application.properties å’Œ application.yml ä¸­å†™é…ç½®çš„æ—¶å€™ä¼šæœ‰è‡ªåŠ¨æé†’: æ ‡è®°é…ç½®å±æ€§ä¸º Deprecatedconfiguration processor å…è®¸æˆ‘ä»¬æ ‡è®°æŸä¸€ä¸ªå±æ€§ä¸º deprecated æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ  @DeprecatedConfigurationProperty æ³¨è§£åˆ°å­—æ®µçš„ getter æ–¹æ³•ä¸Šï¼Œæ¥æ ‡ç¤ºè¯¥å­—æ®µä¸º deprecatedï¼Œé‡æ–° build é¡¹ç›®ï¼Œçœ‹çœ‹ JSON æ–‡ä»¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ å½“æˆ‘ä»¬å†ç¼–å†™é…ç½®æ–‡ä»¶æ—¶ï¼Œå·²ç»ç»™å‡ºäº†æ˜ç¡® deprecated æç¤º: æ€»ç»“Spring Boot çš„ @ConfigurationProperties æ³¨è§£åœ¨ç»‘å®šç±»å‹å®‰å…¨çš„ Java Bean æ—¶æ˜¯éå¸¸å¼ºå¤§çš„ï¼Œæˆ‘ä»¬å¯ä»¥é…åˆå…¶æ³¨è§£å±æ€§å’Œ @DeprecatedConfigurationProperty æ³¨è§£è·å–åˆ°æ›´å‹å¥½çš„ç¼–ç¨‹æ–¹å¼ï¼ŒåŒæ—¶è¿™æ ·è®©æˆ‘ä»¬çš„é…ç½®æ›´åŠ æ¨¡å—åŒ–ã€‚ é™„åŠ è¯´æ˜ä»¥ä¸º @ConfigurationProperties æ³¨è§£æ»¡è¶³æˆ‘ä»¬çš„å…¨éƒ¨éœ€è¦äº†å—ï¼Ÿå…¶å®ä¸ç„¶ï¼ŒSpring å®˜ç½‘æ˜ç¡®ç»™å‡ºäº†è¯¥æ³¨è§£å’Œ @Value æ³¨è§£çš„å¯¹æ¯”: å¦‚æœä½¿ç”¨ SpEL è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬åªèƒ½é€‰æ‹© @Value æ³¨è§£ å¦å¤–æˆ‘ä¹‹å‰åœ¨é˜…è¯» RabbitMQ æºç æ—¶ï¼Œå‘ç° RabbitProperties ç±»å……åˆ†çš„åˆ©ç”¨äº† @ConfigurationProperties æ³¨è§£ç‰¹æ€§: deprecated Duration Enum åµŒå¥—å±æ€§ æ„Ÿè§‰è‡ªå·±åçŸ¥åè§‰ï¼Œæœ€è¿‘åœ¨æ€è€ƒï¼Œä¸ºä»€ä¹ˆå°æ—¶å€™è¦é˜…è¯»å’ŒèƒŒè¯µå¤è¯—è¯ï¼Œæ–‡è¨€æ–‡ç­‰ç»å…¸ï¼Œå› ä¸ºè¿™æ ·å†™æ–‡ç« å°±å¯ä»¥è½»æ¾ç†Ÿç»ƒçš„å¼•ç”¨ç»å…¸ã€‚æŠ€æœ¯ä¹Ÿä¸€æ ·ï¼Œå„ç§æ¡†æ¶çš„æºç å°±æ˜¯å­¦ç”Ÿæ—¶ä»£çš„å¤è¯—è¯å’Œæ–‡è¨€æ–‡ï¼Œæˆ‘ä»¬è¦å¤šå¤šæŸ¥çœ‹é˜…è¯»ï¼Œç”šè‡³èƒŒè¯µç¼–ç¨‹æ€æƒ³ï¼Œè¿™æ ·å°±å¯ä»¥å†™å‡ºè¶Šæ¥è¶Šä¼˜é›…çš„ä»£ç  å…³äº @ConfigurationProperties æ³¨è§£çš„ä½¿ç”¨ï¼Œè¿™é‡Œæ¨è RabbitMQ Github æºç ï¼Œåªéœ€çœ‹è¿™ä¸€ä¸ªç±»å°±å¯ä»¥ï¼ŒçŸ¥é“æ€æ ·å……åˆ†åˆ©ç”¨è¿™ä¸ªæ³¨è§£. Demo ä»£ç è·å–ï¼Œå›å¤å…¬ä¼—å·ã€Œdemoã€ï¼Œæ‰“å¼€é“¾æ¥æŸ¥çœ‹å¯¹åº”çš„å­æ–‡ä»¶å¤¹å³å¯","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"}]},{"title":"Spring Aware åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ","slug":"Spring-Aware-åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ","date":"2019-12-22T11:20:52.000Z","updated":"2019-12-23T13:57:39.955Z","comments":true,"path":"/p/spring-aware.html","link":"","permalink":"https://dayarch.top/p/spring-aware.html","excerpt":"é€šè¿‡å¦‚ä¸‹å‰åºä¸¤ç¯‡æ–‡ç« : 1. Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· 2. Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜å°½ æˆ‘ä»¬äº†è§£äº† Spring Bean çš„ç”Ÿå‘½å‘¨æœŸæ ¸å¿ƒå†…å®¹ï¼Œbean æ˜¯å¦‚ä½•è¢«åˆå§‹åŒ–å˜ä¸º Ready for Use çš„çŠ¶æ€ï¼Œå½“èµ„æºè¢«å›æ”¶æ—¶åˆæ˜¯å¦‚ä½•è¢« destroy çš„ï¼Œä½† Spring Bean Life Cycleå›¾å¹¶æœªè¢«å…¨éƒ¨ç‚¹äº®ï¼Œè¿™ç¯‡æ–‡ç« å°†ç‚¹äº®å‰©ä½™å†…å®¹ï¼ŒåŒæ—¶è¯´è¯´ä½ å¸¸è§çš„ XxxxAware æ¥å£ ä¸ºä»€ä¹ˆè¦è¯´ Spring Bean ç”Ÿå‘½å‘¨æœŸåˆè¯´ Aware å‘¢ï¼Ÿä¸‹æ¥ç‚¹äº®å‰©ä¸‹å†…å®¹ä½ ä¹Ÿè®¸å°±æ˜ç™½äº†ï¼š 1. åœ¨ Spring Bean Ready for Us","text":"é€šè¿‡å¦‚ä¸‹å‰åºä¸¤ç¯‡æ–‡ç« : Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜å°½æˆ‘ä»¬äº†è§£äº† Spring Bean çš„ç”Ÿå‘½å‘¨æœŸæ ¸å¿ƒå†…å®¹ï¼Œbean æ˜¯å¦‚ä½•è¢«åˆå§‹åŒ–å˜ä¸º Ready for Use çš„çŠ¶æ€ï¼Œå½“èµ„æºè¢«å›æ”¶æ—¶åˆæ˜¯å¦‚ä½•è¢« destroy çš„ï¼Œä½† Spring Bean Life Cycleå›¾å¹¶æœªè¢«å…¨éƒ¨ç‚¹äº®ï¼Œè¿™ç¯‡æ–‡ç« å°†ç‚¹äº®å‰©ä½™å†…å®¹ï¼ŒåŒæ—¶è¯´è¯´ä½ å¸¸è§çš„ XxxxAware æ¥å£ ä¸ºä»€ä¹ˆè¦è¯´ Spring Bean ç”Ÿå‘½å‘¨æœŸåˆè¯´ Aware å‘¢ï¼Ÿä¸‹æ¥ç‚¹äº®å‰©ä¸‹å†…å®¹ä½ ä¹Ÿè®¸å°±æ˜ç™½äº†ï¼š åœ¨ Spring Bean Ready for Useä¹‹å‰çš„èµ·æºå½“ç„¶æ˜¯è¦è°ƒç”¨æ„é€ å™¨ï¼Œæ‰€ä»¥ Constructor æ¯‹åº¸ç½®ç–‘æ˜¯åˆ›å»º Spring Bean çš„ç¬¬ä¸€æ­¥ é€šè¿‡ Setter æ–¹æ³•å®Œæˆä¾èµ–æ³¨å…¥ï¼ŒSDI ï¼ˆSetter Dependency Injectionï¼‰ ä¾èµ–æ³¨å…¥ä¸€æ—¦ç»“æŸï¼ŒBeanNameAware.setBeanName() ä¼šè¢«è°ƒç”¨ï¼Œå®ƒè®¾ç½®è¯¥ bean åœ¨ Bean Factory ä¸­çš„åç§° æ¥ä¸‹æ¥è°ƒç”¨ BeanClassLoaderAware.setBeanClassLoader()ï¼Œä¸º bean å®ä¾‹æä¾›ç±»åŠ è½½å™¨ï¼Œæˆ‘ä»¬çŸ¥é“æ‰€æœ‰ç±»éƒ½æ˜¯è¦é€šè¿‡ç±»åŠ è½½å™¨åŠ è½½åˆ°ä¸Šä¸‹æ–‡çš„ï¼Œå…³äºç±»çš„åŠ è½½æœºåˆ¶/åŒäº²å§”æ´¾æ¨¡å‹ï¼ˆå¤§å‚éƒ½çˆ±é—®çš„é¢è¯•é¢˜ï¼‰å†…å®¹ä¼šåœ¨åç»­ç»™å‡ºæ¥ï¼Œè®©ä½ é€å½»çš„äº†è§£ ç„¶å BeanFactoryAware.setBeanFactory() ä¼šè¢«è°ƒç”¨ä¸º bean å®ä¾‹æä¾›å…¶æ‰€æ‹¥æœ‰çš„ factory å…³äº 1ã€2 ä¸¤ç‚¹æˆ‘è¦é¢å¤–å¤šè¯´ä¸€äº›å†…å®¹ï¼Œè¯·çœ‹ä¸‹é¢ä»£ç ï¼š è¿™é‡Œï¼Œæˆ‘ä»¬å°è¯•é€šè¿‡æ„é€ å™¨è®¿é—®è‡ªåŠ¨æ³¨å…¥çš„ field Environment envï¼Œå½“æ„é€ å™¨è¢«è°ƒç”¨æ—¶ï¼ŒSpring Bean è¿˜æ²¡è¢«å®Œå…¨åˆå§‹åŒ–ï¼Œè¿™å°±ä¼šå¯¼è‡´ NullPointerExceptionsï¼›æˆ‘ä»¬å˜æ¢ä¸€ä¸‹æ–¹å¼ï¼š è¿™ç§æ–¹å¼ï¼ŒEnvironment å®ä¾‹è¢«å®‰å…¨æ³¨å…¥ä¹‹åæ‰è°ƒç”¨ @PostConstructæ ‡è®°çš„æ–¹æ³•ï¼Œè¿™æ ·å°±ä¸ä¼šæŠ›å‡º NullPointerException äº†ã€‚ è¿™ä¼šå›çœ‹å‘¨æœŸå›¾ï¼Œæœ‰æ²¡æœ‰è±ç„¶å¼€æœ—ï¼Ÿ ç­‰æ‰€æœ‰ Spring Bean éƒ½å®Œæˆä¾èµ–æ³¨å…¥ï¼ˆå‘¨æœŸå›¾ä¸­çš„ Setter Methods éƒ¨åˆ†ï¼‰å†ä½¿ç”¨ bean çš„å¼•ç”¨æ‰æ˜¯å®‰å…¨çš„æ–¹å¼ï¼Œ åç»­ä¼šæœ‰ä¸€ä¸ªç« èŠ‚ä¸“é—¨è¯´ä¸€è¯´é¢è¯•ç»å¸¸è¢«é—®èµ·çš„ Spring æœ‰å‡ ç§ä¾èµ–æ³¨å…¥æ–¹å¼çš„å°´å°¬é—®é¢˜ï¼Œè¯·å…³æ³¨åç»­æ–‡ç«  åˆ°è¿™é‡Œç»ˆäºå¯ä»¥è¯´ä¸€è¯´ Aware äº†ï¼Œä¸”çœ‹ AwareAware æ˜¯ Spring ä¸­çš„ä¸€ä¸ªæ ¹æ¥å£ï¼Œç»§æ‰¿è¯¥æ¥å£çš„å­æ¥å£æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å‘¨æœŸå›¾ä¸­çš„é‚£ä¸‰ä¸ª Awareï¼Œä½†æ˜¯è¯¥æ¥å£æ²¡æœ‰ä»»ä½•æ–¹æ³•ï¼Œæ‰€ä»¥å¤§å®¶å¯ä»¥æŠŠå®ƒç†è§£æˆä¸€ä¸ªæ ‡è®°æ¥å£ï¼š Aware ç¿»è¯‘è¿‡æ¥å¯ä»¥ç†è§£ä¸ºâ€å¯Ÿè§‰çš„ï¼›æ³¨æ„åˆ°çš„ï¼›æ„ŸçŸ¥çš„â€ ï¼ŒXxxxAware ä¹Ÿå°±æ˜¯å¯¹â€¦.æ„ŸçŸ¥çš„ï¼Œæ²¡æœ‰ Aware å°±æ˜¯æ— æ„ŸçŸ¥çš„å—ï¼Ÿå¯¹å–½ Spring çš„ä¾èµ–æ³¨å…¥æœ€å¤§äº®ç‚¹å°±æ˜¯æ‰€æœ‰çš„ Bean å¯¹ Spring å®¹å™¨çš„å­˜åœ¨æ˜¯æ²¡æœ‰æ„è¯†çš„ï¼Œæ‹¿ Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· æ–‡ç« ä¸­â€œå°å­¦ç”Ÿå…¥å°‘å…ˆé˜Ÿâ€ä¸ºä¾‹å­è¯´æ˜ï¼Œå°å­¦ç”Ÿè¿˜æ˜¯é‚£ä¸ªå°å­¦ç”Ÿï¼ŒåŠ å…¥å°‘å…ˆé˜Ÿè¿˜æ˜¯åŠ å…¥å…±é’å›¢åªä¸è¿‡è§„åˆ™ä¸ä¸€æ ·ç½¢äº†ä½†æ˜¯åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸å¯é¿å…çš„è¦ç”¨åˆ° Spring å®¹å™¨æœ¬èº«æä¾›çš„èµ„æºï¼ˆéš¾å…è¦æœ‰äº‹æƒ…éœ€è¦å°‘å…ˆé˜Ÿç»„ç»‡çš„å¸®åŠ©ï¼‰ï¼Œè¿™æ—¶å€™è¦è®© Bean ä¸»åŠ¨æ„è¯†åˆ° Spring å®¹å™¨çš„å­˜åœ¨ï¼Œæ‰èƒ½è°ƒç”¨ Spring æ‰€æä¾›çš„èµ„æºï¼Œè¿™å°±æ˜¯ Spring Aware. å…¶å® Spring Aware æ˜¯ Spring è®¾è®¡ä¸ºæ¡†æ¶å†…éƒ¨ä½¿ç”¨çš„ï¼Œè‹¥ä½¿ç”¨äº†ï¼Œä½ çš„ Bean å°†ä¼šå’Œ Spring æ¡†æ¶è€¦åˆï¼Œæ‰€ä»¥è‡ªå·±ä¸å•ç‹¬ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨è¯»æ¡†æ¶æºç æ—¶å¸Œæœ›ä½ ä¸å†æ¨¡ç³Š. å¸¸è§çš„ Spring Aware æ¥å£ Awareå­æ¥å£ æè¿° BeanNameAware è·å–å®¹å™¨ä¸­ Bean çš„åç§° BeanFactoryAware è·å–å½“å‰ BeanFactory ï¼Œè¿™æ ·å¯ä»¥è°ƒç”¨å®¹å™¨çš„æœåŠ¡ ApplicationContextAware åŒä¸Šï¼Œåœ¨BeanFactory å’Œ ApplicationContext çš„åŒºåˆ« ä¸­å·²æ˜ç¡®è¯´æ˜ MessageSourceAware è·å– Message Source ç›¸å…³æ–‡æœ¬ä¿¡æ¯ ApplicationEventPublisherAware å‘å¸ƒäº‹ä»¶ ResourceLoaderAware è·å–èµ„æºåŠ è½½å™¨ï¼Œè¿™æ ·è·å–å¤–éƒ¨èµ„æºæ–‡ä»¶ æ¥çœ‹ç±»å…³ç³»å›¾ï¼š å½“ç„¶ä¸æ­¢ä»¥ä¸Šè¿™äº› Awareï¼Œ é€šå¸¸ä½¿ç”¨ Spring Aware çš„ç›®çš„æ˜¯ä¸ºäº†è®© Bean è·å¾— Spring å®¹å™¨çš„æœåŠ¡ã€‚ ä»£ç ç¤ºä¾‹BeanNameAwareè‡ªå®šä¹‰ bean å®ç° BeanNameAware æ³¨å†Œ bean è¿è¡Œ å’Œé¢„æƒ³ä¸€æ ·ï¼ŒBean Name è¾“å‡ºç»“æœä¸º myCustomBeanNameï¼Œå¦‚æœç§»é™¤æ‰ @Bean æ³¨è§£çš„ name å±æ€§ï¼Œ è¾“å‡ºç»“æœä¸º getMyBeanName æ€»ç»“åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨ä»»ä½• Aware æ¥å£ï¼Œé™¤éæˆ‘ä»¬éœ€è¦å®ƒä»¬ã€‚å®ç°è¿™äº›æ¥å£ä¼šå°†ä»£ç è€¦åˆåˆ°Springæ¡†æ¶ï¼Œä½†æ˜¯å¸Œæœ›çœ‹è¿‡æœ¬èŠ‚å†…å®¹ä¹‹åé˜…è¯»æ¡†æ¶æºç æ€ç»´æ›´åŠ æ¸…æ™° çµé­‚è¿½é—® æ¡†æ¶ä¸­æœ‰å“ªäº›ç»å…¸çš„ Aware åº”ç”¨ï¼Ÿ åˆ°ç°åœ¨ä½ èƒ½å¾ˆå¥½çš„ç†è§£ Spring Bean çš„ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿ Demoä»£ç æ¶‰åŠåˆ° Spring Bean ç”Ÿå‘½å‘¨æœŸçš„æµ‹è¯•ä»£ç ç”±äºå†…å®¹è¾ƒå¤šï¼Œæ²¡æœ‰å†™åœ¨æ­¤å¤„ï¼Œå…³æ³¨å…¬ä¼—å·å¹¶å›å¤ ã€Œdemoã€è·å–ç›¸å…³ä»£ç ï¼Œè¯·è‡ªè¡Œå°è¯•è¿è¡Œç»“æœ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Aware","slug":"Spring-Aware","permalink":"https://dayarch.top/tags/Spring-Aware/"},{"name":"Spring Bean","slug":"Spring-Bean","permalink":"https://dayarch.top/tags/Spring-Bean/"},{"name":"ç”Ÿå‘½å‘¨æœŸ","slug":"ç”Ÿå‘½å‘¨æœŸ","permalink":"https://dayarch.top/tags/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"}]},{"title":"Spring Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜å°½","slug":"Spring-Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜å°½","date":"2019-12-21T09:23:42.000Z","updated":"2019-12-21T10:12:36.099Z","comments":true,"path":"/p/spring-bean-lifecycle-destroy.html","link":"","permalink":"https://dayarch.top/p/spring-bean-lifecycle-destroy.html","excerpt":"ä¸Šä¸€ç¯‡æ–‡ç«  Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· è¯´æ˜äº†æˆ‘æ˜¯è°ï¼Ÿ å’Œ æˆ‘ä»å“ªé‡Œæ¥? çš„ä¸¤å¤§å“²å­¦é—®é¢˜ï¼Œä»Šå¤©æˆ‘ä»¬è¦è®¨è®ºä¸€ä¸‹ç»ˆæå“²å­¦æˆ‘è¦åˆ°å“ªé‡Œå»ï¼Ÿ åˆå§‹åŒ– Spring Bean æœ‰ä¸‰ç§æ–¹å¼ï¼š 1. @PostConstruct 2. InitializingBean.afterPropertiesSet() 3. init-method é”€æ¯ Spring Bean åŒæ ·æœ‰ä¸‰ç§æ–¹å¼ï¼š 1. @PreDestroy 2. DisposableBean.destroy() 3. destroy-method æ­£æ‰€è°“ï¼Œå¤©å¯¹åœ°ï¼Œé›¨å¯¹é£ï¼› @PostConstruct å¯¹ @Pre","text":"ä¸Šä¸€ç¯‡æ–‡ç«  Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ· è¯´æ˜äº†æˆ‘æ˜¯è°ï¼Ÿ å’Œ æˆ‘ä»å“ªé‡Œæ¥? çš„ä¸¤å¤§å“²å­¦é—®é¢˜ï¼Œä»Šå¤©æˆ‘ä»¬è¦è®¨è®ºä¸€ä¸‹ç»ˆæå“²å­¦æˆ‘è¦åˆ°å“ªé‡Œå»ï¼Ÿ åˆå§‹åŒ– Spring Bean æœ‰ä¸‰ç§æ–¹å¼ï¼š @PostConstruct InitializingBean.afterPropertiesSet() init-method é”€æ¯ Spring Bean åŒæ ·æœ‰ä¸‰ç§æ–¹å¼ï¼š @PreDestroy DisposableBean.destroy() destroy-method æ­£æ‰€è°“ï¼Œå¤©å¯¹åœ°ï¼Œé›¨å¯¹é£ï¼› @PostConstruct å¯¹ @PreDestroyï¼›InitializingBean.afterPropertiesSet() å¯¹ DisposableBean.destroy()ï¼› init-method å¯¹ destroy-methodï¼›é›·éšéšï¼Œé›¾è’™è’™ï¼›å±±èŠ±å¯¹æµ·æ ‘ï¼Œèµ¤æ—¥å¯¹è‹ç©¹ï¼›å¹³ä»„å¹³ä»„å¹³å¹³ä»„ï¼Œä»„å¹³ä»„å¹³ä»„ä»„å¹³ï¼Œä»„ä»„å¹³â€¦â€¦ æ„Ÿè§‰è®²åˆ°è¿™æ²¡å¿…è¦è®²ä¸‹å»äº†ï¼Œä¸€åˆ‡æ¸…æ™°æ˜äº†ï¼Œä½†æˆ‘è¿˜æœ‰è¯è¦è¯´ å½“ Spring Ioc å®¹å™¨è¦ç§»é™¤ bean æ—¶ï¼Œé”€æ¯ç›¸å…³å›è°ƒæ–¹æ³•å°†ä¼šè¢«æ‰§è¡Œï¼Œè¿™ä¹ˆåšçš„ç›®çš„æ—¶é‡Šæ”¾è¢« bean æŒæœ‰çš„èµ„æºï¼Œæˆ–è€…å»æ‰§è¡Œä¸€äº›ç»ˆæä»»åŠ¡. å½“ ApplicationContext è°ƒç”¨ registerShutdownHook æ–¹æ³•æ—¶ï¼Œè¿™äº›é”€æ¯æ–¹æ³•å°±ä¼šè¢«è§¦å‘ï¼Œä½†ä¸€èˆ¬æ­£å¸¸çš„ä¸šåŠ¡ä¸­å¾ˆå°‘ä¼šç”¨åˆ°è¿™äº›æ–¹æ³• æ¥ä¸‹æ¥å…·ä½“çš„å±•ç¤ºä¸€ä¸‹ä¸‰ç§æ–¹æ³•çš„ä½¿ç”¨æ–¹å¼ ä¸‰ç§é”€æ¯ Spring Bean çš„æ–¹å¼DisposableBeanSpring ä¸ºæˆ‘ä»¬æä¾›äº† DisposableBean æ¥å£ æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç° DisposableBean æ¥å£ï¼Œåœ¨å…¶å”¯ä¸€æ–¹æ³• destroy å†…å®Œæˆ bean é”€æ¯çš„å·¥ä½œï¼Œä½†æ˜¯ Spring Framework å®˜æ–¹å¹¶ä¸å»ºè®®æˆ‘ä»¬é€šè¿‡è¿™ç§æ–¹æ³•æ¥é”€æ¯ beanï¼Œè¿™åŒæ ·æ˜¯ä¸€ç§å¼ºè€¦åˆçš„æ–¹å¼ï¼Œæˆ‘ä»¬çœ‹åˆ°æ¡†æ¶å±‚é¢æ‰ä¼šç”¨åˆ°è¿™ä¸ªæ–¹æ³•ã€‚ @PreDestroyè¿™ç§æ–¹å¼æ˜¯ Spring éå¸¸æå€¡çš„ä¸€ç§æ–¹å¼ï¼Œæˆ‘ä»¬é€šå¸¸å°†å…¶æ ‡è®°åœ¨æ–¹æ³•ä¸Šå³å¯ï¼Œé€šå¸¸ä¹ æƒ¯å°†è¿™ä¸ªæ–¹æ³•èµ·åä¸º destory() destroy-methodåŒæ ·æ˜¯ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€ç§æ–¹å¼ï¼š ç¬¬äºŒç§æ–¹å¼ ä»¥ä¸Šä¸‰ç§ Bean çš„é”€æ¯æ–¹å¼ä¹Ÿæ˜¯å¯ä»¥ç»„åˆä½¿ç”¨çš„ï¼Œé‚£ä¹ˆç»„åˆåœ¨ä¸€èµ·çš„è°ƒç”¨é¡ºåºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ é¦–å…ˆ @PreDestroy ä¼šè¢«è°ƒç”¨ å…¶æ¬¡ DisposableBean.destroy() ä¼šè¢«è°ƒç”¨ æœ€åè°ƒç”¨é€šè¿‡ XML é…ç½®çš„ destroy-method æ–¹æ³•æˆ–é€šè¿‡è®¾ç½® @Bean æ³¨è§£ è®¾ç½® destroyMethod å±æ€§çš„æ–¹æ³• ç”¨å›¾ç¤ºæ¥è¯´æ˜ä¸€ä¸‹è°ƒç”¨é¡ºåº è¿™ä¸ªè°ƒç”¨é¡ºåºä¹Ÿä¸éš¾è®°å¿† PreDestroy (P)ï¼Œdestroy (D)ï¼Œdestroy-method (D) â€”&gt; PDD ï¼ˆé‚£ä¸ª3äº¿äººéƒ½åœ¨ pin çš„é‚£ä¸ª APP åç§°ï¼Œç›®å‰ 3 äº¿äººä¸­æ²¡æœ‰æˆ‘ï¼‰ å†æ¥çœ‹çœ‹ Spring Bean ç”Ÿå‘½å‘¨æœŸå›¾ï¼Œæˆ‘ä»¬å·²ç»ç‚¹äº®äº†æ ¸å¿ƒéƒ¨åˆ†ï¼š æˆ‘ä»¬è¦æ³¨æ„ï¼Œåœ¨é”€æ¯çš„è¿‡ç¨‹å¹¶æ²¡æœ‰ç±»ä¼¼ BeanPostProcess é‚£ä¸­åˆ‡é¢çš„æ€æƒ³ï¼Œè¿™é‡Œè¦æ³¨æ„åˆ°åŒºåˆ«ã€‚ çµé­‚è¿½é—® åœ¨é˜…è¯»æ¡†æ¶æºç æ—¶ï¼Œå“ªäº›åœ°æ–¹ç”¨åˆ°äº† bean çš„é”€æ¯æ–¹æ³•ï¼Ÿ è¿˜æ²¡æœ‰è¢«ç‚¹äº®çš„åœ°æ–¹ï¼Œä½ è®¤ä¸ºè¿˜æœ‰å“ªäº›å†…å®¹æ²¡æœ‰åšï¼Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Bean","slug":"Spring-Bean","permalink":"https://dayarch.top/tags/Spring-Bean/"},{"name":"ç”Ÿå‘½å‘¨æœŸ","slug":"ç”Ÿå‘½å‘¨æœŸ","permalink":"https://dayarch.top/tags/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"}]},{"title":"Spring Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ·","slug":"Spring-Beanç”Ÿå‘½å‘¨æœŸä¹‹ç¼˜èµ·","date":"2019-12-20T01:04:56.000Z","updated":"2019-12-21T10:12:29.078Z","comments":true,"path":"/p/spring-bean-lifecycle-creation.html","link":"","permalink":"https://dayarch.top/p/spring-bean-lifecycle-creation.html","excerpt":"Spring bean çš„ç”Ÿå‘½å‘¨æœŸå¾ˆå®¹æ˜“ç†è§£ã€‚å®ä¾‹åŒ– bean æ—¶ï¼Œå¯èƒ½éœ€è¦æ‰§è¡Œä¸€äº›åˆå§‹åŒ–ä»¥ä½¿å…¶è¿›å…¥å¯ç”¨ ï¼ˆReady for Useï¼‰çŠ¶æ€ã€‚ç±»ä¼¼åœ°ï¼Œå½“ä¸å†éœ€è¦ bean å¹¶å°†å…¶ä»å®¹å™¨ä¸­ç§»é™¤æ—¶ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›æ¸…ç†ï¼Œè¿™å°±æ˜¯å®ƒçš„ç”Ÿå‘½å‘¨æœŸ ä¸Šä¸€ç¯‡æ–‡ç«  é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ ä¸­è¯´æ˜äº†æ¥å£ Beanfactory å’Œ Applicationcontext å¯ä»¥é€šè¿‡ T getBean(String name, Class requiredType) æ–¹æ³•ä» Spring å®¹å™¨ä¸­è·å–beanï¼ŒåŒºåˆ«æ˜¯ï¼Œå‰è€…æ˜¯æ‡’åŠ è½½å½¢å¼ï¼Œåè€…æ˜¯é¢„åŠ è½½çš„å½¢å¼","text":"Spring bean çš„ç”Ÿå‘½å‘¨æœŸå¾ˆå®¹æ˜“ç†è§£ã€‚å®ä¾‹åŒ– bean æ—¶ï¼Œå¯èƒ½éœ€è¦æ‰§è¡Œä¸€äº›åˆå§‹åŒ–ä»¥ä½¿å…¶è¿›å…¥å¯ç”¨ ï¼ˆReady for Useï¼‰çŠ¶æ€ã€‚ç±»ä¼¼åœ°ï¼Œå½“ä¸å†éœ€è¦ bean å¹¶å°†å…¶ä»å®¹å™¨ä¸­ç§»é™¤æ—¶ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›æ¸…ç†ï¼Œè¿™å°±æ˜¯å®ƒçš„ç”Ÿå‘½å‘¨æœŸ ä¸Šä¸€ç¯‡æ–‡ç«  é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ ä¸­è¯´æ˜äº†æ¥å£ Beanfactory å’Œ Applicationcontext å¯ä»¥é€šè¿‡ T getBean(String name, Class&lt;T&gt; requiredType) æ–¹æ³•ä» Spring å®¹å™¨ä¸­è·å–beanï¼ŒåŒºåˆ«æ˜¯ï¼Œå‰è€…æ˜¯æ‡’åŠ è½½å½¢å¼ï¼Œåè€…æ˜¯é¢„åŠ è½½çš„å½¢å¼ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š è¿™äº› Spring Beans æ˜¯æ€ä¹ˆç”Ÿæˆå‡ºæ¥çš„å‘¢ï¼Ÿ åœ¨æ­£å¼å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆè§£ç­”ä¸€äº›æœ‰å…³ Java Beanï¼Œ Spring Bean å’Œ Spring IoC å®¹å™¨è¿™äº›æ¦‚å¿µæ€§çš„ç–‘æƒ‘ï¼Œæˆ‘å¸Œæœ›é€šè¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­å½¢è±¡è¯´æ˜è¿™äº›é—®é¢˜ï¼š å°å­¦ç”Ÿ ï¼ˆJava Beanï¼‰é€šè¿‡æäº¤èµ„æ–™ç”³è¯·ï¼ˆå…ƒæ•°æ®é…ç½®ï¼‰åŠ å…¥äº†å°‘å…ˆé˜Ÿï¼ˆSpring Ioc å®¹å™¨ï¼‰ï¼Œå­¦ä¹ äº†ä¸€äº›ç²¾ç¥ä¸è§„å®šä¹‹åï¼Œå˜æˆäº†å°‘å…ˆé˜Ÿå‘˜ï¼ˆSpring Beanï¼‰ ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒJava Bean å’Œ Spring Bean éƒ½æ˜¯å…·æœ‰ç‰¹å®šåŠŸèƒ½çš„å¯¹è±¡ï¼Œå°å­¦ç”Ÿè¿˜æ˜¯é‚£ä¸ªå°å­¦ç”Ÿï¼Œåªä¸è¿‡åŠ å…¥äº†å°‘å…ˆé˜Ÿä¹‹åæœ‰äº†æ–°çš„èº«ä»½ï¼Œæ–°çš„èº«ä»½è¦æŒ‰ç…§ç»„ç»‡ ï¼ˆSpring Iocï¼‰çš„è§„å®šå±¥è¡Œç‰¹å®šä¹‰åŠ¡ æ¥çœ‹ä¸‹å›¾åŠ æ·±ä¸€ä¸‹äº†è§£ é¦–å…ˆè¦æœ‰å®¹å™¨ï¼Œå®ä¾‹åŒ– Spring Ioc å®¹å™¨æ˜¯éå¸¸ç®€å•çš„ï¼Œæ¥å£ org.springframework.context.ApplicationContext è¡¨ç¤ºSpring IoCå®¹å™¨ï¼Œè´Ÿè´£å®ä¾‹åŒ–ï¼Œé…ç½®å’Œç»„è£…ä¸Šè¿° beanã€‚ å®¹å™¨é€šè¿‡è¯»å–é…ç½®å…ƒæ•°æ®è·å–æœ‰å…³è¦å®ä¾‹åŒ–ï¼Œé…ç½®å’Œç»„è£…çš„å¯¹è±¡çš„æŒ‡ä»¤ã€‚ é…ç½®å…ƒæ•°æ®é€šå¸¸ä»¥XMLï¼ŒJava æ³¨è§£æˆ–ä»£ç çš„å½¢å¼è¡¨ç¤ºã€‚ å®ƒå…è®¸ä½ è‡ªå·±è¡¨è¾¾ç»„æˆåº”ç”¨ç¨‹åºçš„å¯¹è±¡ä»¥åŠè¿™äº›å¯¹è±¡ä¹‹é—´ä¸°å¯Œçš„ç›¸äº’ä¾èµ–æ€§ï¼Œæ¯”å¦‚è¿™æ ·ï¼š 1ApplicationContext context = new ClassPathXmlApplicationContext(new String[] &#123;\"spring.xml\", \"spring1.xml\"&#125;); æœ‰äº†å®¹å™¨ï¼Œæˆ‘ä»¬éœ€è¦åšå“ªäº›å¤„ç†ï¼Œä½¿å…¶å†…éƒ¨å¯¹è±¡å˜ä¸º Ready for Use çš„çŠ¶æ€? æˆ‘ä»¬éœ€è¦é€šè¿‡ Spring å®¹å™¨å®ä¾‹åŒ–å®ƒä»¬ï¼ŒSpring ä¸ºæˆ‘ä»¬æä¾›äº†ä¸‰ç§æ–¹å¼ï¼š ä¸‰ç§åˆå§‹åŒ–æ–¹å¼InitializingBeanSpring ä¸ºæˆ‘ä»¬æä¾›äº† InitializingBean æ¥å£ 123public interface InitializingBean &#123; void afterPropertiesSet() throws Exception;&#125; æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç° InitializingBean æ¥å£ï¼Œåœ¨å…¶å”¯ä¸€æ–¹æ³• afterPropertiesSet å†…å®Œæˆå®ä¾‹åŒ–çš„å·¥ä½œï¼Œä½†æ˜¯ Spring Framework å®˜æ–¹å¹¶ä¸å»ºè®®æˆ‘ä»¬é€šè¿‡è¿™ç§æ–¹æ³•æ¥å®Œæˆ Bean çš„å®ä¾‹åŒ–ï¼Œè¿™æ˜¯ä¸€ç§å¼ºè€¦åˆçš„æ–¹å¼ï¼Œæˆ‘ä»¬çœ‹åˆ°æ¡†æ¶å±‚é¢æ‰ä¼šç”¨åˆ°è¿™ä¸ªæ–¹æ³•ã€‚ @PostConstructè¿™ç§æ–¹å¼æ˜¯ Spring éå¸¸æå€¡çš„ä¸€ç§æ–¹å¼ï¼Œæˆ‘ä»¬é€šå¸¸å°†å…¶æ ‡è®°åœ¨æ–¹æ³•ä¸Šå³å¯ï¼Œé€šå¸¸ä¹ æƒ¯å°†è¿™ä¸ªæ–¹æ³•èµ·åä¸º init() 1234@PostConstructpublic void init() &#123; System.out.println(\"Inside init() method...\");&#125; init-methodä½ åº”è¯¥è§è¿‡è¿™ç§åˆå§‹åŒ–æ–¹å¼ï¼š 12345678910111213public class MyClass &#123; public void init() &#123; // perform post-creation logic here &#125;&#125;@Configurationpublic class AppConfig &#123; @Bean(initMethod = \"init\") public MyClass myclass() &#123; return new MyClass (); &#125;&#125; ä½ ä¹Ÿåº”è¯¥è§è¿‡è¿™ç§é…ç½®æ–¹å¼ï¼š 1&lt;bean id=\"myClass\" class=\"com.demo.MyClass\" init-method=\"init\"/&gt; æ²¡é”™ï¼Œè¿™åªæ˜¯åŒæ ·åŠŸèƒ½çš„ä¸åŒå®ç°æ–¹å¼ç½¢äº†ä»¥ä¸Šå°±æ˜¯ä¸‰ç§åˆå§‹åŒ– Spring Beans çš„æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨æ¡†æ¶ä¸­çœ‹åˆ°è¿‡ä¸‰ç§æ–¹å¼åœ¨ç»„åˆä½¿ç”¨ï¼Œé‚£ä¹ˆç»„åˆä½¿ç”¨çš„è°ƒç”¨é¡ºåºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ é¦–å…ˆ@PostConstruct ä¼šè¢«æœ€å…ˆè°ƒç”¨ å…¶æ¬¡ InitializingBean.afterPropertiesSet() æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨ æœ€åè°ƒç”¨é€šè¿‡ XML é…ç½®çš„ init-method æ–¹æ³•æˆ–é€šè¿‡è®¾ç½® @Bean æ³¨è§£ è®¾ç½® initMethod å±æ€§çš„æ–¹æ³• äº†è§£äº†è¿™äº›ï¼Œä½ ä¹Ÿå°±äº†è§£äº† Spring Bean æ˜¯æ€ä¹ˆæ¥çš„äº† é€šè¿‡å›¾ç¤ºæ¥è¯´æ˜ä¸€ä¸‹ï¼š è¿™ä¸ªè°ƒç”¨é¡ºåºå¾ˆéš¾è®°å¿†å—å—ï¼Ÿ PostConstruct (P)ï¼ŒafterPropertiesSet (A)ï¼Œinit-method (I) â€”&gt; PAI ï¼ˆåœ†å‘¨ç‡Ï€ï¼‰ BeanPostProcessorBeanPostProcessor æ¥å£ï¼Œå¤§å®¶ä¹Ÿåº”è¯¥æœ‰å°è±¡ï¼Œé‡Œé¢åªæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š 12345public interface BeanPostProcessor &#123; Object postProcessBeforeInitialization(Object var1, String var2) throws BeansException; Object postProcessAfterInitialization(Object var1, String var2) throws BeansException;&#125; çœ‹æ–¹æ³•åï¼ŒBeforeInitialization å’Œ AfterInitializationï¼Œæˆ‘ä»¬åº”è¯¥çŒœå¾—å‡ºï¼Œè¿™æ˜¯åœ¨ä¸Šè¿°ä¸‰ç§æ–¹å¼çš„å‰å’Œåï¼Œç®—æ˜¯ä¸€ç§å…¨å±€çš„åˆ‡é¢æ€æƒ³ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨ postProcessAfterInitialization æ–¹æ³•ï¼Œé€šè¿‡è¯»å– Bean çš„æ³¨è§£å®Œæˆä¸€äº›åç»­é€»è¾‘ç¼–å†™ä¸å±æ€§çš„è®¾å®šï¼Œç°åœ¨ Ready for Useä¹‹å‰æ˜¯è¿™æ ·ï¼š åœ¨ Ready for Use ä¹‹å‰ï¼Œäº†è§£è¿™äº›å†…å®¹ï¼Œå·²å¯ä»¥åŸºæœ¬æ»¡è¶³æ—¥å¸¸çš„å·¥ä½œå†…å®¹ï¼Œä½†è¿™å¹¶ä¸æ˜¯ Ready for Use çš„å…¨éƒ¨å†…å®¹ï¼ŒSpring Bean æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„æµç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œåç»­æ–‡ç« ä¼šé€æ­¥ç‚¹äº®ï¼š çµé­‚è¿½é—® äº†è§£äº† Spring Bean æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿé‚£å®ƒæ˜¯æ€ä¹ˆæ²¡çš„å‘¢ï¼Ÿä»€ä¹ˆæ—¶å€™éœ€è¦é”€æ¯ä»–ä»¬å‘¢ï¼Ÿ Spring æ¡†æ¶ä¸­ XxxxAwareï¼Œè¿™äº›ç±»æœ‰ä»€ä¹ˆä½œç”¨ï¼Œèƒ½åœ¨ Ready for Use ä¹‹å‰æœ‰ç”¨å¤„å—ï¼Ÿ ä½ æ—¥å¸¸çš„å·¥ä½œä¸­æœ‰å……åˆ†åˆ©ç”¨ä»Šå¤©è¯´æ˜çš„è¿™äº›å†…å®¹å—ï¼Ÿæ‡‚å¾—è¿™äº›ä¼šå¤§å¤§æ–¹ä¾¿ä½ çš„ç¼–ç¨‹ è¡¥å……è¯´æ˜ è™½ç„¶å½“ä¸‹æµè¡Œä»¥æ³¨è§£å£°æ˜æ–¹å¼è¿›è¡Œç¼–ç¨‹ï¼Œç”šè‡³é«˜ç‰ˆæœ¬ Spring ä¼šå°†ä¸€äº›æ–¹æ³•æ ‡è®°ä¸ºè¿‡æ—¶ï¼Œä½†æ–‡ç« è¯´æ˜ä¾æ—§ä¼šä½¿ç”¨ XMLBeanFactory è¿™ç±»æ–¹æ³•ï¼ŒåŒ…æ‹¬ XML é…ç½®ã€‚è¿™æ ·åšï¼Œåªä¸è¿‡ä¸ºäº†æ›´æ¸…æ™°çš„è¯´æ˜é—®é¢˜ã€‚ å¦å¤–å°† Spring Bean å£°æ˜å‘¨æœŸçš„è®²è§£ï¼Œè¿›è¡Œæ‹†åˆ†ï¼Œæ˜¯ä¸ºäº†è®©å¤§å®¶æœ‰ç‹¬ç«‹çš„æ€è€ƒç©ºé—´ï¼Œå¸¦ç€é—®é¢˜å»æ€è€ƒã€æ—¶é—´ï¼Œè€Œä¸æ˜¯è¢«åŠ¨çš„å¡«å……ï¼Œæœ€ç»ˆä¸²è”èµ·è‡ªå·±çš„å­¦ä¹ ç½‘ç»œï¼Œè¿™æ ·ç†è§£çš„æ›´æ·±åˆ»ï¼Œå…·ä½“è¯·çœ‹ä¹‹å‰å†™çš„æ–‡ç«  ç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç , åç»­å†…å®¹è¯·æŒç»­å…³æ³¨","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Bean","slug":"Spring-Bean","permalink":"https://dayarch.top/tags/Spring-Bean/"},{"name":"ç”Ÿå‘½å‘¨æœŸ","slug":"ç”Ÿå‘½å‘¨æœŸ","permalink":"https://dayarch.top/tags/%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"},{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"}]},{"title":"é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ","slug":"é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ","date":"2019-12-19T13:37:30.000Z","updated":"2019-12-19T13:45:38.771Z","comments":true,"path":"/p/difference-between-beanfactory-and-applicationcontext.html","link":"","permalink":"https://dayarch.top/p/difference-between-beanfactory-and-applicationcontext.html","excerpt":"å‰è¨€ æ¥å£ BeanFactory å’Œ ApplicationContext éƒ½æ˜¯ç”¨æ¥ä»å®¹å™¨ä¸­è·å– Spring beans çš„ï¼Œä½†æ˜¯ï¼Œä»–ä»¬äºŒè€…æœ‰å¾ˆå¤§ä¸åŒ æˆ‘çœ‹åˆ°è¿‡å¾ˆå¤šé—® BeanFactory å’Œ ApplicationContext ä¸åŒç‚¹çš„é—®é¢˜ï¼Œè€ƒè™‘åˆ°è¿™ï¼Œæˆ‘åº”è¯¥ä½¿ç”¨å‰è€…è¿˜æ˜¯åè€…ä» Spring å®¹å™¨ä¸­è·å– beans å‘¢ï¼Ÿè¯·å‘ä¸‹çœ‹ ä»€ä¹ˆæ˜¯ Spring Bean è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•è€Œåˆå¾ˆå¤æ‚çš„é—®é¢˜ï¼Œé€šå¸¸æ¥è¯´ï¼ŒSpring beans å°±æ˜¯è¢« Spring å®¹å™¨æ‰€ç®¡ç†çš„ Java å¯¹è±¡ï¼Œæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ 1 2 3 4 5 6 7 8 9 10 package com.zolta","text":"å‰è¨€ æ¥å£ BeanFactory å’Œ ApplicationContext éƒ½æ˜¯ç”¨æ¥ä»å®¹å™¨ä¸­è·å– Spring beans çš„ï¼Œä½†æ˜¯ï¼Œä»–ä»¬äºŒè€…æœ‰å¾ˆå¤§ä¸åŒ æˆ‘çœ‹åˆ°è¿‡å¾ˆå¤šé—® BeanFactory å’Œ ApplicationContext ä¸åŒç‚¹çš„é—®é¢˜ï¼Œè€ƒè™‘åˆ°è¿™ï¼Œæˆ‘åº”è¯¥ä½¿ç”¨å‰è€…è¿˜æ˜¯åè€…ä» Spring å®¹å™¨ä¸­è·å– beans å‘¢ï¼Ÿè¯·å‘ä¸‹çœ‹ ä»€ä¹ˆæ˜¯ Spring Beanè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•è€Œåˆå¾ˆå¤æ‚çš„é—®é¢˜ï¼Œé€šå¸¸æ¥è¯´ï¼ŒSpring beans å°±æ˜¯è¢« Spring å®¹å™¨æ‰€ç®¡ç†çš„ Java å¯¹è±¡ï¼Œæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ 12345678910package com.zoltanraffai; public class HelloWorld &#123; private String message; public void setMessage(String message)&#123; this.message = message; &#125; public void getMessage()&#123; System.out.println(\"My Message : \" + message); &#125; &#125; åœ¨åŸºäº XML çš„é…ç½®ä¸­ï¼Œ beans.xml ä¸º Spring å®¹å™¨ç®¡ç† bean æä¾›å…ƒæ•°æ® ä»€ä¹ˆæ˜¯ Spring å®¹å™¨Spring å®¹å™¨è´Ÿè´£å®ä¾‹åŒ–ï¼Œé…ç½®å’Œè£…é… Spring beansï¼Œä¸‹é¢æ¥çœ‹å¦‚ä½•ä¸º IoC å®¹å™¨é…ç½®æˆ‘ä»¬çš„ HelloWorld POJO 123456789&lt;?xml version = \"1.0\" encoding = \"UTF-8\"?&gt;&lt;beans xmlns = \"http://www.springframework.org/schema/beans\" xmlns:xsi = \"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation = \"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\"&gt; &lt;bean id = \"helloWorld\" class = \"com.zoltanraffai.HelloWorld\"&gt; &lt;property name = \"message\" value = \"Hello World!\"/&gt; &lt;/bean&gt;&lt;/beans&gt; ç°åœ¨ï¼Œå®ƒå·²ç»è¢« Spring å®¹å™¨ç®¡ç†äº†ï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬æ€æ ·è·å–å®ƒï¼Ÿ BeanFactory å’Œ ApplicationContext çš„ä¸åŒç‚¹BeanFactory æ¥å£è¿™æ˜¯ä¸€ä¸ªç”¨æ¥è®¿é—® Spring å®¹å™¨çš„ root æ¥å£ï¼Œè¦è®¿é—® Spring å®¹å™¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Spring ä¾èµ–æ³¨å…¥åŠŸèƒ½ï¼Œä½¿ç”¨ BeanFactory æ¥å£å’Œå®ƒçš„å­æ¥å£ ç‰¹æ€§ï¼š Bean çš„å®ä¾‹åŒ–/ä¸²è”é€šå¸¸æƒ…å†µï¼ŒBeanFactory çš„å®ç°æ˜¯ä½¿ç”¨æ‡’åŠ è½½çš„æ–¹å¼ï¼Œè¿™æ„å‘³ç€ beans åªæœ‰åœ¨æˆ‘ä»¬é€šè¿‡ getBean() æ–¹æ³•ç›´æ¥è°ƒç”¨å®ƒä»¬æ—¶æ‰è¿›è¡Œå®ä¾‹åŒ–å®ç° BeanFactory æœ€å¸¸ç”¨çš„ API æ˜¯ XMLBeanFactoryè¿™é‡Œæ˜¯å¦‚ä½•é€šè¿‡ BeanFactory è·å–ä¸€ä¸ª bean çš„ä¾‹å­ï¼š 1234567891011package com.zoltanraffai; import org.springframework.core.io.ClassPathResource; import org.springframework.beans.factory.InitializingBean; import org.springframework.beans.factory.xml.XmlBeanFactory; public class HelloWorldApp&#123; public static void main(String[] args) &#123; XmlBeanFactory factory = new XmlBeanFactory (new ClassPathResource(\"beans.xml\")); HelloWorld obj = (HelloWorld) factory.getBean(\"helloWorld\"); obj.getMessage(); &#125;&#125; ApplicationContext æ¥å£ApplicationContext æ˜¯ Spring åº”ç”¨ç¨‹åºä¸­çš„ä¸­å¤®æ¥å£ï¼Œç”¨äºå‘åº”ç”¨ç¨‹åºæä¾›é…ç½®ä¿¡æ¯å®ƒç»§æ‰¿äº† BeanFactory æ¥å£ï¼Œæ‰€ä»¥ ApplicationContext åŒ…å« BeanFactory çš„æ‰€æœ‰åŠŸèƒ½ä»¥åŠæ›´å¤šåŠŸèƒ½ï¼å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯æ”¯æŒå¤§å‹çš„ä¸šåŠ¡åº”ç”¨çš„åˆ›å»º ç‰¹æ€§ï¼š Bean instantiation/wiring Bean çš„å®ä¾‹åŒ–/ä¸²è” è‡ªåŠ¨çš„ BeanPostProcessor æ³¨å†Œ è‡ªåŠ¨çš„ BeanFactoryPostProcessor æ³¨å†Œ æ–¹ä¾¿çš„ MessageSource è®¿é—®ï¼ˆi18nï¼‰ ApplicationEvent çš„å‘å¸ƒ ä¸ BeanFactory æ‡’åŠ è½½çš„æ–¹å¼ä¸åŒï¼Œå®ƒæ˜¯é¢„åŠ è½½ï¼Œæ‰€ä»¥ï¼Œæ¯ä¸€ä¸ª bean éƒ½åœ¨ ApplicationContext å¯åŠ¨ä¹‹åå®ä¾‹åŒ– è¿™é‡Œæ˜¯ ApplicationContext çš„ä½¿ç”¨ä¾‹å­ï¼š 1234567891011package com.zoltanraffai; import org.springframework.core.io.ClassPathResource; import org.springframework.beans.factory.InitializingBean; import org.springframework.beans.factory.xml.XmlBeanFactory; public class HelloWorldApp&#123; public static void main(String[] args) &#123; ApplicationContext context=new ClassPathXmlApplicationContext(\"beans.xml\"); HelloWorld obj = (HelloWorld) context.getBean(\"helloWorld\"); obj.getMessage(); &#125;&#125; æ€»ç»“ApplicationContext åŒ…å« BeanFactory çš„æ‰€æœ‰ç‰¹æ€§ï¼Œé€šå¸¸æ¨èä½¿ç”¨å‰è€…ã€‚ä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›é™åˆ¶æƒ…å½¢ï¼Œæ¯”å¦‚ç§»åŠ¨åº”ç”¨å†…å­˜æ¶ˆè€—æ¯”è¾ƒä¸¥è‹›ï¼Œåœ¨é‚£äº›æƒ…æ™¯ä¸­ï¼Œä½¿ç”¨æ›´è½»é‡çº§çš„ BeanFactory æ˜¯æ›´åˆç†çš„ã€‚ç„¶è€Œï¼Œåœ¨å¤§å¤šæ•°ä¼ä¸šçº§çš„åº”ç”¨ä¸­ï¼ŒApplicationContext æ˜¯ä½ çš„é¦–é€‰ã€‚ çµé­‚è¿½é—® å¦‚ä½•ä½¿ç”¨ BeanPostProcessor å’Œ BeanFactoryPostProcessor ï¼Ÿ ä½ äº†è§£ Spring Bean çš„ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿäº†è§£äº†è¿™äº›å¯¹ä¸ bean çš„ä½¿ç”¨å°†æœ‰éå¸¸å¤§çš„å¸®åŠ©.","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://dayarch.top/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"Java equals å’Œ hashCode é¢è¯•é‚£ç‚¹äº‹","slug":"Java-equals-å’Œ-hashCode-é¢è¯•é‚£ç‚¹äº‹","date":"2019-12-17T12:41:51.000Z","updated":"2019-12-22T11:48:22.310Z","comments":true,"path":"/p/java-equals-hashcode.html","link":"","permalink":"https://dayarch.top/p/java-equals-hashcode.html","excerpt":"å‰è¨€ ä¸Šä¸€ç¯‡æ–‡ç«  å¦‚ä½•å¦™ç”¨ Spring æ•°æ®ç»‘å®šï¼Ÿ ï¼Œçµé­‚è¿½é—® ç¯èŠ‚ç•™ä¸‹äº†ä¸€ä¸ªæœ‰å…³ equals å’Œ hashcode é—®é¢˜ ã€‚åŸºç¡€é¢è¯•ç»å¸¸ä¼šç¢°åˆ°ä¸ä¹‹ç›¸å…³çš„é—®é¢˜ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œä½†å¾ˆå¤šæœ‹å‹éƒ½è‹¦äºè¯´æ˜ä»–ä»¬äºŒè€…çš„å…³ç³»å’Œçº¦æŸï¼Œäºæ˜¯å†™æœ¬æ–‡åšå•ç‹¬è¯´æ˜ï¼Œæœ¬ç¯‡æ–‡ç« å°†å¾ªåºæ¸è¿› ( é€šè¿‡ä¸¾ä¾‹ï¼Œè®©è®°å¿†ä¸ç†è§£æ›´è½»æ¾ ) è¯´æ˜è¿™äº›è®©ä½ æœ‰äº›è‹¦æ¼çš„é—®é¢˜ï¼ŒLetâ€™s go â€¦â€¦. é¢è¯•é—®é¢˜ 1. Java é‡Œé¢æœ‰äº† == è¿ç®—ç¬¦ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ equals ï¼Ÿ == æ¯”è¾ƒçš„æ˜¯å¯¹è±¡åœ°å€ï¼Œequals æ¯”è¾ƒçš„æ˜¯å¯¹è±¡å€¼ å…ˆæ¥çœ‹ä¸€çœ‹ Object ç±»ä¸­ equals æ–¹æ³•: 1 2 3 public boole","text":"å‰è¨€ä¸Šä¸€ç¯‡æ–‡ç«  å¦‚ä½•å¦™ç”¨ Spring æ•°æ®ç»‘å®šï¼Ÿ ï¼Œçµé­‚è¿½é—® ç¯èŠ‚ç•™ä¸‹äº†ä¸€ä¸ªæœ‰å…³ equals å’Œ hashcode é—®é¢˜ ã€‚åŸºç¡€é¢è¯•ç»å¸¸ä¼šç¢°åˆ°ä¸ä¹‹ç›¸å…³çš„é—®é¢˜ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œä½†å¾ˆå¤šæœ‹å‹éƒ½è‹¦äºè¯´æ˜ä»–ä»¬äºŒè€…çš„å…³ç³»å’Œçº¦æŸï¼Œäºæ˜¯å†™æœ¬æ–‡åšå•ç‹¬è¯´æ˜ï¼Œæœ¬ç¯‡æ–‡ç« å°†å¾ªåºæ¸è¿› ( é€šè¿‡ä¸¾ä¾‹ï¼Œè®©è®°å¿†ä¸ç†è§£æ›´è½»æ¾ ) è¯´æ˜è¿™äº›è®©ä½ æœ‰äº›è‹¦æ¼çš„é—®é¢˜ï¼ŒLetâ€™s go â€¦â€¦. é¢è¯•é—®é¢˜1. Java é‡Œé¢æœ‰äº† == è¿ç®—ç¬¦ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ equals ï¼Ÿ == æ¯”è¾ƒçš„æ˜¯å¯¹è±¡åœ°å€ï¼Œequals æ¯”è¾ƒçš„æ˜¯å¯¹è±¡å€¼ å…ˆæ¥çœ‹ä¸€çœ‹ Object ç±»ä¸­ equals æ–¹æ³•: 123public boolean equals(Object obj) &#123; return (this == obj);&#125; æˆ‘ä»¬çœ‹åˆ° equals æ–¹æ³•åŒæ ·æ˜¯é€šè¿‡ == æ¯”è¾ƒå¯¹è±¡åœ°å€ï¼Œå¹¶æ²¡æœ‰å¸®æˆ‘ä»¬æ¯”è¾ƒå€¼ã€‚Java ä¸–ç•Œä¸­ Object ç»å¯¹æ˜¯â€è€ç¥–å®—â€ çš„å­˜åœ¨ï¼Œ== å·æˆ‘ä»¬æ²¡åŠæ³•æ”¹å˜æˆ–é‡å†™ã€‚ä½† equals æ˜¯æ–¹æ³•ï¼Œè¿™å°±ç»™äº†æˆ‘ä»¬é‡å†™ equals æ–¹æ³•çš„å¯èƒ½ï¼Œè®©æˆ‘ä»¬å®ç°å…¶å¯¹å€¼çš„æ¯”è¾ƒ: 1234@Overridepublic boolean equals(Object obj) &#123; //é‡å†™é€»è¾‘&#125; æ–°ä¹°çš„ç”µè„‘ï¼Œæ¯ä¸ªç”µè„‘éƒ½æœ‰å”¯ä¸€çš„åºåˆ—å·ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„ç”µè„‘æ”¾åœ¨é¢å‰ï¼Œä½ ä¼šè¯´ç”±äºåºåˆ—å·ä¸ä¸€æ ·ï¼Œè¿™ä¸¤ä¸ªç”µè„‘ä¸ä¸€æ ·å—ï¼Ÿ å¦‚æœæˆ‘ä»¬è¦è¯´ä¸¤ä¸ªç”µè„‘ä¸€æ ·ï¼Œé€šå¸¸æ˜¯æ¯”è¾ƒå…¶ã€Œå“ç‰Œ/å°ºå¯¸/é…ç½® ã€(å€¼) ï¼Œæ¯”å¦‚è¿™æ ·: 1234@Overridepublic boolean equals(Object obj) &#123; return å“ç‰Œç›¸ç­‰ &amp;&amp; å°ºå¯¸ç›¸ç­‰ &amp;&amp; é…ç½®ç›¸ç­‰&#125; å½“é‡åˆ°å¦‚ä¸Šåœºæ™¯æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦é‡å†™ equals æ–¹æ³•ã€‚è¿™å°±è§£é‡Šäº† Java ä¸–ç•Œä¸ºä»€ä¹ˆæœ‰äº† == è¿˜æœ‰equals è¿™ä¸ªé—®é¢˜äº†. 2. equalsç›¸ç­‰ å’Œ hashcode ç›¸ç­‰é—®é¢˜å…³äºäºŒè€…ï¼Œä½ ç»å¸¸ä¼šç¢°åˆ°ä¸‹é¢çš„ä¸¤ä¸ªé—®é¢˜: ä¸¤ä¸ªå¯¹è±¡ equals ç›¸ç­‰ï¼Œé‚£ä»–ä»¬ hashCode ç›¸ç­‰å—ï¼Ÿ ä¸¤ä¸ªå¯¹è±¡ hashCode ç›¸ç­‰ï¼Œé‚£ä»–ä»¬ equals ç›¸ç­‰å—ï¼Ÿ ä¸ºäº†è¯´æ˜ä¸Šé¢ä¸¤ä¸ªé—®é¢˜çš„ç»“è®ºï¼Œè¿™é‡Œä¸¾ä¸€ä¸ªä¸å¤ªæ°å½“çš„ä¾‹å­ï¼Œåªä¸ºæ–¹ä¾¿è®°å¿†ï¼Œæˆ‘ä»¬å°† equals æ¯”ä½œä¸€ä¸ªå•è¯çš„æ‹¼å†™ï¼›hashCode æ¯”ä½œä¸€ä¸ªå•è¯çš„å‘éŸ³ï¼Œåœ¨ç›¸åŒè¯­å¢ƒä¸‹: sea / sea ã€Œå¤§æµ·ã€ï¼Œä¸¤ä¸ªå•è¯æ‹¼å†™ä¸€æ ·ï¼Œæ‰€ä»¥ equals ç›¸ç­‰ï¼Œä»–ä»¬è¯»éŸ³ /siË/ ä¹Ÿä¸€æ ·ï¼Œæ‰€ä»¥ hashCode å°±ç›¸ç­‰ï¼Œè¿™å°±å›ç­”äº†ç¬¬ä¸€ä¸ªé—®é¢˜: ä¸¤ä¸ªå¯¹è±¡ equals ç›¸ç­‰ï¼Œé‚£ä»–ä»¬ hashCode ä¸€å®šä¹Ÿç›¸ç­‰ sea / see ã€Œå¤§æµ·/çœ‹ã€ï¼Œä¸¤ä¸ªå•è¯çš„è¯»éŸ³ /siË/ ä¸€æ ·ï¼Œæ˜¾ç„¶å•è¯æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™å°±å›ç­”äº†ç¬¬äºŒä¸ªé—®é¢˜: ä¸¤ä¸ªå¯¹è±¡ hashCode ç›¸ç­‰ï¼Œé‚£ä»–ä»¬ equals ä¸ä¸€å®šç›¸ç­‰ æŸ¥çœ‹ Object ç±»çš„ hashCode æ–¹æ³•: 1public native int hashCode(); ç»§ç»­æŸ¥çœ‹è¯¥æ–¹æ³•çš„æ³¨é‡Šï¼Œæ˜ç¡®å†™æ˜å…³äºè¯¥æ–¹æ³•çš„çº¦æŸ å…¶å®åœ¨è¿™ä¸ªç»“æœçš„èƒŒåï¼Œè¿˜æœ‰çš„æ˜¯å…³äºé‡å†™ equals æ–¹æ³•çš„çº¦æŸ 3. é‡å†™ equals æœ‰å“ªäº›çº¦æŸï¼Ÿå…³äºé‡å†™ equals æ–¹æ³•çš„çº¦æŸï¼ŒåŒæ ·åœ¨è¯¥æ–¹æ³•çš„æ³¨é‡Šä¸­å†™çš„å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘åœ¨è¿™é‡Œå†è¯´æ˜ä¸€ä¸‹: èµ¤æ©™çº¢ç»¿é’è“ç´«ï¼Œä¸ƒå½©ä»¥è‰²åˆ—ï¼›å“†æ¥å’ªå‘å”†æ‹‰è¥¿, ä¸€æ›²å®‰å“¥æ‹‰ ï¼Œè¿™äº›è§„åˆ™ä¸æ˜¯ç”¨æ¥èƒŒè¯µçš„ï¼Œåªæ˜¯åœ¨ä½ éœ€è¦é‡å†™ equals æ–¹æ³•æ—¶ï¼Œæ‰“å¼€ JDK æŸ¥çœ‹è¯¥æ–¹æ³•ï¼ŒæŒ‰ç…§å‡†åˆ™é‡å†™å°±å¥½ 4. ä»€ä¹ˆæ—¶å€™éœ€è¦æˆ‘ä»¬é‡å†™ hashCodeï¼Ÿä¸ºäº†æ¯”è¾ƒå€¼ï¼Œæˆ‘ä»¬é‡å†™ equals æ–¹æ³•ï¼Œé‚£ä»€ä¹ˆæ—¶å€™åˆéœ€è¦é‡å†™ hashCode æ–¹æ³•å‘¢ï¼Ÿ é€šå¸¸åªè¦æˆ‘ä»¬é‡å†™ equals æ–¹æ³•å°±è¦é‡å†™ hashCode æ–¹æ³• ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„çº¦æŸå‘¢ï¼ŸæŒ‰ç…§ä¸Šé¢è®²çš„åŸåˆ™ï¼Œä¸¤ä¸ªå¯¹è±¡ equals ç›¸ç­‰ï¼Œé‚£ä»–ä»¬çš„ hashCode ä¸€å®šä¹Ÿç›¸ç­‰ã€‚å¦‚æœæˆ‘ä»¬åªé‡å†™ equals æ–¹æ³•è€Œä¸é‡å†™ hashCode æ–¹æ³•ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œä¸¾ä¸ªä¾‹å­æ¥çœ‹: å®šä¹‰å­¦ç”Ÿç±»ï¼Œå¹¶é€šè¿‡ IDE åªå¸®æˆ‘ä»¬ç”Ÿæˆ equals æ–¹æ³•: 123456789101112131415public class Student &#123; private String name; private int age; @Override public boolean equals(Object o) &#123; if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Student student = (Student) o; return age == student.age &amp;&amp; Objects.equals(name, student.name); &#125;&#125; ç¼–å†™æµ‹è¯•ä»£ç : 12345678910111213141516171819Student student1 = new Student();student1.setName(\"æ—¥æ‹±ä¸€å…µ\");student1.setAge(18);Student student2 = new Student();student2.setName(\"æ—¥æ‹±ä¸€å…µ\");student2.setAge(18);System.out.println(\"student1.equals(student2)çš„ç»“æœæ˜¯ï¼š\" + student1.equals(student2));Set&lt;Student&gt; students = new HashSet&lt;Student&gt;();students.add(student1);students.add(student2);System.out.println(\"Student Set é›†åˆé•¿åº¦æ˜¯ï¼š\" + students.size());Map&lt;Student, java.lang.String&gt; map = new HashMap&lt;Student, java.lang.String&gt;();map.put(student1, \"student1\");map.put(student2, \"student2\");System.out.println(\"Student Map é›†åˆé•¿åº¦æ˜¯ï¼š\" + map.keySet().size()); æŸ¥çœ‹è¿è¡Œç»“æœ: 123student1.equals(student2)çš„ç»“æœæ˜¯ï¼štrueStudent Set é›†åˆé•¿åº¦æ˜¯ï¼š2Student Map é›†åˆé•¿åº¦æ˜¯ï¼š2 å¾ˆæ˜¾ç„¶ï¼ŒæŒ‰ç…§é›†åˆ Set å’Œ Map åŠ å…¥å…ƒç´ çš„æ ‡å‡†æ¥çœ‹ï¼Œstudent1 å’Œ student2 æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œå› ä¸ºåœ¨è°ƒç”¨ä»–ä»¬çš„ put (Set add æ–¹æ³•çš„èƒŒåä¹Ÿæ˜¯ HashMap çš„ put)æ–¹æ³•æ—¶ï¼Œ ä¼šå…ˆåˆ¤æ–­ hash å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè¿™ä¸ªå°ä¼™ä¼´ä»¬æ‰“å¼€ JDK è‡ªè¡ŒæŸ¥çœ‹å§ æ‰€ä»¥æˆ‘ä»¬ç»§ç»­é‡å†™ Student ç±»çš„ hashCode æ–¹æ³•: 1234@Overridepublic int hashCode() &#123; return Objects.hash(name, age);&#125; é‡æ–°è¿è¡Œä¸Šé¢çš„æµ‹è¯•ï¼ŒæŸ¥çœ‹ç»“æœ: 123student1.equals(student2)çš„ç»“æœæ˜¯ï¼štrueStudent Set é›†åˆé•¿åº¦æ˜¯ï¼š1Student Map é›†åˆé•¿åº¦æ˜¯ï¼š1 å¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆé€šå¸¸æˆ‘ä»¬é‡å†™ equals æ–¹æ³•ä¸ºä»€ä¹ˆæœ€å¥½ä¹Ÿé‡å†™ hashCode æ–¹æ³•çš„åŸå›  å¦‚æœä½ åœ¨ä½¿ç”¨ Lombokï¼Œä¸çŸ¥é“ä½ æ˜¯å¦æ³¨æ„åˆ° Lombok åªæœ‰ä¸€ä¸ª @EqualsAndHashCode æ³¨è§£ï¼Œè€Œæ²¡æœ‰æ‹†åˆ†æˆ @Equals å’Œ @HashCode ä¸¤ä¸ªæ³¨è§£ï¼Œæƒ³äº†è§£æ›´å¤š Lombok çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰å†™çš„æ–‡ç«  Lomok ä½¿ç”¨è¯¦è§£ å¦å¤–é€šè¿‡ IDE å¿«æ·é”®ç”Ÿæˆé‡å†™æ–¹æ³•æ—¶ï¼Œä½ ä¹Ÿä¼šçœ‹åˆ°è¿™ä¸¤ä¸ªæ–¹æ³•æ”¾åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯åƒ getter å’Œ setter é‚£æ ·åˆ†å¼€ ä»¥ä¸Šä¸¤ç‚¹éƒ½æ˜¯éšå½¢çš„è§„èŒƒçº¦æŸï¼Œå¸Œæœ›å¤§å®¶ä¹Ÿä¸¥æ ¼éµå®ˆè¿™ä¸ªè§„èŒƒï¼Œä»¥é˜²å¸¦æ¥ä¸å¿…è¦çš„éº»çƒ¦ï¼Œè®°å¿†çš„æ–¹å¼æœ‰å¤šæ ·ï¼Œå¦‚æœè®°ä¸ä½è¿™ä¸ªæ–‡å­—çº¦æŸï¼Œè„‘æµ·ä¸­è®°ä½ä¸Šé¢çš„å›¾ä½ ä¹Ÿå°±æ‡‚äº† 5. é‡å†™ hashCode ä¸ºä»€ä¹ˆæ€»æœ‰ 31 è¿™ä¸ªæ•°å­—ï¼Ÿç»†å¿ƒçš„æœ‹å‹å¯èƒ½æ³¨æ„åˆ°ï¼Œæˆ‘ä¸Šé¢é‡å†™ hashCodeçš„æ–¹æ³•å¾ˆç®€ç­”ï¼Œ å°±æ˜¯ç”¨äº† Objects.hash æ–¹æ³•ï¼Œè¿›å»æŸ¥çœ‹é‡Œé¢çš„æ–¹æ³•: 1234567891011public static int hashCode(Object a[]) &#123; if (a == null) return 0; int result = 1; for (Object element : a) result = 31 * result + (element == null ? 0 : element.hashCode()); return result;&#125; è¿™é‡Œé€šè¿‡ 31 æ¥è®¡ç®—å¯¹è±¡ hash å€¼ åœ¨ å¦‚ä½•å¦™ç”¨ Spring æ•°æ®ç»‘å®šï¼Ÿ æ–‡ç« æœ«å°¾æåˆ°çš„åœ¨ HandlerMethodArgumentResolverComposite ç±»ä¸­æœ‰è¿™æ ·ä¸€ä¸ªæˆå‘˜å˜é‡: 12private final Map&lt;MethodParameter, HandlerMethodArgumentResolver&gt; argumentResolverCache = new ConcurrentHashMap&lt;MethodParameter, HandlerMethodArgumentResolver&gt;(256); Map çš„ key æ˜¯ MethodParameter ï¼Œæ ¹æ®æˆ‘ä»¬ä¸Šé¢çš„åˆ†æï¼Œè¿™ä¸ªç±»ä¸€å®šä¹Ÿä¼šé‡å†™ equals å’Œ hashCode æ–¹æ³•ï¼Œè¿›å»æŸ¥çœ‹å‘ç°ï¼ŒhashCode çš„è®¡ç®—ä¹Ÿç”¨åˆ°äº† 31 è¿™ä¸ªæ•°å­— 12345678910111213141516@Overridepublic boolean equals(Object other) &#123; if (this == other) &#123; return true; &#125; if (!(other instanceof MethodParameter)) &#123; return false; &#125; MethodParameter otherParam = (MethodParameter) other; return (this.parameterIndex == otherParam.parameterIndex &amp;&amp; getMember().equals(otherParam.getMember()));&#125;@Overridepublic int hashCode() &#123; return (getMember().hashCode() * 31 + this.parameterIndex);&#125; ä¸ºä»€ä¹ˆè®¡ç®— hash å€¼è¦ç”¨åˆ° 31 è¿™ä¸ªæ•°å­—å‘¢ï¼Ÿæˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€ç¯‡ä¸é”™çš„æ–‡ç« ï¼Œåˆ†äº«ç»™å¤§å®¶ï¼Œä½œä¸ºç§‘æ™®ï¼Œå¯ä»¥ç®€å•æŸ¥çœ‹ä¸€ä¸‹:String hashCode æ–¹æ³•ä¸ºä»€ä¹ˆé€‰æ‹©æ•°å­—31ä½œä¸ºä¹˜å­ æ€»ç»“å¦‚æœè¿˜å¯¹equals å’Œ hashCode å…³ç³»åŠçº¦æŸå«æ··ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§ä¸Šè¿°æ­¥éª¤é€æ­¥å›å¿†å³å¯ï¼Œæ›´å¥½çš„æ˜¯ç›´æ¥æŸ¥çœ‹ JDK æºç ï¼›å¦å¤–æ‹¿å‡ºå®é™…çš„ä¾‹å­æ¥åæ¨éªŒè¯æ˜¯éå¸¸å¥½çš„åŠæ³•ã€‚å¦‚æœä½ è¿˜æœ‰ç›¸å…³ç–‘é—®ï¼Œä¹Ÿå¯ä»¥ç•™è¨€æ¢è®¨. çµé­‚è¿½é—® Thread ç±»å°±æ²¡æœ‰é‡å†™ equals æ–¹æ³•ï¼Œä½ è¿˜çŸ¥é“å“ªäº›æƒ…å†µæ²¡å¿…è¦é‡å†™ equals æ–¹æ³•å—ï¼Ÿ ä»ä¸Šé¢ HandlerMethodArgumentResolverComposite ç±»ä¸­å®šä¹‰çš„ Map æˆå‘˜å˜é‡ï¼Œä½ æ³¨æ„åˆ°å“ªäº›çŸ¥è¯†ç‚¹ï¼Œæ¯”å¦‚ finalï¼ŒConcurrentHashMapï¼Œåˆè¯†å®¹é‡ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ï¼Ÿä½ èƒ½è§£é‡Šå‡ºåŸå› å—ï¼Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://dayarch.top/tags/Java/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://dayarch.top/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"Spring æ•°æ®ç»‘å®šå‰–æ","slug":"Spring-æ•°æ®ç»‘å®šå‰–æ","date":"2019-12-12T11:59:04.000Z","updated":"2019-12-16T04:30:41.731Z","comments":true,"path":"/p/spring-data-binding-mechanism.html","link":"","permalink":"https://dayarch.top/p/spring-data-binding-mechanism.html","excerpt":"å‰è¨€ åœ¨å‰–æå®Œ ã€ŒSpring Boot ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ ã€æ–‡ç« ä¹‹åï¼Œä¸€ç›´è§‰å¾—æœ‰å¿…è¦è¯´æ˜ä¸€ä¸‹ Springâ€™s Data Binding Mechanism ã€ŒSpring æ•°æ®ç»‘å®šæœºåˆ¶ã€ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring åªçŸ¥é“å¦‚ä½•è½¬æ¢ç®€å•æ•°æ®ç±»å‹ã€‚æ¯”å¦‚æˆ‘ä»¬æäº¤çš„ intã€String æˆ– booleanç±»å‹çš„è¯·æ±‚æ•°æ®ï¼Œå®ƒä¼šè‡ªåŠ¨ç»‘å®šåˆ°ä¸ä¹‹å¯¹åº”çš„ Java ç±»å‹ã€‚ä½†åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿œè¿œä¸å¤Ÿï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½éœ€è¦ç»‘å®šæ›´å¤æ‚çš„å¯¹è±¡ç±»å‹ã€‚ æˆ‘ä»¬éœ€è¦äº†è§£ Spring æ•°æ®ç»‘å®šæœºåˆ¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ›´çµæ´»çš„åšå…¨å±€é…ç½®æˆ–è‡ªå®šä¹‰é…ç½®ï¼Œè¿›è€Œè®©æˆ‘ä»¬çš„ RESTful API æ›´ç®€æ´ï¼Œå¯è¯»æ€§ä¹Ÿæ›´å¥½ã€‚æœ¬æ–‡ä¾æ—§å…ˆ","text":"å‰è¨€åœ¨å‰–æå®Œ ã€ŒSpring Boot ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ ã€æ–‡ç« ä¹‹åï¼Œä¸€ç›´è§‰å¾—æœ‰å¿…è¦è¯´æ˜ä¸€ä¸‹ Springâ€™s Data Binding Mechanism ã€ŒSpring æ•°æ®ç»‘å®šæœºåˆ¶ã€ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring åªçŸ¥é“å¦‚ä½•è½¬æ¢ç®€å•æ•°æ®ç±»å‹ã€‚æ¯”å¦‚æˆ‘ä»¬æäº¤çš„ intã€String æˆ– booleanç±»å‹çš„è¯·æ±‚æ•°æ®ï¼Œå®ƒä¼šè‡ªåŠ¨ç»‘å®šåˆ°ä¸ä¹‹å¯¹åº”çš„ Java ç±»å‹ã€‚ä½†åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿œè¿œä¸å¤Ÿï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½éœ€è¦ç»‘å®šæ›´å¤æ‚çš„å¯¹è±¡ç±»å‹ã€‚ æˆ‘ä»¬éœ€è¦äº†è§£ Spring æ•°æ®ç»‘å®šæœºåˆ¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ›´çµæ´»çš„åšå…¨å±€é…ç½®æˆ–è‡ªå®šä¹‰é…ç½®ï¼Œè¿›è€Œè®©æˆ‘ä»¬çš„ RESTful API æ›´ç®€æ´ï¼Œå¯è¯»æ€§ä¹Ÿæ›´å¥½ã€‚æœ¬æ–‡ä¾æ—§å…ˆé€šè¿‡ç¤ºä¾‹ä»£ç è¯´æ˜å®ç°ï¼Œç„¶åè¿›è¡Œæºç åˆ†æï¼Œå¸¦é¢†å¤§å®¶äº†è§£è¿™ä¸ªæœºåˆ¶æ˜¯å¦‚ä½•ç”Ÿæ•ˆçš„ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œ Letâ€™s goâ€¦â€¦ Spring æ•°æ®ç»‘å®šæ—¥æœŸç»‘å®šå…ˆæ¥çœ‹ä¸‹é¢ä¸€å°æ®µä»£ç  1234567891011@RestController@RequestMapping(\"/bindings/\")@Slf4jpublic class BindingController &#123; @GetMapping(\"/&#123;date&#125;\") public void getSpecificDateInfo(@PathVariable LocalDateTime date) &#123; log.info(date.toString()); &#125;&#125; å½“æˆ‘ä»¬ç”¨ Postman è¯·æ±‚è¿™ä¸ª API 1http://localhost:8080/rgyb/bindings/2019-12-10 12:00:00 å¦‚æˆ‘ä»¬æ‰€æ–™ï¼ŒæŠ›å‡ºæ•°æ®ç±»å‹è½¬æ¢å¼‚å¸¸å› ä¸º Spring é»˜è®¤ä¸æ”¯æŒå°† String ç±»å‹çš„è¯·æ±‚å‚æ•°è½¬æ¢ä¸º LocalDateTime ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ converter ã€Œè½¬æ¢å™¨ã€å®Œæ•´æ•´ä¸ªè½¬æ¢è¿‡ç¨‹ è‡ªå®šä¹‰è½¬æ¢å™¨ StringToLocalDateTimeConverterï¼Œä½¿å…¶å®ç° org.springframework.core.convert.converter.Converter&lt;S, T&gt; æ¥å£ï¼Œåœ¨é‡å†™çš„ convert æ–¹æ³•ä¸­å®ç°æˆ‘ä»¬è‡ªå®šä¹‰çš„è½¬æ¢é€»è¾‘ 1234567public class StringToLocalDateTimeConverter implements Converter&lt;String, LocalDateTime&gt; &#123; @Override public LocalDateTime convert(String s) &#123; DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\", Locale.CHINESE); return LocalDateTime.parse(s, formatter); &#125;&#125; å°†è½¬æ¢å™¨æ³¨å†Œåˆ°ä¸Šä¸‹æ–‡ä¸­: 1234567@Configurationpublic class UnifiedReturnConfig implements WebMvcConfigurer &#123; @Override public void addFormatters(FormatterRegistry registry) &#123; registry.addConverter(new StringToLocalDateTimeConverter()); &#125;&#125; é‡æ–°è®¿é—®ä¸Šé¢é“¾æ¥ï¼ŒæŸ¥çœ‹æ§åˆ¶å°ï¼ŒæŒ‰ç…§é¢„æœŸå¾—åˆ°ç›¸åº”è½¬æ¢ç»“æœ: 1c.e.unifiedreturn.api.BindingController : 2019-12-10T12:00 çŸ¥é“äº†è¿™ä¸ªï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„æšä¸¾ç±»å‹ä¹Ÿå¯ä»¥åº”ç”¨è¿™ç§æ–¹å¼åšæ•°æ®ç»‘å®š æšä¸¾ç±»å‹ç»‘å®šåŒæ ·çš„å¥—è·¯ï¼Œè‡ªå®šä¹‰è½¬æ¢å™¨ 1234567public class StringToEnumConverter implements Converter&lt;String, Modes&gt; &#123; @Override public Modes convert(String s) &#123; return Modes.valueOf(s); &#125;&#125; å°†å…¶æ·»åŠ è‡³ä¸Šä¸‹æ–‡ï¼Œè¯·å°ä¼™ä¼´ä»¬è‡ªè¡Œå°è¯•å§ï¼ŒçŸ¥é“äº†è¿™ä¸ªï¼Œæˆ‘ä»¬å†ä¹Ÿä¸ç”¨åœ¨ RESTful API å†…éƒ¨åšæ•°æ®è½¬æ¢äº†ï¼Œæˆ‘ä»¬åšåˆ°äº†å…¨å±€æ§åˆ¶ï¼ŒåŒæ—¶è®©æ•´ä¸ª API çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ç®€æ´ ç»‘å®šå¯¹è±¡åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ•°æ®ç»‘å®šåˆ°å¯¹è±¡ï¼Œè¿™æ—¶æˆ‘ä»¬å¯èƒ½é©¬ä¸Šè”æƒ³èµ·æ¥ä½¿ç”¨ @RequestBody æ³¨è§£ï¼Œè¯¥æ³¨è§£é€šå¸¸ç”¨äºè·å– POST è¯·æ±‚ä½“ï¼Œå¹¶å°†å…¶è½¬æ¢ç›¸åº”çš„æ•°æ®å¯¹è±¡ åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œé™¤äº†è¯·æ±‚ä½“ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦è¯·æ±‚å¤´ä¸­çš„æ•°æ®ï¼Œæ¯”å¦‚ token ï¼Œtoken ä¸­åŒ…å«å½“å‰ç™»é™†ç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ¯ä¸€æ¬¡ RESTful è¯·æ±‚æˆ‘ä»¬éƒ½éœ€è¦ä» header ä¸­è·å– token æ•°æ®å¤„ç†å®é™…ä¸šåŠ¡ï¼Œè¿™ç§åœºæ™¯ï¼Œä¸Šæ–‡æåˆ°çš„ Converter ä»¥åŠ @RequestBody æ˜¾ç„¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±è¦æ¢å¦ä¸€ç§è§£å†³æ–¹æ¡ˆ : HandlerMethodArgumentResolver é¦–å…ˆæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£ LoginUser (è¿è¡Œæ—¶ç”Ÿæ•ˆï¼Œä½œç”¨äºå‚æ•°ä¸Š) 1234@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.PARAMETER)public @interface LoginUser &#123;&#125; ç„¶åè‡ªå®šä¹‰ LoginUserArgumentResolver ï¼Œä½¿å…¶å®ç° HandlerMethodArgumentResolver æ¥å£ 1234567891011121314151617181920212223242526public class LoginUserArgumentResolver implements HandlerMethodArgumentResolver &#123; @Override public boolean supportsParameter(MethodParameter methodParameter) &#123; //åˆ¤æ–­å‚æ•°æ˜¯å¦æœ‰è‡ªå®šä¹‰æ³¨è§£ LoginUser ä¿®é¥° return methodParameter.hasParameterAnnotation(LoginUser.class); &#125; @Override public Object resolveArgument(MethodParameter methodParameter, ModelAndViewContainer modelAndViewContainer, NativeWebRequest nativeWebRequest, WebDataBinderFactory webDataBinderFactory) throws Exception &#123; HttpServletRequest request = (HttpServletRequest) nativeWebRequest.getNativeRequest(); LoginUserVo loginUserVo = new LoginUserVo(); String token = request.getHeader(\"token\"); if (Strings.isNotBlank(token))&#123; //é€šå¸¸è¿™é‡Œéœ€è¦ç¼–å†™ token è§£æé€»è¾‘ï¼Œå¹¶å°†å…¶æ”¾åˆ° LoginUserVo å¯¹è±¡ä¸­ //logic &#125; //åœ¨æ­¤ä¸ºäº†å¿«é€Ÿç®€æ´çš„åšæ¼”ç¤ºè¯´æ˜ï¼Œçœç•¥æ‰è§£æ token éƒ¨åˆ†ï¼Œç›´æ¥ä» header æŒ‡å®š key ä¸­è·å–æ•°æ® loginUserVo.setId(Long.valueOf(request.getHeader(\"userId\"))); loginUserVo.setName(request.getHeader(\"userName\")); return loginUserVo; &#125;&#125; ä¾æ—§å°†è‡ªå®šä¹‰çš„ LoginUserArgumentResolver æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­ 1234@Overridepublic void addArgumentResolvers(List&lt;HandlerMethodArgumentResolver&gt; resolvers) &#123; resolvers.add(new LoginUserArgumentResolver());&#125; ç¼–å†™ API: 1234@GetMapping(\"/id\")public void getLoginUserInfo(@LoginUser LoginUserVo loginUserVo) &#123; log.info(loginUserVo.toString());&#125; é€šè¿‡ Postman è¯·æ±‚ï¼Œåœ¨ header ä¸­è®¾ç½®å¥½ç›¸åº”çš„ K-Vï¼Œå¦‚ä¸‹å›¾ 1http://localhost:8080/rgyb/bindings/id å‘é€è¯·æ±‚ï¼ŒæŸ¥çœ‹æ§åˆ¶å°ï¼Œå¾—åˆ°é¢„æœŸç»“æœ 1c.e.unifiedreturn.api.BindingController : LoginUserVo(id=111111, name=rgyb) ç›¸ä¿¡åˆ°è¿™é‡Œï¼Œä½ å·²ç»äº†è§£äº†åŸºæœ¬çš„ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œæºç åˆ†æï¼Œé€è¿‡ç°è±¡çœ‹æœ¬è´¨ (å¸Œæœ›å¯ä»¥æ‰“å¼€ IDE è·Ÿç€æ­¥éª¤æŸ¥çœ‹) Spring æ•°æ®ç»‘å®šæºç åˆ†æé¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£æˆ‘ä»¬è‡ªå®šä¹‰çš„ LoginUserArgumentResolver æ˜¯å¦‚ä½•è¢«åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­çš„ï¼Œåœ¨ä½ çœ‹è¿‡ HttpMessageConverterè½¬æ¢åŸç†è§£æ å’Œ Springbootè¿”å›ç»Ÿä¸€JSONæ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿåï¼Œä½ ä¹Ÿè®¸å·²ç»æœ‰äº†çœ‰ç›®ï¼ŒåŒåŠ è½½ MessageConverter å¦‚å‡ºä¸€è¾™ï¼Œåœ¨ RequestMappingHandlerAdapter ç±»ä¸­ï¼ŒåŒæ ·æœ‰æ·»åŠ  ArgumentResolver çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šæŠŠç³»ç»Ÿå†…ç½®çš„ resolver å’Œç”¨æˆ·è‡ªå®šä¹‰çš„ resolver éƒ½åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œå…³é”®ä»£ç å±•ç¤ºå¦‚ä¸‹: 1234567891011121314151617private List&lt;HandlerMethodArgumentResolver&gt; getDefaultArgumentResolvers() &#123; List&lt;HandlerMethodArgumentResolver&gt; resolvers = new ArrayList(); resolvers.add(new RequestParamMethodArgumentResolver(this.getBeanFactory(), false)); //å…¶ä»–å†…ç½® resolver resolvers.add(new RequestResponseBodyMethodProcessor(this.getMessageConverters(), this.requestResponseBodyAdvice)); ... ... if (this.getCustomArgumentResolvers() != null) &#123; resolvers.addAll(this.getCustomArgumentResolvers()); &#125; ... ... return resolvers;&#125; åœ¨ HttpMessageConverterè½¬æ¢åŸç†è§£æ æ–‡ç« ä¸­æœ‰ä¸€æ®µè°ƒç”¨æ ˆè·Ÿè¸ªï¼Œæˆ‘å†æ¬¡ç²˜è´´åœ¨æ­¤å¤„ï¼Œå¹¶ç”¨çº¢æ¡†åšå‡ºæ ‡è®°ï¼Œå…¶å®æˆ‘ä»¬åœ¨åˆ†æ messageConverter æ—¶å·²ç»æ‚„æ‚„çš„è·¯è¿‡äº†æˆ‘ä»¬æœ¬èŠ‚è¦è¯´çš„å†…å®¹ æˆ‘ä»¬è¿›å…¥ç›¸åº”çš„ç±»ä¸­ç§ä¸€ç§: åˆ°è¿™é‡Œä½ åº”è¯¥çŒ›çš„äº†è§£è¿™èƒŒåçš„é“ç†äº†å§ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥éªŒè¯æˆ‘ä»¬å¤©å¤©ç”¨çš„ @RequestBody æ³¨è§£æ˜¯ä¸æ˜¯è¿™ä¸ªå¥—è·¯å‘¢ï¼Ÿå¤„ç†è¯¥æ³¨è§£çš„ç±»æ˜¯ RequestResponseBodyMethodProcessorï¼ŒæŸ¥çœ‹å…¶ç±»å›¾ï¼Œå‘ç°å…¶ä¾æ—§å®ç°äº† HandlerMethodArgumentResolver æ¥å£ æ‰“å¼€è¯¥ç±»ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹å›¾ä»£ç ï¼Œé‡ç‚¹åœ°æ–¹æˆ‘å·²æ ‡è®°å‡ºæ¥ æ•´ä½“å¤„ç†æµç¨‹å¦‚å‡ºä¸€è¾™ï¼Œåªä¸è¿‡åœ¨é‡Œé¢è°ƒç”¨äº† messageConverter æ¥è§£æ JSON æ•°æ®ã€‚ æ€»ç»“æœ¬æ–‡è¯´çš„ Converter å’Œ ArgumentResolver ä»¥åŠåœ¨ Spring MVC ä¸­å¸¸ç”¨çš„ @InitBinder æ³¨è§£æ•´ä½“è¿‡ç¨‹éƒ½å¦‚å‡ºä¸€è¾™ï¼Œå¤§å®¶éƒ½å¯ä»¥æŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥æŸ¥çœ‹å…·ä½“çš„å®ç°ã€‚å¦å¤–ï¼Œåœ¨æˆ‘ä»¬å®Œæˆæ—¥å¸¸ç¼–ç å·¥ä½œæ—¶ï¼Œéƒ½å¯ä»¥ä» Spring ç°æœ‰çš„å¤„ç†æ–¹å¼ä¸­æ‘¸ç´¢åˆ°ä¸€äº›è§£å†³æ–¹æ¡ˆï¼Œä½†å‰ææ˜¯ä½ äº†è§£ Spring åº•å±‚çš„ä¸€äº›è°ƒç”¨è¿‡ç¨‹ æœ€åå¸Œæœ›å°ä¼™ä¼´æ‰“å¼€ IDE åˆ‡å®æŸ¥çœ‹ç›¸åº”ä»£ç ï¼Œä½ ä¸€å®šè¿˜ä¼šæœ‰æ–°å‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·æ¢è®¨ã€‚æœ¬æ–‡ä»£ç å·²ä¸Šä¼ ï¼Œå…¬ä¼—å·å›å¤ã€Œdemoã€ï¼Œæ‰“å¼€é“¾æ¥æŸ¥çœ‹ ã€Œspring-boot-unified-returnã€æ–‡ä»¶å¤¹å†…å®¹å³å¯ï¼Œä¹Ÿå¯ä»¥é¡ºè·¯å›é¡¾ä»¥å‰ Spring Boot ç»Ÿä¸€è¿”å›æ ¼å¼çš„ä»£ç å®ç° çµé­‚è¿½é—® å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨è¿½ä¸­æºç æ—¶ï¼Œå‘ç°HandlerMethodArgumentResolverComposite æ˜¯ HandlerMethodArgumentResolver çš„å®ç°ç±»ä¹‹ä¸€ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ª Map ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œé€šå¸¸æˆ‘ä»¬ä½¿ç”¨ Mapï¼Œkey çš„ç±»å‹å¤šæ•°ä¸º String ç±»å‹ï¼Œä½†çœ‹åˆ°è¿™ä¸ª Map ä¸­æœ‰è¿™æ ·çš„ key ä½ é©¬ä¸Šæƒ³åˆ°çš„æ˜¯ä»€ä¹ˆï¼ŸåŸºç¡€é¢è¯•ç»å¸¸ä¼šé—® equals å’Œ hashcode çš„é—®é¢˜ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« ä¼šå€Ÿç€è¿™ä¸ªç±»æ¥åˆ†æè¯´æ˜ä¸€ä¸‹ä½ æ€»å›°æƒ‘çš„è¿™ä»¶å°äº‹ å¯¹äº Spring Boot çš„æ•´ä¸ªè°ƒç”¨è¿‡ç¨‹ï¼Œä½ èƒ½æè¿°å‡ºæ•´ä½“æµç¨‹å—ï¼Ÿ Spring å†…ç½®å¤šå°‘ä¸ª Resolverï¼Ÿä½ å¯ä»¥è·Ÿè¸ªè°ƒè¯•è·å–åˆ°","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"},{"name":"Spring Data Binding","slug":"Spring-Data-Binding","permalink":"https://dayarch.top/tags/Spring-Data-Binding/"}]},{"title":"Lombok ä½¿ç”¨æ•™ç¨‹è¯¦è§£","slug":"Lombok-ä½¿ç”¨æ•™ç¨‹è¯¦è§£","date":"2019-11-25T05:34:12.000Z","updated":"2019-11-25T05:41:24.129Z","comments":true,"path":"/p/lombok-usage.html","link":"","permalink":"https://dayarch.top/p/lombok-usage.html","excerpt":"å‰è¨€ åœ¨ Java åº”ç”¨ç¨‹åºä¸­å­˜åœ¨è®¸å¤šé‡å¤ç›¸ä¼¼çš„ã€ç”Ÿæˆä¹‹åå‡ ä¹ä¸å¯¹å…¶åšæ›´æ”¹çš„ä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜ä¸å¾—ä¸èŠ±è´¹å¾ˆå¤šç²¾åŠ›ç¼–å†™å®ƒä»¬æ¥æ»¡è¶³ Java çš„ç¼–è¯‘éœ€æ±‚ æ¯”å¦‚ï¼Œåœ¨ Java åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹è¦ä¸ºæ‰€æœ‰ Bean çš„æˆå‘˜å˜é‡æ·»åŠ  get() ,set() ç­‰æ–¹æ³•ï¼Œè¿™äº›ç›¸å¯¹å›ºå®šä½†åˆä¸å¾—ä¸ç¼–å†™çš„ä»£ç æµªè´¹ç¨‹åºå‘˜å¾ˆå¤šç²¾åŠ›ï¼ŒåŒæ—¶è®©ç±»å†…å®¹çœ‹ç€æ›´æ‚ä¹±ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æœ‰é™çš„ç²¾åŠ›å…³æ³¨åœ¨æ›´é‡è¦çš„åœ°æ–¹ã€‚ Lombok å·²ç»è¯ç”Ÿå¾ˆä¹…äº†ï¼Œç”šè‡³åœ¨ Spring Boot Initalizr ä¸­éƒ½å·²åŠ å…¥äº† Lombok é€‰é¡¹ï¼Œ è¿™é‡Œæˆ‘ä»¬å°† Lombok åšä¸€ä¸‹è¯¦ç»†è¯´æ˜: Lombok å®˜ç½‘çš„ä»‹ç»ï¼šProject Lom","text":"å‰è¨€åœ¨ Java åº”ç”¨ç¨‹åºä¸­å­˜åœ¨è®¸å¤šé‡å¤ç›¸ä¼¼çš„ã€ç”Ÿæˆä¹‹åå‡ ä¹ä¸å¯¹å…¶åšæ›´æ”¹çš„ä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜ä¸å¾—ä¸èŠ±è´¹å¾ˆå¤šç²¾åŠ›ç¼–å†™å®ƒä»¬æ¥æ»¡è¶³ Java çš„ç¼–è¯‘éœ€æ±‚ æ¯”å¦‚ï¼Œåœ¨ Java åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹è¦ä¸ºæ‰€æœ‰ Bean çš„æˆå‘˜å˜é‡æ·»åŠ  get() ,set() ç­‰æ–¹æ³•ï¼Œè¿™äº›ç›¸å¯¹å›ºå®šä½†åˆä¸å¾—ä¸ç¼–å†™çš„ä»£ç æµªè´¹ç¨‹åºå‘˜å¾ˆå¤šç²¾åŠ›ï¼ŒåŒæ—¶è®©ç±»å†…å®¹çœ‹ç€æ›´æ‚ä¹±ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æœ‰é™çš„ç²¾åŠ›å…³æ³¨åœ¨æ›´é‡è¦çš„åœ°æ–¹ã€‚ Lombok å·²ç»è¯ç”Ÿå¾ˆä¹…äº†ï¼Œç”šè‡³åœ¨ Spring Boot Initalizr ä¸­éƒ½å·²åŠ å…¥äº† Lombok é€‰é¡¹ï¼Œ è¿™é‡Œæˆ‘ä»¬å°† Lombok åšä¸€ä¸‹è¯¦ç»†è¯´æ˜: Lombok å®˜ç½‘çš„ä»‹ç»ï¼šProject Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java. Never write another getter or equals method again. Early access to future java features such as val, and much more. ç›´ç™½çš„è¯´ï¼š Lombok æ˜¯ä¸€ç§ Javaâ„¢ å®ç”¨å·¥å…·ï¼Œå¯ç”¨æ¥å¸®åŠ©å¼€å‘äººå‘˜æ¶ˆé™¤ Java çš„å†—é•¿ï¼Œå°¤å…¶æ˜¯å¯¹äºç®€å•çš„ Java å¯¹è±¡ï¼ˆPOJOï¼‰ã€‚å®ƒé€šè¿‡æ³¨è§£å®ç°è¿™ä¸€ç›®çš„ï¼Œä¸”çœ‹: Bean çš„å¯¹æ¯”ä¼ ç»Ÿçš„ POJO ç±»æ˜¯è¿™æ ·çš„ é€šè¿‡Lombokæ”¹é€ åçš„ POJO ç±»æ˜¯è¿™æ ·çš„ ä¸€çœ¼å¯ä»¥è§‚å¯Ÿå‡ºæ¥æˆ‘ä»¬åœ¨ç¼–å†™ Employee è¿™ä¸ªç±»çš„æ—¶å€™é€šè¿‡ @Data æ³¨è§£å°±å·²ç»å®ç°äº†æ‰€æœ‰æˆå‘˜å˜é‡çš„ get() ä¸ set() æ–¹æ³•ç­‰ï¼ŒåŒæ—¶ Employee ç±»çœ‹èµ·æ¥æ›´åŠ æ¸…æ™°ç®€æ´ã€‚Lombok çš„ç¥å¥‡ä¹‹å¤„ä¸æ­¢è¿™äº›ï¼Œä¸°å¯Œçš„æ³¨è§£æ»¡è¶³äº†æˆ‘ä»¬å¼€å‘çš„å¤šæ•°éœ€æ±‚ã€‚ Lombokçš„å®‰è£…æŸ¥çœ‹ä¸‹å›¾ï¼Œ@Dataçš„å®ç°ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªæ³¨è§£æ˜¯åº”ç”¨åœ¨ç¼–è¯‘é˜¶æ®µçš„ è¿™å’Œæˆ‘ä»¬å¤§å¤šæ•°ä½¿ç”¨çš„æ³¨è§£ï¼Œå¦‚ Spring çš„æ³¨è§£ï¼ˆåœ¨è¿è¡Œæ—¶ï¼Œé€šè¿‡åå°„æ¥å®ç°ä¸šåŠ¡é€»è¾‘ï¼‰æ˜¯æœ‰å¾ˆå¤§å·®åˆ«çš„ï¼Œå¦‚Spring çš„@RestController æ³¨è§£ ä¸€ä¸ªæ›´ç›´æ¥çš„ä½“ç°å°±æ˜¯ï¼Œæ™®é€šçš„åŒ…åœ¨å¼•ç”¨ä¹‹åä¸€èˆ¬çš„ IDE éƒ½èƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«è¯­æ³•ï¼Œä½†æ˜¯ Lombok çš„è¿™äº›æ³¨è§£ï¼Œä¸€èˆ¬çš„ IDE éƒ½æ— æ³•è‡ªåŠ¨è¯†åˆ«ï¼Œå› æ­¤å¦‚æœè¦ä½¿ç”¨ Lombok çš„è¯è¿˜éœ€è¦é…åˆå®‰è£…ç›¸åº”çš„æ’ä»¶æ¥æ”¯æŒ IDE çš„ç¼–è¯‘ï¼Œé˜²æ­¢IDE çš„è‡ªåŠ¨æ£€æŸ¥æŠ¥é”™ï¼Œä¸‹é¢ä»¥ IntelliJ IDEA ä¸¾ä¾‹å®‰è£…æ’ä»¶ã€‚ åœ¨Repositoriesä¸­æœç´¢Lombokï¼Œå®‰è£…åé‡å¯IDEå³å¯ åœ¨Mavenæˆ–Gradleå·¥ç¨‹ä¸­æ·»åŠ ä¾èµ– è‡³æ­¤æˆ‘ä»¬å°±å¯ä»¥åº”ç”¨ Lombok æä¾›çš„æ³¨è§£å¹²äº›äº‹æƒ…äº†ã€‚ Lombokæ³¨è§£è¯¦è§£Lombokå®˜ç½‘æä¾›äº†è®¸å¤šæ³¨è§£ï¼Œä½†æ˜¯ â€œåŠ²é…’è™½å¥½ï¼Œå¯ä¸è¦è´ªæ¯å“¦â€ï¼Œæ¥ä¸‹æ¥é€ä¸€è®²è§£å®˜ç½‘æ¨èä½¿ç”¨çš„æ³¨è§£(æœ‰äº›æ³¨è§£å’ŒåŸæœ‰Javaç¼–å†™æ–¹å¼æ²¡å¤ªå¤§å·®åˆ«çš„ä¹Ÿæ²¡æœ‰åœ¨æ­¤å¤„åˆ—ä¸¾ï¼Œå¦‚@ Synchronizedç­‰) @Getterå’Œ@Setterè¯¥æ³¨è§£å¯åº”ç”¨åœ¨ç±»æˆ–æˆå‘˜å˜é‡ä¹‹ä¸Šï¼Œå’Œæˆ‘ä»¬é¢„æƒ³çš„ä¸€æ ·ï¼Œ@Getter å’Œ @Setter å°±æ˜¯ä¸ºæˆå‘˜å˜é‡è‡ªåŠ¨ç”Ÿæˆ get å’Œ set æ–¹æ³•ï¼Œé»˜è®¤ç”Ÿæˆè®¿é—®æƒé™ä¸º public æ–¹æ³•ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šè®¿é—®æƒé™ protected ç­‰ï¼Œå¦‚ä¸‹å›¾ï¼š æˆå‘˜å˜é‡nameæŒ‡å®šç”Ÿæˆsetæ–¹æ³•ï¼Œå¹¶ä¸”è®¿é—®æƒé™ä¸ºprotectedï¼›booleanç±»å‹çš„æˆå‘˜å˜é‡ female åªç”Ÿæˆgetæ–¹æ³•ï¼Œå¹¶ä¿®æ”¹æ–¹æ³•åç§°ä¸º isFemale()ã€‚å½“æŠŠè¯¥æ³¨è§£åº”ç”¨åœ¨ç±»ä¸Šï¼Œé»˜è®¤ä¸ºæ‰€æœ‰éé™æ€æˆå‘˜å˜é‡ç”Ÿæˆ get å’Œ set æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ AccessLevel.NONE æ‰‹åŠ¨ç¦æ­¢ç”Ÿæˆgetæˆ–setæ–¹æ³•ï¼Œå¦‚ä¸‹å›¾ï¼š @ToStringè¯¥æ³¨è§£éœ€åº”ç”¨åœ¨ç±»ä¸Šï¼Œä¸ºæˆ‘ä»¬ç”Ÿæˆ Object çš„ toString æ–¹æ³•ï¼Œè€Œè¯¥æ³¨è§£é‡Œé¢çš„å‡ ä¸ªå±æ€§èƒ½æ›´åŠ ä¸°å¯Œæˆ‘ä»¬æƒ³è¦çš„å†…å®¹, exclude å±æ€§ç¦æ­¢åœ¨ toString æ–¹æ³•ä¸­ä½¿ç”¨æŸå­—æ®µï¼Œè€Œofå±æ€§å¯ä»¥æŒ‡å®šéœ€è¦ä½¿ç”¨çš„å­—æ®µï¼Œå¦‚ä¸‹å›¾ï¼š æŸ¥çœ‹ç¼–è¯‘åçš„Employee.classå¾—åˆ°æˆ‘ä»¬é¢„æœŸçš„ç»“æœï¼Œå¦‚ä¸‹å›¾ @EqualsAndHashCodeè¯¥æ³¨è§£éœ€åº”ç”¨åœ¨ç±»ä¸Šï¼Œä½¿ç”¨è¯¥æ³¨è§£ï¼Œlombokä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆ equals(Object other) å’Œ hashcode() æ–¹æ³•ï¼ŒåŒ…æ‹¬æ‰€æœ‰éé™æ€å±æ€§å’Œétransientçš„å±æ€§ï¼ŒåŒæ ·è¯¥æ³¨è§£ä¹Ÿå¯ä»¥é€šè¿‡ exclude å±æ€§æ’é™¤æŸäº›å­—æ®µï¼Œof å±æ€§æŒ‡å®šæŸäº›å­—æ®µï¼Œä¹Ÿå¯ä»¥é€šè¿‡ callSuper å±æ€§åœ¨é‡å†™çš„æ–¹æ³•ä¸­ä½¿ç”¨çˆ¶ç±»çš„å­—æ®µï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ›´çµæ´»çš„å®šä¹‰beançš„æ¯”å¯¹ï¼Œå¦‚ä¸‹å›¾ï¼š æŸ¥çœ‹ç¼–è¯‘åçš„Employee.classæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š @NonNullè¯¥æ³¨è§£éœ€åº”ç”¨åœ¨æ–¹æ³•æˆ–æ„é€ å™¨çš„å‚æ•°ä¸Šæˆ–å±æ€§ä¸Šï¼Œç”¨æ¥åˆ¤æ–­å‚æ•°çš„åˆæ³•æ€§ï¼Œé»˜è®¤æŠ›å‡º NullPointerException å¼‚å¸¸ æŸ¥çœ‹NonNullExample.classæ–‡ä»¶ï¼Œä¼šä¸ºæˆ‘ä»¬æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œå¦‚ä¸‹å›¾ï¼š å½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šå¼‚å¸¸ç±»å‹æŠ›å‡ºå…¶ä»–å¼‚å¸¸ï¼Œlombok.nonNull.exceptionType = [NullPointerException | IllegalArgumentException] , ä¸ºå®ç°æ­¤åŠŸèƒ½æˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ–°å»ºlombok.configæ–‡ä»¶ï¼š é‡æ–°ç¼–è¯‘NonNullExampleç±»ï¼Œå·²ç»ä¸ºæˆ‘ä»¬æŠ›å‡ºéæ³•å‚æ•°å¼‚å¸¸ï¼š @NoArgsConstructor, @RequiredArgsConstructor, @AllArgsConstructorä»¥ä¸Šä¸‰ä¸ªæ³¨è§£åˆ†åˆ«ä¸ºæˆ‘ä»¬ç”Ÿæˆæ— å‚æ„é€ å™¨ï¼ŒæŒ‡å®šå‚æ•°æ„é€ å™¨å’ŒåŒ…å«æ‰€æœ‰å‚æ•°çš„æ„é€ å™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ@RequiredArgsConstructor, @AllArgsConstructor ç”Ÿæˆçš„æ„é€ å™¨ä¼šå¯¹æ‰€æœ‰æ ‡è®° @NonNull çš„å±æ€§åšéç©ºæ ¡éªŒã€‚ æ— å‚æ„é€ å™¨å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹çœ‹åä¸¤ç§ï¼Œå…ˆçœ‹ @RequiredArgsConstructor ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ @RequiredArgsConstructor æ³¨è§£ç”Ÿæˆæœ‰å‚æ•°æ„é€ å™¨æ—¶åªä¼šåŒ…å«æœ‰ final å’Œ @NonNull æ ‡è¯†çš„ fieldï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥æŒ‡å®š staticName é€šè¿‡ç”Ÿæˆé™æ€æ–¹æ³•æ¥æ„é€ å¯¹è±¡ æŸ¥çœ‹Employee.classæ–‡ä»¶ å½“æˆ‘ä»¬æŠŠ staticName å±æ€§å»æ‰æˆ‘ä»¬æ¥çœ‹éä»¥åçš„æ–‡ä»¶: ç›¸ä¿¡ä½ å·²ç»æ³¨æ„åˆ°ç»†èŠ‚ @AllArgsConstructor å°±æ›´ç®€å•äº†ï¼Œè¯·å¤§å®¶è‡ªè¡ŒæŸ¥çœ‹å§ @Dataä»‹ç»äº†ä»¥ä¸Šçš„æ³¨è§£ï¼Œå†æ¥ä»‹ç» @Data å°±éå¸¸å®¹æ˜“æ‡‚äº†ï¼Œ@Data æ³¨è§£åº”ç”¨åœ¨ç±»ä¸Šï¼Œæ˜¯@ToString, @EqualsAndHashCode, @Getter / @Setter å’Œ @RequiredArgsConstructoråˆåŠ›çš„ä½“ç°ï¼Œå¦‚ä¸‹å›¾ï¼š @Builderå‡½æ•°å¼ç¼–ç¨‹æˆ–è€…è¯´æµå¼çš„æ“ä½œè¶Šæ¥è¶Šæµè¡Œï¼Œåº”ç”¨åœ¨å¤§å¤šæ•°è¯­è¨€ä¸­ï¼Œè®©ç¨‹åºæ›´å…·æ›´ç®€ä»‹ï¼Œå¯è¯»æ€§æ›´é«˜ï¼Œç¼–å†™æ›´è¿è´¯ï¼Œ@Builderå°±å¸¦æ¥äº†è¿™ä¸ªåŠŸèƒ½ï¼Œç”Ÿæˆä¸€ç³»åˆ—çš„builder APIï¼Œè¯¥æ³¨è§£ä¹Ÿéœ€è¦åº”ç”¨åœ¨ç±»ä¸Šï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­å°±ä¼šæ›´åŠ æ¸…æ™°æ˜äº†ã€‚ ç¼–è¯‘åçš„Employee.classæ–‡ä»¶å¦‚ä¸‹ï¼š å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘ set å€¼é‚£ä¹ˆéº»çƒ¦äº†ï¼Œæµå¼æ“ä½œæå®šï¼š @Logè¯¥æ³¨è§£éœ€è¦åº”ç”¨åˆ°ç±»ä¸Šï¼Œåœ¨ç¼–å†™æœåŠ¡å±‚ï¼Œéœ€è¦æ·»åŠ ä¸€äº›æ—¥å¿—ï¼Œä»¥ä¾¿å®šä½é—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå®šä¹‰ä¸€ä¸ªé™æ€å¸¸é‡Loggerï¼Œç„¶ååº”ç”¨åˆ°æˆ‘ä»¬æƒ³æ—¥å¿—çš„åœ°æ–¹ï¼Œç°åœ¨ä¸€ä¸ªæ³¨è§£å°±å¯ä»¥å®ç°ï¼š æŸ¥çœ‹classæ–‡ä»¶ï¼Œå’Œæˆ‘ä»¬é¢„æƒ³çš„ä¸€æ ·ï¼š Logæœ‰å¾ˆå¤šå˜ç§ï¼ŒCommonLogï¼ŒLog4jï¼ŒLog4j2ï¼ŒSlf4jç­‰ï¼Œlombokä¾æ—§è‰¯å¥½çš„é€šè¿‡å˜ç§æ³¨è§£åšè‰¯å¥½çš„æ”¯æŒï¼š æˆ‘å®é™…ä½¿ç”¨çš„æ˜¯ @Slf4j æ³¨è§£ valç†Ÿæ‚‰ Javascript çš„åŒå­¦éƒ½çŸ¥é“ï¼Œvar å¯ä»¥å®šä¹‰ä»»ä½•ç±»å‹çš„å˜é‡ï¼Œè€Œåœ¨ java çš„å®ç°ä¸­æˆ‘ä»¬éœ€è¦æŒ‡å®šå…·ä½“å˜é‡çš„ç±»å‹ï¼Œè€Œ val è®©æˆ‘ä»¬æ‘†è„±æŒ‡å®šï¼Œç¼–è¯‘ä¹‹åå°±ç²¾å‡†åŒ¹é…ä¸Šç±»å‹ï¼Œé»˜è®¤æ˜¯ final ç±»å‹ï¼Œå°±åƒ java8 çš„å‡½æ•°å¼è¡¨è¾¾å¼ï¼Œ()-&gt;System.out.println(â€œhello lombokâ€); å°±å¯ä»¥è§£æåˆ°Runnableå‡½æ•°å¼æ¥å£ã€‚ æŸ¥çœ‹è§£æåçš„classæ–‡ä»¶ï¼š @Cleanupå½“æˆ‘ä»¬å¯¹æµè¿›è¡Œæ“ä½œï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è°ƒç”¨ close æ–¹æ³•æ¥å…³é—­æˆ–ç»“æŸæŸèµ„æºï¼Œè€Œ @Cleanup æ³¨è§£å¯ä»¥å¸®åŠ©æˆ‘ä»¬è°ƒç”¨ close æ–¹æ³•ï¼Œå¹¶ä¸”æ”¾åˆ° try/finally å¤„ç†å—ä¸­ï¼Œå¦‚ä¸‹å›¾ï¼š ç¼–è¯‘åçš„classæ–‡ä»¶å¦‚ä¸‹ï¼Œæˆ‘ä»¬å‘ç°è¢«try/finallyåŒ…å›´å¤„ç†ï¼Œå¹¶è°ƒç”¨äº†æµçš„closeæ–¹æ³• å…¶å®åœ¨ JDK1.7 ä¹‹åå°±æœ‰äº† try-with-resourceï¼Œä¸ç”¨æˆ‘ä»¬æ˜¾å¼çš„å…³é—­æµï¼Œè¿™ä¸ªè¯·å¤§å®¶è‡ªè¡Œçœ‹å§ æ€»ç»“Lombokçš„åŸºæœ¬æ“ä½œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š å®šä¹‰ç¼–è¯‘æœŸçš„æ³¨è§£ åˆ©ç”¨JSR269 api(Pluggable Annotation Processing API )åˆ›å»ºç¼–è¯‘æœŸçš„æ³¨è§£å¤„ç†å™¨ åˆ©ç”¨tools.jarçš„javac apiå¤„ç†AST(æŠ½è±¡è¯­æ³•æ ‘) å°†åŠŸèƒ½æ³¨å†Œè¿›jaråŒ… Lombok å½“ç„¶è¿˜æœ‰å¾ˆå¤šæ³¨è§£ï¼Œæˆ‘æ¨èä½¿ç”¨ä»¥ä¸Šå°±è¶³å¤Ÿäº†ï¼Œè¿™ä¸ªå·¥å…·æ˜¯å¸¦æ¥ä¾¿åˆ©çš„ï¼Œè€Œä¸èƒ½è¢«å…¶æ†ç»‘ï¼Œâ€œå¼±æ°´ä¸‰åƒåªå–ä¸€ç“¢é¥®ï¼Œä»£ç åƒä¸‡éœ€æŠ“é‡ç‚¹çœ‹â€ï¼ŒLombok èƒ½è®©æˆ‘æ›´åŠ ä¸“æ³¨æœ‰æ•ˆä»£ç æ’é™¤æ„ä¹‰å¾®å°çš„éšœçœ¼ä»£ç ï¼ˆgetï¼Œsetç­‰ï¼‰ï¼Œå¦å¤–Lombokç”Ÿæˆçš„ä»£ç è¿˜èƒ½åƒä½¿ç”¨å·¥å…·ç±»ä¸€æ ·æ–¹ä¾¿ï¼ˆ@Builderï¼‰ã€‚ æ›´å¤šå†…å®¹è¯·æŸ¥çœ‹å®˜ç½‘ï¼šhttps://www.projectlombok.org/ çµé­‚è¿½é—® ä¸ºä»€ä¹ˆåªæœ‰ä¸€ä¸ªæ•´ä½“ @EqualsAndHashCode æ³¨è§£ï¼Ÿè€Œä¸æ˜¯ @Equals å’Œ @HashCodeï¼Ÿè¿™æ¶‰åŠåˆ°ä¸€ä¸ªè§„èŒƒå“¦ å¦‚æœæŠŠä¸‰ç§æ„é€ å™¨æ–¹å¼åŒæ—¶åº”ç”¨åˆåŠ ä¸Šäº† @Builder æ³¨è§£ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ ä½ çš„ç¯è¿˜äº®ç€å—ï¼Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://dayarch.top/tags/Java/"},{"name":"Lombok","slug":"Lombok","permalink":"https://dayarch.top/tags/Lombok/"}]},{"title":"SDKMAN ç»Ÿä¸€çµæ´»ç®¡ç†å¤šç‰ˆæœ¬Java","slug":"å¤šç‰ˆæœ¬Javaç»Ÿä¸€çµæ´»ç®¡ç†","date":"2019-11-14T00:51:02.000Z","updated":"2019-11-14T01:24:50.504Z","comments":true,"path":"/p/multiple-java-management.html","link":"","permalink":"https://dayarch.top/p/multiple-java-management.html","excerpt":"è¿‘ä¸¤å¹´ï¼ŒJava ç‰ˆæœ¬å‡çº§é¢‘ç¹ï¼Œæ„Ÿè§‰åˆšåˆšæŒæ¡ Java8ï¼Œå†™æœ¬æ–‡æ—¶ï¼Œå·²å¬åˆ° java14 çš„æ¶ˆæ¯ï¼Œæ— è®ºæ˜¯å°é²œæ–°ç‰¹æ€§(Java12 ä¸­è¶…çº§é¦™çš„ä¸€ä¸ªåŠŸèƒ½)ï¼Œè¿˜æ˜¯ç”±äºé¡¹ç›®å‡çº§/å…¼å®¹éœ€è¦ï¼Œæˆ‘ä»¬å¯èƒ½éƒ½è¦é¢ä¸´ç®¡ç†å¤šä¸ª Java ç‰ˆæœ¬çš„æƒ… å¦å¤– Oracle è‡ª Java11 å¼€å§‹ï¼Œæ›´æ”¹äº†ç”¨æˆ·åè®®ï¼Œä»»ä½•å•†ç”¨éƒ½ä¼šæ”¶è´¹ã€‚åœ¨å†™æœ¬æ–‡æ—¶ï¼Œå¾—åˆ°æ¶ˆæ¯ã€Œå¾®è½¯å®£å¸ƒåŠ å…¥ OpenJDKã€ï¼Œæ‰“ä¸è¿‡å°±é€‰æ‹© OpenJDKã€‚éšä¾¿ G ä¸€ä¸‹ï¼Œå½“ä¸ªæ•…äº‹äº†è§£å°±å¯ä»¥ é…ç½®å•ä¸ª Java ç¯å¢ƒå˜é‡æœ¬èº«æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡å¯è¨€ï¼Œä½†å½“éœ€è¦ç®¡ç†å¤šä¸ª Java ç‰ˆæœ¬ï¼Œé‡å¤é…ç½®ç¯å¢ƒå˜é‡æ˜¾ç„¶æ˜¯éå¸¸æ¯ç‡¥çš„ï¼ŒæŒ‰ç…§ä¼ ç»Ÿçš„é…ç½®æ–¹å¼æˆ‘ä»¬åˆä¸èƒ½çµæ´»çš„åˆ‡æ¢ Java ç‰ˆ","text":"è¿‘ä¸¤å¹´ï¼ŒJava ç‰ˆæœ¬å‡çº§é¢‘ç¹ï¼Œæ„Ÿè§‰åˆšåˆšæŒæ¡ Java8ï¼Œå†™æœ¬æ–‡æ—¶ï¼Œå·²å¬åˆ° java14 çš„æ¶ˆæ¯ï¼Œæ— è®ºæ˜¯å°é²œæ–°ç‰¹æ€§(Java12 ä¸­è¶…çº§é¦™çš„ä¸€ä¸ªåŠŸèƒ½)ï¼Œè¿˜æ˜¯ç”±äºé¡¹ç›®å‡çº§/å…¼å®¹éœ€è¦ï¼Œæˆ‘ä»¬å¯èƒ½éƒ½è¦é¢ä¸´ç®¡ç†å¤šä¸ª Java ç‰ˆæœ¬çš„æƒ… å¦å¤– Oracle è‡ª Java11 å¼€å§‹ï¼Œæ›´æ”¹äº†ç”¨æˆ·åè®®ï¼Œä»»ä½•å•†ç”¨éƒ½ä¼šæ”¶è´¹ã€‚åœ¨å†™æœ¬æ–‡æ—¶ï¼Œå¾—åˆ°æ¶ˆæ¯ã€Œå¾®è½¯å®£å¸ƒåŠ å…¥ OpenJDKã€ï¼Œæ‰“ä¸è¿‡å°±é€‰æ‹© OpenJDKã€‚éšä¾¿ G ä¸€ä¸‹ï¼Œå½“ä¸ªæ•…äº‹äº†è§£å°±å¯ä»¥ é…ç½®å•ä¸ª Java ç¯å¢ƒå˜é‡æœ¬èº«æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡å¯è¨€ï¼Œä½†å½“éœ€è¦ç®¡ç†å¤šä¸ª Java ç‰ˆæœ¬ï¼Œé‡å¤é…ç½®ç¯å¢ƒå˜é‡æ˜¾ç„¶æ˜¯éå¸¸æ¯ç‡¥çš„ï¼ŒæŒ‰ç…§ä¼ ç»Ÿçš„é…ç½®æ–¹å¼æˆ‘ä»¬åˆä¸èƒ½çµæ´»çš„åˆ‡æ¢ Java ç‰ˆæœ¬ é‚£è¦å¦‚ä½•è½»æ¾ç®¡ç†ä¸ä½¿ç”¨å¤šä¸ªç‰ˆæœ¬ Javaï¼Ÿ å¤šç‰ˆæœ¬ Java ç®¡ç†æ˜¾ç„¶æˆ‘ä»¬ä¸æ˜¯ç¬¬ä¸€ä¸ªæœ‰è¿™ç§å›°å¢ƒçš„äººï¼Œæˆ‘æ‰€çŸ¥é“çš„ç°æœ‰æ–¹æ¡ˆæœ‰ä¸‰ç§: Jabba jenv sdkman æœ¬æ–‡ä¸»è¦è¯´æ˜å¦‚ä½•é€šè¿‡ sdkman æ‰“ç ´æˆ‘ä»¬é¢ä¸´çš„å›°å¢ƒï¼Œå¸®åŠ©æˆ‘ä»¬çµæ´»é…ç½®ä¸ä½¿ç”¨ Java sdkman ä»‹ç»SDKMAN æ˜¯ä¸€ä¸ªç”¨äºåœ¨å¤§å¤šæ•°åŸºäº Unix ç³»ç»Ÿä¸Šç®¡ç† å¤šä¸ªè½¯ä»¶å¼€å‘å·¥å…·åŒ… (Java, Groovy, Scala, Kotlin and Ceylon. Ant, Gradle ç­‰) çš„å¹¶è¡Œç‰ˆæœ¬çš„å·¥å…· ã€‚ å®ƒæä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„å‘½ä»¤è¡Œæ¥å£ (CLI) å’Œ APIï¼Œç”¨äºå®‰è£…ã€åˆ‡æ¢ã€åˆ é™¤å’Œåˆ—å‡ºå€™é€‰å¯¹è±¡ã€‚æœ¬æ–‡ä¸»è¦é€šè¿‡ç®¡ç† Java æ¥è¯´æ˜ sdkman çš„ä½¿ç”¨ sdkman å®‰è£…åœ¨ç±» unix å¹³å°ä¸Šå®‰è£… sdkman éå¸¸å®¹æ˜“ã€‚å®ƒå¯ä»¥é¡ºåˆ©çš„å®‰è£…åœ¨Mac OSXã€Linuxã€WLSã€Cygwinã€Solariså’ŒFreeBSD ä¸Šï¼ŒåŒæ—¶è¿˜æ”¯æŒBashå’Œ ZSH shellã€‚ åªéœ€æ‰“å¼€ä¸€ä¸ªæ–°ç»ˆç«¯æœºå¹¶è¾“å…¥: 1$ curl -s \"https://get.sdkman.io\" | bash æŒ‰ç…§ç›¸åº”çš„æŒ‡ä»¤æç¤ºï¼Œå®Œæˆç›¸åº”çš„æ“ä½œåç»§ç»­è¾“å…¥: 1$ source \"$HOME/.sdkman/bin/sdkman-init.sh\" åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥éªŒè¯ sdk çš„å®‰è£…ç‰ˆæœ¬äº†: 1$ sdk version ä¸Šå›¾çº¢è‰²æ¡†æ ‡è®°æ˜¾ç¤ºæˆ‘å½“å‰ sdkman çš„ç‰ˆæœ¬ï¼Œæ¯æ¬¡æ‰§è¡Œ sdk version å‘½ä»¤æ—¶ï¼Œéƒ½ä¼šæ£€æŸ¥æ˜¯å¦ä¼šæœ‰æ–°ç‰ˆæœ¬ï¼Œå¦‚æœè¦æ›´æ–°è¾“å…¥ y å°±å¯ä»¥ æœ‰äº›ç³»ç»Ÿå‘è¡Œç‰ˆæœ¬ä¸åŒ…å« zip å’Œ unzipï¼Œå¦‚æœå®‰è£…æ—¶é‡åˆ°ç›¸å…³é”™è¯¯ï¼Œå¯ä»¥è¾“å…¥å¦‚ä¸‹å‘½ä»¤å®‰è£… zip å’Œ unzip 1$ sudo apt-get install zip unzip ä»ä¸Šé¢çš„å®‰è£…å‘½ä»¤ä¸Šå¯ä»¥çœ‹å‡ºï¼Œsdkman é»˜è®¤çš„å®‰è£…è·¯å¾„æ˜¯åœ¨$HOME/.sdkman ä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å®‰è£…è·¯å¾„ï¼Œåªéœ€è¦æŒ‡å®š SDKMAN_DIR å˜é‡å€¼å°±å¥½äº†: 1$ export SDKMAN_DIR=\"/usr/local/sdkman\" &amp;&amp; curl -s \"https://get.sdkman.io\" | bash åˆ°è¿™é‡Œ sdkman çš„å®‰è£…å°±ç»“æŸäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ sdkman ä½¿ç”¨æ•™ç¨‹å‘½ä»¤è¡Œä¸‹å­¦ä¹ ä¸€ä¸ªæ–°ç©æ„å½“ç„¶æ˜¯æŸ¥çœ‹å®ƒçš„ help å‘½ä»¤ï¼Œè¾“å…¥: 1$ sdkman help æ„Ÿè§‰ä¸Šå›¾æŒ‰é¢œè‰²åŒºåˆ†å†…å®¹åï¼Œsdkman çš„ä½¿ç”¨è¯´æ˜ä¹Ÿå°±ç»“æŸäº†ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„å›¾æ¥è¯¦ç»†è¯´æ˜ä¸€ä¸‹ä½¿ç”¨æ•™ç¨‹ sdk listå…ˆæ¥è¾“å…¥: 1$ sdk list ç»¿è‰²çš„æ ‡è®°å°±æ˜¯ sdkman é›†æˆçš„æ‰€æœ‰å¯ç”¨çš„ candidateï¼Œé€šè¿‡æŒ‰å›è½¦ã€Œenterã€æŒ‰é”®ï¼Œä¼šçœ‹åˆ°æ›´å¤šå¯ç”¨ candidate æˆ‘ä»¬æŒ‡å®š candidateï¼Œè¾“å…¥: 1$ sdk list java ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰ java å¯ç”¨çš„ç‰ˆæœ¬ versionï¼Œä»¥åŠæ ‡è¯† indentifierï¼Œä»¥åŠçŠ¶æ€ statusï¼Œæˆ‘å·²ç»å®‰è£…äº† java 12 å’Œ 11 æœ‰äº†è¿™äº›ä¿¡æ¯åšé“ºå«ï¼Œæˆ‘ä»¬å¯ä»¥å®‰è£…ä»»æ„ sdkman å†…ç½®çš„è½¯ä»¶å¼€å‘åŒ…äº†ï¼Œç»§ç»­ä»¥ java ä¸ºä¾‹ sdk installå›çœ‹ sdkman help å‘½ä»¤çš„è¾“å‡ºï¼Œä½¿ç”¨ install å‘½ä»¤ï¼Œæˆ‘ä»¬å†å®‰è£…ä¸€ä¸ª Java æœ€æ–° 13.0.1.j9 ç‰ˆæœ¬ ä»ä¸Šå›¾ä½ å¯ä»¥çœ‹å‡ºï¼Œç»¿è‰²æ ‡è®°çš„å†…å®¹æ˜¯ list å‘½ä»¤ç»“æœä¸­çš„ version å€¼ï¼Œä½†æ˜¯æŠ¥é”™ä¸å¯ç”¨ï¼Œè¾“å…¥indentifier ç¼–å·æ‰èƒ½æ­£å¸¸ä¸‹è½½ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ å®‰è£…å®Œåï¼Œstatus å°±ä¼šç¼–ç¨‹ installed çŠ¶æ€ sdk currentå½“å®‰è£…å¤šä¸ªç‰ˆæœ¬çš„ java æ—¶ï¼Œæˆ‘ä»¬è¾“å…¥ä¸‹é¢å‘½ä»¤è·å–å½“å‰æ­£åœ¨ç”¨ candidate çš„ç‰ˆæœ¬ 1$ sdk current java sdk useäº†è§£äº†å½“å‰ä½¿ç”¨ç‰ˆæœ¬ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åˆ‡æ¢åˆ°å…¶ä»–ç‰ˆæœ¬, å¯ä»¥è¾“å…¥: 1$ sdk use java 12.0.2.j9-adpt æ³¨æ„âš ï¸: è¿™é‡ŒåŒæ ·æ˜¯æŒ‡å®šçš„ indentifier çš„å€¼ sdk defaultå¦‚æœæˆ‘ä»¬æƒ³æŒ‡å®šæŸä¸ªç‰ˆæœ¬ä¸ºé»˜è®¤ç‰ˆæœ¬ï¼Œå¯ä»¥è¾“å…¥: 1$ sdk default java jdk1.8.0_162.jdk æ³¨æ„âš ï¸: è¿™é‡ŒåŒæ ·æ˜¯æŒ‡å®šçš„ indentifier çš„å€¼ sdk uninstallå½“æˆ‘ä»¬æƒ³å¸è½½æŸä¸ªç‰ˆæœ¬å¯ä»¥è¾“å…¥: 1$ sdk uninstall java 12.0.2.j9-adpt æ³¨æ„âš ï¸: è¿™é‡ŒåŒæ ·æ˜¯æŒ‡å®šçš„ indentifier çš„å€¼ sdk upgradeå¦‚æœæˆ‘ä»¬æƒ³å‡çº§æŸä¸ª candidateï¼Œå¯ä»¥è¾“å…¥: 1$ sdk upgrade java sdk flushä½¿ç”¨ sdkman æ—¶é—´å˜é•¿ä¹Ÿä¼šæ…¢æ…¢äº§ç”Ÿå¾ˆå¤šç¼“å­˜å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥æ¸…ç†å¹¿æ’­æ¶ˆæ¯: 1$ sdk flush broadcast æ¸…ç†ä¸‹è½½çš„ sdk äºŒè¿›åˆ¶æ–‡ä»¶(é•¿æ—¶é—´ä½¿ç”¨åæ¸…ç†ï¼Œå¯ä»¥èŠ‚çœå‡ºå¾ˆå¤šç©ºé—´): 1$ sdk flush archives æ¸…ç†ä¸´æ—¶æ–‡ä»¶å†…å®¹: 1$ sdk flush temp åˆ°è¿™é‡Œ sdkman çš„åŸºæœ¬ä½¿ç”¨å°±å·²ç»ä»‹ç»å®Œäº†ï¼Œå…¶å®è¿™äº›å‘½ä»¤éƒ½ä¸ç”¨æ€¥ï¼Œæƒ³ä¸èµ·æ¥çš„æ—¶å€™æ‰§è¡Œ sdk help æ¥ä¸´æ—¶æŸ¥çœ‹ä¸€ä¸‹å°±å¥½ sdkman å¸è½½å¦‚æœæˆ‘ä»¬ä¸å–œæ¬¢ sdkman äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è½»æ¾çš„å¸è½½æ‰å®ƒ: 12$ tar zcvf ~/sdkman-backup_$(date +%F-%kh%M).tar.gz -C ~/ .sdkman$ rm -rf ~/.sdkman æœ€åæ‰“å¼€ä½ çš„ .bashrcã€.bash_profile å’Œ/æˆ–è€… .profileï¼Œæ‰¾åˆ°å¹¶åˆ é™¤ä¸‹é¢è¿™å‡ è¡Œã€‚ 12#THIS MUST BE AT THE END OF THE FILE FOR SDKMAN TO WORK!!![[ -s \"/home/dudette/.sdkman/bin/sdkman-init.sh\" ]] &amp;&amp; source \"/home/dudette/.sdkman/bin/sdkman-init.sh\" æˆ‘ç”¨çš„ zshrcï¼Œæ‰¾åˆ° .zshrc æ–‡ä»¶åˆ é™¤æ‰ä¸Šé¢å†…å®¹å³å¯ åˆ°è¿™é‡ŒåŸºäº Unix ç³»ç»Ÿçš„ï¼Œæœ‰å…³ sdkman çš„å®‰è£…ï¼Œä½¿ç”¨åŠä¸‹è½½éƒ½å·²ç»ä»‹ç»å®Œäº†ï¼Œå¯ä»¥ä¸Šæ‰‹è¯•ä¸€è¯•äº†ï¼Œç›¸ä¿¡å¾ˆå¤šå°ä¼™ä¼´ç”¨çš„æ˜¯ Windowsï¼Œé™¤äº† jenvï¼Œ sdkman å’Œ Jabba éƒ½æœ‰ windows ç”¨æˆ·çš„è§£å†³æ–¹æ¡ˆ: sdkman windows è§£å†³æ–¹æ¡ˆåœ¨ sdkman å®˜ç½‘é¦–é¡µåŒæ ·ä¸º windows ç”¨æˆ·æä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œå°ä¼™ä¼´ä»¬æ‰¾åˆ°å¦‚ä¸‹ä½ç½®æŸ¥çœ‹å³å¯ æˆ‘çœ‹äº†ä¸€ä¸‹è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯å¾ˆç®€å•ï¼Œç”±äºæ‰‹å¤´æ²¡æœ‰ windows ç”µè„‘ï¼Œè¿™ä¸ªè¯·å°ä¼™ä¼´ä»¬è‡ªè¡Œå°è¯•å§ï¼Œæœ‰é—®é¢˜æ¬¢è¿ç•™è¨€ çµé­‚è¿½é—® ä½ ç°åœ¨ç”¨çš„ Java ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ æœ‰è·Ÿéšæ–°ç‰ˆæœ¬å°è¯•æ›´å¤šæ–°ç‰¹æ€§å—ï¼Ÿ ä½ çš„ç¯è¿˜äº®ç€å—ï¼Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://dayarch.top/tags/Java/"},{"name":"JDK","slug":"JDK","permalink":"https://dayarch.top/tags/JDK/"}]},{"title":"HttpMessageConverterè½¬æ¢åŸç†è§£æ","slug":"HttpMessageConverterè½¬æ¢åŸç†è§£æ","date":"2019-11-07T10:15:50.000Z","updated":"2019-11-08T09:01:22.470Z","comments":true,"path":"/p/spring-boot-messageconverter.html","link":"","permalink":"https://dayarch.top/p/spring-boot-messageconverter.html","excerpt":"Java Web äººå‘˜ç»å¸¸è¦è®¾è®¡ RESTful APIï¼ˆå¦‚ä½•è®¾è®¡å¥½çš„RESTful APIï¼‰ï¼Œé€šè¿‡ json æ•°æ®è¿›è¡Œäº¤äº’ã€‚é‚£ä¹ˆå‰ç«¯ä¼ å…¥çš„ json æ•°æ®å¦‚ä½•è¢«è§£ææˆ Java å¯¹è±¡ä½œä¸º APIå…¥å‚ï¼ŒAPI è¿”å›ç»“æœåˆå¦‚ä½•å°† Java å¯¹è±¡è§£ææˆ json æ ¼å¼æ•°æ®è¿”å›ç»™å‰ç«¯ï¼Œå…¶å®åœ¨æ•´ä¸ªæ•°æ®æµè½¬è¿‡ç¨‹ä¸­ï¼ŒHttpMessageConverter èµ·åˆ°äº†é‡è¦ä½œç”¨ï¼›å¦å¤–åœ¨è½¬æ¢çš„è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥åŠ å…¥å“ªäº›å®šåˆ¶åŒ–å†…å®¹ï¼Ÿ HttpMessageConverter ä»‹ç» org.springframework.http.converter.HttpMessageConverter æ˜¯ä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œæ¥å£è¯´æ˜å¦‚ä¸‹","text":"Java Web äººå‘˜ç»å¸¸è¦è®¾è®¡ RESTful APIï¼ˆå¦‚ä½•è®¾è®¡å¥½çš„RESTful APIï¼‰ï¼Œé€šè¿‡ json æ•°æ®è¿›è¡Œäº¤äº’ã€‚é‚£ä¹ˆå‰ç«¯ä¼ å…¥çš„ json æ•°æ®å¦‚ä½•è¢«è§£ææˆ Java å¯¹è±¡ä½œä¸º APIå…¥å‚ï¼ŒAPI è¿”å›ç»“æœåˆå¦‚ä½•å°† Java å¯¹è±¡è§£ææˆ json æ ¼å¼æ•°æ®è¿”å›ç»™å‰ç«¯ï¼Œå…¶å®åœ¨æ•´ä¸ªæ•°æ®æµè½¬è¿‡ç¨‹ä¸­ï¼ŒHttpMessageConverter èµ·åˆ°äº†é‡è¦ä½œç”¨ï¼›å¦å¤–åœ¨è½¬æ¢çš„è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥åŠ å…¥å“ªäº›å®šåˆ¶åŒ–å†…å®¹ï¼Ÿ HttpMessageConverter ä»‹ç»org.springframework.http.converter.HttpMessageConverter æ˜¯ä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œæ¥å£è¯´æ˜å¦‚ä¸‹ï¼š Strategy interface that specifies a converter that can convert from and to HTTP requests and responses. ç®€å•è¯´å°±æ˜¯ HTTP request (è¯·æ±‚)å’Œresponse (å“åº”)çš„è½¬æ¢å™¨ã€‚è¯¥æ¥å£æœ‰åªæœ‰5ä¸ªæ–¹æ³•ï¼Œç®€å•æ¥è¯´å°±æ˜¯è·å–æ”¯æŒçš„ MediaTypeï¼ˆapplication/jsonä¹‹ç±»ï¼‰ï¼Œæ¥æ”¶åˆ°è¯·æ±‚æ—¶åˆ¤æ–­æ˜¯å¦èƒ½è¯»ï¼ˆcanReadï¼‰ï¼Œèƒ½è¯»åˆ™è¯»ï¼ˆreadï¼‰ï¼›è¿”å›ç»“æœæ—¶åˆ¤æ–­æ˜¯å¦èƒ½å†™ï¼ˆcanWriteï¼‰ï¼Œèƒ½å†™åˆ™å†™ï¼ˆwriteï¼‰ã€‚è¿™å‡ ä¸ªæ–¹æ³•å…ˆæœ‰ä¸ªå°è±¡å³å¯ï¼š 12345boolean canRead(Class&lt;?&gt; clazz, MediaType mediaType);boolean canWrite(Class&lt;?&gt; clazz, MediaType mediaType);List&lt;MediaType&gt; getSupportedMediaTypes();T read(Class&lt;? extends T&gt; clazz, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException;void write(T t, MediaType contentType, HttpOutputMessage outputMessage) throws IOException, HttpMessageNotWritableException; ç¼ºçœé…ç½®æˆ‘ä»¬å†™ Demo æ²¡æœ‰é…ç½®ä»»ä½• MessageConverterï¼Œä½†æ˜¯æ•°æ®å‰åä¼ é€’ä¾æ—§å¥½ç”¨ï¼Œæ˜¯å› ä¸º SpringMVC å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨é…ç½®ä¸€äº›HttpMessageConverterï¼Œåœ¨ WebMvcConfigurationSupport ç±»ä¸­æ·»åŠ äº†ç¼ºçœ MessageConverterï¼š 12345678910111213141516171819202122232425262728293031protected final void addDefaultHttpMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; messageConverters) &#123; StringHttpMessageConverter stringConverter = new StringHttpMessageConverter(); stringConverter.setWriteAcceptCharset(false); messageConverters.add(new ByteArrayHttpMessageConverter()); messageConverters.add(stringConverter); messageConverters.add(new ResourceHttpMessageConverter()); messageConverters.add(new SourceHttpMessageConverter&lt;Source&gt;()); messageConverters.add(new AllEncompassingFormHttpMessageConverter()); if (romePresent) &#123; messageConverters.add(new AtomFeedHttpMessageConverter()); messageConverters.add(new RssChannelHttpMessageConverter()); &#125; if (jackson2XmlPresent) &#123; ObjectMapper objectMapper = Jackson2ObjectMapperBuilder.xml().applicationContext(this.applicationContext).build(); messageConverters.add(new MappingJackson2XmlHttpMessageConverter(objectMapper)); &#125; else if (jaxb2Present) &#123; messageConverters.add(new Jaxb2RootElementHttpMessageConverter()); &#125; if (jackson2Present) &#123; ObjectMapper objectMapper = Jackson2ObjectMapperBuilder.json().applicationContext(this.applicationContext).build(); messageConverters.add(new MappingJackson2HttpMessageConverter(objectMapper)); &#125; else if (gsonPresent) &#123; messageConverters.add(new GsonHttpMessageConverter()); &#125; &#125; æˆ‘ä»¬çœ‹åˆ°å¾ˆç†Ÿæ‚‰çš„ MappingJackson2HttpMessageConverter ï¼Œå¦‚æœæˆ‘ä»¬å¼•å…¥ jackson ç›¸å…³åŒ…ï¼ŒSpring å°±ä¼šä¸ºæˆ‘ä»¬æ·»åŠ è¯¥ MessageConverterï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸åœ¨æ­å»ºæ¡†æ¶çš„æ—¶å€™è¿˜æ˜¯ä¼šæ‰‹åŠ¨æ·»åŠ é…ç½® MappingJackson2HttpMessageConverterï¼Œä¸ºä»€ä¹ˆï¼Ÿ å…ˆæ€è€ƒä¸€ä¸‹ï¼š å½“æˆ‘ä»¬é…ç½®äº†è‡ªå·±çš„ MessageConverterï¼Œ SpringMVC å¯åŠ¨è¿‡ç¨‹å°±ä¸ä¼šè°ƒç”¨ addDefaultHttpMessageConverters æ–¹æ³•ï¼Œä¸”çœ‹ä¸‹é¢ä»£ç  if æ¡ä»¶ï¼Œè¿™æ ·åšä¹Ÿæ˜¯ä¸ºäº†å®šåˆ¶åŒ–æˆ‘ä»¬è‡ªå·±çš„ MessageConverter 1234567891011protected final List&lt;HttpMessageConverter&lt;?&gt;&gt; getMessageConverters() &#123; if (this.messageConverters == null) &#123; this.messageConverters = new ArrayList&lt;HttpMessageConverter&lt;?&gt;&gt;(); configureMessageConverters(this.messageConverters); if (this.messageConverters.isEmpty()) &#123; addDefaultHttpMessageConverters(this.messageConverters); &#125; extendMessageConverters(this.messageConverters); &#125; return this.messageConverters; &#125; ç±»å…³ç³»å›¾åœ¨æ­¤å¤„ä»…åˆ—å‡º MappingJackson2HttpMessageConverter å’Œ StringHttpMessageConverter ä¸¤ä¸ªè½¬æ¢å™¨ï¼Œæˆ‘ä»¬å‘ç°ï¼Œ å‰è€…å®ç°äº† GenericHttpMessageConverter æ¥å£, è€Œåè€…å´æ²¡æœ‰ï¼Œç•™æœ‰è¿™ä¸ªå…³é”®å°è±¡ï¼Œè¿™æ˜¯æ•°æ®æµè½¬è¿‡ç¨‹ä¸­å…³é”®é€»è¾‘åˆ¤æ–­ æ•°æ®æµè½¬è§£ææ•°æ®çš„è¯·æ±‚å’Œå“åº”éƒ½è¦ç»è¿‡ DispatcherServlet ç±»çš„ doDispatch(HttpServletRequest request, HttpServletResponse response) æ–¹æ³•çš„å¤„ç† è¯·æ±‚è¿‡ç¨‹è§£æçœ‹ doDispatch æ–¹æ³•ä¸­çš„å…³é”®ä»£ç ï¼š 1234567// è¿™é‡Œçš„ Adapter å®é™…ä¸Šæ˜¯ RequestMappingHandlerAdapterHandlerAdapter ha = this.getHandlerAdapter(mappedHandler.getHandler()); if (!mappedHandler.applyPreHandle(processedRequest, response)) &#123; return;&#125;// å®é™…å¤„ç†çš„handlermv = ha.handle(processedRequest, response, mappedHandler.getHandler()); mappedHandler.applyPostHandle(processedRequest, response, mv); ä»è¿›å…¥handleä¹‹åæˆ‘å…ˆå°†è°ƒç”¨æ ˆç²˜è´´åœ¨æ­¤å¤„ï¼Œå¸Œæœ›å°ä¼™ä¼´å¯ä»¥æŒ‰ç…§è°ƒç”¨æ ˆè·¯çº¿åŠ¨æ‰‹è·Ÿè¸ªå°è¯•ï¼š 123456789101112readWithMessageConverters:192, AbstractMessageConverterMethodArgumentResolver (org.springframework.web.servlet.mvc.method.annotation)readWithMessageConverters:150, RequestResponseBodyMethodProcessor (org.springframework.web.servlet.mvc.method.annotation)resolveArgument:128, RequestResponseBodyMethodProcessor (org.springframework.web.servlet.mvc.method.annotation)resolveArgument:121, HandlerMethodArgumentResolverComposite (org.springframework.web.method.support)getMethodArgumentValues:158, InvocableHandlerMethod (org.springframework.web.method.support)invokeForRequest:128, InvocableHandlerMethod (org.springframework.web.method.support) // ä¸‹é¢çš„è°ƒç”¨æ ˆé‡ç‚¹å…³æ³¨ï¼Œå¤„ç†è¯·æ±‚å’Œè¿”å›å€¼çš„åˆ†å‰å£å°±åœ¨è¿™é‡ŒinvokeAndHandle:97, ServletInvocableHandlerMethod (org.springframework.web.servlet.mvc.method.annotation)invokeHandlerMethod:849, RequestMappingHandlerAdapter (org.springframework.web.servlet.mvc.method.annotation)handleInternal:760, RequestMappingHandlerAdapter (org.springframework.web.servlet.mvc.method.annotation)handle:85, AbstractHandlerMethodAdapter (org.springframework.web.servlet.mvc.method)doDispatch:967, DispatcherServlet (org.springframework.web.servlet) è¿™é‡Œé‡ç‚¹è¯´æ˜è°ƒç”¨æ ˆæœ€é¡¶å±‚ readWithMessageConverters æ–¹æ³•ä¸­å†…å®¹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738// éå† messageConvertersfor (HttpMessageConverter&lt;?&gt; converter : this.messageConverters) &#123; Class&lt;HttpMessageConverter&lt;?&gt;&gt; converterType = (Class&lt;HttpMessageConverter&lt;?&gt;&gt;) converter.getClass(); // ä¸Šæ–‡ç±»å…³ç³»å›¾å¤„è¦é‡ç‚¹è®°ä½çš„åœ°æ–¹ï¼Œä¸»è¦åˆ¤æ–­ MappingJackson2HttpMessageConverter æ˜¯å¦æ˜¯ GenericHttpMessageConverter ç±»å‹ if (converter instanceof GenericHttpMessageConverter) &#123; GenericHttpMessageConverter&lt;?&gt; genericConverter = (GenericHttpMessageConverter&lt;?&gt;) converter; if (genericConverter.canRead(targetType, contextClass, contentType)) &#123; if (logger.isDebugEnabled()) &#123; logger.debug(\"Read [\" + targetType + \"] as \\\"\" + contentType + \"\\\" with [\" + converter + \"]\"); &#125; if (inputMessage.getBody() != null) &#123; inputMessage = getAdvice().beforeBodyRead(inputMessage, parameter, targetType, converterType); body = genericConverter.read(targetType, contextClass, inputMessage); body = getAdvice().afterBodyRead(body, inputMessage, parameter, targetType, converterType); &#125; else &#123; body = getAdvice().handleEmptyBody(null, inputMessage, parameter, targetType, converterType); &#125; break; &#125; &#125; else if (targetClass != null) &#123; if (converter.canRead(targetClass, contentType)) &#123; if (logger.isDebugEnabled()) &#123; logger.debug(\"Read [\" + targetType + \"] as \\\"\" + contentType + \"\\\" with [\" + converter + \"]\"); &#125; if (inputMessage.getBody() != null) &#123; inputMessage = getAdvice().beforeBodyRead(inputMessage, parameter, targetType, converterType); body = ((HttpMessageConverter&lt;T&gt;) converter).read(targetClass, inputMessage); body = getAdvice().afterBodyRead(body, inputMessage, parameter, targetType, converterType); &#125; else &#123; body = getAdvice().handleEmptyBody(null, inputMessage, parameter, targetType, converterType); &#125; break; &#125; &#125;&#125; ç„¶åå°±åˆ¤æ–­æ˜¯å¦canReadï¼Œèƒ½è¯»å°±readï¼Œæœ€ç»ˆèµ°åˆ°ä¸‹é¢ä»£ç å¤„å°†è¾“å…¥çš„å†…å®¹ååºåˆ—åŒ–å‡ºæ¥ï¼š 1234567891011121314151617181920212223242526272829protected Object _readMapAndClose(JsonParser p0, JavaType valueType) throws IOException &#123; try (JsonParser p = p0) &#123; Object result; JsonToken t = _initForReading(p); if (t == JsonToken.VALUE_NULL) &#123; // Ask JsonDeserializer what 'null value' to use: DeserializationContext ctxt = createDeserializationContext(p, getDeserializationConfig()); result = _findRootDeserializer(ctxt, valueType).getNullValue(ctxt); &#125; else if (t == JsonToken.END_ARRAY || t == JsonToken.END_OBJECT) &#123; result = null; &#125; else &#123; DeserializationConfig cfg = getDeserializationConfig(); DeserializationContext ctxt = createDeserializationContext(p, cfg); JsonDeserializer&lt;Object&gt; deser = _findRootDeserializer(ctxt, valueType); if (cfg.useRootWrapping()) &#123; result = _unwrapAndDeserialize(p, ctxt, cfg, valueType, deser); &#125; else &#123; result = deser.deserialize(p, ctxt); &#125; ctxt.checkUnresolvedObjectId(); &#125; // Need to consume the token too p.clearCurrentToken(); return result; &#125; &#125; åˆ°è¿™é‡Œä»è¯·æ±‚ä¸­è§£æå‚æ•°è¿‡ç¨‹å°±åˆ°æ­¤ç»“æŸäº†ï¼Œè¶çƒ­æ‰“é“æ¥çœ‹å°†å“åº”ç»“æœè¿”å›ç»™å‰ç«¯çš„è¿‡ç¨‹ è¿”å›è¿‡ç¨‹è§£æåœ¨ä¸Šé¢è°ƒç”¨æ ˆè¯·æ±‚å’Œè¿”å›ç»“æœåˆ†å‰å£å¤„åŒæ ·å¤„ç†è¿”å›çš„å†…å®¹ï¼š 12345writeWithMessageConverters:224, AbstractMessageConverterMethodProcessor (org.springframework.web.servlet.mvc.method.annotation)handleReturnValue:174, RequestResponseBodyMethodProcessor (org.springframework.web.servlet.mvc.method.annotation)handleReturnValue:81, HandlerMethodReturnValueHandlerComposite (org.springframework.web.method.support)// åˆ†å‰å£invokeAndHandle:113, ServletInvocableHandlerMethod (org.springframework.web.servlet.mvc.method.annotation) é‡ç‚¹å…³æ³¨è°ƒç”¨æ ˆé¡¶å±‚å†…å®¹ï¼Œæ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰çš„æ ·å­ï¼Œå®Œå…¨ä¸€æ ·çš„é€»è¾‘, åˆ¤æ–­æ˜¯å¦èƒ½å†™canWriteï¼Œèƒ½å†™åˆ™writeï¼š 12345678910111213141516171819202122232425262728293031323334for (HttpMessageConverter&lt;?&gt; messageConverter : this.messageConverters) &#123; if (messageConverter instanceof GenericHttpMessageConverter) &#123; if (((GenericHttpMessageConverter) messageConverter).canWrite( declaredType, valueType, selectedMediaType)) &#123; outputValue = (T) getAdvice().beforeBodyWrite(outputValue, returnType, selectedMediaType, (Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt;) messageConverter.getClass(), inputMessage, outputMessage); if (outputValue != null) &#123; addContentDispositionHeader(inputMessage, outputMessage); ((GenericHttpMessageConverter) messageConverter).write( outputValue, declaredType, selectedMediaType, outputMessage); if (logger.isDebugEnabled()) &#123; logger.debug(\"Written [\" + outputValue + \"] as \\\"\" + selectedMediaType + \"\\\" using [\" + messageConverter + \"]\"); &#125; &#125; return; &#125; &#125; else if (messageConverter.canWrite(valueType, selectedMediaType)) &#123; outputValue = (T) getAdvice().beforeBodyWrite(outputValue, returnType, selectedMediaType, (Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt;) messageConverter.getClass(), inputMessage, outputMessage); if (outputValue != null) &#123; addContentDispositionHeader(inputMessage, outputMessage); ((HttpMessageConverter) messageConverter).write(outputValue, selectedMediaType, outputMessage); if (logger.isDebugEnabled()) &#123; logger.debug(\"Written [\" + outputValue + \"] as \\\"\" + selectedMediaType + \"\\\" using [\" + messageConverter + \"]\"); &#125; &#125; return; &#125;&#125; æˆ‘ä»¬çœ‹åˆ°æœ‰è¿™æ ·ä¸€è¡Œä»£ç ï¼š 123outputValue = (T) getAdvice().beforeBodyWrite(outputValue, returnType, selectedMediaType, (Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt;) messageConverter.getClass(), inputMessage, outputMessage); æˆ‘ä»¬åœ¨è®¾è®¡ RESTful API æ¥å£çš„æ—¶å€™é€šå¸¸ä¼šå°†è¿”å›çš„æ•°æ®å°è£…æˆç»Ÿä¸€æ ¼å¼ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šå®ç° ResponseBodyAdvice æ¥å£æ¥å¤„ç†æ‰€æœ‰ API çš„è¿”å›å€¼ï¼Œåœ¨çœŸæ­£ write ä¹‹å‰å°†æ•°æ®è¿›è¡Œç»Ÿä¸€çš„å°è£… 12345678910111213141516171819@RestControllerAdvice()public class CommonResultResponseAdvice implements ResponseBodyAdvice&lt;Object&gt; &#123; @Override public boolean supports(MethodParameter returnType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; converterType) &#123; return true; &#125; @Override public Object beforeBodyWrite(Object body, MethodParameter returnType, MediaType selectedContentType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; selectedConverterType, ServerHttpRequest request, ServerHttpResponse response) &#123; if (body instanceof CommonResult) &#123; return body; &#125; return new CommonResult&lt;Object&gt;(body); &#125;&#125; æ•´ä¸ªå¤„ç†æµç¨‹å°±æ˜¯è¿™æ ·ï¼Œæ•´ä¸ªå®ç°è¿‡ç¨‹ç»†èŠ‚è¿˜éœ€å°ä¼™ä¼´è‡ªè¡Œè¿½è¸ªå‘ç°ï¼Œæ–‡ç« å¼€å¤´æˆ‘ä»¬è¯´è¿‡ æ·»åŠ è‡ªå·±çš„ MessageConverter èƒ½æ›´å¥½çš„æ»¡è¶³æˆ‘ä»¬çš„å®šåˆ¶åŒ–ï¼Œéƒ½æœ‰å“ªäº›å¯ä»¥å®šåˆ¶çš„å‘¢ï¼Ÿ å®šåˆ¶åŒ–ç©ºå€¼å¤„ç†è¯·æ±‚å’Œè¿”å›çš„æ•°æ®æœ‰å¾ˆå¤šç©ºå€¼ï¼Œè¿™äº›å€¼æœ‰æ—¶å€™å¹¶æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥è¿‡æ»¤æ‰å’Œä¸è¿”å›ï¼Œæˆ–è®¾ç½®æˆé»˜è®¤å€¼ã€‚æ¯”å¦‚é€šè¿‡é‡å†™ getObjectMapper æ–¹æ³•ï¼Œå°†è¿”å›ç»“æœçš„ç©ºå€¼ä¸è¿›è¡Œåºåˆ—åŒ–ï¼š 1234567converters.add(0, new MappingJackson2HttpMessageConverter()&#123; @Override public ObjectMapper getObjectMapper() &#123; super.getObjectMapper().setSerializationInclusion(JsonInclude.Include.NON_NULL); return super.getObjectMapper(); &#125;&#125; XSS è„šæœ¬æ”»å‡»ä¸ºäº†ä¿è¯è¾“å…¥çš„æ•°æ®æ›´å®‰å…¨ï¼Œé˜²æ­¢ XSS è„šæœ¬æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è‡ªå®šä¹‰ååºåˆ—åŒ–å™¨ï¼š 1234567891011121314//å¯¹åº”æ— æ³•ç›´æ¥è¿”å›Stringç±»å‹converters.add(0, new MappingJackson2HttpMessageConverter()&#123; @Override public ObjectMapper getObjectMapper() &#123; super.getObjectMapper().setSerializationInclusion(JsonInclude.Include.NON_NULL); // XSS è„šæœ¬è¿‡æ»¤ SimpleModule simpleModule = new SimpleModule(); simpleModule.addDeserializer(String.class, new StringXssDeserializer()); super.getObjectMapper().registerModule(simpleModule); return super.getObjectMapper(); &#125;&#125; ç»†èŠ‚åˆ†æcanRead å’Œ canWrite çš„åˆ¤æ–­é€»è¾‘æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ è¯·çœ‹ä¸‹å›¾ï¼š å®¢æˆ·ç«¯ Request Header ä¸­è®¾ç½®å¥½ Content-Typeï¼ˆä¼ å…¥çš„æ•°æ®æ ¼å¼ï¼‰å’ŒAcceptï¼ˆæ¥æ”¶çš„æ•°æ®æ ¼å¼ï¼‰ï¼Œæ ¹æ®é…ç½®å¥½çš„MessageConverteræ¥åˆ¤æ–­æ˜¯å¦ canRead æˆ– canWriteï¼Œç„¶åå†³å®š response.body çš„ Content-Type çš„ç¬¬ä¸€è¦ç´ æ˜¯å¯¹åº”çš„request.headers.Accept å±æ€§çš„å€¼ï¼Œåˆå«åš MediaTypeã€‚å¦‚æœæœåŠ¡ç«¯æ”¯æŒè¿™ä¸ª Acceptï¼Œé‚£ä¹ˆåº”è¯¥æŒ‰ç…§è¿™ä¸ª Accept æ¥ç¡®å®šè¿”å›response.body å¯¹åº”çš„æ ¼å¼ï¼ŒåŒæ—¶æŠŠ response.headers.Content-Type è®¾ç½®æˆè‡ªå·±æ”¯æŒçš„ç¬¦åˆé‚£ä¸ª Accept çš„ MediaType æ€»ç»“ä¸æ€è€ƒç«™åœ¨ä¸Šå¸è§†è§’çœ‹ï¼Œæ•´ä¸ªæµç¨‹å¯ä»¥æŒ‰ç…§ä¸‹å›¾è¿›è¡Œæ¦‚æ‹¬ï¼Œè¯·æ±‚æŠ¥æ–‡å…ˆè½¬æ¢æˆ HttpInputMessage, ç„¶åå†é€šè¿‡ HttpMessageConverter å°†å…¶è½¬æ¢æˆ SpringMVC çš„ java å¯¹è±¡ï¼Œåä¹‹äº¦ç„¶ã€‚ å°†å„ç§å¸¸ç”¨ HttpMessageConverter æ”¯æŒçš„MediaType å’Œ JavaType ä»¥åŠå¯¹åº”å…³ç³»æ€»ç»“åœ¨æ­¤å¤„ï¼š ç±»å æ”¯æŒçš„JavaType æ”¯æŒçš„MediaType ByteArrayHttpMessageConverter byte[] application/octet-stream, */* StringHttpMessageConverter String text/plain, */* MappingJackson2HttpMessageConverter Object application/json, application/*+json AllEncompassingFormHttpMessageConverter Map&lt;K, List&lt;?&gt;&gt; application/x-www-form-urlencoded, multipart/form-data SourceHttpMessageConverter Source application/xml, text/xml, application/*+xml æœ€åæ€è€ƒè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆ HttpMessageConverter åœ¨å†™çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆåˆ¤æ–­ canWrite ååˆ¤æ–­æ˜¯å¦æœ‰ responseBodyAdvice çš„æ•°æ®å°è£…å‘¢ï¼Ÿ å¦‚æœå…ˆè¿›è¡Œ responseBodyAdvice çš„æ•°æ®å°è£…ååˆ¤æ–­ canWrite ä¼šæ€æ ·å‘¢ï¼Ÿ æé«˜æ•ˆç‡å·¥å…·ä¾æ—§ä»‹ç»å†™è¯¥æ–‡ç« ç”¨åˆ°çš„ä¸€äº›å¥½çš„å·¥å…· processonProcessOnæ˜¯ä¸€ä¸ªåœ¨çº¿ä½œå›¾å·¥å…·çš„èšåˆå¹³å°ï¼Œå®ƒå¯ä»¥åœ¨çº¿ç”»æµç¨‹å›¾ã€æ€ç»´å¯¼å›¾ã€UIåŸå‹å›¾ã€UMLã€ç½‘ç»œæ‹“æ‰‘å›¾ã€ç»„ç»‡ç»“æ„å›¾ç­‰ç­‰ï¼Œæ‚¨æ— éœ€æ‹…å¿ƒä¸‹è½½å’Œæ›´æ–°çš„é—®é¢˜ï¼Œä¸ç®¡Macè¿˜æ˜¯Windowsï¼Œä¸€ä¸ªæµè§ˆå™¨å°±å¯ä»¥éšæ—¶éšåœ°çš„å‘æŒ¥åˆ›æ„ï¼Œè§„åˆ’å·¥ä½œï¼ŒåŒæ—¶æ‚¨å¯ä»¥æŠŠä½œå“åˆ†äº«ç»™å›¢é˜Ÿæˆå‘˜æˆ–å¥½å‹ï¼Œæ— è®ºä½•æ—¶ä½•åœ°å¤§å®¶éƒ½å¯ä»¥å¯¹ä½œå“è¿›è¡Œç¼–è¾‘ã€é˜…è¯»å’Œè¯„è®º SequenceDiagramSequenceDiagram æ˜¯ IntelliJ IDEA çš„ä¸€ä¸ªæ’ä»¶ï¼Œæœ‰äº†è¿™ä¸ªæ’ä»¶ï¼Œä½ å¯ä»¥ ç”Ÿæˆç®€å•åºåˆ—å›¾ã€‚ å•å‡»å›¾å½¢å½¢çŠ¶æ¥å¯¼èˆªä»£ç ã€‚ ä»å›¾ä¸­åˆ é™¤ç±»ã€‚ å°†å›¾è¡¨å¯¼å‡ºä¸ºå›¾åƒã€‚ é€šè¿‡â€œè®¾ç½®â€&gt;â€œå…¶ä»–è®¾ç½®â€&gt;â€œåºåˆ—â€ä»å›¾è¡¨ä¸­æ’é™¤ç±» æ–¹ä¾¿å¿«é€Ÿçš„å®šä½æ–¹æ³•å’Œç†è§£ç±»çš„è°ƒç”¨è¿‡ç¨‹","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"},{"name":"HTTP","slug":"HTTP","permalink":"https://dayarch.top/tags/HTTP/"},{"name":"MessageConverter","slug":"MessageConverter","permalink":"https://dayarch.top/tags/MessageConverter/"}]},{"title":"Java12 Collectors.teeing çš„ä½¿ç”¨è¯¦è§£","slug":"Java12-Collectors-teeing-çš„ä½¿ç”¨è¯¦è§£","date":"2019-11-05T08:43:32.000Z","updated":"2019-11-07T06:36:13.203Z","comments":true,"path":"/p/jdk12-collectors-teeing-api-usage.html","link":"","permalink":"https://dayarch.top/p/jdk12-collectors-teeing-api-usage.html","excerpt":"å‰è¨€ åœ¨ Java 12 é‡Œé¢æœ‰ä¸ªéå¸¸å¥½ç”¨ä½†åœ¨å®˜æ–¹ JEP æ²¡æœ‰å…¬å¸ƒçš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒåªæ˜¯ Collector ä¸­çš„ä¸€ä¸ªå°æ”¹åŠ¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ merge ä¸¤ä¸ª collector çš„ç»“æœï¼Œè¿™å¥è¯æ˜¾å¾—å¾ˆæŠ½è±¡ï¼Œè€è§„çŸ©ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªå›¾: ç®¡é“æ”¹é€ ç»å¸¸ä¼šç”¨è¿™ä¸ªå°ä¸œè¥¿ï¼Œé€šå¸¸æˆ‘ä»¬å«å®ƒã€Œä¸‰é€šã€ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯å°† downstream1 å’Œ downstream2 çš„æµå…¥åˆå¹¶ï¼Œç„¶åä» merger æµå‡º æœ‰äº†è¿™ä¸ªå½¢è±¡çš„è¯´æ˜æˆ‘ä»¬å°±è¿›å…¥æ­£é¢˜å§ Collectors.teeing ä¸Šé¢æåˆ°çš„å°åŠŸèƒ½å°±æ˜¯ Collectors.teeing API, å…ˆæ¥çœ‹ä¸€ä¸‹ JDK å…³äºè¯¥ API çš„è¯´æ˜ï¼Œçœ‹ç€è§‰å¾—éš¾å—çš„ç›´æ¥å¿½","text":"å‰è¨€åœ¨ Java 12 é‡Œé¢æœ‰ä¸ªéå¸¸å¥½ç”¨ä½†åœ¨å®˜æ–¹ JEP æ²¡æœ‰å…¬å¸ƒçš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒåªæ˜¯ Collector ä¸­çš„ä¸€ä¸ªå°æ”¹åŠ¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ merge ä¸¤ä¸ª collector çš„ç»“æœï¼Œè¿™å¥è¯æ˜¾å¾—å¾ˆæŠ½è±¡ï¼Œè€è§„çŸ©ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªå›¾: ç®¡é“æ”¹é€ ç»å¸¸ä¼šç”¨è¿™ä¸ªå°ä¸œè¥¿ï¼Œé€šå¸¸æˆ‘ä»¬å«å®ƒã€Œä¸‰é€šã€ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯å°† downstream1 å’Œ downstream2 çš„æµå…¥åˆå¹¶ï¼Œç„¶åä» merger æµå‡º æœ‰äº†è¿™ä¸ªå½¢è±¡çš„è¯´æ˜æˆ‘ä»¬å°±è¿›å…¥æ­£é¢˜å§ Collectors.teeingä¸Šé¢æåˆ°çš„å°åŠŸèƒ½å°±æ˜¯ Collectors.teeing API, å…ˆæ¥çœ‹ä¸€ä¸‹ JDK å…³äºè¯¥ API çš„è¯´æ˜ï¼Œçœ‹ç€è§‰å¾—éš¾å—çš„ç›´æ¥å¿½ç•¥ï¼Œç»§ç»­å‘ä¸‹çœ‹ä¾‹å­å°±å¥½äº†: 1234567891011121314151617181920212223242526272829303132333435363738/** * Returns a &#123;@code Collector&#125; that is a composite of two downstream collectors. * Every element passed to the resulting collector is processed by both downstream * collectors, then their results are merged using the specified merge function * into the final result. * * &lt;p&gt;The resulting collector functions do the following: * * &lt;ul&gt; * &lt;li&gt;supplier: creates a result container that contains result containers * obtained by calling each collector's supplier * &lt;li&gt;accumulator: calls each collector's accumulator with its result container * and the input element * &lt;li&gt;combiner: calls each collector's combiner with two result containers * &lt;li&gt;finisher: calls each collector's finisher with its result container, * then calls the supplied merger and returns its result. * &lt;/ul&gt; * * &lt;p&gt;The resulting collector is &#123;@link Collector.Characteristics#UNORDERED&#125; if both downstream * collectors are unordered and &#123;@link Collector.Characteristics#CONCURRENT&#125; if both downstream * collectors are concurrent. * * @param &lt;T&gt; the type of the input elements * @param &lt;R1&gt; the result type of the first collector * @param &lt;R2&gt; the result type of the second collector * @param &lt;R&gt; the final result type * @param downstream1 the first downstream collector * @param downstream2 the second downstream collector * @param merger the function which merges two results into the single one * @return a &#123;@code Collector&#125; which aggregates the results of two supplied collectors. * @since 12 */public static &lt;T, R1, R2, R&gt;Collector&lt;T, ?, R&gt; teeing(Collector&lt;? super T, ?, R1&gt; downstream1, Collector&lt;? super T, ?, R2&gt; downstream2, BiFunction&lt;? super R1, ? super R2, R&gt; merger) &#123; return teeing0(downstream1, downstream2, merger);&#125; API æè¿°é‡çš„ä¸€å¥è¯éå¸¸å…³é”®: Every element passed to the resulting collector is processed by both downstream collectors ç»“åˆã€Œä¸‰é€šå›¾ã€æ¥è¯´æ˜å°±æ˜¯ï¼Œé›†åˆä¸­æ¯ä¸€ä¸ªè¦è¢«ä¼ å…¥ merger çš„å…ƒç´ éƒ½ä¼šç»è¿‡ downstream1 å’Œ downstream2 çš„åŠ å·¥å¤„ç† å…¶ä¸­ merger ç±»å‹æ˜¯ BiFunctionï¼Œä¹Ÿå°±æ˜¯è¯´æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªå€¼ï¼Œè¯·çœ‹å®ƒçš„ apply æ–¹æ³• 123456789101112@FunctionalInterfacepublic interface BiFunction&lt;T, U, R&gt; &#123; /** * Applies this function to the given arguments. * * @param t the first function argument * @param u the second function argument * @return the function result */ R apply(T t, U u);&#125; è‡³äºå¯ä»¥å¦‚ä½•å¤„ç†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€äº›ä¾‹å­å§ ä¾‹å­ä¸ºäº†æ›´å¥½çš„è¯´æ˜ teeing çš„ä½¿ç”¨ï¼Œåˆ—ä¸¾äº†å››ä¸ªä¾‹å­ï¼Œçœ‹è¿‡è¿™å››ä¸ªä¾‹å­å†å›çœ‹ä¸Šé¢çš„ API è¯´æ˜ï¼Œç›¸ä¿¡ä½ ä¼šæŸ³æš—èŠ±æ˜äº† è®¡æ•°å’Œç´¯åŠ å…ˆæ¥çœ‹ä¸€ä¸ªç»å…¸çš„é—®é¢˜ï¼Œç»™å®šçš„æ•°å­—é›†åˆï¼Œéœ€è¦æ˜ å°„æ•´æ•°æµä¸­çš„å…ƒç´ æ•°é‡å’Œå®ƒä»¬çš„å’Œ 12345678910111213141516class CountSum &#123; private final Long count; private final Integer sum; public CountSum(Long count, Integer sum) &#123; this.count = count; this.sum = sum; &#125; @Override public String toString() &#123; return \"CountSum&#123;\" + \"count=\" + count + \", sum=\" + sum + '&#125;'; &#125;&#125; é€šè¿‡ Collectors.teeing å¤„ç† 1234567CountSum countsum = Stream.of(2, 11, 1, 5, 7, 8, 12) .collect(Collectors.teeing( counting(), summingInt(e -&gt; e), CountSum::new));System.out.println(countsum.toString()); downstream1 é€šè¿‡ Collectors çš„é™æ€æ–¹æ³• counting è¿›è¡Œé›†åˆè®¡æ•° downstream2 é€šè¿‡ Collectors çš„é™æ€æ–¹æ³• summingInt è¿›è¡Œé›†åˆå…ƒç´ å€¼çš„ç´¯åŠ  merger é€šè¿‡ CountSum æ„é€ å™¨æ”¶é›†ç»“æœ è¿è¡Œç»“æœ: CountSum{count=7, sum=46} æˆ‘ä»¬é€šè¿‡ teeing ä¸€æ¬¡æ€§å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œç»§ç»­å‘ä¸‹çœ‹å…¶ä»–ä¾‹å­: æœ€å¤§å€¼ä¸æœ€å°å€¼é€šè¿‡ç»™å®šçš„é›†åˆï¼Œ ä¸€æ¬¡æ€§è®¡ç®—å‡ºé›†åˆçš„æœ€å¤§å€¼ä¸æœ€å°å€¼ï¼ŒåŒæ ·æ–°å»ºä¸€ä¸ªç±» MinMaxï¼Œå¹¶åˆ›å»ºæ„é€ å™¨ç”¨äº merger æ”¶é›†ç»“æœ 12345678910111213141516class MinMax &#123; private final Integer min; private final Integer max; public MinMax(Integer min, Integer max) &#123; this.min = min; this.max = max; &#125; @Override public String toString() &#123; return \"MinMax&#123;\" + \"min=\" + min + \", max=\" + max + '&#125;'; &#125;&#125; é€šè¿‡ teeing API è®¡ç®—ç»“æœ: 1234567MinMax minmax = Stream.of(2, 11, 1, 5, 7, 8, 12) .collect(Collectors.teeing( minBy(Comparator.naturalOrder()), maxBy(Comparator.naturalOrder()), (Optional&lt;Integer&gt; a, Optional&lt;Integer&gt; b) -&gt; new MinMax(a.orElse(Integer.MIN_VALUE), b.orElse(Integer.MAX_VALUE))));System.out.println(minmax.toString()); downstream1 é€šè¿‡ Collectors çš„é™æ€æ–¹æ³• minByï¼Œé€šè¿‡ Comparator æ¯”è¾ƒå™¨æŒ‰ç…§è‡ªç„¶æ’åºæ‰¾åˆ°æœ€å°å€¼ downstream2 é€šè¿‡ Collectors çš„é™æ€æ–¹æ³• maxByï¼Œé€šè¿‡ Comparator æ¯”è¾ƒå™¨æŒ‰ç…§è‡ªç„¶æ’åºæ‰¾åˆ°æœ€å¤§å€¼ merger é€šè¿‡ MinMax æ„é€ å™¨æ”¶é›†ç»“æœï¼Œåªä¸è¿‡ä¸ºäº†åº”å¯¹ NPEï¼Œå°† BiFunction çš„ä¸¤ä¸ªå…¥å‚ç»è¿‡ Optional å¤„ç† è¿è¡Œç»“æœ: MinMax{min=1, max=12} ä¸ºäº†éªŒè¯ä¸€ä¸‹ Optionalï¼Œæˆ‘ä»¬å°†é›†åˆä¸­æ·»åŠ ä¸€ä¸ª null å…ƒç´ ï¼Œå¹¶ä¿®æ”¹ä¸€ä¸‹æ’åºè§„åˆ™æ¥çœ‹ä¸€ä¸‹æ’åºç»“æœ: 12345MinMax minmax = Stream.of(null, 2, 11, 1, 5, 7, 8, 12) .collect(Collectors.teeing( minBy(Comparator.nullsFirst(Comparator.naturalOrder())), maxBy(Comparator.nullsLast(Comparator.naturalOrder())), (Optional&lt;Integer&gt; a, Optional&lt;Integer&gt; b) -&gt; new MinMax(a.orElse(Integer.MIN_VALUE), b.orElse(Integer.MAX_VALUE)))); downstream1 å¤„ç†è§„åˆ™æ˜¯å°† null æ”¾åœ¨æ’åºçš„æœ€å‰é¢ downstream2 å¤„ç†è§„åˆ™æ˜¯å°† null æ”¾åœ¨æ’åºçš„æœ€åé¢ merger å¤„ç†æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œ optional.orElse æ–¹æ³•ï¼Œåˆ†åˆ«è¾“å‡ºæœ€å°å€¼ä¸æœ€å¤§å€¼ è¿è¡Œç»“æœ: MinMax{min=-2147483648, max=2147483647} ç“œçš„æ€»é‡å’Œå•ä¸ªé‡é‡æ¥ä¸‹æ¥ä¸¾ä¸€ä¸ªæ›´è´´åˆå®é™…çš„æ“ä½œå¯¹è±¡çš„ä¾‹å­ 1234567891011121314151617181920212223242526272829303132333435// å®šä¹‰ç“œçš„ç±»å‹å’Œé‡é‡class Melon &#123; private final String type; private final int weight; public Melon(String type, int weight) &#123; this.type = type; this.weight = weight; &#125; public String getType() &#123; return type; &#125; public int getWeight() &#123; return weight; &#125;&#125;// æ€»é‡å’Œå•ä¸ªé‡é‡åˆ—è¡¨class WeightsAndTotal &#123; private final int totalWeight; private final List&lt;Integer&gt; weights; public WeightsAndTotal(int totalWeight, List&lt;Integer&gt; weights) &#123; this.totalWeight = totalWeight; this.weights = weights; &#125; @Override public String toString() &#123; return \"WeightsAndTotal&#123;\" + \"totalWeight=\" + totalWeight + \", weights=\" + weights + '&#125;'; &#125;&#125; é€šè¿‡ teeing API è®¡ç®—æ€»é‡é‡å’Œå•ä¸ªåˆ—è¡¨é‡é‡ 123456789101112131415List&lt;Melon&gt; melons = Arrays.asList(new Melon(\"Crenshaw\", 1200), new Melon(\"Gac\", 3000), new Melon(\"Hemi\", 2600), new Melon(\"Hemi\", 1600), new Melon(\"Gac\", 1200), new Melon(\"Apollo\", 2600), new Melon(\"Horned\", 1700), new Melon(\"Gac\", 3000), new Melon(\"Hemi\", 2600));WeightsAndTotal weightsAndTotal = melons.stream() .collect(Collectors.teeing( summingInt(Melon::getWeight), mapping(m -&gt; m.getWeight(), toList()), WeightsAndTotal::new));System.out.println(weightsAndTotal.toString()); downstream1 é€šè¿‡ Collectors çš„é™æ€æ–¹æ³• summingInt åšé‡é‡ç´¯åŠ  downstream2 é€šè¿‡ Collectors çš„é™æ€æ–¹æ³• mapping æå–å‡ºç“œçš„é‡é‡ï¼Œå¹¶é€šè¿‡æµçš„ç»ˆç»“æ“ä½œ toList() è·å–ç»“æœ merger é€šè¿‡ WeightsAndTotal æ„é€ å™¨è·å–ç»“æœ è¿è¡Œç»“æœ: WeightsAndTotal{totalWeight=19500, weights=[1200, 3000, 2600, 1600, 1200, 2600, 1700, 3000, 2600]} ç»§ç»­ä¸€ä¸ªæ›´è´´åˆå®é™…çš„ä¾‹å­å§: é¢„çº¦äººå‘˜åˆ—è¡¨å’Œé¢„çº¦äººæ•°12345678910111213141516171819202122232425262728293031323334353637383940class Guest &#123; private String name; private boolean participating; private Integer participantsNumber; public Guest(String name, boolean participating, Integer participantsNumber) &#123; this.name = name; this.participating = participating; this.participantsNumber = participantsNumber; &#125; public boolean isParticipating() &#123; return participating; &#125; public Integer getParticipantsNumber() &#123; return participantsNumber; &#125; public String getName() &#123; return name; &#125;&#125;class EventParticipation &#123; private List&lt;String&gt; guestNameList; private Integer totalNumberOfParticipants; public EventParticipation(List&lt;String&gt; guestNameList, Integer totalNumberOfParticipants) &#123; this.guestNameList = guestNameList; this.totalNumberOfParticipants = totalNumberOfParticipants; &#125; @Override public String toString() &#123; return \"EventParticipation &#123; \" + \"guests = \" + guestNameList + \", total number of participants = \" + totalNumberOfParticipants + \" &#125;\"; &#125;&#125; é€šè¿‡ teeing API å¤„ç† 12345678910var result = Stream.of( new Guest(\"Marco\", true, 3), new Guest(\"David\", false, 2), new Guest(\"Roger\",true, 6)) .collect(Collectors.teeing( Collectors.filtering(Guest::isParticipating, Collectors.mapping(Guest::getName, Collectors.toList())), Collectors.summingInt(Guest::getParticipantsNumber), EventParticipation::new ));System.out.println(result); downstream1 é€šè¿‡ filtering æ–¹æ³•è¿‡æ»¤å‡ºç¡®å®šå‚åŠ çš„äººï¼Œå¹¶ mapping å‡ºä»–ä»¬çš„å§“åï¼Œæœ€ç»ˆæ”¾åˆ° toList é›†åˆä¸­ downstream2 é€šè¿‡ summingInt æ–¹æ³•è®¡æ•°ç´¯åŠ  merger é€šè¿‡ EventParticipation æ„é€ å™¨æ”¶é›†ç»“æœ å…¶ä¸­æˆ‘ä»¬å®šä¹‰äº† var result æ¥æ”¶é›†ç»“æœï¼Œå¹¶æ²¡æœ‰æŒ‡å®šç±»å‹ï¼Œè¿™ä¸ªè¯­æ³•ç³–ä¹ŸåŠ é€Ÿäº†æˆ‘ä»¬ç¼–ç¨‹çš„æ•ˆç‡ è¿è¡Œç»“æœ: EventParticipation { guests = [Marco, Roger], total number of participants = 11 } æ€»ç»“å…¶å® teeing API å°±æ˜¯çµæ´»åº”ç”¨ Collectors é‡Œé¢å®šä¹‰çš„é™æ€æ–¹æ³•ï¼Œå°†é›†åˆå…ƒç´ é€šè¿‡ downstream1 å’Œ downstream2 è¿›è¡Œå¤„ç†ï¼Œæœ€ç»ˆé€šè¿‡ merger æ”¶é›†èµ·æ¥ï¼Œå½“é¡¹ç›®ä¸­æœ‰åŒæ—¶è·å–ä¸¤ä¸ªæ”¶é›†ç»“æœæ—¶ï¼Œæ˜¯æ—¶å€™åº”ç”¨æˆ‘ä»¬çš„ teeing API äº† çµé­‚è¿½é—® Collectors é‡Œé¢çš„é™æ€æ–¹æ³•ä½ åº”ç”¨çš„ç†Ÿç»ƒå—ï¼Ÿ é¡¹ç›®ä¸­ä½ ä»¬åœ¨ç”¨ JDK çš„ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ Lambda çš„ä½¿ç”¨ç†Ÿç»ƒå—ï¼Ÿ ä½ çš„ç¯è¿˜äº®ç€å—ï¼Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://dayarch.top/tags/Java/"},{"name":"JDKæºç ","slug":"JDKæºç ","permalink":"https://dayarch.top/tags/JDK%E6%BA%90%E7%A0%81/"}]},{"title":"Javaå¹¶å‘æ­»é”è§£å†³æ€è·¯","slug":"Javaå¹¶å‘æ­»é”è§£å†³æ€è·¯","date":"2019-10-18T06:01:20.000Z","updated":"2019-12-31T03:09:05.244Z","comments":true,"path":"/p/java-concurrency-dead-lock.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-dead-lock.html","excerpt":"å†™åœ¨å‰é¢ ä¸Šä¸€ç¯‡æ–‡ç« å…±äº«èµ„æºé‚£ä¹ˆå¤šï¼Œå¦‚ä½•ç”¨ä¸€æŠŠé”ä¿æŠ¤å¤šä¸ªèµ„æºï¼Ÿ æ–‡ç« æˆ‘ä»¬è°ˆåˆ°äº†é“¶è¡Œè½¬è´¦ç»å…¸æ¡ˆä¾‹ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªé—®é¢˜: 1. å•çº¯çš„ç”¨ synchronized æ–¹æ³•èµ·ä¸åˆ°ä¿æŠ¤ä½œç”¨(ä¸èƒ½ä¿æŠ¤ target) 2. ç”¨ Account.class é”æ–¹æ¡ˆï¼Œé”çš„ç²’åº¦åˆè¿‡å¤§ï¼Œå¯¼è‡´æ¶‰åŠåˆ°è´¦æˆ·çš„æ‰€æœ‰æ“ä½œ(å–æ¬¾ï¼Œè½¬è´¦ï¼Œä¿®æ”¹å¯†ç ç­‰)éƒ½ä¼šå˜æˆä¸²è¡Œæ“ä½œ å¦‚ä½•è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜å‘¢ï¼Ÿå’±ä»¬å…ˆæ¢å¥½è¡£æœç©¿è¶Šå›åˆ°è¿‡å»å¯»æ‰¾ä¸€ä¸‹é’±åº„ï¼Œä¸€èµ·é€è¿‡ç°è±¡çœ‹æœ¬è´¨ï¼Œdengdeng dengâ€¦â€¦. æ¥åˆ°é’±åº„ï¼Œå‘Šè¯‰æŸœå‘˜ä½ è¦ç»™é“è›‹å„¿è½¬ 100 é“œé’±ï¼Œè¿™æ—¶æŸœå‘˜è½¬èº«åœ¨å¢™ä¸Šå¯»æ‰¾ä½ å’Œé“è›‹å„¿çš„è´¦æœ¬ï¼Œæ­¤æ—¶æŸœå‘˜å¯èƒ½é¢ä¸´ä¸‰ç§æƒ…å†µ: 1. ç†æƒ³çŠ¶æ€:","text":"å†™åœ¨å‰é¢ä¸Šä¸€ç¯‡æ–‡ç« å…±äº«èµ„æºé‚£ä¹ˆå¤šï¼Œå¦‚ä½•ç”¨ä¸€æŠŠé”ä¿æŠ¤å¤šä¸ªèµ„æºï¼Ÿ æ–‡ç« æˆ‘ä»¬è°ˆåˆ°äº†é“¶è¡Œè½¬è´¦ç»å…¸æ¡ˆä¾‹ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªé—®é¢˜: å•çº¯çš„ç”¨ synchronized æ–¹æ³•èµ·ä¸åˆ°ä¿æŠ¤ä½œç”¨(ä¸èƒ½ä¿æŠ¤ target) ç”¨ Account.class é”æ–¹æ¡ˆï¼Œé”çš„ç²’åº¦åˆè¿‡å¤§ï¼Œå¯¼è‡´æ¶‰åŠåˆ°è´¦æˆ·çš„æ‰€æœ‰æ“ä½œ(å–æ¬¾ï¼Œè½¬è´¦ï¼Œä¿®æ”¹å¯†ç ç­‰)éƒ½ä¼šå˜æˆä¸²è¡Œæ“ä½œ å¦‚ä½•è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜å‘¢ï¼Ÿå’±ä»¬å…ˆæ¢å¥½è¡£æœç©¿è¶Šå›åˆ°è¿‡å»å¯»æ‰¾ä¸€ä¸‹é’±åº„ï¼Œä¸€èµ·é€è¿‡ç°è±¡çœ‹æœ¬è´¨ï¼Œdengdeng dengâ€¦â€¦. æ¥åˆ°é’±åº„ï¼Œå‘Šè¯‰æŸœå‘˜ä½ è¦ç»™é“è›‹å„¿è½¬ 100 é“œé’±ï¼Œè¿™æ—¶æŸœå‘˜è½¬èº«åœ¨å¢™ä¸Šå¯»æ‰¾ä½ å’Œé“è›‹å„¿çš„è´¦æœ¬ï¼Œæ­¤æ—¶æŸœå‘˜å¯èƒ½é¢ä¸´ä¸‰ç§æƒ…å†µ: ç†æƒ³çŠ¶æ€: ä½ å’Œé“è›‹å„¿çš„è´¦æœ¬éƒ½æ˜¯ç©ºé—²çŠ¶æ€ï¼Œä¸€èµ·æ‹¿å›æ¥ï¼Œåœ¨ä½ çš„è´¦æœ¬ä¸Šå‡ 100 é“œé’±ï¼Œåœ¨é“è›‹å„¿è´¦æœ¬ä¸ŠåŠ  100 é“œé’±ï¼ŒæŸœå‘˜è½¬èº«å°†è´¦æœ¬æŒ‚å›åˆ°å¢™ä¸Šï¼Œå®Œæˆä½ çš„ä¸šåŠ¡ å°´å°¬çŠ¶æ€: ä½ çš„è´¦æœ¬åœ¨ï¼Œé“è›‹å„¿çš„è´¦æœ¬è¢«å…¶ä»–æŸœå‘˜æ‹¿å‡ºå»ç»™åˆ«äººè½¬è´¦ï¼Œä½ è¦ç­‰å¾…å…¶ä»–æŸœå‘˜æŠŠé“è›‹å„¿çš„è´¦æœ¬å½’è¿˜ æŠ“ç‹‚çŠ¶æ€: ä½ çš„è´¦æœ¬ä¸åœ¨ï¼Œé“è›‹å„¿çš„è´¦æœ¬ä¹Ÿä¸åœ¨ï¼Œä½ åªèƒ½ç­‰å¾…ä¸¤ä¸ªè´¦æœ¬éƒ½å½’è¿˜ æ”¾æ…¢æŸœå‘˜çš„å–è´¦æœ¬æ“ä½œï¼Œä»–ä¸€å®šæ˜¯å…ˆæ‹¿åˆ°ä½ çš„è´¦æœ¬ï¼Œç„¶åå†å»æ‹¿é“è›‹å„¿çš„è´¦æœ¬ï¼Œä¸¤ä¸ªè´¦æœ¬éƒ½æ‹¿åˆ°(ç†æƒ³çŠ¶æ€)ä¹‹åæ‰èƒ½å®Œæˆè½¬è´¦ï¼Œç”¨ç¨‹åºæ¨¡å‹æ¥æè¿°ä¸€ä¸‹è¿™ä¸ªæ‹¿å–è´¦æœ¬çš„è¿‡ç¨‹: æˆ‘ä»¬ç»§ç»­ç”¨ç¨‹åºä»£ç æè¿°ä¸€ä¸‹ä¸Šé¢è¿™ä¸ªæ¨¡å‹: 12345678910111213141516class Account &#123; private int balance; // è½¬è´¦ void transfer(Account target, int amt)&#123; // é”å®šè½¬å‡ºè´¦æˆ· synchronized(this) &#123; // é”å®šè½¬å…¥è´¦æˆ· synchronized(target) &#123; if (this.balance &gt; amt) &#123; this.balance -= amt; target.balance += amt; &#125; &#125; &#125; &#125; &#125; è¿™ä¸ªè§£å†³æ–¹æ¡ˆçœ‹èµ·æ¥å¾ˆå®Œç¾ï¼Œè§£å†³äº†æ–‡ç« å¼€å¤´è¯´çš„ä¸¤ä¸ªé—®é¢˜ï¼Œä½†çœŸæ˜¯è¿™æ ·å—ï¼Ÿ æˆ‘ä»¬åˆšåˆšè¯´è¿‡çš„ç†æƒ³çŠ¶æ€æ˜¯é’±åº„åªæœ‰ä¸€ä¸ªæŸœå‘˜(æ—¢å•çº¿ç¨‹)ã€‚éšç€é’±åº„è§„æ¨¡å˜å¤§ï¼Œå¢™ä¸Šæ—©å·²æŒ‚äº†éå¸¸å¤šä¸ªè´¦æœ¬ï¼Œé’±åº„ä¸ºäº†åº”å¯¹ç¹å¿™çš„ä¸šåŠ¡ï¼Œå¼€é€šäº†å¤šä¸ªçª—å£ï¼Œæ­¤æ—¶æœ‰å¤šä¸ªæŸœå‘˜(å¤šçº¿ç¨‹)å¤„ç†é’±åº„ä¸šåŠ¡ã€‚ æŸœå‘˜ 1 æ­£åœ¨åŠç†ç»™é“è›‹å„¿è½¬è´¦çš„ä¸šåŠ¡ï¼Œä½†åªæ‹¿åˆ°äº†ä½ çš„è´¦æœ¬ï¼›æŸœå‘˜ 2 æ­£åœ¨åŠç†é“è›‹å„¿ç»™ä½ è½¬è´¦çš„ä¸šåŠ¡ï¼Œä½†åªæ‹¿åˆ°äº†é“è›‹å„¿çš„è´¦æœ¬ï¼Œæ­¤æ—¶åŒæ–¹å‡ºç°äº†å°´å°¬çŠ¶æ€ï¼Œä¸¤ä½æŸœå‘˜éƒ½åœ¨ç­‰å¾…å¯¹æ–¹å½’è¿˜è´¦æœ¬ä¸ºå½“å‰å®¢æˆ·åŠç†è½¬è´¦ä¸šåŠ¡ã€‚ ç°å®ä¸­æŸœå‘˜ä¼šæ²Ÿé€šï¼Œå–Šå‡ºä¸€å—“å­ è€é“ï¼Œé“è›‹å„¿çš„è´¦æœ¬å…ˆç»™æˆ‘ç”¨ä¸€ä¸‹ï¼Œç”¨å®Œè¿˜ç»™ä½ ï¼Œä½†ç¨‹åºå´æ²¡è¿™ä¹ˆæ™ºèƒ½ï¼Œsynchronized å†…ç½®é”éå¸¸æ‰§ç€ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ã€Œæ­»ç­‰ã€çš„é“ç†ï¼Œæœ€ç»ˆå‡ºç°æ­»é” Java æœ‰äº† synchronized å†…ç½®é”ï¼Œè¿˜å‘æ˜äº†æ˜¾ç¤ºé” Lockï¼Œæ˜¯ä¸æ˜¯å°±ä¸ºäº†æ²»ä¸€æ²» synchronized ã€Œæ­»ç­‰ã€çš„æ‰§ç€å‘¢ï¼ŸğŸ˜ è§£å†³æ–¹æ¡ˆå¦‚ä½•è§£å†³ä¸Šé¢çš„é—®é¢˜å‘¢ï¼Ÿæ­£æ‰€è°“çŸ¥å·±çŸ¥å½¼æ–¹èƒ½ç™¾æˆ˜ä¸æ®†ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£ä»€ä¹ˆæƒ…å†µä¼šå‘ç”Ÿæ­»é”ï¼Œæ‰èƒ½çŸ¥é“å¦‚ä½•é¿å…æ­»é”ï¼Œå¾ˆå¹¸è¿æˆ‘ä»¬å¯ä»¥ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šçœ‹å¾…é—®é¢˜ Coffman æ€»ç»“å‡ºäº†å››ä¸ªæ¡ä»¶è¯´æ˜å¯ä»¥å‘ç”Ÿæ­»é”çš„æƒ…å½¢: Coffman æ¡ä»¶äº’æ–¥æ¡ä»¶ï¼šæŒ‡è¿›ç¨‹å¯¹æ‰€åˆ†é…åˆ°çš„èµ„æºè¿›è¡Œæ’å®ƒæ€§ä½¿ç”¨ï¼Œå³åœ¨ä¸€æ®µæ—¶é—´å†…æŸèµ„æºåªç”±ä¸€ä¸ªè¿›ç¨‹å ç”¨ã€‚å¦‚æœæ­¤æ—¶è¿˜æœ‰å…¶å®ƒè¿›ç¨‹è¯·æ±‚èµ„æºï¼Œåˆ™è¯·æ±‚è€…åªèƒ½ç­‰å¾…ï¼Œç›´è‡³å æœ‰èµ„æºçš„è¿›ç¨‹ç”¨æ¯•é‡Šæ”¾ã€‚ è¯·æ±‚å’Œä¿æŒæ¡ä»¶ï¼šæŒ‡è¿›ç¨‹å·²ç»ä¿æŒè‡³å°‘ä¸€ä¸ªèµ„æºï¼Œä½†åˆæå‡ºäº†æ–°çš„èµ„æºè¯·æ±‚ï¼Œè€Œè¯¥èµ„æºå·²è¢«å…¶å®ƒè¿›ç¨‹å æœ‰ï¼Œæ­¤æ—¶è¯·æ±‚è¿›ç¨‹é˜»å¡ï¼Œä½†åˆå¯¹è‡ªå·±å·²è·å¾—çš„å…¶å®ƒèµ„æºä¿æŒä¸æ”¾ã€‚ ä¸å¯å‰¥å¤ºæ¡ä»¶ï¼šæŒ‡è¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½è¢«å‰¥å¤ºï¼Œåªèƒ½åœ¨ä½¿ç”¨å®Œæ—¶ç”±è‡ªå·±é‡Šæ”¾ã€‚ ç¯è·¯ç­‰å¾…æ¡ä»¶ï¼šæŒ‡åœ¨å‘ç”Ÿæ­»é”æ—¶ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªè¿›ç¨‹â€”â€”èµ„æºçš„ç¯å½¢é“¾ï¼Œå³è¿›ç¨‹é›†åˆ{P1ï¼ŒP2ï¼ŒÂ·Â·Â·ï¼ŒPn}ä¸­çš„ P1 æ­£åœ¨ç­‰å¾…ä¸€ä¸ª P2 å ç”¨çš„èµ„æºï¼›P2 æ­£åœ¨ç­‰å¾… P3 å ç”¨çš„èµ„æºï¼Œâ€¦â€¦ï¼ŒPn æ­£åœ¨ç­‰å¾…å·²è¢« P0 å ç”¨çš„èµ„æºã€‚ è¿™å‡ ä¸ªæ¡ä»¶å¾ˆå¥½ç†è§£ï¼Œå…¶ä¸­ã€Œäº’æ–¥æ¡ä»¶ã€æ˜¯å¹¶å‘ç¼–ç¨‹çš„æ ¹åŸºï¼Œè¿™ä¸ªæ¡ä»¶æ²¡åŠæ³•æ”¹å˜ã€‚ä½†å…¶ä»–ä¸‰ä¸ªæ¡ä»¶éƒ½æœ‰æ”¹å˜çš„å¯èƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´ç ´åå¦å¤–ä¸‰ä¸ªæ¡ä»¶å°±ä¸ä¼šå‡ºç°ä¸Šé¢è¯´åˆ°çš„æ­»é”é—®é¢˜ ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶æ¯ä¸ªæŸœå‘˜éƒ½å¯ä»¥å–æ”¾è´¦æœ¬ï¼Œå¾ˆå®¹æ˜“å‡ºç°äº’ç›¸ç­‰å¾…çš„æƒ…å†µã€‚è¦æƒ³ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶ï¼Œå°±è¦ä¸€æ¬¡æ€§æ‹¿åˆ°æ‰€æœ‰èµ„æºã€‚ ä½œä¸ºç¨‹åºçŒ¿ä½ ä¸€å®šå¬è¿‡è¿™å¥è¯: ä»»ä½•è½¯ä»¶å·¥ç¨‹é‡åˆ°çš„é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¢åŠ ä¸€ä¸ªä¸­é—´å±‚æ¥è§£å†³ æˆ‘ä»¬ä¸å…è®¸æŸœå‘˜éƒ½å¯ä»¥å–æ”¾è´¦æœ¬ï¼Œè´¦æœ¬è¦ç”±å•ç‹¬çš„è´¦æœ¬ç®¡ç†å‘˜æ¥ç®¡ç† ä¹Ÿå°±æ˜¯è¯´è´¦æœ¬ç®¡ç†å‘˜æ‹¿å–è´¦æœ¬æ˜¯ä¸´ç•ŒåŒºï¼Œå¦‚æœåªæ‹¿åˆ°å…¶ä¸­ä¹‹ä¸€çš„è´¦æœ¬ï¼Œé‚£ä¹ˆä¸ä¼šç»™æŸœå‘˜ï¼Œè€Œæ˜¯ç­‰å¾…æŸœå‘˜ä¸‹ä¸€æ¬¡è¯¢é—®æ˜¯å¦ä¸¤ä¸ªè´¦æœ¬éƒ½åœ¨ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class Account &#123; //å•ä¾‹çš„è´¦æœ¬ç®¡ç†å‘˜ private AccountBookManager accountBookManager; private int balance; public void transfer(Account target, int amt)&#123; // ä¸€æ¬¡æ€§ç”³è¯·è½¬å‡ºè´¦æˆ·å’Œè½¬å…¥è´¦æˆ·ï¼Œç›´åˆ°æˆåŠŸ while(accountBookManager.getAllRequiredAccountBook(this, target)); try&#123; // é”å®šè½¬å‡ºè´¦æˆ· synchronized(this)&#123; // é”å®šè½¬å…¥è´¦æˆ· synchronized(target)&#123; if (this.balance &gt; amt)&#123; this.balance -= amt; target.balance += amt; &#125; &#125; &#125; &#125; finally &#123; accountBookManager.releaseObtainedAccountBook(this, target); &#125; &#125;&#125;public class AccountBookManager &#123; List&lt;Object&gt; accounts = new ArrayList&lt;&gt;(2); synchronized boolean getAllRequiredAccountBook( Object from, Object to)&#123; if(accounts.contains(from) || accounts.contains(to))&#123; return false; &#125; else&#123; accounts.add(from); accounts.add(to); return true; &#125; &#125; // å½’è¿˜èµ„æº synchronized void releaseObtainedAccountBook(Object from, Object to)&#123; accounts.remove(from); accounts.remove(to); &#125;&#125; ç ´åä¸å¯å‰¥å¤ºæ¡ä»¶ä¸Šé¢å·²ç»ç»™äº†ä½ å°å°çš„æç¤ºï¼Œä¸ºäº†è§£å†³å†…ç½®é”çš„æ‰§ç€ï¼ŒJava æ˜¾ç¤ºé”æ”¯æŒé€šçŸ¥(notify/notifyall)å’Œç­‰å¾…(wait)ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥åŠŸèƒ½å¯ä»¥å®ç°å–Šä¸€å—“å­ è€é“ï¼Œé“è›‹å„¿çš„è´¦æœ¬å…ˆç»™æˆ‘ç”¨ä¸€ä¸‹ï¼Œç”¨å®Œè¿˜ç»™ä½  çš„åŠŸèƒ½ï¼Œè¿™ä¸ªåç»­å°†åˆ° Java SDK ç›¸å…³å†…å®¹æ—¶ä¼šåšè¯´æ˜ ç ´åç¯è·¯ç­‰å¾…æ¡ä»¶ç ´åç¯è·¯ç­‰å¾…æ¡ä»¶ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å°†èµ„æºåºå·å¤§å°æ’åºè·å–å°±ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°†ç¯è·¯æ‹†é™¤ ç»§ç»­ç”¨ä»£ç æ¥è¯´æ˜: 123456789101112131415161718192021222324class Account &#123; private int id; private int balance; // è½¬è´¦ void transfer(Account target, int amt)&#123; Account smaller = this Account larger = target; // æ’åº if (this.id &gt; target.id) &#123; smaller = target; larger = this; &#125; // é”å®šåºå·å°çš„è´¦æˆ· synchronized(smaller)&#123; // é”å®šåºå·å¤§çš„è´¦æˆ· synchronized(larger)&#123; if (this.balance &gt; amt)&#123; this.balance -= amt; target.balance += amt; &#125; &#125; &#125; &#125; &#125; å½“ smaller è¢«å ç”¨æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å°±ä¼šè¢«é˜»å¡ï¼Œä¹Ÿå°±ä¸ä¼šå­˜åœ¨æ­»é”äº†. é™„åŠ è¯´æ˜åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œå…³äº Account éƒ½ä¼šæ˜¯æ•°æ®åº“å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äº‹åŠ¡æˆ–æ•°æ®åº“çš„ä¹è§‚é”æ¥è§£å†³çš„ã€‚å¦å¤–åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œè´¦æœ¬ç®¡ç†å‘˜è¿™ä¸ªè§’è‰²çš„å¤„ç†ä¹Ÿå¯èƒ½ä¼šç”¨ redis åˆ†å¸ƒå¼é”æ¥è§£å†³. åœ¨å¤„ç†ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ while å¾ªç¯æ–¹å¼æ¥ä¸æ–­è¯·æ±‚é”çš„æ—¶å€™ï¼Œåœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œæˆ‘ä»¬ä¼šæœ‰ timeout çš„è®¾ç½®ï¼Œé˜²æ­¢æ— ä¼‘æ­¢çš„æµªè´¹ CPU ä½¿ç”¨ç‡ å¦å¤–å¤§å®¶å¯ä»¥å°è¯•ä½¿ç”¨é˜¿é‡Œå¼€æºå·¥å…· Arthas æ¥æŸ¥çœ‹ CPU ä½¿ç”¨ç‡ï¼Œçº¿ç¨‹ç­‰ç›¸å…³é—®é¢˜ï¼Œgithub ä¸Šæœ‰æ˜ç¡®çš„è¯´æ˜ æ€»ç»“è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›è¿œè¿œè¶…è¿‡äººç±»ï¼Œä½†æ˜¯ä»–çš„æ™ºæ…§è¿˜éœ€è¦æœ‰å¸¦æé«˜ï¼Œå½“çœ‹å¾…å¹¶å‘é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¾€å¾€è®¤ä¸ºäººç±»çš„æœ€åŸºæœ¬æ²Ÿé€šè®¡ç®—æœºä¹Ÿå¯ä»¥åšåˆ°ï¼Œå…¶å®ä¸ç„¶ï¼Œè¿˜æ˜¯é‚£å¥è¯ï¼Œç¼–å†™å¹¶å‘ç¨‹åºï¼Œè¦ç«™åœ¨è®¡ç®—æœºçš„è§’åº¦æ¥çœ‹å¾…é—®é¢˜ ç²—ç²’åº¦é”æˆ‘ä»¬ä¸æå€¡ï¼Œæ‰€ä»¥ä¼šä½¿ç”¨ç»†ç²’åº¦é”ï¼Œä½†ä½¿ç”¨ç»†ç²’åº¦é”çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦ä¸¥æ ¼æŒ‰ç…§ Coffman çš„å››å¤§æ¡ä»¶æ¥é€æ¡åˆ¤æ–­ï¼Œè¿™æ ·å†åº”ç”¨æˆ‘ä»¬è¿™å‡ ä¸ªè§£å†³æ–¹æ¡ˆæ¥è§£å†³å°±å¥½äº† çµé­‚è¿½é—® ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶æ—¶ï¼Œå¤„ç†èƒ½åŠ›çš„ç“¶é¢ˆåœ¨è´¦æœ¬ç®¡ç†å‘˜é‚£é‡Œï¼Œé‚£ä½ è§‰å¾—è¿™ç§å¤„ç†æ–¹å¼ä¼šæé«˜å¹¶å‘é‡å—ï¼Ÿ ç ´åè¯·æ±‚ä¿æŒæ¡ä»¶çš„æ–¹æ³•å’Œç ´åç¯è·¯ç­‰å¾…çš„æ–¹æ³•ï¼Œä½ è§‰å¾—é‚£ç§æ–¹å¼æ›´å¥½ ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶æ—¶ï¼Œå¦‚æœä»£ç æ¢æˆä¸‹é¢çš„æ ·å­ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ 12345678910111213141516171819public void transfer(Account target, int amt)&#123; // ä¸€æ¬¡æ€§ç”³è¯·è½¬å‡ºè´¦æˆ·å’Œè½¬å…¥è´¦æˆ·ï¼Œç›´åˆ°æˆåŠŸ while(accountBookManager.getAllRequiredAccountBook(this, target))&#123;&#125; try&#123; // é”å®šè½¬å‡ºè´¦æˆ· synchronized(this)&#123; // é”å®šè½¬å…¥è´¦æˆ· synchronized(target)&#123; if (this.balance &gt; amt)&#123; this.balance -= amt; target.balance += amt; &#125; &#125; &#125; &#125; finally &#123; accountBookManager.releaseObtainedAccountBook(this, target); &#125; &#125;&#125; æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® å¹¶å‘Bugä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£ é¢è¯•å¹¶å‘volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"æ­»é”","slug":"æ­»é”","permalink":"https://dayarch.top/tags/%E6%AD%BB%E9%94%81/"},{"name":"é”ç²’åº¦","slug":"é”ç²’åº¦","permalink":"https://dayarch.top/tags/%E9%94%81%E7%B2%92%E5%BA%A6/"}]},{"title":"Spring Boot è‡ªå®šä¹‰starter å…¨é¢æ•™ç¨‹","slug":"Spring-Boot-è‡ªå®šä¹‰starter-å…¨é¢æ•™ç¨‹","date":"2019-10-15T11:35:53.000Z","updated":"2019-11-07T06:24:19.750Z","comments":true,"path":"/p/spring-boot-starter-custom.html","link":"","permalink":"https://dayarch.top/p/spring-boot-starter-custom.html","excerpt":"å†™åœ¨å‰é¢ æˆ‘ä»¬æ¯æ¬¡æ„å»ºä¸€ä¸ª Spring åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬éƒ½ä¸å¸Œæœ›ä»å¤´å¼€å§‹å®ç°å…·æœ‰ã€Œæ¨ªåˆ‡å…³æ³¨ç‚¹ã€çš„å†…å®¹ï¼›ç›¸åï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€æ¬¡æ€§å®ç°è¿™äº›åŠŸèƒ½ï¼Œå¹¶æ ¹æ®éœ€è¦å°†å®ƒä»¬åŒ…å«åˆ°ä»»ä½•æˆ‘ä»¬è¦æ„å»ºçš„åº”ç”¨ç¨‹åºä¸­ æ¨ªåˆ‡å…³æ³¨ç‚¹ æ¨ªåˆ‡å…³æ³¨ç‚¹: æŒ‡çš„æ˜¯ä¸€äº›å…·æœ‰æ¨ªè¶Šå¤šä¸ªæ¨¡å—çš„è¡Œä¸º (æ¥è‡ªç»´åŸºç™¾ç§‘çš„ä»‹ç») è¯´ç™½äº†å°±æ˜¯å¤šä¸ªé¡¹ç›®æˆ–æ¨¡å—éƒ½å¯ä»¥ç”¨åˆ°çš„å†…å®¹ï¼Œæ¯”å¦‚ä¸€ä¸ª SDK åœ¨Spring Bootä¸­ï¼Œç”¨äºè¡¨ç¤ºæä¾›è¿™ç§æ¨ªåˆ‡å…³æ³¨ç‚¹çš„æ¨¡å—çš„æœ¯è¯­æ˜¯ starterï¼Œé€šè¿‡ä¾èµ– starter å¯ä»¥è½»æ¾ä½¿ç”¨å…¶åŒ…å«çš„ä¸€äº›åŠŸèƒ½ç‰¹æ€§ï¼Œæ— è®ºä½ çš„å·¥ä½œä¸­æ˜¯å¦ä¼šæ„å»ºè‡ªå·±çš„ starterï¼Œä½ éƒ½è¦å…·æœ‰æ„å»º ã€Œstarterã€çš„æ€æƒ³ï¼Œæœ¬æ–‡å°†ç»“åˆ Spring","text":"å†™åœ¨å‰é¢æˆ‘ä»¬æ¯æ¬¡æ„å»ºä¸€ä¸ª Spring åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬éƒ½ä¸å¸Œæœ›ä»å¤´å¼€å§‹å®ç°å…·æœ‰ã€Œæ¨ªåˆ‡å…³æ³¨ç‚¹ã€çš„å†…å®¹ï¼›ç›¸åï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€æ¬¡æ€§å®ç°è¿™äº›åŠŸèƒ½ï¼Œå¹¶æ ¹æ®éœ€è¦å°†å®ƒä»¬åŒ…å«åˆ°ä»»ä½•æˆ‘ä»¬è¦æ„å»ºçš„åº”ç”¨ç¨‹åºä¸­ æ¨ªåˆ‡å…³æ³¨ç‚¹ æ¨ªåˆ‡å…³æ³¨ç‚¹: æŒ‡çš„æ˜¯ä¸€äº›å…·æœ‰æ¨ªè¶Šå¤šä¸ªæ¨¡å—çš„è¡Œä¸º (æ¥è‡ªç»´åŸºç™¾ç§‘çš„ä»‹ç») è¯´ç™½äº†å°±æ˜¯å¤šä¸ªé¡¹ç›®æˆ–æ¨¡å—éƒ½å¯ä»¥ç”¨åˆ°çš„å†…å®¹ï¼Œæ¯”å¦‚ä¸€ä¸ª SDK åœ¨Spring Bootä¸­ï¼Œç”¨äºè¡¨ç¤ºæä¾›è¿™ç§æ¨ªåˆ‡å…³æ³¨ç‚¹çš„æ¨¡å—çš„æœ¯è¯­æ˜¯ starterï¼Œé€šè¿‡ä¾èµ– starter å¯ä»¥è½»æ¾ä½¿ç”¨å…¶åŒ…å«çš„ä¸€äº›åŠŸèƒ½ç‰¹æ€§ï¼Œæ— è®ºä½ çš„å·¥ä½œä¸­æ˜¯å¦ä¼šæ„å»ºè‡ªå·±çš„ starterï¼Œä½ éƒ½è¦å…·æœ‰æ„å»º ã€Œstarterã€çš„æ€æƒ³ï¼Œæœ¬æ–‡å°†ç»“åˆ Spring Boot å®˜æ–¹æ ‡å‡†æ„å»ºä¸€ä¸ªç®€å•çš„ starter è‡ªå®šä¹‰ starteråœ¨æˆ‘ä»¬æ·±å…¥äº†è§£å¦‚ä½•è‡ªå®šä¹‰ starter ä¹‹å‰ï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£æˆ‘ä»¬æ¯ä¸€æ­¥åœ¨å¹²ä»€ä¹ˆï¼Œä»¥åŠ starter æ˜¯å¦‚ä½•èµ·ä½œç”¨çš„ï¼Œæˆ‘ä»¬å…ˆä»å®è§‚è§’åº¦æ¥çœ‹ starter çš„ç»“æ„ç»„æˆåˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„ é€šå¸¸ä¸€ä¸ªå®Œæ•´çš„ starter éœ€è¦åŒ…å«ä¸‹é¢ä¸¤ä¸ªç»„ä»¶: Auto-Configure Module Starter Module å¦‚æœä½ çœ‹ä¸‹é¢è¿™ä¸¤ä¸ªç»„ä»¶çš„è§£é‡Šæœ‰äº›æŠ½è±¡ï¼Œå¤§æ¦‚äº†è§£ä¸€ä¸‹ï¼Œé˜…è¯»å®Œè¯¥æ–‡ç« å›çœ‹è¿™é‡Œå°±ä¼šè±ç„¶å¼€æœ—äº† Auto-Configure ModuleAuto-Configure Module (è‡ªåŠ¨é…ç½®æ¨¡å—) æ˜¯åŒ…å«è‡ªåŠ¨é…ç½®ç±»çš„ Maven æˆ– Gradle æ¨¡å—ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå¯ä»¥è‡ªåŠ¨è´¡çŒ®äºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„æ¨¡å—ï¼Œä»¥åŠæ·»åŠ æŸä¸ªç‰¹æ€§æˆ–æä¾›å¯¹æŸä¸ªå¤–éƒ¨åº“çš„è®¿é—® Starter ModuleSpring Boot Starter æ˜¯ä¸€ä¸ª Maven æˆ– Gradle æ¨¡å—ï¼Œå…¶å”¯ä¸€ç›®çš„æ˜¯æä¾› â€œå¯åŠ¨â€ æŸä¸ªç‰¹æ€§æ‰€éœ€çš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª Auto-Configure Module (è‡ªåŠ¨é…ç½®æ¨¡å—)çš„ä¾èµ–é¡¹ï¼Œä»¥åŠå¯èƒ½éœ€è¦çš„ä»»ä½•å…¶ä»–ä¾èµ–é¡¹ã€‚è¿™æ ·ï¼Œåœ¨Spring å¯åŠ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ è¿™ä¸ª starter ä¾èµ–å°±å¯ä»¥ä½¿ç”¨å…¶ç‰¹æ€§ âš ï¸: Spring å®˜æ–¹å‚è€ƒæ‰‹å†Œå»ºè®®å°†è‡ªåŠ¨é…ç½®åˆ†ç¦»ï¼Œå¹¶å°†æ¯ä¸ªè‡ªåŠ¨é…ç½®å¯åŠ¨åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ Maven æˆ– Gradle æ¨¡å—ä¸­ï¼Œä»è€Œå°†è‡ªåŠ¨é…ç½®å’Œä¾èµ–é¡¹ç®¡ç†åˆ†ç¦»å¼€æ¥ã€‚å¦‚æœä½ æ²¡æœ‰å»ºç«‹ä¸€ä¸ªä¾›æˆåƒä¸Šä¸‡ç”¨æˆ·ä½¿ç”¨çš„å¼€æºåº“ï¼Œä¹Ÿå¯ä»¥å°†äºŒè€…åˆå¹¶åˆ°ä¸€ä¸ª module ä¸­ You may combine the auto-configuration code and the dependency management in a single module if you do not need to separate those two concerns å‘½åæ¥è‡ª Spring å®˜æ–¹çš„ starter éƒ½æ˜¯ ä»¥ spring-boot-starter å¼€å¤´ï¼Œæ¯”å¦‚: spring-boot-starter-web spring-boot-starter-aop å¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰ starter åŠŸèƒ½åç§°å«acmeï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å‘½åæ˜¯è¿™æ ·çš„: acme-spring-boot-starter acme-spring-boot-autoconfigure å¦‚æœ starter ä¸­ç”¨åˆ°äº†é…ç½® keysï¼Œä¹Ÿè¦æ³¨æ„ä¸è¦ä½¿ç”¨ Spring Boot ä½¿ç”¨çš„å‘½åç©ºé—´ï¼Œæ¯”å¦‚(serverï¼Œmanagementï¼Œspring) Parent Module åˆ›å»ºå…ˆæ¥å…¨å±€çœ‹ä¸€ä¸‹é¡¹ç›®ç»“æ„:ä¸€çº§ç›®å½•ç»“æ„: 12345.â”œâ”€â”€ pom.xmlâ”œâ”€â”€ rgyb-spring-boot-autoconfigureâ”œâ”€â”€ rgyb-spring-boot-sampleâ””â”€â”€ rgyb-spring-boot-starter äºŒçº§ç›®å½•ç»“æ„: 1234567891011.â”œâ”€â”€ pom.xmlâ”œâ”€â”€ rgyb-spring-boot-autoconfigureâ”‚ â”œâ”€â”€ pom.xmlâ”‚ â””â”€â”€ srcâ”œâ”€â”€ rgyb-spring-boot-sampleâ”‚ â”œâ”€â”€ pom.xmlâ”‚ â””â”€â”€ srcâ””â”€â”€ rgyb-spring-boot-starter â”œâ”€â”€ pom.xml â””â”€â”€ src åˆ›å»ºä¸€ä¸ªç©ºçš„çˆ¶äº² Maven Moduleï¼Œä¸»è¦æä¾›ä¾èµ–ç®¡ç†ï¼Œè¿™æ · SubModule ä¸ç”¨å•ç‹¬ç»´æŠ¤ä¾èµ–ç‰ˆæœ¬å·ï¼Œæ¥çœ‹ pom.xml å†…å®¹: 12345678910111213&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-boot.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;!-- æ·»åŠ å…¶ä»–å…¨å±€ä¾èµ–ç®¡ç†åˆ°è¿™é‡Œï¼Œsubmoduleé»˜è®¤ä¸å¼•å…¥è¿™äº›ä¾èµ–ï¼Œéœ€è¦æ˜¾å¼çš„æŒ‡å®š --&gt;&lt;/dependencyManagement&gt; Auto-Configure Module æ„å»ºæ–°å»ºç±» GreetingAutoConfiguration 12345678@Configurationpublic class GreetingAutoConfiguration &#123; @Bean public GreetingService greetingService(GreetingProperties greetingProperties)&#123; return new GreetingService(greetingProperties.getMembers()); &#125;&#125; æˆ‘ä»¬ç”¨ @Configuration æ³¨è§£æ ‡è®°ç±» GreetingAutoConfigurationï¼Œä½œä¸º starter çš„å…¥å£ç‚¹ã€‚è¿™ä¸ªé…ç½®åŒ…å«äº†æˆ‘ä»¬éœ€è¦æä¾›starterç‰¹æ€§çš„æ‰€æœ‰ @Bean å®šä¹‰ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œä¸ºäº†ç®€å•é˜è¿°é—®é¢˜ï¼Œæˆ‘ä»¬åªå°† GreetingService Bean æ·»åŠ åˆ°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ GreetingService å†…å®¹å¦‚ä¸‹: 123456789@AllArgsConstructorpublic class GreetingService &#123; private List&lt;String&gt; members = new ArrayList&lt;&gt;(); public void sayHello()&#123; members.forEach(s -&gt; System.out.println(\"hello \" + s)); &#125;&#125; åœ¨ resources ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ META-INF/spring.factories (å¦‚æœç›®å½• META-INF ä¸å­˜åœ¨éœ€è¦æ‰‹å·¥åˆ›å»º)ï¼Œå‘æ–‡ä»¶å†™å…¥å†…å®¹: 12org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\ top.dayarch.autoconfigure.GreetingAutoConfiguration Spring å¯åŠ¨æ—¶ä¼šåœ¨å…¶ classpath ä¸­æ‰€æœ‰çš„ spring.factoreis æ–‡ä»¶ï¼Œå¹¶åŠ è½½é‡Œé¢çš„å£°æ˜é…ç½®ï¼ŒGreetingAutoConfiguration ç±»å°±ç»ªåï¼Œæˆ‘ä»¬çš„ Spring Boot Starter å°±æœ‰äº†ä¸€ä¸ªè‡ªåŠ¨æ¿€æ´»çš„å…¥å£ç‚¹ åˆ°è¿™é‡Œè¿™ä¸ª â€œä¸å®Œå…¨çš„ starterâ€ å·²ç»å¯ä»¥ä½¿ç”¨äº†ã€‚ä½†å› ä¸ºå®ƒæ˜¯è‡ªåŠ¨æ¿€æ´»çš„ï¼Œä¸ºäº†ä¸ªè®©å…¶çµæ´»å¯ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è®©å…¶æŒ‰ç…§æˆ‘ä»¬çš„æ„æ„¿æ¥æ¿€æ´»ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ¡ä»¶æ³¨è§£æ¥å¸®å¿™ æ¡ä»¶é…ç½®ä¸ºç±»æ·»åŠ ä¸¤ä¸ªæ¡ä»¶æ³¨è§£: 123456@Configuration@ConditionalOnProperty(value = \"rgyb.greeting.enable\", havingValue = \"true\")@ConditionalOnClass(DummyEmail.class)public class GreetingAutoConfiguration &#123; ...&#125; é€šè¿‡ä½¿ç”¨ @ConditionalOnProperty æ³¨è§£ï¼Œæˆ‘ä»¬å‘Šè¯‰ Springï¼Œåªæœ‰å±æ€§ rgyb.greeting.enable å€¼è¢«è®¾ç½®ä¸º true æ—¶ï¼Œæ‰å°† GreetingAutoConfiguration (ä»¥åŠå®ƒå£°æ˜çš„æ‰€æœ‰ bean ) åŒ…å«åˆ°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­ é€šè¿‡ä½¿ç”¨ @ConditionalOnClass æ³¨è§£ï¼Œæˆ‘ä»¬å‘Šè¯‰Spring åªæœ‰ç±» DummyEmail.class å­˜åœ¨äº classpath æ—¶ï¼Œæ‰å°† GreetingAutoConfiguration (ä»¥åŠå®ƒå£°æ˜çš„æ‰€æœ‰ bean ) åŒ…å«åˆ°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­ å¤šä¸ªæ¡ä»¶æ˜¯ and/ä¸çš„å…³ç³»ï¼Œæ—¢åªæœ‰æ»¡è¶³å…¨éƒ¨æ¡ä»¶æ—¶ï¼Œæ‰ä¼šåŠ è½½ GreetingAutoConfiguration å¦‚æœä½ å¯¹æ¡ä»¶æ³¨è§£çš„ä½¿ç”¨è¿˜ä¸æ˜¯å¾ˆæ˜ç¡®ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« : @Conditionalæ³¨è§£ï¼Œçµæ´»é…ç½® Spring Boot é…ç½®å±æ€§ç®¡ç†ä¸Šé¢ä½¿ç”¨äº† @ConditionalOnProperty æ³¨è§£ï¼Œå®é™… starter ä¸­å¯èƒ½æœ‰éå¸¸å¤šçš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†è¿™äº›å±æ€§é›†ä¸­ç®¡ç†: 1234567891011121314@Data@ConfigurationProperties(prefix = \"rgyb.greeting\")public class GreetingProperties &#123; /** * GreetingProperties å¼€å…³ */ boolean enable = false; /** * éœ€è¦æ‰“æ‹›å‘¼çš„æˆå‘˜åˆ—è¡¨ */ List&lt;String&gt; members = new ArrayList&lt;&gt;();&#125; æˆ‘ä»¬çŸ¥é“è¿™äº›å±æ€§æ˜¯è¦åœ¨ application.yml ä¸­ä½¿ç”¨çš„ï¼Œå½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿™äº›å±æ€§æ—¶ï¼Œä¸ºäº†è®© IDE ç»™å‡ºæ›´å‹å¥½çš„æç¤ºï¼Œæˆ‘ä»¬éœ€è¦åœ¨ pom.xml ä¸­æ·»åŠ ä¾èµ–: 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt; è¿™æ ·å½“æˆ‘ä»¬ mvn compile æ—¶ï¼Œä¼šåœ¨ç”Ÿæˆä¸€ä¸ªåä¸º spring-configuration-metadata.json JSON æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹: ç”Ÿæˆçš„å†…å®¹åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ä¸­ç”¨åˆ°ï¼Œä¸”çœ‹ æå‡å¯åŠ¨æ—¶é—´å¯¹äºç±»è·¯å¾„ä¸Šçš„æ¯ä¸ªè‡ªåŠ¨é…ç½®ç±»ï¼ŒSpring Boot å¿…é¡»è®¡ç®— @Conditionalâ€¦ æ¡ä»¶å€¼ï¼Œç”¨äºå†³å®šæ˜¯å¦åŠ è½½è‡ªåŠ¨é…ç½®åŠå…¶æ‰€éœ€çš„æ‰€æœ‰ç±»ï¼Œæ ¹æ® Spring å¯åŠ¨åº”ç”¨ç¨‹åºä¸­ starter çš„å¤§å°å’Œæ•°é‡ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªéå¸¸æ˜‚è´µçš„æ“ä½œï¼Œå¹¶ä¸”ä¼šå½±å“å¯åŠ¨æ—¶é—´ï¼Œä¸ºäº†æå‡å¯åŠ¨æ—¶é—´ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ pom.xml ä¸­æ·»åŠ å¦å¤–ä¸€ä¸ªä¾èµ–: 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-autoconfigure-processor&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt; è¿™ä¸ªæ³¨è§£ä¼šç”Ÿæˆä¸€ä¸ªåä¸º spring-autoconfigure-metadata.properties Property æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹: è¿™æ ·ï¼ŒSpring Boot åœ¨å¯åŠ¨æœŸé—´è¯»å–è¿™äº›å…ƒæ•°æ®ï¼Œå¯ä»¥è¿‡æ»¤å‡ºä¸æ»¡è¶³æ¡ä»¶çš„é…ç½®ï¼Œè€Œä¸å¿…å®é™…æ£€æŸ¥è¿™äº›ç±»ï¼Œæå‡å¯åŠ¨é€Ÿåº¦ åˆ°è¿™é‡Œå…³äº Auto-Configure Module å°±æ„å»ºå®Œäº†ï¼Œæˆ‘ä»¬éœ€è¦ç»§ç»­å®Œæˆ Starter Module çš„æ„å»º Starter Module æ„å»ºStarter Module çš„æ„å»ºå¾ˆç®€å•äº†ï¼Œä½ å¯ä»¥è®¤ä¸ºå®ƒå°±æ˜¯ä¸€ä¸ªç©º moduleï¼Œé™¤äº†ä¾èµ– Auto-Configure Moduleï¼Œå…¶å”¯ä¸€ä½œç”¨å°±æ˜¯ä¸ºäº†ä½¿ç”¨ starter åŠŸèƒ½ç‰¹æ€§æä¾›æ‰€æœ‰å¿…é¡»ä¾èµ–ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸º starter module çš„ pom.xml æ–‡ä»¶æ·»åŠ å¦‚ä¸‹å†…å®¹: 123456789&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;top.dayarch.learnings&lt;/groupId&gt; &lt;artifactId&gt;rgyb-spring-boot-autoconfigure&lt;/artifactId&gt; &lt;version&gt;1.0.0.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;!-- åœ¨æ­¤å¤„æ·»åŠ å…¶ä»–å¿…è¦ä¾èµ–ï¼Œä¿è¯starterå¯ç”¨ --&gt;&lt;/dependencies&gt; åŒæ ·åœ¨ resources ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ META-INF/spring.providers , å…¶å†…å®¹å¦‚ä¸‹: 1providers: rgyb-spring-boot-autoconfigure è¯¥æ–‡ä»¶ä¸»è¦ä½œç”¨æ˜¯è¯´æ˜ starter module çš„ä¾èµ–ä¿¡æ¯ï¼Œå¤šä¸ªä¾èµ–ä»¥é€—å·åˆ†éš”å°±å¥½ï¼Œè¯¥æ–‡ä»¶ä¸ä¼šå½±å“ starter çš„ä½¿ç”¨ï¼Œå¯æœ‰å¯æ—  Starter Module å°±å¯ä»¥è¿™ä¹ˆç®€å•ï¼Œå°†ä¸¤ä¸ª module åˆ†åˆ« mvn install åˆ°æœ¬åœ° Maven Repositoryï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»º sample module å¼•å…¥è¿™ä¸ª starter ä¾èµ–æ—¶å°±ä¼šä»æœ¬åœ° Maven Repository ä¸­æ‹‰å– åˆ›å»º Sample Moduleæˆ‘ä»¬å¯ä»¥é€šè¿‡ Spring Initializr æ­£å¸¸åˆå§‹åŒ–ä¸€ä¸ª Spring Boot é¡¹ç›® (rgyb-spring-boot-sample)ï¼Œå¼•å…¥æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ starter ä¾èµ–ï¼Œåœ¨ sample pom.xml ä¸­æ·»åŠ ä¾èµ–: 12345&lt;dependency&gt; &lt;groupId&gt;top.dayarch.learnings&lt;/groupId&gt; &lt;artifactId&gt;rgyb-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.0.0.RELEASE&lt;/version&gt;&lt;/dependency&gt; æ¥ä¸‹æ¥é…ç½® application.yml å±æ€§ 123456rgyb: greeting: enable: true members: - æé›· - éŸ©æ¢…æ¢… åœ¨æˆ‘ä»¬é…ç½® YAML çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä¸‹å›¾çš„æç¤ºï¼Œè¿™æ ·ä¼šæ›´å‹å¥½ï¼Œå½“ç„¶ä¸ºäº†è§„èŒƒï¼Œå±æ€§æè¿°æœ€å¥½ä¹Ÿç”¨è‹±æ–‡æè¿°ï¼Œè¿™é‡Œä¸ºäº†è¯´æ˜é—®é¢˜ç”¨äº†ä¸­æ–‡æè¿°: ç¼–å†™æµ‹è¯•ç±»æˆ‘ä»¬ç¼–å†™æµ‹è¯•ç”¨ä¾‹: 1234567@Autowired(required = false)private GreetingService greetingService;@Testpublic void testGreeting() &#123; greetingService.sayHello();&#125; æµ‹è¯•ç»“æœå¦‚ä¸‹: 12hello æé›·hello éŸ©æ¢…æ¢… æ€»ç»“åˆ°è¿™é‡Œå®Œæ•´çš„ starter å¼€å‘å°±ç»“æŸäº†ï¼Œå¸Œæœ›å¤§å®¶äº†è§£å…¶æ„å»ºè¿‡ç¨‹ï¼Œç›®å½•ç»“æ„åŠå‘½åç­‰æ ‡å‡†ï¼Œè¿™æ ·æœ‰ç›¸åº”çš„ä¸šåŠ¡éœ€æ±‚æ—¶éƒ½å¯ä»¥å¼€å‘è‡ªå·±çš„ starter è¢«å…¶ä»–äººåº”ç”¨èµ·æ¥ starter å¼€å‘å¥½äº†ï¼Œåˆ«äººå¯ä»¥æ‰‹åŠ¨æ·»åŠ ä¾èµ–å¼•å…¥ starter çš„ç›¸å…³åŠŸèƒ½ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•åƒ Spring Initializr ä¸€æ ·ï¼Œé€šè¿‡ä¸‹æ¥èœå•é€‰æ‹©æˆ‘ä»¬çš„ starter å‘¢ï¼Œè¿™æ ·ç›´æ¥åˆå§‹åŒ–å¥½æ•´ä¸ªé¡¹ç›®ï¼Œæ¥ä¸‹æ¥çš„æ–‡ç« æˆ‘ä»¬ä¼šæ¨¡ä»¿ Spring Initializr è‡ªå®šä¹‰æˆ‘ä»¬è‡ªçš„ Initializr çŸ¥è¯†ç‚¹è¯´æ˜Dependency optinal ä¸ºä»€ä¹ˆ Auto-Configure Module çš„ dependency éƒ½æ˜¯ optional = true å‘¢ï¼Ÿè¿™æ¶‰åŠåˆ° Maven ä¼ é€’æ€§ä¾èµ–çš„é—®é¢˜ï¼Œè¯¦æƒ…è¯·çœ‹ Maven ä¾èµ–ä¼ é€’æ€§é€å½»ç†è§£ spring.factories Spring Boot æ˜¯å¦‚ä½•åŠ è½½è¿™ä¸ªæ–‡ä»¶å¹¶æ‰¾åˆ°æˆ‘ä»¬çš„é…ç½®ç±»çš„ä¸‹å›¾æ˜¯ Spring Boot åº”ç”¨ç¨‹åºå¯åŠ¨çš„è°ƒç”¨æ ˆçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘æ·»åŠ äº†æ–­ç‚¹: æ‰“å¼€ SpringFactoriesLoader ç±»ï¼Œæ˜ å…¥çœ¼å¸˜çš„å°±æ˜¯è¿™ä¸ªå†…å®¹: è¿™ä¸¤å¼ å›¾åº”è¯¥è¶³å¤Ÿè¯´æ˜é—®é¢˜äº†ï¼Œæ˜¯ SPI çš„ä¸€ç§åŠ è½½æ–¹å¼ï¼Œæ›´ç»†èŠ‚çš„å†…å®¹è¯·å¤§å®¶è‡ªå·±å»å‘ç°å§ å®é™…æ¡ˆä¾‹è¿™é‡Œæ¨èæŸ¥çœ‹ mybatis-spring-boot-starter è¿™ä¸ªé Spring å®˜æ–¹çš„æ¡ˆä¾‹ï¼Œä»ä¸­æˆ‘ä»¬: æ¨¡ä»¿å…¶ç›®å½•ç»“æ„ æ¨¡ä»¿å…¶è®¾è®¡ç†å¿µ æ¨¡ä»¿å…¶ç¼–ç è§„èŒƒ å¦å¤–ï¼Œæœ¬æ–‡çš„æ¡ˆä¾‹æˆ‘å·²ä¸Šä¼ ï¼Œå…¬ä¼—å·å›å¤ã€Œdemoã€ï¼Œæ‰“å¼€é“¾æ¥ï¼ŒæŸ¥çœ‹ customstarter ç›®å½•ä¸‹å†…å®¹å³å¯ çµé­‚è¿½é—® åœ¨ç”Ÿæˆ spring-autoconfigure-metadata.properties æ–‡ä»¶æ—¶ï¼Œä¸ºä»€ä¹ˆ @ConditionalOnProperty çš„å†…å®¹æ²¡æœ‰è¢«å†™è¿›å» å¦‚æœæˆ‘ä»¬è¦å°†ä¾èµ–ä¸Šä¼ è‡³ remote central repositoryï¼Œä½ çŸ¥é“æ€æ ·æ­å»ºè‡ªå·±çš„ maven repository å—ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® å¹¶å‘Bugä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£ é¢è¯•å¹¶å‘volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"},{"name":"Starter","slug":"Starter","permalink":"https://dayarch.top/tags/Starter/"}]},{"title":"Maven ä¾èµ–ä¼ é€’æ€§é€å½»ç†è§£","slug":"Maven-optional-ä¾èµ–é€å½»ç†è§£","date":"2019-10-11T07:36:38.000Z","updated":"2019-11-07T06:36:38.010Z","comments":true,"path":"/p/maven-dependency-optional-transitive.html","link":"","permalink":"https://dayarch.top/p/maven-dependency-optional-transitive.html","excerpt":"å†™åœ¨å‰é¢ æœ¬æ¥æƒ³å†™ä¸€ç¯‡ã€Œå¦‚ä½•è‡ªå®šä¹‰Spring Boot Starterã€ï¼Œä½†æ˜¯ä¸ºäº†æ›´å¥½ç†è§£ Starter çš„ä¸€äº›è®¾è®¡ç†å¿µå’Œå…¶ä¸­çš„å…³é”®ç‚¹ï¼Œæ‰€ä»¥æå‰å°†ä¸€äº›ç»†èŠ‚å†…å®¹å•ç‹¬æå–å‡ºæ¥è®²è§£è¯´æ˜ åœ¨ Maven pom.xml ä¸­ï¼Œä½ ç»å¸¸ä¼šçœ‹åˆ°ä¾èµ–é¡¹ä¸­æœ‰ç±»ä¼¼ä¸‹é¢çš„ä»£ç : 1 2 3 4 5 6 7 sample.ProjectA Project-A 1.0 compile tru","text":"å†™åœ¨å‰é¢æœ¬æ¥æƒ³å†™ä¸€ç¯‡ã€Œå¦‚ä½•è‡ªå®šä¹‰Spring Boot Starterã€ï¼Œä½†æ˜¯ä¸ºäº†æ›´å¥½ç†è§£ Starter çš„ä¸€äº›è®¾è®¡ç†å¿µå’Œå…¶ä¸­çš„å…³é”®ç‚¹ï¼Œæ‰€ä»¥æå‰å°†ä¸€äº›ç»†èŠ‚å†…å®¹å•ç‹¬æå–å‡ºæ¥è®²è§£è¯´æ˜ åœ¨ Maven pom.xml ä¸­ï¼Œä½ ç»å¸¸ä¼šçœ‹åˆ°ä¾èµ–é¡¹ä¸­æœ‰ç±»ä¼¼ä¸‹é¢çš„ä»£ç : 1234567&lt;dependency&gt; &lt;groupId&gt;sample.ProjectA&lt;/groupId&gt; &lt;artifactId&gt;Project-A&lt;/artifactId&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;scope&gt;compile&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; è¿™é‡Œçš„ &lt;optional&gt;true&lt;/optional&gt; æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ optional å…³é”®å­—çš„å¥¥ç§˜è€è§„çŸ©ï¼Œç”»ä¸ªå›¾è¯´æ˜é—®é¢˜: ç”±äº project C ä½¿ç”¨åˆ°äº†ä¸¤ä¸ªæ¥è‡ª project A çš„ç±» (OptionalFeatureAClass) å’Œ project B çš„ç±» (OptionalFeatureBClass). å¦‚æœ project C æ²¡æœ‰ä¾èµ– packageA å’Œ packageBï¼Œé‚£ä¹ˆç¼–è¯‘å°†ä¼šå¤±è´¥ã€‚ project D ä¾èµ– project Cï¼Œä½†æ˜¯å¯¹äº project D æ¥è¯´ï¼Œç±» (OptionalFeatureAClass) å’Œç±» (OptionalFeatureBClass) æ˜¯å¯é€‰çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ä¸ºäº†è®©æœ€ç»ˆçš„ war/ejb package ä¸åŒ…å«ä¸å¿…è¦çš„ä¾èµ–ï¼Œä½¿ç”¨&lt;optional&gt; å£°æ˜å½“å‰ä¾èµ–æ˜¯å¯é€‰çš„, é»˜è®¤æƒ…å†µä¸‹ä¹Ÿä¸ä¼šè¢«å…¶ä»–é¡¹ç›®ç»§æ‰¿(å¥½æ¯” Java ä¸­çš„ final ç±»ï¼Œä¸èƒ½è¢«å…¶ä»–ç±»ç»§æ‰¿ä¸€æ ·) å¦‚æœ project D ç¡®å®éœ€è¦ç”¨åˆ° project C ä¸­çš„ OptionalFeatureAClass æ€ä¹ˆåŠå‘¢ï¼Ÿé‚£æˆ‘ä»¬å°±éœ€è¦åœ¨ project D çš„ pom.xml ä¸­æ˜¾å¼çš„æ·»åŠ å£°æ˜ project A ä¾èµ–ï¼Œç»§ç»­çœ‹ä¸‹å›¾: Project D éœ€è¦ç”¨åˆ° Project A çš„ OptionalFeatureAClassï¼Œé‚£ä¹ˆéœ€è¦åœ¨ Project D çš„ pom.xml æ–‡ä»¶ä¸­æ˜¾å¼çš„æ·»åŠ å¯¹ Project A çš„ä¾èµ– åˆ°è¿™ä¹Ÿå°±å¾ˆå¥½ç†è§£ä¸ºä»€ä¹ˆ Maven ä¸ºä»€ä¹ˆè¦è®¾è®¡ optional å…³é”®å­—äº†ï¼Œå‡è®¾ä¸€ä¸ªå…³äºæ•°æ®åº“æŒä¹…åŒ–çš„é¡¹ç›®(Project C), ä¸ºäº†é€‚é…æ›´å¤šç±»å‹çš„æ•°æ®åº“æŒä¹…åŒ–è®¾è®¡ï¼Œæ¯”å¦‚ Mysql æŒä¹…åŒ–è®¾è®¡(Project A) å’Œ Oracle æŒä¹…åŒ–è®¾è®¡(Project B)ï¼Œå½“æˆ‘ä»¬çš„é¡¹ç›®(Project D) è¦ç”¨çš„ Project C çš„æŒä¹…åŒ–è®¾è®¡ï¼Œä¸å¯èƒ½æ—¢å¼•å…¥ mysql é©±åŠ¨åˆå¼•å…¥ oracle é©±åŠ¨å§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ˜¾å¼çš„æŒ‡å®šä¸€ä¸ªï¼Œå°±æ˜¯è¿™ä¸ªé“ç†äº† å®é™…æ¡ˆä¾‹åœ¨ spring-boot-actuator pom.xml æ–‡ä»¶ä¸­ï¼Œæœ‰è¶…è¿‡ 20 ä¸ªä¾èµ–æ˜¯ optional å› ä¸º Spring Boot ä¸å¯èƒ½å°†æ²¡å¿…è¦çš„ä¾èµ–ä¹Ÿæ‰“åŒ…åˆ°ä½ æœ€ç»ˆçš„ jar package ä¸­ï¼Œæ‰€ä»¥ç”¨åˆ° spring boot actuator çš„é¡¹ç›®æœ€ç»ˆç”Ÿæˆçš„ jar package ä¸­ä¸ä¼šåŒ…å«è¿™ 20 å¤šä¸ªä¾èµ– jarï¼Œå¦‚æœä½ è¦ç”¨åˆ°å“ªä¸€ä¸ªï¼Œæ˜¾å¼çš„åŠ å…¥åˆ°ä½ çš„é¡¹ç›®å°±å¥½äº† åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ï¼Œè‡ªå®šä¹‰ Spring Boot Starter ä¹Ÿæ˜¯è¿™ä¸ªç­–ç•¥ï¼Œå› ä¸º starter æ˜¯åŒ…å«ç‰¹å®šåŠŸèƒ½ä¸ºå…¶ä»–é¡¹ç›®æœåŠ¡ç”¨çš„ï¼Œç±»ä¼¼æœ¬æ–‡çš„ Project C çš„è§’è‰²äº†ï¼Œåˆ°è¿™é‡Œä½ ç†è§£ optional çš„å¥¥ç§˜äº†å—ï¼Ÿ åå‘åº”ç”¨å¦‚æœ Project C å¼•å…¥çš„ä¾èµ–æ²¡æœ‰åŠ  &lt;optional&gt;true&lt;/optional&gt;ï¼ŒProject D åˆéœ€è¦ä¾èµ– Project Cï¼Œä½†åªç”¨åˆ° Project A çš„ç±»æ€ä¹ˆåŠå‘¢ï¼ŸMaven ä¹Ÿæ˜¯æœ‰è§£å†³åŠæ³•çš„ï¼Œä½¿ç”¨ exclusion å…³é”®å­—ï¼Œä¸å¤šè¯´ï¼Œä¸Šä¸€æ®µä»£ç å°±æ‡‚äº†: 123456789101112&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;top.dayarch.demo&lt;/groupId&gt; &lt;artifactId&gt;Project-C&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;top.dayarch.demo&lt;/groupId&gt; &lt;artifactId&gt;Project-B&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt;&lt;/dependencies&gt; æ€»ç»“åˆ°è¿™é‡Œï¼Œåœ¨ä½ ä»Šåè®¾è®¡åŠŸèƒ½æ€§ä¾èµ–æ—¶ï¼Œä½ åº”è¯¥æ˜ç™½æ€æ ·è®¾è®¡ä¾èµ–å…³ç³»äº†, æˆ‘è¿™é‡Œæ¨èä½¿ç”¨ optional çš„å½¢å¼ï¼Œç®€å•æ¥è¯´ï¼Œä½ è®¾è®¡çš„ä¾èµ–ä»€ä¹ˆèœéƒ½æœ‰ï¼Œæƒ³åƒä»€ä¹ˆèœè‡ªå·± â€œæŠ±è”¡æ˜â€ å°±å¥½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¨¡æ‹Ÿå®˜æ–¹æ ‡å‡†åˆ›å»ºè‡ªå®šä¹‰çš„ starterâ€¦â€¦ çµé­‚è¿½é—® æœ‰å¾ˆå¤šç«¥é‹é¡¹ç›®ç»„ç”¨çš„æ„å»ºå·¥å…·æ—¶ Gradleï¼Œä½ çŸ¥é“ Gradle ä¸­æ˜¯æ€æ ·è¡¨ç¤ºçš„å—ï¼Ÿ è‡ªå®šä¹‰ starterï¼Œä½ çŸ¥é“å®˜æ–¹æ ‡å‡† starter çš„ç»“æ„æ˜¯ä»€ä¹ˆæ ·çš„å—ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® å¹¶å‘Bugä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£ é¢è¯•å¹¶å‘volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"DevOps","slug":"Coding/DevOps","permalink":"https://dayarch.top/categories/Coding/DevOps/"}],"tags":[{"name":"Maven","slug":"Maven","permalink":"https://dayarch.top/tags/Maven/"}]},{"title":"é”ä¿æŠ¤èµ„æºï¼Œsynchronizedæ–¹æ³•å°±å¤Ÿäº†å—","slug":"é”ä¿æŠ¤èµ„æºï¼Œsynchronizedæ–¹æ³•å°±å¤Ÿäº†å—","date":"2019-10-10T06:17:23.000Z","updated":"2020-03-04T03:43:42.706Z","comments":true,"path":"/p/java-concurrency-lock-resource.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-lock-resource.html","excerpt":"å†™åœ¨å‰é¢ ä¸Šä¸€ç¯‡æ–‡ç« åŸå­æ€§é—®é¢˜çš„å®è§‚ç†è§£ å¸¦é¢†å¤§å®¶äº†è§£äº†é”å’Œèµ„æºçš„æ¨¡å‹ï¼Œæœ‰äº†è¿™ç¯‡æ–‡ç« çš„é“ºå«ï¼Œç›¸ä¿¡ç†è§£è¿™ä¸€ç¯‡æ–‡ç« å°±éå¸¸è½»æ¾äº† å½“æˆ‘ä»¬è¦ä¿æŠ¤å•ä¸ªèµ„æºå¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹å…¶å®å¾ˆç®€å•ï¼Œåªéœ€æŒ‰ç…§ä¸‹å›¾åˆ†ä¸‰æ­¥èµ° 1. åˆ›å»ºå—ä¿æŠ¤èµ„æº R çš„é” 2. åŠ é”è¿›å…¥ä¸´ç•ŒåŒº 3. è§£é”èµ°å‡ºä¸´ç•ŒåŒº ä¸Šå›¾çš„å…³é”®æ˜¯ã€ŒR1 çš„é”ä¿æŠ¤ R1ã€çš„æŒ‡å‘å…³ç³»æ˜¯å¦æ­£ç¡® å¦‚æœéƒ½æ˜¯ä¿æŠ¤å•ä¸ªèµ„æºè¿™æ ·ç®€å•ï¼Œç¨‹åºçŒ¿çš„ä¸–ç•Œè¯¥æœ‰å¤šç¾å¥½ï¼Œå¯æƒœå¹¶ä¸æ˜¯ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦ä¿æŠ¤å¤šä¸ªèµ„æº ä¿æŠ¤å¤šä¸ªèµ„æº ä¿æŠ¤å¤šä¸ªæ²¡æœ‰å…³ç³»çš„èµ„æº å¦‚æœå¤šä¸ªèµ„æºæ²¡æœ‰å…³ç³»ï¼Œé‚£å°±æ˜¯ä¿æŠ¤ä¸€ä¸ªèµ„æºæ¨¡å‹çš„å¤åˆ¶ï¼ŒåŒæ ·éå¸¸ç®€å•ï¼Œä¸”çœ‹ä¸‹å›¾: æ¯”å¦‚ç°å®ä¸­é“¶è¡Œå–æ¬¾å’Œä¿®æ”¹å¯†ç æ“ä½œã€‚ é“¶è¡Œå–","text":"å†™åœ¨å‰é¢ä¸Šä¸€ç¯‡æ–‡ç« åŸå­æ€§é—®é¢˜çš„å®è§‚ç†è§£ å¸¦é¢†å¤§å®¶äº†è§£äº†é”å’Œèµ„æºçš„æ¨¡å‹ï¼Œæœ‰äº†è¿™ç¯‡æ–‡ç« çš„é“ºå«ï¼Œç›¸ä¿¡ç†è§£è¿™ä¸€ç¯‡æ–‡ç« å°±éå¸¸è½»æ¾äº† å½“æˆ‘ä»¬è¦ä¿æŠ¤å•ä¸ªèµ„æºå¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹å…¶å®å¾ˆç®€å•ï¼Œåªéœ€æŒ‰ç…§ä¸‹å›¾åˆ†ä¸‰æ­¥èµ° åˆ›å»ºå—ä¿æŠ¤èµ„æº R çš„é” åŠ é”è¿›å…¥ä¸´ç•ŒåŒº è§£é”èµ°å‡ºä¸´ç•ŒåŒº ä¸Šå›¾çš„å…³é”®æ˜¯ã€ŒR1 çš„é”ä¿æŠ¤ R1ã€çš„æŒ‡å‘å…³ç³»æ˜¯å¦æ­£ç¡® å¦‚æœéƒ½æ˜¯ä¿æŠ¤å•ä¸ªèµ„æºè¿™æ ·ç®€å•ï¼Œç¨‹åºçŒ¿çš„ä¸–ç•Œè¯¥æœ‰å¤šç¾å¥½ï¼Œå¯æƒœå¹¶ä¸æ˜¯ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦ä¿æŠ¤å¤šä¸ªèµ„æº ä¿æŠ¤å¤šä¸ªèµ„æºä¿æŠ¤å¤šä¸ªæ²¡æœ‰å…³ç³»çš„èµ„æºå¦‚æœå¤šä¸ªèµ„æºæ²¡æœ‰å…³ç³»ï¼Œé‚£å°±æ˜¯ä¿æŠ¤ä¸€ä¸ªèµ„æºæ¨¡å‹çš„å¤åˆ¶ï¼ŒåŒæ ·éå¸¸ç®€å•ï¼Œä¸”çœ‹ä¸‹å›¾: æ¯”å¦‚ç°å®ä¸­é“¶è¡Œå–æ¬¾å’Œä¿®æ”¹å¯†ç æ“ä½œã€‚é“¶è¡Œå–æ¬¾æ“ä½œå¯¹åº”çš„èµ„æºæ˜¯ã€Œä½™é¢ã€, ä¿®æ”¹å¯†ç æ“ä½œå¯¹åº”çš„èµ„æºæ˜¯ã€Œå¯†ç ã€ï¼Œä½™é¢å’Œå¯†ç ä¸¤ä¸ªèµ„æºå®Œå…¨æ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥å„è‡ªç”¨è‡ªå®¶çš„é”ä¿æŠ¤è‡ªå®¶çš„èµ„æºå°±å¥½äº† å¦‚æœå¤šä¸ªèµ„æºæ²¡æœ‰å…³ç³»ï¼Œç¨‹åºçŒ¿çš„ä¸–ç•Œè¯¥æœ‰å¤šç¾å¥½ï¼Œå¯æƒœå¹¶ä¸æ˜¯ï¼Œæˆ‘ä»¬ä¿æŠ¤çš„èµ„æºå¤šæ•°æƒ…å†µéƒ½æœ‰å…³è”å…³ç³» ä¿æŠ¤å¤šä¸ªå…³ç³»çš„èµ„æºæ‹¿ç»å…¸çš„é“¶è¡Œè½¬è´¦æ¡ˆä¾‹æ¥è¯´æ˜ï¼Œè´¦æˆ· A ç»™è´¦æˆ· B è½¬è´¦ï¼Œè´¦æˆ· A ä½™é¢å‡å°‘ 100 å…ƒï¼Œè´¦æˆ· B ä½™é¢å¢åŠ  100 å…ƒï¼Œè¿™ä¸ªæ“ä½œè¦æ˜¯åŸå­æ€§çš„ï¼Œé‚£ä¹ˆèµ„æºã€ŒA ä½™é¢ã€å’Œèµ„æºã€ŒB ä½™é¢ã€å°±è¿™æ ·â€æœ‰äº†å…³ç³»â€ï¼Œå…ˆæ¥çœ‹ç¨‹åº: 1234567891011class Account &#123; private int balance; // è½¬è´¦ synchronized void transfer( Account target, int amt)&#123; if (this.balance &gt; amt) &#123; this.balance -= amt; target.balance += amt; &#125; &#125; &#125; ç”¨ synchronized ç›´æ¥ä¿æŠ¤ transfer æ–¹æ³•ï¼Œç„¶åæ“ä½œèµ„æºã€ŒA ä½™é¢ã€å’Œèµ„æºã€ŒB ä½™é¢ã€å°±å¯ä»¥äº† âš ï¸: çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ å…ˆåœæ­¢å‘ä¸‹çœ‹ï¼Œåœ¨ä½ çš„ç¬”è®°æœ¬ä¸ŠæŒ‰ç…§æ–‡ç« å¼€å¤´çš„ä¸‰æ­¥èµ°æ¥ç”»ä¸ªå›¾çœ‹ä¸€çœ‹ï¼Œæ˜¯å¦å’Œä¸‹å›¾ä¸€æ ·å‘¢ï¼Ÿ æˆ‘ä»¬é€šå¸¸å®¹æ˜“å¿½ç•¥é”å’Œèµ„æºçš„æŒ‡å‘å…³ç³»ï¼Œæˆ‘ä»¬æƒ³å½“ç„¶çš„ç”¨é” this æ¥ä¿æŠ¤ target èµ„æºäº†ï¼Œä¹Ÿå°±æ²¡æœ‰èµ·åˆ°ä¿æŠ¤ä½œç”¨ å‡è®¾ Aï¼ŒBï¼ŒC è´¦æˆ·åˆå§‹ä½™é¢éƒ½æ˜¯ 200 åŸï¼ŒA å‘ B è½¬è´¦ 100ï¼ŒB å‘ C è½¬è´¦ 100 æˆ‘ä»¬æœŸç›¼æœ€ç»ˆçš„ç»“æœæ˜¯:è´¦æˆ· A ä½™é¢: 100 å…ƒè´¦æˆ· B ä½™é¢: 200 å…ƒè´¦æˆ· C ä½™é¢: 300 å…ƒ å‡çº¿ç¨‹ 1ã€ŒA å‘ B è½¬è´¦ã€ä¸çº¿ç¨‹ 2ã€ŒB å‘ C è½¬è´¦ã€ä¸¤ä¸ªæ“ä½œåŒæ—¶æ‰§è¡Œï¼Œæ ¹æ® JMM æ¨¡å‹å¯çŸ¥ï¼Œçº¿ç¨‹ 1 å’Œçº¿ç¨‹ 2 è¯»å–çº¿ç¨‹ B å½“å‰çš„ä½™é¢éƒ½æ˜¯ 200 å…ƒ: çº¿ç¨‹ 1 æ‰§è¡Œ transfer æ–¹æ³•é”å®šçš„æ˜¯ A çš„å®ä¾‹(A.this)ï¼Œå¹¶æ²¡æœ‰é”å®š B çš„å®ä¾‹ çº¿ç¨‹ 2 æ‰§è¡Œ transfer æ–¹æ³•é”å®šçš„æ˜¯ B çš„å®ä¾‹(B.this)ï¼Œå¹¶æ²¡æœ‰é”å®š C çš„å®ä¾‹ æ‰€ä»¥çº¿ç¨‹ 1 å’Œçº¿ç¨‹ 2 å¯ä»¥åŒæ—¶è¿›å…¥ transfer ä¸´ç•ŒåŒºï¼Œä¸Šé¢ä½ è®¤ä¸ºå¯¹çš„æ¨¡å‹å…¶å®å°±ä¼šå˜æˆè¿™ä¸ªæ ·å­: è¿˜è®°å¾— happens-before è§„åˆ™ è¿™ç¯‡æ–‡ç« æåˆ°çš„ç›‘è§†å™¨é”è§„åˆ™å’Œä¼ é€’æ€§è§„åˆ™å—ï¼Ÿ ç›‘è§†å™¨é”è§„åˆ™ å¯¹ä¸€ä¸ªé”çš„è§£é” happens-before äºéšåå¯¹è¿™ä¸ªé”çš„åŠ é” ä¼ é€’æ€§è§„åˆ™å¦‚æœ A happens-before B, ä¸” B happens-before C, é‚£ä¹ˆ A happens-before C èµ„æº B.balance å­˜åœ¨äºä¸¤ä¸ªâ€ä¸´ç•ŒåŒºâ€ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªâ€ä¸´ç•ŒåŒºâ€å¯¹ B.balance æ¥è¯´å½¢åŒè™šè®¾ï¼Œä¹Ÿå°±ä¸æ»¡è¶³ç›‘è§†å™¨é”è§„åˆ™ï¼Œè¿›è€Œå¯¼è‡´ä¼ é€’æ€§è§„åˆ™ä¹Ÿä¸ç”Ÿæ•ˆï¼Œè¯´ç™½äº†ï¼Œå‰åºçº¿ç¨‹çš„æ›´æ”¹ç»“æœå¯¹åä¸€ä¸ªçº¿ç¨‹ä¸å¯è§ è¿™æ ·æœ€ç»ˆå¯¼è‡´: è´¦æˆ· B çš„ä½™é¢å¯èƒ½æ˜¯ 100: çº¿ç¨‹ 1 å†™ B.balance 100(balance = 300) å…ˆäº çº¿ç¨‹ 2 å†™ B.balance(balance = 100)ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹ 1 çš„ç»“æœä¼šè¢«çº¿ç¨‹ 2 è¦†ç›–ï¼Œå¯¼è‡´æœ€ç»ˆè´¦æˆ· B çš„ä½™é¢ä¸º 100 è´¦æˆ· B çš„ä½™é¢å¯èƒ½æ˜¯ 300: ä¸ä¸Šè¿°æƒ…å†µç›¸åï¼Œçº¿ç¨‹ 1 å†™ B.balance 100(balance = 300) åäº çº¿ç¨‹ 2 å†™ B.balance(balance = 100)ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹ 2 çš„ç»“æœçº¿ç¨‹ 1 è¦†ç›–ï¼Œå¯¼è‡´æœ€ç»ˆè´¦æˆ· B çš„ä½™é¢ä¸º 300 å°±æ˜¯ä¸èƒ½å¾—åˆ°æˆ‘ä»¬ç†æƒ³ç»“æœ 200ï¼Œæ„Ÿè§‰ç”Ÿæ´»æ— æ¯”çš„è‰°éš¾ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ æ­£ç¡®å§¿åŠ¿ä¸Šé¢çš„é—®é¢˜å°±æ˜¯ä¸ºèµ„æºåˆ›å»ºçš„é”ä¸èƒ½ä¿æŠ¤æ‰€æœ‰å…³è”çš„èµ„æºï¼Œé‚£æˆ‘ä»¬å°±æƒ³åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¥çœ‹ä¸‹é¢ä»£ç : 123456789101112class Account &#123; private int balance; // è½¬è´¦ void transfer(Account target, int amt)&#123; synchronized(Account.class) &#123; if (this.balance &gt; amt) &#123; this.balance -= amt; target.balance += amt; &#125; &#125; &#125; &#125; æˆ‘ä»¬å°† this é”å˜ä¸º Account.class é”ï¼ŒAccount.class æ˜¯è™šæ‹ŸæœºåŠ è½½ Account ç±»æ—¶åˆ›å»ºçš„ï¼Œè‚¯å®šæ˜¯å”¯ä¸€çš„(åŒäº²å§”æ´¾æ¨¡å‹è§£é‡Šäº†ä¸ºä½•è¯¥å¯¹è±¡æ˜¯å”¯ä¸€çš„)ï¼Œ æ‰€æœ‰ Account å¯¹è±¡éƒ½å…±äº« Account.class, ä¹Ÿå°±æ˜¯è¯´ï¼ŒAccount.class é”èƒ½ä¿æŠ¤æ‰€æœ‰ Account å¯¹è±¡ï¼Œæˆ‘ä»¬å°†ä¸Šé¢ç¨‹åºå†ç”¨æ¨¡å‹è§£é‡Šä¸€ä¸‹ æ€»ç»“åˆ°è¿™é‡Œå…³äºé”å’Œèµ„æºçš„å…³ç³»ä½ åº”è¯¥äº†è§£çš„æ›´åŠ é€å½»äº†ï¼Œå•ä¸ªèµ„æºå’Œå¤šä¸ªæ— å…³è”èµ„æºçš„æƒ…å½¢éƒ½å¾ˆå¥½å¤„ç†ï¼Œä¸ºå„è‡ªèµ„æºåˆ›å»ºç›¸åº”çš„é”å°±å¥½ï¼Œå¦‚æœå¤šä¸ªèµ„æºæœ‰å…³è”ï¼Œä¸ºäº†è®©é”èµ·åˆ°ä¿æŠ¤ä½œç”¨ï¼Œæˆ‘ä»¬éœ€è¦å°†é”çš„ç²’åº¦å˜å¤§ï¼Œæ¯”å¦‚å°† this é”å˜æˆäº† Account.class é”ã€‚ è½¬è´¦ä¸šåŠ¡éå¸¸å¸¸è§ï¼Œå¹¶å‘é‡éå¸¸å¤§ï¼Œå¦‚æœæˆ‘ä»¬å°†é”çš„ç²’åº¦éƒ½æå‡åˆ° Account.class è¿™ä¸ªçº§åˆ«(åˆ†ä¹…å¿…åˆ)ï¼Œå‡è®¾æ¯æ¬¡è½¬è´¦ä¸šåŠ¡éƒ½å¾ˆè€—æ—¶ï¼Œé‚£ä¹ˆæ˜¾ç„¶è¿™ä¸ªé”çš„æ€§èƒ½æ˜¯æ¯”è¾ƒä½çš„ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„æ–‡ç« ï¼Œæˆ‘ä»¬è¿˜ä¼šç»§ç»­ä¼˜åŒ–è¿™ä¸ªæ¨¡å‹ï¼Œé€‰æ‹©åˆé€‚çš„é”ç²’åº¦ï¼ŒåŒæ—¶èƒ½ä¿æŠ¤å¤šä¸ªæœ‰å…³è”çš„èµ„æºï¼Œ æˆ‘ä»¬çš„é”ç²’åº¦è™½ç„¶å¤§ï¼Œä½†æ˜¯æˆ‘ä»¬ä¿éšœäº†è´¦æˆ·çš„å®‰å…¨ï¼Œæ‰€ä»¥å¹¶å‘ç¼–ç¨‹å¯ä»¥å…ˆä¿è¯äº‹æƒ…åšå¯¹ï¼Œé‡åˆ°ç“¶é¢ˆäº†ï¼Œæ…¢æ…¢ä¼˜åŒ–æ”¹å˜ç›¸åº”çš„æ¨¡å‹å°±å¥½äº†ï¼Œå½“ç„¶ç†Ÿç»ƒç†è§£è¿™ä¸ªæ¨¡å‹ä»¥åï¼Œä¸€æ­¥åˆ°ä½çš„å¹¶å‘ç¼–ç¨‹æ¨¡å‹å½“ç„¶æ˜¯æå¥½çš„â€¦â€¦ çµé­‚è¿½é—® è¿˜è®°å¾— happens-before çš„å‡ ä¸ªåŸåˆ™å—ï¼Ÿ åå‘é”ï¼Œè½»é‡é”ï¼Œé‡é‡é”æ˜¯ä¸æ˜¯å’Œæˆ‘ä»¬è¿™èŠ‚å†…å®¹æœ‰å¼‚æ›²åŒå·¥ä¹‹å¤„å‘¢ï¼Ÿ æå‰æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•æ¥ä¼˜åŒ–è¿™ä¸ªæ¨¡å‹å‘¢ï¼Ÿ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"},{"name":"é”","slug":"é”","permalink":"https://dayarch.top/tags/%E9%94%81/"}]},{"title":"EasyExcelè¯»å–Excelå®é™…åº”ç”¨","slug":"EasyExcelè¯»å–Excelå®é™…åº”ç”¨","date":"2019-10-07T10:32:34.000Z","updated":"2019-12-15T13:04:40.165Z","comments":true,"path":"/p/easyexcel-read.html","link":"","permalink":"https://dayarch.top/p/easyexcel-read.html","excerpt":"å†™åœ¨å‰é¢ Java åç«¯ç¨‹åºå‘˜åº”è¯¥ä¼šé‡åˆ°è¯»å– Excel ä¿¡æ¯åˆ° DB ç­‰ç›¸å…³éœ€æ±‚ï¼Œè„‘æµ·ä¸­å¯èƒ½çªç„¶é—´æƒ³èµ· Apache POI è¿™ä¸ªæŠ€æœ¯è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å½“ Excel çš„æ•°æ®é‡éå¸¸å¤§çš„æ—¶å€™ï¼Œä½ ä¹Ÿè®¸å‘ç°ï¼ŒPOI æ˜¯å°†æ•´ä¸ª Excel çš„å†…å®¹å…¨éƒ¨è¯»å‡ºæ¥æ”¾å…¥åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥å†…å­˜æ¶ˆè€—éå¸¸ä¸¥é‡ï¼Œå¦‚æœåŒæ—¶è¿›è¡ŒåŒ…å«å¤§æ•°æ®é‡çš„ Excel è¯»æ“ä½œï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºé—®é¢˜ ä½† EasyExcel çš„å‡ºç°å¾ˆå¥½çš„è§£å†³äº† POI ç›¸å…³é—®é¢˜ï¼ŒåŸæœ¬ä¸€ä¸ª 3M çš„ Excel ç”¨ POI éœ€è¦100Må·¦å³å†…å­˜, è€Œ EasyExcel å¯ä»¥å°†å…¶é™ä½åˆ°å‡  Mï¼ŒåŒæ—¶å†å¤§çš„ Excel éƒ½ä¸ä¼šå‡ºç°å†…å­˜æº¢å‡ºçš„æƒ…å†µï¼Œå› ä¸ºæ˜¯é€è¡Œè¯»å– E","text":"å†™åœ¨å‰é¢Java åç«¯ç¨‹åºå‘˜åº”è¯¥ä¼šé‡åˆ°è¯»å– Excel ä¿¡æ¯åˆ° DB ç­‰ç›¸å…³éœ€æ±‚ï¼Œè„‘æµ·ä¸­å¯èƒ½çªç„¶é—´æƒ³èµ· Apache POI è¿™ä¸ªæŠ€æœ¯è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å½“ Excel çš„æ•°æ®é‡éå¸¸å¤§çš„æ—¶å€™ï¼Œä½ ä¹Ÿè®¸å‘ç°ï¼ŒPOI æ˜¯å°†æ•´ä¸ª Excel çš„å†…å®¹å…¨éƒ¨è¯»å‡ºæ¥æ”¾å…¥åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥å†…å­˜æ¶ˆè€—éå¸¸ä¸¥é‡ï¼Œå¦‚æœåŒæ—¶è¿›è¡ŒåŒ…å«å¤§æ•°æ®é‡çš„ Excel è¯»æ“ä½œï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºé—®é¢˜ ä½† EasyExcel çš„å‡ºç°å¾ˆå¥½çš„è§£å†³äº† POI ç›¸å…³é—®é¢˜ï¼ŒåŸæœ¬ä¸€ä¸ª 3M çš„ Excel ç”¨ POI éœ€è¦100Må·¦å³å†…å­˜, è€Œ EasyExcel å¯ä»¥å°†å…¶é™ä½åˆ°å‡  Mï¼ŒåŒæ—¶å†å¤§çš„ Excel éƒ½ä¸ä¼šå‡ºç°å†…å­˜æº¢å‡ºçš„æƒ…å†µï¼Œå› ä¸ºæ˜¯é€è¡Œè¯»å– Excel çš„å†…å®¹ (è€è§„çŸ©ï¼Œè¿™é‡Œä¸ç”¨è¿‡åˆ†å…³å¿ƒä¸‹å›¾ï¼Œè„‘æµ·ä¸­æœ‰ä¸ªå°è±¡å³å¯ï¼Œçœ‹å®Œä¸‹é¢çš„ç”¨ä¾‹å†å›çœ‹è¿™ä¸ªå›¾ï¼Œå°±å¾ˆç®€å•äº†) å¦å¤– EasyExcel åœ¨ä¸Šå±‚åšäº†æ¨¡å‹è½¬æ¢çš„å°è£…ï¼Œä¸éœ€è¦ cell ç­‰ç›¸å…³æ“ä½œï¼Œè®©ä½¿ç”¨è€…æ›´åŠ ç®€å•å’Œæ–¹ä¾¿ï¼Œä¸”çœ‹ ç®€å•è¯»å‡è®¾æˆ‘ä»¬ excel ä¸­æœ‰ä»¥ä¸‹å†…å®¹: æˆ‘ä»¬éœ€è¦æ–°å»º User å®ä½“ï¼ŒåŒæ—¶ä¸ºå…¶æ·»åŠ æˆå‘˜å˜é‡ 123456789101112131415@Datapublic class User &#123; /** * å§“å */ @ExcelProperty(index = 0) private String name; /** * å¹´é¾„ */ @ExcelProperty(index = 1) private Integer age;&#125; ä½ ä¹Ÿè®¸å…³æ³¨åˆ°äº† @ExcelProperty æ³¨è§£ï¼ŒåŒæ—¶ä½¿ç”¨äº† index å±æ€§ (0 ä»£è¡¨ç¬¬ä¸€åˆ—ï¼Œä»¥æ­¤ç±»æ¨)ï¼Œè¯¥æ³¨è§£åŒæ—¶æ”¯æŒä»¥ã€Œåˆ—åã€name çš„æ–¹å¼åŒ¹é…ï¼Œæ¯”å¦‚: 12@ExcelProperty(\"å§“å\")private String name; æŒ‰ç…§ github æ–‡æ¡£çš„è¯´æ˜: ä¸å»ºè®® index å’Œ name åŒæ—¶ç”¨ï¼Œè¦ä¹ˆä¸€ä¸ªå¯¹è±¡åªç”¨indexï¼Œè¦ä¹ˆä¸€ä¸ªå¯¹è±¡åªç”¨nameå»åŒ¹é… å¦‚æœè¯»å–çš„ Excel æ¨¡æ¿ä¿¡æ¯åˆ—å›ºå®šï¼Œè¿™é‡Œå»ºè®®ä»¥ index çš„å½¢å¼ä½¿ç”¨ï¼Œå› ä¸ºå¦‚æœç”¨åå­—å»åŒ¹é…ï¼Œåå­—é‡å¤ï¼Œä¼šå¯¼è‡´åªæœ‰ä¸€ä¸ªå­—æ®µè¯»å–åˆ°æ•°æ®ï¼Œæ‰€ä»¥ index æ˜¯æ›´ç¨³å¦¥çš„æ–¹å¼ å¦‚æœ Excel æ¨¡æ¿çš„åˆ— index ç»å¸¸æœ‰å˜åŒ–ï¼Œé‚£è¿˜æ˜¯é€‰æ‹© name æ–¹å¼æ¯”è¾ƒå¥½ï¼Œä¸ç”¨ç»å¸¸æ€§ä¿®æ”¹å®ä½“çš„æ³¨è§£ index æ•°å€¼ æ‰€ä»¥å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„æƒ…å†µè‡ªè¡Œé€‰æ‹© ç¼–å†™æµ‹è¯•ç”¨ä¾‹ 12345@Testpublic void readExcel()&#123; String fileName = TestUtils.getPath() + \"excel\" + File.separator + \"users1.xlsx\"; EasyExcel.read(fileName, User.class, new UserExcelListener()).sheet().doRead();&#125; EasyExcel ç±»ä¸­é‡è½½äº†å¾ˆå¤šä¸ª read æ–¹æ³•ï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—ä¸¾è¯´æ˜ï¼Œè¯·å¤§å®¶è‡ªè¡ŒæŸ¥çœ‹ï¼›åŒæ—¶ sheet æ–¹æ³•ä¹Ÿå¯ä»¥æŒ‡å®š sheetNoï¼Œé»˜è®¤æ˜¯ç¬¬ä¸€ä¸ª sheet çš„ä¿¡æ¯ ä¸Šé¢ä»£ç çš„ new UserExcelListener() å¼‚å¸¸é†’ç›®ï¼Œè¿™ä¹Ÿæ˜¯ EasyExcel é€è¡Œè¯»å– Excel å†…å®¹çš„å…³é”®æ‰€åœ¨ï¼Œè‡ªå®šä¹‰ UserExcelListener ç»§æ‰¿ AnalysisEventListener 123456789101112131415161718192021222324252627282930@Slf4jpublic class UserExcelListener extends AnalysisEventListener&lt;User&gt; &#123; /** * æ‰¹å¤„ç†é˜ˆå€¼ */ private static final int BATCH_COUNT = 2; List&lt;User&gt; list = new ArrayList&lt;User&gt;(BATCH_COUNT); @Override public void invoke(User user, AnalysisContext analysisContext) &#123; log.info(\"è§£æåˆ°ä¸€æ¡æ•°æ®:&#123;&#125;\", JSON.toJSONString(user)); list.add(user); if (list.size() &gt;= BATCH_COUNT) &#123; saveData(); list.clear(); &#125; &#125; @Override public void doAfterAllAnalysed(AnalysisContext analysisContext) &#123; saveData(); log.info(\"æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼\"); &#125; private void saveData()&#123; log.info(\"&#123;&#125;æ¡æ•°æ®ï¼Œå¼€å§‹å­˜å‚¨æ•°æ®åº“ï¼\", list.size()); log.info(\"å­˜å‚¨æ•°æ®åº“æˆåŠŸï¼\"); &#125;&#125; åˆ°è¿™é‡Œè¯·å›çœ‹æ–‡ç« å¼€å¤´çš„ EasyExcel åŸç†å›¾ï¼Œinvoke æ–¹æ³•é€è¡Œè¯»å–æ•°æ®ï¼Œå¯¹åº”çš„å°±æ˜¯è®¢é˜…è€… 1ï¼›doAfterAllAnalysed æ–¹æ³•å¯¹åº”çš„å°±æ˜¯è®¢é˜…è€… 2ï¼Œè¿™æ ·ä½ ç†è§£äº†å—ï¼Ÿ æ‰“å°ç»“æœ: ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶æ˜¯é€è¡Œè§£ææ•°æ®ï¼Œä½†æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰é˜ˆå€¼ï¼Œå®Œæˆæ•°æ®çš„æ‰¹å¤„ç†æ“ä½œï¼Œå¯è§ EasyExcel æ“ä½œçš„çµæ´»æ€§ è‡ªå®šä¹‰è½¬æ¢å™¨è¿™æ˜¯æœ€åŸºæœ¬çš„æ•°æ®è¯»å†™ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡æ•°æ®é€šå¸¸ä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼Œæœ‰æ—¶ç”šè‡³éœ€è¦å°†å…¶è½¬æ¢ä¸ºç¨‹åºå¯è¯»çš„æ•°æ® æ€§åˆ«ä¿¡æ¯è½¬æ¢æ¯”å¦‚ Excel ä¸­æ–°å¢ã€Œæ€§åˆ«ã€åˆ—ï¼Œå…¶æ€§åˆ«ä¸ºç”·/å¥³ï¼Œæˆ‘ä»¬éœ€è¦å°† Excel ä¸­çš„æ€§åˆ«ä¿¡æ¯è½¬æ¢æˆç¨‹åºä¿¡æ¯: ã€Œ1: ç”·ï¼›2:å¥³ã€ é¦–å…ˆåœ¨ User å®ä½“ä¸­æ·»åŠ æˆå‘˜å˜é‡ gender: 12@ExcelProperty(index = 2)private Integer gender; EasyExcel æ”¯æŒæˆ‘ä»¬è‡ªå®šä¹‰ converterï¼Œå°† excel çš„å†…å®¹è½¬æ¢ä¸ºæˆ‘ä»¬ç¨‹åºéœ€è¦çš„ä¿¡æ¯ï¼Œè¿™é‡Œæ–°å»º GenderConverterï¼Œç”¨æ¥è½¬æ¢æ€§åˆ«ä¿¡æ¯ 123456789101112131415161718192021222324252627282930public class GenderConverter implements Converter&lt;Integer&gt; &#123; public static final String MALE = \"ç”·\"; public static final String FEMALE = \"å¥³\"; @Override public Class supportJavaTypeKey() &#123; return Integer.class; &#125; @Override public CellDataTypeEnum supportExcelTypeKey() &#123; return CellDataTypeEnum.STRING; &#125; @Override public Integer convertToJavaData(CellData cellData, ExcelContentProperty excelContentProperty, GlobalConfiguration globalConfiguration) throws Exception &#123; String stringValue = cellData.getStringValue(); if (MALE.equals(stringValue))&#123; return 1; &#125;else &#123; return 2; &#125; &#125; @Override public CellData convertToExcelData(Integer integer, ExcelContentProperty excelContentProperty, GlobalConfiguration globalConfiguration) throws Exception &#123; return null; &#125;&#125; ä¸Šé¢ç¨‹åºçš„ Converter æ¥å£çš„æ³›å‹æ˜¯æŒ‡è¦è½¬æ¢çš„ Java æ•°æ®ç±»å‹ï¼Œä¸ supportJavaTypeKey æ–¹æ³•ä¸­çš„è¿”å›å€¼ç±»å‹ä¸€è‡´ æ‰“å¼€æ³¨è§£ @ExcelProperty æŸ¥çœ‹ï¼Œè¯¥æ³¨è§£æ˜¯æ”¯æŒè‡ªå®šä¹‰ Converter çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸º User å®ä½“æ·»åŠ  gender æˆå‘˜å˜é‡ï¼Œå¹¶æŒ‡å®š converter 12345/** * æ€§åˆ« 1ï¼šç”·ï¼›2ï¼šå¥³ */@ExcelProperty(index = 2, converter = GenderConverter.class)private Integer gender; æ¥çœ‹è¿è¡Œç»“æœ: æ•°æ®æŒ‰ç…§æˆ‘ä»¬é¢„æœŸåšå‡ºäº†è½¬æ¢ï¼Œä»è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒConverter å¯ä»¥ä¸€æ¬¡å®šä¹‰åˆ°å¤„æ˜¯ç”¨çš„ä¾¿åˆ©æ€§ æ—¥æœŸä¿¡æ¯è½¬æ¢æ—¥æœŸä¿¡æ¯ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è§çš„è½¬æ¢æ•°æ®ï¼Œæ¯”å¦‚ Excel ä¸­æ–°å¢ã€Œå‡ºç”Ÿå¹´æœˆã€åˆ—ï¼Œæˆ‘ä»¬è¦è§£ææˆ yyyy-MM-dd æ ¼å¼ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è¿›è¡Œæ ¼å¼åŒ–ï¼ŒEasyExcel é€šè¿‡ @DateTimeFormat æ³¨è§£è¿›è¡Œæ ¼å¼åŒ– åœ¨ User å®ä½“ä¸­æ·»åŠ æˆå‘˜å˜é‡ birthï¼ŒåŒæ—¶åº”ç”¨ @DateTimeFormat æ³¨è§£ï¼ŒæŒ‰ç…§è¦æ±‚åšæ ¼å¼åŒ– 123456/** * å‡ºç”Ÿæ—¥æœŸ */@ExcelProperty(index = 3)@DateTimeFormat(\"yyyy-MM-dd HH:mm:ss\")private String birth; æ¥çœ‹è¿è¡Œç»“æœ: å¦‚æœè¿™é‡Œä½ æŒ‡å®š birth çš„ç±»å‹ä¸º Dateï¼Œè¯•è¯•çœ‹ï¼Œä½ å¾—åˆ°çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ åˆ°è¿™é‡Œéƒ½æ˜¯ä»¥æµ‹è¯•çš„æ–¹å¼æ¥ç¼–å†™ç¨‹åºä»£ç ï¼Œä½œä¸º Java Web å¼€å‘äººå‘˜ï¼Œå°¤å…¶åœ¨ç›®å‰ä¸»æµ Spring Boot çš„æ¶æ„ä¸‹ï¼Œæ‰€ä»¥å¦‚ä½•å®ç° Web æ–¹å¼è¯»å– Excel çš„ä¿¡æ¯å‘¢ï¼Ÿ web è¯»ç®€å• Webå¾ˆç®€å•ï¼Œåªæ˜¯å°†æµ‹è¯•ç”¨ä¾‹çš„å…³é”®ä»£ç ç§»åŠ¨åˆ° Controller ä¸­å³å¯ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª UserControllerï¼Œåœ¨å…¶æ·»åŠ  upload æ–¹æ³• 12345678910@RestController@RequestMapping(\"/users\")@Slf4jpublic class UserController &#123; @PostMapping(\"/upload\") public String upload(MultipartFile file) throws IOException &#123; EasyExcel.read(file.getInputStream(), User.class, new UserExcelListener()).sheet().doRead(); return \"success\"; &#125;&#125; å…¶å®åœ¨å†™æµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ä½ ä¹Ÿè®¸å·²ç»å‘ç°ï¼Œlistener æ˜¯ä»¥ new çš„å½¢å¼ä½œä¸ºå‚æ•°ä¼ å…¥åˆ° EasyExcel.read æ–¹æ³•ä¸­çš„ï¼Œè¿™æ˜¯ä¸ç¬¦åˆ Spring IoC çš„è§„åˆ™çš„ï¼Œæˆ‘ä»¬é€šå¸¸è¯»å– Excel æ•°æ®ä¹‹åéƒ½è¦é’ˆå¯¹è¯»å–çš„æ•°æ®ç¼–å†™ä¸€äº›ä¸šåŠ¡é€»è¾‘çš„ï¼Œè€Œä¸šåŠ¡é€»è¾‘é€šå¸¸åˆä¼šå†™åœ¨ Service å±‚ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨ listener ä¸­è°ƒç”¨åˆ°æˆ‘ä»¬çš„ service ä»£ç å‘¢ï¼Ÿ *å…ˆä¸è¦å‘ä¸‹çœ‹ï¼Œä½ è„‘æµ·ä¸­æœ‰å“ªäº›æ–¹æ¡ˆå‘¢ï¼Ÿ * åŒ¿åå†…éƒ¨ç±»æ–¹å¼åŒ¿åå†…éƒ¨ç±»æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ–°å»º Service å±‚çš„ä¿¡æ¯:æ–°å»º IUser æ¥å£: 123public interface IUser &#123; public boolean saveData(List&lt;User&gt; users);&#125; æ–°å»º IUser æ¥å£å®ç°ç±» UserServiceImpl: 1234567891011@Service@Slf4jpublic class UserServiceImpl implements IUser &#123; @Override public boolean saveData(List&lt;User&gt; users) &#123; log.info(\"UserService &#123;&#125;æ¡æ•°æ®ï¼Œå¼€å§‹å­˜å‚¨æ•°æ®åº“ï¼\", users.size()); log.info(JSON.toJSONString(users)); log.info(\"UserService å­˜å‚¨æ•°æ®åº“æˆåŠŸï¼\"); return true; &#125;&#125; æ¥ä¸‹æ¥ï¼Œåœ¨ Controller ä¸­æ³¨å…¥ IUser: 12@Autowiredprivate IUser iUser; ä¿®æ”¹ upload æ–¹æ³•ï¼Œä»¥åŒ¿åå†…éƒ¨ç±»é‡å†™ listener æ–¹æ³•çš„å½¢å¼æ¥å®ç°: 12345678910111213141516171819202122232425262728293031@PostMapping(\"/uploadWithAnonyInnerClass\") public String uploadWithAnonyInnerClass(MultipartFile file) throws IOException &#123; EasyExcel.read(file.getInputStream(), User.class, new AnalysisEventListener&lt;User&gt;()&#123; /** * æ‰¹å¤„ç†é˜ˆå€¼ */ private static final int BATCH_COUNT = 2; List&lt;User&gt; list = new ArrayList&lt;User&gt;(); @Override public void invoke(User user, AnalysisContext analysisContext) &#123; log.info(\"è§£æåˆ°ä¸€æ¡æ•°æ®:&#123;&#125;\", JSON.toJSONString(user)); list.add(user); if (list.size() &gt;= BATCH_COUNT) &#123; saveData(); list.clear(); &#125; &#125; @Override public void doAfterAllAnalysed(AnalysisContext analysisContext) &#123; saveData(); log.info(\"æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼\"); &#125; private void saveData()&#123; iUser.saveData(list); &#125; &#125;).sheet().doRead(); return \"success\"; &#125; æŸ¥çœ‹ç»“æœ: è¿™ç§å®ç°æ–¹å¼ï¼Œå…¶å®è¿™åªæ˜¯å°† listener ä¸­çš„å†…å®¹å…¨éƒ¨é‡å†™ï¼Œå¹¶åœ¨ controller ä¸­å±•ç°å‡ºæ¥ï¼Œå½“ä½ çœ‹ç€è¿™ä¹ˆè‡ƒè‚¿çš„ controller æ˜¯ä¸æ˜¯éå¸¸éš¾å—ï¼Ÿå¾ˆæ˜¾ç„¶è¿™ç§æ–¹å¼ä¸æ˜¯æˆ‘ä»¬çš„æœ€ä½³ç¼–ç å®ç° æ„é€ å™¨ä¼ å‚åœ¨ä¹‹å‰åˆ†æ SpringBoot ç»Ÿä¸€è¿”å›æºç æ—¶ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦å‘ç°ï¼ŒSpring åº•å±‚æºç å¤šæ•°ä»¥æ„é€ å™¨çš„å½¢å¼ä¼ å‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†ä¸º listener æ·»åŠ æœ‰å‚æ„é€ å™¨ï¼Œå°† Controller ä¸­ä¾èµ–æ³¨å…¥çš„ IUser ä»¥æ„é€ å™¨çš„å½¢å¼ä¼ å…¥åˆ° listener : 1234567891011121314@Slf4jpublic class UserExcelListener extends AnalysisEventListener&lt;User&gt; &#123; private IUser iUser; public UserExcelListener(IUser iUser)&#123; this.iUser = iUser; &#125; // çœç•¥ç›¸åº”ä»£ç ... private void saveData()&#123; iUser.saveData(list); //è°ƒç”¨ userService ä¸­çš„ saveData æ–¹æ³• &#125; æ›´æ”¹ Controller æ–¹æ³•: 12345@PostMapping(\"/uploadWithConstructor\")public String uploadWithConstructor(MultipartFile file) throws IOException &#123; EasyExcel.read(file.getInputStream(), User.class, new UserExcelListener(iUser)).sheet().doRead(); return \"success\";&#125; è¿è¡Œç»“æœ: åŒä¸Š è¿™æ ·æ›´æ”¹åï¼Œcontroller ä»£ç çœ‹ç€å¾ˆæ¸…æ™°ï¼Œä½†å¦‚æœåç»­ä¸šåŠ¡è¿˜æœ‰åˆ«çš„ Service éœ€è¦æ³¨å…¥ï¼Œæˆ‘ä»¬éš¾é“è¦ä¸€ç›´æ·»åŠ æœ‰å‚æ„é€ å™¨å—ï¼Ÿå¾ˆæ˜æ˜¾ï¼Œè¿™ç§æ–¹å¼åŒæ ·ä¸æ˜¯å¾ˆçµæ´»ã€‚ å…¶å®åœ¨ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ—¶å€™ï¼Œä½ ä¹Ÿè®¸ä¼šæƒ³åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Java8 lambda çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ Lambda ä¼ å‚ä¸ºäº†è§£å†³æ„é€ å™¨ä¼ å‚çš„ç—›ç‚¹ï¼ŒåŒæ—¶æˆ‘ä»¬åˆå¸Œæœ› listener æ›´å…·æœ‰é€šç”¨æ€§ï¼Œæ²¡å¿…è¦ä¸ºæ¯ä¸ª Excel ä¸šåŠ¡éƒ½æ–°å»ºä¸€ä¸ª listenerï¼Œå› ä¸º listener éƒ½æ˜¯é€è¡Œè¯»å– Excel æ•°æ®ï¼Œåªéœ€è¦å°†æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ä»£ç ä¼ å…¥ç»™ listener å³å¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€ç”¨åˆ° Consumer&lt;T&gt; ï¼Œå°†å…¶ä½œä¸ºæ„é€  listener çš„å‚æ•°ã€‚ æ–°å»ºä¸€ä¸ªå·¥å…·ç±» ExcelDemoUtilsï¼Œç”¨æ¥æ„é€  listener: 12345678910111213141516171819202122232425262728293031323334353637383940public class ExcelDemoUtils &#123; /** * æŒ‡å®šé˜ˆå€¼ * @param consumer * @param threshold * @param &lt;T&gt; * @return */ public static &lt;T&gt; AnalysisEventListener&lt;T&gt; getListener(Consumer&lt;List&lt;T&gt;&gt; consumer, int threshold) &#123; return new AnalysisEventListener&lt;T&gt;() &#123; private LinkedList&lt;T&gt; linkedList = new LinkedList&lt;T&gt;(); @Override public void invoke(T t, AnalysisContext analysisContext) &#123; linkedList.add(t); if (linkedList.size() == threshold)&#123; consumer.accept(linkedList); linkedList.clear(); &#125; &#125; @Override public void doAfterAllAnalysed(AnalysisContext analysisContext) &#123; if (linkedList.size() &gt; 0)&#123; consumer.accept(linkedList); &#125; &#125; &#125;; &#125; /** * ä¸æŒ‡å®šé˜ˆå€¼ï¼Œé˜ˆå€¼é»˜è®¤ä¸º10 * @param consumer * @param &lt;T&gt; * @return */ public static &lt;T&gt; AnalysisEventListener&lt;T&gt; getListener(Consumer&lt;List&lt;T&gt;&gt; consumer)&#123; return getListener(consumer, 10); &#125; æˆ‘ä»¬çœ‹åˆ°ï¼ŒgetListener æ–¹æ³•æ¥æ”¶ä¸€ä¸ª Consumer&lt;List&lt;T&gt;&gt; çš„å‚æ•°ï¼Œè¿™æ ·ä¸‹é¢ä»£ç è¢«è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ä¹Ÿå°±ä¼šè¢«ç›¸åº”çš„æ‰§è¡Œäº†: 1consumer.accept(linkedList); ç»§ç»­æ”¹é€  Controller æ–¹æ³•: 123456789101112@PostMapping(\"/uploadWithLambda\")public String uploadWithLambda(MultipartFile file) throws IOException &#123; AnalysisEventListener&lt;User&gt; userAnalysisEventListener = ExcelDemoUtils.getListener(this.batchInsert(), 2); EasyExcel.read(file.getInputStream(), User.class, userAnalysisEventListener).sheet().doRead(); return \"success\";&#125;private Consumer&lt;List&lt;User&gt;&gt; batchInsert()&#123; //å…¶ä»–ä¸šåŠ¡é€»è¾‘åªéœ€è¦æ·»åŠ åˆ°è¯¥æ–¹æ³•ä¸­å³å¯ return users -&gt; iUser.saveData(users);&#125; è¿è¡Œç»“æœ: åŒä¸Š åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦å°†ä¸šåŠ¡é€»è¾‘å®šåˆ¶åœ¨ batchInsert æ–¹æ³•ä¸­: æ»¡è¶³ Controller RESTful API çš„ç®€æ´æ€§ listener æ›´åŠ é€šç”¨å’Œçµæ´»ï¼Œå®ƒæ›´å¤šæ˜¯æ‰®æ¼”äº†æŠ½è±¡ç±»çš„è§’è‰²ï¼Œå…·ä½“çš„é€»è¾‘äº¤ç»™æŠ½è±¡æ–¹æ³•çš„å®ç°æ¥å®Œæˆ ä¸šåŠ¡é€»è¾‘å¯æ‰©å±•æ€§ä¹Ÿæ›´å¥½ï¼Œé€»è¾‘æ›´åŠ æ¸…æ™° æ€»ç»“åˆ°è¿™é‡Œï¼Œå…³äºå¦‚ä½•ä½¿ç”¨ EasyExcel è¯»å– Excel ä¿¡æ¯çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼å·²ç»ä»‹ç»å®Œäº†ï¼Œè¿˜æœ‰å¾ˆå¤šç»†èŠ‚å†…å®¹æ²¡æœ‰è®²ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜… EasyExcel Github æ–‡æ¡£å»å‘ç°æ›´å¤šå†…å®¹ é™¤äº†è¯»å– Excel çš„è¯»å–ï¼Œè¿˜æœ‰ Excel çš„å†™å…¥ï¼Œå¦‚æœéœ€è¦å°†å…¶å†™å…¥åˆ°æŒ‡å®šä½ç½®ï¼Œé…åˆ HuTool çš„å·¥å…·ç±» FileWriter çš„ä½¿ç”¨æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œé’ˆå¯¹ EasyExcel çš„ä½¿ç”¨ï¼Œå¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¹Ÿæ¬¢è¿åˆ°åšå®¢ä¸‹æ–¹æ¢è®¨ å®Œæ•´ä»£ç è¯·åœ¨å…¬ä¼—å·å›å¤ã€Œdemoã€ï¼Œç‚¹å¼€é“¾æ¥ï¼ŒæŸ¥çœ‹ã€Œeasyexceldemoã€æ–‡ä»¶å¤¹çš„å†…å®¹å³å¯ æ„Ÿè°¢éå¸¸æ„Ÿè°¢ EasyExcel çš„ä½œè€… ğŸŒ¹ğŸŒ¹ï¼Œè®© Excel çš„è¯»å†™æ›´åŠ æ–¹ä¾¿ çµé­‚è¿½é—® é™¤äº† Consumerï¼Œå¦‚æœéœ€è¦è¿”å›å€¼çš„ä¸šåŠ¡é€»è¾‘ï¼Œéœ€è¦ç”¨åˆ°å“ªä¸ªå‡½æ•°å¼æ¥å£å‘¢ï¼Ÿ å½“å‡ºç°å¤æ‚è¡¨å¤´çš„æ—¶å€™è¦å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ å°† DB æ•°æ®å†™å…¥åˆ° Excel å¹¶ä¸‹è½½ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ ä» EasyExcel çš„è®¾è®¡ä¸Šï¼Œä½ å­¦åˆ°äº†ä»€ä¹ˆï¼Œæ¬¢è¿åšå®¢ä¸‹æ–¹ç•™è¨€è®¨è®º æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® å¹¶å‘Bugä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£ é¢è¯•å¹¶å‘volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"Excel","slug":"Excel","permalink":"https://dayarch.top/tags/Excel/"},{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"},{"name":"EasyExcel","slug":"EasyExcel","permalink":"https://dayarch.top/tags/EasyExcel/"},{"name":"POI","slug":"POI","permalink":"https://dayarch.top/tags/POI/"}]},{"title":"é¢è¯•volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ","slug":"é¢è¯•volatileå…³é”®å­—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å…·å¤‡å“ªäº›è°ˆèµ„ï¼Ÿ","date":"2019-09-29T12:03:33.000Z","updated":"2020-03-04T03:43:49.265Z","comments":true,"path":"/p/java-concurrency-volatile.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-volatile.html","excerpt":"å†™åœ¨å‰é¢ åœ¨ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š æ–‡ç« ä¸­ï¼Œhappens-before çš„åŸåˆ™ä¹‹ä¸€: volatileå˜é‡è§„åˆ™ å¯¹ä¸€ä¸ª volatile åŸŸçš„å†™, happens-before äºä»»æ„åç»­å¯¹è¿™ä¸ª volatile åŸŸçš„è¯» æŒ‰ç†è¯´äº†è§£äº†è¿™ä¸ªè§„åˆ™ï¼Œå¯¹ volatile çš„ä½¿ç”¨å°±å·²ç»è¶³å¤Ÿäº†ï¼Œä½†æ˜¯é¢è¯•å®˜å¯æ˜¯å–œæ¬¢åˆ¨æ ¹é—®åˆ°åº•çš„ï¼Œä¸ºäº†æ›´é€å½»çš„äº†è§£ volatile çš„å†…å­˜è¯­ä¹‰ä¸è¯»å†™è¯­ä¹‰ï¼Œä¸ºäº†é¢è¯•å¤šä¸€äº›è°ˆèµ„è¿›è€Œè·å¾—ä¸€äº›åŠ åˆ†é¡¹ï¼ŒåŒæ—¶å°½æ—©å¡«è¡¥å‰åºæ–‡ç« ç•™ä¸‹çš„å‘ï¼Œäºæ˜¯ä¹è¿™ç¯‡æ–‡ç« å°±è¿™æ ·å°´å°¬çš„è¯ç”Ÿäº† happens-before ä¹‹ volatile å˜é‡è§„åˆ™ ä¸‹é¢çš„è¡¨æ ¼ä½ è¿˜è®°å¾—å—ï¼Ÿ","text":"å†™åœ¨å‰é¢åœ¨ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š æ–‡ç« ä¸­ï¼Œhappens-before çš„åŸåˆ™ä¹‹ä¸€: volatileå˜é‡è§„åˆ™ å¯¹ä¸€ä¸ª volatile åŸŸçš„å†™, happens-before äºä»»æ„åç»­å¯¹è¿™ä¸ª volatile åŸŸçš„è¯» æŒ‰ç†è¯´äº†è§£äº†è¿™ä¸ªè§„åˆ™ï¼Œå¯¹ volatile çš„ä½¿ç”¨å°±å·²ç»è¶³å¤Ÿäº†ï¼Œä½†æ˜¯é¢è¯•å®˜å¯æ˜¯å–œæ¬¢åˆ¨æ ¹é—®åˆ°åº•çš„ï¼Œä¸ºäº†æ›´é€å½»çš„äº†è§£ volatile çš„å†…å­˜è¯­ä¹‰ä¸è¯»å†™è¯­ä¹‰ï¼Œä¸ºäº†é¢è¯•å¤šä¸€äº›è°ˆèµ„è¿›è€Œè·å¾—ä¸€äº›åŠ åˆ†é¡¹ï¼ŒåŒæ—¶å°½æ—©å¡«è¡¥å‰åºæ–‡ç« ç•™ä¸‹çš„å‘ï¼Œäºæ˜¯ä¹è¿™ç¯‡æ–‡ç« å°±è¿™æ ·å°´å°¬çš„è¯ç”Ÿäº† happens-before ä¹‹ volatile å˜é‡è§„åˆ™ä¸‹é¢çš„è¡¨æ ¼ä½ è¿˜è®°å¾—å—ï¼Ÿ(æ˜¯çš„ï¼Œä½ è®°å¾—ğŸ˜‚) èƒ½å¦é‡æ’åº ç¬¬äºŒä¸ªæ“ä½œ ç¬¬äºŒä¸ªæ“ä½œ ç¬¬äºŒä¸ªæ“ä½œ ç¬¬ä¸€ä¸ªæ“ä½œ æ™®é€šè¯»/å†™ volatile è¯» volatile å†™ æ™®é€šè¯»/å†™ - - NO volatile è¯» NO NO NO volatile å†™ - NO NO ä¸Šé¢çš„è¡¨æ ¼æ˜¯ JMM é’ˆå¯¹ç¼–è¯‘å™¨å®šåˆ¶çš„ volatile é‡æ’åºçš„è§„åˆ™ï¼Œé‚£ JMM æ˜¯æ€æ ·ç¦æ­¢é‡æ’åºçš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å†…å­˜å±éšœ å†…å­˜å±éšœ (Memory Barriers / Fences)æ— è®ºä½ å¬è¿‡è¿™ä¸ªåè¯ä¸å¦éƒ½æ²¡å…³ç³»ï¼Œå¾ˆç®€å•ï¼Œä¸”çœ‹ ä¸ºäº†å®ç° volatile çš„å†…å­˜è¯­ä¹‰ï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆå­—èŠ‚ç æ—¶ï¼Œä¼šåœ¨æŒ‡ä»¤åºåˆ—ä¸­æ’å…¥å†…å­˜å±éšœæ¥ç¦æ­¢ç‰¹å®šç±»å‹çš„å¤„ç†å™¨é‡æ’åº è¿™å¥è¯æœ‰ç‚¹æŠ½è±¡ï¼Œè¯•ç€æƒ³è±¡å†…å­˜å±éšœæ˜¯ä¸€é¢é«˜å¢™ï¼Œå¦‚æœä¸¤ä¸ªå˜é‡ä¹‹é—´æœ‰è¿™ä¸ªå±éšœï¼Œé‚£ä¹ˆä»–ä»¬å°±ä¸èƒ½äº’æ¢ä½ç½®(é‡æ’åº)äº†ï¼Œå˜é‡æœ‰è¯»(Load)æœ‰å†™(Store)ï¼Œæ“ä½œæœ‰å‰æœ‰åï¼ŒJMM å°±å°†å†…å­˜å±éšœæ’å…¥ç­–ç•¥åˆ†ä¸º 4 ç§: åœ¨æ¯ä¸ª volatile å†™æ“ä½œçš„å‰é¢æ’å…¥ä¸€ä¸ª StoreStore å±éšœ åœ¨æ¯ä¸ª volatile å†™æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª StoreLoad å±éšœ åœ¨æ¯ä¸ª volatile è¯»æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª LoadLoad å±éšœ åœ¨æ¯ä¸ª volatile è¯»æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª LoadStore å±éšœ 1 å’Œ 2 ç”¨å›¾å½¢æè¿°ä»¥åŠå¯¹åº”è¡¨æ ¼è§„åˆ™å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­äº†: 3 å’Œ 4 ç”¨å›¾å½¢æè¿°ä»¥åŠå¯¹åº”è¡¨æ ¼è§„åˆ™å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­äº†: å…¶å®å›¾å½¢ä¹Ÿæ˜¯è¡¨æ ¼å†…å®¹çš„ä½“ç°ï¼Œåªä¸è¿‡å‘Šè¯‰å¤§å®¶å†…å­˜å±éšœæ˜¯å¦‚ä½•ç¦æ­¢æŒ‡ä»¤é‡æ’åºçš„ï¼Œæ‰€ä»¥å¤§å®¶åªè¦ç‰¢è®°è¡¨æ ¼å†…å®¹å³å¯ ä¸€æ®µç¨‹åºçš„è¯»å†™é€šå¸¸ä¸ä¼šåƒä¸Šé¢ä¸¤ç§æƒ…å†µè¿™æ ·ç®€å•ï¼Œè¿™äº›å±éšœç»„åˆèµ·æ¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿå…¶å®ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›æŒ‡ä»¤å¸¦å…¥åˆ°æ–‡ç« å¼€å¤´çš„è¡¨æ ¼ä¸­ï¼Œç„¶åå†æŒ‰ç…§ç¨‹åºé¡ºåºæ‹¼æ¥æŒ‡ä»¤å°±å¥½äº† æ¥çœ‹ä¸€å°æ®µç¨‹åº: 1234567891011121314public class VolatileBarrierExample &#123; private int a; private volatile int v1 = 1; private volatile int v2 = 2; void readAndWrite()&#123; int i = v1; //ç¬¬ä¸€ä¸ªvolatileè¯» int j = v2; //ç¬¬äºŒä¸ªvolatileè¯» a = i + j; //æ™®é€šå†™ v1 = i + 1; //ç¬¬ä¸€ä¸ªvolatileå†™ v2 = j * 2; //ç¬¬äºŒä¸ªvolatileå†™ &#125;&#125; å°†å±éšœæŒ‡ä»¤å¸¦å…¥åˆ°ç¨‹åºå°±æ˜¯è¿™ä¸ªæ ·å­: æˆ‘ä»¬å°†ä¸Šå›¾åˆ†å‡ ä¸ªè§’åº¦æ¥çœ‹: å½©è‰²æ˜¯å°†å±éšœæŒ‡ä»¤å¸¦å…¥åˆ°ç¨‹åºä¸­ç”Ÿæˆçš„å…¨éƒ¨å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ç¼–è¯‘å™¨ç”Ÿæˆçš„ã€Œæœ€ç¨³å¦¥ã€çš„æ–¹æ¡ˆ æ˜¾ç„¶æœ‰å¾ˆå¤šå±éšœæ˜¯é‡å¤å¤šä½™çš„ï¼Œå³ä¾§è™šçº¿æ¡†æŒ‡å‘çš„å±éšœæ˜¯å¯ä»¥è¢«ã€Œä¼˜åŒ–ã€åˆ é™¤æ‰çš„å±éšœ åˆ°è¿™é‡Œä½ åº”è¯¥äº†è§£äº† volatile æ˜¯å¦‚ä½•é€šè¿‡å†…å­˜å±éšœä¿è¯ç¨‹åºä¸è¢«â€æ“…è‡ªâ€æ’åºçš„ï¼Œé‚£ volatile æ˜¯å¦‚ä½•ä¿è¯å¯è§æ€§çš„å‘¢ï¼Ÿ volatile å†™-è¯»çš„å†…å­˜è¯­ä¹‰å›é¡¾ä¸€ä¸‹ä¹‹å‰æ–‡ç« å†…å®¹ä¸­çš„ç¨‹åºï¼Œå‡å®šçº¿ç¨‹ A å…ˆæ‰§è¡Œ writer æ–¹æ³•ï¼Œéšåçº¿ç¨‹ B æ‰§è¡Œ reader æ–¹æ³•ï¼Œ: 12345678910111213141516171819public class ReorderExample &#123; private int x = 0; private int y = 1; private volatile boolean flag = false; public void writer()&#123; x = 42; //1 y = 50; //2 flag = true; //3 &#125; public void reader()&#123; if (flag)&#123; //4 System.out.println(\"x:\" + x); //5 System.out.println(\"y:\" + y); //6 &#125; &#125;&#125; åˆ°è¿™é‡Œä½ æ˜¯å¦è¿˜è®°å¾—ä¹‹å‰è¯´è¿‡çš„ JMMï¼Œæ˜¯çš„ï¼Œä½ è¿˜è®°å¾—ğŸ˜‚ï¼Œå½“çº¿ç¨‹ A æ‰§è¡Œ writer æ–¹æ³•æ—¶ï¼Œä¸”çœ‹ä¸‹å›¾: çº¿ç¨‹ A å°†æœ¬åœ°å†…å­˜æ›´æ”¹çš„å˜é‡å†™å›åˆ°ä¸»å†…å­˜ä¸­ volatile è¯»çš„å†…å­˜è¯­ä¹‰:å½“è¯»ä¸€ä¸ª volatile å˜é‡æ—¶, JMM ä¼šæŠŠè¯¥çº¿ç¨‹å¯¹åº”çš„æœ¬åœ°å†…å­˜ç½®ä¸ºæ— æ•ˆã€‚çº¿ç¨‹æ¥ä¸‹æ¥å°†ä»ä¸»å†…å­˜ä¸­è¯»å–å…±äº«å˜é‡ã€‚ æ‰€ä»¥å½“çº¿ç¨‹ B æ‰§è¡Œ reader æ–¹æ³•æ—¶ï¼Œå›¾å½¢ç»“æ„å°±å˜æˆäº†è¿™ä¸ªæ ·å­: çº¿ç¨‹ B æœ¬åœ°å†…å­˜å˜é‡æ— æ•ˆï¼Œä»ä¸»å†…å­˜ä¸­è¯»å–å˜é‡åˆ°æœ¬åœ°å†…å­˜ä¸­ï¼Œä¹Ÿå°±å¾—åˆ°äº†çº¿ç¨‹ A æ›´æ”¹åçš„ç»“æœï¼Œè¿™å°±æ˜¯ volatile æ˜¯å¦‚ä½•ä¿è¯å¯è§æ€§çš„ å¦‚æœä½ çœ‹è¿‡å‰é¢çš„æ–‡ç« ä½ å°±ä¸éš¾ç†è§£ä¸Šé¢çš„ä¸¤å¼ å›¾äº†ï¼Œç»¼åˆèµ·æ¥è¯´: çº¿ç¨‹ A å†™ä¸€ä¸ªvolatileå˜é‡, å®è´¨ä¸Šæ˜¯çº¿ç¨‹ A å‘æ¥ä¸‹æ¥å°†è¦è¯»è¿™ä¸ª volatile å˜é‡çš„æŸä¸ªçº¿ç¨‹å‘å‡ºäº†(å…¶å¯¹å…±äº«å˜é‡æ‰€åšä¿®æ”¹çš„)æ¶ˆæ¯ çº¿ç¨‹ B è¯»ä¸€ä¸ª volatile å˜é‡,å®è´¨ä¸Šæ˜¯çº¿ç¨‹ B æ¥æ”¶äº†ä¹‹å‰æŸä¸ªçº¿ç¨‹å‘å‡ºçš„(åœ¨å†™è¿™ä¸ª volatile å˜é‡ä¹‹å‰å¯¹å…±äº«å˜é‡æ‰€åšä¿®æ”¹çš„)æ¶ˆæ¯ã€‚ çº¿ç¨‹ A å†™ä¸€ä¸ª volatile å˜é‡, éšåçº¿ç¨‹ B è¯»è¿™ä¸ª volatile å˜é‡, è¿™ä¸ªè¿‡ç¨‹å®è´¨ä¸Šæ˜¯çº¿ç¨‹ A é€šè¿‡ä¸»å†…å­˜å‘çº¿ç¨‹B å‘é€æ¶ˆæ¯ã€‚ åˆ°è¿™é‡Œï¼Œé¢è¯• volatile æ—¶ï¼Œä½ åº”è¯¥æœ‰ä¸€äº›è°ˆèµ„äº†ï¼ŒåŒæ—¶ä¹Ÿå¯¹ volatile çš„è¯­ä¹‰æœ‰äº†æ›´æ·±å±‚æ¬¡çš„äº†è§£ å½©è›‹ä¹‹å‰çš„æ–‡ç« æåˆ°è¿‡è¿™æ ·ä¸€å¥è¯: ä»å†…å­˜è¯­ä¹‰çš„è§’åº¦æ¥è¯´, volatile çš„å†™-è¯»ä¸é”çš„é‡Šæ”¾-è·å–æœ‰ç›¸åŒçš„å†…å­˜æ•ˆæœï¼›volatile å†™å’Œé”çš„é‡Šæ”¾æœ‰ç›¸åŒçš„å†…å­˜è¯­ä¹‰; volatile è¯»ä¸é”çš„è·å–æœ‰ç›¸åŒçš„å†…å­˜è¯­ä¹‰ è®°ä½æ–‡ä¸­æœ€åä¸¤å¼ å›¾ï¼Œ å½“æˆ‘ä»¬è¯´åˆ° synchronized çš„æ—¶å€™ï¼Œä½ å°±ä¼šçŒ›çš„ç†è§£è¿™å¥è¯çš„å«ä¹‰äº†, æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å…ˆäº†è§£ synchronized çš„å†™-è¯»è¯­ä¹‰ æ¥ä¸‹æ¥æˆ‘ä»¬å°±èŠä¸€èŠé”ç›¸å…³çš„å†…å®¹äº†ï¼Œæ•¬è¯·æœŸå¾…â€¦ çµé­‚è¿½é—® å¦‚æœ volatile å†™ä¹‹åç›´æ¥ returnï¼Œé‚£è¿˜ä¼šç”Ÿæˆ StoreLoad æŒ‡ä»¤å—ï¼Ÿ synchronized æ˜¯æ€æ ·é€æ­¥è¢«ä¼˜åŒ–çš„ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· tool.luhttps://tool.lu æ˜¯ä¸€æ¬¾é›†æˆäº†éå¸¸å¤šåŠŸèƒ½çš„åœ¨çº¿å·¥å…·ï¼ŒåŸºæœ¬æ»¡è¶³æ—¥å¸¸å¼€å‘æ‰€éœ€ æ¨èé˜…è¯» è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® å¹¶å‘Bugä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"},{"name":"volatile","slug":"volatile","permalink":"https://dayarch.top/tags/volatile/"}]},{"title":"è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£","slug":"è§£å†³åŸå­æ€§é—®é¢˜ï¼Ÿä½ é¦–å…ˆéœ€è¦çš„æ˜¯å®è§‚ç†è§£","date":"2019-09-19T02:05:31.000Z","updated":"2020-03-04T03:43:57.834Z","comments":true,"path":"/p/java-concurrency-atomic.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-atomic.html","excerpt":"ä¸Šä¸€ç¯‡æ–‡ç«  å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®šï¼Œè§£å†³äº†å¹¶å‘ä¸‰å¤§é—®é¢˜ä¸­çš„ä¸¤ä¸ªï¼Œä»Šå¤©æˆ‘ä»¬å°±èŠèŠå¦‚ä½•è§£å†³åŸå­æ€§é—®é¢˜ åŸå­æ€§é—®é¢˜çš„æºå¤´å°±æ˜¯ çº¿ç¨‹åˆ‡æ¢ï¼Œä½†åœ¨å¤šæ ¸ CPU çš„å¤§èƒŒæ™¯ä¸‹ï¼Œä¸å…è®¸çº¿ç¨‹åˆ‡æ¢æ˜¯ä¸å¯èƒ½çš„ï¼Œæ­£æ‰€è°“ã€Œé­”é«˜ä¸€å°ºï¼Œé“é«˜ä¸€ä¸ˆã€ï¼Œæ–°è§„çŸ©æ¥äº†: äº’æ–¥: åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ å®é™…ä¸Šï¼Œä¸Šé¢è¿™å¥è¯çš„æ„æ€æ˜¯: å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹æ˜¯äº’æ–¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹ A ä¿®æ”¹å…±äº«å˜é‡æ—¶å…¶ä»–çº¿ç¨‹ä¸èƒ½ä¿®æ”¹ï¼Œè¿™å°±ä¸å­˜åœ¨æ“ä½œè¢«æ‰“æ–­çš„é—®é¢˜äº†ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°äº’æ–¥å‘¢ï¼Ÿ é” å¯¹å¹¶å‘æœ‰æ‰€äº†è§£çš„å°ä¼™ä¼´é©¬ä¸Šå°±èƒ½æƒ³åˆ° é” è¿™ä¸ªæ¦‚å¿µï¼Œå¹¶ä¸”ä½ çš„ç¬¬ä¸€ååº”å¾ˆå¯èƒ½å°±æ˜¯ä½¿ç”¨ synchronizedï¼Œè¿™é‡Œåˆ—å‡ºæ¥ä½ å¸¸è§çš„ syn","text":"ä¸Šä¸€ç¯‡æ–‡ç«  å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®šï¼Œè§£å†³äº†å¹¶å‘ä¸‰å¤§é—®é¢˜ä¸­çš„ä¸¤ä¸ªï¼Œä»Šå¤©æˆ‘ä»¬å°±èŠèŠå¦‚ä½•è§£å†³åŸå­æ€§é—®é¢˜ åŸå­æ€§é—®é¢˜çš„æºå¤´å°±æ˜¯ çº¿ç¨‹åˆ‡æ¢ï¼Œä½†åœ¨å¤šæ ¸ CPU çš„å¤§èƒŒæ™¯ä¸‹ï¼Œä¸å…è®¸çº¿ç¨‹åˆ‡æ¢æ˜¯ä¸å¯èƒ½çš„ï¼Œæ­£æ‰€è°“ã€Œé­”é«˜ä¸€å°ºï¼Œé“é«˜ä¸€ä¸ˆã€ï¼Œæ–°è§„çŸ©æ¥äº†: äº’æ–¥: åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ å®é™…ä¸Šï¼Œä¸Šé¢è¿™å¥è¯çš„æ„æ€æ˜¯: å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹æ˜¯äº’æ–¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹ A ä¿®æ”¹å…±äº«å˜é‡æ—¶å…¶ä»–çº¿ç¨‹ä¸èƒ½ä¿®æ”¹ï¼Œè¿™å°±ä¸å­˜åœ¨æ“ä½œè¢«æ‰“æ–­çš„é—®é¢˜äº†ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°äº’æ–¥å‘¢ï¼Ÿ é”å¯¹å¹¶å‘æœ‰æ‰€äº†è§£çš„å°ä¼™ä¼´é©¬ä¸Šå°±èƒ½æƒ³åˆ° é” è¿™ä¸ªæ¦‚å¿µï¼Œå¹¶ä¸”ä½ çš„ç¬¬ä¸€ååº”å¾ˆå¯èƒ½å°±æ˜¯ä½¿ç”¨ synchronizedï¼Œè¿™é‡Œåˆ—å‡ºæ¥ä½ å¸¸è§çš„ synchronized çš„ä¸‰ç§ç”¨æ³•: 123456789101112131415161718public class ThreeSync &#123; private static final Object object = new Object(); public synchronized void normalSyncMethod()&#123; //ä¸´ç•ŒåŒº &#125; public static synchronized void staticSyncMethod()&#123; //ä¸´ç•ŒåŒº &#125; public void syncBlockMethod()&#123; synchronized (object)&#123; //ä¸´ç•ŒåŒº &#125; &#125;&#125; ä¸‰ç§ synchronized é”çš„å†…å®¹æœ‰ä¸€äº›å·®åˆ«: å¯¹äºæ™®é€šåŒæ­¥æ–¹æ³•ï¼Œé”çš„æ˜¯å½“å‰å®ä¾‹å¯¹è±¡ï¼Œé€šå¸¸æŒ‡ this å¯¹äºé™æ€åŒæ­¥æ–¹æ³•ï¼Œé”çš„æ˜¯å½“å‰ç±»çš„ Class å¯¹è±¡ï¼Œå¦‚ ThreeSync.class å¯¹äºåŒæ­¥æ–¹æ³•å—ï¼Œé”çš„æ˜¯ synchronized æ‹¬å·å†…çš„å¯¹è±¡ æˆ‘ç‰¹æ„åœ¨ä¸‰ç§ synchronized ä»£ç é‡Œé¢æ·»åŠ äº†ã€Œä¸´ç•ŒåŒºã€å­—æ ·çš„æ³¨é‡Šï¼Œé‚£ä»€ä¹ˆæ˜¯ä¸´ç•ŒåŒºå‘¢ï¼Ÿ ä¸´ç•ŒåŒº: æˆ‘ä»¬æŠŠéœ€è¦äº’æ–¥æ‰§è¡Œçš„ä»£ç çœ‹æˆä¸ºä¸´ç•ŒåŒº è¯´åˆ°è¿™é‡Œï¼Œå’Œå¤§å®¶ä¸²çš„çŸ¥è¯†éƒ½æ˜¯è¡¨å±‚è®¤çŸ¥ï¼Œå¦‚ä½•ç”¨é”ä¿æŠ¤æœ‰æ•ˆçš„ä¸´ç•ŒåŒºæ‰æ˜¯å…³é”®ï¼Œè¿™ç›´æ¥å…³ç³»åˆ°ä½ æ˜¯å¦ä¼šå†™å‡ºå¹¶å‘çš„ bugï¼Œäº†è§£è¿‡æœ¬ç« å†…å®¹åï¼Œä½ ä¼šå‘ç°æ— è®ºæ˜¯éšå¼é”/å†…ç½®é” (synchronized) è¿˜æ˜¯æ˜¾ç¤ºé” (Lock) çš„ä½¿ç”¨éƒ½æ˜¯åœ¨æ‰¾å¯»è¿™ç§å…³ç³»ï¼Œå…³ç³»å¯¹äº†ï¼Œä¸€åˆ‡å°±å¯¹äº†ï¼Œä¸”çœ‹ ä¸Šé¢é”çš„ä¸‰ç§æ–¹å¼éƒ½å¯ä»¥ç”¨ä¸‹å›¾æ¥è¡¨è¾¾: çº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰ï¼Œå°è¯•åŠ é” lock()ï¼Œ åŠ é”æˆåŠŸï¼Œåˆ™è¿›å…¥ä¸´ç•ŒåŒº(å¯¹å…±äº«å˜é‡è¿›è¡Œä¿®æ”¹)ï¼ŒæŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œå®Œä¸´ç•ŒåŒºä»£ç åï¼Œæ‰§è¡Œ unlock()ï¼Œé‡Šæ”¾é”ã€‚é’ˆå¯¹è¿™ä¸ªæ¨¡å‹ï¼Œå¤§å®¶ç»å¸¸ç”¨æŠ¢å å•æ‰€å‘ä½æ¥å½¢å®¹: åœ¨å­¦ä¹  Java æ—©æœŸæˆ‘å°±æ˜¯è¿™æ ·è®°å¿†ä¸ç†è§£é”çš„ï¼Œä½†è½å®åˆ°ä»£ç ä¸Šï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¿½ç•¥ä¸¤ç‚¹: æˆ‘ä»¬é”çš„æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬ä¿æŠ¤çš„åˆæ˜¯ä»€ä¹ˆï¼Ÿ å°†è¿™ä¸¤å¥è¯è”åˆèµ·æ¥å°±æ˜¯ä½ çš„é”èƒ½å¦å¯¹ä¸´ç•ŒåŒºçš„èµ„æºèµ·åˆ°ä¿æŠ¤çš„ä½œç”¨ï¼Ÿæ‰€ä»¥æˆ‘ä»¬è¦å°†ä¸Šé¢çš„æ¨¡å‹è¿›ä¸€æ­¥ç»†åŒ– ç°å®ä¸­ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“è‡ªå·±çš„é”æ¥é”è‡ªå·±éœ€è¦ä¿æŠ¤çš„ä¸œè¥¿ ï¼Œè¿™å¥è¯ç¿»è¯‘æˆä½ çš„è¡ŒåŠ¨è¯­è¨€ä¹‹åä½ å·²ç»æ˜ç¡®çŸ¥é“äº†: ä½ é”çš„æ˜¯ä»€ä¹ˆ ä½ ä¿æŠ¤çš„èµ„æºæ˜¯ä»€ä¹ˆ CPU å¯ä¸åƒæˆ‘ä»¬å¤§è„‘è¿™ä¹ˆæ™ºèƒ½ï¼Œæˆ‘ä»¬è¦æ˜ç¡®è¯´æ˜æˆ‘ä»¬é”çš„æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬è¦ä¿æŠ¤çš„èµ„æºæ˜¯ä»€ä¹ˆï¼Œå®ƒæ‰ä¼šç”¨é”ä¿æŠ¤æˆ‘ä»¬æƒ³è¦ä¿æŠ¤çš„èµ„æº(å…±äº«å˜é‡) æ‹¿ä¸Šå›¾æ¥è¯´ï¼Œèµ„æº R (å…±äº«å˜é‡) å°±æ˜¯æˆ‘ä»¬è¦ä¿æŠ¤çš„èµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦åˆ›å»ºèµ„æº R çš„é”æ¥ä¿æŠ¤èµ„æº Rï¼Œç»†å¿ƒçš„æœ‹å‹å¯èƒ½å‘ç°ä¸Šå›¾å‡ ä¸ªé—®é¢˜: LR å’Œ R ä¹‹é—´æœ‰æ˜ç¡®çš„æŒ‡å‘å…³ç³»æˆ‘ä»¬ç¼–å†™ç¨‹åºæ—¶ï¼Œå¾€å¾€è„‘å­ä¸­çš„æ¨¡å‹æ˜¯å¯¹çš„ï¼Œä½†æ˜¯å¿½ç•¥äº†è¿™ä¸ªæŒ‡å‘å…³ç³»ï¼Œå¯¼è‡´è‡ªå·±çš„é”ä¸èƒ½èµ·åˆ°ä¿æŠ¤èµ„æº R çš„ä½œç”¨(ç”¨åˆ«äººå®¶çš„é”ä¿æŠ¤è‡ªå·±å®¶çš„ä¸œè¥¿æˆ–ç”¨è‡ªå·±å®¶çš„é”ä¿æŠ¤åˆ«äººå®¶çš„ä¸œè¥¿)ï¼Œæœ€ç»ˆå¼•å‘å¹¶å‘ bugï¼Œæ‰€ä»¥åœ¨ä½ å‹¾ç”»è‰å›¾æ—¶ï¼Œè¦æ˜ç¡®æ‰¾åˆ°è¿™ä¸ªå…³ç³» å·¦å›¾ LR è™šçº¿æŒ‡å‘äº†éå…±äº«å˜é‡æˆ‘ä»¬å†™ç¨‹åºçš„æ—¶å€™å¾ˆå®¹æ˜“è¿™ä¹ˆåšï¼Œä¸ç¡®å®šå“ªä¸ªæ˜¯è¦ä¿æŠ¤çš„èµ„æºï¼Œç›´æ¥å¤§æ‚çƒ©ï¼Œç”¨ LR å°†è¦ä¿æŠ¤çš„èµ„æº R å’Œæ²¡å¿…è¦ä¿æŠ¤çš„éå…±äº«å˜é‡ä¸€èµ·ä¿æŠ¤èµ·æ¥äº†ï¼Œä¸¾ä¸¤ä¸ªä¾‹å­æ¥è¯´ä½ å°±æ˜ç™½è¿™ä¹ˆåšçš„åå¤„äº† ç¼–å†™ä¸²è¡Œç¨‹åºæ—¶ï¼Œæ˜¯ä¸å»ºè®® tryâ€¦catch æ•´ä¸ªæ–¹æ³•çš„ï¼Œè¿™æ ·å¦‚æœå‡ºç°é—®æ˜¯å¾ˆéš¾å®šä½çš„ï¼Œé“ç†ä¸€æ ·ï¼Œæˆ‘ä»¬è¦ç”¨é”ç²¾ç¡®çš„é”ä½æˆ‘ä»¬è¦ä¿æŠ¤çš„èµ„æºå°±å¤Ÿäº†ï¼Œå…¶ä»–æ— æ„ä¹‰çš„èµ„æºæ˜¯ä¸è¦é”çš„ é”ä¿æŠ¤çš„ä¸œè¥¿è¶Šå¤šï¼Œä¸´ç•ŒåŒºå°±è¶Šå¤§ï¼Œä¸€ä¸ªçº¿ç¨‹ä»èµ°å…¥ä¸´ç•ŒåŒºåˆ°èµ°å‡ºä¸´ç•ŒåŒºçš„æ—¶é—´å°±è¶Šé•¿ï¼Œè¿™å°±è®©å…¶ä»–çº¿ç¨‹ç­‰å¾…çš„æ—¶é—´è¶Šä¹…ï¼Œè¿™æ ·å¹¶å‘çš„æ•ˆç‡å°±æœ‰æ‰€ä¸‹é™ï¼Œå…¶å®è¿™æ˜¯æ¶‰åŠåˆ°é”ç²’åº¦çš„é—®é¢˜ï¼Œåç»­ä¹Ÿéƒ½ä¼šåšç›¸å…³è¯´æ˜ ä½œä¸ºç¨‹åºçŒ¿è¿˜æ˜¯ç®€å•æ‹¿ä»£ç è¯´æ˜ä¸€ä¸‹å¿ƒé‡Œæ¯”è¾ƒè¸å®ï¼Œä¸”çœ‹: 123456789101112131415161718public class ValidLock &#123; private static final Object object = new Object(); private int count; public synchronized void badSync()&#123; //å…¶ä»–ä¸å…±äº«å˜é‡countæ— å…³çš„ä¸šåŠ¡é€»è¾‘ count++; &#125; public void goodSync()&#123; //å…¶ä»–ä¸å…±äº«å˜é‡countæ— å…³çš„ä¸šåŠ¡é€»è¾‘ synchronized (object)&#123; count++; &#125; &#125;&#125; è¿™é‡Œå¹¶ä¸æ˜¯è¯´ synchronized æ”¾åœ¨æ–¹æ³•ä¸Šä¸å¥½ï¼Œåªæ˜¯æé†’å¤§å®¶ç”¨åˆé€‚çš„é”çš„ç²’åº¦æ‰ä¼šæ›´é«˜æ•ˆ åœ¨è®¡æ•°å™¨ç¨‹åºä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸è¿™ä¹ˆå†™: 123456789101112public class SafeCounter &#123; private int count; public synchronized void counter()&#123; count++; &#125; public synchronized int getCount()&#123; return count; &#125;&#125; ä¸‹å›¾å°±æ˜¯ä¸Šé¢ç¨‹åºçš„æ¨¡å‹å±•ç¤º: è¿™é‡Œæˆ‘ä»¬é”çš„æ˜¯ thisï¼Œå¯ä»¥ä¿æŠ¤ this.countã€‚ä½†æœ‰äº›åŒå­¦è®¤ä¸º getCount æ–¹æ³•æ²¡å¿…è¦åŠ  synchronized å…³é”®å­—ï¼Œå› ä¸ºæ˜¯è¯»çš„æ“ä½œï¼Œä¸ä¼šå¯¹å…±äº«å˜é‡åšä¿®æ”¹ï¼Œå¦‚æœä¸åŠ ä¸Š synchronized å…³é”®å­—ï¼Œå°±è¿èƒŒäº†æˆ‘ä»¬ä¸Šä¸€ç¯‡æ–‡ç«  happens-before è§„åˆ™ä¸­çš„ç›‘è§†å™¨é”è§„åˆ™: å¯¹ä¸€ä¸ªé”çš„è§£é” happens-before äºéšåå¯¹è¿™ä¸ªé”çš„åŠ é”ä¹Ÿå°±æ˜¯è¯´å¯¹ count çš„å†™å¾ˆå¯èƒ½å¯¹ count çš„è¯»ä¸å¯è§ï¼Œä¹Ÿå°±å¯¼è‡´è„è¯» ä¸Šé¢æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ª this é”æ˜¯å¯ä»¥ä¿æŠ¤å¤šä¸ªèµ„æºçš„ï¼Œé‚£ç”¨å¤šä¸ªä¸åŒçš„é”ä¿æŠ¤ä¸€ä¸ªèµ„æºå¯ä»¥å—ï¼Ÿæ¥çœ‹ä¸€æ®µç¨‹åº: 123456789101112public class UnsafeCounter &#123; private static int count; public synchronized void counter()&#123; count++; &#125; public static synchronized int calc()&#123; return count++; &#125;&#125; çå¤§çœ¼ç›ä»”ç»†çœ‹ï¼Œä¸€ä¸ªé”çš„æ˜¯ thisï¼Œä¸€ä¸ªé”çš„æ˜¯ UnsafeCounter.class, ä»–ä»¬éƒ½æƒ³ä¿æŠ¤å…±äº«å˜é‡ countï¼Œä½ è§‰å¾—å¦‚ä½•ï¼Ÿä¸‹å›¾å°±æ˜¯è¡Œé¢ç¨‹åºçš„æ¨¡å‹å±•ç¤º: ä¸¤ä¸ªä¸´ç•ŒåŒºæ˜¯ç”¨ä¸¤ä¸ªä¸åŒçš„é”æ¥ä¿æŠ¤çš„ï¼Œæ‰€ä»¥ä¸´ç•ŒåŒºæ²¡æœ‰äº’æ–¥å…³ç³»ï¼Œä¹Ÿå°±ä¸èƒ½ä¿æŠ¤ countï¼Œæ‰€ä»¥è¿™æ ·åŠ é”æ˜¯æ— æ„ä¹‰çš„ æ€»ç»“ è§£å†³åŸå­æ€§é—®é¢˜ï¼Œå°±æ˜¯è¦äº’æ–¥ï¼Œå°±æ˜¯è¦ä¿è¯ä¸­é—´çŠ¶æ€å¯¹å¤–ä¸å¯è§ é”æ˜¯è§£å†³åŸå­æ€§é—®é¢˜çš„å…³é”®ï¼Œæ˜ç¡®çŸ¥é“æˆ‘ä»¬é”çš„æ˜¯ä»€ä¹ˆï¼Œè¦ä¿æŠ¤çš„èµ„æºæ˜¯ä»€ä¹ˆï¼Œæ›´é‡è¦çš„è¦çŸ¥é“ä½ çš„é”èƒ½å¦ä¿æŠ¤è¿™ä¸ªå—ä¿æŠ¤çš„èµ„æº(å›¾ä¸­çš„ç®­å¤´æŒ‡å‘) æœ‰æ•ˆçš„ä¸´ç•ŒåŒºæ˜¯ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£ï¼Œå¤šä¸ªä¸´ç•ŒåŒºä¿æŠ¤ä¸€ä¸ªèµ„æºï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªèµ„æºæœ‰å¤šä¸ªå¹¶è¡Œçš„å…¥å£å’Œå¤šä¸ªå‡ºå£ï¼Œè¿™å°±æ²¡æœ‰èµ·åˆ°äº’æ–¥çš„ä¿æŠ¤ä½œç”¨ï¼Œä¸´ç•ŒåŒºå½¢åŒè™šè®¾ é”è‡ªå·±å®¶é—¨èƒ½ä¿æŠ¤èµ„æºå°±æ²¡å¿…è¦é”æ•´ä¸ªå°åŒºï¼Œå¦‚æœé”äº†æ•´ä¸ªå°åŒºï¼Œè¿™ä¸¥é‡å½±å“å…¶ä»–ä¸šä¸»çš„æ´»åŠ¨(é”ç²’åº¦çš„é—®é¢˜) æœ¬æ–‡ä»¥ synchronized é”ä¸¾ä¾‹æ¥è¯´æ˜å¦‚ä½•è§£å†³åŸå­æ€§é—®é¢˜ï¼Œä¸»è¦æ˜¯å¸®åŠ©å¤§å®¶å»ºç«‹å®è§‚çš„ç†å¿µï¼Œç”¨äºè§£å†³åŸå­æ€§é—®é¢˜ï¼Œè¿™æ ·åç»­ä½ çœ‹åˆ°æ— è®ºä»€ä¹ˆé”ï¼Œåªè¦è„‘æµ·ä¸­å›æƒ³èµ·æœ¬èŠ‚è¯´æ˜çš„æ¨¡å‹ï¼Œä½ ä¼šå‘ç°éƒ½æ˜¯æ¢æ±¤ä¸æ¢è¯ï¼Œå­¦ä¹ èµ·æ¥å°±éå¸¸è½»æ¾äº†. åˆ°è¿™é‡Œå¹¶å‘çš„ä¸‰å¤§é—®é¢˜ æœ‰åºæ€§ï¼Œå¯è§æ€§ï¼ŒåŸå­æ€§éƒ½æœ‰äº†è§£å†³æ–¹æ¡ˆï¼Œè¿™æ˜¯è¿œçœ‹å¹¶å‘ï¼Œè®©å¤§å®¶æœ‰äº†å®è§‚çš„æ¦‚å¿µï¼›ä½†é¢è¯•å’Œå®æˆ˜éƒ½æ˜¯è®²æ±‚ç»†èŠ‚çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç”±è¿œåŠè¿‘ï¼Œé€æ­¥çœ‹å¹¶å‘çš„ç»†èŠ‚ï¼Œé¡ºå¸¦è¯´æ˜é‚£äº›é¢è¯•å®˜ç»å¸¸ä¼šé—®åˆ°çš„é—®é¢˜ çµé­‚è¿½é—® å¤šä¸ªé”é”ä¸€ä¸ªèµ„æºä¸€å®šä¼šæœ‰é—®é¢˜å—ï¼Ÿ ä»€ä¹ˆæ—¶å€™éœ€è¦é”å°åŒºï¼Œè€Œä¸èƒ½é”æŸä¸€æˆ·å‘¢ï¼Ÿ é“¶è¡Œè½¬è´¦ï¼Œä¸¤äººäº’è½¬å’Œåˆ«äººç»™è‡ªå·±è½¬ï¼Œç”¨ä»€ä¹ˆæ ·çš„é”ç²’åº¦åˆé€‚å‘¢ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® å¹¶å‘Bugä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ å¯è§æ€§æœ‰åºæ€§ï¼ŒHappens-beforeæ¥æå®š åŸºç¡€é¢è¯•ï¼Œä¸ºä»€ä¹ˆé¢è¯•å®˜æ€»å–œæ¬¢é—®Stringï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"},{"name":"é”","slug":"é”","permalink":"https://dayarch.top/tags/%E9%94%81/"}]},{"title":"æœ‰åºæ€§å¯è§æ€§ï¼ŒHappens-beforeæ¥æå®š","slug":"æœ‰åºæ€§å¯è§æ€§ï¼ŒHappens-beforeæ¥æå®š","date":"2019-09-12T10:24:22.000Z","updated":"2020-03-04T03:44:04.638Z","comments":true,"path":"/p/java-concurrency-happens-before-rule.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-happens-before-rule.html","excerpt":"å†™åœ¨å‰é¢ ä¸Šä¸€ç¯‡æ–‡ç« å¹¶å‘ Bug ä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ è°ˆåˆ°äº†å¯è§æ€§/åŸå­æ€§/æœ‰åºæ€§ä¸‰ä¸ªé—®é¢˜ï¼Œè¿™äº›é—®é¢˜é€šå¸¸è¿èƒŒæˆ‘ä»¬çš„ç›´è§‰å’Œæ€è€ƒæ¨¡å¼ï¼Œä¹Ÿå°±å¯¼è‡´äº†å¾ˆå¤šå¹¶å‘ Bug * ä¸ºäº†è§£å†³ CPUï¼Œå†…å­˜ï¼ŒIO çš„çŸ­æ¿ï¼Œå¢åŠ äº†ç¼“å­˜ï¼Œä½†è¿™å¯¼è‡´äº†å¯è§æ€§é—®é¢˜ * ç¼–è¯‘å™¨/å¤„ç†å™¨æ“…è‡ªä¼˜åŒ– ( Javaä»£ç åœ¨ç¼–è¯‘åä¼šå˜æˆ Java å­—èŠ‚ç , å­—èŠ‚ç è¢«ç±»åŠ è½½å™¨åŠ è½½åˆ° JVM é‡Œ, JVM æ‰§è¡Œå­—èŠ‚ç , æœ€ç»ˆéœ€è¦è½¬åŒ–ä¸ºæ±‡ç¼–æŒ‡ä»¤åœ¨ CPU ä¸Šæ‰§è¡Œ) ï¼Œå¯¼è‡´æœ‰åºæ€§é—®é¢˜ åˆè¡·æ˜¯å¥½çš„ï¼Œä½†å¼•å‘äº†æ–°é—®é¢˜ï¼Œæœ€æœ‰æ•ˆçš„åŠæ³•å°±ç¦æ­¢ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–ï¼Œé—®é¢˜è™½ç„¶èƒ½è§£å†³ï¼Œä½†ã€Œåˆå›åˆ°æœ€åˆçš„èµ·ç‚¹ï¼Œå‘†å‘†åœ°ç«™åœ¨é•œå­å‰ã€æ˜¯å¾ˆå°´å°¬çš„ï¼Œæˆ‘ä»¬ç¨‹åºçš„æ€§èƒ½å°±","text":"å†™åœ¨å‰é¢ä¸Šä¸€ç¯‡æ–‡ç« å¹¶å‘ Bug ä¹‹æºæœ‰ä¸‰ï¼Œè¯·çå¤§çœ¼ç›çœ‹æ¸…å®ƒä»¬ è°ˆåˆ°äº†å¯è§æ€§/åŸå­æ€§/æœ‰åºæ€§ä¸‰ä¸ªé—®é¢˜ï¼Œè¿™äº›é—®é¢˜é€šå¸¸è¿èƒŒæˆ‘ä»¬çš„ç›´è§‰å’Œæ€è€ƒæ¨¡å¼ï¼Œä¹Ÿå°±å¯¼è‡´äº†å¾ˆå¤šå¹¶å‘ Bug ä¸ºäº†è§£å†³ CPUï¼Œå†…å­˜ï¼ŒIO çš„çŸ­æ¿ï¼Œå¢åŠ äº†ç¼“å­˜ï¼Œä½†è¿™å¯¼è‡´äº†å¯è§æ€§é—®é¢˜ ç¼–è¯‘å™¨/å¤„ç†å™¨æ“…è‡ªä¼˜åŒ– ( Javaä»£ç åœ¨ç¼–è¯‘åä¼šå˜æˆ Java å­—èŠ‚ç , å­—èŠ‚ç è¢«ç±»åŠ è½½å™¨åŠ è½½åˆ° JVM é‡Œ, JVM æ‰§è¡Œå­—èŠ‚ç , æœ€ç»ˆéœ€è¦è½¬åŒ–ä¸ºæ±‡ç¼–æŒ‡ä»¤åœ¨ CPU ä¸Šæ‰§è¡Œ) ï¼Œå¯¼è‡´æœ‰åºæ€§é—®é¢˜ åˆè¡·æ˜¯å¥½çš„ï¼Œä½†å¼•å‘äº†æ–°é—®é¢˜ï¼Œæœ€æœ‰æ•ˆçš„åŠæ³•å°±ç¦æ­¢ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–ï¼Œé—®é¢˜è™½ç„¶èƒ½è§£å†³ï¼Œä½†ã€Œåˆå›åˆ°æœ€åˆçš„èµ·ç‚¹ï¼Œå‘†å‘†åœ°ç«™åœ¨é•œå­å‰ã€æ˜¯å¾ˆå°´å°¬çš„ï¼Œæˆ‘ä»¬ç¨‹åºçš„æ€§èƒ½å°±å ªå¿§äº†. è§£å†³æ–¹æ¡ˆ ä½œä¸ºæˆ‘ä»¬ç¨‹åºçŒ¿ä¸æƒ³å†™å‡º bug å½±å“ KPIï¼Œæ‰€ä»¥å¸Œæœ›å†…å­˜æ¨¡å‹æ˜“äºç†è§£ã€æ˜“äºç¼–ç¨‹ã€‚è¿™å°±éœ€è¦åŸºäºä¸€ä¸ªå¼ºå†…å­˜æ¨¡å‹æ¥ç¼–å†™ä»£ç  ä½œä¸ºç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¸æƒ³è®©å¤–äººè¯´å®ƒå¤„ç†é€Ÿåº¦å¾ˆæ…¢ï¼Œæ‰€ä»¥å¸Œæœ›å†…å­˜æ¨¡å‹å¯¹ä»–ä»¬æŸç¼šè¶Šå°‘è¶Šå¥½ï¼Œå¯ä»¥ç”±ä»–ä»¬æ“…è‡ªä¼˜åŒ–ï¼Œè¿™å°±éœ€è¦åŸºäºä¸€ä¸ªå¼±å†…å­˜æ¨¡å‹ ä¿—è¯è¯´:ã€Œæ²¡æœ‰ä»€ä¹ˆäº‹æ˜¯å¼€ä¼šè§£å†³ä¸äº†çš„ï¼Œå¦‚æœæœ‰ï¼Œé‚£å°±å†å¼€ä¸€æ¬¡ã€ğŸ˜‚ JSR-133 çš„ä¸“å®¶ä»¬å°±æœ‰äº†æ–°æƒ³æ³•ï¼Œæ—¢ç„¶ä¸èƒ½å®Œå…¨ç¦æ­¢ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–ï¼Œé‚£å°±æŒ‰éœ€ç¦ç”¨ç¼“å­˜å’Œç¼–è¯‘ä¼˜åŒ–ï¼ŒæŒ‰éœ€å°±æ˜¯è¦åŠ ä¸€äº›çº¦æŸï¼Œçº¦æŸä¸­å°±åŒ…æ‹¬äº†ä¸Šä¸€ç¯‡æ–‡ç« ç®€å•æåˆ°è¿‡çš„ volatileï¼Œsynchronizedï¼Œfinal ä¸‰ä¸ªå…³é”®å­—ï¼ŒåŒæ—¶è¿˜æœ‰ä½ å¯èƒ½å¬è¿‡çš„ Happens-Before åŸåˆ™(åŒ…å«å¯è§æ€§å’Œæœ‰åºæ€§çš„çº¦æŸ)ï¼ŒHappens-before è§„åˆ™ä¹Ÿæ˜¯æœ¬ç« çš„ä¸»è¦å†…å®¹ ä¸ºäº†æ»¡è¶³äºŒè€…çš„å¼ºçƒˆéœ€æ±‚ï¼Œç…§é¡¾åˆ°åŒæ–¹çš„æƒ…ç»ªï¼Œäºæ˜¯ä¹: JMM å°±å¯¹ç¨‹åºçŒ¿è¯´äº†ä¸€ä¸ªå–„æ„çš„è°è¨€: ã€Œä¼šä¸¥æ ¼éµå®ˆ Happpen-Befores è§„åˆ™ï¼Œä¸ä¼šé‡æ’åºã€è®©ç¨‹åºçŒ¿æ”¾å¿ƒï¼Œç§ä¸‹å´æœ‰è‡ªå·±çš„ç­–ç•¥: å¯¹äºä¼šæ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„é‡æ’åº,JMMè¦æ±‚ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¿…é¡»ç¦æ­¢è¿™ç§é‡æ’åºã€‚ å¯¹äºä¸ä¼šæ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„é‡æ’åº, JMMå¯¹ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¸åšè¦æ±‚ (JMMå…è®¸è¿™ç§é‡æ’åº)ã€‚ æˆ‘ä»¬æ¥ç”¨ä¸ªå›¾è¯´æ˜ä¸€ä¸‹: è¿™å°±æ˜¯é‚£ä¸ªå–„æ„çš„è°è¨€ï¼Œè™½æ˜¯è°è¨€ï¼Œä½†è¿˜æ˜¯ç…§é¡¾åˆ°äº†ç¨‹åºçŒ¿çš„åˆ©ç›Šï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦äº†è§£ happens-before è§„åˆ™å°±èƒ½å¾—åˆ°ä¿è¯ (å›¾ç”»äº†å¥½ä¹…ï¼Œä¸çŸ¥é“æ˜¯å¦è¯´æ˜äº†è°è¨€çš„æ‰€åœ¨ğŸ˜…ï¼Œæ¬¢è¿ç•™è¨€) Happens-beforeHappens-before è§„åˆ™ä¸»è¦ç”¨æ¥çº¦æŸä¸¤ä¸ªæ“ä½œï¼Œä¸¤ä¸ªæ“ä½œä¹‹é—´å…·æœ‰ happens-before å…³ç³», å¹¶ä¸æ„å‘³ç€å‰ä¸€ä¸ªæ“ä½œå¿…é¡»è¦åœ¨åä¸€ä¸ªæ“ä½œä¹‹å‰æ‰§è¡Œï¼Œhappens-before ä»…ä»…è¦æ±‚å‰ä¸€ä¸ªæ“ä½œ(æ‰§è¡Œçš„ç»“æœ)å¯¹åä¸€ä¸ªæ“ä½œå¯è§, (the first is visible to and ordered before the second) è¯´äº†è¿™ä¹ˆå¤šï¼Œå…ˆæ¥çœ‹ä¸€å°æ®µä»£ç å¸¦ä½ é€æ­¥èµ°è¿› Happen-Befores åŸåˆ™ï¼Œçœ‹çœ‹æ˜¯æ€æ ·ç”¨è¯¥åŸåˆ™è§£å†³ å¯è§æ€§ å’Œ æœ‰åºæ€§ çš„é—®é¢˜: 12345678910111213class ReorderExample &#123; int x = 0; boolean flag = false; public void writer() &#123; x = 42; //1 flag = true; //2 &#125; public void reader() &#123; if (flag) &#123; //3 System.out.println(x); //4 &#125; &#125;&#125; å‡è®¾ A çº¿ç¨‹æ‰§è¡Œ writer æ–¹æ³•ï¼ŒB çº¿ç¨‹æ‰§è¡Œ reader æ–¹æ³•ï¼Œæ‰“å°å‡ºæ¥çš„ x å¯èƒ½ä¼šæ˜¯ 0ï¼Œä¸Šä¸€ç¯‡æ–‡ç« è¯´æ˜è¿‡: å› ä¸ºä»£ç  1 å’Œ 2 æ²¡æœ‰æ•°æ®ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥å¯èƒ½è¢«é‡æ’åº 12flag = true; //2x = 42; //1 æ‰€ä»¥ï¼Œçº¿ç¨‹ A å°† flag = true å†™å…¥ä½†æ²¡æœ‰ä¸º x é‡æ–°èµ‹å€¼æ—¶ï¼Œçº¿ç¨‹ B å¯èƒ½å°±å·²ç»æ‰“å°äº† x æ˜¯ 0 é‚£ä¹ˆä¸º flag åŠ ä¸Š volatile å…³é”®å­—è¯•ä¸€ä¸‹: 1volatile boolean flag = false; å³ä¾¿åŠ ä¸Šäº† volatile å…³é”®å­—ï¼Œè¿™ä¸ªé—®é¢˜åœ¨ java1.5 ä¹‹å‰è¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼Œä½† java1.5 å’Œå…¶ä¹‹åçš„ç‰ˆæœ¬å¯¹ volatile è¯­ä¹‰åšäº†å¢å¼ºï¼Œé—®é¢˜å¾—ä»¥è§£å†³ï¼Œè¿™å°±ç¦»ä¸å¼€ Happens-before è§„åˆ™çš„çº¦æŸäº†ï¼Œæ€»å…±æœ‰ 6 ä¸ªè§„åˆ™ï¼Œä¸”çœ‹ ç¨‹åºé¡ºåºæ€§è§„åˆ™ ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸ªæ“ä½œ, happens-before äºè¯¥çº¿ç¨‹ä¸­çš„ä»»æ„åç»­æ“ä½œç¬¬ä¸€æ„Ÿè§‰è¿™ä¸ªåŸåˆ™æ˜¯ä¸€ä¸ªåœ¨ç†æƒ³çŠ¶æ€ä¸‹çš„â€åºŸè¯â€ï¼Œå¹¶ä¸”å’Œä¸Šé¢æåˆ°çš„ä¼šå‡ºç°é‡æ’åºçš„æƒ…å†µæ˜¯çŸ›ç›¾çš„ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ“ä½œï¼Œå…¶å®éšå«äº†ã€Œas-if-serialã€è¯­ä¹‰: è¯´ç™½äº†å°±æ˜¯åªè¦æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ï¼Œæ— è®ºæ€ä¹ˆâ€æ’åºâ€ï¼Œéƒ½æ˜¯å¯¹çš„ è¿™ä¸ªè§„åˆ™æ˜¯ä¸€ä¸ªåŸºç¡€è§„åˆ™ï¼Œhappens-before æ˜¯å¤šçº¿ç¨‹çš„è§„åˆ™ï¼Œæ‰€ä»¥è¦å’Œå…¶ä»–è§„åˆ™çº¦æŸåœ¨ä¸€èµ·æ‰èƒ½ä½“ç°å‡ºå®ƒçš„é¡ºåºæ€§ï¼Œåˆ«ç€æ€¥ï¼Œç»§ç»­å‘ä¸‹çœ‹ volatileå˜é‡è§„åˆ™ å¯¹ä¸€ä¸ª volatile åŸŸçš„å†™, happens-before äºä»»æ„åç»­å¯¹è¿™ä¸ª volatile åŸŸçš„è¯» æˆ‘å°†ä¸Šé¢çš„ç¨‹åºæ·»åŠ ä¸¤è¡Œä»£ç ä½œè¯´æ˜: 12345678910111213141516171819public class ReorderExample &#123; private int x = 0; private int y = 1; private volatile boolean flag = false; public void writer()&#123; x = 42; //1 y = 50; //2 flag = true; //3 &#125; public void reader()&#123; if (flag)&#123; //4 System.out.println(\"x:\" + x); //5 System.out.println(\"y:\" + y); //6 &#125; &#125;&#125; è¿™é‡Œæ¶‰åŠåˆ°äº† volatile çš„å†…å­˜å¢å¼ºè¯­ä¹‰ï¼Œå…ˆæ¥çœ‹ä¸ªè¡¨æ ¼: èƒ½å¦é‡æ’åº ç¬¬äºŒä¸ªæ“ä½œ ç¬¬äºŒä¸ªæ“ä½œ ç¬¬äºŒä¸ªæ“ä½œ ç¬¬ä¸€ä¸ªæ“ä½œ æ™®é€šè¯»/å†™ volatile è¯» volatile å†™ æ™®é€šè¯»/å†™ - - NO volatile è¯» NO NO NO volatile å†™ - NO NO ä»è¿™ä¸ªè¡¨æ ¼ æœ€åä¸€åˆ— å¯ä»¥çœ‹å‡º: å¦‚æœç¬¬äºŒä¸ªæ“ä½œä¸º volatile å†™ï¼Œä¸ç®¡ç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼Œè¿™å°±ç¡®ä¿äº† volatile å†™ä¹‹å‰çš„æ“ä½œä¸ä¼šè¢«é‡æ’åºåˆ° volatile å†™ä¹‹åæ‹¿ä¸Šé¢çš„ä»£ç æ¥è¯´ï¼Œä»£ç  1 å’Œ 2 ä¸ä¼šè¢«é‡æ’åºåˆ°ä»£ç  3 çš„åé¢ï¼Œä½†ä»£ç  1 å’Œ 2 å¯èƒ½è¢«é‡æ’åº (æ²¡æœ‰ä¾èµ–ä¹Ÿä¸ä¼šå½±å“åˆ°æ‰§è¡Œç»“æœ)ï¼Œè¯´åˆ°è¿™é‡Œå’Œ ç¨‹åºé¡ºåºæ€§è§„åˆ™æ˜¯ä¸æ˜¯å°±å·²ç»å…³è”èµ·æ¥äº†å‘¢ï¼Ÿ ä»è¿™ä¸ªè¡¨æ ¼çš„ å€’æ•°ç¬¬äºŒè¡Œ å¯ä»¥çœ‹å‡º: å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œä¸º volatile è¯»ï¼Œä¸ç®¡ç¬¬äºŒä¸ªæ“ä½œæ˜¯ä»€ä¹ˆï¼Œéƒ½ä¸èƒ½é‡æ’åºï¼Œè¿™ç¡®ä¿äº† volatile è¯»ä¹‹åçš„æ“ä½œä¸ä¼šè¢«é‡æ’åºåˆ° volatile è¯»ä¹‹å‰æ‹¿ä¸Šé¢çš„ä»£ç æ¥è¯´ï¼Œä»£ç  4 æ˜¯è¯»å– volatile å˜é‡ï¼Œä»£ç  5 å’Œ 6 ä¸ä¼šè¢«é‡æ’åºåˆ°ä»£ç  4 ä¹‹å‰ volatile å†…å­˜è¯­ä¹‰çš„å®ç°æ˜¯åº”ç”¨åˆ°äº† ã€Œå†…å­˜å±éšœã€ï¼Œå› ä¸ºè¿™å®Œå…¨å¤Ÿå•ç‹¬å†™ä¸€ç« çš„å†…å®¹ï¼Œè¿™é‡Œä¸ºäº†ä¸æ©ç›–ä¸»è§’ Happens-before çš„å…‰ç¯ï¼Œä¿æŒç†è§£ Happens-before çš„è¿ç»­æ€§ï¼Œå…ˆä¸åšè¿‡å¤šè¯´æ˜ åˆ°è¿™é‡Œï¼Œçœ‹è¿™ä¸ªè§„åˆ™ï¼Œè²Œä¼¼ä¹Ÿæ²¡è§£å†³å•¥é—®é¢˜ï¼Œå› ä¸ºå®ƒè¿˜è¦è”åˆç¬¬ä¸‰ä¸ªè§„åˆ™æ‰èµ·ä½œç”¨ ä¼ é€’æ€§è§„åˆ™ å¦‚æœ A happens-before B, ä¸” B happens-before C, é‚£ä¹ˆ A happens-before Cç›´æ¥ä¸Šå›¾è¯´æ˜ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­ ä»ä¸Šå›¾å¯ä»¥çœ‹å‡º x =42 å’Œ y = 50 Happens-before flag = true, è¿™æ˜¯è§„åˆ™ 1 å†™å˜é‡(ä»£ç  3) flag=true Happens-before è¯»å˜é‡(ä»£ç  4) if(flag)ï¼Œè¿™æ˜¯è§„åˆ™ 2 æ ¹æ®è§„åˆ™ 3ä¼ é€’æ€§è§„åˆ™ï¼Œx =42 Happens-before è¯»å˜é‡ if(flag) è°œæ¡ˆè¦æ­æ™“äº†: å¦‚æœçº¿ç¨‹ B è¯»åˆ°äº† flag æ˜¯ trueï¼Œé‚£ä¹ˆ x =42 å’Œ y = 50 å¯¹çº¿ç¨‹ B å°±ä¸€å®šå¯è§äº†ï¼Œè¿™å°±æ˜¯ Java1.5 çš„å¢å¼º (ä¹‹å‰ç‰ˆæœ¬æ˜¯å¯ä»¥æ™®é€šå˜é‡å†™å’Œ volatile å˜é‡å†™çš„é‡æ’åºçš„) é€šå¸¸ä¸Šé¢ä¸‰ä¸ªè§„åˆ™æ˜¯ä¸€ç§è”åˆçº¦æŸï¼Œåˆ°è¿™é‡Œä½ æ‡‚äº†å—ï¼Ÿè§„åˆ™è¿˜æ²¡å®Œï¼Œç»§ç»­çœ‹ ç›‘è§†å™¨é”è§„åˆ™ å¯¹ä¸€ä¸ªé”çš„è§£é” happens-before äºéšåå¯¹è¿™ä¸ªé”çš„åŠ é” è¿™ä¸ªè§„åˆ™æˆ‘è§‰å¾—ä½ åº”è¯¥æœ€ç†Ÿæ‚‰äº†ï¼Œå°±æ˜¯è§£é‡Š synchronized å…³é”®å­—çš„ï¼Œæ¥çœ‹ 1234567891011121314151617public class SynchronizedExample &#123; private int x = 0; public void synBlock()&#123; // 1.åŠ é” synchronized (SynchronizedExample.class)&#123; x = 1; // å¯¹xèµ‹å€¼ &#125; // 3.è§£é” &#125; // 1.åŠ é” public synchronized void synMethod()&#123; x = 2; // å¯¹xèµ‹å€¼ &#125; // 3. è§£é”&#125; å…ˆè·å–é”çš„çº¿ç¨‹ï¼Œå¯¹ x èµ‹å€¼ä¹‹åé‡Šæ”¾é”ï¼Œå¦å¤–ä¸€ä¸ªå†è·å–é”ï¼Œä¸€å®šèƒ½çœ‹åˆ°å¯¹ x èµ‹å€¼çš„æ”¹åŠ¨ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œè¯·å°ä¼™ä¼´ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹ä¸Šé¢ç¨‹åºï¼Œçœ‹åŒæ­¥å—å’ŒåŒæ­¥æ–¹æ³•è¢«è½¬æ¢æˆæ±‡ç¼–æŒ‡ä»¤æœ‰ä½•ä¸åŒï¼Ÿ 1javap -c -v SynchronizedExample è¿™å’Œ synchronized çš„è¯­ä¹‰ç›¸å…³ï¼Œå°ä¼™ä¼´å¯ä»¥å…ˆè‡ªè¡Œäº†è§£ä¸€ä¸‹ï¼Œé”çš„å†…å®¹æ—¶ä¼šåšè¯¦ç»†è¯´æ˜ start()è§„åˆ™ å¦‚æœçº¿ç¨‹ A æ‰§è¡Œæ“ä½œ ThreadB.start() (å¯åŠ¨çº¿ç¨‹B), é‚£ä¹ˆ A çº¿ç¨‹çš„ ThreadB.start() æ“ä½œ happens-before äºçº¿ç¨‹ B ä¸­çš„ä»»æ„æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»çº¿ç¨‹ A å¯åŠ¨å­çº¿ç¨‹ B åï¼Œå­çº¿ç¨‹ B èƒ½çœ‹åˆ°ä¸»çº¿ç¨‹åœ¨å¯åŠ¨å­çº¿ç¨‹ B å‰çš„æ“ä½œï¼Œçœ‹ä¸ªç¨‹åºå°±ç§’æ‡‚äº† 123456789101112131415161718192021222324public class StartExample &#123; private int x = 0; private int y = 1; private boolean flag = false; public static void main(String[] args) throws InterruptedException &#123; StartExample startExample = new StartExample(); Thread thread1 = new Thread(startExample::writer, \"çº¿ç¨‹1\"); startExample.x = 10; startExample.y = 20; startExample.flag = true; thread1.start(); System.out.println(\"ä¸»çº¿ç¨‹ç»“æŸ\"); &#125; public void writer()&#123; System.out.println(\"x:\" + x ); System.out.println(\"y:\" + y ); System.out.println(\"flag:\" + flag ); &#125;&#125; è¿è¡Œç»“æœ: 123456ä¸»çº¿ç¨‹ç»“æŸx:10y:20flag:trueProcess finished with exit code 0 çº¿ç¨‹ 1 çœ‹åˆ°äº†ä¸»çº¿ç¨‹è°ƒç”¨ thread1.start() ä¹‹å‰çš„æ‰€æœ‰èµ‹å€¼ç»“æœï¼Œè¿™é‡Œæ²¡æœ‰æ‰“å°ã€Œä¸»çº¿ç¨‹ç»“æŸã€ï¼Œä½ çŸ¥é“ä¸ºä»€ä¹ˆå—ï¼Ÿè¿™ä¸ªå®ˆæŠ¤çº¿ç¨‹çŸ¥è¯†æœ‰å…³ç³» join()è§„åˆ™ å¦‚æœçº¿ç¨‹ A æ‰§è¡Œæ“ä½œ ThreadB.join() å¹¶æˆåŠŸè¿”å›, é‚£ä¹ˆçº¿ç¨‹ B ä¸­çš„ä»»æ„æ“ä½œ happens-before äºçº¿ç¨‹ A ä» ThreadB.join() æ“ä½œæˆåŠŸè¿”å›ï¼Œå’Œ start è§„åˆ™åˆšå¥½ç›¸åï¼Œä¸»çº¿ç¨‹ A ç­‰å¾…å­çº¿ç¨‹ B å®Œæˆï¼Œå½“å­çº¿ç¨‹ B å®Œæˆåï¼Œä¸»çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å­çº¿ç¨‹ B çš„èµ‹å€¼æ“ä½œï¼Œå°†ç¨‹åºåšä¸ªå°æ”¹åŠ¨ï¼Œä½ ä¹Ÿä¼šç§’æ‡‚çš„ 12345678910111213141516171819202122232425public class JoinExample &#123; private int x = 0; private int y = 1; private boolean flag = false; public static void main(String[] args) throws InterruptedException &#123; JoinExample joinExample = new JoinExample(); Thread thread1 = new Thread(joinExample::writer, \"çº¿ç¨‹1\"); thread1.start(); thread1.join(); System.out.println(\"x:\" + joinExample.x ); System.out.println(\"y:\" + joinExample.y ); System.out.println(\"flag:\" + joinExample.flag ); System.out.println(\"ä¸»çº¿ç¨‹ç»“æŸ\"); &#125; public void writer()&#123; this.x = 100; this.y = 200; this.flag = true; &#125;&#125; è¿è¡Œç»“æœ: 123456x:100y:200flag:trueä¸»çº¿ç¨‹ç»“æŸProcess finished with exit code 0 ã€Œä¸»çº¿ç¨‹ç»“æŸã€è¿™å‡ ä¸ªå­—æ‰“å°å‡ºæ¥å–½ï¼Œä¾æ—§å’Œçº¿ç¨‹ä½•æ—¶é€€å‡ºæœ‰å…³ç³» æ€»ç»“ Happens-before é‡ç‚¹æ˜¯è§£å†³å‰ä¸€ä¸ªæ“ä½œç»“æœå¯¹åä¸€ä¸ªæ“ä½œå¯è§ï¼Œç›¸ä¿¡åˆ°è¿™é‡Œï¼Œä½ å·²ç»å¯¹ Happens-before è§„åˆ™æœ‰æ‰€äº†è§£ï¼Œè¿™äº›è§„åˆ™è§£å†³äº†å¤šçº¿ç¨‹ç¼–ç¨‹çš„å¯è§æ€§ä¸æœ‰åºæ€§é—®é¢˜ï¼Œä½†è¿˜æ²¡æœ‰å®Œå…¨è§£å†³åŸå­æ€§é—®é¢˜(é™¤äº† synchronized) start å’Œ join è§„åˆ™ä¹Ÿæ˜¯è§£å†³ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹é€šä¿¡çš„æ–¹å¼ä¹‹ä¸€ ä»å†…å­˜è¯­ä¹‰çš„è§’åº¦æ¥è¯´, volatile çš„å†™-è¯»ä¸é”çš„é‡Šæ”¾-è·å–æœ‰ç›¸åŒçš„å†…å­˜æ•ˆæœï¼›volatile å†™å’Œé”çš„é‡Šæ”¾æœ‰ç›¸åŒçš„å†…å­˜è¯­ä¹‰; volatile è¯»ä¸é”çš„è·å–æœ‰ç›¸åŒçš„å†…å­˜è¯­ä¹‰ï¼Œâš ï¸âš ï¸âš ï¸(æ•²é»‘æ¿äº†) volatile è§£å†³çš„æ˜¯å¯è§æ€§é—®é¢˜ï¼Œsynchronized è§£å†³çš„æ˜¯åŸå­æ€§é—®é¢˜ï¼Œè¿™ç»å¯¹ä¸æ˜¯ä¸€å›äº‹ï¼Œåç»­æ–‡ç« ä¹Ÿä¼šè¯´æ˜ é™„åŠ è¯´æ˜ ä¸ªäººåšå®¢ä¼šé¦–å‘åŸåˆ›æ–‡ç« ï¼Œå¦‚æ–‡ç« æœ‰å¯†ç ä¿æŠ¤ï¼Œé€šè¿‡æŸ¥çœ‹æ–‡ç« çš„åˆ›å»ºæ—¥æœŸï¼Œå¦‚æœæ˜¯ 1 æœˆä»½ï¼Œè¯·å…¬ä¼—å·å›å¤å½“å‰æœˆä»½æ•°å€¼å³å¯ï¼Œå¦‚å›å¤ã€Œ1ã€ å¤šçº¿ç¨‹ç³»åˆ—æ–‡ç« æ•´ä½“ä¼šæŒ‰ç…§æˆ‘çš„å¤§çº²èŠ‚å¥æ¥å†™ï¼Œä½†æ˜¯å¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆç–‘é—®ï¼Œä¹Ÿæ¬¢è¿åˆ°æˆ‘å•ç‹¬å»ºç«‹çš„å¤šçº¿ç¨‹ç³»åˆ—é—®é¢˜ç•™è¨€æ±‡æ€» æ–‡ç« ä¸­ç•™è¨€ï¼Œæˆ‘ä¼šç»Ÿä¸€å›å¤ï¼Œå¦‚æœå…±é€šç–‘é—®å¾ˆå¤šï¼Œæˆ‘ä¼šæ’å…¥ç›¸å…³ç« èŠ‚å•ç‹¬åšè¯´æ˜ å¹¶å‘æ–‡ç« çš„ç›¸å…³ä»£ç ï¼Œæˆ‘ä¹Ÿä¼šåŒæ­¥ä¸Šä¼ åˆ°ä»£ç åº“ï¼Œå…¬ä¼—å·å›å¤ã€Œdemoã€ï¼Œç‚¹å‡»é“¾æ¥ï¼Œæ‰¾åˆ°concurrency å­é¡¹ç›®å³å¯ å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œçƒ¦è¯·å°ä¼™ä¼´è½¬å‘åˆ†äº«ç»™æ›´å¤šæœ‹å‹ï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ çµé­‚è¿½é—® åŒæ­¥å—å’ŒåŒæ­¥æ–¹æ³•åœ¨ç¼–è¯‘æˆ CPU æŒ‡ä»¤åæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ çº¿ç¨‹æœ‰ Daemon(å®ˆæŠ¤çº¿ç¨‹)å’Œé Daemon çº¿ç¨‹ï¼Œä½ çŸ¥é“çº¿ç¨‹çš„é€€å‡ºç­–ç•¥å—ï¼Ÿ å…³äº Happens-before ä½ è¿˜æœ‰å“ªäº›ç–‘æƒ‘å‘¢ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· MarkDown è¡¨æ ¼ç”Ÿæˆå™¨æœ¬æ–‡çš„å¥½å¤šè¡¨æ ¼æ˜¯ä»å®˜ç½‘ç²˜è´´çš„ï¼Œå¦‚ä½•å°†å…¶ç›´æ¥è½¬æ¢æˆ MD table å‘¢ï¼Ÿé‚£ä¹ˆ https://www.tablesgenerator.com/markdown_tables å°±å¯ä»¥å¸®åˆ°ä½ äº†ï¼Œæ— è®ºæ˜¯ç”Ÿæˆ MD tableï¼Œè¿˜æ˜¯ç²˜è´´å†…å®¹ç”Ÿæˆ table å’Œå†…å®¹éƒ½æ˜¯æå¥½çš„ï¼Œå½“ç„¶äº†ä¸æ­¢ MD tableï¼Œè‡ªå·±å‘ç°å§ï¼Œæ›´å¤šå·¥å…·ï¼Œå…¬ä¼—å·å›å¤ ã€Œå·¥å…·ã€è·å¾— æ¨èé˜…è¯» æ¯å¤©ç”¨SpringBootï¼Œè¿˜ä¸æ‡‚RESTful APIè¿”å›ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API çº¢é»‘æ ‘ï¼Œè¶…å¼ºåŠ¨é™å›¾è¯¦è§£ï¼Œç®€å•æ˜“æ‡‚ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"},{"name":"Happens-before","slug":"Happens-before","permalink":"https://dayarch.top/tags/Happens-before/"}]},{"title":"å¹¶å‘ç¼–ç¨‹ä¸‰å¤§é—®é¢˜","slug":"å¹¶å‘ç¼–ç¨‹ä¸‰å¤§é—®é¢˜","date":"2019-09-04T08:31:34.000Z","updated":"2020-03-04T03:44:16.419Z","comments":true,"path":"/p/java-concurrency-three-questions.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-three-questions.html","excerpt":"å†™åœ¨å‰é¢ * ç”Ÿæ´»ä¸­ä½ ä¸€å®šå¬è¯´è¿‡â€”â€”èƒ½è€…å¤šåŠ³ * ä½œä¸º Java ç¨‹åºå‘˜ï¼Œä½ ä¸€å®šå¬è¿‡â€”â€”è¿™ä¸ªåŠŸèƒ½è¯·æ±‚æ…¢ï¼Œèƒ½åŠ ä¸€å±‚ç¼“å­˜æˆ–ä¼˜åŒ–ä¸€ä¸‹ SQL å—ï¼Ÿ * çœ‹è¿‡ä¸­å›½å¤ä»£ç¥è¯æ•…äº‹çš„ä¹Ÿä¸€å®šå¬è¿‡â€”â€”å¤©ä¸Šä¸€å¤©ï¼Œåœ°ä¸Šä¸€å¹´ ä¸€åˆ‡è®¾è®¡æ¥æºäºç”Ÿæ´»ï¼Œä¸Šä¸€ç«  å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® ä¸­æœ‰è®²è¿‡ï¼Œä½œä¸ºâ€èµ„æœ¬å®¶â€ï¼Œä½ è¦å°½å¯èƒ½çš„æ¦¨å– CPUï¼Œå†…å­˜ä¸ IO çš„å‰©ä½™ä»·å€¼ï¼Œä½†ä¸‰è€…å®Œæˆä»»åŠ¡çš„é€Ÿåº¦ç›¸å·®å¾ˆå¤§ï¼ŒCPU > å†…å­˜ > IOåˆ†ï¼ŒCPU æ˜¯å¤©ï¼Œé‚£å†…å­˜å°±æ˜¯åœ°ï¼Œå†…å­˜æ˜¯å¤©ï¼Œé‚£ IO å°±æ˜¯åœ°ï¼Œé‚£æ€æ ·å¹³è¡¡ä¸‰è€…ï¼Œæå‡æ•´ä½“é€Ÿåº¦å‘¢ï¼Ÿ 1. CPU å¢åŠ ç¼“å­˜ï¼Œè¿˜ä¸æ­¢ä¸€å±‚ç¼“å­˜ï¼Œå¹³è¡¡å†…å­˜çš„æ…¢ 2. CPU èƒ½è€…å¤šåŠ³ï¼Œé€šè¿‡åˆ†æ—¶","text":"å†™åœ¨å‰é¢ ç”Ÿæ´»ä¸­ä½ ä¸€å®šå¬è¯´è¿‡â€”â€”èƒ½è€…å¤šåŠ³ ä½œä¸º Java ç¨‹åºå‘˜ï¼Œä½ ä¸€å®šå¬è¿‡â€”â€”è¿™ä¸ªåŠŸèƒ½è¯·æ±‚æ…¢ï¼Œèƒ½åŠ ä¸€å±‚ç¼“å­˜æˆ–ä¼˜åŒ–ä¸€ä¸‹ SQL å—ï¼Ÿ çœ‹è¿‡ä¸­å›½å¤ä»£ç¥è¯æ•…äº‹çš„ä¹Ÿä¸€å®šå¬è¿‡â€”â€”å¤©ä¸Šä¸€å¤©ï¼Œåœ°ä¸Šä¸€å¹´ ä¸€åˆ‡è®¾è®¡æ¥æºäºç”Ÿæ´»ï¼Œä¸Šä¸€ç«  å­¦å¹¶å‘ç¼–ç¨‹ï¼Œé€å½»ç†è§£è¿™ä¸‰ä¸ªæ ¸å¿ƒæ˜¯å…³é”® ä¸­æœ‰è®²è¿‡ï¼Œä½œä¸ºâ€èµ„æœ¬å®¶â€ï¼Œä½ è¦å°½å¯èƒ½çš„æ¦¨å– CPUï¼Œå†…å­˜ä¸ IO çš„å‰©ä½™ä»·å€¼ï¼Œä½†ä¸‰è€…å®Œæˆä»»åŠ¡çš„é€Ÿåº¦ç›¸å·®å¾ˆå¤§ï¼ŒCPU &gt; å†…å­˜ &gt; IOåˆ†ï¼ŒCPU æ˜¯å¤©ï¼Œé‚£å†…å­˜å°±æ˜¯åœ°ï¼Œå†…å­˜æ˜¯å¤©ï¼Œé‚£ IO å°±æ˜¯åœ°ï¼Œé‚£æ€æ ·å¹³è¡¡ä¸‰è€…ï¼Œæå‡æ•´ä½“é€Ÿåº¦å‘¢ï¼Ÿ CPU å¢åŠ ç¼“å­˜ï¼Œè¿˜ä¸æ­¢ä¸€å±‚ç¼“å­˜ï¼Œå¹³è¡¡å†…å­˜çš„æ…¢ CPU èƒ½è€…å¤šåŠ³ï¼Œé€šè¿‡åˆ†æ—¶å¤ç”¨ï¼Œå¹³è¡¡ IO çš„é€Ÿåº¦å·®å¼‚ ä¼˜åŒ–ç¼–è¯‘æŒ‡ä»¤ ä¸Šé¢çš„æ–¹å¼è²Œä¼¼è§£å†³äº†æœ¨æ¡¶çŸ­æ¿é—®é¢˜ï¼Œä½†åŒæ—¶è¿™ç§è§£å†³æ–¹æ¡ˆä¹Ÿä¼´éšç€äº§ç”Ÿæ–°çš„å¯è§æ€§ï¼ŒåŸå­æ€§ï¼Œå’Œæœ‰åºæ€§çš„é—®é¢˜ï¼Œä¸”çœ‹ ä¸‰å¤§é—®é¢˜å¯è§æ€§ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿç«‹åˆ»çœ‹åˆ°ï¼Œæˆ‘ä»¬ç§°ä¸ºå¯è§æ€§ è°ˆåˆ°å¯è§æ€§ï¼Œè¦å…ˆå¼•å‡º JMM (Java Memory Model) æ¦‚å¿µ, å³ Java å†…å­˜æ¨¡å‹ï¼ŒJava å†…å­˜æ¨¡å‹è§„å®šï¼Œå°†æ‰€æœ‰çš„å˜é‡éƒ½å­˜æ”¾åœ¨ ä¸»å†…å­˜ ä¸­ï¼Œå½“çº¿ç¨‹ä½¿ç”¨å˜é‡æ—¶ï¼Œä¼šæŠŠä¸»å†…å­˜é‡Œé¢çš„å˜é‡ å¤åˆ¶ åˆ°è‡ªå·±çš„å·¥ä½œç©ºé—´æˆ–è€…å«ä½œ ç§æœ‰å†…å­˜ ï¼Œçº¿ç¨‹è¯»å†™å˜é‡æ—¶æ“ä½œçš„æ˜¯è‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ã€‚ ç”¨ Git çš„å·¥ä½œæµç¨‹ç†è§£ä¸Šé¢çš„æè¿°å°±å¾ˆç®€å•äº†ï¼ŒGit è¿œç¨‹ä»“åº“å°±æ˜¯ä¸»å†…å­˜ï¼ŒGit æœ¬åœ°ä»“åº“å°±æ˜¯è‡ªå·±çš„å·¥ä½œå†…å­˜ æ–‡å­—æè¿°æœ‰äº›æŠ½è±¡ï¼Œæˆ‘ä»¬æ¥å›¾è§£è¯´æ˜: çœ‹è¿™ä¸ªåœºæ™¯: ä¸»å†…å­˜ä¸­æœ‰å˜é‡ xï¼Œåˆå§‹å€¼ä¸º 0 çº¿ç¨‹ A è¦å°† x åŠ  1ï¼Œå…ˆå°† x=0 æ‹·è´åˆ°è‡ªå·±çš„ç§æœ‰å†…å­˜ä¸­ï¼Œç„¶åæ›´æ–° x çš„å€¼ çº¿ç¨‹ A å°†æ›´æ–°åçš„ x å€¼å›åˆ·åˆ°ä¸»å†…å­˜çš„æ—¶é—´æ˜¯ä¸å›ºå®šçš„ åˆšå¥½åœ¨çº¿ç¨‹ A æ²¡æœ‰å›åˆ· x åˆ°ä¸»å†…å­˜æ—¶ï¼Œçº¿ç¨‹ B åŒæ ·ä»ä¸»å†…å­˜ä¸­è¯»å– xï¼Œæ­¤æ—¶ä¸º 0ï¼Œå’Œçº¿ç¨‹ A ä¸€æ ·çš„æ“ä½œï¼Œæœ€åæœŸç›¼çš„ x=2 å°±ä¼šç¼–ç¨‹ x=1 è¿™å°±æ˜¯çº¿ç¨‹å¯è§æ€§çš„é—®é¢˜ JMM æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œåœ¨å®é™…å®ç°ä¸­ï¼Œçº¿ç¨‹çš„å·¥ä½œå†…å­˜æ˜¯è¿™æ ·çš„: ä¸ºäº†å¹³è¡¡å†…å­˜/IO çŸ­æ¿ï¼Œä¼šåœ¨ CPU ä¸Šå¢åŠ ç¼“å­˜ï¼Œæ¯ä¸ªæ ¸éƒ½åªæœ‰è‡ªå·±çš„ä¸€çº§ç¼“å­˜ï¼Œç”šè‡³æœ‰ä¸€ä¸ªæ‰€æœ‰ CPU éƒ½å…±äº«çš„äºŒçº§ç¼“å­˜ï¼Œå°±æ˜¯ä¸Šå›¾çš„æ ·å­äº†ï¼Œéƒ½è¯´è¿™ä¹ˆè®¾è®¡æ˜¯ç¡¬ä»¶åŒå­¦ç•™ç»™è½¯ä»¶åŒå­¦çš„ä¸€ä¸ªå‘ï¼Œä½†èƒ½å¦è·³è¿‡å»è¿™ä¸ªå‘ä¹Ÿæ˜¯è¡¡é‡è½¯ä»¶åŒå­¦æ˜¯å¦èµ°å‘ Java è¿›é˜¶çš„å…³é”®æŒ‡æ ‡å§â€¦â€¦ å°æç¤ºä»ä¸Šå›¾ä¸­ä½ ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨ Java ä¸­ï¼Œæ‰€æœ‰çš„å®ä¾‹åŸŸï¼Œé™æ€åŸŸå’Œæ•°ç»„å…ƒç´ éƒ½å­˜å‚¨åœ¨å †å†…å­˜ä¸­ï¼Œå †å†…å­˜åœ¨çº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œè¿™äº›åœ¨åç»­æ–‡ç« ä¸­éƒ½ç§°ä¹‹ä¸ºã€Œå…±äº«å˜é‡ã€ï¼Œå±€éƒ¨å˜é‡ï¼Œæ–¹æ³•å®šä¹‰å‚æ•°å’Œå¼‚å¸¸å¤„ç†å™¨å‚æ•°ä¸ä¼šåœ¨çº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œæ‰€ä»¥ä»–ä»¬ä¸ä¼šæœ‰å†…å­˜å¯è§æ€§çš„é—®é¢˜ï¼Œä¹Ÿå°±ä¸å—å†…å­˜æ¨¡å‹çš„å½±å“ ä¸€å¥è¯ï¼Œè¦æƒ³è§£å†³å¤šçº¿ç¨‹å¯è§æ€§é—®é¢˜ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»è¦åˆ·å–ä¸»å†…å­˜ä¸­çš„å˜é‡æ€ä¹ˆè§£å†³å¯è§æ€§é—®é¢˜å‘¢ï¼ŸJava å…³é”®å­— volatile å¸®ä½ æå®šï¼Œåç»­ç« èŠ‚ä¼šåˆ†æâ€¦â€¦ åŸå­æ€§åŸå­ï¼ˆatomï¼‰æŒ‡åŒ–å­¦ååº”ä¸å¯å†åˆ†çš„åŸºæœ¬å¾®ç²’ï¼ŒåŸå­æ€§æ“ä½œä½ åº”è¯¥èƒ½æ„Ÿå—åˆ°å…¶å«ä¹‰: æ‰€è°“åŸå­æ“ä½œæ˜¯æŒ‡ä¸ä¼šè¢«çº¿ç¨‹è°ƒåº¦æœºåˆ¶æ‰“æ–­çš„æ“ä½œï¼›è¿™ç§æ“ä½œä¸€æ—¦å¼€å§‹ï¼Œå°±ä¸€ç›´è¿è¡Œåˆ°ç»“æŸï¼Œä¸­é—´ä¸ä¼šæœ‰ä»»ä½• context switch å°å“ã€Œé’Ÿç‚¹å·¥ã€æœ‰ä¸€å¥éå¸¸ç»å…¸çš„å°è¯ï¼Œè¦æŠŠå¤§è±¡è£…å†°ç®±ï¼Œæ€»å…±åˆ†å‡ æ­¥ï¼Ÿ æ¥çœ‹ä¸€å°æ®µç¨‹åº: å¤šçº¿ç¨‹æƒ…å†µä¸‹èƒ½å¾—åˆ°æˆ‘ä»¬æœŸç›¼çš„ count = 20000 çš„å€¼å—ï¼Ÿ ä¹Ÿè®¸æœ‰åŒå­¦ä¼šè®¤ä¸ºï¼Œçº¿ç¨‹è°ƒç”¨çš„ counter æ–¹æ³•åªæœ‰ä¸€ä¸ª count++ æ“ä½œï¼Œæ˜¯å•ä¸€æ“ä½œï¼Œæ‰€ä»¥æ˜¯åŸå­æ€§çš„ï¼Œéä¹Ÿã€‚åœ¨çº¿ç¨‹ç¬¬ä¸€è®²ä¸­è¯´è¿‡æˆ‘ä»¬ä¸èƒ½ç”¨é«˜çº§è¯­è¨€æ€ç»´æ¥ç†è§£ CPU çš„å¤„ç†æ–¹å¼ï¼Œcount++ è½¬æ¢æˆ CPU æŒ‡ä»¤åˆ™éœ€è¦ä¸‰æ­¥ï¼Œé€šè¿‡ä¸‹é¢å‘½ä»¤è§£æå‡ºæ±‡ç¼–æŒ‡ä»¤ç­‰ä¿¡æ¯: 1javap -c UnsafeCounter æˆªå– counter æ–¹æ³•çš„æ±‡ç¼–æŒ‡ä»¤æ¥çœ‹: è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„æŒ‡ä»¤ï¼Œ16 : è·å–å½“å‰ count å€¼ï¼Œå¹¶ä¸”æ”¾å…¥æ ˆé¡¶19 : å°†å¸¸é‡ 1 æ”¾å…¥æ ˆé¡¶20 : å°†å½“å‰æ ˆé¡¶ä¸­ä¸¤ä¸ªå€¼ç›¸åŠ ï¼Œå¹¶æŠŠç»“æœæ”¾å…¥æ ˆé¡¶21 : æŠŠæ ˆé¡¶çš„ç»“æœå†èµ‹å€¼ç»™ count ç”±æ­¤å¯è§ï¼Œç®€å•çš„ count++ ä¸æ˜¯ä¸€æ­¥æ“ä½œï¼Œè¢«è½¬æ¢ä¸ºæ±‡ç¼–åå°±ä¸å…·å¤‡åŸå­æ€§äº†ï¼Œå°±å¥½æ¯”å¤§è±¡è£…å†°ç®±ï¼Œå…¶å®è¦åˆ†ä¸‰æ­¥: ç¬¬ä¸€æ­¥ï¼ŒæŠŠå†°ç®±é—¨æ‰“å¼€ï¼›ç¬¬äºŒæ­¥ï¼ŒæŠŠå¤§è±¡æ”¾è¿›å»ï¼›ç¬¬ä¸‰æ­¥ï¼ŒæŠŠå†°ç®±é—¨å¸¦ä¸Š ç»“åˆ JMM ç»“æ„å›¾ç†è§£ï¼Œè¯´æ˜ä¸€ä¸‹ä¸ºä»€ä¹ˆå¾ˆéš¾å¾—åˆ° count=20000 çš„ç»“æœ: å¤šçº¿ç¨‹è®¡æ•°å™¨ï¼Œå¦‚ä½•ä¿è¯å¤šä¸ªæ“ä½œçš„åŸå­æ€§å‘¢ï¼Ÿæœ€ç²—æš´çš„æ–¹å¼æ˜¯åœ¨æ–¹æ³•ä¸ŠåŠ  synchronized å…³é”®å­—ï¼Œæ¯”å¦‚è¿™æ ·: é—®é¢˜æ˜¯è§£å†³äº†ï¼Œå¦‚æœ synchronized æ˜¯ä¸‡èƒ½è‰¯æ–¹ï¼Œé‚£ä¹ˆä¹Ÿè®¸å¹¶å‘å°±æ²¡é‚£ä¹ˆå¤šäº‹äº†ï¼Œå¯ä»¥é ä¸€ä¸ª synchronized èµ°å¤©ä¸‹äº†ï¼Œäº‹å®å¹¶ä¸æ˜¯è¿™æ ·ï¼Œsynchronized æ˜¯ç‹¬å é” (åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è°ƒç”¨)ï¼Œæ²¡æœ‰è·å–é”çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼›å¦å¤–ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šçº¿ç¨‹åˆ‡æ¢çš„ä¸Šä¸‹æ–‡å¼€é”€ æ‰€ä»¥ JDK ä¸­å°±æœ‰äº†éé˜»å¡ CAS (Compare and Swap) ç®—æ³•å®ç°çš„åŸå­æ“ä½œç±» AtomicLong ç­‰å·¥å…·ç±»ï¼Œçœ‹è¿‡æºç çš„åŒå­¦ä¹Ÿè®¸ä¼šå‘ç°ä¸€ä¸ªå…±åŒç‰¹ç‚¹ï¼Œæ‰€æœ‰åŸå­ç±»ä¸­éƒ½æœ‰ä¸‹é¢è¿™æ ·ä¸€æ®µä»£ç : 1private static final Unsafe unsafe = Unsafe.getUnsafe(); è¿™ä¸ªç±»æ˜¯ JDK çš„ rt.jar åŒ…ä¸­çš„ Unsafe ç±»æä¾›äº† ç¡¬ä»¶çº§åˆ« çš„åŸå­æ€§æ“ä½œï¼Œç±»ä¸­çš„æ–¹æ³•éƒ½æ˜¯ native ä¿®é¥°çš„ï¼Œåé¢ä»‹ç»åŸå­ç±»ä¹‹å‰ä¹Ÿä¼šå…ˆè¯´æ˜è¿™ä¸ªç±»ä¸­çš„å‡ ä¸ªæ–¹æ³•ï¼Œè¿™é‡Œå…ˆç®€å•ä»‹ç»æœ‰ä¸ªå°è±¡å³å¯ã€‚ æœ‰åŒå­¦ä¸ç†è§£æˆ‘åˆšåˆšæåˆ°çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¾ˆå¤§æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¸¾ 2ä¸ªä¾‹å­ä½ å°±æ‡‚äº†: ä½ (CPU)åœ¨çœ‹ä¸¤æœ¬ä¹¦(ä¸¤ä¸ªçº¿ç¨‹)ï¼Œçœ‹ç¬¬ä¸€æœ¬ä¹¦å¾ˆçŸ­æ—¶é—´åè¦å»çœ‹ç¬¬äºŒæœ¬ä¹¦ï¼Œçœ‹ç¬¬äºŒæœ¬ä¹¦å¾ˆçŸ­æ—¶é—´ååˆå›çœ‹ç¬¬ä¸€æœ¬ä¹¦ï¼Œå¹¶è¦ç²¾ç¡®çš„è®°å¾—çœ‹åˆ°ç¬¬å‡ è¡Œï¼Œå½“åˆçœ‹åˆ°äº†ä»€ä¹ˆ(CPU è®°ä½çº¿ç¨‹çº§åˆ«çš„ä¿¡æ¯)ï¼Œå½“è®©ä½  â€œåŒæ—¶â€ çœ‹ 10 æœ¬ç”šè‡³æ›´å¤šï¼Œåˆ‡æ¢çš„å¼€é”€å°±å¾ˆå¤§äº†å§ ç»¼è‰ºèŠ‚ç›®ä¸­æœ‰å¾ˆå¤šæ¸¸æˆï¼Œè®©ä½ ä¸€è¾¹æ•°é’±ï¼Œåˆè¦ä¸€è¾¹åšå…¶ä»–çš„äº‹ï¼Œæœ€ç»ˆä¿è¯å¤šæ ·äº‹æƒ…éƒ½åšæ­£ç¡®ï¼Œå¤§è„‘å¼€é”€å¤§ä¸å¤§ï¼Œä½ è¯•è¯•å°±çŸ¥é“äº†ğŸ˜Š æœ‰åºæ€§ç”Ÿæ´»ä¸­ä½ é—®å€™ä»–äººã€Œåƒäº†å—ä½ ï¼Ÿã€å’Œã€Œä½ åƒäº†å—ï¼Ÿã€æ˜¯ä¸€ä¸ªæ„æ€ï¼Œä½ å†™çš„æ˜¯ä¸‹é¢ç¨‹åº: 1234a = 1ï¼›b = 2;System.out.println(a);System.out.println(b); ç¼–è¯‘å™¨ä¼˜åŒ–åå¯èƒ½å°±å˜æˆäº†è¿™æ ·: 1234b = 2;a = 1ï¼›System.out.println(a);System.out.println(b); è¿™ä¸ªæƒ…å†µï¼Œç¼–è¯‘å™¨è°ƒæ•´äº†è¯­å¥é¡ºåºæ²¡ä»€ä¹ˆå½±å“ï¼Œä½†ç¼–è¯‘å™¨ æ“…è‡ª ä¼˜åŒ–é¡ºåºï¼Œå°±ç»™æˆ‘ä»¬åŸ‹ä¸‹äº†é›·ï¼Œæ¯”å¦‚åº”ç”¨åŒé‡æ£€æŸ¥æ–¹å¼å®ç°çš„å•ä¾‹ ä¸€åˆ‡åˆå¾ˆå®Œç¾æ˜¯ä¸æ˜¯ï¼Œéä¹Ÿï¼Œé—®é¢˜å‡ºç°åœ¨ instance = new Singleton();ï¼Œè¿™ 1 è¡Œä»£ç è½¬æ¢æˆäº† CPU æŒ‡ä»¤ååˆå˜æˆäº† 3 ä¸ªï¼Œæˆ‘ä»¬ç†è§£ new å¯¹è±¡åº”è¯¥æ˜¯è¿™æ ·çš„: åˆ†é…ä¸€å—å†…å­˜ M åœ¨å†…å­˜ M ä¸Šåˆå§‹åŒ– Singleton å¯¹è±¡ ç„¶å M çš„åœ°å€èµ‹å€¼ç»™ instance å˜é‡ ä½†ç¼–è¯‘å™¨æ“…è‡ªä¼˜åŒ–åå¯èƒ½å°±å˜æˆäº†è¿™æ ·: åˆ†é…ä¸€å—å†…å­˜ M ç„¶åå°† M çš„åœ°å€èµ‹å€¼ç»™ instance å˜é‡ åœ¨å†…å­˜ M ä¸Šåˆå§‹åŒ– Singleton å¯¹è±¡ é¦–å…ˆ new å¯¹è±¡åˆ†äº†ä¸‰æ­¥ï¼Œç»™ CPU ç•™ä¸‹äº†åˆ‡æ¢çº¿ç¨‹çš„æœºä¼šï¼›å¦å¤–ï¼Œç¼–è¯‘å™¨ä¼˜åŒ–åçš„é¡ºåºå¯èƒ½å¯¼è‡´é—®é¢˜çš„å‘ç”Ÿï¼Œæ¥çœ‹: çº¿ç¨‹ A å…ˆæ‰§è¡Œ getInstance æ–¹æ³•ï¼Œå½“æ‰§è¡Œåˆ°æŒ‡ä»¤ 2 æ—¶ï¼Œæ°å¥½å‘ç”Ÿäº†çº¿ç¨‹åˆ‡æ¢ çº¿ç¨‹ B åˆšè¿›å…¥åˆ° getInstance æ–¹æ³•ï¼Œåˆ¤æ–­ if è¯­å¥ instance æ˜¯å¦ä¸ºç©º çº¿ç¨‹ A å·²ç»å°† M çš„åœ°å€èµ‹å€¼ç»™äº† instance å˜é‡ï¼Œæ‰€ä»¥çº¿ç¨‹ B è®¤ä¸º instance ä¸ä¸ºç©º çº¿ç¨‹ B ç›´æ¥ return instance å˜é‡ CPU åˆ‡æ¢å›çº¿ç¨‹ Aï¼Œçº¿ç¨‹ A å®Œæˆåç»­åˆå§‹åŒ–å†…å®¹ æˆ‘ä»¬è¿˜æ˜¯ç”»ä¸ªå›¾è¯´æ˜ä¸€ä¸‹: å¦‚æœçº¿ç¨‹ A æ‰§è¡Œåˆ°ç¬¬ 2 æ­¥ï¼Œçº¿ç¨‹åˆ‡æ¢ï¼Œç”±äºçº¿ç¨‹ A æ²¡æœ‰æŠŠçº¢è‰²ç®­å¤´æ‰§è¡Œå®Œå…¨ï¼Œçº¿ç¨‹ B å°±ä¼šå¾—åˆ°ä¸€ä¸ªæœªåˆå§‹åŒ–å®Œå…¨çš„å¯¹è±¡ï¼Œè®¿é—® instance æˆå‘˜å˜é‡çš„æ—¶å€™å°±å¯èƒ½å‘ç”Ÿ NPEï¼Œå¦‚æœå°†å˜é‡ instance ç”¨ volatile æˆ–è€… final ä¿®é¥°(æ¶‰åŠåˆ°ç±»çš„åŠ è½½æœºåˆ¶ï¼Œå¯çœ‹æˆ‘ä¹‹å‰å†™çš„æ–‡ç« : åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š)ï¼Œé—®é¢˜å°±è§£å†³äº†. æ€»ç»“ä½ æ‰€çœ‹åˆ°çš„ç¨‹åºå¹¶ä¸ä¸€å®šæ˜¯ç¼–è¯‘å™¨ä¼˜åŒ–/ç¼–è¯‘åçš„ CPU æŒ‡ä»¤ï¼Œå¤§è±¡è£…å†°ç®±æ˜¯æ˜¯ä¸ªç¨‹åºï¼Œä½†å…¶éšå«ä¸‰ä¸ªæ­¥éª¤ï¼Œå­¦ä¹ å¹¶å‘ç¼–ç¨‹ï¼Œä½ è¦æŒ‰ç…§ CPU çš„æ€ç»´è€ƒè™‘é—®é¢˜ï¼Œæ‰€ä»¥ä½ éœ€è¦æ·±åˆ»ç†è§£ å¯è§æ€§/åŸå­æ€§/æœ‰åºæ€§ ï¼Œè¿™æ˜¯äº§ç”Ÿå¹¶å‘ Bug çš„æºå¤´ æœ¬èŠ‚è¯´æ˜äº†ä¸‰ä¸ªé—®é¢˜ï¼Œä¸‹é¢çš„æ–‡ç« ä¹Ÿä¼šé€ä¸ªåˆ†æè§£å†³ä»¥ä¸Šé—®é¢˜çš„åŠæ³•ï¼Œä»¥åŠç›¸å¯¹ä¼˜çš„æ–¹æ¡ˆï¼Œè¯·æŒç»­å…³æ³¨ï¼Œå¦å¤–å…³äºå¹¶å‘çš„æµ‹è¯•ä»£ç æˆ‘éƒ½ä¼šæŒ‰ä¾‹ä¸Šä¼ åˆ° githubï¼Œå…¬ä¼—å·å›å¤ã€Œdemoã€â€”â€”&gt; concurrency è·å–æ›´å¤šå†…å®¹ çµé­‚è¿½é—® ä¸ºä»€ä¹ˆç”¨ final ä¿®é¥°çš„å˜é‡å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„äº†å‘¢ï¼Ÿ ä½ ä¼šç»å¸¸æŸ¥çœ‹ CPU æ±‡ç¼–æŒ‡ä»¤å—ï¼Ÿ å¦‚æœè®©ä½ å†™å•ä¾‹ï¼Œä½ é€šå¸¸ä¼šé‡‡ç”¨å“ªç§å®ç°ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· Material Theme UIè¿™æ˜¯ä¸€æ¬¾ IDEA çš„ä¸»é¢˜æ’ä»¶ï¼Œå®‰è£…åï¼Œé€‰æ‹© Material Palenight ä¸»é¢˜ï¼ŒåŒæ—¶ä½œå‡ºå¦‚ä¸‹è®¾ç½® è®¾ç½®å®Œåï¼Œä½ çš„ IDEA å°±æ˜¯ä¸‹é¢è¿™æ ·ï¼Œå¼•èµ·æåº¦èˆ’é€‚ æ¨èé˜…è¯» æ¯å¤©ç”¨SpringBootï¼Œè¿˜ä¸æ‡‚RESTful APIè¿”å›ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API çº¢é»‘æ ‘ï¼Œè¶…å¼ºåŠ¨é™å›¾è¯¦è§£ï¼Œç®€å•æ˜“æ‡‚ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"},{"name":"å¯è§æ€§","slug":"å¯è§æ€§","permalink":"https://dayarch.top/tags/%E5%8F%AF%E8%A7%81%E6%80%A7/"},{"name":"åŸå­æ€§","slug":"åŸå­æ€§","permalink":"https://dayarch.top/tags/%E5%8E%9F%E5%AD%90%E6%80%A7/"},{"name":"æœ‰åºæ€§","slug":"æœ‰åºæ€§","permalink":"https://dayarch.top/tags/%E6%9C%89%E5%BA%8F%E6%80%A7/"}]},{"title":"Mybatisæ‹¦æˆªå™¨å®ç°æ•°æ®åŠ å¯†ä¸è§£å¯†","slug":"Mybatisæ‹¦æˆªå™¨å®ç°æ•°æ®åŠ å¯†ä¸è§£å¯†","date":"2019-09-02T00:40:51.000Z","updated":"2020-01-22T02:16:08.745Z","comments":true,"path":"/p/mybatis-interceptor-encrypt-decrypt.html","link":"","permalink":"https://dayarch.top/p/mybatis-interceptor-encrypt-decrypt.html","excerpt":"æ‹¦æˆªå™¨ä»‹ç» Mybatis Interceptor åœ¨ Mybatis ä¸­è¢«å½“ä½œ Plugin(æ’ä»¶)ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†ç¡®å®æ˜¯åœ¨ org.apache.ibatis.plugin åŒ…ä¸‹é¢ æ—¢ç„¶æ˜¯æ‹¦æˆªå™¨ï¼Œå¯ä»¥æ‹¦æˆªå“ªäº›å†…å®¹å‘¢ï¼Ÿè¯•æƒ³ä¸€ä¸‹â€¦â€¦ å½“ç¨‹åºå†™åˆ°æŒä¹…å±‚æ—¶ï¼ŒMybatis ä¼š æ‰§è¡Œ æŒ‡å®š SQL è¯­å¥ï¼Œå¹¶å¤„ç† è¯·æ±‚å‚æ•° å’Œ è¿”å›å€¼ã€‚æ²¡é”™ï¼ŒMybatis æ‹¦æˆªå™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¤„ç†ä¸Šè¿°å†…å®¹ï¼Œè¯·çœ‹å®˜ç½‘çš„ Plugins çš„ç‰‡æ®µ, å†…å®¹ä¸å¤š 1 2 3 4 5 6 7 8 // æ‰§è¡Œ Executor (update, query, flushStatements, commit, rollb","text":"æ‹¦æˆªå™¨ä»‹ç»Mybatis Interceptor åœ¨ Mybatis ä¸­è¢«å½“ä½œ Plugin(æ’ä»¶)ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†ç¡®å®æ˜¯åœ¨ org.apache.ibatis.plugin åŒ…ä¸‹é¢ æ—¢ç„¶æ˜¯æ‹¦æˆªå™¨ï¼Œå¯ä»¥æ‹¦æˆªå“ªäº›å†…å®¹å‘¢ï¼Ÿè¯•æƒ³ä¸€ä¸‹â€¦â€¦ å½“ç¨‹åºå†™åˆ°æŒä¹…å±‚æ—¶ï¼ŒMybatis ä¼š æ‰§è¡Œ æŒ‡å®š SQL è¯­å¥ï¼Œå¹¶å¤„ç† è¯·æ±‚å‚æ•° å’Œ è¿”å›å€¼ã€‚æ²¡é”™ï¼ŒMybatis æ‹¦æˆªå™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¤„ç†ä¸Šè¿°å†…å®¹ï¼Œè¯·çœ‹å®˜ç½‘çš„ Plugins çš„ç‰‡æ®µ, å†…å®¹ä¸å¤š 12345678// æ‰§è¡ŒExecutor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)// è¯·æ±‚å‚æ•°å¤„ç†ParameterHandler (getParameterObject, setParameters)// è¿”å›ç»“æœé›†å¤„ç†ResultSetHandler (handleResultSets, handleOutputParameters)// SQLè¯­å¥æ„å»ºStatementHandler (prepare, parameterize, batch, update, query) æ‹¦æˆªå™¨çš„ä½¿ç”¨å¦‚æœéœ€è¦å®ç°è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œåªéœ€è¦å®ç° org.apache.ibatis.plugin.Interceptor æ¥å£ï¼Œè¯¥æ¥å£æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼š 12345Object intercept(Invocation invocation) throws Throwable;Object plugin(Object target);void setProperties(Properties properties); æˆ‘ä»¬è¦å®ç°æ•°æ®åŠ å¯†ï¼Œè¿›å…¥æ•°æ®åº“çš„å­—æ®µä¸èƒ½æ˜¯çœŸå®çš„æ•°æ®ï¼Œä½†æ˜¯è¿”å›æ¥çš„æ•°æ®è¦çœŸå®å¯ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é’ˆå¯¹ Parameter å’Œ ResultSet ä¸¤ç§ç±»å‹å¤„ç†ï¼ŒåŒæ—¶ä¸ºäº†æ›´çµæ´»çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ³¨è§£ è‡ªå®šä¹‰æ³¨è§£ç±»æ³¨è§£ï¼Œå°†æ³¨è§£æ”¾åœ¨å®ä½“ç±»ä¸Š 123456789/** * éœ€è¦åŠ è§£å¯†çš„ç±»æ³¨è§£ */@Documented@Inherited@Target(&#123; ElementType.TYPE &#125;)@Retention(RetentionPolicy.RUNTIME)public @interface EncryptDecryptClass &#123;&#125; å­—æ®µæ³¨è§£ï¼Œå°†æ³¨è§£æ”¾åœ¨å®ä½“å­—æ®µä¸Š 12345678910/** * åŠ å¯†å­—æ®µæ³¨è§£ */@Documented@Inherited@Target(&#123; ElementType.FIELD &#125;)@Retention(RetentionPolicy.RUNTIME)public @interface EncryptDecryptField &#123;&#125; æœ‰äº†è¿™ä¸¤ä¸ªæ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬å¯ä»¥æ ‡è®°æˆ‘ä»¬è¦å¤„ç†çš„å®ä½“å’Œå®ä½“ä¸­çš„å­—æ®µ è‡ªå®šä¹‰å‚æ•°å¤„ç†æ‹¦æˆªå™¨å‚è€ƒå®˜ç½‘ï¼Œé€šè¿‡ @Intercepts å’Œ @Signature çš„è”åˆä½¿ç”¨ï¼ŒæŒ‡å®š ParameterHandler.class ç±»å‹ï¼ŒåŒæ—¶é€šè¿‡ @Component æ³¨è§£æ³¨å…¥åˆ°å®¹å™¨ä¸­ï¼Œå³å¯åœ¨è®¾ç½®å‚æ•°çš„æ—¶å€™è¿›è¡Œæ‹¦æˆªï¼Œé€šè¿‡è‡ªå®šä¹‰æ¥å£ IEncryptDecrypt, æ ¹æ® Field çš„å„ç§ç±»å‹è‡ªå®šä¹‰åŠ å¯†è§£å¯†ç®—æ³• 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253@Intercepts(&#123; @Signature(type = ParameterHandler.class, method = \"setParameters\", args = PreparedStatement.class),&#125;)@ConditionalOnProperty(value = \"domain.encrypt\", havingValue = \"true\")@Component@Slf4jpublic class ParammeterInterceptor implements Interceptor &#123; @Autowired private IEncryptDecrypt encryptDecrypt; @Override public Object intercept(Invocation invocation) throws Throwable &#123; log.info(\"æ‹¦æˆªå™¨ParamInterceptor\"); //æ‹¦æˆª ParameterHandler çš„ setParameters æ–¹æ³• åŠ¨æ€è®¾ç½®å‚æ•° if (invocation.getTarget() instanceof ParameterHandler) &#123; ParameterHandler parameterHandler = (ParameterHandler) invocation.getTarget(); PreparedStatement ps = (PreparedStatement) invocation.getArgs()[0]; // åå°„è·å– BoundSql å¯¹è±¡ï¼Œæ­¤å¯¹è±¡åŒ…å«ç”Ÿæˆçš„sqlå’Œsqlçš„å‚æ•°mapæ˜ å°„ /*Field boundSqlField = parameterHandler.getClass().getDeclaredField(\"boundSql\"); boundSqlField.setAccessible(true); BoundSql boundSql = (BoundSql) boundSqlField.get(parameterHandler);*/ // åå°„è·å– å‚æ•°å¯¹åƒ Field parameterField = parameterHandler.getClass().getDeclaredField(\"parameterObject\"); parameterField.setAccessible(true); Object parameterObject = parameterField.get(parameterHandler); if (Objects.nonNull(parameterObject))&#123; Class&lt;?&gt; parameterObjectClass = parameterObject.getClass(); EncryptDecryptClass encryptDecryptClass = AnnotationUtils.findAnnotation(parameterObjectClass, EncryptDecryptClass.class); if (Objects.nonNull(encryptDecryptClass))&#123; Field[] declaredFields = parameterObjectClass.getDeclaredFields(); final Object encrypt = encryptDecrypt.encrypt(declaredFields, parameterObject); &#125; &#125; &#125; return invocation.proceed(); &#125; @Override public Object plugin(Object o) &#123; return Plugin.wrap(o, this); &#125; @Override public void setProperties(Properties properties) &#123; &#125;&#125; åŒæ ·æ–°å»ºç»“æœé›†æ‹¦æˆªå™¨ ç»“æœé›†æ‹¦æˆªå™¨ä¸å‚æ•°æ‹¦æˆªå™¨åŸºæœ¬ä¸€æ ·, åªä¸è¿‡ç±»å‹æŒ‡å®šä¸º ResultSetHandler.class 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@Intercepts(&#123; @Signature(type = ResultSetHandler.class, method = \"handleResultSets\", args=&#123;Statement.class&#125;)&#125;)@ConditionalOnProperty(value = \"domain.decrypt\", havingValue = \"true\")@Component@Slf4jpublic class ResultInterceptor implements Interceptor &#123; @Autowired private IEncryptDecrypt encryptDecrypt; @Override public Object intercept(Invocation invocation) throws Throwable &#123; Object result = invocation.proceed(); if (Objects.isNull(result))&#123; return null; &#125; if (result instanceof ArrayList) &#123; ArrayList resultList = (ArrayList) result; if (CollectionUtils.isNotEmpty(resultList) &amp;&amp; needToDecrypt(resultList.get(0)))&#123; for (int i = 0; i &lt; resultList.size(); i++) &#123; encryptDecrypt.decrypt(resultList.get(i)); &#125; &#125; &#125;else &#123; if (needToDecrypt(result))&#123; encryptDecrypt.decrypt(result); &#125; &#125; return result; &#125; public boolean needToDecrypt(Object object)&#123; Class&lt;?&gt; objectClass = object.getClass(); EncryptDecryptClass encryptDecryptClass = AnnotationUtils.findAnnotation(objectClass, EncryptDecryptClass.class); if (Objects.nonNull(encryptDecryptClass))&#123; return true; &#125; return false; &#125; @Override public Object plugin(Object target) &#123; return Plugin.wrap(target, this); &#125; @Override public void setProperties(Properties properties) &#123; &#125;&#125; åŠ å¯†è§£å¯†IEncryptDecrypt æ¥å£å®šä¹‰äº† åŠ å¯†å’Œè§£å¯†ä¸¤ä¸ªæ–¹æ³•ï¼Œ 1234567891011121314151617181920public interface IEncryptDecrypt &#123; /** * åŠ å¯†æ–¹æ³• * @param declaredFields åå°„beanæˆå‘˜å˜é‡ * @param parameterObject Mybatiså…¥å‚ * @param &lt;T&gt; * @return */ public &lt;T&gt; T encrypt(Field[] declaredFields, T parameterObject) throws IllegalAccessException; /** * è§£å¯†æ–¹æ³• * @param result Mybatis è¿”å›å€¼ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯ArrayListç±»å‹ * @param &lt;T&gt; * @return */ public &lt;T&gt; T decrypt(T result) throws IllegalAccessException;&#125; ä¸¤ä¸ªæ‹¦æˆªå™¨é€šè¿‡åœ¨ YAML ä¸­é…ç½®å±æ€§ï¼ŒæŒ‰æ¡ä»¶æ³¨å…¥ï¼Œå¤–åŠ è‡ªå®šä¹‰åŠ å¯†è§£å¯†ç®—æ³•ï¼Œå®Œæˆå…¨å±€çµæ´»çš„é…ç½®ã€‚æ ¸å¿ƒä»£ç å·²ä¸Šä¼ è‡³ Github Demo é—®é¢˜å½©è›‹ä¹Ÿè®¸åº”å¯¹å½“å‰çš„ä¸šåŠ¡ï¼Œçœ‹äº†è¯¥æ–‡ç« æ»¡è¶³äº†å½“ä¸‹éœ€æ±‚ï¼Œæˆ‘ä»¬ç›®å‰åªçœ‹åˆ°äº†ä»€ä¹ˆæ˜¯ Mybatis æ‹¦æˆªå™¨ï¼Œæ€æ ·ç®€å•ä½¿ç”¨ï¼Œæ‹¦æˆªå™¨çš„å…¶ä»–ç”¨æ³•ä»¥åŠå…¶ä»–å¾ˆå¤šä¸ºä»€ä¹ˆéƒ½æ²¡æœ‰è§£å†³ï¼Œå…³æ³¨å…¬ä¼—å·ï¼Œå›å¤â€œäººè¿¹ç½•è‡³â€ è¯»å®Œæ–‡ç«  ã€Œç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç ã€å ï¼Œæˆ‘ä¸ä¼šæ»¡è¶³çœ¼å‰çš„è¿™äº›åŸºæœ¬åº”ç”¨ï¼Œæˆ‘ä¼šæœ‰è¯¸å¤šç–‘é—®ï¼Œ æˆ‘ä»¬æ—¥å¸¸å†™ CRUD çš„ä¸šåŠ¡ï¼Œä¸ºä»€ä¹ˆ Executor ä¸­åªæœ‰ R(query) å’Œ U(update), é‚£ä¹ˆC(insert) å’Œ D(delete) æ€æ ·å¤„ç†çš„ï¼Ÿ è‡ªå®šä¹‰æ‹¦æˆªå™¨æ˜¯ä»¥ä»€ä¹ˆæ–¹å¼è¢«æ‰§è¡Œçš„ï¼Œæ‰§è¡Œé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ åˆ†é¡µä¹Ÿæ˜¯ Mybatis æ‹¦æˆªå™¨çš„ä¸€ç§ï¼Œå¸¦æœ‰åˆ†é¡µçš„æ¡†æ¶æ˜¯æ€æ ·ä½¿ç”¨æ‹¦æˆªå™¨çš„å‘¢ï¼Ÿå¦‚ Mybatis Plus, PageHelper è™½ç„¶é‡å†™äº† Inteceptor æ¥å£çš„ public void setProperties(Properties properties) æ–¹æ³•ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å†™ä»€ä¹ˆä¸šåŠ¡é€»è¾‘ï¼Œè¿™ä¸ªæ–¹æ³•èƒ½æ€æ ·ä½¿ç”¨ï¼Ÿ â€¦â€¦åç»­æ–‡ç« ä¹Ÿä¼šé€šè¿‡è¯»æºç çš„æ–¹å¼é€æ­¥è§£æè¿™äº›é—®é¢˜ï¼Œå½“ç„¶ä½ æœ‰ç›¸å…³é—®é¢˜ä¹Ÿå¯ä»¥ç•™è¨€äº¤æµè®¨è®º æé«˜æ•ˆç‡å·¥å…·ä¾æ—§æ¨èåœ¨å†™æ–‡ç« æ—¶ç”¨åˆ°çš„é«˜æ•ˆå·¥å…·ï¼Œåç»­ç›¸å…³å·¥å…·ä¹Ÿä¼šåœ¨æ–‡ç« ä¸­é™†ç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨ MyBatis Log PluginMyBatis Log Plugin æ˜¯ Intelligj IDEA çš„ä¸€ä¸ªæ’ä»¶ï¼Œç”¨æ¥ä» Mybatis è¾“å‡ºçš„ log ä¸­æå–å‡ºå½“å‰è°ƒç”¨çš„ SQL è¯­å¥ï¼Œå¹¶å°†å‚æ•°å°è£…åœ¨ SQL è¯­å¥ä¸­ç»„æˆå®Œæ•´çš„ SQLï¼Œè¿™æ ·ï¼Œå½“æˆ‘ä»¬è°ƒè¯•çš„æ—¶å€™æ›´åŠ æ¸…æ™°æ–¹ä¾¿ï¼Œå¯ä»¥è½»æ¾å®šä½æ˜¯å¦ SQL åˆé—®é¢˜ æ¨èé˜…è¯» æ¯å¤©ç”¨SpringBootï¼Œè¿˜ä¸æ‡‚RESTful APIè¿”å›ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API çº¢é»‘æ ‘ï¼Œè¶…å¼ºåŠ¨é™å›¾è¯¦è§£ï¼Œç®€å•æ˜“æ‡‚ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"æ•°æ®åº“-æŒä¹…å±‚-SQL","slug":"Coding/æ•°æ®åº“-æŒä¹…å±‚-SQL","permalink":"https://dayarch.top/categories/Coding/%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%8C%81%E4%B9%85%E5%B1%82-SQL/"}],"tags":[{"name":"MyBatis","slug":"MyBatis","permalink":"https://dayarch.top/tags/MyBatis/"}]},{"title":"Java StringåŸºç¡€é¢è¯•","slug":"Java StringåŸºç¡€é¢è¯•","date":"2019-08-31T03:57:49.000Z","updated":"2019-12-17T12:47:59.582Z","comments":true,"path":"/p/java-string-interview.html","link":"","permalink":"https://dayarch.top/p/java-string-interview.html","excerpt":"å…³äº Java Stringï¼Œè¿™æ˜¯é¢è¯•çš„åŸºç¡€ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šç«¥é‹ä¸èƒ½è¯´æ¸…æ¥šï¼Œæ‰€ä»¥æœ¬æ–‡å°†ç®€å•è€Œåˆé€å½»çš„è¯´æ˜ä¸€ä¸‹é‚£ä¸ªè®©ä½ è¿·æƒ‘çš„ String åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸² 1 2 String x = \"abc\"; String y = new String(\"abc\"); ä½ å¸¸è§ä¹Ÿå¸¸å†™ç¬¬ä¸€ç§ï¼Œå¾ˆå°‘è§ç¬¬äºŒç§ï¼Œä½†é¢è¯•è¿˜æ€»é—®è¿™ç±»é—®é¢˜ï¼ŒåŒå¼•å·å’Œæ„é€ å™¨ä¸¤ç§å½¢å¼åˆ›å»ºå­—ç¬¦ä¸²åˆ°åº•æœ‰ä»€ä¹ˆå·®åˆ«å‘¢ï¼Ÿ å…ˆæ¥çœ‹ä¾‹å­ ä¾‹å­ 1 1 2 3 4 String a = \"abcd\"; String b = \"abcd\"; System.out.println(a == b); // T","text":"å…³äº Java Stringï¼Œè¿™æ˜¯é¢è¯•çš„åŸºç¡€ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šç«¥é‹ä¸èƒ½è¯´æ¸…æ¥šï¼Œæ‰€ä»¥æœ¬æ–‡å°†ç®€å•è€Œåˆé€å½»çš„è¯´æ˜ä¸€ä¸‹é‚£ä¸ªè®©ä½ è¿·æƒ‘çš„ String åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸² 12String x = \"abc\";String y = new String(\"abc\"); ä½ å¸¸è§ä¹Ÿå¸¸å†™ç¬¬ä¸€ç§ï¼Œå¾ˆå°‘è§ç¬¬äºŒç§ï¼Œä½†é¢è¯•è¿˜æ€»é—®è¿™ç±»é—®é¢˜ï¼ŒåŒå¼•å·å’Œæ„é€ å™¨ä¸¤ç§å½¢å¼åˆ›å»ºå­—ç¬¦ä¸²åˆ°åº•æœ‰ä»€ä¹ˆå·®åˆ«å‘¢ï¼Ÿ å…ˆæ¥çœ‹ä¾‹å­ ä¾‹å­ 11234String a = \"abcd\";String b = \"abcd\";System.out.println(a == b); // TrueSystem.out.println(a.equals(b)); // True a == b ç»“æœä¸º trueï¼Œæ˜¯å› ä¸º a å’Œ b éƒ½æŒ‡å‘ æ–¹æ³•åŒº(method area) åŒä¸€ä¸ªå­—ç¬¦ä¸²æ–‡å­—ï¼Œå†…å­˜å¼•ç”¨æ˜¯åŒä¸€ä¸ª å½“å¤šæ¬¡åˆ›å»ºç›¸åŒçš„å­—ç¬¦ä¸²æ–‡å­—æ—¶ï¼Œåªå­˜å‚¨æ¯ä¸ªä¸åŒå­—ç¬¦ä¸²å€¼çš„ä¸€ä¸ªå‰¯æœ¬ã€‚è¿™ä¸ªå«åšå­—ç¬¦ä¸²ç•™é©»/ç•™ç”¨ï¼ŒJava ä¸­æ‰€æœ‰ç¼–è¯‘æœŸå­—ç¬¦ä¸²å¸¸é‡éƒ½ä¼šè¢«è‡ªåŠ¨ç•™é©» ä¾‹å­ 21234String c = new String(\"abcd\");String d = new String(\"abcd\");System.out.println(c == d); // FalseSystem.out.println(c.equals(d)); // True c==d ç»“æœä¸º falseï¼Œå› ä¸º c å’Œ d çš„å¼•ç”¨æŒ‡å‘å †ä¸­ä¸åŒçš„å¯¹è±¡ï¼Œä¸åŒçš„å¯¹è±¡è‚¯å®šæœ‰ä¸åŒçš„å†…å­˜å¼•ç”¨ ä¸¾äº†ä¸¤ä¸ªä¾‹å­ï¼Œæ–‡å­—æè¿°æœ‰ç‚¹æ‡µï¼Ÿæˆ‘ä»¬æ¥è¯•å›¾é€šè¿‡å›¾å½¢æ¥ç†è§£ä¸Šè¿°ä¸¤ç§æƒ…å†µ: ä¹Ÿè®¸ä½ å·²ç»çœ‹çœ‹å‡ºæ¥äº†ï¼Œä¸€ä¸ªæ˜¯åœ¨æ–¹æ³•åŒºï¼Œä¸€ä¸ªæ˜¯åœ¨å †ä¸­ï¼Œåœ¨ JVM æ¨¡å‹ä¸­è¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„åŒºåŸŸï¼Œä¹Ÿè®¸ä½ é¢è¯•æ—¶ä¹Ÿç»å¸¸è¢«é—®åˆ°å§ï¼Œæ¥çœ‹ä¸‹å›¾: å†æ¬¡æé†’ä¸€ä¸‹ï¼Œæ‰€æœ‰ new çš„å¯¹è±¡éƒ½ä¼šåœ¨ Heap ä¸­ï¼Œè¿™æ ·ä»¥åä½ å°±å¥½åŒºåˆ†äº† è¿è¡ŒæœŸå­—ç¬¦ä¸²ç•™é©»ä¸Šé¢è¯´çš„å­—ç¬¦ä¸²ç•™é©»æ˜¯åœ¨ç¼–è¯‘æœŸï¼Œé‚£ä¹ˆè¿è¡ŒæœŸå¯ä»¥å—ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥å¸®å¿™ 1234String c = new String(\"abcd\").intern();String d = new String(\"abcd\").intern();System.out.println(c == d); // Now trueSystem.out.println(c.equals(d)); // True çœ‹åˆ° c == d ç»“æœä¸º trueï¼Œä½ åº”è¯¥ç†è§£ intern (è‹±æ–‡æœ‰æ‹˜ç•™ï¼Œè½¯ç¦çš„æ„æ€)çš„ä½œç”¨äº†ï¼Œé€šè¿‡è°ƒç”¨ intern()æ–¹æ³•ï¼Œå°±å¥½æ¯”æŠŠåˆ›å»ºçš„å­—ç¬¦ä¸²æ‹˜ç•™åœ¨æ–¹æ³•åŒºä¸€æ ·äº† åœ¨é¢è¯•æ—¶ç”šè‡³è¿˜ä¼šé—®ä½ ä¸‹é¢ä»£ç åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡: 1String d = new String(\"abcd\") å¦‚æœæ–¹æ³•åŒºå·²å­˜åœ¨â€abcdâ€, é‚£ä¹ˆåªåˆ›å»ºä¸€ä¸ª new String çš„å¯¹è±¡ å¦‚æœæ–¹æ³•åŒºæ²¡æœ‰â€abcdâ€, é‚£ä¹ˆè¦åˆ›å»ºä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªåœ¨æ–¹æ³•åŒºï¼Œä¸€ä¸ªåœ¨å †ä¸­ æ‰€ä»¥ï¼Œæ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ²¡å¿…è¦ä½¿ç”¨æ„é€ å™¨åˆ›å»ºå¯¹è±¡ï¼Œå› ä¸ºè¿™å¾ˆå¯èƒ½ä¼šäº§ç”Ÿä¸€ä¸ªé¢å¤–çš„æ²¡ç”¨çš„å¯¹è±¡ï¼Œä½†æ˜¯æœ‰ä¾‹å¤–å“¦ï¼Œæˆ‘ä»¬ä¸‹é¢è¯´ 12String s = \"abcd\";s = s.concat(\"ef\"); å½“æˆ‘ä»¬æƒ³åœ¨å­—ç¬¦ä¸² s åé¢æ‹¼æ¥å­—ç¬¦â€efâ€æ—¶ï¼Œä¼šåœ¨å †ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å°† s çš„å¼•ç”¨æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œç”±äº String åˆ›å»ºçš„æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œæ‰€ä»¥ String ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸ä¼šæ”¹å˜å®ƒè‡ªèº«ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²(å¿«æ‰“å¼€ä½ çš„ IDEï¼Œçœ‹çœ‹æ˜¯å¦æ¯ä¸ªæ“ä½œString çš„æ–¹æ³•æœ€åéƒ½æ˜¯è¿”å›æœ‰ return new String å­—æ ·)ï¼Œåˆ°è¿™é‡Œä½ ä¹Ÿåº”è¯¥ç†è§£äº†ä¸€ä¸ªé“ç†: å¦‚æœæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸²è¢«ä¿®æ”¹ï¼Œæˆ‘ä»¬æœ€å¥½ä½¿ç”¨ StringBuffer æˆ–è€… StringBuilderï¼Œå¦åˆ™ï¼Œç”±äºæ¯æ¬¡æ“ä½œå­—ç¬¦ä¸²éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè€Œæ—§çš„å¯¹è±¡ä¸ä¼šæœ‰å¼•ç”¨æŒ‡å‘å®ƒï¼Œè¿™æ ·æˆ‘ä»¬ä¼šæµªè´¹å¾ˆå¤šåƒåœ¾å›æ”¶çš„æ—¶é—´ åˆ°è¿™é‡Œè¿˜æ²¡å®Œï¼Œä½ æœ‰æ²¡æœ‰æƒ³è¿‡ä¸ºä»€ä¹ˆ String ä¼šè¢«è®¾ç½®/åˆ¶é€ æˆ finalï¼Ÿ ä¸ºä»€ä¹ˆ String ç±»è¢« final ä¿®é¥°è°ˆåŠè¿™ä¸ªé—®é¢˜æˆ‘ä»¬éœ€è¦ä¸€äº›å€’æ¨çš„æˆ–è€…ç›¸äº’çº¦æŸæ€ç»´æ¥æ€è€ƒ å­—ç¬¦ä¸²æ± çš„éœ€æ±‚å­—ç¬¦ä¸²æ± (String intern pool)æ˜¯æ–¹æ³•åŒºåŸŸä¸­çš„ä¸€ä¸ªç‰¹æ®Šå­˜å‚¨åŒºåŸŸã€‚å½“åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²å·²ç»å­˜åœ¨äºæ± ä¸­ï¼Œé‚£ä¹ˆè¿”å›ç°æœ‰å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚æ‰€ä»¥è¯´ï¼Œå¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆæ”¹å˜ä¸€ä¸ªå¼•ç”¨çš„å€¼ï¼Œå°†å¯¼è‡´åŸæœ¬æŒ‡å‘è¯¥å€¼çš„å¼•ç”¨è·å–åˆ°é”™è¯¯çš„å€¼ ç¼“å­˜ hashcodeå­—ç¬¦ä¸²çš„hashcodeåœ¨Javaä¸­ç»å¸¸ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨HashMapæˆ–HashSetä¸­ã€‚ä¸å¯å˜ä¿è¯hashcodeå§‹ç»ˆæ˜¯ç›¸åŒçš„ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ä¸æ‹…å¿ƒæ›´æ”¹çš„æƒ…å†µä¸‹å…‘ç°å®ƒã€‚è¿™æ„å‘³ç€ï¼Œä¸éœ€è¦æ¯æ¬¡ä½¿ç”¨hashcodeæ—¶éƒ½è®¡ç®—å®ƒã€‚è¿™æ ·æ›´æœ‰æ•ˆç‡ã€‚æ‰€ä»¥ä½ ä¼šåœ¨ String ç±»ä¸­çœ‹åˆ°ä¸‹é¢çš„æˆå‘˜å˜é‡çš„å®šä¹‰: 12/** Cache the hash code for the string */private int hash; // Default to 0 å®‰å…¨æ€§Stringè¢«å¹¿æ³›ç”¨ä½œè®¸å¤šjavaç±»çš„å‚æ•°ï¼Œä¾‹å¦‚ç½‘ç»œè¿æ¥ã€æ‰“å¼€æ–‡ä»¶ç­‰ã€‚å¦‚æœå­—ç¬¦ä¸²ä¸æ˜¯ä¸å¯å˜çš„ï¼Œè¿æ¥æˆ–æ–‡ä»¶å°†è¢«æ›´æ”¹ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å®‰å…¨å¨èƒã€‚è¯¥æ–¹æ³•è®¤ä¸ºå®ƒè¿æ¥åˆ°ä¸€å°æœºå™¨ä¸Šï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰ã€‚å¯å˜å­—ç¬¦ä¸²ä¹Ÿå¯èƒ½å¯¼è‡´åå°„ä¸­çš„å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºå‚æ•°æ˜¯å­—ç¬¦ä¸²ã€‚ ä¸å¯å˜å¯¹è±¡å¤©ç”Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ç”±äºä¸å¯å˜å¯¹è±¡ä¸èƒ½è¢«æ›´æ”¹ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´è‡ªç”±å…±äº«ã€‚è¿™æ¶ˆé™¤äº†åŒæ­¥çš„éœ€æ±‚ã€‚ æ€»ä¹‹ï¼Œå‡ºäºæ•ˆç‡å’Œå®‰å…¨æ€§çš„è€ƒè™‘ï¼ŒString è¢«è®¾è®¡ä¸ºä¸å¯å˜çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å¯å˜ç±»æ˜¯é¦–é€‰çš„åŸå› ã€‚ é™„åŠ è¯´æ˜å…³äºä¸å¯å˜å¯¹è±¡å’Œä¸å¯å˜å¼•ç”¨æ€»æ˜¯æœ‰åŒå­¦æä¸æ¸…æ¥š 1final User user = new User(); ä¸Šé¢çš„ä»£ç æŒ‡çš„æ˜¯ user å¼•ç”¨ä¸èƒ½è¢«æ›´æ”¹æŒ‡å‘å†…å­˜çš„å…¶ä»–åœ°å€ï¼Œä½†æ˜¯ç”±äº User æ˜¯å¯å˜å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ user çš„ setter æ–¹æ³•ä¿®æ”¹å…¶å±æ€§ åœ¨Stringç±»ä¸­åŒ…å«å¾ˆå¤šå­¦é—®ï¼ŒåŒ…æ‹¬ä½ å¯¹JVMæ¨¡å‹çš„ç†è§£ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆé¢è¯•å®˜ä¸ºä»€ä¹ˆå–œæ¬¢é—®Stringï¼Œä¸»è¦è€ƒå¯Ÿä½ çš„åŸºæœ¬åŠŸ çµé­‚è¿½é—® String å’ŒåŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»å¦‚ Integer å’Œ Long éƒ½è¢« final ä¿®é¥°ï¼Œä½†ä¸ºä»€ä¹ˆä¸å»ºè®®ä½œä¸º synchronized åŒæ­¥å—çš„å‚æ•°é€‚ç”¨å‘¢ï¼Ÿ åŸºæœ¬ç±»å‹è‡ªåŠ¨è£…ç®±ä½ çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆå—ï¼Ÿå’Œä¸Šä¸€ä¸ªé—®é¢˜æœ‰å…³ç³» æé«˜æ•ˆç‡å·¥å…· Material Theme UIè¿™æ˜¯ä¸€æ¬¾ IDEA çš„ä¸»é¢˜æ’ä»¶ï¼Œå®‰è£…åï¼Œé€‰æ‹© Material Palenight ä¸»é¢˜ï¼ŒåŒæ—¶ä½œå‡ºå¦‚ä¸‹è®¾ç½® è®¾ç½®å®Œåï¼Œä½ çš„ IDEA å°±æ˜¯ä¸‹é¢è¿™æ ·ï¼Œå¼•èµ·æåº¦èˆ’é€‚ æ¨èé˜…è¯» æ¯å¤©ç”¨SpringBootï¼Œè¿˜ä¸æ‡‚RESTful APIè¿”å›ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API çº¢é»‘æ ‘ï¼Œè¶…å¼ºåŠ¨é™å›¾è¯¦è§£ï¼Œç®€å•æ˜“æ‡‚ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://dayarch.top/tags/%E9%9D%A2%E8%AF%95/"},{"name":"JVM","slug":"JVM","permalink":"https://dayarch.top/tags/JVM/"}]},{"title":"å¹¶å‘ç¼–ç¨‹ä¸‰å¤§æ ¸å¿ƒ","slug":"åˆ†å·¥-åŒæ­¥-äº’æ–¥æ˜¯å¹¶å‘ç¼–ç¨‹ä¸‰å¤§æ ¸å¿ƒ","date":"2019-08-28T12:29:07.000Z","updated":"2020-03-04T03:44:25.415Z","comments":true,"path":"/p/java-concurrency-core.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-core.html","excerpt":"å†™åœ¨å‰é¢ ä¸Šä¸€ç¯‡æ–‡ç« è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ ç»™å¤§å®¶å¸¦äº†å¹¶å‘ç¼–ç¨‹çš„å¼€èƒƒèœï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€æ­¥ä¸Šæ­£é¤ï¼Œåœ¨åƒæ­£é¤ä¹‹å‰ï¼Œæˆ‘è¿˜è¦å¼•ç”¨é‚£é¦–è¯—è¯: ã€Œæ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œè¿œè¿‘é«˜ä½å„ä¸åŒã€ï¼Œè¿œçœ‹çœ‹è½®å»“ï¼Œè¿‘çœ‹çœ‹ç»†èŠ‚ï¼Œä¸æ–­åˆ‡æ¢æ€ç»´æˆ–è§†è§’æ¥å­¦ä¹  è¿œçœ‹å¹¶å‘ï¼Œå¹¶å‘ç¼–ç¨‹å¯ä»¥æŠ½è±¡æˆä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜: åˆ†å·¥ã€åŒæ­¥/åä½œã€äº’æ–¥ å¦‚æœä½ å·²ç»å·¥ä½œäº†ï¼Œé‚£ä¹ˆä½ ä¸€å®šå¬è¯´è¿‡æˆ–è€…æ­£åœ¨åº”ç”¨æ•æ·å¼€å‘æ¨¡å¼æ¥äº¤ä»˜æ—¥å¸¸çš„å·¥ä½œä»»åŠ¡ï¼Œæˆ‘ä»¬å°±ç”¨ä½ ç†Ÿæ‚‰çš„æµç¨‹æ¥è§£é‡Šè¿™ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ åˆ†å·¥ å°†å½“å‰ Sprint çš„ Story æ‹†åˆ†æˆã€Œåˆé€‚ã€å¤§å°çš„ Taskï¼Œå¹¶ä¸”å®‰æ’ç»™ã€Œåˆé€‚ã€çš„ Team Member å»å®Œæˆ è¿™é‡Œé¢ç”¨äº†ä¸¤ä¸ªã€Œåˆé€‚ã€ï¼Œå°† Story æ‹†åˆ†","text":"å†™åœ¨å‰é¢ä¸Šä¸€ç¯‡æ–‡ç« è¿™æ¬¡èµ°è¿›å¹¶å‘çš„ä¸–ç•Œï¼Œè¯·ä¸è¦é”™è¿‡ ç»™å¤§å®¶å¸¦äº†å¹¶å‘ç¼–ç¨‹çš„å¼€èƒƒèœï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€æ­¥ä¸Šæ­£é¤ï¼Œåœ¨åƒæ­£é¤ä¹‹å‰ï¼Œæˆ‘è¿˜è¦å¼•ç”¨é‚£é¦–è¯—è¯: ã€Œæ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œè¿œè¿‘é«˜ä½å„ä¸åŒã€ï¼Œè¿œçœ‹çœ‹è½®å»“ï¼Œè¿‘çœ‹çœ‹ç»†èŠ‚ï¼Œä¸æ–­åˆ‡æ¢æ€ç»´æˆ–è§†è§’æ¥å­¦ä¹  è¿œçœ‹å¹¶å‘ï¼Œå¹¶å‘ç¼–ç¨‹å¯ä»¥æŠ½è±¡æˆä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜: åˆ†å·¥ã€åŒæ­¥/åä½œã€äº’æ–¥ å¦‚æœä½ å·²ç»å·¥ä½œäº†ï¼Œé‚£ä¹ˆä½ ä¸€å®šå¬è¯´è¿‡æˆ–è€…æ­£åœ¨åº”ç”¨æ•æ·å¼€å‘æ¨¡å¼æ¥äº¤ä»˜æ—¥å¸¸çš„å·¥ä½œä»»åŠ¡ï¼Œæˆ‘ä»¬å°±ç”¨ä½ ç†Ÿæ‚‰çš„æµç¨‹æ¥è§£é‡Šè¿™ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ åˆ†å·¥ å°†å½“å‰ Sprint çš„ Story æ‹†åˆ†æˆã€Œåˆé€‚ã€å¤§å°çš„ Taskï¼Œå¹¶ä¸”å®‰æ’ç»™ã€Œåˆé€‚ã€çš„ Team Member å»å®Œæˆ è¿™é‡Œé¢ç”¨äº†ä¸¤ä¸ªã€Œåˆé€‚ã€ï¼Œå°† Story æ‹†åˆ†æˆå¤§å°é€‚ä¸­ï¼Œå¯å®Œæˆçš„ Task æ˜¯éå¸¸é‡è¦çš„ã€‚æ‹†åˆ†çš„ç²’åº¦å¤ªç²—ï¼Œå¯¼è‡´è¿™ä¸ªä»»åŠ¡å®Œæˆéš¾åº¦å˜é«˜ï¼Œè€—æ—¶é•¿ï¼Œä¸æ˜“ä¸å…¶ä»–äººé…åˆï¼›æ‹†åˆ†çš„ç²’åº¦å¤ªç»†ï¼Œåˆå¯¼è‡´ä»»åŠ¡å¤ªå¤šï¼Œä¸å¥½ç®¡ç†ä¸è¿½è¸ªï¼Œæµªè´¹ç²¾åŠ›å’Œèµ„æºã€‚(åˆé€‚çš„çº¿ç¨‹æ‰èƒ½æ›´å¥½çš„å®Œæˆæ•´å—å·¥ä½œï¼Œå½“ç„¶ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è½»æ¾æå®šçš„å°±æ²¡å¿…è¦å¤šçº¿ç¨‹)ï¼›å®‰æ’ç»™åˆé€‚çš„äººå‘˜å»å®ŒæˆåŒæ ·é‡è¦ï¼ŒUX-UE é—®é¢˜äº¤ç»™åç«¯äººå‘˜å¤„ç†ï¼Œå¾ˆæ˜¾ç„¶æ˜¯æœ‰é—®é¢˜çš„ (ä¸»çº¿ç¨‹åº”è¯¥åšçš„äº‹äº¤ç»™å­çº¿ç¨‹æ˜¾ç„¶æ˜¯è§£å†³ä¸äº†é—®é¢˜çš„ï¼Œæ¯ä¸ªçº¿ç¨‹åšæ­£ç¡®çš„äº‹æ‰èƒ½å‘æŒ¥ä½œç”¨) å…³äºåˆ†å·¥ï¼Œå¸¸è§çš„ Executorï¼Œç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼ŒFork/Join ç­‰ï¼Œè¿™éƒ½æ˜¯åˆ†å·¥æ€æƒ³çš„ä½“ç° åŒæ­¥/åä½œä»»åŠ¡æ‹†åˆ†å®Œæ¯•ï¼Œæˆ‘è¦ç­‰å¼ ä¸‰çš„ä»»åŠ¡ï¼Œå¼ ä¸‰è¦ç­‰æå››çš„ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯è¯´ä»»åŠ¡ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå‰é¢çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œåé¢çš„ä»»åŠ¡æ‰å¯ä»¥æ‰§è¡Œï¼Œäººé«˜çº§åœ¨å¯ä»¥é€šè¿‡æ²Ÿé€šåå¤ç¡®è®¤ï¼Œç¡®ä¿è‡ªå·±çš„ä»»åŠ¡å¯ä»¥å¼€å§‹æ‰§è¡Œã€‚ä½†é¢å¯¹ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ç¨‹åºçš„æ²Ÿé€šæ–¹å¼ï¼Œä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡ï¼Œå¦‚ä½•é€šçŸ¥åç»­çº¿ç¨‹æ‰§è¡Œ æ‰€æœ‰çš„åŒæ­¥/åä½œå…³ç³»æˆ‘ä»¬éƒ½å¯ä»¥ç”¨ä½ æœ€ç†Ÿæ‚‰çš„ If-then-else æ¥è¡¨ç¤º: 12345if(å‰åºä»»åŠ¡å®Œæˆ)&#123; execute();&#125;else&#123; wait();&#125; ä¸Šé¢çš„ä»£ç å°±æ˜¯è¯´:å½“æŸä¸ªæ¡ä»¶ä¸æ»¡è¶³æ—¶ï¼Œçº¿ç¨‹éœ€è¦ç­‰å¾…ï¼›å½“æŸä¸ªæ¡ä»¶æ»¡è¶³æ—¶ï¼Œçº¿ç¨‹éœ€è¦è¢«å”¤é†’æ‰§è¡Œï¼Œçº¿ç¨‹ä¹‹é—´çš„åä½œå¯èƒ½æ˜¯ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹çš„åä½œï¼Œå¯èƒ½æ˜¯å­çº¿ç¨‹ä¸å­çº¿ç¨‹çš„åˆä½œï¼Œ Java SDK ä¸­ CountDownLatch å’Œ CyclicBarrier å°±æ˜¯ç”¨æ¥è§£å†³çº¿ç¨‹åä½œé—®é¢˜çš„ äº’æ–¥åˆ†å·¥å’ŒåŒæ­¥å¼ºè°ƒçš„æ˜¯æ€§èƒ½ï¼Œä½†æ˜¯äº’æ–¥æ˜¯å¼ºè°ƒæ­£ç¡®æ€§ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸å¸¸æåˆ°çš„ã€Œçº¿ç¨‹å®‰å…¨ã€ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå…±äº«å˜é‡/æˆå‘˜å˜é‡æ—¶ï¼Œå°±å¯èƒ½å‘ç”Ÿä¸ç¡®å®šæ€§ï¼Œé€ æˆä¸ç¡®å®šæ€§ä¸»è¦æ˜¯æœ‰å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§è¿™ä¸‰å¤§é—®é¢˜ï¼Œè€Œè§£å†³è¿™äº›é—®é¢˜çš„æ ¸å¿ƒå°±æ˜¯äº’æ–¥ äº’æ–¥ åŒä¸€æ—¶åˆ»ï¼Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®å…±äº«å˜é‡ æ¥çœ‹ä¸‹å›¾ï¼Œä¸»å¹²è·¯å°±æ˜¯å…±äº«å˜é‡ï¼Œè¿›å…¥ä¸»å¹²è·¯ä¸€æ¬¡åªèƒ½æœ‰ä¸€è¾†è½¦ï¼Œè¿™æ ·ä½ æ˜¯å¦ç†è§£äº†å‘¢ï¼Ÿã€Œå¤©ä¸‹å¤§äº‹ï¼Œåˆ†ä¹…å¿…åˆã€ åŒæ · Java SDK ä¹Ÿæœ‰å¾ˆå¤šäº’æ–¥çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚ä½ é©¬ä¸Šå°±èƒ½æƒ³åˆ° synchronized å…³é”®å­—ï¼ŒLockï¼ŒThreadLocal ç­‰å°±æ˜¯äº’æ–¥çš„è§£å†³æ–¹æ¡ˆ æ€»ç»“èµ„æœ¬å®¶ç–¯ç‹‚æ¦¨å–åŠ³åŠ¨å·¥äººçš„å‰©ä½™ä»·å€¼ï¼Œè·å¾—æœ€å¤§æ”¶ç›Šã€‚å½“ä½ é¢å¯¹ CPUï¼Œå†…å­˜ï¼ŒIO è¿™äº›åŠ³åŠ¨å·¥äººæ—¶ï¼Œä½ å°±æ˜¯é‚£ä¸ªèµ„æœ¬å®¶ï¼Œä½ è¦æ€è€ƒå¦‚ä½•å……åˆ†æ¦¨å–å®ƒä»¬çš„ä»·å€¼ å½“ä¸€ä¸ªå·¥äººèƒ½å¹²çš„æ´»ï¼Œç»ä¸è®©ä¸¤ä¸ªäººæ¥å¹²(å•çº¿ç¨‹èƒ½æ»¡è¶³å°±æ²¡å¿…è¦ä¸ºäº†å¤šçº¿ç¨‹)å½“å¤šä¸ªå·¥äººå¹²æ´»æ—¶ï¼Œå°±è¦è®©ä»–ä»¬åˆ†å·¥æ˜ç¡®ï¼Œåˆä½œé¡ºç•…ï¼Œæ²¡çŸ›ç›¾ å½“ä»»åŠ¡å¾ˆå¤§æ—¶ï¼Œç”±äº IO å¹²æ´»æ…¢ï¼ŒCPU å¹²æ´»å¿«ï¼Œå°±æ²¡å¿…è¦è®© CPU æ­»ç­‰å½“å‰çš„ IOï¼Œè½¬è€Œå»æ‰§è¡Œå…¶ä»–æŒ‡ä»¤ï¼Œè¿™å°±æ˜¯æ¦¨å–å‰©ä½™ä»·å€¼ï¼Œå¦‚ä½•æœ€å¤§é™åº¦çš„æ¦¨å–å…¶ä»·å€¼ï¼Œè¿™å°±æ¶‰åŠåˆ°åç»­çš„è°ƒä¼˜é—®é¢˜ï¼Œæ¯”å¦‚å¤šå°‘çº¿ç¨‹åˆé€‚ç­‰ åˆ†å·¥æ˜¯è®¾è®¡ï¼ŒåŒæ­¥å’Œäº’æ–¥æ˜¯å®ç°ï¼Œæ²¡æœ‰å¥½çš„è®¾è®¡ä¹Ÿå°±æ²¡æœ‰å¥½çš„å®ç°ï¼Œæ‰€ä»¥åœ¨åˆ†å·¥é˜¶æ®µï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶å‹¾åˆ’è‰å›¾ï¼Œäº†è§£ç“¶é¢ˆæ‰€åœ¨ï¼Œè¿™æ ·æ‰ä¼šæœ‰æ›´å¥½çš„å®ç°ï¼Œåç»­ç« èŠ‚çš„å†…å®¹ï¼Œæˆ‘ä¹Ÿä¼šå¸¦é¢†å¤§å®¶ç”»è‰å›¾ï¼Œåˆ†æé—®é¢˜ï¼Œé€æ­¥å…»æˆè¿™ä¸ªä¹ æƒ¯ æœ¬ç« å†…å®¹å¯ä»¥ç”¨ä¸‹é¢çš„å›¾æ¥ç®€å•æ¦‚æ‹¬ï¼Œå¶å­ç»“ç‚¹çš„å†…å®¹æˆ‘ä»¬ä¼šé€æ­¥ç‚¹äº®ï¼Œç°é˜¶æ®µä¸ç”¨è¿‡åˆ†å…³æ³¨(å¦‚æœä½ ä¸Šæ¥å°±å•ƒ JDK æºç ï¼Œä¹Ÿè®¸ä½ ä¼šç—›è‹¦çš„è¿·å¤±ï¼Œå¹¶æœ€ç»ˆæ”¾å¼ƒä½ çš„è¿›é˜¶ä¹‹è·¯çš„) ç†è§£ä¸‰å¤§æ ¸å¿ƒé—®é¢˜ï¼Œä½ è¦å……åˆ†ç»“åˆç”Ÿæ´»ä¸­çš„å®é™…ï¼Œç¨‹åºä¸­çš„å¹¶å‘é—®é¢˜ï¼ŒåŸºæœ¬ä¸Šéƒ½èƒ½åœ¨å®é™…ç”Ÿæ´»ä¸­æ‰¾å¾—åˆ°åŸå‹ ä¸‹ä¸€ç¯‡æ–‡ç« çš„å†…å®¹ï¼Œæˆ‘ä»¬å°±è¦èŠèŠï¼Œå¼•èµ·çº¿ç¨‹å®‰å…¨çš„ä¸‰ä¸ªé—®é¢˜:ã€Œå¯è§æ€§ï¼ŒåŸå­æ€§ï¼Œæœ‰åºæ€§ã€ï¼Œè¿™æ¶‰åŠåˆ° JMM çš„ä¸€ç‚¹å†…å®¹ï¼Œå¯ä»¥æå‰äº†è§£ä¸€ä¸‹çš„ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½æ›´å¥½çš„ç¢°æ’ çµé­‚è¿½é—® å·¥ä½œä¸­å¤šçº¿ç¨‹ç¼–ç¨‹çš„åœºæ™¯å¤šå—ï¼Ÿ æƒ³åˆ°å¤šçº¿ç¨‹ï¼Œåªä¼šæƒ³åˆ° synchronized å—ï¼Ÿ Java å¹¶å‘åŒ…å„ä¸ªç±»ï¼Œä½ æœ‰äº†è§£åº•å±‚å®ç°å’Œè®¾è®¡ç†å¿µå—ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» æ¯å¤©ç”¨SpringBootï¼Œè¿˜ä¸æ‡‚RESTful APIè¿”å›ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API çº¢é»‘æ ‘ï¼Œè¶…å¼ºåŠ¨é™å›¾è¯¦è§£ï¼Œç®€å•æ˜“æ‡‚ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"åˆ†å·¥","slug":"åˆ†å·¥","permalink":"https://dayarch.top/tags/%E5%88%86%E5%B7%A5/"},{"name":"åŒæ­¥","slug":"åŒæ­¥","permalink":"https://dayarch.top/tags/%E5%90%8C%E6%AD%A5/"},{"name":"äº’æ–¥","slug":"äº’æ–¥","permalink":"https://dayarch.top/tags/%E4%BA%92%E6%96%A5/"},{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"}]},{"title":"å¹¶å‘ç¼–ç¨‹ä¹‹åˆæ¢","slug":"å¹¶å‘ç¼–ç¨‹ä¹‹åˆæ¢","date":"2019-08-25T11:45:08.000Z","updated":"2020-03-04T03:44:11.512Z","comments":true,"path":"/p/java-concurrency-metaphor.html","link":"","permalink":"https://dayarch.top/p/java-concurrency-metaphor.html","excerpt":"å†™åœ¨å‰é¢ Java æœ‰è¿›é˜¶ï¼Œå…¶åä¸ºå¹¶å‘ï¼Œå¹¶å‘çŸ¥è¯†ä¹‹å¤§ï¼Œä¸€å£åƒä¸ä¸‹ã€‚é‚£å¥½ï¼Œè¯·æ‚¨å¤šåƒå‡ å£ï¼Œåˆæ²¡è¯´ä¸€é¡¿åƒå®Œï¼Œç»†åš¼æ…¢å’½æ‰æœ‰å‘³. æ‰€æœ‰ Java ä¹¦ç±éƒ½å°†å¹¶å‘ç¼–ç¨‹æ”¾åœ¨å…¶é«˜çº§/è¿›é˜¶ç¯‡ç« ä¸­ï¼Œå…¶é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå­¦å¥½å¹¶å‘ä¹Ÿæ˜¯è‡ªèº«èµ°å…¥é«˜çº§è¡Œåˆ—çš„å¿…å¤‡ç´ è´¨ä¹‹ä¸€ å¹¶å‘/å¹¶è¡Œï¼Œè¿›ç¨‹/çº¿ç¨‹ è¿™äº›æ¦‚å¿µæ€»æ˜¯æ˜¾å¾—è¿‡äºæŠ½è±¡ï¼Œå› ä¸ºè¿™æ˜¯ä¸æ“ä½œç³»ç»Ÿæ²Ÿé€šç”¨åˆ°çš„è¯æ±‡ï¼Œå°±åƒæˆ‘ä»¬ä¹ æƒ¯äº†ä½¿ç”¨åè¿›åˆ¶ç®—æ³•ï¼ŒäºŒè¿›åˆ¶å’Œ 16 è¿›åˆ¶å°±éœ€è¦æ€ç»´çš„åˆ‡æ¢ï¼›ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å½¼æ­¤æ€»æ˜¯ä¸èƒ½äº’ç›¸ç†è§£ï¼Œå¹³é™ä¹‹åï¼Œæˆ‘ä»¬çŸ¥é“è¦æ¢ä½æ€è€ƒï¼›ç¨‹åºçš„ä¸–ç•Œä¹Ÿä¸€æ ·ï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£é—®é¢˜ï¼Œä½ ä¹Ÿè¦ç«™åœ¨æ“ä½œç³»ç»Ÿçš„è§’åº¦æ¥æ€è€ƒé—®é¢˜ï¼Œä½†å½“ä½ å°è¯•ç†è§£å¯¹æ–¹æ—¶ï¼Œæ˜¯è¿èƒŒè‡ªå·±è®¤çŸ¥ä¹ æƒ¯çš„ï¼Œæ‰€ä»¥æœ‰äº›å›°éš¾åœ¨æ‰€éš¾å… ç”Ÿ","text":"å†™åœ¨å‰é¢Java æœ‰è¿›é˜¶ï¼Œå…¶åä¸ºå¹¶å‘ï¼Œå¹¶å‘çŸ¥è¯†ä¹‹å¤§ï¼Œä¸€å£åƒä¸ä¸‹ã€‚é‚£å¥½ï¼Œè¯·æ‚¨å¤šåƒå‡ å£ï¼Œåˆæ²¡è¯´ä¸€é¡¿åƒå®Œï¼Œç»†åš¼æ…¢å’½æ‰æœ‰å‘³. æ‰€æœ‰ Java ä¹¦ç±éƒ½å°†å¹¶å‘ç¼–ç¨‹æ”¾åœ¨å…¶é«˜çº§/è¿›é˜¶ç¯‡ç« ä¸­ï¼Œå…¶é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå­¦å¥½å¹¶å‘ä¹Ÿæ˜¯è‡ªèº«èµ°å…¥é«˜çº§è¡Œåˆ—çš„å¿…å¤‡ç´ è´¨ä¹‹ä¸€ å¹¶å‘/å¹¶è¡Œï¼Œè¿›ç¨‹/çº¿ç¨‹ è¿™äº›æ¦‚å¿µæ€»æ˜¯æ˜¾å¾—è¿‡äºæŠ½è±¡ï¼Œå› ä¸ºè¿™æ˜¯ä¸æ“ä½œç³»ç»Ÿæ²Ÿé€šç”¨åˆ°çš„è¯æ±‡ï¼Œå°±åƒæˆ‘ä»¬ä¹ æƒ¯äº†ä½¿ç”¨åè¿›åˆ¶ç®—æ³•ï¼ŒäºŒè¿›åˆ¶å’Œ 16 è¿›åˆ¶å°±éœ€è¦æ€ç»´çš„åˆ‡æ¢ï¼›ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å½¼æ­¤æ€»æ˜¯ä¸èƒ½äº’ç›¸ç†è§£ï¼Œå¹³é™ä¹‹åï¼Œæˆ‘ä»¬çŸ¥é“è¦æ¢ä½æ€è€ƒï¼›ç¨‹åºçš„ä¸–ç•Œä¹Ÿä¸€æ ·ï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£é—®é¢˜ï¼Œä½ ä¹Ÿè¦ç«™åœ¨æ“ä½œç³»ç»Ÿçš„è§’åº¦æ¥æ€è€ƒé—®é¢˜ï¼Œä½†å½“ä½ å°è¯•ç†è§£å¯¹æ–¹æ—¶ï¼Œæ˜¯è¿èƒŒè‡ªå·±è®¤çŸ¥ä¹ æƒ¯çš„ï¼Œæ‰€ä»¥æœ‰äº›å›°éš¾åœ¨æ‰€éš¾å… ç”Ÿæ´»ä¸­ä½ ä¸€å®šè¯´è¿‡ã€Œæ€é¸¡ç„‰ç”¨ç‰›åˆ€ï¼Ÿã€è¿™å¥è¯ï¼Œå¹¶å‘ç¼–ç¨‹ä¸­çš„å„ç§é”(å†…ç½®é”/æ˜¾ç¤ºé”/åå‘é”/è½»é‡é”/é‡é‡é”/ä¹è§‚é”/æ‚²è§‚é”)ï¼Œçœ‹åˆ°çœ¼èŠ±ç¼­ä¹±ï¼Œæœ‰æ—¶å€™å¾ˆå°çš„é—®é¢˜å´ç”¨äº†å¾ˆé‡çš„é”ï¼Œè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼›ä½†æ˜¯è¿™äº›é”ï¼Œæ²¡æœ‰æœ€å¥½çš„é‚£ä¸ªï¼Œåªæœ‰æœ€åˆé€‚å’Œæ›´é«˜æ•ˆçš„é‚£ä¸ª JUC (java.util.concurrent) åŒ…éšç€ JDK çš„ç‰ˆæœ¬å‡çº§å†…å®¹ä¹Ÿå˜çš„è¶Šæ¥è¶Šå¤šï¼Œé¢å¯¹ç³ç…æ»¡ç›®çš„å¹¶å‘ç±»ï¼Œåˆæœ‰äº›æ— ä»ä¸‹æ‰‹ï¼Œå…¶å®ä»–ä»¬éƒ½æœ‰ä¸€å®šçš„è”ç³»ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å‡çº§çš„ä¸»çº¿ï¼Œè®©å…¶å˜å¾—æœ‰è¿¹å¯å¾ª. è°ˆåŠå¹¶å‘ç¼–ç¨‹ï¼Œæˆ‘è¿˜æ˜¯å¸¦æœ‰ä¸€ä¸æƒ¶æ: å¦‚ä½•å°†è¿™äº›æŠ½è±¡çš„æ¦‚å¿µå˜å¾—å…·è±¡ï¼Ÿ å¦‚ä½•å°†ç¼–ç¨‹é—®é¢˜è”ç³»åˆ°ç”Ÿæ´»å®é™…? å¦‚ä½•åœ¨æŠ½è±¡å’Œå…·è±¡ä¹‹é—´åˆ‡æ¢æ€ç»´? ä¸ªäººè§‰å¾—è¿™äº›éƒ½æ˜¯å­¦å¥½å¹¶å‘ç¼–ç¨‹çš„å…³é”®ã€‚æ‰€ä»¥å…³äºå¹¶å‘ç¼–ç¨‹çš„ç³»åˆ—æ–‡ç« ï¼Œæˆ‘æ‰“ç®—ä»ä»¥ä¸Šå‡ ç‚¹å‡ºå‘ï¼Œå°†æŠ€æœ¯é—®é¢˜ä»¥å¹½é»˜é£è¶£å…·è±¡çš„æ–¹å¼è½åœ° å¦‚ä½•å­¦å¹¶å‘ã€Œæ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œè¿œè¿‘é«˜ä½å„ä¸åŒã€ï¼Œåœ¨ä¹‹å‰çš„æ–‡ç« ä¸­å¤šæ¬¡å¼•ç”¨äº†è¿™æ®µè¯—è¯ï¼Œæˆ‘ä»¬å­¦ä¹ æŠ€æœ¯ä¹Ÿè¦è¿™æ ·ï¼Œè¿œè§‚çœ‹è½®å»“ï¼Œè¿‘è§‚çœ‹ç»†èŠ‚ï¼Œä»ä¸åŒçš„è§’åº¦çœ‹å¾…é—®é¢˜ï¼Œåœ¨åç»­çš„æ–‡ç« ä¸­ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶ä¸è¦å°†æ€ç»´å±€é™ï¼Œå°è¯•è·³å…¥/è·³å‡ºï¼ŒæŠ½è±¡/å…·è±¡ éƒ‘é‡å£°æ˜ï¼Œæ¥ä¸‹æ¥ä¸æ˜¯å¹¿å‘Šæˆ‘å¸Œæœ›å’Œå¤§å®¶å…±åŒå®Œæˆå¹¶å‘ç¼–ç¨‹ç³»åˆ—æœ‰æ›´å¤šçš„æ€æƒ³ç¢°æ’ï¼Œå¸Œæœ›å¤§å®¶åœ¨è¯»è¿™ä¸ªç³»åˆ—çš„åŒæ—¶ä¹Ÿé˜…è¯»ä»¥ä¸‹ä¹¦ç±é€æ­¥å½¢æˆè‡ªå·±çš„çŸ¥è¯†ä½“ç³»ï¼Œè¿™é‡Œé™„ä¸Šä¸ªäººè®¤ä¸ºçš„æœ€ä½³é˜…è¯»é¡ºåº: 1.ã€ŒJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€ è¯¥ä¹¦ç±æ˜¯å€¼å¾—è¿”å›çœ‹çš„ï¼Œç¬¬ä¸€éä¸éœ€è¦ç²¾åº¦ï¼Œä¸»è¦æ˜¯ä¸ºäº†å»ºç«‹ä¸€ä¸ªå¹¶å‘çš„æ€æƒ³ï¼Œå’Œå…³é”®æœ¯è¯­çš„å¤§è‡´è®°å¿†ï¼Œå…ˆé˜…è¯»ç¬¬ 16 ç« ä¹Ÿæ˜¯æå¥½çš„ï¼Œç†è§£ JMM æ˜¯å®è·µå¹¶å‘ç¼–ç¨‹çš„åŸºç¡€ 2. ã€Œç å‡ºé«˜æ•ˆã€å¯ç›´æ¥é˜…è¯»ç¬¬ä¸ƒç« ã€Œå¹¶å‘ä¸å¤šçº¿ç¨‹ã€ï¼Œè¿™ä¸ªç« èŠ‚æ›´å¥½çš„å°†æŠ€æœ¯é—®é¢˜è”ç³»åˆ°äº†ç”Ÿæ´»å®é™…ï¼Œæœ‰äº†ã€Œå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€çš„é“ºåº•ï¼Œç›¸ä¿¡ï¼Œçœ‹è¿™ä¸ªç« èŠ‚ä¼šæ›´æœ‰æ„Ÿè§‰ 3. ã€ŒJavaå¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€ è¿™æœ¬ä¹¦ä»ç¬¬ 5 ç« å¼€å§‹ï¼Œå°±ä¼šæœ‰æºç åˆ†æï¼Œæœ‰å‰è¾ˆå¸¦é¢†è¯»æºç ï¼Œè½»æ¾å¤šäº†ï¼Œè¿™å›è®©ä½ æ›´åŠ äº†è§£æœ¬è´¨ï¼ŒåŒæ—¶ä¹Ÿä¼šæ‰¾åˆ° JUC å‡çº§çš„ä¸»çº¿ 4. ã€ŒJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€è¿™æœ¬ä¹¦ä¼šæ»¡è¶³ä½ ä»å„ä¸ªè§’åº¦çœ‹å¾…å¹¶å‘ç¼–ç¨‹é—®é¢˜ æ…é‡ï¼Œå¦‚æœä½ æ˜¯ä¹°ä¹¦å¦‚å±±å€’ï¼Œè¯»ä¹¦å¦‚æŠ½ä¸çš„ç«¥é‹ï¼Œè¯·å¿½ç•¥è¿™ç‚¹å†…å®¹ï¼Œåœæ­¢ä½ çš„ä¹°ä¹¦è¡ŒåŠ¨ï¼Œè¯·å®‰å¿ƒè·Ÿè¸ªå…¬ä¼—å·çš„å†…å®¹å³å¯ è®¡åˆ’å¦‚æ— ç‰¹æ®Šå¼‚å¸¸ï¼Œä¼šæŒ‰ç…§ 1 å‘¨ 1 ç¯‡çš„èŠ‚å¥æ¥åˆ†äº«ï¼Œä¼šæ§åˆ¶ç¯‡å¹…å¤§å°ï¼Œç»™å¤§å®¶ç•™æœ‰æ€è€ƒç©ºé—´ï¼ŒæœŸå¾…å¤§å®¶å¸¦ç€ç–‘é—®ç­‰å¾…ä¸‹ä¸€ç¯‡æ–‡ç« çš„åˆ°æ¥ï¼Œæˆ‘ä¼šä»å¤§å®¶æ›´å¤šäº†è§£çš„å†…å®¹å‡ºå‘ï¼Œé€æ­¥èµ°å…¥å¹¶å‘çš„ä¸–ç•Œ å¹¶å‘å¼€èƒƒèœä¸å†å¤šåºŸè¯ï¼Œæ‹¿å‡ºä¹‹å‰æ”¶è—çš„ä¸€ç¯‡æ–‡ç« ä½œä¸ºå¹¶å‘ç¼–ç¨‹çš„å¼€èƒƒå°èœï¼Œé€šè¿‡è¿™ä¸ªå½¢è±¡æ¯”å–»ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¯¹å¹¶å‘æœ‰ä¸ªåˆæ­¥çš„äº†è§£: æ‘˜è‡ª: https://www.cnblogs.com/CoolRandy/p/3169938.html è§‰å¾—å›¾è§£çš„å¾ˆåˆ°ä½ï¼Œå°†å¹¶å‘ç¼–ç¨‹çš„å‡ ä¸ªæ ¸å¿ƒè¦ç´ éƒ½ä»¥å…·è±¡çš„å½¢å¼è¡¨è¾¾å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹ä½•ä¸º è¿›ç¨‹ï¼ˆprocessï¼‰å’Œ çº¿ç¨‹ï¼ˆthreadï¼‰ 1.è®¡ç®—æœºçš„æ ¸å¿ƒæ˜¯CPUï¼Œå®ƒæ‰¿æ‹…äº†æ‰€æœ‰çš„è®¡ç®—ä»»åŠ¡ã€‚å®ƒå°±åƒä¸€åº§å·¥å‚ï¼Œæ—¶åˆ»åœ¨è¿è¡Œã€‚ 2.å‡å®šå·¥å‚çš„ç”µåŠ›æœ‰é™ï¼Œä¸€æ¬¡åªèƒ½ä¾›ç»™ä¸€ä¸ªè½¦é—´ä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªè½¦é—´å¼€å·¥çš„æ—¶å€™ï¼Œå…¶ä»–è½¦é—´éƒ½å¿…é¡»åœå·¥ã€‚èƒŒåçš„å«ä¹‰å°±æ˜¯ï¼Œå•ä¸ª CPU ä¸€æ¬¡åªèƒ½è¿è¡Œä¸€ä¸ªä»»åŠ¡ã€‚ 3.è¿›ç¨‹å°±å¥½æ¯”å·¥å‚çš„è½¦é—´ï¼Œå®ƒä»£è¡¨ CPU æ‰€èƒ½å¤„ç†çš„å•ä¸ªä»»åŠ¡ã€‚ä»»ä¸€æ—¶åˆ»ï¼ŒCPU æ€»æ˜¯è¿è¡Œä¸€ä¸ª è¿›ç¨‹ï¼Œå…¶ä»– è¿›ç¨‹ å¤„äºéè¿è¡ŒçŠ¶æ€ã€‚ 4.ä¸€ä¸ªè½¦é—´é‡Œï¼Œå¯ä»¥æœ‰å¾ˆå¤šå·¥äººã€‚ä»–ä»¬ååŒå®Œæˆä¸€ä¸ªä»»åŠ¡ã€‚ 5.çº¿ç¨‹ å°±å¥½æ¯”è½¦é—´é‡Œçš„å·¥äººã€‚ä¸€ä¸ª è¿›ç¨‹ å¯ä»¥åŒ…æ‹¬å¤šä¸ª çº¿ç¨‹ã€‚ 6.è½¦é—´çš„ç©ºé—´æ˜¯å·¥äººä»¬å…±äº«çš„ï¼Œæ¯”å¦‚è®¸å¤šæˆ¿é—´æ˜¯æ¯ä¸ªå·¥äººéƒ½å¯ä»¥è¿›å‡ºçš„ã€‚è¿™è±¡å¾ä¸€ä¸ª è¿›ç¨‹ çš„å†…å­˜ç©ºé—´æ˜¯å…±äº«çš„ï¼Œæ¯ä¸ª çº¿ç¨‹ éƒ½å¯ä»¥ä½¿ç”¨è¿™äº›å…±äº«å†…å­˜ã€‚ 7.å¯æ˜¯ï¼Œæ¯é—´æˆ¿é—´çš„å¤§å°ä¸åŒï¼Œæœ‰äº›æˆ¿é—´æœ€å¤šåªèƒ½å®¹çº³ä¸€ä¸ªäººï¼Œæ¯”å¦‚å•æ‰€ã€‚é‡Œé¢æœ‰äººçš„æ—¶å€™ï¼Œå…¶ä»–äººå°±ä¸èƒ½è¿›å»äº†ã€‚è¿™ä»£è¡¨ä¸€ä¸ª çº¿ç¨‹ ä½¿ç”¨æŸäº›å…±äº«å†…å­˜æ—¶ï¼Œå…¶ä»– çº¿ç¨‹ å¿…é¡»ç­‰å®ƒç»“æŸï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸€å—å†…å­˜ã€‚ 8.ä¸€ä¸ªé˜²æ­¢ä»–äººè¿›å…¥çš„ç®€å•æ–¹æ³•ï¼Œå°±æ˜¯é—¨å£åŠ ä¸€æŠŠé”ã€‚å…ˆåˆ°çš„äººé”ä¸Šé—¨ï¼Œååˆ°çš„äººçœ‹åˆ°ä¸Šé”ï¼Œå°±åœ¨é—¨å£æ’é˜Ÿï¼Œç­‰é”æ‰“å¼€å†è¿›å»ã€‚è¿™å°±å« â€œäº’æ–¥é”â€ï¼ˆMutual exclusionï¼Œç¼©å†™ Mutexï¼‰ï¼Œé˜²æ­¢å¤šä¸ª çº¿ç¨‹ åŒæ—¶è¯»å†™æŸä¸€å—å†…å­˜åŒºåŸŸã€‚ 9.è¿˜æœ‰äº›æˆ¿é—´ï¼Œå¯ä»¥åŒæ—¶å®¹çº³ n ä¸ªäººï¼Œæ¯”å¦‚å¨æˆ¿ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœäººæ•°å¤§äºnï¼Œå¤šå‡ºæ¥çš„äººåªèƒ½åœ¨å¤–é¢ç­‰ç€ã€‚è¿™å¥½æ¯”æŸäº›å†…å­˜åŒºåŸŸï¼Œåªèƒ½ä¾›ç»™å›ºå®šæ•°ç›®çš„ çº¿ç¨‹ ä½¿ç”¨ã€‚ 10.è¿™æ—¶çš„è§£å†³æ–¹æ³•ï¼Œå°±æ˜¯åœ¨é—¨å£æŒ‚ n æŠŠé’¥åŒ™ã€‚è¿›å»çš„äººå°±å–ä¸€æŠŠé’¥åŒ™ï¼Œå‡ºæ¥æ—¶å†æŠŠé’¥åŒ™æŒ‚å›åŸå¤„ã€‚ååˆ°çš„äººå‘ç°é’¥åŒ™æ¶ç©ºäº†ï¼Œå°±çŸ¥é“å¿…é¡»åœ¨é—¨å£æ’é˜Ÿç­‰ç€äº†ã€‚è¿™ç§åšæ³•å«åš â€œä¿¡å·é‡â€ï¼ˆSemaphoreï¼‰ï¼Œç”¨æ¥ä¿è¯å¤šä¸ª çº¿ç¨‹ ä¸ä¼šäº’ç›¸å†²çªã€‚ ä¸éš¾çœ‹å‡ºï¼ŒMutex (äº’æ–¥é”) æ˜¯ Semaphore (ä¿¡å·é‡)çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼ˆn=1æ—¶ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®Œå…¨å¯ä»¥ç”¨åè€…æ›¿ä»£å‰è€…ã€‚ä½†æ˜¯ï¼Œå› ä¸º mutex è¾ƒä¸ºç®€å•ï¼Œä¸”æ•ˆç‡é«˜ï¼Œæ‰€ä»¥åœ¨å¿…é¡»ä¿è¯èµ„æºç‹¬å çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯é‡‡ç”¨è¿™ç§è®¾è®¡ã€‚ 11.æ“ä½œç³»ç»Ÿçš„è®¾è®¡ï¼Œå› æ­¤å¯ä»¥å½’ç»“ä¸ºä¸‰ç‚¹ï¼šï¼ˆ1ï¼‰ä»¥å¤š è¿›ç¨‹ å½¢å¼ï¼Œå…è®¸å¤šä¸ªä»»åŠ¡åŒæ—¶è¿è¡Œï¼›ï¼ˆ2ï¼‰ä»¥å¤š çº¿ç¨‹ å½¢å¼ï¼Œå…è®¸å•ä¸ªä»»åŠ¡åˆ†æˆä¸åŒçš„éƒ¨åˆ†è¿è¡Œï¼›ï¼ˆ3ï¼‰æä¾›åè°ƒæœºåˆ¶ï¼Œä¸€æ–¹é¢é˜²æ­¢ è¿›ç¨‹ ä¹‹é—´å’Œ çº¿ç¨‹ ä¹‹é—´äº§ç”Ÿå†²çªï¼Œå¦ä¸€æ–¹é¢å…è®¸ è¿›ç¨‹ ä¹‹é—´å’Œ çº¿ç¨‹ ä¹‹é—´å…±äº«èµ„æºã€‚ ç›¸ä¿¡çœ‹è¿‡è¿™ä¹‹åå°±äº†è§£äº†å¹¶å‘ç¼–ç¨‹å¤§æ¦‚è¦å…³æ³¨çš„ä¸€äº›å†…å®¹äº†ï¼Œåœ¨åç»­çš„æ–‡ç« ä¸­ï¼Œå¸Œæœ›å¤§å®¶ç‰¢è®°ï¼Œä½ æ˜¯ä¸€ä¸ªå·¥å‚åªèƒ½æœ‰ä¸€ä¸ªè½¦é—´è¿è¡Œçš„è´Ÿè´£äººï¼Œå¦‚ä½•è®©å·¥äººé«˜æ•ˆçš„å¹²æ´»ä¸”ä¸å‡ºå·®é”™ï¼Œä¹Ÿä¸èµ·å†²çªï¼Œä½ å°±æ˜¯åˆæ ¼çš„è´Ÿè´£äººâ€¦â€¦ æé«˜æ•ˆç‡å·¥å…· [center] æ¨èé˜…è¯» åªä¼šç”¨ git pull ï¼Ÿæœ‰æ—¶å€™ä½ å¯ä»¥å°è¯•æ›´ä¼˜é›…çš„å¤„ç†æ–¹å¼ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API ç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java-Concurrency","slug":"Coding/Java-Concurrency","permalink":"https://dayarch.top/categories/Coding/Java-Concurrency/"}],"tags":[{"name":"Java-Concurrency","slug":"Java-Concurrency","permalink":"https://dayarch.top/tags/Java-Concurrency/"},{"name":"thread","slug":"thread","permalink":"https://dayarch.top/tags/thread/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","permalink":"https://dayarch.top/tags/%E5%B9%B6%E5%8F%91/"}]},{"title":"SpringBootç»Ÿä¸€å¼‚å¸¸å¤„ç†","slug":"SpringBootç»Ÿä¸€å¼‚å¸¸å¤„ç†","date":"2019-08-09T07:13:46.000Z","updated":"2019-11-07T06:37:19.144Z","comments":true,"path":"/p/spring-boot-global-exception.html","link":"","permalink":"https://dayarch.top/p/spring-boot-global-exception.html","excerpt":"è¯è¯´å¼‚å¸¸ ã€Œæ¬²æ¸¡é»„æ²³å†°å¡å·ï¼Œå°†ç™»å¤ªè¡Œé›ªæ»¡å¤©ã€ï¼Œæ— è®ºç”Ÿæ´»è¿˜æ˜¯è®¡ç®—æœºä¸–ç•Œéš¾å…å‘ç”Ÿå¼‚å¸¸ï¼Œä¸Šä¸€ç¯‡æ–‡ç« RESTful API è¿”å›ç»Ÿä¸€JSONæ•°æ®æ ¼å¼ è¯´æ˜äº†ç»Ÿä¸€è¿”å›çš„å¤„ç†ï¼Œè¿™æ˜¯è¯·æ±‚ä¸€åˆ‡æ­£å¸¸çš„æƒ…å½¢ï¼›è¿™ç¯‡æ–‡ç« å°†è¯´æ˜å¦‚ä½•ç»Ÿä¸€å¤„ç†å¼‚å¸¸ï¼Œä»¥åŠå…¶èƒŒåçš„å®ç°åŸç†ï¼Œè€å¥—è·¯ï¼Œå…ˆå®ç°ï¼Œåè¯´æ˜åŸç†ï¼Œæœ‰äº†ä¸Šä¸€ç¯‡æ–‡ç« çš„é“ºåº•ï¼Œç›¸ä¿¡ï¼Œç†è§£è¿™ç¯‡æ–‡ç« å°±é©¾è½»å°±ç†Ÿäº† å®ç° æ–°å»ºä¸šåŠ¡å¼‚å¸¸ æ–°å»º BusinessException.class ç±»è¡¨ç¤ºä¸šåŠ¡å¼‚å¸¸ï¼Œæ³¨æ„è¿™æ˜¯ä¸€ä¸ª Runtime å¼‚å¸¸ 1 2 3 4 5 6 7 8 9 @Data @AllArgsConstructor public final class Busine","text":"è¯è¯´å¼‚å¸¸ã€Œæ¬²æ¸¡é»„æ²³å†°å¡å·ï¼Œå°†ç™»å¤ªè¡Œé›ªæ»¡å¤©ã€ï¼Œæ— è®ºç”Ÿæ´»è¿˜æ˜¯è®¡ç®—æœºä¸–ç•Œéš¾å…å‘ç”Ÿå¼‚å¸¸ï¼Œä¸Šä¸€ç¯‡æ–‡ç« RESTful API è¿”å›ç»Ÿä¸€JSONæ•°æ®æ ¼å¼ è¯´æ˜äº†ç»Ÿä¸€è¿”å›çš„å¤„ç†ï¼Œè¿™æ˜¯è¯·æ±‚ä¸€åˆ‡æ­£å¸¸çš„æƒ…å½¢ï¼›è¿™ç¯‡æ–‡ç« å°†è¯´æ˜å¦‚ä½•ç»Ÿä¸€å¤„ç†å¼‚å¸¸ï¼Œä»¥åŠå…¶èƒŒåçš„å®ç°åŸç†ï¼Œè€å¥—è·¯ï¼Œå…ˆå®ç°ï¼Œåè¯´æ˜åŸç†ï¼Œæœ‰äº†ä¸Šä¸€ç¯‡æ–‡ç« çš„é“ºåº•ï¼Œç›¸ä¿¡ï¼Œç†è§£è¿™ç¯‡æ–‡ç« å°±é©¾è½»å°±ç†Ÿäº† å®ç°æ–°å»ºä¸šåŠ¡å¼‚å¸¸æ–°å»º BusinessException.class ç±»è¡¨ç¤ºä¸šåŠ¡å¼‚å¸¸ï¼Œæ³¨æ„è¿™æ˜¯ä¸€ä¸ª Runtime å¼‚å¸¸ 123456789@Data@AllArgsConstructorpublic final class BusinessException extends RuntimeException &#123; private String errorCode; private String errorMsg;&#125; æ·»åŠ ç»Ÿä¸€å¼‚å¸¸å¤„ç†é™æ€æ–¹æ³•åœ¨ CommonResult ç±»ä¸­æ·»åŠ é™æ€æ–¹æ³• errorResult ç”¨äºæ¥æ”¶å¼‚å¸¸ç å’Œå¼‚å¸¸æ¶ˆæ¯: 1234567public static &lt;T&gt; CommonResult&lt;T&gt; errorResult(String errorCode, String errorMsg)&#123; CommonResult&lt;T&gt; commonResult = new CommonResult&lt;&gt;(); commonResult.errorCode = errorCode; commonResult.errorMsg = errorMsg; commonResult.status = -1; return commonResult;&#125; é…ç½®åŒæ ·è¦ç”¨åˆ° @RestControllerAdvice æ³¨è§£ï¼Œå°†ç»Ÿä¸€å¼‚å¸¸æ·»åŠ åˆ°é…ç½®ä¸­: 12345678@RestControllerAdvice(\"com.example.unifiedreturn.api\")static class UnifiedExceptionHandler&#123; @ExceptionHandler(BusinessException.class) public CommonResult&lt;Void&gt; handleBusinessException(BusinessException be)&#123; return CommonResult.errorResult(be.getErrorCode(), be.getErrorMsg()); &#125;&#125; ä¸‰éƒ¨æå®šï¼Œåˆ°è¿™é‡Œæ— è®ºæ˜¯ Controller è¿˜æ˜¯ Service ä¸­ï¼Œåªè¦æŠ›å‡º BusinessException, æˆ‘ä»¬éƒ½ä¼šè¿”å›ç»™å‰ç«¯ä¸€ä¸ªç»Ÿä¸€æ•°æ®æ ¼å¼ æµ‹è¯•å°† UserController ä¸­çš„æ–¹æ³•è¿›è¡Œæ”¹é€ ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸: 1234@GetMapping(\"/&#123;id&#125;\")public UserVo getUserById(@PathVariable Long id)&#123; throw new BusinessException(\"1001\", \"æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸\");&#125; æµè§ˆå™¨ä¸­è¾“å…¥: http://localhost:8080/users/1 åœ¨ Service ä¸­æŠ›å‡ºå¼‚å¸¸: 1234567891011121314@Servicepublic class UserServiceImpl implements UserService &#123; /** * æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢ç”¨æˆ· * * @param id * @return */ @Override public UserVo getUserById(Long id) &#123; throw new BusinessException(\"1001\", \"æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·å¼‚å¸¸\"); &#125;&#125; è¿è¡Œæ˜¯å¾—åˆ°åŒæ ·çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬å°½å¯èƒ½çš„æŠ›å‡ºå¼‚å¸¸å§ (ä½œä¸ºä¸€ä¸ªç¨‹åºçŒ¿è¿™ç§å¿ƒç†å¾ˆå¯æ‹) è§£å‰–å®ç°è¿‡ç¨‹è§£å‰–è¿™ä¸ªè¿‡ç¨‹æ˜¯ç›¸å½“çº ç»“çš„ï¼Œä¸ºäº†æ›´å¥½çš„è¯´(yin)æ˜(wei)é—®(wo)é¢˜(lan)ï¼Œæˆ‘è¦è¯´é‡ä¸­ä¹‹é‡äº†ï¼ŒçœŸå¿ƒå¸Œæœ›çœ‹è¯¥æ–‡ç« çš„ç«¥é‹è‡ªå·±å»æ¡ˆå‘ç°åœºå‘ç°çº¿ç´¢è¿˜æ˜¯åœ¨ WebMvcConfigurationSupport ç±»ä¸­å®ä¾‹åŒ–äº† HandlerExceptionResolver Bean 12345678910111213@Beanpublic HandlerExceptionResolver handlerExceptionResolver() &#123; List&lt;HandlerExceptionResolver&gt; exceptionResolvers = new ArrayList&lt;&gt;(); configureHandlerExceptionResolvers(exceptionResolvers); if (exceptionResolvers.isEmpty()) &#123; addDefaultHandlerExceptionResolvers(exceptionResolvers); &#125; extendHandlerExceptionResolvers(exceptionResolvers); HandlerExceptionResolverComposite composite = new HandlerExceptionResolverComposite(); composite.setOrder(0); composite.setExceptionResolvers(exceptionResolvers); return composite;&#125; å’Œä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ¯›ä¸€æ ·çš„å¥—è·¯ï¼ŒExceptionHandlerExceptionResolver å®ç°äº† InitializingBean æ¥å£ï¼Œé‡å†™äº† afterPropertiesSet æ–¹æ³•: 123456789101112131415161718192021222324252627282930@Overridepublic void afterPropertiesSet() &#123; // Do this first, it may add ResponseBodyAdvice beans initExceptionHandlerAdviceCache(); ...&#125;private void initExceptionHandlerAdviceCache() &#123; if (getApplicationContext() == null) &#123; return; &#125; List&lt;ControllerAdviceBean&gt; adviceBeans = ControllerAdviceBean.findAnnotatedBeans(getApplicationContext()); AnnotationAwareOrderComparator.sort(adviceBeans); for (ControllerAdviceBean adviceBean : adviceBeans) &#123; Class&lt;?&gt; beanType = adviceBean.getBeanType(); if (beanType == null) &#123; throw new IllegalStateException(\"Unresolvable type for ControllerAdviceBean: \" + adviceBean); &#125; // é‡ç‚¹çœ‹è¿™ä¸ªæ„é€ æ–¹æ³• ExceptionHandlerMethodResolver resolver = new ExceptionHandlerMethodResolver(beanType); if (resolver.hasExceptionMappings()) &#123; this.exceptionHandlerAdviceCache.put(adviceBean, resolver); &#125; if (ResponseBodyAdvice.class.isAssignableFrom(beanType)) &#123; this.responseBodyAdvice.add(adviceBean); &#125; &#125;&#125; é‡ç‚¹çœ‹ä¸Šé¢æˆ‘ç”¨æ³¨é‡Šæ ‡è®°çš„æ„é€ æ–¹æ³•ï¼Œä»£ç å¾ˆå¥½æ‡‚ï¼Œä»”ç»†çœ‹çœ‹å§ï¼Œå…¶å®å°±æ˜¯ç­›é€‰å‡ºæˆ‘ä»¬ç”¨ @ExceptionHandler æ³¨è§£æ ‡è®°çš„æ–¹æ³•å¹¶æ”¾åˆ°é›†åˆå½“ä¸­ï¼Œç”¨äºåç»­å…¨å±€å¼‚å¸¸æ•è·çš„åŒ¹é… 123456789101112131415161718192021222324252627282930313233343536373839/** * A constructor that finds &#123;@link ExceptionHandler&#125; methods in the given type. * @param handlerType the type to introspect */public ExceptionHandlerMethodResolver(Class&lt;?&gt; handlerType) &#123; for (Method method : MethodIntrospector.selectMethods(handlerType, EXCEPTION_HANDLER_METHODS)) &#123; for (Class&lt;? extends Throwable&gt; exceptionType : detectExceptionMappings(method)) &#123; addExceptionMapping(exceptionType, method); &#125; &#125;&#125;/** * Extract exception mappings from the &#123;@code @ExceptionHandler&#125; annotation first, * and then as a fallback from the method signature itself. */@SuppressWarnings(\"unchecked\")private List&lt;Class&lt;? extends Throwable&gt;&gt; detectExceptionMappings(Method method) &#123; List&lt;Class&lt;? extends Throwable&gt;&gt; result = new ArrayList&lt;&gt;(); detectAnnotationExceptionMappings(method, result); if (result.isEmpty()) &#123; for (Class&lt;?&gt; paramType : method.getParameterTypes()) &#123; if (Throwable.class.isAssignableFrom(paramType)) &#123; result.add((Class&lt;? extends Throwable&gt;) paramType); &#125; &#125; &#125; if (result.isEmpty()) &#123; throw new IllegalStateException(\"No exception types mapped to \" + method); &#125; return result;&#125;private void detectAnnotationExceptionMappings(Method method, List&lt;Class&lt;? extends Throwable&gt;&gt; result) &#123; ExceptionHandler ann = AnnotatedElementUtils.findMergedAnnotation(method, ExceptionHandler.class); Assert.state(ann != null, \"No ExceptionHandler annotation\"); result.addAll(Arrays.asList(ann.value()));&#125; åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ç”¨ @RestControllerAdvice å’Œ @ExceptionHandler æ³¨è§£å°±ä¼šè¢« Spring æ‰«æåˆ°ä¸Šä¸‹æ–‡ï¼Œä¾›æˆ‘ä»¬ä½¿ç”¨ è®©æˆ‘ä»¬å›åˆ°ä½ æœ€ç†Ÿæ‚‰çš„è°ƒç”¨çš„å…¥å£ DispatcherServlet ç±»çš„ doDispatch æ–¹æ³•: 123456789101112131415161718192021222324252627protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception &#123; ... try &#123; ModelAndView mv = null; Exception dispatchException = null; try &#123; ... // å½“è¯·æ±‚å‘ç”Ÿå¼‚å¸¸ï¼Œè¯¥æ–¹æ³•ä¼šé€šè¿‡ catch æ•è·å¼‚å¸¸ mv = ha.handle(processedRequest, response, mappedHandler.getHandler()); ... &#125; catch (Exception ex) &#123; dispatchException = ex; &#125; catch (Throwable err) &#123; // As of 4.3, we're processing Errors thrown from handler methods as well, // making them available for @ExceptionHandler methods and other scenarios. dispatchException = new NestedServletException(\"Handler dispatch failed\", err); &#125; // è°ƒç”¨è¯¥æ–¹æ³•åˆ†ææ•è·çš„å¼‚å¸¸ processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException); &#125; ...&#125; æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ processDispatchResult æ–¹æ³•ï¼Œè¿™é‡Œåªè¦å±•ç¤ºè°ƒç”¨æ ˆä½ å°±ä¼šçœ¼å‰ä¸€äº®äº†ï¼Œåˆæ˜¯ä¸ºäº†è¿”å›ç»Ÿä¸€æ ¼å¼æ•°æ®: æ€»ç»“ä¸Šä¸€ç¯‡æ–‡ç« çš„è¿”å›ç»Ÿä¸€æ•°æ®æ ¼å¼æ˜¯åŸºç¡€ï¼Œå½“å¼‚å¸¸æƒ…å†µå‘ç”Ÿæ—¶ï¼Œåªä¸è¿‡éœ€è¦å°†å¼‚å¸¸ä¿¡æ¯æå–å‡ºæ¥ã€‚æœ¬æ–‡ä¸»è¦ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œå‰–æåŸç†ï¼Œå¥½å¤šåœ°æ–¹è®¾è®¡æ–¹å¼æ˜¯ä¸å¯å–ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ€å¥½å°†å¼‚å¸¸å°è£…åœ¨ä¸€ä¸ª Enum ç±»ï¼Œé€šè¿‡ enum å¯¹è±¡æŠ›å‡ºå¼‚å¸¸ç­‰ï¼Œå¦‚æœä½ ç”¨åˆ°è¿™äº›ï¼Œå»å®Œå–„ä½ çš„è®¾è®¡æ–¹æ¡ˆå§ å›å¤ ã€Œdemoã€ï¼Œæ‰“å¼€é“¾æ¥ï¼ŒæŸ¥çœ‹æ–‡ä»¶å¤¹ ã€Œunifiedreturnã€ä¸‹å†…å®¹ï¼Œè·å–å®Œæ•´ä»£ç  é™„åŠ è¯´æ˜ä¹‹å‰çœ‹åˆ°çš„ä¸€æœ¬ä¹¦å¯¹å¼‚å¸¸çš„åˆ†ç±»è®©æˆ‘å°è±¡æ·±åˆ»ï¼Œåœ¨æ­¤æ‘˜å½•ä¸€å°æ®µåˆ†äº«ç»™å¤§å®¶: ç»“åˆå‡ºå›½æ—…è¡Œçš„ä¾‹å­è¯´æ˜å¼‚å¸¸åˆ†ç±»: æœºåœºåœ°éœ‡ï¼Œå±äºä¸å¯æŠ—åŠ›ï¼Œå¯¹åº”å¼‚å¸¸åˆ†ç±»ä¸­çš„ Errorï¼Œåœ¨åˆ¶è®¢å‡ºè¡Œè®¡åˆ’æ—¶ï¼Œæ ¹æœ¬ä¸éœ€è¦æŠŠè¿™ä¸ªéƒ¨åˆ†çš„å¼‚å¸¸è€ƒè™‘è¿›å» å µè½¦å±äº checked å¼‚å¸¸ï¼Œåº”å¯¹è¿™ç§å¼‚å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥æå‰å‡ºå‘ï¼Œæˆ–è€…æ”¹ç­¾æœºç¥¨ã€‚è€Œé£æœºå»¶è¯¯å¼‚å¸¸,è™½ç„¶ä¹Ÿéœ€è¦ checkï¼Œä½†æˆ‘ä»¬æ— èƒ½ä¸ºåŠ›ï¼Œåªèƒ½æŒç»­å…³æ³¨èˆªç­åŠ¨æ€ æ²¡æœ‰å¸¦æŠ¤ç…§ï¼Œæ˜æ˜¾å±äºå¯æå‰é¢„æµ‹çš„å¼‚å¸¸ï¼Œåªè¦å‡ºå‘å‰æ£€æŸ¥å³å¯é¿å…ï¼›å»æœºåœºè·¯ä¸Šè½¦å­æŠ›é”šï¼Œè¿™ä¸ªå¼‚å¸¸æ˜¯çªå‘çš„ï¼Œè™½ç„¶éš¾ä»¥é¢„æ–™ï¼Œä½†æ˜¯å¿…é¡»å¤„ç†ï¼Œå±äºéœ€è¦æ•æ‰çš„å¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡æ›´æ¢äº¤é€šå·¥å…·ï¼›åº”å¯¹æ£€ç¥¨æœºå™¨æ•…éšœå±äº å¯é€å‡ºå¼‚å¸¸ï¼Œäº¤ç”±èˆªç©ºå…¬å¸å¤„ç†,æˆ‘ä»¬æ— é¡»å…³å¿ƒ çµé­‚è¿½é—® è¿™ä¸¤ç¯‡æ–‡ç« ï¼Œä½ å­¦åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ ä½ èƒ½ç†Ÿç»ƒçš„ä½¿ç”¨åå°„å—ï¼Ÿå½“çœ‹æºç æ˜¯ä¼šçœ‹åˆ°å¾ˆå¤šåå°„çš„åº”ç”¨ ä½ äº†è§£ Spring CGLIB å—ï¼Ÿå®ƒçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ æé«˜æ•ˆç‡å·¥å…· JSON-ViewerJSON-Viewer æ˜¯ Chrome æµè§ˆå™¨çš„æ’ä»¶ï¼Œç”¨äºå¿«é€Ÿè§£æåŠæ ¼å¼åŒ– json å†…å®¹ï¼Œåœ¨ Chrome omniboxï¼ˆå¤šåŠŸèƒ½è¾“å…¥æ¡†ï¼‰è¾“å…¥json-viewer + TAB ï¼Œå°† json å†…å®¹æ‹·è´è¿›å»ï¼Œç„¶åè¾“å…¥å›è½¦é”®ï¼Œå°†çœ‹åˆ°ç»“æ„æ¸…æ™°çš„ json æ•°æ®ï¼ŒåŒæ—¶å¯ä»¥è‡ªå®šä¹‰ä¸»é¢˜ å¦å¤–ï¼Œå‰ç«¯äººå‘˜æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒåŒå‡»è¯·æ±‚é“¾æ¥ï¼Œä¼šè‡ªåŠ¨å°† response ä¸­çš„ json æ•°æ®è§£æå‡ºæ¥ï¼Œéå¸¸æ–¹ä¾¿æ¨èé˜…è¯» åªä¼šç”¨ git pull ï¼Ÿæœ‰æ—¶å€™ä½ å¯ä»¥å°è¯•æ›´ä¼˜é›…çš„å¤„ç†æ–¹å¼ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API ç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Exception","slug":"Exception","permalink":"https://dayarch.top/tags/Exception/"}]},{"title":"Springbootè¿”å›ç»Ÿä¸€JSONæ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ","slug":"æ¯å¤©ç”¨SpringBootï¼Œè¿˜ä¸æ‡‚ç»Ÿä¸€è¿”å›æ•°æ®æ ¼å¼æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ","date":"2019-08-08T13:22:23.000Z","updated":"2019-11-07T06:38:17.571Z","comments":true,"path":"/p/spring-boot-global-return.html","link":"","permalink":"https://dayarch.top/p/spring-boot-global-return.html","excerpt":"å…³äº Spring çš„å…¨å±€å¤„ç†ï¼Œæˆ‘æœ‰ä¸¤æ–¹é¢è¦è¯´: 1. ç»Ÿä¸€æ•°æ®è¿”å›æ ¼å¼ 2. ç»Ÿä¸€å¼‚å¸¸å¤„ç† ä¸ºäº†å°†ä¸¤ä¸ªé—®é¢˜è¯´æ˜æ¸…æ¥šï¼Œå°†åˆ†ä¸¤ä¸ªç« èŠ‚åˆ†åˆ«è¯´æ˜ï¼Œæœ¬ç« ä¸»è¦è¯´ç¬¬ä¸€ç‚¹ æœ‰ç«¥é‹è¯´ï¼Œæˆ‘ä»¬é¡¹ç›®éƒ½åšäº†è¿™ç§å¤„ç†ï¼Œå°±æ˜¯åœ¨æ¯ä¸ª API éƒ½å•ç‹¬å·¥å…·ç±»å°†è¿”å›å€¼è¿›è¡Œå°è£…ï¼Œä½†è¿™ç§ä¸å¤Ÿä¼˜é›…ï¼›æˆ‘æƒ³å†™æœ€å°‘çš„ä»£ç å®Œæˆè¿™ä»¶äº‹ï¼Œä¹Ÿè®¸æœ‰ç«¥é‹è¯´ï¼ŒåŠ å‡ ä¸ªæ³¨è§£å°±è§£å†³é—®é¢˜äº†ï¼Œè¯´çš„æ²¡é”™ï¼Œä½†è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä¸ºäº†è¯´æ˜ä¸ºä»€ä¹ˆåŠ äº†å‡ ä¸ªæ³¨è§£å°±è§£å†³é—®é¢˜äº†ï¼Œç›®çš„æ˜¯å¸Œæœ›å¤§å®¶çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚ ä¸ºäº†æ›´å¥½çš„è¯´æ˜é—®é¢˜ï¼Œæœ¬æ–‡å…ˆè¯´æ˜å¦‚ä½•å®ç°ï¼Œç„¶åå†è¯¦ç»†å‰–æå®ç°åŸç†(è¿™å¾ˆå…³é”®) ä¸ºä»€ä¹ˆè¦åšç»Ÿä¸€æ•°æ®è¿”å›æ ¼å¼ å‰åç«¯åˆ†ç¦»æ˜¯å½“ä»ŠæœåŠ¡å½¢å¼çš„ä¸»æµï¼Œå¦‚ä½•è®¾è®¡ä¸€ä¸ªå¥½çš„","text":"å…³äº Spring çš„å…¨å±€å¤„ç†ï¼Œæˆ‘æœ‰ä¸¤æ–¹é¢è¦è¯´: ç»Ÿä¸€æ•°æ®è¿”å›æ ¼å¼ ç»Ÿä¸€å¼‚å¸¸å¤„ç†ä¸ºäº†å°†ä¸¤ä¸ªé—®é¢˜è¯´æ˜æ¸…æ¥šï¼Œå°†åˆ†ä¸¤ä¸ªç« èŠ‚åˆ†åˆ«è¯´æ˜ï¼Œæœ¬ç« ä¸»è¦è¯´ç¬¬ä¸€ç‚¹ æœ‰ç«¥é‹è¯´ï¼Œæˆ‘ä»¬é¡¹ç›®éƒ½åšäº†è¿™ç§å¤„ç†ï¼Œå°±æ˜¯åœ¨æ¯ä¸ª API éƒ½å•ç‹¬å·¥å…·ç±»å°†è¿”å›å€¼è¿›è¡Œå°è£…ï¼Œä½†è¿™ç§ä¸å¤Ÿä¼˜é›…ï¼›æˆ‘æƒ³å†™æœ€å°‘çš„ä»£ç å®Œæˆè¿™ä»¶äº‹ï¼Œä¹Ÿè®¸æœ‰ç«¥é‹è¯´ï¼ŒåŠ å‡ ä¸ªæ³¨è§£å°±è§£å†³é—®é¢˜äº†ï¼Œè¯´çš„æ²¡é”™ï¼Œä½†è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯ä¸ºäº†è¯´æ˜ä¸ºä»€ä¹ˆåŠ äº†å‡ ä¸ªæ³¨è§£å°±è§£å†³é—®é¢˜äº†ï¼Œç›®çš„æ˜¯å¸Œæœ›å¤§å®¶çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚ ä¸ºäº†æ›´å¥½çš„è¯´æ˜é—®é¢˜ï¼Œæœ¬æ–‡å…ˆè¯´æ˜å¦‚ä½•å®ç°ï¼Œç„¶åå†è¯¦ç»†å‰–æå®ç°åŸç†(è¿™å¾ˆå…³é”®) ä¸ºä»€ä¹ˆè¦åšç»Ÿä¸€æ•°æ®è¿”å›æ ¼å¼å‰åç«¯åˆ†ç¦»æ˜¯å½“ä»ŠæœåŠ¡å½¢å¼çš„ä¸»æµï¼Œå¦‚ä½•è®¾è®¡ä¸€ä¸ªå¥½çš„ RESTful API ï¼Œä»¥åŠå¦‚ä½•è®©å‰ç«¯å°ä¼™ä¼´å¯ä»¥å¤„ç†æ ‡å‡†çš„ response JSON æ•°æ®ç»“æ„éƒ½è‡³å…³é‡è¦ï¼Œä¸ºäº†è®©å‰ç«¯æœ‰æ›´å¥½çš„é€»è¾‘å±•ç¤ºä¸é¡µé¢äº¤äº’å¤„ç†ï¼Œæ¯ä¸€æ¬¡ RESTful è¯·æ±‚éƒ½åº”è¯¥åŒ…å«ä»¥ä¸‹å‡ ä¸ªä¿¡æ¯: åç§° æè¿° status çŠ¶æ€ç ï¼Œæ ‡è¯†è¯·æ±‚æˆåŠŸä¸å¦ï¼Œå¦‚ [1:æˆåŠŸï¼›-1:å¤±è´¥] errorCode é”™è¯¯ç ï¼Œç»™å‡ºæ˜ç¡®é”™è¯¯ç ï¼Œæ›´å¥½çš„åº”å¯¹ä¸šåŠ¡å¼‚å¸¸ï¼›è¯·æ±‚æˆåŠŸè¯¥å€¼å¯ä¸ºç©º errorMsg é”™è¯¯æ¶ˆæ¯ï¼Œä¸é”™è¯¯ç ç›¸å¯¹åº”ï¼Œæ›´å…·ä½“çš„æè¿°å¼‚å¸¸ä¿¡æ¯ resultBody è¿”å›ç»“æœï¼Œé€šå¸¸æ˜¯ Bean å¯¹è±¡å¯¹åº”çš„ JSON æ•°æ®, é€šå¸¸ä¸ºäº†åº”å¯¹ä¸åŒè¿”å›å€¼ç±»å‹ï¼Œå°†å…¶å£°æ˜ä¸ºæ³›å‹ç±»å‹ å®ç°é€šç”¨è¿”å›å€¼ç±»å®šä¹‰æ ¹æ®ä¸Šé¢çš„æè¿°ï¼Œç”¨ Java Bean æ¥ä½“ç°è¿™ä¸ªç»“æ„å°±æ˜¯è¿™æ ·: 123456789101112131415161718@Datapublic final class CommonResult&lt;T&gt; &#123; private int status = 1; private String errorCode = \"\"; private String errorMsg = \"\"; private T resultBody; public CommonResult() &#123; &#125; public CommonResult(T resultBody) &#123; this.resultBody = resultBody; &#125;&#125; é…ç½®æ²¡é”™ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©å‡ ä¸ªå…³é”®æ³¨è§£æ¥å®Œæˆä¸€ä¸‹ç›¸å…³é…ç½®: 123456789101112131415161718192021@EnableWebMvc@Configurationpublic class UnifiedReturnConfig &#123; @RestControllerAdvice(\"com.example.unifiedreturn.api\") static class CommonResultResponseAdvice implements ResponseBodyAdvice&lt;Object&gt;&#123; @Override public boolean supports(MethodParameter methodParameter, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass) &#123; return true; &#125; @Override public Object beforeBodyWrite(Object body, MethodParameter methodParameter, MediaType mediaType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass, ServerHttpRequest serverHttpRequest, ServerHttpResponse serverHttpResponse) &#123; if (body instanceof CommonResult)&#123; return body; &#125; return new CommonResult&lt;Object&gt;(body); &#125; &#125;&#125; åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥çºµæƒ…çš„å†™ä»»ä½• RESTful API äº†ï¼Œæ‰€æœ‰çš„è¿”å›å€¼éƒ½ä¼šæœ‰ç»Ÿä¸€çš„ JSON ç»“æ„ æµ‹è¯•æ–°å»º UserControllerï¼Œæ·»åŠ ç›¸åº”çš„ RESTful APIï¼Œæµ‹è¯•ç”¨ä¾‹å†™çš„æ¯”è¾ƒç®€å•ï¼Œåªä¸ºäº†è¯´æ˜è¿”å›å€¼çš„å¤„ç† 12345678910111213@RestController@RequestMapping(\"/users\")public class UserController &#123; @GetMapping(\"\") public List&lt;UserVo&gt; getUserList()&#123; List&lt;UserVo&gt; userVoList = Lists.newArrayListWithCapacity(2); userVoList.add(UserVo.builder().id(1L).name(\"æ—¥æ‹±ä¸€å…µ\").age(18).build()); userVoList.add(UserVo.builder().id(2L).name(\"tan\").age(19).build()); return userVoList; &#125;&#125; æ‰“å¼€æµè§ˆå™¨è¾“å…¥åœ°å€æµ‹è¯•: http://localhost:8080/users/ ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿”å›äº† List JSON æ•°æ® ç»§ç»­æ·»åŠ  RESTful APIï¼Œæ ¹æ®ç”¨æˆ· ID æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ 1234@GetMapping(\"/&#123;id&#125;\")public UserVo getUserByName(@PathVariable Long id)&#123; return UserVo.builder().id(1L).name(\"æ—¥æ‹±ä¸€å…µ\").age(18).build();&#125; æ‰“å¼€æµè§ˆå™¨è¾“å…¥åœ°å€æµ‹è¯•: http://localhost:8080/users/1 ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿”å›äº†å•ä¸ª User JSON æ•°æ® æ·»åŠ ä¸€ä¸ªè¿”å›å€¼ç±»å‹ä¸º ResponseEntity çš„ API 1234@GetMapping(\"/testResponseEntity\")public ResponseEntity getUserByAge()&#123; return new ResponseEntity(UserVo.builder().id(1L).name(\"æ—¥æ‹±ä¸€å…µ\").age(18).build(), HttpStatus.OK);&#125; æ‰“å¼€æµè§ˆå™¨è¾“å…¥åœ°å€æµ‹è¯•: http://localhost:8080/users/testResponseEntity ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒæ ·è¿”å›äº†å•ä¸ª User JSON æ•°æ® è§£å‰–å®ç°è¿‡ç¨‹æˆ‘ä¼šå°†å…³é”®éƒ¨åˆ†ä¸€ä¸€è¯´æ˜æ¸…æ¥šï¼Œæ–­æ¡ˆè¿˜éœ€å°ä¼™ä¼´è‡ªå·±å»æ¡ˆå‘ç°åœº(æ‰“å¼€è‡ªå·±çš„ IDE æŸ¥çœ‹) æ•…äº‹è¦ä» @EnableWebMvc è¿™ä¸ªæ³¨è§£è¯´èµ·ï¼Œæ‰“å¼€è¯¥æ³¨è§£çœ‹: 123456@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.TYPE)@Documented@Import(DelegatingWebMvcConfiguration.class)public @interface EnableWebMvc &#123;&#125; é€šè¿‡ @Import æ³¨è§£å¼•å…¥äº† DelegatingWebMvcConfiguration.classï¼Œé‚£æ¥çœ‹è¿™ä¸ªç±»å§: 1234@Configurationpublic class DelegatingWebMvcConfiguration extends WebMvcConfigurationSupport &#123; ...&#125; æœ‰ @Configuration æ³¨è§£ï¼Œä½ åº”è¯¥å¾ˆç†Ÿæ‚‰äº†ï¼Œè¯¥ç±»çš„çˆ¶ç±» WebMvcConfigurationSupport ä¸­å´éšè—ç€ä¸€æ®µå…³é”®ä»£ç : 123456@Beanpublic RequestMappingHandlerAdapter requestMappingHandlerAdapter() &#123; RequestMappingHandlerAdapter adapter = createRequestMappingHandlerAdapter(); ... return adapter;&#125; RequestMappingHandlerAdapter æ˜¯æ¯ä¸€æ¬¡è¯·æ±‚å¤„ç†çš„å…³é”®ï¼Œæ¥çœ‹è¯¥ç±»çš„å®šä¹‰: 1234public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter implements BeanFactoryAware, InitializingBean &#123; ...&#125; è¯¥ç±»å®ç°äº† InitializingBean æ¥å£ï¼Œæˆ‘åœ¨ Spring Bean ç”Ÿå‘½å‘¨æœŸä¹‹â€œæˆ‘ä»å“ªé‡Œæ¥â€ï¼Ÿ è¿™ç¯‡æ–‡ç« ä¸­æ˜ç¡®è¯´æ˜äº† Spring Bean åˆå§‹åŒ–çš„å‡ ä¸ªå…³é”®ï¼Œå…¶ä¸­ InitializingBean æ¥å£çš„afterPropertiesSet æ–¹æ³•å°±æ˜¯å…³é”®ä¹‹ä¸€ï¼Œåœ¨ RequestMappingHandlerAdapter ç±»ä¸­åŒæ ·é‡å†™äº†è¯¥æ–¹æ³•: 123456789101112131415161718@Overridepublic void afterPropertiesSet() &#123; // Do this first, it may add ResponseBody advice beans initControllerAdviceCache(); if (this.argumentResolvers == null) &#123; List&lt;HandlerMethodArgumentResolver&gt; resolvers = getDefaultArgumentResolvers(); this.argumentResolvers = new HandlerMethodArgumentResolverComposite().addResolvers(resolvers); &#125; if (this.initBinderArgumentResolvers == null) &#123; List&lt;HandlerMethodArgumentResolver&gt; resolvers = getDefaultInitBinderArgumentResolvers(); this.initBinderArgumentResolvers = new HandlerMethodArgumentResolverComposite().addResolvers(resolvers); &#125; if (this.returnValueHandlers == null) &#123; List&lt;HandlerMethodReturnValueHandler&gt; handlers = getDefaultReturnValueHandlers(); this.returnValueHandlers = new HandlerMethodReturnValueHandlerComposite().addHandlers(handlers); &#125;&#125; è¯¥æ–¹æ³•å†…å®¹éƒ½éå¸¸å…³é”®ï¼Œä½†æˆ‘ä»¬å…ˆæ¥çœ‹ initControllerAdviceCache æ–¹æ³•ï¼Œå…¶ä»–å†…å®¹åç»­å†å•ç‹¬è¯´æ˜: 123456789101112131415161718private void initControllerAdviceCache() &#123; ... if (logger.isInfoEnabled()) &#123; logger.info(\"Looking for @ControllerAdvice: \" + getApplicationContext()); &#125; List&lt;ControllerAdviceBean&gt; beans = ControllerAdviceBean.findAnnotatedBeans(getApplicationContext()); AnnotationAwareOrderComparator.sort(beans); List&lt;Object&gt; requestResponseBodyAdviceBeans = new ArrayList&lt;Object&gt;(); for (ControllerAdviceBean bean : beans) &#123; ... if (ResponseBodyAdvice.class.isAssignableFrom(bean.getBeanType())) &#123; requestResponseBodyAdviceBeans.add(bean); &#125; &#125;&#125; é€šè¿‡ ControllerAdviceBean é™æ€æ–¹æ³•æ‰«æ ControllerAdvice æ³¨è§£ï¼Œå¯æ˜¯æˆ‘ä»¬åœ¨å®ç°ä¸Šä½¿ç”¨çš„æ˜¯ @RestControllerAdvice æ³¨è§£ï¼Œæ‰“å¼€çœ‹è¯¥æ³¨è§£: 123456@Target(ElementType.TYPE)@Retention(RetentionPolicy.RUNTIME)@Documented@ControllerAdvice@ResponseBodypublic @interface RestControllerAdvice &#123; è¯¥æ³¨è§£ç”± @ControllerAdvice å’Œ @ResponseBody æ ‡è®°ï¼Œå°±å¥½æ¯”ä½ ç†Ÿæ‚‰çš„ @RestController æ³¨è§£ç”± @Controller å’Œ @ResponseBody æ ‡è®°æ˜¯ä¸€æ ·çš„ åˆ°è¿™é‡Œä½ å·²ç»çŸ¥é“æˆ‘ä»¬ç”¨ @RestControllerAdvice æ ‡è®°çš„ Bean æ˜¯å¦‚ä½•è¢«åŠ è½½åˆ° Spring ä¸Šä¸‹æ–‡çš„ï¼Œæ¥ä¸‹æ¥å°±è¦çŸ¥é“æ˜¯ Spring æ˜¯å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬çš„ bean ä»¥åŠå¯¹è¿”å› body åšå¤„ç†çš„ å…¶å®åœ¨ HttpMessageConverteræ˜¯å¦‚ä½•è½¬æ¢æ•°æ®çš„ï¼Ÿ è¿™ç¯‡æ–‡ç« ä¸­å·²ç»è¯´æ˜äº†ä¸€éƒ¨åˆ†ï¼Œå¸Œæœ›å°ä¼™ä¼´å…ˆçœ‹è¿™ç¯‡æ–‡ç« ï¼Œä¸‹é¢çš„éƒ¨åˆ†å°±ä¼šç§’æ‡‚äº†ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåšè¿›ä¸€æ­¥çš„è¯´æ˜ åœ¨ AbstractMessageConverterMethodProcessor çš„ writeWithMessageConverters æ–¹æ³•ä¸­ï¼Œæœ‰ä¸€æ®µæ ¸å¿ƒä»£ç : 12345678910if (messageConverter instanceof GenericHttpMessageConverter) &#123; if (((GenericHttpMessageConverter) messageConverter).canWrite( declaredType, valueType, selectedMediaType)) &#123; outputValue = (T) getAdvice().beforeBodyWrite(outputValue, returnType, selectedMediaType, (Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt;) messageConverter.getClass(), inputMessage, outputMessage); ... return; &#125;&#125; å¯ä»¥çœ‹åˆ°é€šè¿‡ getAdvice() è°ƒç”¨äº† beforeBodyWrite æ–¹æ³•ï¼Œæˆ‘ä»¬å·²ç»æ¥è¿‘çœŸç›¸äº† 123protected RequestResponseBodyAdviceChain getAdvice() &#123; return this.advice;&#125; RequestResponseBodyAdviceChainï¼Œçœ‹åå­—å¸¦æœ‰ Chainï¼Œå¾ˆæ˜æ˜¾ç”¨åˆ°äº†ã€Œè´£ä»»é“¾è®¾è®¡æ¨¡å¼ã€ï¼Œè¿™äº›å†…å®¹åœ¨ ä¸å¾—ä¸çŸ¥çš„è´£ä»»é“¾è®¾è®¡æ¨¡å¼ æ–‡ç« ä¸­æ˜ç¡®è¯´æ˜è¿‡ï¼Œåªä¸è¿‡å®ƒä¼ é€’è´£ä»»é“¾ä»¥å¾ªç¯çš„æ–¹å¼å®Œæˆ: 123456789101112131415161718192021222324class RequestResponseBodyAdviceChain implements RequestBodyAdvice, ResponseBodyAdvice&lt;Object&gt; &#123; @Override public Object beforeBodyWrite(Object body, MethodParameter returnType, MediaType contentType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; converterType, ServerHttpRequest request, ServerHttpResponse response) &#123; return processBody(body, returnType, contentType, converterType, request, response); &#125; @SuppressWarnings(\"unchecked\") private &lt;T&gt; Object processBody(Object body, MethodParameter returnType, MediaType contentType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; converterType, ServerHttpRequest request, ServerHttpResponse response) &#123; for (ResponseBodyAdvice&lt;?&gt; advice : getMatchingAdvice(returnType, ResponseBodyAdvice.class)) &#123; if (advice.supports(returnType, converterType)) &#123; body = ((ResponseBodyAdvice&lt;T&gt;) advice).beforeBodyWrite((T) body, returnType, contentType, converterType, request, response); &#125; &#125; return body; &#125;&#125; æˆ‘ä»¬é‡å†™çš„ beforeBodyWrite æ–¹æ³•ç»ˆç©¶ä¼šè¢«è°ƒç”¨åˆ°ï¼ŒçœŸç›¸å°±æ˜¯è¿™æ ·äº†!!! å…¶å®è¿˜æ²¡å®Œï¼Œä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå¦‚æœæˆ‘ä»¬çš„ API æ–¹æ³•è¿”å›å€¼æ˜¯ org.springframework.http.ResponseEntity&lt;T&gt; ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®š HTTP è¿”å›çŠ¶æ€ç ï¼Œä½†æ˜¯è¿™ä¸ªè¿”å›å€¼ä¼šç›´æ¥æ”¾åˆ°æˆ‘ä»¬çš„ beforeBodyWrite æ–¹æ³•çš„ body å‚æ•°ä¸­å—ï¼Ÿå¦‚æœè¿™æ ·åšå¾ˆæ˜æ˜¾æ˜¯é”™è¯¯çš„ï¼Œå› ä¸º ResponseEntity åŒ…å«å¾ˆå¤šæˆ‘ä»¬éä¸šåŠ¡æ•°æ®åœ¨é‡Œé¢ï¼Œé‚£ Spring æ˜¯æ€ä¹ˆå¸®æˆ‘ä»¬å¤„ç†çš„å‘¢ï¼Ÿ åœ¨æˆ‘ä»¬æ–¹æ³•å–å¾—è¿”å›å€¼å¹¶ä¸”åœ¨è°ƒç”¨ beforeBodyWrite æ–¹æ³•ä¹‹å‰ï¼Œè¿˜è¦é€‰æ‹© HandlerMethodReturnValueHandler ç”¨äºå¤„ç†ä¸åŒçš„ Handler æ¥å¤„ç†è¿”å›å€¼ åœ¨ç±» HandlerMethodReturnValueHandlerComposite ä¸­çš„ handleReturnValue æ–¹æ³•ä¸­ 12345678910@Overridepublic void handleReturnValue(Object returnValue, MethodParameter returnType, ModelAndViewContainer mavContainer, NativeWebRequest webRequest) throws Exception &#123; HandlerMethodReturnValueHandler handler = selectHandler(returnValue, returnType); if (handler == null) &#123; throw new IllegalArgumentException(\"Unknown return value type: \" + returnType.getParameterType().getName()); &#125; handler.handleReturnValue(returnValue, returnType, mavContainer, webRequest);&#125; é€šè¿‡è°ƒç”¨ selectHandler æ–¹æ³•æ¥é€‰æ‹©åˆé€‚çš„ handlerï¼ŒSpring å†…ç½®äº†å¾ˆå¤šä¸ª Handlerï¼Œæˆ‘ä»¬æ¥çœ‹ç±»å›¾: HttpEntityMethodProcessor å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå®ƒé‡å†™äº† supportsParameter æ–¹æ³•ï¼Œæ”¯æŒ HttpEntity ç±»å‹ï¼Œå³æ”¯æŒ ResponseEntity ç±»å‹: 12345@Overridepublic boolean supportsParameter(MethodParameter parameter) &#123; return (HttpEntity.class == parameter.getParameterType() || RequestEntity.class == parameter.getParameterType());&#125; æ‰€ä»¥å½“æˆ‘ä»¬è¿”å›çš„ç±»å‹ä¸º ResponseEntity æ—¶ï¼Œå°±è¦é€šè¿‡ HttpEntityMethodProcessor çš„ handleReturnValue æ–¹æ³•æ¥å¤„ç†æˆ‘ä»¬çš„ç»“æœ: 12345678910111213141516171819202122232425@Overridepublic void handleReturnValue(Object returnValue, MethodParameter returnType, ModelAndViewContainer mavContainer, NativeWebRequest webRequest) throws Exception &#123; ... if (responseEntity instanceof ResponseEntity) &#123; int returnStatus = ((ResponseEntity&lt;?&gt;) responseEntity).getStatusCodeValue(); outputMessage.getServletResponse().setStatus(returnStatus); if (returnStatus == 200) &#123; if (SAFE_METHODS.contains(inputMessage.getMethod()) &amp;&amp; isResourceNotModified(inputMessage, outputMessage)) &#123; // Ensure headers are flushed, no body should be written. outputMessage.flush(); // Skip call to converters, as they may update the body. return; &#125; &#125; &#125; // Try even with null body. ResponseBodyAdvice could get involved. writeWithMessageConverters(responseEntity.getBody(), returnType, inputMessage, outputMessage); // Ensure headers are flushed even if no body was written. outputMessage.flush();&#125; è¯¥æ–¹æ³•æå–å‡º responseEntity.getBody()ï¼Œå¹¶ä¼ é€’ä¸ª MessageConverterï¼Œç„¶åå†ç»§ç»­è°ƒç”¨ beforeBodyWrite æ–¹æ³•ï¼Œè¿™æ‰æ˜¯çœŸç›¸!!! è¿™æ˜¯ RESTful API æ­£å¸¸è¿”å›å†…å®¹çš„æƒ…å†µï¼Œä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œè®©æˆ‘ä»¬æ¥ä¾¦æŸ¥ä¸€ä¸‹ç»Ÿä¸€å¼‚å¸¸æƒ…å†µçš„å¤„ç†ä»¥åŠå®ç°åŸç† çµé­‚è¿½é—® è¿”å›å€¼æ˜¯é ResponseEntity ç±»å‹æ—¶ï¼Œç”¨çš„æ˜¯ä»€ä¹ˆ handlerï¼Ÿå®ƒæ”¯æŒçš„è¿”å›å€¼ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿçœ‹è¿‡ä½ ä¹Ÿè®¸å°±çŸ¥é“ä¸ºä»€ä¹ˆè¦ç”¨ @ResponseBody æ³¨è§£äº† ä½ æœ‰è¿½è¸ªè¿‡ DispatchServlet çš„æ•´ä¸ªè¯·æ±‚è¿‡ç¨‹å—ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» åªä¼šç”¨ git pull ï¼Ÿæœ‰æ—¶å€™ä½ å¯ä»¥å°è¯•æ›´ä¼˜é›…çš„å¤„ç†æ–¹å¼ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API ç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» | å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– | å›å¤ã€Œèµ„æ–™ã€ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"}]},{"title":"Shiroâ€”å°è€Œç¾çš„å®‰å…¨æ¡†æ¶","slug":"Shiroâ€”å°è€Œç¾çš„å®‰å…¨æ¡†æ¶","date":"2019-08-05T03:21:40.000Z","updated":"2019-11-07T06:36:52.166Z","comments":true,"path":"/p/shiro-in-practice.html","link":"","permalink":"https://dayarch.top/p/shiro-in-practice.html","excerpt":"å†™åœ¨å‰é¢ åœ¨ä¸€æ¬¾åº”ç”¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘ä»¬éƒ½ä¼šè°ˆåŠè¯¥åº”ç”¨çš„æ•°æ®å®‰å…¨é—®é¢˜ã€‚ç”¨æˆ·çš„åˆæ³•æ€§ä¸æ•°æ®çš„å¯è§æ€§æ˜¯æ•°æ®å®‰å…¨ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œä¸€æ–¹é¢ï¼Œä¸åŒçš„åº”ç”¨å¯¹äºæ•°æ®çš„åˆæ³•æ€§å’Œå¯è§æ€§è¦æ±‚çš„ç»´åº¦ä¸ç²’åº¦éƒ½æœ‰æ‰€åŒºåˆ«ï¼›å¦ä¸€æ–¹é¢ï¼Œä»¥å½“å‰å¾®æœåŠ¡ã€å¤šæœåŠ¡çš„æ¶æ„æ–¹å¼ï¼Œå¦‚ä½•å…±äº«Sessionï¼Œå¦‚ä½•ç¼“å­˜è®¤è¯å’Œæˆæƒæ•°æ®åº”å¯¹é«˜å¹¶å‘è®¿é—®éƒ½è¿«åˆ‡éœ€è¦æˆ‘ä»¬è§£å†³ã€‚Shiroçš„å‡ºç°è®©æˆ‘ä»¬å¯ä»¥å¿«é€Ÿå’Œç®€å•çš„åº”å¯¹æˆ‘ä»¬åº”ç”¨çš„æ•°æ®å®‰å…¨é—®é¢˜ Shiroä»‹ç» Shiroç®€ä»‹ è¿™ä¸ªå®˜ç½‘è§£é‡Šä¸æŠ½è±¡ï¼Œæ‰€ä»¥ç›´æ¥ç”¨å®˜ç½‘è§£é‡Šï¼šApache Shiroâ„¢æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„ Java å®‰å…¨æ¡†æ¶ï¼Œå¯ä»¥æ‰§è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†ç­‰ã€‚åŸºäº Shiro çš„æ˜“äºç†è§£","text":"å†™åœ¨å‰é¢åœ¨ä¸€æ¬¾åº”ç”¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘ä»¬éƒ½ä¼šè°ˆåŠè¯¥åº”ç”¨çš„æ•°æ®å®‰å…¨é—®é¢˜ã€‚ç”¨æˆ·çš„åˆæ³•æ€§ä¸æ•°æ®çš„å¯è§æ€§æ˜¯æ•°æ®å®‰å…¨ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œä¸€æ–¹é¢ï¼Œä¸åŒçš„åº”ç”¨å¯¹äºæ•°æ®çš„åˆæ³•æ€§å’Œå¯è§æ€§è¦æ±‚çš„ç»´åº¦ä¸ç²’åº¦éƒ½æœ‰æ‰€åŒºåˆ«ï¼›å¦ä¸€æ–¹é¢ï¼Œä»¥å½“å‰å¾®æœåŠ¡ã€å¤šæœåŠ¡çš„æ¶æ„æ–¹å¼ï¼Œå¦‚ä½•å…±äº«Sessionï¼Œå¦‚ä½•ç¼“å­˜è®¤è¯å’Œæˆæƒæ•°æ®åº”å¯¹é«˜å¹¶å‘è®¿é—®éƒ½è¿«åˆ‡éœ€è¦æˆ‘ä»¬è§£å†³ã€‚Shiroçš„å‡ºç°è®©æˆ‘ä»¬å¯ä»¥å¿«é€Ÿå’Œç®€å•çš„åº”å¯¹æˆ‘ä»¬åº”ç”¨çš„æ•°æ®å®‰å…¨é—®é¢˜ Shiroä»‹ç»Shiroç®€ä»‹è¿™ä¸ªå®˜ç½‘è§£é‡Šä¸æŠ½è±¡ï¼Œæ‰€ä»¥ç›´æ¥ç”¨å®˜ç½‘è§£é‡Šï¼šApache Shiroâ„¢æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„ Java å®‰å…¨æ¡†æ¶ï¼Œå¯ä»¥æ‰§è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†ç­‰ã€‚åŸºäº Shiro çš„æ˜“äºç†è§£çš„APIï¼Œæ‚¨å¯ä»¥å¿«é€Ÿã€è½»æ¾åœ°ä½¿ä»»ä½•åº”ç”¨ç¨‹åºå˜å¾—å®‰å…¨ï¼ˆä»æœ€å°çš„ç§»åŠ¨åº”ç”¨åˆ°æœ€å¤§çš„ç½‘ç»œå’Œä¼ä¸šåº”ç”¨ï¼‰ã€‚ è°ˆåŠå®‰å…¨ï¼Œå¤šæ•° Java å¼€å‘äººå‘˜éƒ½ç¦»ä¸å¼€ Spring æ¡†æ¶çš„æ”¯æŒï¼Œè‡ªç„¶ä¹Ÿå°±ä¼šå…ˆæƒ³åˆ° Spring Securityï¼Œé‚£æˆ‘ä»¬å…ˆæ¥çœ‹äºŒè€…çš„å·®åˆ« Shiro Spring Security ç®€å•ã€çµæ´» å¤æ‚ã€ç¬¨é‡ å¯è„±ç¦»Spring ä¸å¯è„±ç¦»Spring ç²’åº¦è¾ƒç²— ç²’åº¦è¾ƒç»† è™½ç„¶ Spring Security å±äºåéœ‡ä¸­å¤– Spring å®¶æ—çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯äº†è§£ Shiro ä¹‹åï¼Œä½ ä¸ä¼šæƒ³ â€œå«å…¥è±ªé—¨â€ï¼Œè€Œæ˜¯é€‰æ‹©è¿½æ±‚ã€Œè¯—å’Œè¿œæ–¹ã€å†²åŠ¨ã€‚ æ¨ªçœ‹æˆå²­ä¾§æˆå³°ï¼Œè¿œè¿‘é«˜ä½å„ä¸åŒ (ä¾æ—§æ˜¯å…ˆäº†è§£æ¦‚å¿µå°±å¥½) è¿œçœ‹ Shiro çœ‹è½®å»“ Subjectå®ƒæ˜¯ä¸€ä¸ªä¸»ä½“ï¼Œä»£è¡¨äº†å½“å‰â€œç”¨æˆ·â€ï¼Œè¿™ä¸ªç”¨æˆ·ä¸ä¸€å®šæ˜¯ä¸€ä¸ªå…·ä½“çš„äººï¼Œä¸å½“å‰åº”ç”¨äº¤äº’çš„ä»»ä½•ä¸œè¥¿éƒ½æ˜¯Subjectï¼Œå¦‚ç½‘ç»œçˆ¬è™«ï¼Œæœºå™¨äººç­‰ï¼›å³ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼›æ‰€æœ‰ Subject éƒ½ç»‘å®šåˆ° SecurityManagerï¼Œä¸ Subject çš„æ‰€æœ‰äº¤äº’éƒ½ä¼šå§”æ‰˜ç»™SecurityManagerï¼›å¯ä»¥æŠŠ Subject è®¤ä¸ºæ˜¯ä¸€ä¸ªé—¨é¢ï¼›SecurityManager æ‰æ˜¯å®é™…çš„æ‰§è¡Œè€… SecurityManagerå®‰å…¨ç®¡ç†å™¨ï¼›å³æ‰€æœ‰ä¸å®‰å…¨æœ‰å…³çš„æ“ä½œéƒ½ä¼šä¸ SecurityManager äº¤äº’ï¼›ä¸”å®ƒç®¡ç†ç€æ‰€æœ‰ Subjectï¼›å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ Shiro çš„æ ¸å¿ƒï¼Œå®ƒè´Ÿè´£ä¸åè¾¹ä»‹ç»çš„å…¶ä»–ç»„ä»¶è¿›è¡Œäº¤äº’ï¼Œå¦‚æœå­¦ä¹ è¿‡ SpringMVCï¼Œä½ å¯ä»¥æŠŠå®ƒçœ‹æˆ DispatcherServletå‰ç«¯æ§åˆ¶å™¨ RealmåŸŸï¼ŒShiro ä» Realm è·å–å®‰å…¨æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰ï¼Œå°±æ˜¯è¯´ SecurityManager è¦éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œé‚£ä¹ˆå®ƒéœ€è¦ä» Realm è·å–ç›¸åº”çš„ç”¨æˆ·è¿›è¡Œæ¯”è¾ƒä»¥ç¡®å®šç”¨æˆ·èº«ä»½æ˜¯å¦åˆæ³•ï¼›ä¹Ÿéœ€è¦ä» Realm å¾—åˆ°ç”¨æˆ·ç›¸åº”çš„è§’è‰²/æƒé™è¿›è¡ŒéªŒè¯ç”¨æˆ·æ˜¯å¦èƒ½è¿›è¡Œæ“ä½œï¼›å¯ä»¥æŠŠ Realm çœ‹æˆ DataSourceï¼Œå³å®‰å…¨æ•°æ®æºã€‚ è¿‘çœ‹ Shiro çœ‹ç»†èŠ‚çœ‹å›¾ç¬é—´æ‡µé€¼ï¼Ÿåˆ«æ…Œï¼Œä¼šä¸ºä½ æ‹†è§£æ¥çœ‹ï¼Œç»“åˆç€å›¾çœ‹ä¸‹é¢çš„è§£é‡Šï¼Œè¿™ä¸æ˜¯å•¥å¤§é—®é¢˜ï¼Œä¸”çœ‹: Subjectä¸»ä½“ï¼Œå¯ä»¥çœ‹åˆ°ä¸»ä½“å¯ä»¥æ˜¯ä»»ä½•å¯ä»¥ä¸åº”ç”¨äº¤äº’çš„ â€œç”¨æˆ·â€ SecurityManagerç›¸å½“äº SpringMVC ä¸­çš„ DispatcherServletï¼›æ˜¯ Shiro çš„å¿ƒè„ï¼›æ‰€æœ‰å…·ä½“çš„äº¤äº’éƒ½é€šè¿‡ SecurityManager è¿›è¡Œæ§åˆ¶ï¼›å®ƒç®¡ç†ç€æ‰€æœ‰ Subjectã€ä¸”è´Ÿè´£è¿›è¡Œè®¤è¯å’Œæˆæƒã€åŠä¼šè¯ã€ç¼“å­˜çš„ç®¡ç† Authenticatorè®¤è¯å™¨ï¼Œè´Ÿè´£ä¸»ä½“è®¤è¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæ‰©å±•ç‚¹ï¼Œå¦‚æœç”¨æˆ·è§‰å¾— Shiro é»˜è®¤çš„ä¸å¥½ï¼Œå¯ä»¥è‡ªå®šä¹‰å®ç°ï¼›éœ€è¦è‡ªå®šä¹‰è®¤è¯ç­–ç•¥ï¼ˆAuthentication Strategyï¼‰ï¼Œå³ä»€ä¹ˆæƒ…å†µä¸‹ç®—ç”¨æˆ·è®¤è¯é€šè¿‡äº† Authrizeræˆæƒå™¨ï¼Œæˆ–è€…è®¿é—®æ§åˆ¶å™¨ï¼Œç”¨æ¥å†³å®šä¸»ä½“æ˜¯å¦æœ‰æƒé™è¿›è¡Œç›¸åº”çš„æ“ä½œï¼›å³æ§åˆ¶ç€ç”¨æˆ·èƒ½è®¿é—®åº”ç”¨ä¸­çš„å“ªäº›åŠŸèƒ½ Realmå¯ä»¥æœ‰ 1 ä¸ªæˆ–å¤šä¸ª Realmï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å®‰å…¨å®ä½“æ•°æ®æºï¼Œå³ç”¨äºè·å–å®‰å…¨å®ä½“çš„ï¼›å¯ä»¥æ˜¯JDBCå®ç°ï¼Œä¹Ÿå¯ä»¥æ˜¯LDAPå®ç°ï¼Œæˆ–è€…å†…å­˜å®ç°ç­‰ç­‰ï¼›ç”±ç”¨æˆ·æä¾›ï¼›æ³¨æ„ï¼šShiro ä¸çŸ¥é“ä½ çš„ç”¨æˆ·/æƒé™å­˜å‚¨åœ¨å“ªåŠä»¥ä½•ç§æ ¼å¼å­˜å‚¨ï¼›æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬åœ¨åº”ç”¨ä¸­éƒ½éœ€è¦å®ç°è‡ªå·±çš„Realm SessionManagerå¦‚æœå†™è¿‡ Servlet å°±åº”è¯¥çŸ¥é“ Session çš„æ¦‚å¿µï¼ŒSession éœ€è¦æœ‰äººå»ç®¡ç†å®ƒçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™ä¸ªç»„ä»¶å°±æ˜¯ SessionManagerï¼›è€ŒShiro å¹¶ä¸ä»…ä»…å¯ä»¥ç”¨åœ¨ Web ç¯å¢ƒï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨å¦‚æ™®é€šçš„ JavaSE ç¯å¢ƒã€EJBç­‰ç¯å¢ƒï¼›æ‰€ä»¥ï¼ŒShiro å°±æŠ½è±¡äº†ä¸€ä¸ªè‡ªå·±çš„Session æ¥ç®¡ç†ä¸»ä½“ä¸åº”ç”¨ä¹‹é—´äº¤äº’çš„æ•°æ®ï¼›è¿™æ ·çš„è¯ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ Web ç¯å¢ƒç”¨ï¼Œåˆšå¼€å§‹æ˜¯ä¸€å°WebæœåŠ¡å™¨ï¼›æ¥ç€åˆä¸Šäº†å°EJB æœåŠ¡å™¨ï¼›è¿™æ—¶åˆæƒ³æŠŠä¸¤å°æœåŠ¡å™¨çš„ä¼šè¯æ•°æ®æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°è‡ªå·±çš„åˆ†å¸ƒå¼ä¼šè¯ï¼ˆå¦‚æŠŠæ•°æ®æ”¾åˆ°Memcached æœåŠ¡å™¨ï¼‰ SessionDAODAOå¤§å®¶éƒ½ç”¨è¿‡ï¼Œæ•°æ®è®¿é—®å¯¹è±¡ï¼Œç”¨äºä¼šè¯çš„ CRUDï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³æŠŠ Session ä¿å­˜åˆ°æ•°æ®åº“ï¼Œé‚£ä¹ˆå¯ä»¥å®ç°è‡ªå·±çš„SessionDAOï¼Œé€šè¿‡å¦‚JDBCå†™åˆ°æ•°æ®åº“ï¼›æ¯”å¦‚æƒ³æŠŠ Session æ”¾åˆ° Memcached ä¸­ï¼Œå¯ä»¥å®ç°è‡ªå·±çš„ Memcached SessionDAOï¼›å¦å¤– SessionDAO ä¸­å¯ä»¥ä½¿ç”¨ Cache è¿›è¡Œç¼“å­˜ï¼Œä»¥æé«˜æ€§èƒ½ï¼› CacheManagerç¼“å­˜æ§åˆ¶å™¨ï¼Œæ¥ç®¡ç†å¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ç­‰çš„ç¼“å­˜çš„ï¼›å› ä¸ºè¿™äº›æ•°æ®åŸºæœ¬ä¸Šå¾ˆå°‘å»æ”¹å˜ï¼Œæ”¾åˆ°ç¼“å­˜ä¸­åå¯ä»¥æé«˜è®¿é—®çš„æ€§èƒ½ Cryptographyå¯†ç æ¨¡å—ï¼ŒShiroæé«˜äº†ä¸€äº›å¸¸è§çš„åŠ å¯†ç»„ä»¶ç”¨äºå¦‚å¯†ç ã€ŒåŠ å¯†/è§£å¯†ã€çš„ æ³¨æ„ä¸Šå›¾çš„ç»“æ„ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®è¿™å¼ å›¾æ¥é€æ­¥æ‹†åˆ†è®²è§£ï¼Œè®°ä½è¿™å¼ å›¾ä¹Ÿæ›´æœ‰åŠ©äºæˆ‘ä»¬ç†è§£ Shiro çš„å·¥ä½œåŸç†ï¼Œæ‰€ä»¥ä¾æ—§æ˜¯æ‰“å¼€ä¸¤ä¸ªç½‘é¡µä¸€èµ·çœ‹å°±å¥½å–½ æ­å»ºæ¦‚è§ˆå¤šæ•°å°ä¼™ä¼´éƒ½åœ¨ä½¿ç”¨ Spring Bootï¼Œ Shiro ä¹Ÿå¾ˆåº”æ™¯çš„å®šä¹‰äº† starterï¼Œåšäº†æ›´å¥½çš„å°è£…ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´ä½¿ç”¨èµ·æ¥ä¹Ÿå°±æ›´åŠ æ–¹ä¾¿ï¼Œæ¥çœ‹é€‰å‹æ¦‚è§ˆ åºå· åç§° ç‰ˆæœ¬ 1 Springboot 2.0.4 2 JPA 2.0.4 3 Mysql 8.0.12 4 Redis 2.0.4 5 Lombok 1.16.22 6 Guava 26.0-jre 7 Shiro 1.4.0 ä½¿ç”¨ Spring Bootï¼Œå¤§å¤šéƒ½æ˜¯é€šè¿‡æ·»åŠ  starter ä¾èµ–ï¼Œä¼šè‡ªåŠ¨è§£å†³ä¾èµ–åŒ…ç‰ˆæœ¬ï¼Œæ‰€ä»¥è‡ªå·±å°è¯•çš„æ—¶å€™ç”¨æœ€æ–°ç‰ˆæœ¬ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¯”å¦‚ Shiro ç°åœ¨çš„ç‰ˆæœ¬æ˜¯ 1.5.0 äº†ï¼Œæ•´ä½“é—®é¢˜ä¸å¤§ï¼Œå¤§å®¶è‡ªè¡Œå°è¯•å°±å¥½ æ·»åŠ  Gradle ä¾èµ–ç®¡ç† å¤§ä½“ç›®å½•ç»“æ„ application.yml é…ç½® åŸºæœ¬é…ç½® ä½ å°±è®©æˆ‘çœ‹è¿™ï¼Ÿè¿™åªæ˜¯ä¸€ä¸ªæ¦‚è§ˆï¼Œå…ˆåšåˆ°å¿ƒä¸­æœ‰æ•°ï¼Œæˆ‘ä»¬æ¥çœ‹å…·ä½“é…ç½®ï¼Œé€æ­¥å®Œæˆæ­å»º å…¶ä¸­ shiroFilter bean éƒ¨åˆ†æŒ‡å®šäº†æ‹¦æˆªè·¯å¾„å’Œç›¸åº”çš„è¿‡æ»¤å™¨ï¼Œâ€/user/loginâ€, â€/userâ€, â€/user/loginoutâ€ å¯ä»¥åŒ¿åè®¿é—®ï¼Œå…¶ä»–è·¯å¾„éƒ½éœ€è¦æˆæƒè®¿é—®ï¼Œshiro æä¾›å’Œå¤šä¸ªé»˜è®¤çš„è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›è¿‡æ»¤å™¨æ¥é…ç½®æ§åˆ¶æŒ‡å®šurlçš„æƒé™(å…ˆäº†è§£ä¸ªå¤§æ¦‚å³å¯)ï¼š é…ç½®ç¼©å†™ å¯¹åº”çš„è¿‡æ»¤å™¨ åŠŸèƒ½ anon AnonymousFilter æŒ‡å®šurlå¯ä»¥åŒ¿åè®¿é—® authc FormAuthenticationFilter æŒ‡å®šurléœ€è¦formè¡¨å•ç™»å½•ï¼Œé»˜è®¤ä¼šä»è¯·æ±‚ä¸­è·å–usernameã€password,rememberMeç­‰å‚æ•°å¹¶å°è¯•ç™»å½•ï¼Œå¦‚æœç™»å½•ä¸äº†å°±ä¼šè·³è½¬åˆ°loginUrlé…ç½®çš„è·¯å¾„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªè¿‡æ»¤å™¨åšé»˜è®¤çš„ç™»å½•é€»è¾‘ï¼Œä½†æ˜¯ä¸€èˆ¬éƒ½æ˜¯æˆ‘ä»¬è‡ªå·±åœ¨æ§åˆ¶å™¨å†™ç™»å½•é€»è¾‘çš„ï¼Œè‡ªå·±å†™çš„è¯å‡ºé”™è¿”å›çš„ä¿¡æ¯éƒ½å¯ä»¥å®šåˆ¶å˜›ã€‚ authcBasic BasicHttpAuthenticationFilter æŒ‡å®šurléœ€è¦basicç™»å½• Logout LogoutFilter ç™»å‡ºè¿‡æ»¤å™¨ï¼Œé…ç½®æŒ‡å®šurlå°±å¯ä»¥å®ç°é€€å‡ºåŠŸèƒ½ï¼Œéå¸¸æ–¹ä¾¿ noSessionCreation NoSessionCreationFilter ç¦æ­¢åˆ›å»ºä¼šè¯ perms PermissionsAuthorizationFilter éœ€è¦æŒ‡å®šæƒé™æ‰èƒ½è®¿é—® port PortFilter éœ€è¦æŒ‡å®šç«¯å£æ‰èƒ½è®¿é—® rest HttpMethodPermissionFilter å°†httpè¯·æ±‚æ–¹æ³•è½¬åŒ–æˆç›¸åº”çš„åŠ¨è¯æ¥æ„é€ ä¸€ä¸ªæƒé™å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæ„Ÿè§‰æ„ä¹‰ä¸å¤§ï¼Œæœ‰å…´è¶£è‡ªå·±çœ‹æºç çš„æ³¨é‡Š roles RolesAuthorizationFilter éœ€è¦æŒ‡å®šè§’è‰²æ‰èƒ½è®¿é—® ssl SslFilter éœ€è¦httpsè¯·æ±‚æ‰èƒ½è®¿é—® user UserFilter éœ€è¦å·²ç™»å½•æˆ–â€œè®°ä½æˆ‘â€çš„ç”¨æˆ·æ‰èƒ½è®¿é—® æ•°æ®åº“è¡¨è®¾è®¡æ•°æ®åº“è¡¨è®¾è®¡è¯·å‚è€ƒ entity packageä¸‹çš„ beanï¼Œé€šè¿‡@Entity æ³¨è§£ä¸ JPA çš„è®¾ç½®è‡ªåŠ¨ç”Ÿæˆè¡¨ç»“æ„ (ä½ éœ€è¦ç®€å•çš„äº†è§£ä¸€ä¸‹ JPA çš„åŠŸèƒ½)ã€‚ æˆ‘ä»¬è¦è¯´é‡ç‚¹å•¦ï½ï½ï½ èº«ä»½è®¤è¯èº«ä»½è®¤è¯æ˜¯ä¸€ä¸ªè¯æ˜ â€œæé›·æ˜¯æé›·ï¼ŒéŸ©æ¢…æ¢…æ˜¯éŸ©æ¢…æ¢…â€ çš„è¿‡ç¨‹ï¼Œå›çœ‹ä¸Šå›¾ï¼ŒRealm æ¨¡å—å°±æ˜¯ç”¨æ¥åšè¿™ä»¶äº‹çš„ï¼ŒShiro æä¾›äº† IniRealmï¼ŒJdbcReamlï¼ŒLDAPReamç­‰è®¤è¯æ–¹å¼ï¼Œä½†è‡ªå®šä¹‰çš„ Realm é€šå¸¸æ˜¯æœ€é€‚åˆæˆ‘ä»¬ä¸šåŠ¡éœ€è¦çš„ï¼Œè®¤è¯é€šå¸¸æ˜¯æ ¡éªŒç™»å½•ç”¨æˆ·æ˜¯å¦åˆæ³•ã€‚ æ–°å»ºç”¨æˆ· User12345678910111213141516@Data@Entitypublic class User implements Serializable &#123; @Id @GeneratedValue(strategy=GenerationType.AUTO) private Long id; @Column(unique =true) private String username; private String password; private String salt;&#125; å®šä¹‰ Repository123456@Repositorypublic interface UserRepository extends JpaRepository&lt;User, Long&gt; &#123; public User findUserByUsername(String username);&#125; ç¼–å†™UserControllerï¼š1234567@GetMapping(\"/login\")public void login(String username, String password) &#123; UsernamePasswordToken token = new UsernamePasswordToken(username, password); token.setRememberMe(true); Subject currentUser = SecurityUtils.getSubject(); currentUser.login(token);&#125; è‡ªå®šä¹‰ Realmè‡ªå®šä¹‰ Realmï¼Œä¸»è¦æ˜¯ä¸ºäº†é‡å†™ doGetAuthenticationInfo(â€¦)æ–¹æ³• 123456789@Overrideprotected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123; UsernamePasswordToken token = (UsernamePasswordToken) authenticationToken; String username = token.getUsername(); User user = userRepository.findUserByUsername(username); SimpleAuthenticationInfo simpleAuthenticationInfo = new SimpleAuthenticationInfo(user, user.getPassword(), getName()); simpleAuthenticationInfo.setCredentialsSalt(ByteSource.Util.bytes(user.getSalt())); return simpleAuthenticationInfo;&#125; è¿™äº›ä»£ç æˆ‘éœ€è¦åšä¸€ä¸ªè¯´æ˜ï¼Œä½ å¯èƒ½ä¹Ÿæ»¡è‚šå­ç–‘æƒ‘: è¿™æ®µä»£ç æ€ä¹ˆåº”ç”¨äº† shiroï¼Ÿ controller æ˜¯æ€ä¹ˆè°ƒç”¨åˆ° custom realm çš„ï¼Ÿ é‡å†™çš„ doGetAuthenticationInfo(â€¦) æ–¹æ³•ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ è®¤è¯æµç¨‹è¯´æ˜ç”¨æˆ·è®¿é—®/user/login è·¯å¾„ï¼Œç”Ÿæˆ UsernamePasswordToken, é€šè¿‡SecurityUtils.getSubject()è·å–Subjectï¼ˆcurrentUserï¼‰ï¼Œè°ƒç”¨ login æ–¹æ³•è¿›è¡ŒéªŒè¯ï¼Œè®©æˆ‘ä»¬è·Ÿè¸ªä¸€ä¸‹ä»£ç ï¼Œç§ä¸€ç§å°±çŸ¥é“è‡ªå®šä¹‰çš„CustomRealmæ€æ ·èµ·ä½œç”¨çš„ï¼Œä¸€èµ·æ¥çœ‹æºç ï¼š åˆ°è¿™é‡Œæˆ‘ä»¬è¦åœä¸€åœäº†ï¼Œè¯·å›çœ‹ Shiro è¿‘æ™¯å›¾ï¼Œå°†æºç è¿½è¸ªè·¯å¾„ä¸å…¶å¯¹æ¯”ï¼Œæ˜¯å®Œå…¨ä¸€è‡´çš„ æˆæƒèº«ä»½è®¤è¯æ˜¯éªŒè¯ä½ æ˜¯è°çš„é—®é¢˜ï¼Œè€Œæˆæƒæ˜¯ä½ èƒ½å¹²ä»€ä¹ˆçš„é—®é¢˜ï¼Œ äº§å“ç»ç†ï¼šç”³è´­æ¨¡å—åªèƒ½ç§‘å®¤çœ‹ç¨‹åºå‘˜ï¼šå¥½çš„äº§å“ç»ç†ï¼šç§‘é•¿æƒé™å¤§ä¸€äº›ï¼Œä»–ä¹Ÿèƒ½çœ‹ç”³è´­æ¨¡å—ç¨‹åºå‘˜ï¼šå¥½çš„(é»‘è„¸)äº§å“ç»ç†ï¼šç§‘é•¿ä¸ä½†èƒ½çœ‹ï¼Œè¿˜èƒ½ä¿®æ”¹æ•°æ®ç¨‹åºå‘˜ï¼šå…³å…¬æå¤§åˆ€ï¼Œæ‹¿å‘½æ¥â€¦ ä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘ä»¬çš„å®—æ—¨æ˜¯ï¼šã€Œèƒ½åŠ¨æ‰‹å°±ä¸åµåµã€; ç¡çƒŸæ€’ç«æ‹”åœ°èµ·ï¼Œè€³è¾¹å“èµ·é©¼é“ƒå£°ï¼ˆShiroï¼‰ï¼šã€Œæ”¾ä¸‹å± åˆ€ï¼Œç«‹åœ°æˆä½›ã€æˆæƒæ²¡æœ‰é‚£ä¹ˆéº»çƒ¦ï¼Œå¤§å®¶å¥½å•†é‡â€¦ æ•´ä¸ªè¿‡ç¨‹å’Œèº«ä»½è®¤è¯åŸºæœ¬æ˜¯ä¸€æ¯›ä¸€æ ·ï¼Œä½ å¯¹æ¯”çœ‹çœ‹ è§’è‰²å®ä½“åˆ›å»ºæ¶‰åŠåˆ°æˆæƒï¼Œè‡ªç„¶è¦å’Œè§’è‰²ç›¸å…³ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»º Role å®ä½“: 123456789101112@Data@Entitypublic class Role &#123; @Id @GeneratedValue(strategy=GenerationType.AUTO) private Long id; @Column(unique =true) private String roleCode; private String roleName;&#125; æ–°å»º Role Repository123456789@Repositorypublic interface RoleRepository extends JpaRepository&lt;Role, Long&gt; &#123; @Query(value = \"select roleId from UserRoleRel ur where ur.userId = ?1\") List&lt;Long&gt; findUserRole(Long userId); List&lt;Role&gt; findByIdIn(List&lt;Long&gt; ids);&#125; å®šä¹‰æƒé™å®ä½“ Permission123456789101112@Data@Entitypublic class Permission &#123; @Id @GeneratedValue(strategy=GenerationType.AUTO) private Long id; @Column(unique =true) private String permCode; private String permName;&#125; å®šä¹‰ Permission Repository12345678@Repositorypublic interface PermissionRepository extends JpaRepository&lt;Permission, Long&gt; &#123; @Query(value = \"select permId from RolePermRel pr where pr.roleId in ?1\") List&lt;Long&gt; findRolePerm(List&lt;Long&gt; roleIds); List&lt;Permission&gt; findByIdIn(List&lt;Long&gt; ids);&#125; å»ºç«‹ç”¨æˆ·ä¸è§’è‰²å…³ç³»å…¶å®å¯ä»¥é€šè¿‡ JPA æ³¨è§£æ¥åˆ¶å®šå…³ç³»çš„ï¼Œè¿™é‡Œä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œä»¥å•ç‹¬å¤–é”®å½¢å¼è¯´æ˜ 1234567891011121314@Data@Entitypublic class UserRoleRel &#123; @Id @GeneratedValue(strategy=GenerationType.AUTO) private Long id; private Long userId; private Long roleId;&#125; å»ºç«‹è§’è‰²ä¸æƒé™å…³ç³»12345678910111213@Data@Entitypublic class RolePermRel &#123; @Id @GeneratedValue(strategy=GenerationType.AUTO) private Long id; private Long permId; private Long roleId;&#125; ç¼–å†™ UserController12345@RequiresPermissions(\"user:list:view\")@GetMapping()public void getAllUsers()&#123; List&lt;User&gt; users = userRepository.findAll();&#125; @RequiresPermissions(&quot;user:list:view&quot;) æ³¨è§£è¯´æ˜å…·æœ‰ç”¨æˆ·ï¼šåˆ—è¡¨ï¼šæŸ¥çœ‹æƒé™çš„æ‰å¯ä»¥è®¿é—®ï¼‰ï¼Œå®˜ç½‘æ˜ç¡®ç»™å‡ºæƒé™å®šä¹‰æ ¼å¼ï¼ŒåŒ…æ‹¬é€šé…ç¬¦ç­‰ï¼Œæˆ‘å¸Œæœ›ä½ è‡ªè¡Œå»æŸ¥çœ‹ è‡ªå®šä¹‰ CustomRealm (ä¸»è¦é‡å†™ doGetAuthorizationInfo) æ–¹æ³•: ä¸è®¤è¯æµç¨‹å¦‚å‡ºä¸€è¾™ï¼Œåªä¸è¿‡å¤šäº†ç”¨æˆ·ï¼Œè§’è‰²ï¼Œæƒé™çš„å…³ç³»ç½¢äº† æˆæƒæµç¨‹è¯´æ˜è¿™é‡Œé€šè¿‡è¿‡æ»¤å™¨ï¼ˆè§Shiroé…ç½®ï¼‰å’Œæ³¨è§£äºŒè€…ç»“åˆçš„æ–¹å¼æ¥è¿›è¡Œæˆæƒï¼Œå’Œè®¤è¯æµç¨‹ä¸€æ ·ï¼Œæœ€ç»ˆä¼šèµ°åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„ CustomRealm ä¸­ï¼ŒåŒæ · Shiro é»˜è®¤æä¾›äº†è®¸å¤šæ³¨è§£ç”¨æ¥å¤„ç†ä¸åŒçš„æˆæƒæƒ…å†µ æ³¨è§£ åŠŸèƒ½ @RequiresGuest åªæœ‰æ¸¸å®¢å¯ä»¥è®¿é—® @RequiresAuthentication éœ€è¦ç™»å½•æ‰èƒ½è®¿é—® @RequiresUser å·²ç™»å½•çš„ç”¨æˆ·æˆ–â€œè®°ä½æˆ‘â€çš„ç”¨æˆ·èƒ½è®¿é—® @RequiresRoles å·²ç™»å½•çš„ç”¨æˆ·éœ€å…·æœ‰æŒ‡å®šçš„è§’è‰²æ‰èƒ½è®¿é—® @RequiresPermissions å·²ç™»å½•çš„ç”¨æˆ·éœ€å…·æœ‰æŒ‡å®šçš„æƒé™æ‰èƒ½è®¿é—®ï¼ˆå¦‚æœä¸æƒ³å’Œäº§å“ç»ç†åå±±è®ºå‰‘ï¼Œæ¨èç”¨è¿™ä¸ªæ³¨è§£ï¼‰ æˆæƒå®˜ç½‘ç»™å‡ºæ˜ç¡®çš„æˆæƒç­–ç•¥ä¸æ¡ˆä¾‹ï¼Œè¯·æŸ¥çœ‹ï¼šhttp://shiro.apache.org/permissions.html ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬é€šè¿‡ä¸€ç›´åœ¨é€šè¿‡è®¿é—® Mysql è·å–ç”¨æˆ·è®¤è¯å’Œæˆæƒä¿¡æ¯ï¼Œè¿™ä¸­æ–¹å¼æ˜æ˜¾ä¸ç¬¦åˆç”Ÿäº§ç¯å¢ƒçš„éœ€æ±‚ Sessionä¼šè¯ç®¡ç†åšè¿‡ Web å¼€å‘çš„åŒå­¦éƒ½çŸ¥é“ Session çš„æ¦‚å¿µï¼Œæœ€å¸¸ç”¨çš„æ˜¯ Session è¿‡æœŸæ—¶é—´ï¼Œæ•°æ®åœ¨ Session çš„ CRUDï¼ŒåŒæ ·çœ‹ä¸Šå›¾ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨ SessionManager å’Œ SessionDAO æ¨¡å—ï¼ŒShiro starter å·²ç»æä¾›äº†åŸºæœ¬çš„ Sessioné…ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬æŒ‰éœ€åœ¨YAMLä¸­é…ç½®å°±å¥½ï¼ˆå®˜ç½‘https://shiro.apache.org/spring-boot.html å·²ç»æ˜ç¡®ç»™å‡ºSessionçš„é…ç½®ä¿¡æ¯ï¼‰ Key Default Value Description shiro.enabled true Enables Shiroâ€™s Spring module shiro.web.enabled true Enables Shiroâ€™s Spring web module shiro.annotations.enabled true Enables Spring support for Shiroâ€™s annotations shiro.sessionManager.deleteInvalidSessions true Remove invalid session from session storage shiro.sessionManager.sessionIdCookieEnabled true Enable session ID to cookie, for session tracking shiro.sessionManager.sessionIdUrlRewritingEnabled true Enable session URL rewriting support shiro.userNativeSessionManager false If enabled Shiro will manage the HTTP sessions instead of the container shiro.sessionManager.cookie.name JSESSIONID Session cookie name shiro.sessionManager.cookie.maxAge -1 Session cookie max age shiro.sessionManager.cookie.domain null Session cookie domain shiro.sessionManager.cookie.path null Session cookie path shiro.sessionManager.cookie.secure false Session cookie secure flag shiro.rememberMeManager.cookie.name rememberMe RememberMe cookie name shiro.rememberMeManager.cookie.maxAge one year RememberMe cookie max age shiro.rememberMeManager.cookie.domain null RememberMe cookie domain shiro.rememberMeManager.cookie.path null RememberMe cookie path shiro.rememberMeManager.cookie.secure false RememberMe cookie secure flag shiro.loginUrl /login.jsp Login URL used when unauthenticated users are redirected to login page shiro.successUrl / Default landing page after a user logs in (if alternative cannot be found in the current session) shiro.unauthorizedUrl null Page to redirect user to if they are unauthorized (403 page) åˆ†å¸ƒå¼æœåŠ¡ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å°†Sessionä¿¡æ¯æ”¾å…¥Redisä¸­æ¥ç®¡ç†ï¼Œæ¥åº”å¯¹é«˜å¹¶å‘çš„è®¿é—®éœ€æ±‚ï¼Œè¿™æ—¶åªéœ€é‡å†™SessionDAOå³å¯å®Œæˆè‡ªå®šä¹‰çš„Sessionç®¡ç† æ•´åˆRedis12345678910111213141516@Configurationpublic class RedisConfig &#123; @Autowired private RedisConnectionFactory redisConnectionFactory; @Bean public RedisTemplate&lt;String, Object&gt; stringObjectRedisTemplate() &#123; RedisTemplate&lt;String, Object&gt; template = new RedisTemplate&lt;&gt;(); template.setConnectionFactory(redisConnectionFactory); template.setKeySerializer(new StringRedisSerializer()); template.setValueSerializer(new GenericJackson2JsonRedisSerializer()); return template; &#125;&#125; é‡å†™SessionDao æŸ¥çœ‹æºç ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨é»˜è®¤SessionManagerçš„retriveSessionæ–¹æ³•ï¼Œæˆ‘ä»¬é‡å†™è¯¥æ–¹æ³•ï¼Œå°†Sessionæ”¾å…¥HttpRequestä¸­ï¼Œè¿›ä¸€æ­¥æé«˜sessionè®¿é—®æ•ˆç‡ å‘ShiroConfigä¸­æ·»åŠ é…ç½® å…¶å®åœ¨æ¦‚è§ˆæ¨¡å—å·²ç»ç»™å‡ºä»£ç å±•ç¤ºï¼Œè¿™é‡Œå•ç‹¬åˆ—å‡ºæ¥åšè¯´æ˜: 123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * è‡ªå®šä¹‰RedisSessionDaoç”¨æ¥ç®¡ç†Sessionåœ¨Redisä¸­çš„CRUD * @return */@Bean(name = \"redisSessionDao\")public RedisSessionDao redisSessionDao()&#123; return new RedisSessionDao();&#125;/** * è‡ªå®šä¹‰SessionManager,åº”ç”¨è‡ªå®šä¹‰SessionDao * @return */@Bean(name = \"customerSessionManager\")public CustomerWebSessionManager customerWebSessionManager()&#123; CustomerWebSessionManager customerWebSessionManager = new CustomerWebSessionManager(); customerWebSessionManager.setSessionDAO(redisSessionDao()); return customerWebSessionManager;&#125;/** * å®šä¹‰Security manager * @param customRealm * @return */@Bean(name = \"securityManager\")public DefaultWebSecurityManager defaultWebSecurityManager(CustomRealm customRealm) &#123; DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager (); securityManager.setRealm(customRealm); securityManager.setSessionManager(customerWebSessionManager()); // å¯ä¸æŒ‡å®šï¼ŒShiroä¼šç”¨é»˜è®¤Session manager securityManager.setCacheManager(redisCacheManagers()); //å¯ä¸æŒ‡å®šï¼ŒShiroä¼šç”¨é»˜è®¤CacheManager// securityManager.setSessionManager(defaultWebSessionManager()); return securityManager;&#125;/** * å®šä¹‰sessionç®¡ç†å™¨ * @return */@Bean(name = \"sessionManager\")public DefaultWebSessionManager defaultWebSessionManager()&#123; DefaultWebSessionManager defaultWebSessionManager = new DefaultWebSessionManager(); defaultWebSessionManager.setSessionDAO(redisSessionDao()); return defaultWebSessionManager;&#125; è‡³æ­¤ï¼Œå°† session ä¿¡æ¯ç”± redis ç®¡ç†åŠŸèƒ½å°±è¿™æ ·å®Œæˆäº† ç¼“å­˜ç®¡ç†åº”å¯¹åˆ†å¸ƒå¼æœåŠ¡ï¼Œå¯¹äºé«˜å¹¶å‘è®¿é—®æ•°æ®åº“æƒé™å†…å®¹æ˜¯éå¸¸ä½æ•ˆçš„æ–¹å¼ï¼ŒåŒæ ·æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Redisæ¥è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå°†æˆæƒæ•°æ®ç¼“å­˜åˆ°Redisä¸­ æ–°å»º RedisCache123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263@Slf4j@Componentpublic class RedisCache&lt;K, V&gt; implements Cache&lt;K, V&gt; &#123; public static final String SHIRO_PREFIX = \"shiro-cache:\"; @Resource private RedisTemplate&lt;String, Object&gt; stringObjectRedisTemplate; private String getKey(K key)&#123; if (key instanceof String)&#123; return (SHIRO_PREFIX + key); &#125; return key.toString(); &#125; @Override public V get(K k) throws CacheException &#123; log.info(\"read from redis...\"); V v = (V) stringObjectRedisTemplate.opsForValue().get(getKey(k)); if (v != null)&#123; return v; &#125; return null; &#125; @Override public V put(K k, V v) throws CacheException &#123; stringObjectRedisTemplate.opsForValue().set(getKey(k), v); stringObjectRedisTemplate.expire(getKey(k), 100, TimeUnit.SECONDS); return v; &#125; @Override public V remove(K k) throws CacheException &#123; V v = (V) stringObjectRedisTemplate.opsForValue().get(getKey(k)); stringObjectRedisTemplate.delete((String) get(k)); if (v != null)&#123; return v; &#125; return null; &#125; @Override public void clear() throws CacheException &#123; //ä¸è¦é‡å†™ï¼Œå¦‚æœåªä¿å­˜shiroæ•°æ®æ— æ‰€è°“ &#125; @Override public int size() &#123; return 0; &#125; @Override public Set&lt;K&gt; keys() &#123; return null; &#125; @Override public Collection&lt;V&gt; values() &#123; return null; &#125;&#125; æ–°å»º RedisCacheManager12345678910public class RedisCacheManager implements CacheManager &#123; @Resource private RedisCache redisCache; @Override public &lt;K, V&gt; Cache&lt;K, V&gt; getCache(String s) throws CacheException &#123; return redisCache; &#125;&#125; è‡³æ­¤ï¼Œæˆ‘ä»¬ä¸ç”¨æ¯æ¬¡è®¿é—® Mysql DB æ¥è·å–è®¤è¯å’Œæˆæƒä¿¡æ¯ï¼Œè€Œæ˜¯é€šè¿‡ Redis æ¥ç¼“å­˜è¿™äº›ä¿¡æ¯ï¼Œå¤§å¤§æå‡äº†æ•ˆç‡ï¼Œä¹Ÿæ»¡è¶³åˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡éœ€æ±‚ æ€»ç»“å›å¤å…¬ä¼—å· ã€Œdemoã€è·å– demo ä»£ç ã€‚è¿™é‡Œåªæ˜¯æ¢³ç†äº†Springbootæ•´åˆShiroçš„æµç¨‹ï¼Œä»¥åŠåº”ç”¨Redisæœ€å¤§åŒ–åˆ©ç”¨Shiroï¼ŒShiroçš„ä½¿ç”¨ç»†èŠ‚è¿˜å¾ˆå¤šï¼Œå®˜ç½‘è¯´çš„ä¹Ÿå¾ˆæ˜ç¡®ï¼Œå¸¦ç€ä¸Šé¢çš„æ¶æ„å›¾æ¥ç†è§£Shiroä¼šäº‹åŠåŠŸå€ï¼Œæ„Ÿè§‰è¿™é‡Œé¢çš„ä»£ç æŒºå¤šæŒºå¤´å¤§çš„ï¼Ÿé‚£æ˜¯ä½ æ²¡æœ‰è‡ªå·±åŠ¨æ‰‹å»å°è¯•ï¼Œç»“åˆå®˜ç½‘ä¸ demo ç›¸ä¿¡ä½ ä¼šå¯¹ Shiro æœ‰æ›´å¥½çš„ç†è§£ï¼Œå¦å¤–ä½ å¯ä»¥ç†è§£ Shiro æ˜¯ mini ç‰ˆæœ¬çš„ Spring Securityï¼Œæˆ‘å¸Œæœ›ä»¥å°è§å¤§ï¼Œå½“éœ€è¦æ›´ç»†ç²’åº¦çš„è®¤è¯æˆæƒæ—¶ï¼Œä¹Ÿä¼šå¯¹ç†è§£ Spring Security æœ‰å¾ˆå¤§å¸®åŠ©ï¼Œç‚¹å‡»æ–‡æœ«ã€Œé˜…è¯»åŸæ–‡ã€ï¼Œæ•ˆæœæ›´å¥½ è½éœä¸å­¤é¹œé½é£ ç§‹æ°´å…±é•¿å¤©ä¸€è‰²ï¼Œäº§å“ç»ç†å’Œç¨‹åºå‘˜ä¸€ç‰‡ç¥¥å’Œâ€¦ çµé­‚è¿½é—® éƒ½è¯´ Redis æ˜¯å•çº¿ç¨‹ï¼Œä½†æ˜¯å¾ˆå¿«ï¼Œä½ çŸ¥é“ä¸ºä»€ä¹ˆå—ï¼Ÿ ä½ ä»¬é¡¹ç›®ä¸­æ˜¯æ€æ ·æ§åˆ¶è®¤è¯æˆæƒçš„å‘¢ï¼Ÿå½“æˆæƒæœ‰å˜åŒ–ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™ä¸ªä¿®æ”¹æ˜¯ç¾éš¾å—ï¼Ÿ æé«˜æ•ˆç‡å·¥å…· MarkDown è¡¨æ ¼ç”Ÿæˆå™¨æœ¬æ–‡çš„å¥½å¤šè¡¨æ ¼æ˜¯ä»å®˜ç½‘ç²˜è´´çš„ï¼Œå¦‚ä½•å°†å…¶ç›´æ¥è½¬æ¢æˆ MD table å‘¢ï¼Ÿé‚£ä¹ˆ https://www.tablesgenerator.com/markdown_tables å°±å¯ä»¥å¸®åˆ°ä½ äº†ï¼Œæ— è®ºæ˜¯ç”Ÿæˆ MD tableï¼Œè¿˜æ˜¯ç²˜è´´å†…å®¹ç”Ÿæˆ table å’Œå†…å®¹éƒ½æ˜¯æå¥½çš„ï¼Œå½“ç„¶äº†ä¸æ­¢ MD tableï¼Œè‡ªå·±å‘ç°å§ï¼Œæ›´å¤šå·¥å…·ï¼Œå…¬ä¼—å·å›å¤ ã€Œå·¥å…·ã€è·å¾— æ¨èé˜…è¯» åªä¼šç”¨ git pull ï¼Ÿæœ‰æ—¶å€™ä½ å¯ä»¥å°è¯•æ›´ä¼˜é›…çš„å¤„ç†æ–¹å¼ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API ç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» å›å¤ã€Œå·¥å…·ã€ é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– å›å¤ã€Œèµ„æ–™ã€ åç»­ä¼šæ¨å‡ºã€Œå¤šçº¿ç¨‹ã€ä¸ã€ŒElasticSearchã€ç­‰è¿è½½å†…å®¹ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Shiro","slug":"Shiro","permalink":"https://dayarch.top/tags/Shiro/"}]},{"title":"@Conditionalæ³¨è§£ï¼ŒSpring Boot çš„çµæ´»é…ç½®","slug":"Conditionalæ³¨è§£ï¼ŒSpring-Boot-çš„çµæ´»é…ç½®","date":"2019-07-31T08:30:07.000Z","updated":"2019-11-07T06:35:47.024Z","comments":true,"path":"/p/spring-boot-condition-annotation.html","link":"","permalink":"https://dayarch.top/p/spring-boot-condition-annotation.html","excerpt":"ä¸Šä¸€ç¯‡æ–‡ç«  ä½ åº”è¯¥çŸ¥é“çš„ @ConfigurationProperties æ³¨è§£çš„ä½¿ç”¨å§¿åŠ¿ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº† ä»‹ç»äº†å¦‚ä½•é€šè¿‡ @ConfigurationProperties æ³¨è§£çµæ´»è¯»å–é…ç½®å±æ€§ï¼Œè¿™ç¯‡æ–‡ç« å°†ä»‹ç»å¦‚ä½•çµæ´»é…ç½® Spring Bean å†™åœ¨å‰é¢ å½“æˆ‘ä»¬æ„å»ºä¸€ä¸ª Spring åº”ç”¨çš„æ—¶å€™ï¼Œæœ‰æ—¶æˆ‘ä»¬æƒ³åœ¨æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„æ—¶å€™æ‰å°†æŸä¸ª bean åŠ è½½åˆ°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼Œ åœ¨Spring 4.0 æ—¶ä»£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ @Conditional æ³¨è§£æ¥å®ç°è¿™ç±»æ“ä½œ æˆ‘ä»¬çœ‹åˆ° @Conditional æ³¨è§£æ¥æ”¶çš„å‚æ•°æ˜¯ extends Condition æ¥å£çš„æ³›å‹ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ @Con","text":"ä¸Šä¸€ç¯‡æ–‡ç«  ä½ åº”è¯¥çŸ¥é“çš„ @ConfigurationProperties æ³¨è§£çš„ä½¿ç”¨å§¿åŠ¿ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº† ä»‹ç»äº†å¦‚ä½•é€šè¿‡ @ConfigurationProperties æ³¨è§£çµæ´»è¯»å–é…ç½®å±æ€§ï¼Œè¿™ç¯‡æ–‡ç« å°†ä»‹ç»å¦‚ä½•çµæ´»é…ç½® Spring Bean å†™åœ¨å‰é¢å½“æˆ‘ä»¬æ„å»ºä¸€ä¸ª Spring åº”ç”¨çš„æ—¶å€™ï¼Œæœ‰æ—¶æˆ‘ä»¬æƒ³åœ¨æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„æ—¶å€™æ‰å°†æŸä¸ª bean åŠ è½½åˆ°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ï¼Œ åœ¨Spring 4.0 æ—¶ä»£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ @Conditional æ³¨è§£æ¥å®ç°è¿™ç±»æ“ä½œ æˆ‘ä»¬çœ‹åˆ° @Conditional æ³¨è§£æ¥æ”¶çš„å‚æ•°æ˜¯ extends Condition æ¥å£çš„æ³›å‹ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ @Conditional æ³¨è§£ï¼Œåªéœ€è¦å®ç° Condition æ¥å£å¹¶é‡å†™å…¶æ–¹æ³•å³å¯: çœ‹åˆ°æ¥å£çš„ matches æ–¹æ³•è¿”å›çš„æ˜¯ boolean ç±»å‹ï¼Œæ˜¯ä¸æ˜¯å’Œæˆ‘ä»¬è‡ªå®šä¹‰ validation annotation æœ‰äº›ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ»¡è¶³æŒ‡å®šæ¡ä»¶ã€‚å¦å¤–æ³¨æ„çœ‹ï¼Œä»¥ä¸Šæ³¨è§£å’Œæ¥å£éƒ½åœ¨ org.springframework.context.annotation package ä¸­ ç»ˆäºåˆ°äº† Spring Boot æ—¶ä»£ï¼Œåœ¨è¿™ä¸ªå…¨æ–°çš„æ—¶ä»£ï¼ŒSpring Boot åœ¨ @Conditional æ³¨è§£çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ç»†åŒ–ï¼Œæ— éœ€å‡ºç¤ºå¤æ‚çš„ä»‹ç»ä¿¡ (å®ç° Condition æ¥å£)ï¼Œåªéœ€è¦æ‰‹æŒé¢„å®šä¹‰å¥½çš„ @ConditionalOnXxxx æ³¨è§£å°ç« çš„é—¨ç¥¨ï¼Œå¦‚æœéªŒè¯é€šè¿‡ï¼Œå°±ä¼šèµ°è¿› Application Context å¤§å… æ³¨è§£è¯¦è§£Spring Boot å¯¹ @Conditional æ³¨è§£ä¸ºæˆ‘ä»¬åšäº†ç»†åŒ–ï¼Œè¿™äº›æ³¨è§£éƒ½å®šä¹‰åœ¨ org.springframework.boot.autoconfigure.condition package ä¸‹ é€ä¸ªæ‰“å¼€è¿™ 13 ä¸ªæ³¨è§£ï¼Œæˆ‘ä»¬å‘ç°è¿™äº›æ³¨è§£ä¸Šæœ‰ç›¸åŒçš„å…ƒæ³¨è§£: ä»è¿™äº›æ ‡è®°ä¸Šæˆ‘ä»¬å¯ä»¥äº†è§£å¦‚ä¸‹å†…å®¹: éƒ½å¯ä»¥åº”ç”¨åœ¨ TYPE ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒSpring è‡ªåŠ¨æ‰«æçš„ä¸€åˆ‡ç±» (@Configuration, @Component, @Service, @Repository, or @Controller) éƒ½å¯ä»¥é€šè¿‡æ·»åŠ ç›¸åº”çš„ @ConditionalOnXxxx æ¥åˆ¤æ–­æ˜¯å¦åŠ è½½ éƒ½å¯ä»¥åº”ç”¨åœ¨ METHOD ä¸Šï¼Œæ‰€ä»¥æœ‰ @Bean æ ‡è®°çš„æ–¹æ³•ä¹Ÿå¯ä»¥åº”ç”¨è¿™äº›æ³¨è§£ éƒ½æ˜¯ç”¨äº† @Conditional æ³¨è§£æ¥æ ‡è®°ï¼ŒOnBeanCondition ç­‰è‡ªå®šä¹‰ Condition è¿˜æ˜¯å®ç°äº† Condition æ¥å£çš„ï¼Œæ¢æ±¤ä¸æ¢è¯ï¼Œæ²¡ä»€ä¹ˆç¥ç§˜çš„ï¼Œåªä¸è¿‡åšäº†æ›´å…·è±¡çš„å°è£…ç½¢äº†ï¼Œæ¥çœ‹ç±»ä¾èµ–å›¾: å…¶å®çœ‹è¿™äº›æ³¨è§£å­—é¢æ„æ€å·²ç»èƒ½ç†è§£è¿™äº›æ³¨è§£çš„å«ä¹‰ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯è¦è¯´æ˜å…·ä½“çš„ä½¿ç”¨ä»¥åŠä¸€äº›æ³¨æ„äº‹é¡¹ï¼Œæˆ‘æŒ‰ç…§ä¸ªäººä½¿ç”¨é¢‘æ¬¡ç”±é«˜åˆ°ä½è®²è§£: @ConditionalOnPropertyæ¯«æ— ç–‘é—®è¿™ä¸ªæ³¨è§£æ˜¯æ¦œé¦– è¿™ä¸ªæ¡ä»¶è§£é‡Šæ˜¯: application.properties æˆ– application.yml æ–‡ä»¶ä¸­ mybean.enable ä¸º true æ‰ä¼šåŠ è½½ MyCondition è¿™ä¸ª Beanï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…ä¸Šä¹Ÿä¼šåŠ è½½ï¼Œå› ä¸º matchIfMissing = trueï¼Œé»˜è®¤å€¼æ˜¯ falseã€‚ @ConditionalOnBean å’Œ ConditionalOnMissingBeanæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æŸä¸ª Bean å·²ç»å­˜åœ¨åº”ç”¨ä¸Šä¸‹æ–‡æ—¶æ‰ä¼šåŠ è½½ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šç”¨åˆ° @ConditionalOnBean æ³¨è§£: ä¸ä¹‹ç›¸åï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æŸä¸ª Bean ä¸å­˜åœ¨äºåº”ç”¨ä¸Šä¸‹æ–‡æ—¶æ‰ä¼šåŠ è½½ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šç”¨åˆ° @ConditionalOnMissingBean æ³¨è§£ @ConditionalOnClass å’Œ @ConditionalOnMissingClassä¸è¦å«Œæˆ‘åºŸè¯ï¼Œå’Œä¸Šé¢çš„ä¸€æ ·ï¼Œåªä¸è¿‡åˆ¤æ–­æŸä¸ªç±»æ˜¯å¦å­˜åœ¨äº classpath ä¸­ï¼Œè¿™å°±ä¸åšè¿‡å¤šè¯´æ˜äº† @ConditionalOnExpressionå¦‚æœæˆ‘ä»¬æœ‰æ›´å¤æ‚çš„å¤šä¸ªé…ç½®å±æ€§ä¸€èµ·åˆ¤æ–­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªè¡¨è¾¾å¼äº†: åªæœ‰å½“ä¸¤ä¸ªå±æ€§éƒ½ä¸º true çš„æ—¶å€™æ‰åŠ è½½ MyModuleï¼Œåˆ°è¿™é‡Œè¦é¡ºä¾¿æ­æ™“ä¸Šä¸€ç¯‡æ–‡ç«  ä½ åº”è¯¥çŸ¥é“çš„ @ConfigurationProperties æ³¨è§£çš„ä½¿ç”¨å§¿åŠ¿ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº† çµé­‚è¿½é—® 3ï¼Œå…¶ä¸­ :true å°±æ˜¯: å¦‚æœæ²¡æœ‰ä¸ºè¯¥å±æ€§è®¾ç½®å€¼ï¼Œåˆ™ä¸ºè¯¥å±æ€§è®¾ç½®é»˜è®¤å€¼true, å…¶å®è¿™å°±æ˜¯@Vaue æ³¨è§£çš„è§„èŒƒï¼Œä¸€åˆ‡ SpEL éƒ½å¯ä»¥åº”ç”¨åœ¨è¿™é‡Œ. å†™åˆ°è¿™ï¼Œæˆ‘å¸¸ç”¨çš„å·²ç»ç”¨å®Œäº†ï¼Œè¿˜è¦ç¡¬ç€å¤´çš®ä»‹ç»å…¶ä»–å‡ ä¸ªå†…å®¹ ğŸ˜„ï¼Œå¼€ä¸ªç©ç¬‘ï¼Œå’±ä»¬ç»§ç»­: @ConditionalOnSingleCandidateè¿™ä¸ªæ³¨è§£å’Œ @ConditionalOnBean ç±»ä¼¼ï¼Œä¸ºäº†æ›´å¥½çš„è¯´æ˜è¯¥æ³¨è§£çš„ä½¿ç”¨ (å…¶å®æ˜¯ æ‰ç–å­¦æµ… ) ï¼Œæˆ‘åªèƒ½ç¿»è¯‘ä¸€ä¸‹ç±»çš„æ³¨é‡Šäº† åªæœ‰æŒ‡å®šç±»å·²å­˜åœ¨äº BeanFactory ä¸­ï¼Œå¹¶ä¸”å¯ä»¥ç¡®å®šå•ä¸ªå€™é€‰é¡¹æ‰ä¼šåŒ¹é…æˆåŠŸ BeanFactory å­˜åœ¨å¤šä¸ª bean å®ä¾‹ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ª primary å€™é€‰é¡¹è¢«æŒ‡å®š(é€šå¸¸åœ¨ç±»ä¸Šä½¿ç”¨ @Primary æ³¨è§£)ï¼Œä¹Ÿä¼šåŒ¹é…æˆåŠŸã€‚å®è´¨ä¸Šï¼Œå¦‚æœè‡ªåŠ¨è¿æ¥å…·æœ‰å®šä¹‰ç±»å‹çš„ bean åŒ¹é…å°±ä¼šæˆåŠŸ ç›®å‰ï¼Œæ¡ä»¶åªæ˜¯åŒ¹é…å·²ç»è¢«åº”ç”¨ä¸Šä¸‹æ–‡å¤„ç†çš„ bean å®šä¹‰ï¼Œæœ¬èº«æ¥è®²ï¼Œå¼ºçƒˆå»ºè®®ä»…ä»…åœ¨ auto-configuration ç±»ä¸­ä½¿ç”¨è¿™ä¸ªæ¡ä»¶ï¼Œå¦‚æœå€™é€‰ bean è¢«å¦å¤–ä¸€ä¸ª auto-configuration åˆ›å»ºï¼Œç¡®ä¿ä½¿ç”¨è¯¥æ¡ä»¶çš„è¦åœ¨å…¶åé¢è¿è¡Œ @ConditionalOnResourceå¦‚æœæˆ‘ä»¬è¦åŠ è½½çš„ bean ä¾èµ–æŒ‡å®šèµ„æºæ˜¯å¦å­˜åœ¨äº classpath ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ³¨è§£ çœ‹åˆ°è¿™ä¸ª logback.xml æ˜¯ä¸æ˜¯å¾ˆäº²åˆ‡ï¼Œåœ¨æˆ‘ä»¬å¼•å…¥ç¬¬ä¸‰æ–¹å·¥å…·ç±»å¦‚ Dozer ç­‰éƒ½å¯ä»¥æ·»åŠ ç±»ä¼¼çš„å¼€å…³ æ¥ä¸‹æ¥çš„æ˜¯çœŸå†·é—¨ï¼Œå¤§å®¶æœ‰ä¸ªå°è±¡ï¼Œå¦‚æœæœ‰éœ€è¦ï¼Œè‡³å°‘èƒ½æƒ³åˆ°ç”¨è¿™äº›æ³¨è§£å®ç°çµæ´»é…ç½®å°±å¥½äº† @ConditionalOnJndiåªæœ‰æŒ‡å®šçš„èµ„æºé€šè¿‡ JNDI åŠ è½½åæ‰åŠ è½½ bean @ConditionalOnJavaåªæœ‰è¿è¡ŒæŒ‡å®šç‰ˆæœ¬çš„ Java æ‰ä¼šåŠ è½½ Bean @ConditionalOnWebApplication å’Œ @ConditionalOnNotWebApplicationåªæœ‰è¿è¡Œåœ¨ web åº”ç”¨é‡Œæ‰ä¼šåŠ è½½è¿™ä¸ª bean ä¸ä¹‹ç›¸åï¼Œåœ¨é web ç¯å¢ƒæ‰åŠ è½½ bean @ConditionalOnCloudPlatformè¿™ä¸ªæ³¨è§£å†·çš„æˆ‘å‘¼å¸éƒ½è¦åœæ­¢äº†ï¼Œåªæœ‰è¿è¡Œåœ¨æŒ‡å®šçš„äº‘å¹³å°ä¸Šæ‰åŠ è½½æŒ‡å®šçš„ beanï¼ŒCloudPlatform æ˜¯ org.springframework.boot.cloud ä¸‹ä¸€ä¸ª enum ç±»å‹çš„ç±»ï¼Œå¤§å®¶å¯ä»¥æ‰“å¼€è‡ªè¡Œçœ‹çœ‹: åˆ°æ­¤ï¼ŒSpring Boot ä¸ºæˆ‘ä»¬æä¾›çš„è¿™ 13 ä¸ªæ³¨è§£å°±ä»‹ç»å®Œäº†ï¼Œä½†æ˜¯æ²¡æœ‰ç»“æŸï¼Œä¸‹é¢çš„ä¸€äº›å†·é—¨çŸ¥è¯†ï¼Œä½ éœ€è¦çŸ¥é“: ç»„åˆæ¡ä»¶ç»„åˆæ¡ä»¶ ANDå¦‚æœæˆ‘ä»¬æƒ³å¤šä¸ªæ¡ä»¶ä¸€èµ·åº”ç”¨ï¼Œå¹¶ä¸”æ¡ä»¶çš„å…³ç³»æ˜¯ andï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç±»ä¸Šä½¿ç”¨å¤šä¸ª@ConditionalOnXxxx å°±å¯ä»¥äº† (ä½ è¿™ä¹Ÿå«å†·é—¨ï¼Ÿ) ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç»§æ‰¿ AllNestedConditionsç±»å°è£…æˆ‘ä»¬å¤šä¸ªæ¡ä»¶ è¿™æ ·å°±æœ‰äº†ç»„åˆ and æ¡ä»¶ï¼Œåªæœ‰å†…éƒ¨æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³ï¼Œæ‰åŠ è½½æŒ‡å®š bean ç»„åˆæ¡ä»¶ ORå¦‚æœæˆ‘ä»¬å¸Œæœ›ç»„åˆçš„æ¡ä»¶æ˜¯ or çš„å…³ç³»ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿ AnyNestedCondition æ¥å®Œæˆè¿™ä¸€è¦æ±‚ï¼Œç¤ºä¾‹ä»£ç å’Œä¸Šé¢ä¸€æ ·ï¼Œå¤§å®¶è‡ªè¡Œæ‰“å¼€ AnyNestedCondition ç±»ï¼ŒæŸ¥çœ‹ç±»è¯´æ˜å³å¯ æ¡ä»¶ç»„åˆ NONEæœ‰ and å’Œ or å°±è‚¯å®šæœ‰ non(é)ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿ NoneNestedConditions å®Œæˆè¿™ä¸€è¦æ±‚ï¼Œå¤§å®¶è‡ªè¡ŒæŸ¥çœ‹å³å¯ è‡ªå®šä¹‰æ³¨è§£é€šè¿‡ç»„åˆæ–¹å¼å®ç°äº†å¤šæ¡ä»¶é€»è¾‘åº”ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åº”ç”¨è¿™äº›ç»„åˆæ¡ä»¶ä¹Ÿå°±è¦è‡ªå®šä¹‰æ³¨è§£ï¼Œå…¶å®æ–‡ç« å¼€å¤´å·²ç»è®²è¿‡äº†ï¼Œæ¨¡ä»¿å†…ç½®çš„ 13 ä¸ªæ³¨è§£å†™å°±å¥½äº†: åªéœ€è¦é€šè¿‡@Conditionalæ³¨è§£æŒ‡å®šæˆ‘ä»¬è‡ªå®šä¹‰çš„ condition ç±»å°±å¥½äº†ï¼Œç„¶ååº”ç”¨åˆ°ä½ æƒ³ç”¨çš„åœ°æ–¹å°±å¥½äº† è¿˜æ˜¯æ¨èå¤§å®¶çœ‹ RabbitMq çš„ RabbitAutoConfiguration ç±»ï¼Œè¿™ä¸ªç±»é‡Œé¢ä¸»æµçš„æ³¨è§£éƒ½æ˜¯ç”¨äº† (åªçœ‹è¿™ä¸€ä¸ªç±»å°±å¥½äº†)ï¼Œå¤§å®¶çœ‹æ¡†æ¶ç†è§£å­¦ä¹ è¿™äº›æ³¨è§£æ˜¯æ›´å¥½çš„æ–¹å¼: https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/amqp/RabbitAutoConfiguration.java æ€»ç»“åˆ°è¿™é‡Œï¼Œä½ å·²ç»äº†è§£äº†å¦‚ä½•çµæ´»é…ç½® beanï¼Œç»“åˆä¹‹å‰çš„æ–‡ç« ï¼Œç›¸ä¿¡çš„å®šä¹‰ä¼šæ›´åŠ çµæ´»ï¼Œå¸Œæœ›å¤§å®¶æ‰“å¼€ IDEï¼Œè‡ªè¡ŒæŸ¥çœ‹è¿™äº›æ³¨è§£ï¼Œäº†è§£æ›´å¤šå…·ä½“å†…å®¹ çµé­‚è¿½é—® SpringBoot æ·»åŠ äº† web starterï¼Œæœ‰å“ªäº›æ–¹æ³•å°†å…¶æ›´æ”¹ä¸ºé web åº”ç”¨ï¼Ÿ Java8 Stream ä¹Ÿæœ‰ findAnyï¼ŒfindAll è¿™ç±»çš„æ“ä½œï¼Œè¿™éƒ½æ˜¯åŒ¹é…ï¼Œä½ æœ‰ä½¿ç”¨è¿‡å—ï¼Ÿ çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼Œå¦‚æœ classpath ä¸­æ²¡æœ‰ MyBean classï¼Œç¼–è¯‘ä¼šæŠ¥é”™ï¼Œé‚£è¿™ä¸ªæ³¨è§£ä»€ä¹ˆç”¨å‘¢ï¼Ÿ12345@Configuration @ConditionalOnClass(MyBean.class)public class MyConfiguration&#123; // omitted &#125; æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» çº¢é»‘æ ‘ï¼Œè¶…å¼ºåŠ¨é™å›¾è¯¦è§£ï¼Œç®€å•æ˜“æ‡‚ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API ç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« é«˜æ•ˆå·¥å…·æ±‡æ€» é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” æŠ€æœ¯èµ„æ–™é¢†å– åç»­ä¼šæ¨å‡º ã€Œå¤šçº¿ç¨‹ã€ä»¥åŠã€ŒElasticSearchã€ç­‰è¿è½½å†…å®¹ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"},{"name":"æ³¨è§£","slug":"æ³¨è§£","permalink":"https://dayarch.top/tags/%E6%B3%A8%E8%A7%A3/"}]},{"title":"çº¢é»‘æ ‘ï¼Œå²ä¸Šæœ€å¼ºåŠ¨é™å›¾è¯¦è§£","slug":"çº¢é»‘æ ‘ï¼Œå²ä¸Šæœ€å¼ºåŠ¨é™å›¾è¯¦è§£","date":"2019-07-29T08:42:05.000Z","updated":"2019-11-07T06:06:38.332Z","comments":true,"path":"/p/redblack-tree.html","link":"","permalink":"https://dayarch.top/p/redblack-tree.html","excerpt":"å†™åœ¨å‰é¢ çº¢é»‘æ ‘ï¼Œå¯¹å¾ˆå¤šç«¥é‹æ¥è¯´ï¼Œæ˜¯æ—¢ç†Ÿæ‚‰åˆé™Œç”Ÿã€‚å­¦æ ¡ä¸­å­¦è¿‡ï¼Œåªäº†è§£å¤§æ¦‚ï¼›å·¥ä½œä¸­ä¸æ€ä¹ˆä½¿ç”¨ï¼Œä½†é¢è¯•åˆæ˜¯é‡ç‚¹ã€‚æ¯æ¬¡éœ€è¦æŸ¥çœ‹çº¢é»‘æ ‘å†…å®¹æ—¶éƒ½å¾ˆéš¾ä»¥æ›´ç”ŸåŠ¨å½¢è±¡çš„æ–¹å¼æ¥ç†è§£å…¶å†…å®¹ã€‚æ²¡é”™ï¼Œæœ¬æ–‡å†…å®¹å°±æ˜¯è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç”¨ç®€å•çš„è¯­è¨€ï¼Œæ­é…é™å›¾å’ŒåŠ¨å›¾(åˆ©ç”¨å¤§è„‘å›¾å½¢è®°å¿†æ–¹å¼)ï¼Œè®©ä½ å¯¹çº¢é»‘æ ‘æœ‰æ›´æ·±å…¥çš„äº†è§£å’Œæ›´æ¸…æ™°çš„è®°å¿†ï¼Œå¸Œæœ›å°ä¼™ä¼´ä»¬å†æ¬¡é‡åˆ°çº¢é»‘æ ‘çš„é—®é¢˜ä¸è‡³äºå¤´å¤§ï¼Œå»ºè®®è¯»è¯¥æ–‡ç« å§¿åŠ¿: æ‰“å¼€ä¸¤ä¸ªé¡µé¢ï¼Œä¸€ä¸ªé¡µé¢çœ‹å›¾ç‰‡å’Œå†…å®¹ï¼Œä¸€ä¸ªé¡µé¢çœ‹å…¬å¼ï¼Œåƒç©é­”æ–¹ä¸€æ ·ï¼Œå¤šç©å‡ æ¬¡å°±æ˜ç™½äº† é€šè¿‡å·¥å…· (å…¬ä¼—å·å›å¤ã€Œå·¥å…·ã€â€”>é‚£äº›å¯ä»¥æé«˜æ•ˆç‡çš„å·¥å…·â€”>çº¢é»‘æ ‘) åŠ¨æ€æ„Ÿå—çº¢é»‘æ ‘çš„è½¬æ¢è¿‡ç¨‹ ä¿ºå®¶å¸ä»¤ä¹°å®Œä¸œè¥¿åï¼Œæˆ‘ä¿©ç»å¸¸ä¼šå‘ç”Ÿè¿™æ ·çš„ä¸€æ®µå¯¹è¯","text":"å†™åœ¨å‰é¢çº¢é»‘æ ‘ï¼Œå¯¹å¾ˆå¤šç«¥é‹æ¥è¯´ï¼Œæ˜¯æ—¢ç†Ÿæ‚‰åˆé™Œç”Ÿã€‚å­¦æ ¡ä¸­å­¦è¿‡ï¼Œåªäº†è§£å¤§æ¦‚ï¼›å·¥ä½œä¸­ä¸æ€ä¹ˆä½¿ç”¨ï¼Œä½†é¢è¯•åˆæ˜¯é‡ç‚¹ã€‚æ¯æ¬¡éœ€è¦æŸ¥çœ‹çº¢é»‘æ ‘å†…å®¹æ—¶éƒ½å¾ˆéš¾ä»¥æ›´ç”ŸåŠ¨å½¢è±¡çš„æ–¹å¼æ¥ç†è§£å…¶å†…å®¹ã€‚æ²¡é”™ï¼Œæœ¬æ–‡å†…å®¹å°±æ˜¯è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç”¨ç®€å•çš„è¯­è¨€ï¼Œæ­é…é™å›¾å’ŒåŠ¨å›¾(åˆ©ç”¨å¤§è„‘å›¾å½¢è®°å¿†æ–¹å¼)ï¼Œè®©ä½ å¯¹çº¢é»‘æ ‘æœ‰æ›´æ·±å…¥çš„äº†è§£å’Œæ›´æ¸…æ™°çš„è®°å¿†ï¼Œå¸Œæœ›å°ä¼™ä¼´ä»¬å†æ¬¡é‡åˆ°çº¢é»‘æ ‘çš„é—®é¢˜ä¸è‡³äºå¤´å¤§ï¼Œå»ºè®®è¯»è¯¥æ–‡ç« å§¿åŠ¿: æ‰“å¼€ä¸¤ä¸ªé¡µé¢ï¼Œä¸€ä¸ªé¡µé¢çœ‹å›¾ç‰‡å’Œå†…å®¹ï¼Œä¸€ä¸ªé¡µé¢çœ‹å…¬å¼ï¼Œåƒç©é­”æ–¹ä¸€æ ·ï¼Œå¤šç©å‡ æ¬¡å°±æ˜ç™½äº† é€šè¿‡å·¥å…· (å…¬ä¼—å·å›å¤ã€Œå·¥å…·ã€â€”&gt;é‚£äº›å¯ä»¥æé«˜æ•ˆç‡çš„å·¥å…·â€”&gt;çº¢é»‘æ ‘) åŠ¨æ€æ„Ÿå—çº¢é»‘æ ‘çš„è½¬æ¢è¿‡ç¨‹ ä¿ºå®¶å¸ä»¤ä¹°å®Œä¸œè¥¿åï¼Œæˆ‘ä¿©ç»å¸¸ä¼šå‘ç”Ÿè¿™æ ·çš„ä¸€æ®µå¯¹è¯:å¸ä»¤:ä½ çŒœæˆ‘ä¹°çš„è¿™ä¸ªå¤šå°‘é’±ï¼Ÿæˆ‘: 1000å¸ä»¤: é«˜äº†æˆ‘: 500å¸ä»¤: ä½äº†:æˆ‘: 750â€¦â€¦ ç›´åˆ°æœ€åçŒœä¸­ è¿™æ ·è¯´å¤§å®¶åº”è¯¥å·²ç»çŒœåˆ°äº†æ˜¯ã€ŒäºŒåˆ†æŸ¥æ‰¾æ³•ã€ï¼Œé€šè¿‡è¿™ä¸ªä¾‹å­æˆ‘æƒ³è¦å¼•å‡ºçš„æ˜¯ æ ‘ï¼Œæ¥çœ‹å›¾ç‰‡ ç¨‹åºä¸­çš„æ ‘å…¶å®æ˜¯æˆ‘ä»¬æ—¥å¸¸çœ‹åˆ°çš„æ ‘çš„å€’å½±ï¼Œæˆ–è€…å‘æŒ¥ä¸€ä¸‹æƒ³è±¡ï¼Œå€’å½±ä¹Ÿå¯ä»¥æ˜¯æ ‘æ ¹ äºŒå‰æŸ¥æ‰¾æ ‘äºŒå‰æŸ¥æ‰¾æ ‘ï¼ŒBinary Search Tree ã€ŒBSTã€ï¼Œè¦æƒ³äº†è§£äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹ä¸‹äºŒå‰æŸ¥æ‰¾æ ‘æœ‰å“ªäº›ç‰¹æ€§å‘¢ï¼Ÿ æŸèŠ‚ç‚¹çš„å·¦å­æ ‘èŠ‚ç‚¹å€¼ä»…åŒ…å«å°äºè¯¥èŠ‚ç‚¹å€¼ æŸèŠ‚ç‚¹çš„å³å­æ ‘èŠ‚ç‚¹å€¼ä»…åŒ…å«å¤§äºè¯¥èŠ‚ç‚¹å€¼ å·¦å³å­æ ‘æ¯ä¸ªä¹Ÿå¿…é¡»æ˜¯äºŒå‰æŸ¥æ‰¾æ ‘çœ‹ä¸ªå›¾å°±è½»æ¾ç†è§£ä¸Šé¢ä¸‰å¥è¯çš„æ„æ€äº†: ä¸Šå›¾ï¼Œç»“åˆäºŒå‰æŸ¥æ‰¾æ ‘çš„ä¸‰æ¡çº¦æŸæ¥çœ‹ï¼Œéå¸¸å¥½ï¼Œæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚å†æ¥çœ‹ä¸€ä¸ªå›¾ï¼Œä¾æ—§ç¬¦åˆä¸Šé¢ä¸‰æ¡çº¦æŸï¼Œæ„Ÿè§‰æœ‰é—®é¢˜å—ï¼Ÿ è¿™æ˜¯ä¸€ä¸ªèµ°è·¯ä¸€ç±³å…­ï¼Œä¸€ç±³å…«çš„æ ‘ è¿™æ˜¯ä¸€ä¸ªç•¸å½¢çš„æ ‘ï¼Œå¤§é£ä¸€æŒ‚å¾ˆå¯èƒ½è¢«æŠ˜æ–­çš„æ ‘ä»ç¨‹åºçš„è§’åº¦æ¥è¯´è¿™ä¸ªæ ‘ä¸å¤Ÿå¹³è¡¡ï¼ŒæŸ¥æ‰¾æ¬¡æ•°æˆ–æ—¶é—´å¤æ‚åº¦ O(h)å¯èƒ½ä¼šéšç€ä¸€æ¡è…¿é•¿æ— é™å¢é•¿ ç†ç§‘ç”Ÿåœ¨é«˜ä¸­å­¦ä¹ ç”Ÿç‰©æ—¶å­¦è¿‡ä¸€ä¸ªå…³é”®å­—ã€Œå»é™¤é¡¶ç«¯ä¼˜åŠ¿ã€ï¼Œé€šè¿‡å»é™¤æ¤ç‰©é¡¶ç«¯ä¼˜åŠ¿ï¼Œä¾§èŠ½ä¼šè¿…é€Ÿç”Ÿé•¿ï¼Œæ…¢æ…¢å˜å¾—å¼ºå£®å’Œå¹³è¡¡ï¼Œ çº¢é»‘æ ‘å…¶å®å°±æ˜¯å»é™¤äºŒå‰æŸ¥æ‰¾æ ‘é¡¶ç«¯ä¼˜åŠ¿çš„è§£å†³æ–¹æ¡ˆï¼Œä»è€Œè¾¾åˆ°æ ‘çš„å¹³è¡¡ çº¢é»‘æ ‘çº¢é»‘æ ‘ï¼ŒRed-Black Tree ã€ŒRBTã€æ˜¯ä¸€ä¸ªè‡ªå¹³è¡¡(ä¸æ˜¯ç»å¯¹çš„å¹³è¡¡)çš„äºŒå‰æŸ¥æ‰¾æ ‘(BST)ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½éµå¾ªä¸‹é¢çš„è§„åˆ™: æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰çº¢è‰²æˆ–é»‘è‰² æ ‘çš„æ ¹å§‹ç»ˆæ˜¯é»‘è‰²çš„ (é»‘åœŸåœ°å­•è‚²é»‘æ ‘æ ¹ï¼ŒğŸ˜„) æ²¡æœ‰ä¸¤ä¸ªç›¸é‚»çš„çº¢è‰²èŠ‚ç‚¹ï¼ˆçº¢è‰²èŠ‚ç‚¹ä¸èƒ½æœ‰çº¢è‰²çˆ¶èŠ‚ç‚¹æˆ–çº¢è‰²å­èŠ‚ç‚¹ï¼Œå¹¶æ²¡æœ‰è¯´ä¸èƒ½å‡ºç°è¿ç»­çš„é»‘è‰²èŠ‚ç‚¹ï¼‰ ä»èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬æ ¹ï¼‰åˆ°å…¶ä»»ä½•åä»£NULLèŠ‚ç‚¹(å¶å­ç»“ç‚¹ä¸‹æ–¹æŒ‚çš„ä¸¤ä¸ªç©ºèŠ‚ç‚¹ï¼Œå¹¶ä¸”è®¤ä¸ºä»–ä»¬æ˜¯é»‘è‰²çš„)çš„æ¯æ¡è·¯å¾„éƒ½å…·æœ‰ç›¸åŒæ•°é‡çš„é»‘è‰²èŠ‚ç‚¹ ç¬é—´æ‡µé€¼ï¼Ÿäº†è§£ä¸€ä¸‹å°è±¡å°±è¡Œï¼Œå¼€å§‹ç©é­”æ–¹éƒ½æ˜¯è¦ç…§ç€é­”æ–¹å…¬å¼ä¸€ç‚¹ç‚¹ç©çš„ï¼Œå¤šç©å‡ æ¬¡å°±ç†Ÿæ‚‰äº†ã€‚çº¢é»‘æ ‘ä¹Ÿä¸€æ ·ï¼Œçº¢é»‘æ ‘æœ‰ä¸¤å¤§æ“ä½œ: recolor (é‡æ–°æ ‡è®°é»‘è‰²æˆ–çº¢è‰²) rotation (æ—‹è½¬ï¼Œè¿™æ˜¯æ ‘è¾¾åˆ°å¹³è¡¡çš„å…³é”®)æˆ‘ä»¬ä¼šå…ˆå°è¯• recolorï¼Œå¦‚æœ recolor ä¸èƒ½è¾¾åˆ°çº¢é»‘æ ‘çš„ 4 ç‚¹è¦æ±‚ï¼Œç„¶åæˆ‘ä»¬å°è¯• rotationï¼Œå…¶å®çº¢é»‘æ ‘çš„å…³é”®ç©æ³•å°±æ˜¯å¼„æ¸…æ¥š recolor å’Œ rotation çš„è§„åˆ™ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹è¯¦ç»†çš„ç®—æ³•å…¬å¼å§ åƒä¸‡åˆ«ç€æ€¥è®°å¿†å…¬å¼ï¼Œæœ‰å›¾ç¤ºä¼šé€æ­¥è¯´æ˜ï¼Œå°±åƒé­”æ–¹ä¸€æ ·ï¼Œå¤šç©å‡ æ¬¡å°±æ‡‚äº†:å‡è®¾æˆ‘ä»¬æ’å…¥çš„æ–°èŠ‚ç‚¹ä¸º X å°†æ–°æ’å…¥çš„èŠ‚ç‚¹æ ‡è®°ä¸ºçº¢è‰² å¦‚æœ X æ˜¯æ ¹ç»“ç‚¹(root)ï¼Œåˆ™æ ‡è®°ä¸ºé»‘è‰² å¦‚æœ X çš„ parent ä¸æ˜¯é»‘è‰²ï¼ŒåŒæ—¶ X ä¹Ÿä¸æ˜¯ root: 3.1 å¦‚æœ X çš„ uncle (å”å”) æ˜¯çº¢è‰² 3.1.1 å°† parent å’Œ uncle æ ‡è®°ä¸ºé»‘è‰² 3.1.2 å°† grand parent (ç¥–çˆ¶) æ ‡è®°ä¸ºçº¢è‰² 3.1.3 è®© X èŠ‚ç‚¹çš„é¢œè‰²ä¸ X ç¥–çˆ¶çš„é¢œè‰²ç›¸åŒï¼Œç„¶åé‡å¤æ­¥éª¤ 2ã€3 è¯ä¸å¤šè¯´ï¼Œçœ‹ä¸‹å›¾ è·Ÿç€ä¸Šé¢çš„å…¬å¼èµ°: å°†æ–°æ’å…¥çš„ X èŠ‚ç‚¹æ ‡è®°ä¸ºçº¢è‰² å‘ç° X çš„ parent (P) åŒæ ·ä¸ºçº¢è‰²ï¼Œè¿™è¿åäº†çº¢é»‘æ ‘çš„ç¬¬ä¸‰æ¡è§„åˆ™ã€Œä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­ç›¸é‚»çš„çº¢è‰²èŠ‚ç‚¹ã€ å‘ç° X çš„ uncle (U) åŒæ ·ä¸ºçº¢è‰² å°† P å’Œ U æ ‡è®°ä¸ºé»‘è‰² å°† X å’Œ X çš„ grand parent (G) æ ‡è®°ä¸ºç›¸åŒçš„é¢œè‰²ï¼Œå³çº¢è‰²ï¼Œç»§ç»­é‡å¤å…¬å¼ 2ã€3 å‘ç° G æ˜¯æ ¹ç»“ç‚¹ï¼Œæ ‡è®°ä¸ºé»‘è‰² ç»“æŸ åˆšåˆšè¯´äº† X çš„ uncle æ˜¯çº¢è‰²çš„æƒ…å†µï¼Œæ¥ä¸‹æ¥è¦è¯´æ˜¯é»‘è‰²çš„æƒ…å†µ å¦‚æœ X çš„ parent ä¸æ˜¯é»‘è‰²ï¼ŒåŒæ—¶ X ä¹Ÿä¸æ˜¯ root: 3.2 å¦‚æœ X çš„ uncle (å”å”) æ˜¯é»‘è‰²ï¼Œæˆ‘ä»¬è¦åˆ†å››ç§æƒ…å†µå¤„ç† 3.2.1 å·¦å·¦ (P æ˜¯ G çš„å·¦å­©å­ï¼Œå¹¶ä¸” X æ˜¯ P çš„å·¦å­©å­) 3.2.2 å·¦å³ (P æ˜¯ G çš„å·¦å­©å­ï¼Œå¹¶ä¸” X æ˜¯ P çš„å³å­©å­) 3.2.3 å³å³ (å’Œ 3.2.1 é•œåƒè¿‡æ¥ï¼Œæ°å¥½ç›¸å) 3.2.4 å³å·¦ (å’Œ 3.2.2 é•œåƒè¿‡æ¥ï¼Œæ°å¥½ç›¸å)å½“å‡ºç° uncle æ˜¯é»‘è‰²çš„æ—¶å€™æˆ‘ä»¬ç¬¬ä¸€æ­¥è¦è€ƒè™‘çš„æ˜¯ æ—‹è½¬ ï¼Œè¿™é‡Œå…ˆè¯·å°ä¼™ä¼´ä¸è¦å…³æ³¨çº¢é»‘æ ‘çš„ç¬¬ 4 æ¡è§„åˆ™ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºå¦‚ä½•æ—‹è½¬çš„ï¼Œæ¥ä¸€ç‚¹ç‚¹çœ‹ï¼Œä¸è¦çœ‹å›¾å°±æ…Œï¼Œæœ‰è§£é‡Šçš„ğŸ˜œ:å·¦å·¦æƒ…å†µè¿™ç§æƒ…å†µå¾ˆç®€å•ï¼Œæƒ³è±¡è¿™æ˜¯ä¸€æ ¹ç»³å­ï¼Œæ‰‹æèµ· P èŠ‚ç‚¹ï¼Œç„¶åå˜è‰²å³å¯ å·¦å³å·¦æ—‹: ä½¿ X çš„çˆ¶èŠ‚ç‚¹ P è¢« X å–ä»£ï¼ŒåŒæ—¶çˆ¶èŠ‚ç‚¹ P æˆä¸º X çš„å·¦å­©å­ï¼Œç„¶åå†åº”ç”¨ å·¦å·¦æƒ…å†µ å³å³ä¸å·¦å·¦æƒ…å†µä¸€æ ·ï¼Œæƒ³è±¡æˆä¸€æ ¹ç»³å­ å³å·¦å³æ—‹: ä½¿ X çš„çˆ¶èŠ‚ç‚¹ P è¢« X å–ä»£ï¼ŒåŒæ—¶çˆ¶èŠ‚ç‚¹ P æˆä¸º X çš„å³å­©å­ï¼Œç„¶åå†åº”ç”¨ å³å³æƒ…å†µ ä½ è¯´çš„åŠ¨å›¾åœ¨å“ªé‡Œï¼Œä½ ä¸ªå¤§éª—å­ï¼Œåˆ«ç€æ€¥ï¼Œç°åœ¨å°±ä¸ºå°ä¼™ä¼´ä»¬å¥‰ä¸ŠåŠ¨å›¾æ¼”ç¤ºï¼Œæ¥è¯´æ˜å…¬å¼çš„ä½¿ç”¨: æ¡ˆä¾‹ä¸€ æ’å…¥ 10ï¼Œ20ï¼Œ30ï¼Œ15 åˆ°ä¸€ä¸ªç©ºæ ‘ä¸­ å‘ç©ºæ ‘ä¸­ç¬¬ä¸€æ¬¡æ’å…¥æ•°å­— 10ï¼Œè‚¯å®šæ˜¯ root èŠ‚ç‚¹ root èŠ‚ç‚¹æ ‡è®°æˆé»‘è‰² å‘æ ‘ä¸­æ’å…¥æ–°èŠ‚ç‚¹ 20ï¼Œæ ‡è®°ä¸ºçº¢è‰² 20 &gt; 10ï¼Œå¹¶å‘ç° 10 æ²¡æœ‰å¶å­èŠ‚ç‚¹ï¼Œå°†æ–°èŠ‚ç‚¹ 20 ä½œä¸º 10 çš„å³å­©å­ å‘æ ‘ä¸­æ’å…¥æ–°èŠ‚ç‚¹ 30ï¼Œæ ‡è®°ä¸ºçº¢è‰² 30 &gt; 10ï¼ŒæŸ¥æ‰¾ 10 çš„å³å­æ ‘ï¼Œæ‰¾åˆ° 20 30 &gt; 20ï¼Œç»§ç»­æŸ¥æ‰¾ 20 çš„å³å­æ ‘ï¼Œå‘ç° 20 æ²¡æœ‰å¶å­èŠ‚ç‚¹ï¼Œå°†å€¼æ’åœ¨æ­¤å¤„ 30 å’Œ 20 èŠ‚ç‚¹éƒ½ä¸ºçº¢è‰²ï¼Œ30 ä¸ºå³å­©å­ï¼Œ20 ä¹Ÿä¸ºå³å­©å­ï¼Œè§¦å‘äº† å³å³æƒ…å†µ é€šè¿‡ä¸€æ¬¡æ—‹è½¬ï¼Œæèµ· 20 èŠ‚ç‚¹ 20 èŠ‚ç‚¹æ˜¯æ ¹ç»“ç‚¹ï¼Œæ ‡è®°ä¸ºé»‘è‰² å‘æ ‘ä¸­æ’å…¥æ–°èŠ‚ç‚¹ 15ï¼Œæ ‡è®°ä¸ºçº¢è‰² é€šè¿‡æ¯”å¯¹å¤§å°å’Œåˆ¤æ–­æ˜¯å¦æœ‰å¶å­èŠ‚ç‚¹ï¼Œæœ€ç»ˆæ’å€¼ä¸º 10 èŠ‚ç‚¹çš„å³å­©å­ 15 å’Œ 10 èŠ‚ç‚¹éƒ½ä¸ºçº¢è‰²ï¼Œ15 çš„ uncle èŠ‚ç‚¹ 30 ä¹Ÿä¸ºçº¢è‰² æŒ‰ç…§å…¬å¼ï¼Œå°† 15 çš„ parent 10 å’Œ uncle 30 æ›´æ”¹ä¸ºé»‘è‰² è®© 15 èŠ‚ç‚¹ grand parent 20 çš„é¢œè‰²ä¸ 15 èŠ‚ç‚¹çš„é¢œè‰²ä¸€æ ·ï¼Œå˜ä¸ºçº¢è‰² 20 ä¸ºæ ¹ç»“ç‚¹ï¼Œå°†å…¶æ”¹ä¸ºé»‘è‰² ç»§ç»­æ’å…¥å…¶ä»–èŠ‚ç‚¹åªä¸è¿‡åå¤åº”ç”¨ä¸Šé¢çš„å…¬å¼ï¼Œä¸Šé¢åº”ç”¨åˆ°çš„çº¢é»‘æ ‘å·¥å…·ï¼Œå¯ä»¥æš‚åœåŠ¨ç”»æ•ˆæœï¼Œä¸€å¸§ä¸€å¸§çš„çœ‹çº¢é»‘æ ‘çš„è½¬æ¢è¿‡ç¨‹ï¼Œè¿™æ ·é€šè¿‡ç»ƒä¹ ï¼ŒæŸ¥çœ‹å…¬å¼ï¼Œè§‚å¯Ÿå˜åŒ–ä¸‰ç®¡é½ä¸‹ï¼Œçº¢é»‘æ ‘çš„å…¥é—¨ç†è§£åº”è¯¥å®Œå…¨ä¸å†æ˜¯é—®é¢˜äº† çµé­‚è¿½é—® jdk 1.8 HashMap ä¸­æœ‰ä½¿ç”¨åˆ°çº¢é»‘æ ‘ï¼Œä½ çŸ¥é“è§¦å‘æ¡ä»¶æ˜¯ä»€ä¹ˆå—ï¼Ÿæœ‰è¯»è¿‡æºç æ˜¯å¦‚ä½• put å’Œ remove çš„å—ï¼Ÿ è¿™é‡Œè®²çš„æ˜¯çº¢é»‘æ ‘çš„ insertï¼Œdelete åˆæ˜¯ä»€ä¹ˆè§„åˆ™å‘¢ï¼Ÿ å“ªäº›åœºæ™¯å¯ä»¥åº”ç”¨çº¢é»‘æ ‘ï¼Ÿ ä½ äº†è§£å„ç§æ ‘çš„æ—¶é—´å¤æ‚åº¦å—ï¼Ÿ ç•™ä¸ªå°ä½œä¸šï¼Œåº”ç”¨å·¥å…·å°† [10 70 32 34 13 56 32 56 21 3 62 4 ] é€ä¸ªæ’å…¥åˆ°æ ‘ä¸­ï¼Œç†è§£çº¢é»‘æ ‘ recolor å’Œ rotation çš„è½¬æ¢è§„åˆ™ æé«˜æ•ˆç‡å·¥å…· æ¨èé˜…è¯» åªä¼šç”¨ git pull ï¼Ÿæœ‰æ—¶å€™ä½ å¯ä»¥å°è¯•æ›´ä¼˜é›…çš„å¤„ç†æ–¹å¼ åŒäº²å§”æ´¾æ¨¡å‹ï¼šå¤§å‚é«˜é¢‘é¢è¯•é¢˜ï¼Œè½»æ¾æå®š é¢è¯•è¿˜ä¸çŸ¥é“BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«ï¼Ÿ å¦‚ä½•è®¾è®¡å¥½çš„RESTful API ç¨‹åºçŒ¿ä¸ºä»€ä¹ˆè¦çœ‹æºç ï¼Ÿ æ¬¢è¿æŒç»­å…³æ³¨å…¬ä¼—å·ï¼šã€Œæ—¥æ‹±ä¸€å…µã€ å‰æ²¿ Java æŠ€æœ¯å¹²è´§åˆ†äº« [orange] é«˜æ•ˆå·¥å…·æ±‡æ€» [green] é¢è¯•é—®é¢˜åˆ†æä¸è§£ç­” [pink] æŠ€æœ¯èµ„æ–™é¢†å– [red] åç»­æ–‡ç« ä¼šä¸ºä½ è®²è§£å„ç§æ—¶é—´ç©ºé—´å¤æ‚åº¦ï¼Œä»¥åŠå¤šçº¿ç¨‹ï¼ŒElasticSearch ç­‰é—®é¢˜ ä»¥è¯»ä¾¦æ¢å°è¯´æ€ç»´è½»æ¾è¶£å‘³å­¦ä¹  Java æŠ€æœ¯æ ˆç›¸å…³çŸ¥è¯†ï¼Œæœ¬ç€å°†å¤æ‚é—®é¢˜ç®€å•åŒ–ï¼ŒæŠ½è±¡é—®é¢˜å…·ä½“åŒ–å’Œå›¾å½¢åŒ–åŸåˆ™é€æ­¥åˆ†è§£æŠ€æœ¯é—®é¢˜ï¼ŒæŠ€æœ¯æŒç»­æ›´æ–°ï¼Œè¯·æŒç»­å…³æ³¨â€¦â€¦","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"çº¢é»‘æ ‘","slug":"çº¢é»‘æ ‘","permalink":"https://dayarch.top/tags/%E7%BA%A2%E9%BB%91%E6%A0%91/"},{"name":"äºŒå‰æŸ¥æ‰¾æ ‘","slug":"äºŒå‰æŸ¥æ‰¾æ ‘","permalink":"https://dayarch.top/tags/%E4%BA%8C%E5%8F%89%E6%9F%A5%E6%89%BE%E6%A0%91/"}]},{"title":"å¦‚ä½•è®¾è®¡å¥½çš„Restful API","slug":"å¦‚ä½•è®¾è®¡å¥½çš„Restful-API","date":"2019-05-16T06:48:27.000Z","updated":"2019-11-07T06:37:47.212Z","comments":true,"path":"/p/restful-api-design.html","link":"","permalink":"https://dayarch.top/p/restful-api-design.html","excerpt":"ç°çŠ¶ ç°é˜¶æ®µçš„å¼€å‘æ¨¡å¼å¤šä»¥å‰åç«¯åˆ†ç¦»å½¢å¼å­˜åœ¨ï¼Œå‰åç«¯å¼€å‘äººå‘˜éœ€è¦é€šè¿‡å¤§é‡ API æ¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œå¦‚æœåœ¨äº¤äº’è¿‡ç¨‹ä¸­å‰åç«¯äººå‘˜ç»å¸¸é­é‡å¦‚ä¸‹é—®é¢˜ï¼š * å‰ç«¯äººå‘˜ä¸èƒ½å¿«é€Ÿç†è§£æ¥å£å­—æ®µå«ä¹‰åŠæ¥å£å­—æ®µå˜åŒ– * åç«¯äººå‘˜æƒ³å¤ç”¨æŸäº›æ¥å£ï¼Œä½†æ˜¯ä¸èƒ½å¿«é€Ÿä»æ¥å£ URL çš„å®šä¹‰ä¸­æ˜ç¡®è¯¥æ¥å£çš„å«ä¹‰ï¼Œéœ€è¦è¿›ä¸€æ­¥è¯»ä»£ç ç¡®è®¤ * URLä¸­çš„è‹±æ–‡å•è¯ä½¿ç”¨äº”èŠ±å…«é—¨ï¼Œæœç´¢æŸä¸ªæ¥å£ä¸çŸ¥é“å…·ä½“çš„å…³é”®å­— * è¯·æ±‚æ–¹æ³•åŠ¨è¯å¦‚ POST GET éšæ„ä½¿ç”¨ * å®Œæˆå½“å‰ä¸šåŠ¡æ¥å£å¯¹æ¥ï¼Œå‰ç«¯äººå‘˜ç»å¸¸ä¼šè¯¢é—®ä¸‹ä¸€æ­¥ä¸šåŠ¡æµç¨‹çš„æ¥å£å®šä¹‰åœ¨å“ªé‡Œï¼Œå¯¹æ¥å½¢å¼æ˜¯ä»€ä¹ˆæ ·çš„ ä»¥ä¸Šåªæ˜¯å‰åç«¯äººå‘˜é€šè¿‡æ¥å£äº¤äº’çš„ä¸€å°éƒ¨åˆ†é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å°±å¥½æ¯”â€ç‰™ç—›â€ï¼Œä¸è‡´","text":"ç°çŠ¶ç°é˜¶æ®µçš„å¼€å‘æ¨¡å¼å¤šä»¥å‰åç«¯åˆ†ç¦»å½¢å¼å­˜åœ¨ï¼Œå‰åç«¯å¼€å‘äººå‘˜éœ€è¦é€šè¿‡å¤§é‡ API æ¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œå¦‚æœåœ¨äº¤äº’è¿‡ç¨‹ä¸­å‰åç«¯äººå‘˜ç»å¸¸é­é‡å¦‚ä¸‹é—®é¢˜ï¼š å‰ç«¯äººå‘˜ä¸èƒ½å¿«é€Ÿç†è§£æ¥å£å­—æ®µå«ä¹‰åŠæ¥å£å­—æ®µå˜åŒ– åç«¯äººå‘˜æƒ³å¤ç”¨æŸäº›æ¥å£ï¼Œä½†æ˜¯ä¸èƒ½å¿«é€Ÿä»æ¥å£ URL çš„å®šä¹‰ä¸­æ˜ç¡®è¯¥æ¥å£çš„å«ä¹‰ï¼Œéœ€è¦è¿›ä¸€æ­¥è¯»ä»£ç ç¡®è®¤ URLä¸­çš„è‹±æ–‡å•è¯ä½¿ç”¨äº”èŠ±å…«é—¨ï¼Œæœç´¢æŸä¸ªæ¥å£ä¸çŸ¥é“å…·ä½“çš„å…³é”®å­— è¯·æ±‚æ–¹æ³•åŠ¨è¯å¦‚ POST GET éšæ„ä½¿ç”¨ å®Œæˆå½“å‰ä¸šåŠ¡æ¥å£å¯¹æ¥ï¼Œå‰ç«¯äººå‘˜ç»å¸¸ä¼šè¯¢é—®ä¸‹ä¸€æ­¥ä¸šåŠ¡æµç¨‹çš„æ¥å£å®šä¹‰åœ¨å“ªé‡Œï¼Œå¯¹æ¥å½¢å¼æ˜¯ä»€ä¹ˆæ ·çš„ ä»¥ä¸Šåªæ˜¯å‰åç«¯äººå‘˜é€šè¿‡æ¥å£äº¤äº’çš„ä¸€å°éƒ¨åˆ†é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å°±å¥½æ¯”â€ç‰™ç—›â€ï¼Œä¸è‡´å‘½ï¼Œä½†æ˜¯åœ¨æ•´ä¸ªè½¯ä»¶å¼€å‘çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå¤©å¤©â€ç‰™ç—›â€æ˜¯å¾ˆè¦å‘½çš„, éœ€è¦è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼Œéœ€è¦å‰åç«¯äººå‘˜éƒ½èƒ½è®¤è¯†ä¸äº†è§£æ¥å£è®¾è®¡è§„èŒƒçš„é‡è¦æ€§ã€‚ ä»€ä¹ˆæ˜¯RESTåœ¨ 2000 å¹´ï¼ŒRoy Fielding æå‡º Representational State Transfer (REST) çš„æ¦‚å¿µï¼Œä¸­æ–‡ç¿»è¯‘è¿‡æ¥â€è¡¨è¿°æ€§çŠ¶æ€ä¼ é€’â€ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å»ç»´åŸºç™¾ç§‘çœ‹çœ‹åŸå§‹æ¦‚å¿µï¼Œä¹ä¸€çœ‹æ˜¯ä¸€ä¸ªæŒºæŠ½è±¡çš„æ¦‚å¿µï¼Œä½†å…¶å®ï¼Œè¿™ä¸ªæ¦‚å¿µå°±åƒäº¤é€šç¯è§„åˆ™ä¸€æ ·ç®€å•ï¼Œå°±çœ‹å¦‚ä½•çœ‹å¾…ç›¸å…³è§„èŒƒ. å½“æˆ‘ä»¬è°ˆåŠ RESTful è®¾è®¡è§„èŒƒï¼Œå¤šæ•°äººèƒ½äº†è§£è®¾è®¡çš„å¤§åŸåˆ™ï¼Œä½†æ˜¯ä¸äº†è§£å°ç»†èŠ‚ï¼Œè€Œå¯¹è¿™äº›ç»†èŠ‚çš„äº†è§£ä¸å¦ï¼Œæ˜¯èƒ½å¦æ²»å¥½â€ç‰™ç—›ç—…â€çš„å…³é”® RESTæœ¯è¯­ä»‹ç»ç°å®ä¸–ç•Œäº¤é€šç¯æœ‰çº¢ç»¿é»„ï¼ŒRESTç›¸å…³çš„æ¦‚å¿µä¹Ÿæ˜¯ä¸‰ä¸ªï¼šèµ„æºï¼Œé›†åˆï¼ŒURL èµ„æºèµ„æºæ˜¯æŸç§ä¸œè¥¿çš„å¯¹è±¡æˆ–è¡¨ç¤ºï¼Œå®ƒå…·æœ‰ä¸€äº›ä¸ä¹‹ç›¸å…³çš„æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥æœ‰ä¸€ç»„æ–¹æ³•å¯¹å…¶è¿›è¡Œæ“ä½œã€‚ ä¾‹å¦‚, åŠ¨ç‰©ï¼Œå­¦æ ¡å’Œå‘˜å·¥æ˜¯èµ„æº; åˆ é™¤ï¼Œæ·»åŠ ï¼Œæ›´æ–°æ˜¯å¯¹è¿™äº›èµ„æºæ‰§è¡Œçš„ç›¸å…³æ“ä½œ é›†åˆé›†åˆæ˜¯èµ„æºé›†åˆï¼Œä¾‹å¦‚ï¼Œå…¬å¸æ˜¯å…¬å¸èµ„æºçš„é›†åˆ URLURLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰æ˜¯å¯ä»¥é€šè¿‡å…¶å®šä½èµ„æºçš„è·¯å¾„ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å…¶æ‰§è¡ŒæŸäº›æ“ä½œ äº†è§£åˆ°ä»¥ä¸Šå†…å®¹ï¼Œ é‚£REST ä¸–ç•Œçš„â€äº¤é€šç¯â€è§„åˆ™æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ å¦‚ä½•è®¾è®¡å’Œå¼€å‘ä¸€ä¸ªé«˜å¯ç”¨çš„ REST APIs ç½‘ä¸Šä¸€ç›´æœ‰å…³äºâ€æœ€å¥½çš„Restful APIçš„è®¾è®¡â€äº‰è®ºï¼Œä½•ä¸ºæœ€å¥½ï¼Œè‡³ä»Šæ²¡æœ‰ä¸€ä¸ªå®˜æ–¹çš„æŒ‡å¯¼ã€‚æœ¬æ–‡æ€»ç»“ RESTful çš„è®¾è®¡ç»†èŠ‚ï¼Œä»‹ç»å¦‚ä½•è®¾è®¡å‡ºæ˜“äºç†è§£å’Œä½¿ç”¨çš„ APIã€‚åœ¨ Restful API è®¾è®¡æ ‡å‡†ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæˆ‘ä»¬çš„è®¾è®¡å¢åŠ ä¸€äº›å¼¹æ€§ï¼ˆå›¢é˜Ÿéƒ½è®¤å¯çš„æ–¹å¼ï¼‰ï¼Œæ¯ä¸ªé¡¹ç›®çš„æƒ…å†µä¸åŒï¼Œæœ€é‡è¦çš„æ˜¯é¡¹ç›®ç»„æˆå‘˜è¾¾æˆä¸€è‡´çš„Restful API è®¾è®¡è§„åˆ™ï¼Œè¾¾åˆ°é«˜å¯ç”¨å³å¯ URL è®¾è®¡å­¦è‹±è¯­ï¼Œåè¯ï¼ˆcar/animal/teacherï¼‰éƒ½å¾ˆå¥½è®°å¿†ï¼Œä½†æ˜¯å¦‚ä½•ç”¨åŠ¨è¯å’Œè¿™äº›åè¯ç»„åˆæ¥å‡†ç¡®çš„è¡¨è¾¾ç‰¹å®šçš„å«ä¹‰å´å¾ˆå›°éš¾ï¼Œåº†å¹¸çš„æ˜¯åœ¨ REST çš„ä¸–ç•Œï¼ŒåŠ¨è¯å¯¥å¯¥æ— å‡ ï¼Œå¹¶ä¸”å«ä¹‰å•ä¸€ ï¼ŒRESTful çš„æ ¸å¿ƒæ€æƒ³ä¹Ÿæ˜¯é€šè¿‡è¿™äº›åŠ¨è¯ + åè¯å®Œæˆå¯¹èµ„æºçš„æ“ä½œä¸è®¿é—®ï¼Œä½†æˆ‘ä»¬ç»å¸¸çœ‹åˆ°è¿™æ ·çš„åŠ¨è¯ä¸åè¯çš„ URL ç»„åˆï¼š /getAllUsers /createNewCompany /updateUserInfo /deleteUser?name=zhangsan è¿™äº› URL çš„è®¾è®¡ä¼šå¯¼è‡´æ–‡ç« å¼€å¤´æ‰€è¯´çš„å¾ˆå¤šé—®é¢˜ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥æ¥äº†è§£å¦‚ä½•åº”ç”¨æ‰€è°“çš„åŠ¨è¯ + åè¯ åŠ¨è¯åŠ¨è¯é€šå¸¸å°±æ˜¯ 5 ç§ HTTP æ–¹æ³•ï¼Œå¯¹åº”æˆ‘ä»¬å¸¸è§çš„ CRUD æ“ä½œï¼š POSTï¼šæ–°å»ºï¼ˆCreateï¼‰ GETï¼šè¯»å–ï¼ˆReadï¼‰ PUTï¼šæ›´æ–°ï¼ˆUpdateï¼‰ PATCHï¼šæ›´æ–°ï¼ˆUpdateï¼‰ï¼Œé€šå¸¸ä¸åˆ†æ›´æ–°ï¼Œä¹Ÿå¾ˆå°‘ç”¨åˆ° DELETEï¼šåˆ é™¤ï¼ˆDeleteï¼‰ æ ¹æ® HTTP è§„èŒƒï¼ŒåŠ¨è¯ä¸€å¾‹å¤§å†™ï¼Œå¦å¤–æ ¹æ®RESTful å¹‚ç­‰æ€§ï¼ˆå¤šæ¬¡è°ƒç”¨æ˜¯å¦ä¼šå¯¹èµ„æºäº§ç”Ÿå½±å“ï¼‰åŸåˆ™ï¼Œæˆ‘ä»¬ä¸èƒ½ä¹±ç”¨åŠ¨è¯ï¼ŒGET/PUT/DELETE æ˜¯å¹‚ç­‰çš„ï¼ŒPOST/PATCH ä¸æ˜¯å¹‚ç­‰çš„ æœ‰äº›å®¢æˆ·ç«¯åªèƒ½ä½¿ç”¨GETå’ŒPOSTè¿™ä¸¤ç§æ–¹æ³•ã€‚æœåŠ¡å™¨å¿…é¡»æ¥å—POSTæ¨¡æ‹Ÿå…¶ä»–ä¸‰ä¸ªæ–¹æ³•ï¼ˆPUTã€PATCHã€DELETEï¼‰ã€‚ è¿™æ—¶ï¼Œå®¢æˆ·ç«¯å‘å‡ºçš„ HTTP è¯·æ±‚ï¼Œè¦åŠ ä¸ŠX-HTTP-Method-Overrideå±æ€§ï¼Œå‘Šè¯‰æœåŠ¡å™¨åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªåŠ¨è¯ï¼Œè¦†ç›–POSTæ–¹æ³•ã€‚ 12POST /users/12 HTTP/1.1X-HTTP-Method-Override: PUT ä¸Šé¢ä»£ç ä¸­ï¼ŒX-HTTP-Method-OverrideæŒ‡å®šæœ¬æ¬¡è¯·æ±‚çš„æ–¹æ³•æ˜¯PUTï¼Œè€Œä¸æ˜¯POST åè¯åè¯å°±æ˜¯è¡¨ç¤ºä¸€ä¸ªèµ„æºæˆ–è€…æœåŠ¡ï¼Œå¦‚ /usersï¼Œ/teachersï¼Œè¿™é‡Œçœ‹åˆ°æˆ‘ç”¨åè¯å¤æ•°çš„å½¢å¼æè¿°æŸä¸€èµ„æºï¼Œè‡³äºç”¨å•æ•°è¿˜æ˜¯å¤æ•°æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„è§è§£ï¼Œæˆ‘åœ¨è¿™é‡Œæ¨èä½¿ç”¨å¤æ•°ï¼Œå› ä¸ºåœ¨ç°å®ä¸–ç•Œä¸­ï¼Œèµ„æºå¤šæ•°æ˜¯ä»¥é›†åˆçš„å½¢å¼å­˜åœ¨çš„ åŠ¨è¯ + åè¯ èµ„æº POSTï¼ˆCreateï¼‰ GETï¼ˆReadï¼‰ PUTï¼ˆUpdateï¼‰ DELETE ï¼ˆDeleteï¼‰ /users åˆ›å»ºæ–°ç”¨æˆ· æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· æ‰¹é‡æ›´æ–°ç”¨æˆ· åˆ é™¤æ‰€æœ‰ç”¨æˆ· /users/12 æ–¹æ³•ä¸è¢«å…è®¸ï¼ˆ405ï¼‰ æŸ¥è¯¢æŒ‡å®šç”¨æˆ· æ›´æ–°æŒ‡å®šç”¨æˆ· åˆ é™¤æŒ‡å®šç”¨æˆ· 1234567POST /usersGET /usersPUT /usersDELETE /usersGET /users/12PUT /users/12DELETE /users/12 ä¸Šè¿°åŠ¨è¯ + åè¯çš„ç»„åˆæ˜¯ä¸æ˜¯æ¸…æ™°å¤šäº†ï¼Œæ²¡æœ‰æ‚ä¹±çš„åŠ¨è¯åœ¨ URL ä¸­ï¼Œå¤§å®¶çš„ç†è§£å«ä¹‰ç›¸åŒ URL å±‚çº§ç°å®ä¸­å“ªæœ‰è¿™ä¹ˆç®€å•çš„ CRUDï¼Œèµ„æºçš„ç›¸äº’å…³è”ä¸åµŒå¥—å¾ˆå¸¸è§ï¼ŒæŸ¥æ‰¾ id æ˜¯ 12 çš„ç”¨æˆ·çš„æ‰€æœ‰å¸–å­ï¼Œ å¦‚ä½•è®¾è®¡è¿™ä¸ª URLï¼Œä¸‹é¢ä¸¤ç§è®¾è®¡ä¹Ÿä¼šæœ‰äº‰è®ºï¼š 12GET /users/12/postsGET /posts?userId=12 ç¬¬ä¸€ç§å‡ºç°ä¸¤ä¸ªåè¯ä¸»é¢˜ï¼ˆusers/postsï¼‰ï¼Œä¼šè®©äººæœ‰å‡ ç§’é’Ÿçš„çŒœæƒ³ï¼Œè¿™åˆ°åº•è¯·æ±‚çš„æ˜¯ç”¨æˆ·èµ„æºè¿˜æ˜¯å¸–å­èµ„æºï¼Œå½“å­˜åœ¨æ›´æ·±æµ…å¥—çš„æ—¶å€™ä¹Ÿä¸å®¹æ˜“æ‰©å±•ï¼Œæ‰€ä»¥æˆ‘æ¨èç¬¬äºŒç§æ–¹å¼ï¼Œä¸»ä½“åè¯ posts èµ„æºæ˜æ˜¾ï¼Œå…¶ä»–è¿‡æ»¤æ¡ä»¶ä¹Ÿæ›´å®¹æ˜“æ‰©å±•ï¼Œæ¯”å¦‚ /posts?userName=zhangsanï¼Œæˆ‘ä»¬å¯ä»¥å¤ç”¨åŒæ ·çš„æ¥å£ ç‰ˆæœ¬æˆ‘ä»¬çœ‹åˆ°è¿‡å¾ˆå¤šå¦‚ä¸‹ URL è®¾è®¡ï¼Œç”¨æ¥åŒºåˆ† API ç‰ˆæœ¬ï¼š 12POST /v2/usersGET /V1/users/12 æˆ‘ä»¬éƒ½æŒ‡å‘åŒæ ·çš„èµ„æº usersï¼ŒURL ä¸­ä¸ºä»€ä¹ˆè¦åŠ ç‰ˆæœ¬å·å‘¢ï¼Ÿ é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œç­”æ¡ˆä¾æ—§æ²¡æœ‰ç»Ÿä¸€æ ‡å‡†ï¼Œå¦‚æœå¤šä¸ªç‰ˆæœ¬çš„APIç‰ˆæœ¬è¿”å›æ•°æ®ç»“æœç»“æ„ä¸€æ ·ï¼Œé‚£æ²¡å¿…è¦åŒºåˆ†ç‰ˆæœ¬ï¼Œå¦‚æœç»“æ„å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œè€Œä¸”è¦å‘ä¸‹å…¼å®¹ï¼Œé‚£ç‰ˆæœ¬å·æ˜¯å¾ˆå¥½çš„åŒºåˆ†æ–¹å¼ï¼Œè€Œä¸”é€šè¿‡ URL åŠ ç‰ˆæœ¬çš„æ–¹å¼å¯ä»¥æ›´å¥½çš„å‘ç°èµ„æº è¿‡æ»¤/åˆ†é¡µ/æ’åºå®é™…çš„ä¸šåŠ¡åœºæ™¯ä¸­ä¼šç»å¸¸å¯¹è¯·æ±‚èµ„æºåšæ¡ä»¶ç­›é€‰ï¼Œåˆ†é¡µæ˜¾ç¤ºï¼Œä»¥åŠæ’åºï¼Œæˆ‘ä»¬ä¸è¦ä¸ºè¿™äº›ä¸šåŠ¡è¦æ±‚åˆ›å»ºä¸åŒæ­¥çš„ APIï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä¿æŒ URL çš„ä¿¡æ¯ç®€å•ï¼Œåªéœ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶å‚æ•°æ¥å®ç°ä¸Šè¿°åŠŸèƒ½ï¼ŒåŒæ—¶ç¬¦åˆâ€æœ› URL çŸ¥æ„â€çš„åŸåˆ™ è¿‡æ»¤12GET /users/12/posts?state=publishedGET /users/12/posts?published=true ä¸Šè¿°ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥å®ç°èµ„æºçš„è¿‡æ»¤ åˆ†é¡µ1GET /users?pageNo=1&amp;pageSize=20 ä»¥åˆ†é¡µæ–¹å¼æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ï¼Œæ˜¾ç¤ºç¬¬ 2 é¡µå†…å®¹ï¼Œæ¯é¡µæ˜¾ç¤º 20 æ¡ä¿¡æ¯ æ’åº1GET /users?sort=score_desc æŒ‰ç…§å­¦ç”Ÿåˆ†æ•°é™åºè¿›è¡Œæ’åº ä¸Šè¿°æ‰€æœ‰çš„æ–¹å¼æˆ‘ä»¬éƒ½å¯ä»¥åšåˆ°â€æœ› URL çŸ¥æ„â€ï¼Œè¿™å°±æ˜¯å¥½çš„è®¾è®¡ è¿”å›ç»“æœRESTful API çš„è¿”å›ç»“æœä¹Ÿæ˜¯è®¾è®¡ç¯èŠ‚ä¸­é‡è¦çš„ä¸€ç¯ å“åº”æ•°æ®æ ¼å¼API è¿”å›çš„æ•°æ®æ ¼å¼ï¼Œä¸åº”è¯¥æ˜¯çº¯æ–‡æœ¬ï¼Œè€Œåº”è¯¥æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œå› ä¸ºè¿™æ ·æ‰èƒ½è¿”å›æ ‡å‡†çš„ç»“æ„åŒ–æ•°æ®ã€‚æ‰€ä»¥ï¼ŒæœåŠ¡å™¨å›åº”çš„ HTTP å¤´çš„Content-Typeå±æ€§è¦è®¾ä¸ºapplication/jsonã€‚åŒæ—¶å®¢æˆ·ç«¯ä¹Ÿåº”ä½œå‡ºç›¸åº”çš„é…åˆï¼Œå®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œä¹Ÿè¦æ˜ç¡®å‘Šè¯‰æœåŠ¡å™¨ï¼Œå¯ä»¥æ¥å— JSON æ ¼å¼ï¼Œå³è¯·æ±‚çš„ HTTP å¤´çš„ACCEPTå±æ€§ä¹Ÿè¦è®¾æˆapplication/jsonï¼Œå¤šæ¸ é“è°ƒç”¨å¯èƒ½ä¼šå­˜åœ¨ç›¸åŒèµ„æºéœ€è¦æœ‰ä¸åŒçš„ producer ç±»å‹çš„æƒ…å†µå­˜åœ¨ å“åº”çŠ¶æ€ç å¾ˆå¤šåç«¯å¼€å‘äººå‘˜å¯èƒ½å—å¼€å‘æ¡†æ¶æ‰€é™ï¼Œæˆ–è€…è¿”å›æ•°æ®å°è£…å½¢å¼ä¸å¤Ÿå¥½ï¼Œç»å¸¸ä¼šç»™å‰ç«¯äººå‘˜ä¸æ˜¯å¾ˆå‹å¥½çš„ HTTP çŠ¶æ€ç ï¼Œæ¯”å¦‚ response æœ‰ errorï¼Œå´ç»™å‡º 200 HTTP.OK çš„çŠ¶æ€ç  (æ˜æ˜åƒäº†ä¸‰ç¢—ç²‰ï¼Œå´ç»™ä¸¤ç¢—ç²‰çš„é’±) 123456789HTTP/1.1 200 OKContent-Type: application/json&#123; \"status\": \"-1\", \"result\": &#123; \"error\": \"åˆ†æ•°åº”å°äº150\" &#125;&#125; æœ‰äººè¯´ï¼Œæˆ‘å·²ç»æ ‡è®°è¿”å›å†…å®¹ status æ˜¯ -1ï¼ˆè¡¨ç¤ºfailureï¼‰, ç”¨ 200 ä½œä¸ºçŠ¶æ€ç ä¹Ÿæ— å¦¨å§ï¼Ÿè¿™æ˜¯ä¸€ä¸ªå¾ˆé”™è¯¯çš„è§‚å¿µï¼ŒRESTful çš„è®¾è®¡ç†å¿µä¹‹ä¸€æ˜¯ç®€å•ç›´è§‚ï¼Œè¯•æƒ³ä¸€ä¸‹ï¼Œå‰ç«¯å¼€å‘äººå‘˜æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æ˜¯200çš„çŠ¶æ€ç ï¼Œä½†æ˜¯é¡µé¢æ•°æ®å°±æ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œéš¾é“å‰ç«¯å¼€å‘äººå‘˜è¿˜è¦æ¯ä¸ªæ¥å£è°ƒç”¨ç‚¹å¼€çœ‹ä¸€çœ‹ï¼Œæ˜¯å“ªä¸ª status æ˜¯ -1 å¯¼è‡´çš„å—ï¼Ÿ å¾ˆæ˜¾ç„¶æˆ‘ä»¬ä¸å¸Œæœ›è¿™æ ·çš„æƒ…å†µå‘ç”Ÿï¼Œæ­£ç¡®çš„åšæ³•åº”è¯¥ç±»ä¼¼è¿™æ ·çš„ï¼š 123456789HTTP/1.1 400 Bad RequestContent-Type: application/json&#123; \"status\": \"-1\", \"result\": &#123; \"error\": \"åˆ†æ•°åº”å°äº150\" &#125;&#125; ä¸‹é¢é¡µåˆ—ä¸¾å‡ºæ¥å¸¸ç”¨çš„çŠ¶æ€ç ä»¥åŠè¡¨ç¤ºçš„å«ä¹‰ï¼š 2xx çŠ¶æ€ç  200è¡¨ç¤ºæˆåŠŸï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥è¡¨ç¤ºçš„æ›´åŠ ç²¾ç¡® GET: 200 OK è¯·æ±‚æˆåŠŸ POST: 201 Created åˆ›å»ºæˆåŠŸ PUT: 200 OK æ›´æ–°æˆåŠŸ DELETE: 204 No Content æ‰¾ä¸åˆ°è¦åˆ é™¤çš„å†…å®¹ ä½¿ç”¨çŠ¶æ€ç  202 æœ‰æ—¶å€™ä¼šæ¯” ä½¿ç”¨çŠ¶æ€å•Šå— 201 æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼ŒçŠ¶æ€ç  202 çš„æ„æ€æ˜¯ï¼šæœåŠ¡ç«¯å·²æ¥æ”¶åˆ°äº†è¯·æ±‚ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•èµ„æºï¼Œä½†ç»“æœä¸€åˆ‡æ­£å¸¸ã€‚ æ¯”å¦‚ï¼š å¼‚æ­¥æ“ä½œï¼šæœåŠ¡å™¨å·²æ¥æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯è¿˜æœªå¤„ç†ï¼Œä½†æ˜¯ä¼šåœ¨æœªæ¥å¤„ç† èµ„æºå·²ç»å­˜åœ¨ï¼Œæ²¡æœ‰åˆ›å»ºæ–°çš„èµ„æº ï¼ˆæœ‰äº›ä¸šåŠ¡å¯èƒ½ä¼šè¿”å›é”™è¯¯ä¿¡æ¯â€æ‚¨åˆ›å»ºçš„æ•°æ®å·²å­˜åœ¨â€ï¼Œæ‰€ä»¥è¿™ç§æƒ…æ™¯æ²¡æœ‰æ˜ç¡®çš„è§„å®šï¼Œç¬¦åˆè‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚å³å¯ï¼‰ 4xx çŠ¶æ€ç  4xx çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯çš„é”™è¯¯ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š 400 Bad Requestï¼šæœåŠ¡å™¨ä¸ç†è§£å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œæœªåšä»»ä½•å¤„ç† 401 Unauthorizedï¼šç”¨æˆ·æœªæä¾›èº«ä»½éªŒè¯å‡­æ®ï¼Œæˆ–è€…æ²¡æœ‰é€šè¿‡èº«ä»½éªŒè¯ 403 Forbiddenï¼šç”¨æˆ·é€šè¿‡äº†èº«ä»½éªŒè¯ï¼Œä½†æ˜¯ä¸å…·æœ‰è®¿é—®èµ„æºæ‰€éœ€çš„æƒé™ 404 Not Foundï¼šæ‰€è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ï¼Œæˆ–ä¸å¯ç”¨ 415 Unsupported Media Typeï¼šå®¢æˆ·ç«¯è¦æ±‚çš„è¿”å›æ ¼å¼ä¸æ”¯æŒã€‚æ¯”å¦‚ï¼ŒAPI åªèƒ½è¿”å› JSON æ ¼å¼ï¼Œä½†æ˜¯å®¢æˆ·ç«¯è¦æ±‚è¿”å› XML æ ¼å¼ è¿™é‡Œè¦æ³¨æ„çŠ¶æ€ç  401 å’Œ 403 çš„åŒºåˆ« 5xx çŠ¶æ€ç  5xx çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡ç«¯é”™è¯¯ï¼Œé€šå¸¸åªä¼šç”¨åˆ°ä¸¤ä¸ªï¼š 500 Internal Server Errorï¼šå®¢æˆ·ç«¯è¯·æ±‚æœ‰æ•ˆï¼ŒæœåŠ¡å™¨å¤„ç†æ—¶å‘ç”Ÿäº†æ„å¤– 503 Service Unavailableï¼šæœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ï¼Œä¸€èˆ¬ç”¨äºç½‘ç«™ç»´æŠ¤çŠ¶æ€ æ— çŠ¶æ€è¿‡å»å¼€å‘äººå‘˜é€šå¸¸ä¼šå°†æ´»åŠ¨çš„ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨æœåŠ¡ç«¯çš„ session ä¸­ï¼Œ è¿™ç§å½¢å¼å¾ˆæ˜¾ç„¶ä¸é€‚ç”¨äºç°åœ¨åˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„çš„æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JWT (JSON Web Token) å¦‚ OAuth2 æ¥å®ç°ï¼Œè¿™æ ·æ¯æ¬¡åœ¨ Httpheader ä¸­æ·»åŠ  token æ¥åšéªŒè¯å³å¯ API æ–‡æ¡£Swaggeræ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å·¥å…·æ¥ç”¨æ¥è®°å½•ä¸å‘ˆç° REST APIï¼Œå®ƒæä¾›äº†ä¸€ç§æ¢ç´¢ç‰¹å®š API ä½¿ç”¨çš„æ–¹æ³•ï¼Œå› æ­¤å…è®¸å¼€å‘äººå‘˜ç†è§£åº•å±‚çš„è¯­ä¹‰è¡Œä¸ºã€‚ è¿™æ˜¯ä¸€ç§ä½¿ç”¨æ³¨é‡Šæ·»åŠ æ–‡æ¡£çš„å£°æ˜æ€§æ–¹æ³•ï¼Œå®ƒè¿›ä¸€æ­¥ç”Ÿæˆæè¿° API åŠå…¶ç”¨æ³•çš„ JSONï¼Œå¯ä»¥å®æ—¶åº”å¯¹ API çš„æ›´æ–°ï¼Œå…·ä½“è¯·å‚è€ƒ Swagger å®˜ç½‘ , åŒæ—¶ä½¿ç”¨ Spring Boot çš„å°ä¼™ä¼´ä¹Ÿå¯ä»¥å¾ˆè½»æ¾çš„é›†æˆ Swaggerï¼Œåªéœ€å¼•å…¥Swagger Starter 12345&lt;dependency&gt; &lt;groupId&gt;com.spring4all&lt;/groupId&gt; &lt;artifactId&gt;swagger-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.9.0.RELEASE&lt;/version&gt;&lt;/dependency&gt; HATEOASHATEOAS (Hypermedia As Transfer Engine Of Application State), API çš„ä½¿ç”¨è€…æœªå¿…çŸ¥é“ï¼ŒURL æ˜¯æ€ä¹ˆè®¾è®¡çš„ã€‚ä¸€ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯ï¼Œåœ¨å›åº”ä¸­ï¼Œç»™å‡ºç›¸å…³é“¾æ¥ï¼Œä¾¿äºä¸‹ä¸€æ­¥æ“ä½œã€‚è¿™æ ·çš„è¯ï¼Œç”¨æˆ·åªè¦è®°ä½ä¸€ä¸ª URLï¼Œå°±å¯ä»¥å‘ç°å…¶ä»–çš„ URLã€‚è¿™ç§æ–¹æ³•å«åš HATEOAS , ä¸¾ä¸ªä¾‹å­ï¼Œåˆ—è¡¨é¡µæ•°æ®é€šå¸¸ä¼šæœ‰æŸ¥çœ‹æ“ä½œï¼Œè¿™æ ·æˆ‘ä»¬åœ¨è¿”å›åˆ—è¡¨é¡µçš„æ•°æ®çš„æ—¶å€™åŒæ ·è¿”å›å¦‚ä½•æ“ä½œæŸ¥çœ‹å…·ä½“æ•°æ®è¯¦æƒ…çš„ API æ¥å£ï¼š 123456789101112&#123; \"status\": \"-1\", \"result\": [&#123; \"id\": 1, \"name\": \"zhangsan\", \"links\":[ &#123; \"href\": \"http://localhost:8080/user/&#123;id&#125;\" &#125; ] &#125;]&#125; ä½¿ç”¨ Spring æ¡†æ¶çš„å°ä¼™ä¼´å¯ä»¥å¿«é€Ÿçš„ä½“éªŒä¸€ä¸‹è¿™ç§æ–¹å¼ï¼ŒSpring å®˜ç½‘é¡¹ç›® Spring HATEOAS , ä¼šå¿«é€Ÿçš„å°†å‚æ•°éƒ½åšæ›¿æ¢, å°†æŸ¥çœ‹ API URL ä¸­çš„ id ç›´æ¥æ›¿æ¢æˆ 1ã€‚ 123456789101112&#123; \"status\": \"-1\", \"result\": [&#123; \"id\": 1, \"name\": \"zhangsan\", \"links\":[ &#123; \"href\": \"http://localhost:8080/user/1\" &#125; ] &#125;]&#125; æå‡æ•ˆç‡å·¥å…·RestfulToolkitåç«¯å¼€å‘äººå‘˜å¯ä»¥å®‰è£… IntellJ idea æ’ä»¶ RestfulToolkit, Mac ç¯å¢ƒä½¿ç”¨å¿«æ·é”® CMD + \\ è¾“å…¥å…³é”®å­—å¿«é€Ÿå®šä½åˆ° API ä½ç½® åŒæ—¶åœ¨å³ä¾§å·¥å…·æ æ‰“å¼€ APIï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ demoData è¯·æ±‚å‚æ•°ï¼Œå®ç°å¿«é€Ÿè°ƒç”¨æµ‹è¯•ï¼š JSON-ViewerJSON-Viewer æ˜¯ Chrome æµè§ˆå™¨çš„æ’ä»¶ï¼Œç”¨äºå¿«é€Ÿè§£æåŠæ ¼å¼åŒ– json å†…å®¹ï¼Œåœ¨ Chrome omniboxï¼ˆå¤šåŠŸèƒ½è¾“å…¥æ¡†ï¼‰è¾“å…¥json-viewer + TAB ï¼Œå°† json å†…å®¹æ‹·è´è¿›å»ï¼Œç„¶åè¾“å…¥å›è½¦é”®ï¼Œå°†çœ‹åˆ°ç»“æ„æ¸…æ™°çš„ json æ•°æ®ï¼ŒåŒæ—¶å¯ä»¥è‡ªå®šä¹‰ä¸»é¢˜ å¦å¤–ï¼Œå‰ç«¯äººå‘˜æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒåŒå‡»è¯·æ±‚é“¾æ¥ï¼Œä¼šè‡ªåŠ¨å°† response ä¸­çš„ json æ•°æ®è§£æå‡ºæ¥ï¼Œéå¸¸æ–¹ä¾¿ PostmanPostman åŠŸèƒ½ååˆ†å¼ºå¤§ï¼Œ æœç´¢ Postman è‡ªå®šä¹‰ç¯å¢ƒå˜é‡ï¼Œä¼šæ‰“å¼€æ–°ä¸–ç•Œçš„å¤§é—¨ å†™åœ¨æœ€åå¦‚ä½•è®¾è®¡å‡ºæœ€å¥½çš„ RESTful API æ°¸è¿œä¸ä¼šæœ‰ç»“è®ºï¼Œè®¾è®¡å‡ºé«˜å¯ç”¨ï¼Œå›¢é˜Ÿè®¤å¯ï¼Œç®€å•æ¸…æ™°æ˜äº†çš„ RESTful API å°±æ˜¯å¥½çš„ã€‚ æ¬¢è¿äº¤æµä½ ä»¬åœ¨å›¢é˜Ÿä¸­æ˜¯å¦‚ä½•è®¾è®¡ RESTful API çš„ï¼Œé‡åˆ°äº†å“ªäº›é—®é¢˜ï¼Œæ˜¯å¦‚ä½•è§£å†³å’Œè§„èŒƒçš„","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"å®‰å…¨-åè®®-è§„èŒƒ","slug":"Coding/å®‰å…¨-åè®®-è§„èŒƒ","permalink":"https://dayarch.top/categories/Coding/%E5%AE%89%E5%85%A8-%E5%8D%8F%E8%AE%AE-%E8%A7%84%E8%8C%83/"}],"tags":[{"name":"RESTful","slug":"RESTful","permalink":"https://dayarch.top/tags/RESTful/"},{"name":"HTTP","slug":"HTTP","permalink":"https://dayarch.top/tags/HTTP/"}]},{"title":"Excelçš„å…¬å¼ä½¿ç”¨","slug":"Excelçš„å…¬å¼ä½¿ç”¨","date":"2019-05-10T02:15:39.000Z","updated":"2019-12-15T13:04:23.475Z","comments":true,"path":"/p/excel-formula.html","link":"","permalink":"https://dayarch.top/p/excel-formula.html","excerpt":"å‰è¨€ æœ€è¿‘åœ¨åšåŸºç¡€æ•°æ®çš„æ•´ç†ï¼Œæ•°æ®å­˜æ”¾åœ¨ Word è¡¨æ ¼ä¸­ï¼Œè¦å°†å¤§é‡çš„æ•°æ®æ•´ç†å¥½å¹¶å¯¼å…¥åˆ°æ•°æ®åº“ä¸­ç€å®éœ€è¦è´¹äº›åŠ›æ°”ï¼Œäºæ˜¯éœ€è¦ç¬¨æ–¹æ³•å’Œå·§æ–¹æ³•ä¸€èµ·ç”¨ æ•´ç†è¿‡ç¨‹ é¦–å…ˆåº”ç”¨ç¬¨æ–¹æ³•ï¼Œå°† Word ä¸­çš„æ•°æ®è¡¨æ ¼æ‹·è´åˆ° Excel ä¸­ï¼Œè²Œä¼¼è¿™æ˜¯å¿…é¡»çš„ï¼Œç”±äºæ‹·è´è¿‡æ¥çš„è¡¨æ ¼æœ‰åˆå¹¶å•å…ƒæ ¼çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°† Excel ä¸­çš„è¡¨æ ¼æ ‡å‡†åŒ– Excelé€šè¿‡å…¬å¼æ‹¼æ¥å­—ç¬¦ä¸²æ¢è¡Œ æˆ‘ä»¬é€šå¸¸éƒ½ä¼šé€šè¿‡Excelå…¬å¼=CONCATENATE(Text1,[Text2])æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå½“æˆ‘ä»¬éœ€è¦æ‹¼æ¥çš„å­—ç¬¦ä¸²ä¸­éœ€è¦æ¢è¡Œæ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨CHAR(10)æ¥å®Œæˆæ‹¼æ¥æ¢è¡Œç¬¦ï¼Œè¯·çœ‹å¦‚ä¸‹ä¾‹å­ =CONCATENATE(\"hello\",CHAR(","text":"å‰è¨€æœ€è¿‘åœ¨åšåŸºç¡€æ•°æ®çš„æ•´ç†ï¼Œæ•°æ®å­˜æ”¾åœ¨ Word è¡¨æ ¼ä¸­ï¼Œè¦å°†å¤§é‡çš„æ•°æ®æ•´ç†å¥½å¹¶å¯¼å…¥åˆ°æ•°æ®åº“ä¸­ç€å®éœ€è¦è´¹äº›åŠ›æ°”ï¼Œäºæ˜¯éœ€è¦ç¬¨æ–¹æ³•å’Œå·§æ–¹æ³•ä¸€èµ·ç”¨ æ•´ç†è¿‡ç¨‹é¦–å…ˆåº”ç”¨ç¬¨æ–¹æ³•ï¼Œå°† Word ä¸­çš„æ•°æ®è¡¨æ ¼æ‹·è´åˆ° Excel ä¸­ï¼Œè²Œä¼¼è¿™æ˜¯å¿…é¡»çš„ï¼Œç”±äºæ‹·è´è¿‡æ¥çš„è¡¨æ ¼æœ‰åˆå¹¶å•å…ƒæ ¼çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°† Excel ä¸­çš„è¡¨æ ¼æ ‡å‡†åŒ– Excelé€šè¿‡å…¬å¼æ‹¼æ¥å­—ç¬¦ä¸²æ¢è¡Œæˆ‘ä»¬é€šå¸¸éƒ½ä¼šé€šè¿‡Excelå…¬å¼=CONCATENATE(Text1,[Text2])æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå½“æˆ‘ä»¬éœ€è¦æ‹¼æ¥çš„å­—ç¬¦ä¸²ä¸­éœ€è¦æ¢è¡Œæ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨CHAR(10)æ¥å®Œæˆæ‹¼æ¥æ¢è¡Œç¬¦ï¼Œè¯·çœ‹å¦‚ä¸‹ä¾‹å­ =CONCATENATE(&quot;hello&quot;,CHAR(10),&quot;world&quot;)è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š hello worldNOTE: ä½¿ç”¨æ‹¼æ¥å­—ç¬¦ä¸²å…¬å¼çš„å•å…ƒæ ¼è¯·è®¾ç½®ä¸ºå¸¸è§„ï¼Œä¸è¦æ˜¯è‡ªåŠ¨æ¢è¡Œ. å–æ¶ˆåˆå¹¶å•å…ƒæ ¼ å°† Excel å…¨éƒ¨é€‰ä¸­ï¼Œç„¶åç‚¹å‡»å–æ¶ˆå•å…ƒæ ¼ å°†ç©ºå•å…ƒæ ¼è¿›è¡Œå­—æ®µçš„å¡«å…… æˆ‘ä»¬çœ‹åˆ°æ‹†åˆ†åçš„å•å…ƒæ ¼å¥½å¤šéƒ½æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬éœ€è¦å°†ç©ºçš„å•å…ƒæ ¼å¡«å……ä¸ºå®ƒä¸Šé¢ä¸€è¡Œçš„æ•°æ® é€‰ä¸­å¾…å¤„ç†çš„å•å…ƒæ ¼ æŒ‰F5 åœ¨å¼¹å‡ºæ¡†çš„ä½ç½®é€‰æ‹©ç©ºå€¼é€‰é¡¹ é”®ç›˜è¾“å…¥ç­‰äºå·â€=â€ï¼Œç„¶åæ•²å‡»å‘ä¸Šæ–¹å‘é”® Ctrl + Enter ç»„åˆå®Œæˆ ä¿®æ”¹ Excel çš„é»˜è®¤è¯­è¨€ æˆ‘ç”¨çš„Mac è‹±æ–‡ç‰ˆï¼Œæ‰“å¼€ Excel æ²¡æœ‰ç±»ä¼¼ LENB() è¿™æ ·çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘éœ€è¦å°†è¯­è¨€å°±æ”¹ä¸ºä¸­æ–‡ 12345# ä¿®æ”¹ Excel è¯­è¨€defaults write com.microsoft.Excel AppleLanguages '(\"zh-tw\")'# ä¿®æ”¹ Word è¯­è¨€defaults write com.microsoft.Word AppleLanguages '(\"zh-tw\")' æ•°å­—ä¸æ±‰å­—çš„æ‹†åˆ† æ‹·è´è¿‡æ¥çš„æ•°æ®ï¼Œéœ€è¦åšK-V çš„æ˜ å°„ï¼Œå°†ä¸€æ®µæ–‡å­—ä¸­çš„æ•°å­—æå–å‡ºæ¥ä½œä¸º keyï¼Œ å°†æ–‡æœ¬ä¸­çš„æ±‰å­—æå–å‡ºæ¥ä½œä¸º Valueï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°ä¸¤ç»„å…¬å¼ï¼š LEFT(å•å…ƒæ ¼, length) / RIGHT(å•å…ƒæ ¼, length) LEFT: ä»å•å…ƒæ ¼å†…å®¹å¼€å§‹ä½ç½®æˆªå–æŒ‡å®šé•¿åº¦å†…å®¹ï¼› RIGHT: ä»å•å…ƒæ ¼å†…å®¹æœ«å°¾ä½ç½®æˆªå–æŒ‡å®šé•¿åº¦å†…å®¹ï¼› LEN(å•å…ƒæ ¼) / LENB(å•å…ƒæ ¼) LENæ˜¯è¿”å›å­—ç¬¦ä¸²çš„å­—ç¬¦æ•°; LENBæ˜¯è¿”å›å­—ç¬¦ä¸²çš„å­—èŠ‚æ•°; æ•°å­—ã€å­—æ¯ã€è‹±æ–‡ã€æ ‡ç‚¹ç¬¦å·ï¼ˆåŠè§’çŠ¶æ€ï¼‰éƒ½æ˜¯æŒ‰1è®¡ç®—çš„ï¼Œæ±‰å­—ã€å…¨è§’çŠ¶æ€ä¸‹çš„æ ‡ç‚¹ç¬¦å·ï¼Œæ¯ä¸ªå­—ç¬¦æŒ‰2è®¡ç®— é˜¿æ‹‰ä¼¯æ•°å­—è½¬ç½—é©¬æ•°å­— åªéœ€è¦åº”ç”¨å…¬å¼ï¼š= ROMAN(A16) ç½—é©¬æ•°å­—è½¬é˜¿æ‹‰ä¼¯æ•°å­— åŒæ ·åº”ç”¨å…¬å¼ï¼š=MATCH(B16,INDEX(ROMAN(ROW(INDIRECT(â€œ1:4000â€))),0),0) ä»¥ä¸Šå°±æ˜¯è¿™æ¬¡æ•°æ®æå–ç”¨åˆ°çš„ä¸€äº›å…¬å¼ é™„å½•åœ¨æ­¤å¤„é™„ä¸Š office çš„å„ç§è¯­è¨€å­—å…¸ç ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Others","slug":"Coding/Others","permalink":"https://dayarch.top/categories/Coding/Others/"}],"tags":[{"name":"Excel","slug":"Excel","permalink":"https://dayarch.top/tags/Excel/"}]},{"title":"åŒäº²å§”æ´¾æ¨¡å‹","slug":"åŒäº²å§”æ´¾æ¨¡å‹","date":"2019-04-26T06:56:22.000Z","updated":"2019-11-07T06:37:53.347Z","comments":true,"path":"/p/java-parents-delegation-model.html","link":"","permalink":"https://dayarch.top/p/java-parents-delegation-model.html","excerpt":"åŒäº²å§”æ´¾æ¨¡å‹ åœ¨ä»‹ç»è¿™ä¸ªJavaæŠ€æœ¯ç‚¹ä¹‹å‰ï¼Œå…ˆè¯•ç€æ€è€ƒä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š 1. ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½å®šä¹‰åŒåçš„ String çš„ java æ–‡ä»¶ï¼Ÿ 2. å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œç±»çš„åŠ è½½ä¸ºä»€ä¹ˆä¸ä¼šå‡ºç°é‡å¤åŠ è½½çš„æƒ…å†µï¼Ÿ 3. ä¸‹é¢ä»£ç ï¼Œè™šæ‹Ÿæœºæ˜¯æ€æ ·åˆå§‹åŒ–æ³¨å†Œ Mysql è¿æ¥é©±åŠ¨(Driver)çš„ï¼Ÿ 1 Connection conn= DriverManager.getConnection(\"jdbc:mysql://localhost:3306/mydb?characterEncoding=GBK\", \"root\",","text":"åŒäº²å§”æ´¾æ¨¡å‹åœ¨ä»‹ç»è¿™ä¸ªJavaæŠ€æœ¯ç‚¹ä¹‹å‰ï¼Œå…ˆè¯•ç€æ€è€ƒä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½å®šä¹‰åŒåçš„ String çš„ java æ–‡ä»¶ï¼Ÿ å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œç±»çš„åŠ è½½ä¸ºä»€ä¹ˆä¸ä¼šå‡ºç°é‡å¤åŠ è½½çš„æƒ…å†µï¼Ÿ ä¸‹é¢ä»£ç ï¼Œè™šæ‹Ÿæœºæ˜¯æ€æ ·åˆå§‹åŒ–æ³¨å†Œ Mysql è¿æ¥é©±åŠ¨(Driver)çš„ï¼Ÿ 1Connection conn= DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/mydb?characterEncoding=GBK&quot;, &quot;root&quot;, &quot;000000&quot;); çƒ­éƒ¨ç½²çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ æƒ³ç†è§£ä»¥ä¸Šå‡ ä¸ªé—®é¢˜çš„å‰ææ˜¯äº†è§£ç±»åŠ è½½æ—¶æœºä¸è¿‡ç¨‹, è¿™ç¯‡æ–‡ç« å°†ä¼šä»¥éå¸¸è¯¦ç»†çš„è§£è¯»æ–¹å¼æ¥å›ç­”ä»¥ä¸Šå‡ ä¸ªé—®é¢˜ ç±»åŠ è½½æ—¶æœºä¸è¿‡ç¨‹ç±»ä»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­å¼€å§‹ï¼Œåˆ°å¸è½½å‡ºå†…å­˜ä¸ºæ­¢ï¼Œå®ƒçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ï¼šåŠ è½½ï¼ˆLoadingï¼‰ã€éªŒè¯ï¼ˆVerificationï¼‰ã€å‡†å¤‡(Preparation)ã€è§£æ(Resolution)ã€åˆå§‹åŒ–(Initialization)ã€ä½¿ç”¨(Using)å’Œå¸è½½(Unloading)7ä¸ªé˜¶æ®µã€‚å…¶ä¸­å‡†å¤‡ã€éªŒè¯ã€è§£æ3ä¸ªéƒ¨åˆ†ç»Ÿç§°ä¸ºè¿æ¥ï¼ˆLinkingï¼‰ã€‚å¦‚å›¾æ‰€ç¤º åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€åˆå§‹åŒ–å’Œå¸è½½è¿™5ä¸ªé˜¶æ®µçš„é¡ºåºæ˜¯ç¡®å®šçš„ï¼Œç±»çš„åŠ è½½è¿‡ç¨‹å¿…é¡»æŒ‰ç…§è¿™ç§é¡ºåºæŒ‰éƒ¨å°±ç­åœ°å¼€å§‹ï¼Œè€Œè§£æé˜¶æ®µåˆ™ä¸ä¸€å®šï¼šå®ƒåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥åœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åå†å¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒJavaè¯­è¨€çš„è¿è¡Œæ—¶ç»‘å®šï¼ˆä¹Ÿç§°ä¸ºåŠ¨æ€ç»‘å®šæˆ–æ™šæœŸç»‘å®šï¼‰ åŠ è½½åœ¨åŠ è½½é˜¶æ®µï¼ˆå¯ä»¥å‚è€ƒjava.lang.ClassLoaderçš„loadClass()æ–¹æ³•ï¼‰ï¼Œè™šæ‹Ÿæœºéœ€è¦å®Œæˆä»¥ä¸‹3ä»¶äº‹æƒ…ï¼š é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼ˆå¹¶æ²¡æœ‰æŒ‡æ˜è¦ä»ä¸€ä¸ªClassæ–‡ä»¶ä¸­è·å–ï¼Œå¯ä»¥ä»å…¶ä»–æ¸ é“ï¼Œè­¬å¦‚ï¼šç½‘ç»œã€åŠ¨æ€ç”Ÿæˆã€æ•°æ®åº“ç­‰ï¼‰ï¼› å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ï¼› åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ï¼› åŠ è½½é˜¶æ®µå’Œè¿æ¥é˜¶æ®µï¼ˆLinkingï¼‰çš„éƒ¨åˆ†å†…å®¹ï¼ˆå¦‚ä¸€éƒ¨åˆ†å­—èŠ‚ç æ–‡ä»¶æ ¼å¼éªŒè¯åŠ¨ä½œï¼‰æ˜¯äº¤å‰è¿›è¡Œçš„ï¼ŒåŠ è½½é˜¶æ®µå°šæœªå®Œæˆï¼Œè¿æ¥é˜¶æ®µå¯èƒ½å·²ç»å¼€å§‹ï¼Œä½†è¿™äº›å¤¹åœ¨åŠ è½½é˜¶æ®µä¹‹ä¸­è¿›è¡Œçš„åŠ¨ä½œï¼Œä»ç„¶å±äºè¿æ¥é˜¶æ®µçš„å†…å®¹ï¼Œè¿™ä¸¤ä¸ªé˜¶æ®µçš„å¼€å§‹æ—¶é—´ä»ç„¶ä¿æŒç€å›ºå®šçš„å…ˆåé¡ºåºã€‚ éªŒè¯éªŒè¯æ˜¯è¿æ¥é˜¶æ®µçš„ç¬¬ä¸€æ­¥ï¼Œè¿™ä¸€é˜¶æ®µçš„ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚éªŒè¯é˜¶æ®µå¤§è‡´ä¼šå®Œæˆ4ä¸ªé˜¶æ®µçš„æ£€éªŒåŠ¨ä½œï¼š æ–‡ä»¶æ ¼å¼éªŒè¯ï¼šéªŒè¯å­—èŠ‚æµæ˜¯å¦ç¬¦åˆClassæ–‡ä»¶æ ¼å¼çš„è§„èŒƒï¼›ä¾‹å¦‚ï¼šæ˜¯å¦ä»¥é­”æœ¯0xCAFEBABEå¼€å¤´ï¼ˆå½“classæ–‡ä»¶ä»¥äºŒè¿›åˆ¶å½¢å¼æ‰“å¼€ï¼Œä¼šçœ‹åˆ°è¿™ä¸ªæ–‡ä»¶å¤´ï¼Œcafebabeï¼‰ã€ä¸»æ¬¡ç‰ˆæœ¬å·æ˜¯å¦åœ¨å½“å‰è™šæ‹Ÿæœºçš„å¤„ç†èŒƒå›´ä¹‹å†…ã€å¸¸é‡æ± ä¸­çš„å¸¸é‡æ˜¯å¦æœ‰ä¸è¢«æ”¯æŒçš„ç±»å‹ã€‚ å…ƒæ•°æ®éªŒè¯ï¼šå¯¹å­—èŠ‚ç æè¿°çš„ä¿¡æ¯è¿›è¡Œè¯­ä¹‰åˆ†æï¼ˆæ³¨æ„ï¼šå¯¹æ¯”javacç¼–è¯‘é˜¶æ®µçš„è¯­ä¹‰åˆ†æï¼‰ï¼Œä»¥ä¿è¯å…¶æè¿°çš„ä¿¡æ¯ç¬¦åˆJavaè¯­è¨€è§„èŒƒçš„è¦æ±‚ï¼›ä¾‹å¦‚ï¼šè¿™ä¸ªç±»æ˜¯å¦æœ‰çˆ¶ç±»ï¼Œé™¤äº†java.lang.Objectä¹‹å¤–ã€‚ å­—èŠ‚ç éªŒè¯ï¼šé€šè¿‡æ•°æ®æµå’Œæ§åˆ¶æµåˆ†æï¼Œç¡®å®šç¨‹åºè¯­ä¹‰æ˜¯åˆæ³•çš„ã€ç¬¦åˆé€»è¾‘çš„ã€‚ ç¬¦å·å¼•ç”¨éªŒè¯ï¼šç¡®ä¿è§£æåŠ¨ä½œèƒ½æ­£ç¡®æ‰§è¡Œã€‚ éªŒè¯é˜¶æ®µæ˜¯éå¸¸é‡è¦çš„ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ï¼Œå®ƒå¯¹ç¨‹åºè¿è¡ŒæœŸæ²¡æœ‰å½±å“ï¼Œå¦‚æœæ‰€å¼•ç”¨çš„ç±»ç»è¿‡åå¤éªŒè¯ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘é‡‡ç”¨-Xverifynoneå‚æ•°æ¥å…³é—­å¤§éƒ¨åˆ†çš„ç±»éªŒè¯æªæ–½ï¼Œä»¥ç¼©çŸ­è™šæ‹Ÿæœºç±»åŠ è½½çš„æ—¶é—´ã€‚ å‡†å¤‡å‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µï¼Œè¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ã€‚è¿™æ—¶å€™è¿›è¡Œå†…å­˜åˆ†é…çš„ä»…åŒ…æ‹¬ç±»å˜é‡ï¼ˆè¢«staticä¿®é¥°çš„å˜é‡ï¼‰ï¼Œè€Œä¸åŒ…æ‹¬å®ä¾‹å˜é‡ï¼Œå®ä¾‹å˜é‡å°†ä¼šåœ¨å¯¹è±¡å®ä¾‹åŒ–æ—¶éšç€å¯¹è±¡ä¸€èµ·åˆ†é…åœ¨å †ä¸­ã€‚å…¶æ¬¡ï¼Œè¿™é‡Œæ‰€è¯´çš„åˆå§‹å€¼é€šå¸¸æƒ…å†µä¸‹æ˜¯æ•°æ®ç±»å‹çš„é›¶å€¼ï¼Œå‡è®¾ä¸€ä¸ªç±»å˜é‡çš„å®šä¹‰ä¸ºï¼š 12// å˜é‡valueåœ¨å‡†å¤‡é˜¶æ®µè¿‡åçš„åˆå§‹å€¼ä¸º0è€Œä¸æ˜¯123.å› ä¸ºè¿™æ—¶å€™å°šæœªå¼€å§‹æ‰§è¡Œä»»ä½•javaæ–¹æ³•ï¼Œè€ŒæŠŠvalueèµ‹å€¼ä¸º123çš„putstaticæŒ‡ä»¤æ˜¯ç¨‹åºè¢«ç¼–è¯‘åï¼Œå­˜æ”¾äºç±»æ„é€ å™¨()æ–¹æ³•ä¹‹ä¸­ï¼Œæ‰€ä»¥æŠŠvalueèµ‹å€¼ä¸º123çš„åŠ¨ä½œå°†åœ¨åˆå§‹åŒ–é˜¶æ®µæ‰ä¼šæ‰§è¡Œpublic static int value=123; æœ‰é€šå¸¸æƒ…å†µå°±æœ‰ç‰¹æ®Šæƒ…å†µï¼Œè¿™é‡Œçš„ç‰¹æ®Šæ˜¯æŒ‡ï¼š 12// å½“ç±»å­—æ®µçš„å­—æ®µå±æ€§æ˜¯ConstantValueæ—¶ï¼Œä¼šåœ¨å‡†å¤‡é˜¶æ®µåˆå§‹åŒ–ä¸ºæŒ‡å®šçš„å€¼ï¼Œæ‰€ä»¥æ ‡æ³¨ä¸ºfinalä¹‹åï¼Œvalueçš„å€¼åœ¨å‡†å¤‡é˜¶æ®µåˆå§‹åŒ–ä¸º123è€Œé0public static final int value=123; è§£æè§£æé˜¶æ®µæ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ã€æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦7ç±»ç¬¦å·å¼•ç”¨è¿›è¡Œã€‚ åˆå§‹åŒ–åœ¨ä»‹ç»åˆå§‹åŒ–æ—¶ï¼Œè¦å…ˆä»‹ç»ä¸¤ä¸ªæ–¹æ³•ï¼š&lt;clinit&gt; å’Œ &lt;init&gt; : åœ¨ç¼–è¯‘ç”Ÿæˆclassæ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨äº§ç”Ÿä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ç±»çš„åˆå§‹åŒ–æ–¹æ³•, å¦ä¸€ä¸ªæ˜¯å®ä¾‹çš„åˆå§‹åŒ–æ–¹æ³• clinit&gt;ï¼šåœ¨jvmç¬¬ä¸€æ¬¡åŠ è½½classæ–‡ä»¶æ—¶è°ƒç”¨ï¼ŒåŒ…æ‹¬é™æ€å˜é‡åˆå§‹åŒ–è¯­å¥å’Œé™æ€å—çš„æ‰§è¡Œ &lt;init&gt;: åœ¨å®ä¾‹åˆ›å»ºå‡ºæ¥çš„æ—¶å€™è°ƒç”¨ï¼ŒåŒ…æ‹¬è°ƒç”¨newæ“ä½œç¬¦ï¼›è°ƒç”¨ Class æˆ– Java.lang.reflect.Constructor å¯¹è±¡çš„newInstance()æ–¹æ³•ï¼›è°ƒç”¨ä»»ä½•ç°æœ‰å¯¹è±¡çš„clone()æ–¹æ³•ï¼›é€šè¿‡ java.io.ObjectInputStream ç±»çš„getObject() æ–¹æ³•ååºåˆ—åŒ–ã€‚ ç±»åˆå§‹åŒ–é˜¶æ®µæ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„æœ€åä¸€æ­¥ï¼Œåˆ°äº†åˆå§‹åŒ–é˜¶æ®µï¼Œæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„javaç¨‹åºä»£ç ã€‚åœ¨å‡†å¤‡æç«¯ï¼Œå˜é‡å·²ç»ä»˜è¿‡ä¸€æ¬¡ç³»ç»Ÿè¦æ±‚çš„åˆå§‹å€¼ï¼Œè€Œåœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œåˆ™æ ¹æ®ç¨‹åºçŒ¿é€šè¿‡ç¨‹åºåˆ¶å®šçš„ä¸»ç®¡è®¡åˆ’å»åˆå§‹åŒ–ç±»å˜é‡å’Œå…¶ä»–èµ„æºï¼Œæˆ–è€…è¯´ï¼šåˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨&lt;clinit&gt;()æ–¹æ³•çš„è¿‡ç¨‹. &lt;clinit&gt;()æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å— static{} ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ï¼Œç¼–è¯‘å™¨æ”¶é›†çš„é¡ºåºæ˜¯ç”±è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºæ‰€å†³å®šçš„ï¼Œé™æ€è¯­å¥å—åªèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨é™æ€è¯­å¥å—ä¹‹å‰çš„å˜é‡ï¼Œå®šä¹‰åœ¨å®ƒä¹‹åçš„å˜é‡ï¼Œåœ¨å‰é¢çš„é™æ€è¯­å¥å—å¯ä»¥èµ‹å€¼ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®ã€‚å¦‚ä¸‹ï¼š 1234567public class Test &#123; static &#123; i=0; System.out.println(i); //è¿™å¥ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼šIllegal forward reference (ä¸åˆæ³•çš„å‘å‰å¼•ç”¨) &#125; static int i=1;&#125; é‚£ä¹ˆå»æ‰æŠ¥é”™çš„é‚£å¥ï¼Œæ”¹æˆä¸‹é¢ï¼š 1234567891011public class Test &#123; static &#123; i=0; // System.out.println(i); //è¿™å¥ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼šIllegal forward reference (ä¸åˆæ³•çš„å‘å‰å¼•ç”¨) &#125; static int i=1; public static void main(String args[])&#123; System.out.println(i); &#125;&#125; è¾“å‡ºç»“æœï¼š1 ä¸ºä»€ä¹ˆè¾“å‡ºç»“æœæ˜¯1ï¼Œåœ¨å‡†å¤‡é˜¶æ®µæˆ‘ä»¬çŸ¥é“ i=0ï¼Œç„¶åç±»åˆå§‹åŒ–é˜¶æ®µæŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œé¦–å…ˆæ‰§è¡Œ static å—ä¸­çš„ i=0,æ¥ç€æ‰§è¡Œ staticèµ‹å€¼æ“ä½œi=1, æœ€ååœ¨ main æ–¹æ³•ä¸­è·å– i çš„å€¼ä¸º1 &lt;clinit&gt;()æ–¹æ³•ä¸å®ä¾‹æ„é€ å™¨&lt;init&gt;()æ–¹æ³•ä¸åŒï¼Œå®ƒä¸éœ€è¦æ˜¾ç¤ºåœ°è°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œè™šæ‹Ÿæœºä¼šä¿è¯åœ¨å­ç±»&lt;init&gt;()æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„&lt;clinit&gt;()æ–¹æ³•æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯• ç”±äºçˆ¶ç±»çš„&lt;clinit&gt;()æ–¹æ³•å…ˆæ‰§è¡Œï¼Œä¹Ÿå°±æ„å‘³ç€çˆ¶ç±»ä¸­å®šä¹‰çš„é™æ€è¯­å¥å—è¦ä¼˜å…ˆäºå­ç±»çš„å˜é‡èµ‹å€¼æ“ä½œã€‚ &lt;clinit&gt;()æ–¹æ³•å¯¹äºç±»æˆ–è€…æ¥å£æ¥è¯´å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­æ²¡æœ‰é™æ€è¯­å¥å—ï¼Œä¹Ÿæ²¡æœ‰å¯¹å˜é‡çš„èµ‹å€¼æ“ä½œï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å¯ä»¥ä¸ä¸ºè¿™ä¸ªç±»ç”Ÿäº§&lt;clinit&gt;()æ–¹æ³•ã€‚ æ¥å£ä¸­ä¸èƒ½ä½¿ç”¨é™æ€è¯­å¥å—ï¼Œä½†ä»ç„¶æœ‰å˜é‡åˆå§‹åŒ–çš„èµ‹å€¼æ“ä½œï¼Œå› æ­¤æ¥å£ä¸ç±»ä¸€æ ·éƒ½ä¼šç”Ÿæˆ&lt;clinit&gt;()æ–¹æ³•ã€‚ä½†æ¥å£ä¸ç±»ä¸åŒçš„æ˜¯ï¼Œæ‰§è¡Œæ¥å£çš„&lt;clinit&gt;()æ–¹æ³•ä¸éœ€è¦å…ˆæ‰§è¡Œçˆ¶æ¥å£çš„&lt;clinit&gt;()æ–¹æ³•ã€‚åªæœ‰å½“çˆ¶æ¥å£ä¸­å®šä¹‰çš„å˜é‡ä½¿ç”¨æ—¶ï¼Œçˆ¶æ¥å£æ‰ä¼šåˆå§‹åŒ–ã€‚å¦å¤–ï¼Œæ¥å£çš„å®ç°ç±»åœ¨åˆå§‹åŒ–æ—¶ä¹Ÿä¸€æ ·ä¸ä¼šæ‰§è¡Œæ¥å£çš„&lt;clinit&gt;()æ–¹æ³•ã€‚ è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„&lt;clinit&gt;()æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¢«æ­£ç¡®çš„åŠ é”ã€åŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å»åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªç±»çš„&lt;clinit&gt;()æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹éƒ½éœ€è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œ&lt;clinit&gt;()æ–¹æ³•å®Œæ¯•ã€‚å¦‚æœåœ¨ä¸€ä¸ªç±»çš„&lt;clinit&gt;()æ–¹æ³•ä¸­æœ‰è€—æ—¶å¾ˆé•¿çš„æ“ä½œï¼Œå°±å¯èƒ½é€ æˆå¤šä¸ªçº¿ç¨‹é˜»å¡ï¼Œåœ¨å®é™…åº”ç”¨ä¸­è¿™ç§é˜»å¡å¾€å¾€æ˜¯éšè—çš„ã€‚ è®©æˆ‘ä»¬æ¥éªŒè¯ä¸Šé¢çš„åŠ è½½è§„åˆ™ è™šæ‹Ÿæœºä¼šä¿è¯åœ¨å­ç±»&lt;init&gt;()æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„&lt;clinit&gt;()æ–¹æ³•æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯• 123456789101112131415161718192021222324252627282930313233343536373839404142public class SSClass&#123; static &#123; System.out.println(\"SSClass\"); &#125;&#125;public class SuperClass extends SSClass&#123; static &#123; System.out.println(\"SuperClass init!\"); &#125; public static int value = 123; public SuperClass() &#123; System.out.println(\"init SuperClass\"); &#125;&#125;public class SubClass extends SuperClass&#123; static &#123; System.out.println(\"SubClass init\"); &#125; static int a; public SubClass() &#123; System.out.println(\"init SubClass\"); &#125;&#125;public class NotInitialization&#123; public static void main(String[] args) &#123; System.out.println(SubClass.value); &#125;&#125; è¾“å‡ºç»“æœ 123SSClassSuperClass init!123 é€šè¿‡æ•°ç»„å®šä¹‰æ¥å¼•ç”¨ç±»ï¼Œä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–(æˆ‘çš„ç†è§£æ˜¯æ•°ç»„çš„çˆ¶ç±»æ˜¯Object) 1234567public class NotInitialization&#123; public static void main(String[] args) &#123; SuperClass[] sca = new SuperClass[10]; &#125;&#125; è¾“å‡ºç»“æœï¼šæ—  å¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ç›´æ¥å¼•ç”¨åˆ°å®šä¹‰å¸¸é‡çš„ç±»ï¼Œå› æ­¤ä¸ä¼šè§¦å‘å®šä¹‰å¸¸é‡çš„ç±»çš„åˆå§‹åŒ– 123456789101112131415public class ConstClass&#123; static &#123; System.out.println(\"ConstClass init!\"); &#125; public static final String HELLOWORLD = \"hello world\";&#125;public class NotInitialization&#123; public static void main(String[] args) &#123; System.out.println(ConstClass.HELLOWORLD); &#125;&#125; è¾“å‡ºç»“æœï¼š 1hello world éªŒè¯å°ç»“ è™šæ‹Ÿæœºè§„èŒƒä¸¥æ ¼è§„å®šäº†æœ‰ä¸”åªæœ‰5ä¸­æƒ…å†µï¼ˆjdk1.7ï¼‰å¿…é¡»å¯¹ç±»è¿›è¡Œâ€œåˆå§‹åŒ–â€ï¼ˆè€ŒåŠ è½½ã€éªŒè¯ã€å‡†å¤‡è‡ªç„¶éœ€è¦åœ¨æ­¤ä¹‹å‰å¼€å§‹ï¼‰ï¼š é‡åˆ° new, getstatic, putstatic, invokestatic è¿™äº›å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ç”Ÿæˆè¿™4æ¡æŒ‡ä»¤çš„æœ€å¸¸è§çš„Javaä»£ç åœºæ™¯æ˜¯ï¼šä½¿ç”¨newå…³é”®å­—å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ã€è¯»å–æˆ–è®¾ç½®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µï¼ˆè¢«finalä¿®é¥°ã€å·²åœ¨ç¼–è¯‘å™¨æŠŠç»“æœæ”¾å…¥å¸¸é‡æ± çš„é™æ€å­—æ®µé™¤å¤–ï¼‰çš„æ—¶å€™ï¼Œä»¥åŠè°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚ ä½¿ç”¨ java.lang.reflect åŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±»ï¼ˆåŒ…å«main()æ–¹æ³•çš„é‚£ä¸ªç±»ï¼‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªä¸»ç±»ã€‚ å½“ä½¿ç”¨jdk1.7åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ª java.lang.invoke.MethodHandle å®ä¾‹æœ€åçš„è§£æç»“æœREF_getstatic, REF_putstatic, REF_invokeStatic çš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆå‡ºè§¦å‘å…¶åˆå§‹åŒ–ã€‚ æœ‰äº†è¿™ä¸ªåŠ è½½è§„åˆ™çš„å°è±¡ï¼ŒåŒäº²å§”æ´¾æ¨¡å‹å°±å¾ˆå¥½ç†è§£äº†ï¼Œåˆ«ç€æ€¥ï¼Œç»§ç»­å‘ä¸‹çœ‹, ä½ ä¼šå‘ç°ä½ çš„ç†è§£å±‚é¢æé«˜äº† åŒäº²å§”æ´¾æ¨¡å‹åˆšçœ‹åˆ°è¿™ä¸ªè¯æ±‡çš„æ—¶å€™æˆ‘æ˜¯å®Œå…¨æ‡µæ‡‚çš„çŠ¶æ€ï¼Œå…¶å®å°±æ˜¯å®šä¹‰äº† JVM å¯åŠ¨çš„æ—¶å€™ç±»çš„åŠ è½½è§„åˆ™, å¤§å®¶è¦æŒ‰è§„çŸ©åŠäº‹ï¼Œå¥½åŠäº‹ï¼Œæ¥çœ‹ä¸‹å›¾ï¼š æ‰€è°“åŒäº²å§”æ´¾æ˜¯æŒ‡æ¯æ¬¡æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚æ—¶ï¼Œå…ˆå°†è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å®Œæˆï¼ˆæ‰€æœ‰åŠ è½½è¯·æ±‚æœ€ç»ˆä¼šå§”æ´¾åˆ°é¡¶å±‚çš„Bootstrap ClassLoaderåŠ è½½å™¨ä¸­ï¼‰ï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½ï¼ˆè¯¥åŠ è½½å™¨çš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ç±»ï¼‰ï¼Œå­ç±»å°è¯•è‡ªå·±åŠ è½½ï¼Œ å¦‚æœéƒ½æ²¡åŠ è½½åˆ°ï¼Œåˆ™ä¼šæŠ›å‡º ClassNotFoundException å¼‚å¸¸ï¼Œ çœ‹åˆ°è¿™é‡Œå…¶å®å°±è§£é‡Šäº†æ–‡ç« å¼€å¤´æå‡ºçš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œçˆ¶åŠ è½½å™¨å·²ç»åŠ è½½äº†JDK ä¸­çš„ String.class æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å®šä¹‰åŒåçš„ String java æ–‡ä»¶ã€‚ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„è§„çŸ©è®¾å®šï¼Ÿ å› ä¸ºè¿™æ ·å¯ä»¥é¿å…é‡å¤åŠ è½½ï¼Œå½“çˆ¶äº²å·²ç»åŠ è½½äº†è¯¥ç±»çš„æ—¶å€™ï¼Œå°±æ²¡æœ‰å¿…è¦ ClassLoader å†åŠ è½½ä¸€æ¬¡ã€‚è€ƒè™‘åˆ°å®‰å…¨å› ç´ ï¼Œæˆ‘ä»¬è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™ç§å§”æ‰˜æ¨¡å¼ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥éšæ—¶ä½¿ç”¨è‡ªå®šä¹‰çš„Stringæ¥åŠ¨æ€æ›¿ä»£javaæ ¸å¿ƒapiä¸­å®šä¹‰çš„ç±»å‹ï¼Œè¿™æ ·ä¼šå­˜åœ¨éå¸¸å¤§çš„å®‰å…¨éšæ‚£ï¼Œè€ŒåŒäº²å§”æ‰˜çš„æ–¹å¼ï¼Œå°±å¯ä»¥é¿å…è¿™ç§æƒ…å†µï¼Œå› ä¸ºString å·²ç»åœ¨å¯åŠ¨æ—¶å°±è¢«å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆBootstrcp ClassLoaderï¼‰åŠ è½½ï¼Œæ‰€ä»¥ç”¨æˆ·è‡ªå®šä¹‰çš„ClassLoaderæ°¸è¿œä¹Ÿæ— æ³•åŠ è½½ä¸€ä¸ªè‡ªå·±å†™çš„Stringï¼Œé™¤éä½ æ”¹å˜ JDK ä¸­ ClassLoader æœç´¢ç±»çš„é»˜è®¤ç®—æ³•ã€‚ æˆ‘ä»¬å‘ç°é™¤äº†å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootStrap ClassLoaderï¼‰ï¼Œæ¯ä¸ªç±»éƒ½æœ‰å…¶â€çˆ¶ç±»â€åŠ è½½å™¨ âš ï¸ å…¶å®è¿™é‡Œçš„çˆ¶å­å…³ç³»æ˜¯ç»„åˆæ¨¡å¼ï¼Œä¸æ˜¯ç»§æ‰¿å…³ç³»æ¥å®ç° ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ç±» AppClassLoader å’Œ ExtClassLoader éƒ½ç»§æ‰¿ URLClassLoaderï¼Œ è€Œ URLClassLoader åˆç»§æ‰¿ ClassLoaderï¼Œ åœ¨ ClassLoader ä¸­æœ‰ä¸€ä¸ªå±æ€§ 1234// The parent class loader for delegation// Note: VM hardcoded the offset of this field, thus all new fields// must be added *after* it.private final ClassLoader parent; åœ¨é€šè¿‡æ„é€ å‡½æ•°å®ä¾‹åŒ– AppClassLoader å’Œ ExtClassLoader çš„æ—¶å€™éƒ½è¦ä¼ å…¥ä¸€ä¸ª classloader ä½œä¸ºå½“å‰ classloader çš„ parent 12345AppClassLoader(URL[] var1, ClassLoader var2) &#123; // é€šè¿‡å±‚å±‚è°ƒç”¨ superï¼Œæœ€åæŒ‡å®šåˆ° ClassLoader.java ä¸­çš„ parent å±æ€§ super(var1, var2, Launcher.factory); this.ucp.initLookupCache(this);&#125; é¡¶å±‚ClassLoaderæœ‰å‡ ä¸ªå‡½æ•°å¾ˆå…³é”®ï¼Œå…ˆæœ‰ä¸ªå°è±¡ æŒ‡å®šä¿æŠ¤åŸŸï¼ˆprotectionDomainï¼‰ï¼ŒæŠŠByteBufferçš„å†…å®¹è½¬æ¢æˆ Java ç±»ï¼Œè¿™ä¸ªæ–¹æ³•è¢«å£°æ˜ä¸ºfinalçš„ 1defineClass(String name, java.nio.ByteBuffer b,ProtectionDomain protectionDomain) æŠŠå­—èŠ‚æ•°ç»„ bä¸­çš„å†…å®¹è½¬æ¢æˆ Java ç±»ï¼Œå…¶å¼€å§‹åç§»ä¸ºoff,è¿™ä¸ªæ–¹æ³•è¢«å£°æ˜ä¸ºfinalçš„ 1defineClass(String name, byte[] b, int off, int len) æŸ¥æ‰¾æŒ‡å®šåç§°çš„ç±» 1findClass(String name) é“¾æ¥æŒ‡å®šçš„ç±» 1resolveClass(Class&lt;?&gt;) ç±»åŠ è½½å™¨è´£ä»»èŒƒå›´ä¸Šé¢æˆ‘ä»¬æåˆ°æ¯ä¸ªåŠ è½½å™¨éƒ½æœ‰å¯¹åº”çš„åŠ è½½æœç´¢èŒƒå›´ Bootstrap ClassLoader:è¿™ä¸ªåŠ è½½å™¨ä¸æ˜¯ä¸€ä¸ªJavaç±»ï¼Œè€Œæ˜¯ç”±åº•å±‚çš„c++å®ç°ï¼Œè´Ÿè´£åœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åŠ è½½Jdkæ ¸å¿ƒç±»åº“ï¼ˆå¦‚ï¼šrt.jarã€resources.jarã€charsets.jarç­‰ï¼‰ä»¥åŠåŠ è½½åä¸¤ä¸ªç±»åŠ è½½å™¨ã€‚è¿™ä¸ªClassLoaderå®Œå…¨æ˜¯JVMè‡ªå·±æ§åˆ¶çš„ï¼Œéœ€è¦åŠ è½½å“ªä¸ªç±»ï¼Œæ€ä¹ˆåŠ è½½éƒ½æ˜¯ç”±JVMè‡ªå·±æ§åˆ¶ï¼Œåˆ«äººä¹Ÿè®¿é—®ä¸åˆ°è¿™ä¸ªç±» Extension ClassLoader:æ˜¯ä¸€ä¸ªæ™®é€šçš„Javaç±»ï¼Œç»§æ‰¿è‡ªClassLoaderç±»ï¼Œè´Ÿè´£åŠ è½½{JAVA_HOME}/jre/lib/ext/ç›®å½•ä¸‹çš„æ‰€æœ‰jaråŒ…ã€‚ App ClassLoaderï¼šæ˜¯Extension ClassLoaderçš„å­å¯¹è±¡ï¼Œè´Ÿè´£åŠ è½½åº”ç”¨ç¨‹åºclasspathç›®å½•ä¸‹çš„æ‰€æœ‰jarå’Œclassæ–‡ä»¶ã€‚ 123456789101112131415/** * æµ‹è¯•ç±»åŠ è½½å™¨åŠ è½½ç›®å½• */public class TestClassLoaderPath &#123; public static void main(String[] args)throws Exception&#123; // BootStrap ClassLoaderåŠ è½½çš„æ–‡ä»¶ System.out.println(System.getProperty(\"sun.boot.class.path\")); // ExtClassLoaderåŠ è½½çš„æ–‡ä»¶ System.out.println(System.getProperty(\"java.ext.dirs\")); // AppClassLoaderåŠ è½½çš„æ–‡ä»¶ System.getProperty(\"java.class.path\") &#125;&#125; å¤§å®¶è‡ªè¡Œè¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥çœ‹åˆ°æ¯ä¸ªç±»åŠ è½½å™¨åŠ è½½çš„æ–‡ä»¶äº† ä¸¤ç§ç±»çš„åŠ è½½æ–¹å¼é€šå¸¸ç”¨è¿™ä¸¤ç§æ–¹å¼æ¥åŠ¨æ€åŠ è½½ä¸€ä¸ª java ç±»ï¼ŒClass.forName() ä¸ ClassLoader.loadClass() ä½†æ˜¯ä¸¤ä¸ªæ–¹æ³•ä¹‹é—´ä¹Ÿæ˜¯æœ‰ä¸€äº›ç»†å¾®çš„å·®åˆ« Class.forName() æ–¹å¼æŸ¥çœ‹Classç±»çš„å…·ä½“å®ç°å¯çŸ¥ï¼Œå®è´¨ä¸Šè¿™ä¸ªæ–¹æ³•æ˜¯è°ƒç”¨åŸç”Ÿçš„æ–¹æ³•ï¼š 1private static native Class&lt;?&gt; forName0(String name, boolean initialize,ClassLoader loader); å½¢å¼ä¸Šç±»ä¼¼äºClass.forName(name,true,currentLoader)ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼ŒClass.forName å¦‚æœè°ƒç”¨æˆåŠŸä¼šï¼š ä¿è¯ä¸€ä¸ªJavaç±»è¢«æœ‰æ•ˆå¾—åŠ è½½åˆ°å†…å­˜ä¸­ï¼› ç±»é»˜è®¤ä¼šè¢«åˆå§‹åŒ–ï¼Œå³æ‰§è¡Œå†…éƒ¨çš„é™æ€å—ä»£ç ä»¥åŠä¿è¯é™æ€å±æ€§è¢«åˆå§‹åŒ–ï¼› é»˜è®¤ä¼šä½¿ç”¨å½“å‰çš„ç±»åŠ è½½å™¨æ¥åŠ è½½å¯¹åº”çš„ç±»ã€‚ ClassLoader.loadClassæ–¹å¼å¦‚æœé‡‡ç”¨è¿™ç§æ–¹å¼çš„ç±»åŠ è½½ç­–ç•¥ï¼Œç”±äºåŒäº²æ‰˜ç®¡æ¨¡å‹çš„å­˜åœ¨ï¼Œæœ€ç»ˆéƒ½ä¼šå°†ç±»çš„åŠ è½½ä»»åŠ¡äº¤ä»˜ç»™Bootstrap ClassLoaderè¿›è¡ŒåŠ è½½ã€‚è·Ÿè¸ªæºä»£ç ï¼Œæœ€ç»ˆä¼šè°ƒç”¨åŸç”Ÿæ–¹æ³•ï¼š 1private native Class&lt;?&gt; findBootstrapClass(String name); ä¸æ­¤åŒæ—¶ï¼Œä¸ä¸Šä¸€ç§æ–¹å¼çš„æœ€æœ¬è´¨çš„ä¸åŒæ˜¯ï¼Œç±»ä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œåªæœ‰æ˜¾å¼è°ƒç”¨æ‰ä¼šè¿›è¡Œåˆå§‹åŒ–ã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒClassLoader.loadClass å¦‚æœè°ƒç”¨æˆåŠŸä¼šï¼š ç±»ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼› ç±»ä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œåªæœ‰åœ¨ä¹‹åè¢«ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ç±»æ‰ä¼šè¢«åˆå§‹åŒ–ï¼› ä¹‹æ‰€ä»¥é‡‡ç”¨è¿™ç§æ–¹å¼çš„ç±»åŠ è½½ï¼Œæ˜¯æä¾›ä¸€ç§çµæ´»åº¦ï¼Œå¯ä»¥æ ¹æ®è‡ªèº«çš„éœ€æ±‚ç»§æ‰¿ClassLoaderç±»å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨å®ç°ç±»çš„åŠ è½½ã€‚ï¼ˆå¾ˆå¤šå¼€æºWebé¡¹ç›®ä¸­éƒ½æœ‰è¿™ç§æƒ…å†µï¼Œæ¯”å¦‚tomcatï¼Œstruct2ï¼Œjbossã€‚åŸå› æ˜¯æ ¹æ®Java Servletè§„èŒƒçš„è¦æ±‚ï¼Œæ—¢è¦Webåº”ç”¨è‡ªå·±çš„ç±»çš„ä¼˜å…ˆçº§è¦é«˜äºWebå®¹å™¨æä¾›çš„ç±»ï¼Œä½†åŒæ—¶åˆè¦ä¿è¯Javaçš„æ ¸å¿ƒç±»ä¸è¢«ä»»æ„è¦†ç›–ï¼Œæ­¤æ—¶é‡å†™ä¸€ä¸ªç±»åŠ è½½å™¨å°±å¾ˆå¿…è¦äº†ï¼‰ åŒäº²å§”æ´¾æ¨¡å‹æºç åˆ†æLauncheråˆ†æç±»åŠ è½½å™¨æºç è¦ä» sun.misc.Launcher.class æ–‡ä»¶çœ‹èµ·, å…³é”®ä»£ç å·²æ·»åŠ æ³¨é‡Šï¼ŒåŒæ—¶å¯ä»¥åœ¨æ­¤ç±»ä¸­çœ‹åˆ° ExtClassLoader å’Œ AppClassLoader çš„å®šä¹‰ï¼Œä¹ŸéªŒè¯äº†æˆ‘ä»¬ä¸Šæ–‡æåˆ°çš„ä»–ä»¬ä¸æ˜¯ç»§æ‰¿å…³ç³»ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡å®š parent å±æ€§æ¥å½¢æˆçš„ç»„åˆæ¨¡å‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public Launcher() &#123; Launcher.ExtClassLoader var1; try &#123; // è·å–æ‰©å±•ç±»åŠ è½½å™¨ var1 = Launcher.ExtClassLoader.getExtClassLoader(); &#125; catch (IOException var10) &#123; throw new InternalError(\"Could not create extension class loader\", var10); &#125; try &#123; // è·å–åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ŒåŒæ—¶æŒ‡å®š parent æ˜¯var1ï¼ˆæ‰©å±•ç±»åŠ è½½å™¨ï¼‰ this.loader = Launcher.AppClassLoader.getAppClassLoader(var1); &#125; catch (IOException var9) &#123; throw new InternalError(\"Could not create application class loader\", var9); &#125; // è®¾ç½®AppClassLoaderä¸ºçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼ˆå¾ˆå…³é”®ï¼‰ï¼Œç ´ååŒäº²å§”æ´¾æ¨¡å‹éƒ½è¦ç”¨åˆ°è¿™ä¸ªæœºåˆ¶ Thread.currentThread().setContextClassLoader(this.loader); String var2 = System.getProperty(\"java.security.manager\"); if (var2 != null) &#123; SecurityManager var3 = null; if (!\"\".equals(var2) &amp;&amp; !\"default\".equals(var2)) &#123; try &#123; // è°ƒç”¨loadClasså‡½æ•°ï¼Œè¿™é‡Œçš„loaderæ˜¯AppClassLoader var3 = (SecurityManager)this.loader.loadClass(var2).newInstance(); &#125; catch (IllegalAccessException var5) &#123; &#125; catch (InstantiationException var6) &#123; &#125; catch (ClassNotFoundException var7) &#123; &#125; catch (ClassCastException var8) &#123; &#125; &#125; else &#123; var3 = new SecurityManager(); &#125; if (var3 == null) &#123; throw new InternalError(\"Could not create SecurityManager: \" + var2); &#125; System.setSecurityManager(var3); &#125; &#125;...// é™æ€å†…éƒ¨ç±»ExtClassLoaderstatic class ExtClassLoader extends java.net.URLClassLoader&#123; ...&#125;// é™æ€å†…éƒ¨ç±»AppClassLoaderstatic class AppClassLoader extends java.net.URLClassLoader&#123; ...&#125; è¿›å…¥ä¸Šé¢ç¬¬25è¡Œçš„ loadClass æ–¹æ³•ä¸­ 123456789101112131415161718192021222324252627282930313233343536373839protected Class&lt;?&gt; loadClass(String name, boolean resolve) throws ClassNotFoundException &#123; synchronized (getClassLoadingLock(name)) &#123; // First, check if the class has already been loaded Class&lt;?&gt; c = findLoadedClass(name); if (c == null) &#123; long t0 = System.nanoTime(); try &#123; if (parent != null) &#123; c = parent.loadClass(name, false); &#125; else &#123; // parentä¸ºç©ºï¼Œäº¤ç»™BootStrapClassLoader c = findBootstrapClassOrNull(name); &#125; &#125; catch (ClassNotFoundException e) &#123; // ClassNotFoundException thrown if class not found // from the non-null parent class loader &#125; if (c == null) &#123; // If still not found, then invoke findClass in order // to find the class. long t1 = System.nanoTime(); //URLClassLoaderé‡å†™äº†ClassLoaderçš„findClassæ–¹æ³•ï¼Œä¼šè°ƒç”¨defineClassæ–¹æ³•å½¢æˆä¸€ä¸ªJavaç±» c = findClass(name); // this is the defining class loader; record the stats sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0); sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1); sun.misc.PerfCounter.getFindClasses().increment(); &#125; &#125; if (resolve) &#123; resolveClass(c); &#125; return c; &#125; &#125; æˆ‘ä»¬çœ‹åˆ°æ–¹æ³•æœ‰åŒæ­¥å—ï¼ˆsynchronizedï¼‰, è¿™ä¹Ÿå°±è§£é‡Šäº†æ–‡ç« å¼€å¤´ç¬¬2ä¸ªé—®é¢˜ï¼Œå¤šçº¿ç¨‹æƒ…å†µä¸ä¼šå‡ºç°é‡å¤åŠ è½½çš„æƒ…å†µã€‚åŒæ—¶ä¼šè¯¢é—®parent classloaderæ˜¯å¦æœ‰åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰ï¼Œè‡ªå·±å°è¯•åŠ è½½ã€‚ URLClassLoaderä¸­çš„ findClassæ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930protected Class&lt;?&gt; findClass(final String name) throws ClassNotFoundException &#123; final Class&lt;?&gt; result; try &#123; result = AccessController.doPrivileged( new PrivilegedExceptionAction&lt;Class&lt;?&gt;&gt;() &#123; public Class&lt;?&gt; run() throws ClassNotFoundException &#123; String path = name.replace('.', '/').concat(\".class\"); Resource res = ucp.getResource(path, false); if (res != null) &#123; try &#123; // å®šä¹‰Class return defineClass(name, res); &#125; catch (IOException e) &#123; throw new ClassNotFoundException(name, e); &#125; &#125; else &#123; return null; &#125; &#125; &#125;, acc); &#125; catch (java.security.PrivilegedActionException pae) &#123; throw (ClassNotFoundException) pae.getException(); &#125; if (result == null) &#123; throw new ClassNotFoundException(name); &#125; return result; &#125; å€Ÿç”¨ç½‘å‹çš„ä¸€ä¸ªåŠ è½½æ—¶åºå›¾æ¥è§£é‡Šæ•´ä¸ªè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼š åŒäº²å§”æ´¾æ¨¡å‹çš„ç ´åJavaæœ¬èº«æœ‰ä¸€å¥—èµ„æºç®¡ç†æœåŠ¡JNDIï¼Œæ˜¯æ”¾ç½®åœ¨rt.jarä¸­ï¼Œç”±å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½çš„ã€‚ä»¥å¯¹æ•°æ®åº“ç®¡ç†JDBCä¸ºä¾‹ï¼Œjavaç»™æ•°æ®åº“æ“ä½œæä¾›äº†ä¸€ä¸ªDriveræ¥å£ï¼š 1234567891011121314151617package java.sql;public interface Driver &#123; Connection connect(String url, java.util.Properties info) throws SQLException; boolean acceptsURL(String url) throws SQLException; DriverPropertyInfo[] getPropertyInfo(String url, java.util.Properties info) throws SQLException; int getMajorVersion(); int getMinorVersion(); boolean jdbcCompliant(); public Logger getParentLogger() throws SQLFeatureNotSupportedException;&#125; ç„¶åæä¾›äº†ä¸€ä¸ªDriverManageræ¥ç®¡ç†è¿™äº›Driverçš„å…·ä½“å®ç°ï¼š 123456789101112131415public static synchronized void registerDriver(java.sql.Driver driver, DriverAction da) throws SQLException &#123; /* Register the driver if it has not already been added to our list */ if(driver != null) &#123; registeredDrivers.addIfAbsent(new DriverInfo(driver, da)); &#125; else &#123; // This is for compatibility with the original DriverManager throw new NullPointerException(); &#125; println(\"registerDriver: \" + driver); &#125; è¿™é‡Œçœç•¥äº†å¤§éƒ¨åˆ†ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä½¿ç”¨æ•°æ®åº“é©±åŠ¨å‰å¿…é¡»å…ˆè¦åœ¨DriverManagerä¸­ä½¿ç”¨registerDriver()æ³¨å†Œï¼Œç„¶åæˆ‘ä»¬æ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚ ä¸ç ´ååŒäº²å§”æ´¾æ¨¡å‹çš„æƒ…å†µï¼ˆä¸ä½¿ç”¨JNDIæœåŠ¡ï¼‰æˆ‘ä»¬çœ‹ä¸‹mysqlçš„é©±åŠ¨æ˜¯å¦‚ä½•è¢«åŠ è½½çš„ï¼š 1234// 1.åŠ è½½æ•°æ®è®¿é—®é©±åŠ¨ï¼Œä»¥Class.forNameçš„æ–¹å¼åŠ è½½ï¼Œä¼šåˆå§‹åŒ–Class.forName(\"com.mysql.jdbc.Driver\");//2.è¿æ¥åˆ°æ•°æ®\"åº“\"ä¸Šå»Connection conn= DriverManager.getConnection(\"jdbc:mysql://localhost:3306/mydb?characterEncoding=GBK\", \"root\", \"\"); æ ¸å¿ƒå°±æ˜¯è¿™å¥Class.forName()è§¦å‘äº†mysqlé©±åŠ¨çš„åŠ è½½ï¼Œæˆ‘ä»¬çœ‹ä¸‹mysqlå¯¹Driveræ¥å£çš„å®ç°ï¼š 12345678910111213141516171819202122public class Driver extends NonRegisteringDriver implements java.sql.Driver &#123; // // Register ourselves with the DriverManager // static &#123; try &#123; java.sql.DriverManager.registerDriver(new Driver()); &#125; catch (SQLException E) &#123; throw new RuntimeException(\"Can't register driver!\"); &#125; &#125; /** * Construct a new driver and register it with DriverManager * * @throws SQLException * if a database error occurs. */ public Driver() throws SQLException &#123; // Required for Class.forName().newInstance() &#125;&#125; å¯ä»¥çœ‹åˆ°ï¼ŒClass.forName()å…¶å®è§¦å‘äº†é™æ€ä»£ç å—ï¼Œç„¶åå‘DriverManagerä¸­æ³¨å†Œäº†ä¸€ä¸ªmysqlçš„Driverå®ç°ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡DriverManagerå»è·å–connectionçš„æ—¶å€™åªè¦éå†å½“å‰æ‰€æœ‰Driverå®ç°ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªå»ºç«‹è¿æ¥å°±å¯ä»¥äº†ã€‚ ç ´ååŒäº²å§”æ´¾æ¨¡å‹çš„æƒ…å†µåœ¨JDBC4.0ä»¥åï¼Œå¼€å§‹æ”¯æŒä½¿ç”¨spiçš„æ–¹å¼æ¥æ³¨å†Œè¿™ä¸ªDriverï¼Œå…·ä½“åšæ³•å°±æ˜¯åœ¨mysqlçš„jaråŒ…ä¸­çš„META-INF/services/java.sql.Driver æ–‡ä»¶ä¸­æŒ‡æ˜å½“å‰ä½¿ç”¨çš„Driveræ˜¯å“ªä¸ªï¼Œç„¶åä½¿ç”¨çš„æ—¶å€™å°±ç›´æ¥è¿™æ ·å°±å¯ä»¥äº†ï¼š 1Connection conn= DriverManager.getConnection(\"jdbc:mysql://localhost:3306/mydb?characterEncoding=GBK\", \"root\", \"\"); å¯ä»¥çœ‹åˆ°è¿™é‡Œç›´æ¥è·å–è¿æ¥ï¼Œçœå»äº†ä¸Šé¢çš„Class.forName()æ³¨å†Œè¿‡ç¨‹ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬åˆ†æä¸‹çœ‹ä½¿ç”¨äº†è¿™ç§spiæœåŠ¡çš„æ¨¡å¼åŸæœ¬çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„: ç¬¬ä¸€ï¼Œä»META-INF/services/java.sql.Driveræ–‡ä»¶ä¸­è·å–å…·ä½“çš„å®ç°ç±»åâ€œcom.mysql.jdbc.Driverâ€ ç¬¬äºŒï¼ŒåŠ è½½è¿™ä¸ªç±»ï¼Œè¿™é‡Œè‚¯å®šåªèƒ½ç”¨class.forName(â€œcom.mysql.jdbc.Driverâ€)æ¥åŠ è½½ å¥½äº†ï¼Œé—®é¢˜æ¥äº†ï¼ŒClass.forName()åŠ è½½ç”¨çš„æ˜¯è°ƒç”¨è€…çš„Classloaderï¼Œè¿™ä¸ªè°ƒç”¨è€…DriverManageræ˜¯åœ¨rt.jarä¸­çš„ï¼ŒClassLoaderæ˜¯å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œè€Œcom.mysql.jdbc.Driverè‚¯å®šä¸åœ¨/libä¸‹ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯æ— æ³•åŠ è½½mysqlä¸­çš„è¿™ä¸ªç±»çš„ã€‚è¿™å°±æ˜¯åŒäº²å§”æ´¾æ¨¡å‹çš„å±€é™æ€§äº†ï¼Œçˆ¶çº§åŠ è½½å™¨æ— æ³•åŠ è½½å­çº§ç±»åŠ è½½å™¨è·¯å¾„ä¸­çš„ç±»ã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼ŸæŒ‰ç…§ç›®å‰æƒ…å†µæ¥åˆ†æï¼Œè¿™ä¸ªmysqlçš„drvieråªæœ‰åº”ç”¨ç±»åŠ è½½å™¨èƒ½åŠ è½½ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨å¯åŠ¨ç±»åŠ è½½å™¨ä¸­æœ‰æ–¹æ³•è·å–åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼Œç„¶åé€šè¿‡å®ƒå»åŠ è½½å°±å¯ä»¥äº†ã€‚è¿™å°±æ˜¯æ‰€è°“çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åŠ è½½å™¨ã€‚ æ–‡ç« å‰åŠæ®µæåˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å¯ä»¥é€šè¿‡ Thread.setContextClassLoaser() æ–¹æ³•è®¾ç½®ï¼Œå¦‚æœä¸ç‰¹æ®Šè®¾ç½®ä¼šä»çˆ¶ç±»ç»§æ‰¿ï¼Œä¸€èˆ¬é»˜è®¤ä½¿ç”¨çš„æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ å¾ˆæ˜æ˜¾ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨è®©çˆ¶çº§ç±»åŠ è½½å™¨èƒ½é€šè¿‡è°ƒç”¨å­çº§ç±»åŠ è½½å™¨æ¥åŠ è½½ç±»ï¼Œè¿™æ‰“ç ´äº†åŒäº²å§”æ´¾æ¨¡å‹çš„åŸåˆ™ ç°åœ¨æˆ‘ä»¬çœ‹ä¸‹DriverManageræ˜¯å¦‚ä½•ä½¿ç”¨çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å»åŠ è½½ç¬¬ä¸‰æ–¹jaråŒ…ä¸­çš„Driverç±»çš„ï¼Œå…ˆæ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970public class DriverManager &#123; static &#123; loadInitialDrivers(); println(\"JDBC DriverManager initialized\"); &#125; private static void loadInitialDrivers() &#123; String drivers; try &#123; drivers = AccessController.doPrivileged(new PrivilegedAction&lt;String&gt;() &#123; public String run() &#123; return System.getProperty(\"jdbc.drivers\"); &#125; &#125;); &#125; catch (Exception ex) &#123; drivers = null; &#125; // If the driver is packaged as a Service Provider, load it. // Get all the drivers through the classloader // exposed as a java.sql.Driver.class service. // ServiceLoader.load() replaces the sun.misc.Providers() AccessController.doPrivileged(new PrivilegedAction&lt;Void&gt;() &#123; public Void run() &#123; // ServiceLoader æ˜¯ implements Iterable&lt;S&gt;çš„ä¸€ä¸ªç±»ï¼Œå¹¶é‡å†™äº† iterator æ–¹æ³•ï¼ˆå¾ˆå…³é”®ï¼‰ ServiceLoader&lt;Driver&gt; loadedDrivers = ServiceLoader.load(Driver.class); Iterator&lt;Driver&gt; driversIterator = loadedDrivers.iterator(); /* Load these drivers, so that they can be instantiated. * It may be the case that the driver class may not be there * i.e. there may be a packaged driver with the service class * as implementation of java.sql.Driver but the actual class * may be missing. In that case a java.util.ServiceConfigurationError * will be thrown at runtime by the VM trying to locate * and load the service. * * Adding a try catch block to catch those runtime errors * if driver not available in classpath but it's * packaged as service and that service is there in classpath. */ try&#123; while(driversIterator.hasNext()) &#123; driversIterator.next(); &#125; &#125; catch(Throwable t) &#123; // Do nothing &#125; return null; &#125; &#125;); println(\"DriverManager.initialize: jdbc.drivers = \" + drivers); if (drivers == null || drivers.equals(\"\")) &#123; return; &#125; String[] driversList = drivers.split(\":\"); println(\"number of Drivers:\" + driversList.length); for (String aDriver : driversList) &#123; try &#123; println(\"DriverManager.Initialize: loading \" + aDriver); Class.forName(aDriver, true, ClassLoader.getSystemClassLoader()); &#125; catch (Exception ex) &#123; println(\"DriverManager.Initialize: load failed: \" + ex); &#125; &#125; &#125;&#125; ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨DriverManager.getConnection() æ–¹æ³•è‡ªç„¶ä¼šè§¦å‘é™æ€ä»£ç å—çš„æ‰§è¡Œï¼Œå¼€å§‹åŠ è½½é©±åŠ¨ç„¶åæˆ‘ä»¬çœ‹ä¸‹ServiceLoader.load()çš„å…·ä½“å®ç°ï¼š 12345678public static &lt;S&gt; ServiceLoader&lt;S&gt; load(Class&lt;S&gt; service) &#123; // ä¸Šæ–‡ä»‹ç»ç±»åŠ è½½æºç æ—¶ï¼Œæ³¨é‡Šè¯´æ˜è¿‡è®¾ç½®AppClassLoaderä¸ºä¸Šä¸‹æ–‡åŠ è½½å™¨ ClassLoader cl = Thread.currentThread().getContextClassLoader(); return ServiceLoader.load(service, cl);&#125;public static &lt;S&gt; ServiceLoader&lt;S&gt; load(Class&lt;S&gt; service, ClassLoader loader)&#123; return new ServiceLoader&lt;&gt;(service, loader);&#125; ç»§ç»­å‘ä¸‹çœ‹æ„é€ å‡½æ•°å®ä¾‹åŒ– ServiceLoader åšäº†å“ªäº›äº‹æƒ…ï¼š 123456private ServiceLoader(Class&lt;S&gt; svc, ClassLoader cl) &#123; service = Objects.requireNonNull(svc, \"Service interface cannot be null\"); loader = (cl == null) ? ClassLoader.getSystemClassLoader() : cl; acc = (System.getSecurityManager() != null) ? AccessController.getContext() : null; reload();&#125; æŸ¥çœ‹ reload() å‡½æ•°ï¼š 1234public void reload() &#123; providers.clear(); lookupIterator = new LazyIterator(service, loader);&#125; ç»§ç»­æŸ¥çœ‹LazyIteratoræ„é€ å™¨ï¼Œè¯¥ç±»åŒæ ·å®ç°äº†Iteratoræ¥å£ï¼š 1234private LazyIterator(Class&lt;S&gt; service, ClassLoader loader) &#123; this.service = service; this.loader = loader;&#125; å®ä¾‹åŒ–åˆ°è¿™é‡Œæˆ‘ä»¬ä¹Ÿå°†ä¸Šä¸‹æ–‡å¾—åˆ°çš„ç±»åŠ è½½å™¨å®ä¾‹åŒ–åˆ°è¿™é‡Œï¼Œæ¥å›çœ‹ServiceLoader é‡å†™çš„ iterator() æ–¹æ³•ï¼š 12345678910111213141516171819202122232425public Iterator&lt;S&gt; iterator() &#123; return new Iterator&lt;S&gt;() &#123; Iterator&lt;Map.Entry&lt;String,S&gt;&gt; knownProviders = providers.entrySet().iterator(); public boolean hasNext() &#123; if (knownProviders.hasNext()) return true; return lookupIterator.hasNext(); &#125; // DriverManager ç±»ä¸­ driversIterator è°ƒç”¨çš„next() æ–¹æ³•å®é™…æ˜¯è¿™ä¸ªæ–¹æ³• public S next() &#123; if (knownProviders.hasNext()) return knownProviders.next().getValue(); return lookupIterator.next(); &#125; public void remove() &#123; throw new UnsupportedOperationException(); &#125; &#125;;&#125; ä¸Šé¢next() æ–¹æ³•è°ƒç”¨äº†lookupIterator.next()ï¼Œè¿™ä¸ªlookupIterator å°±æ˜¯åˆšåˆšå®ä¾‹åŒ–çš„ LazyIterator(); æ¥çœ‹nextæ–¹æ³• 12345678910public S next() &#123; if (acc == null) &#123; return nextService(); &#125; else &#123; PrivilegedAction&lt;S&gt; action = new PrivilegedAction&lt;S&gt;() &#123; public S run() &#123; return nextService(); &#125; &#125;; return AccessController.doPrivileged(action, acc); &#125;&#125; ç»§ç»­æŸ¥çœ‹nextService æ–¹æ³•ï¼š 1234567891011121314151617181920212223private S nextService() &#123; if (!hasNextService()) throw new NoSuchElementException(); String cn = nextName; nextName = null; Class&lt;?&gt; c = null; try &#123; c = Class.forName(cn, false, loader); &#125; catch (ClassNotFoundException x) &#123; fail(service, \"Provider \" + cn + \" not found\"); &#125; if (!service.isAssignableFrom(c)) &#123; fail(service, \"Provider \" + cn + \" not a subtype\"); &#125; try &#123; S p = service.cast(c.newInstance()); providers.put(cn, p); return p; &#125; catch (Throwable x) &#123; fail(service, \"Provider \" + cn + \" could not be instantiated\", x); &#125; throw new Error(); // This cannot happen&#125; ç»ˆäºåˆ°è¿™é‡Œäº†ï¼Œåœ¨ä¸Šé¢ nextServiceå‡½æ•°ä¸­ç¬¬8è¡Œè°ƒç”¨äº†c = Class.forName(cn, false, loader) æ–¹æ³•ï¼Œæˆ‘ä»¬æˆåŠŸçš„åšåˆ°äº†é€šè¿‡çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ‹¿åˆ°äº†åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆæˆ–è€…è‡ªå®šä¹‰çš„ç„¶åå¡åˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„ï¼‰ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹ŸæŸ¥æ‰¾åˆ°äº†å‚å•†åœ¨å­çº§çš„jaråŒ…ä¸­æ³¨å†Œçš„é©±åŠ¨å…·ä½“å®ç°ç±»åï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æˆåŠŸçš„åœ¨rt.jaråŒ…ä¸­çš„DriverManagerä¸­æˆåŠŸçš„åŠ è½½äº†æ”¾åœ¨ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºåŒ…ä¸­çš„ç±»äº†åŒæ—¶åœ¨ç¬¬16è¡Œå®ŒæˆDriverçš„å®ä¾‹åŒ–ï¼Œç­‰åŒäºnew Driver(); æ–‡ç« å¼€å¤´çš„é—®é¢˜åœ¨ç†è§£åˆ°è¿™é‡Œä¹Ÿè¿åˆƒè€Œè§£äº† JAVAçƒ­éƒ¨ç½²å®ç°é¦–å…ˆè°ˆä¸€ä¸‹ä½•ä¸ºçƒ­éƒ¨ç½²ï¼ˆhotswapï¼‰ï¼Œçƒ­éƒ¨ç½²æ˜¯åœ¨ä¸é‡å¯ Java è™šæ‹Ÿæœºçš„å‰æä¸‹ï¼Œèƒ½è‡ªåŠ¨ä¾¦æµ‹åˆ° class æ–‡ä»¶çš„å˜åŒ–ï¼Œæ›´æ–°è¿è¡Œæ—¶ class çš„è¡Œä¸ºã€‚Java ç±»æ˜¯é€šè¿‡ Java è™šæ‹ŸæœºåŠ è½½çš„ï¼ŒæŸä¸ªç±»çš„ class æ–‡ä»¶åœ¨è¢« classloader åŠ è½½åï¼Œä¼šç”Ÿæˆå¯¹åº”çš„ Class å¯¹è±¡ï¼Œä¹‹åå°±å¯ä»¥åˆ›å»ºè¯¥ç±»çš„å®ä¾‹ã€‚é»˜è®¤çš„è™šæ‹Ÿæœºè¡Œä¸ºåªä¼šåœ¨å¯åŠ¨æ—¶åŠ è½½ç±»ï¼Œå¦‚æœåæœŸæœ‰ä¸€ä¸ªç±»éœ€è¦æ›´æ–°çš„è¯ï¼Œå•çº¯æ›¿æ¢ç¼–è¯‘çš„ class æ–‡ä»¶ï¼ŒJava è™šæ‹Ÿæœºæ˜¯ä¸ä¼šæ›´æ–°æ­£åœ¨è¿è¡Œçš„ classã€‚å¦‚æœè¦å®ç°çƒ­éƒ¨ç½²ï¼Œæœ€æ ¹æœ¬çš„æ–¹å¼æ˜¯ä¿®æ”¹è™šæ‹Ÿæœºçš„æºä»£ç ï¼Œæ”¹å˜ classloader çš„åŠ è½½è¡Œä¸ºï¼Œä½¿è™šæ‹Ÿæœºèƒ½ç›‘å¬ class æ–‡ä»¶çš„æ›´æ–°ï¼Œé‡æ–°åŠ è½½ class æ–‡ä»¶ï¼Œè¿™æ ·çš„è¡Œä¸ºç ´åæ€§å¾ˆå¤§ï¼Œä¸ºåç»­çš„ JVM å‡çº§åŸ‹ä¸‹äº†ä¸€ä¸ªå¤§å‘ã€‚ å¦ä¸€ç§å‹å¥½çš„æ–¹æ³•æ˜¯åˆ›å»ºè‡ªå·±çš„ classloader æ¥åŠ è½½éœ€è¦ç›‘å¬çš„ classï¼Œè¿™æ ·å°±èƒ½æ§åˆ¶ç±»åŠ è½½çš„æ—¶æœºï¼Œä»è€Œå®ç°çƒ­éƒ¨ç½²ã€‚ çƒ­éƒ¨ç½²æ­¥éª¤ï¼š é”€æ¯è‡ªå®šä¹‰classloader(è¢«è¯¥åŠ è½½å™¨åŠ è½½çš„classä¹Ÿä¼šè‡ªåŠ¨å¸è½½)ï¼› æ›´æ–°class ä½¿ç”¨æ–°çš„ClassLoaderå»åŠ è½½class JVMä¸­çš„Classåªæœ‰æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼Œæ‰èƒ½è¢«GCå›æ”¶ï¼Œä¹Ÿå°±æ˜¯è¯¥Classè¢«å¸è½½ï¼ˆunloadï¼‰ï¼š è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«GCï¼Œä¹Ÿå°±æ˜¯JVMä¸­ä¸å­˜åœ¨è¯¥Classçš„ä»»ä½•å®ä¾‹ã€‚ åŠ è½½è¯¥ç±»çš„ClassLoaderå·²ç»è¢«GCã€‚ è¯¥ç±»çš„java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œå¦‚ä¸èƒ½åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³• è‡ªå®šä¹‰ç±»åŠ è½½å™¨è¦åˆ›å»ºç”¨æˆ·è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œåªéœ€è¦ç»§æ‰¿java.lang.ClassLoaderç±»ï¼Œç„¶åè¦†ç›–å®ƒçš„findClass(String name)æ–¹æ³•å³å¯ï¼Œå³æŒ‡æ˜å¦‚ä½•è·å–ç±»çš„å­—èŠ‚ç æµã€‚ å¦‚æœè¦ç¬¦åˆåŒäº²å§”æ´¾è§„èŒƒï¼Œåˆ™é‡å†™findClassæ–¹æ³•ï¼ˆç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½é€»è¾‘ï¼‰ï¼›è¦ç ´åçš„è¯ï¼Œé‡å†™loadClassæ–¹æ³•(åŒäº²å§”æ´¾çš„å…·ä½“é€»è¾‘å®ç°)ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859package classloader;import java.io.ByteArrayOutputStream;import java.io.File;import java.io.FileInputStream;import java.io.IOException;import java.io.InputStream;class TestClassLoad &#123; @Override public String toString() &#123; return \"ç±»åŠ è½½æˆåŠŸã€‚\"; &#125;&#125;public class PathClassLoader extends ClassLoader &#123; private String classPath; public PathClassLoader(String classPath) &#123; this.classPath = classPath; &#125; @Override protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException &#123; byte[] classData = getData(name); if (classData == null) &#123; throw new ClassNotFoundException(); &#125; else &#123; return defineClass(name, classData, 0, classData.length); &#125; &#125; private byte[] getData(String className) &#123; String path = classPath + File.separatorChar + className.replace('.', File.separatorChar) + \".class\"; try &#123; InputStream is = new FileInputStream(path); ByteArrayOutputStream stream = new ByteArrayOutputStream(); byte[] buffer = new byte[2048]; int num = 0; while ((num = is.read(buffer)) != -1) &#123; stream.write(buffer, 0, num); &#125; return stream.toByteArray(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; return null; &#125; public static void main(String args[]) throws ClassNotFoundException, InstantiationException, IllegalAccessException &#123; ClassLoader pcl = new PathClassLoader(\"D:\\\\ProgramFiles\\\\eclipseNew\\\\workspace\\\\cp-lib\\\\bin\"); Class c = pcl.loadClass(\"classloader.TestClassLoad\");//æ³¨æ„è¦åŒ…æ‹¬åŒ…å System.out.println(c.newInstance());//æ‰“å°ç±»åŠ è½½æˆåŠŸ. &#125;&#125; æ„Ÿè°¢ä¸å‚è€ƒéå¸¸æ„Ÿè°¢ä»¥ä¸‹åšæ–‡çš„ä½œè€…ï¼Œé€šè¿‡åå¤æ‹œè¯»æ¥äº†è§£åŒäº²å§”æ´¾æ¨¡å‹çš„åŸç† https://blog.csdn.net/u014634338/article/details/81434327 https://www.cnblogs.com/aspirant/p/7200523.html https://www.cnblogs.com/gdpuzxs/p/7044963.html https://www.jianshu.com/p/09f73af48a98 https://www.cnblogs.com/yahokuma/p/3668138.html","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"ClassLoader","slug":"ClassLoader","permalink":"https://dayarch.top/tags/ClassLoader/"},{"name":"çƒ­éƒ¨ç½²","slug":"çƒ­éƒ¨ç½²","permalink":"https://dayarch.top/tags/%E7%83%AD%E9%83%A8%E7%BD%B2/"}]},{"title":"PKIXè¯ä¹¦å¯¼å…¥","slug":"PKIXè¯ä¹¦å¯¼å…¥","date":"2019-04-12T03:55:47.000Z","updated":"2019-12-21T11:12:55.103Z","comments":true,"path":"/p/pkix-certificate-import.html","link":"","permalink":"https://dayarch.top/p/pkix-certificate-import.html","excerpt":"é€šè¿‡ç†è§£SSLæ¡æ‰‹è¿‡ç¨‹è§£å†³å®¢æˆ·ç«¯è¯ä¹¦é—®é¢˜æœ€è¿‘åšé¡¹ç›®ï¼Œè°ƒç”¨è¿œç¨‹æœåŠ¡å™¨çªç„¶å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š 1 PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target å¾ˆæ˜æ˜¾ï¼Œå®¢æˆ·ç«¯æ‰¾ä¸åˆ°æœåŠ¡å™¨ç«¯è¿”å›çš„public certificateï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‹¿åˆ°æœåŠ¡å™¨ç»™å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œå¹¶ä¸”å­˜æ”¾åˆ°Keystoreä¸­ï¼Œè¿™å°±æ¶‰åŠåˆ°SSLæ¡æ‰‹ï¼ˆhandshakeï¼‰è·å–ä¿¡ä»»çš„è¿‡ç¨‹ã€‚ å›¾è§£","text":"é€šè¿‡ç†è§£SSLæ¡æ‰‹è¿‡ç¨‹è§£å†³å®¢æˆ·ç«¯è¯ä¹¦é—®é¢˜ æœ€è¿‘åšé¡¹ç›®ï¼Œè°ƒç”¨è¿œç¨‹æœåŠ¡å™¨çªç„¶å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š 1PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target å¾ˆæ˜æ˜¾ï¼Œå®¢æˆ·ç«¯æ‰¾ä¸åˆ°æœåŠ¡å™¨ç«¯è¿”å›çš„public certificateï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‹¿åˆ°æœåŠ¡å™¨ç»™å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œå¹¶ä¸”å­˜æ”¾åˆ°Keystoreä¸­ï¼Œè¿™å°±æ¶‰åŠåˆ°SSLæ¡æ‰‹ï¼ˆhandshakeï¼‰è·å–ä¿¡ä»»çš„è¿‡ç¨‹ã€‚ å›¾è§£SSLï¼ˆSecure Socket Layerï¼‰åè®®å¼€å§‹åŠ å¯†é€šä¿¡ä¹‹å‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é¦–å…ˆå¿…é¡»å»ºç«‹è¿æ¥å’Œäº¤æ¢å‚æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšæ¡æ‰‹ï¼ˆhandshakeï¼‰ å®¢æˆ·ç«¯ç»™å‡ºåè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼ˆClient randomï¼‰ï¼Œä»¥åŠå®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†æ–¹æ³• æœåŠ¡ç«¯ç¡®è®¤åŒæ–¹ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ï¼Œå¹¶ç»™å‡ºæ•°å­—è¯ä¹¦ã€ä»¥åŠä¸€ä¸ªæœåŠ¡å™¨ç”Ÿæˆçš„éšæœºæ•°ï¼ˆServer randomï¼‰ å®¢æˆ·ç«¯ç¡®è®¤æ•°å­—è¯ä¹¦æœ‰æ•ˆï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„éšæœºæ•°ï¼ˆPremaster secretï¼‰ï¼Œå¹¶ä½¿ç”¨æ•°å­—è¯ä¹¦ä¸­çš„å…¬é’¥ï¼ŒåŠ å¯†è¿™ä¸ªéšæœºæ•°ï¼Œå‘ç»™æœåŠ¡ç«¯ æœåŠ¡ç«¯ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼Œè·å–çˆ±ä¸½ä¸å‘æ¥çš„éšæœºæ•°ï¼ˆå³Premaster secretï¼‰ å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ ¹æ®çº¦å®šçš„åŠ å¯†æ–¹æ³•ï¼Œä½¿ç”¨å‰é¢çš„ä¸‰ä¸ªéšæœºæ•°ï¼Œç”Ÿæˆâ€å¯¹è¯å¯†é’¥â€ï¼ˆsession keyï¼‰ï¼Œç”¨æ¥åŠ å¯†æ¥ä¸‹æ¥çš„æ•´ä¸ªå¯¹è¯è¿‡ç¨‹ ä»¥ä¸Šå°±æ˜¯æ¡æ‰‹çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå…¶ä¸­æ¡æ‰‹é˜¶æ®µæœ‰ä¸‰ç‚¹éœ€è¦æ³¨æ„ ç”Ÿæˆå¯¹è¯å¯†é’¥ä¸€å…±éœ€è¦ä¸‰ä¸ªéšæœºæ•°ã€‚ æ¡æ‰‹ä¹‹åçš„å¯¹è¯ä½¿ç”¨â€å¯¹è¯å¯†é’¥â€åŠ å¯†ï¼ˆå¯¹ç§°åŠ å¯†ï¼‰ï¼ŒæœåŠ¡å™¨çš„å…¬é’¥å’Œç§é’¥åªç”¨äºåŠ å¯†å’Œè§£å¯†â€å¯¹è¯å¯†é’¥â€ï¼ˆéå¯¹ç§°åŠ å¯†RSAï¼‰ï¼Œæ— å…¶ä»–ä½œç”¨ã€‚ æœåŠ¡å™¨å…¬é’¥æ”¾åœ¨æœåŠ¡å™¨çš„æ•°å­—è¯ä¹¦ä¹‹ä¸­ã€‚ SSLå…·ä½“æ¡æ‰‹è¿‡ç¨‹ç”¨-Djavax.net.debug=allæ¥å¼€å¯è°ƒè¯•ä¿¡æ¯çš„è¾“å‡ºï¼ŒSSLçš„æ¡æ‰‹è¿‡ç¨‹ä¸€ç›®äº†ç„¶ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174182018-02-01 17:05:24 --INFO-- ***Helper : https://xxx.xxx.com:8443/***/ws/***ServiceIgnoring unsupported cipher suite: TLS_DHE_DSS_WITH_AES_128_CBC_SHA256Ignoring unsupported cipher suite: TLS_DHE_DSS_WITH_AES_256_CBC_SHA256Ignoring unsupported cipher suite: TLS_DHE_RSA_WITH_AES_128_CBC_SHA256Ignoring unsupported cipher suite: TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256Ignoring unsupported cipher suite: TLS_DHE_RSA_WITH_AES_256_CBC_SHA256Ignoring unsupported cipher suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384Ignoring unsupported cipher suite: TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384Ignoring unsupported cipher suite: TLS_RSA_WITH_AES_256_CBC_SHA256Ignoring unsupported cipher suite: TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256Ignoring unsupported cipher suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384Ignoring unsupported cipher suite: TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384Ignoring unsupported cipher suite: TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256Ignoring unsupported cipher suite: TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256Ignoring unsupported cipher suite: TLS_RSA_WITH_AES_128_CBC_SHA256Allow unsafe renegotiation: falseAllow legacy hello messages: trueIs initial handshake: trueIs secure renegotiation: false%% Client cached [Session-5, TLS_RSA_WITH_AES_256_CBC_SHA]%% Try resuming [Session-5, TLS_RSA_WITH_AES_256_CBC_SHA] from port 12371##å®¢æˆ·ç«¯è·ŸæœåŠ¡å™¨ç¬¬ä¸€æ¬¡æ‰“æ‹›å‘¼##*** ClientHello, TLSv1RandomCookie: GMT: 1517410388 bytes = &#123; 95, 120, 132, 216, 69, 34, 205, 73, 133, 30, 240, 178, 37, 187, 228, 127, 73, 149, 1, 216, 19, 3, 35, 236, 29, 111, 125, 132 &#125;Session ID: &#123;248, 40, 73, 62, 46, 20, 43, 249, 49, 73, 148, 196, 222, 200, 202, 68, 221, 241, 33, 57, 128, 93, 149, 1, 7, 112, 248, 66, 173, 203, 187, 1&#125;##æ”¯æŒçš„åŠ å¯†ç®—æ³•##Cipher Suites: [TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA, TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA, TLS_ECDH_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_DSS_WITH_AES_256_CBC_SHA, TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_128_CBC_SHA, TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDH_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA, TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA, TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, TLS_ECDHE_RSA_WITH_RC4_128_SHA, SSL_RSA_WITH_RC4_128_SHA, TLS_ECDH_ECDSA_WITH_RC4_128_SHA, TLS_ECDH_RSA_WITH_RC4_128_SHA, SSL_RSA_WITH_RC4_128_MD5, TLS_EMPTY_RENEGOTIATION_INFO_SCSV]Compression Methods: &#123; 0 &#125;Extension elliptic_curves, curve names: &#123;secp256r1, sect163k1, sect163r2, secp192r1, secp224r1, sect233k1, sect233r1, sect283k1, sect283r1, secp384r1, sect409k1, sect409r1, secp521r1, sect571k1, sect571r1, secp160k1, secp160r1, secp160r2, sect163r1, secp192k1, sect193r1, sect193r2, secp224k1, sect239k1, secp256k1&#125;Extension ec_point_formats, formats: [uncompressed]Extension server_name, server_name: [host_name: idmtest.dcpc.com]***[write] MD5 and SHA1 hashes: len = 2200000: 01 00 00 D8 03 01 5A 72 D8 54 5F 78 84 D8 45 22 ......Zr.T_x..E\"0010: CD 49 85 1E F0 B2 25 BB E4 7F 49 95 01 D8 13 03 .I....%...I........DefaultQuartzScheduler_Worker-3, WRITE: TLSv1 Handshake, length = 220[Raw write]: length = 2250000: 16 03 01 00 DC 01 00 00 D8 03 01 5A 72 D8 54 5F ...........Zr.T_0010: 78 84 D8 45 22 CD 49 85 1E F0 B2 25 BB E4 7F 49 x..E\".I....%...I...[Raw read]: length = 50000: 16 03 01 06 22 ....\"[Raw read]: length = 15700000: 02 00 00 46 03 01 5A 72 63 4E F2 CF 4B 0F CE 58 ...F..ZrcN..K..X0010: 0E EF 36 D4 F3 3E C0 85 AD 6D 4B 8D DB CA FB 77 ..6..&gt;...mK....w0020: 80 B3 A1 D2 A7 90 20 D5 A6 FD 6E A7 FF 5A D4 DF ...... ...n..Z.....DefaultQuartzScheduler_Worker-3, READ: TLSv1 Handshake, length = 1570##æœåŠ¡å™¨å“åº”*** ServerHello, TLSv1RandomCookie: GMT: 1517445966 bytes = &#123; 242, 207, 75, 15, 206, 88, 14, 239, 54, 212, 243, 62, 192, 133, 173, 109, 75, 141, 219, 202, 251, 119, 128, 179, 161, 210, 167, 144 &#125;Session ID: &#123;213, 166, 253, 110, 167, 255, 90, 212, 223, 9, 221, 44, 82, 61, 249, 50, 79, 110, 177, 174, 106, 198, 101, 47, 213, 191, 119, 128, 106, 200, 188, 1&#125;##æœåŠ¡å™¨é€‰å®šçš„åŠ å¯†ç®—æ³•Cipher Suite: TLS_RSA_WITH_AES_256_CBC_SHACompression Method: 0***Warning: No renegotiation indication extension in ServerHello%% Initialized: [Session-8, TLS_RSA_WITH_AES_256_CBC_SHA]** TLS_RSA_WITH_AES_256_CBC_SHA[read] MD5 and SHA1 hashes: len = 740000: 02 00 00 46 03 01 5A 72 63 4E F2 CF 4B 0F CE 58 ...F..ZrcN..K..X0010: 0E EF 36 D4 F3 3E C0 85 AD 6D 4B 8D DB CA FB 77 ..6..&gt;...mK....w...##æœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„è¯ä¹¦é“¾,è¯æ˜â€œæˆ‘æ˜¯æˆ‘â€*** Certificate chainchain [0] = [[ Version: V3 Subject: CN=*.****.com, ST=åŒ—äº¬å¸‚, L=åŒ—äº¬å¸‚, O=***å…¬å¸, C=CN Signature Algorithm: SHA256withRSA, OID = 1.2.840.113549.1.1.11 Key: Sun RSA public key, 2048 bits modulus: 256891288892062675553247103925... public exponent: 65537 Validity: [From: Wed May 17 16:15:30 CST 2017, To: Fri May 15 16:15:30 CST 2020] Issuer: CN=WoSign OV SSL CA, O=WoSign CA Limited, C=CN SerialNumber: [ 363fa17d 5c46082c dc707c24 6a8d81b2]Certificate Extensions: 9[1]: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=falseAuthorityInfoAccess [[ accessMethod: ocsp accessLocation: URIName: http://wosign-ovca.ocsp-certum.com, accessMethod: caIssuers accessLocation: URIName: http://repository.certum.pl/wosign-ovca.cer]][2]: ObjectId: 2.5.29.35 Criticality=falseAuthorityKeyIdentifier [KeyIdentifier [0000: A1 13 54 DC 56 73 2C 27 82 CA C8 84 EF EE BF 00 ..T.Vs,'........0010: FD 5F AB 56 ._.V]][3]: ObjectId: 2.5.29.19 Criticality=trueBasicConstraints:[ CA:false PathLen: undefined][4]: ObjectId: 2.5.29.31 Criticality=falseCRLDistributionPoints [ [DistributionPoint: [URIName: http://wosign.crl.certum.pl/wosign-ovca.crl]]][5]: ObjectId: 2.5.29.32 Criticality=falseCertificatePolicies [ [CertificatePolicyId: [2.23.140.1.2.2][] ] [CertificatePolicyId: [1.2.616.1.113527.2.5.1.12.2][PolicyQualifierInfo: [ qualifierID: 1.3.6.1.5.5.7.2.2 qualifier:0000: 30 81 E4 30 1F 16 18 41 73 73 65 63 6F 20 44 61 0..0...Asseco Da0010: 74 61 20 53 79 73 74 65 6D 73 20 53 2E 41 2E 30 ta Systems S.A.0...]] ]][6]: ObjectId: 2.5.29.37 Criticality=falseExtendedKeyUsages [ serverAuth clientAuth][7]: ObjectId: 2.5.29.15 Criticality=trueKeyUsage [ DigitalSignature Key_Encipherment][8]: ObjectId: 2.5.29.17 Criticality=falseSubjectAlternativeName [ DNSName: *.dcpc.com DNSName: dcpc.com][9]: ObjectId: 2.5.29.14 Criticality=falseSubjectKeyIdentifier [KeyIdentifier [0000: B3 A6 53 AD 96 D8 B7 51 09 D5 E1 07 E5 B2 BC E6 ..S....Q........0010: B5 F2 82 2B ...+]]] Algorithm: [SHA256withRSA] Signature:0000: 9A 38 A4 8F B2 A8 CE 9A B6 98 2F 8F 18 AA 45 79 .8......../...Ey0010: DE D6 31 22 99 6E D7 14 45 5E C1 1F 06 EC 7F C9 ..1\".n..E^.........]***==å®¢æˆ·ç«¯ä»æœ¬åœ°æ‰¾åˆ°çš„ä¿¡èµ–è¯ä¹¦(å¦‚æœæ‰¾ä¸åˆ°ä¼šç›´æ¥æŠ¥certificate_unknow)==Found trusted certificate:[[ Version: V3 Subject: CN=*.****.com, ST=åŒ—äº¬å¸‚, L=åŒ—äº¬å¸‚, O=****å…¬å¸, C=CN Signature Algorithm: SHA256withRSA, OID = 1.2.840.113549.1.1.11 Key: Sun RSA public key, 2048 bits modulus: 2568912888920626755532471039254124.... public exponent: 65537 Validity: [From: Wed May 17 16:15:30 CST 2017, To: Fri May 15 16:15:30 CST 2020] Issuer: CN=WoSign OV SSL CA, O=WoSign CA Limited, C=CN SerialNumber: [ 363fa17d 5c46082c dc707c24 6a8d81b2]Certificate Extensions: 9[1]: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=falseAuthorityInfoAccess [ [ accessMethod: ocsp accessLocation: URIName: http://wosign-ovca.ocsp-certum.com, accessMethod: caIssuers accessLocation: URIName: http://repository.certum.pl/wosign-ovca.cer]][2]: ObjectId: 2.5.29.35 Criticality=falseAuthorityKeyIdentifier [KeyIdentifier [0000: A1 13 54 DC 56 73 2C 27 82 CA C8 84 EF EE BF 00 ..T.Vs,'........0010: FD 5F AB 56 ._.V]][3]: ObjectId: 2.5.29.19 Criticality=trueBasicConstraints:[ CA:false PathLen: undefined][4]: ObjectId: 2.5.29.31 Criticality=falseCRLDistributionPoints [ [DistributionPoint: [URIName: http://wosign.crl.certum.pl/wosign-ovca.crl]]][5]: ObjectId: 2.5.29.32 Criticality=falseCertificatePolicies [ [CertificatePolicyId: [2.23.140.1.2.2][] ] [CertificatePolicyId: [1.2.616.1.113527.2.5.1.12.2][PolicyQualifierInfo: [ qualifierID: 1.3.6.1.5.5.7.2.2 qualifier:0000: 30 81 E4 30 1F 16 18 41 73 73 65 63 6F 20 44 61 0..0...Asseco Da0010: 74 61 20 53 79 73 74 65 6D 73 20 53 2E 41 2E 30 ta Systems S.A.0...]] ]][6]: ObjectId: 2.5.29.37 Criticality=falseExtendedKeyUsages [ serverAuth clientAuth][7]: ObjectId: 2.5.29.15 Criticality=trueKeyUsage [ DigitalSignature Key_Encipherment][8]: ObjectId: 2.5.29.17 Criticality=falseSubjectAlternativeName [ DNSName: *.dcpc.com DNSName: dcpc.com][9]: ObjectId: 2.5.29.14 Criticality=falseSubjectKeyIdentifier [KeyIdentifier [0000: B3 A6 53 AD 96 D8 B7 51 09 D5 E1 07 E5 B2 BC E6 ..S....Q........0010: B5 F2 82 2B ...+]]] Algorithm: [SHA256withRSA] Signature:0000: 9A 38 A4 8F B2 A8 CE 9A B6 98 2F 8F 18 AA 45 79 .8......../...Ey0010: DE D6 31 22 99 6E D7 14 45 5E C1 1F 06 EC 7F C9 ..1\".n..E^.........][read] MD5 and SHA1 hashes: len = 14920000: 0B 00 05 D0 00 05 CD 00 05 CA 30 82 05 C6 30 82 ..........0...0.0010: 04 AE A0 03 02 01 02 02 10 36 3F A1 7D 5C 46 08 .........6?..\\F....*** ServerHelloDone[read] MD5 and SHA1 hashes: len = 40000: 0E 00 00 00 ....*** ClientKeyExchange, RSA PreMasterSecret, TLSv1[write] MD5 and SHA1 hashes: len = 2620000: 10 00 01 02 01 00 85 BD 72 17 92 EA 05 0F 0A BD ........r.......0010: 90 92 72 51 08 0F 6E 29 C4 A2 F0 D2 BA 78 0B A0 ..rQ..n).....x.....DefaultQuartzScheduler_Worker-3, WRITE: TLSv1 Handshake, length = 262[Raw write]: length = 2670000: 16 03 01 01 06 10 00 01 02 01 00 85 BD 72 17 92 .............r..0010: EA 05 0F 0A BD 90 92 72 51 08 0F 6E 29 C4 A2 F0 .......rQ..n)......SESSION KEYGEN:PreMaster Secret:0000: 03 01 80 92 4B 03 FA 1D 39 CE F4 82 3D 4A 96 A7 ....K...9...=J.....CONNECTION KEYGEN:Client Nonce:0000: 5A 72 D8 54 5F 78 84 D8 45 22 CD 49 85 1E F0 B2 Zr.T_x..E\".I.......Server Nonce:0000: 5A 72 63 4E F2 CF 4B 0F CE 58 0E EF 36 D4 F3 3E ZrcN..K..X..6..&gt;...Master Secret:0000: 93 05 C4 97 B7 FB 23 5F 11 15 8A 8E 2C C1 C7 72 ......#_....,..r...Client MAC write Secret:0000: 22 84 BA CD 61 27 D9 62 5F 84 FA 7A DF 05 DE 0A \"...a'.b_..z.......Server MAC write Secret:0000: D2 AC 73 AC CE F2 D2 00 31 E6 4F 8A DE E3 97 8D ..s.....1.O.....0010: 73 52 BA D2 sR..Client write key:0000: CA FB B2 02 E7 3F 79 93 55 61 CB AB FF EF 1E 76 .....?y.Ua.....v0010: 10 4C DD DE 83 55 99 6F 28 8E 19 5D 18 25 33 A2 .L...U.o(..].%3.Server write key:0000: 1A 25 31 69 D2 3B 45 D7 70 09 5F 9A FF D5 B3 71 .%1i.;E.p._....q0010: 73 9D D6 52 F0 10 21 8B 8E 13 97 BE B1 02 75 46 s..R..!.......uFClient write IV:0000: 68 49 14 C3 A2 97 75 A0 F3 AC 89 DA 31 84 C3 EF hI....u.....1...Server write IV:0000: 2C 03 9D 28 6F C2 7D BD 37 B1 AA E5 30 6E 09 EA ,..(o...7...0n..DefaultQuartzScheduler_Worker-3, WRITE: TLSv1 Change Cipher Spec, length = 1[Raw write]: length = 60000: 14 03 01 00 01 01 ......*** Finishedverify_data: &#123; 56, 169, 160, 43, 198, 100, 229, 140, 160, 251, 76, 146 &#125;***[write] MD5 and SHA1 hashes: len = 160000: 14 00 00 0C 38 A9 A0 2B C6 64 E5 8C A0 FB 4C 92 ....8..+.d....L.Padded plaintext before ENCRYPTION: len = 480000: 14 00 00 0C 38 A9 A0 2B C6 64 E5 8C A0 FB 4C 92 ....8..+.d....L.0010: F5 B1 BB DE F4 25 ED A2 3A 18 9D C8 8E EE 2B A6 .....%..:.....+.0020: 4A 1E 3A C7 0B 0B 0B 0B 0B 0B 0B 0B 0B 0B 0B 0B J.:.............DefaultQuartzScheduler_Worker-3, WRITE: TLSv1 Handshake, length = 48[Raw write]: length = 530000: 16 03 01 00 30 4E 92 1F 3A 1F 91 C8 1B 9F 6B 3A ....0N..:.....k:0010: CC 2C 67 2C 9D CA 58 DA 4F 91 21 01 8E D8 5A 37 .,g,..X.O.!...Z70020: 67 B8 BD A9 E4 F3 79 E9 9C E6 E1 52 BB 8D 39 0E g.....y....R..9.0030: 45 5F F5 7E 7A E_..z[Raw read]: length = 50000: 14 03 01 00 01 .....[Raw read]: length = 10000: 01 .DefaultQuartzScheduler_Worker-3, READ: TLSv1 Change Cipher Spec, length = 1[Raw read]: length = 50000: 16 03 01 00 30 ....0[Raw read]: length = 480000: A9 B4 AB 6C 68 BA 47 DB CF 6E EF 8A F2 6F BD 73 ...lh.G..n...o.s0010: E4 44 55 C8 93 1B 4B C6 D9 A3 DB 4D 03 3B E0 8D .DU...K....M.;..0020: 67 ED E8 35 CA 63 D8 F8 C8 11 40 1B 54 DD 6F F2 g..5.c....@.T.o.DefaultQuartzScheduler_Worker-3, READ: TLSv1 Handshake, length = 48Padded plaintext after DECRYPTION: len = 480000: 14 00 00 0C 58 5A F4 F0 FA C9 BE 1D 27 6A A5 3A ....XZ......'j.:0010: DC 90 D1 52 C8 53 16 DD CB 04 E9 F0 F7 46 E2 9F ...R.S.......F..0020: 9E A6 EF 63 0B 0B 0B 0B 0B 0B 0B 0B 0B 0B 0B 0B ...c............*** Finishedverify_data: &#123; 88, 90, 244, 240, 250, 201, 190, 29, 39, 106, 165, 58 &#125;***%% Cached client session: [Session-8, TLS_RSA_WITH_AES_256_CBC_SHA][read] MD5 and SHA1 hashes: len = 160000: 14 00 00 0C 58 5A F4 F0 FA C9 BE 1D 27 6A A5 3A ....XZ......'j.:DefaultQuartzScheduler_Worker-3, setSoTimeout(9000000) calledPadded plaintext before ENCRYPTION: len = 960##å‘é€æ•°æ®0000: 50 4F 53 54 20 2F 69 64 6D 2F 77 73 2F 55 6E 69 POST /idm/ws/Uni0010: 74 53 65 72 76 69 63 65 20 48 54 54 50 2F 31 2E tService HTTP/1.0020: 30 0D 0A 43 6F 6E 74 65 6E 74 2D 54 79 70 65 3A 0..Content-Type:0030: 20 74 65 78 74 2F 78 6D 6C 3B 20 63 68 61 72 73 text/xml; chars0040: 65 74 3D 75 74 66 2D 38 0D 0A 41 63 63 65 70 74 et=utf-8..Accept0050: 3A 20 61 70 70 6C 69 63 61 74 69 6F 6E 2F 73 6F : application/so0060: 61 70 2B 78 6D 6C 2C 20 61 70 70 6C 69 63 61 74 ap+xml, applicat0070: 69 6F 6E 2F 64 69 6D 65 2C 20 6D 75 6C 74 69 70 ion/dime, multip0080: 61 72 74 2F 72 65 6C 61 74 65 64 2C 20 74 65 78 art/related, tex0090: 74 2F 2A 0D 0A 55 73 65 72 2D 41 67 65 6E 74 3A t/*..User-Agent:00A0: 20 41 78 69 73 2F 31 2E 34 0D 0A 48 6F 73 74 3A Axis/1.4..Host:00B0: 20 69 64 6D 74 65 73 74 2E 64 63 70 63 2E 63 6F ***.***.co00C0: 6D 3A 38 34 34 33 0D 0A 43 61 63 68 65 2D 43 6F m:8443..Cache-Co...DefaultQuartzScheduler_Worker-3, WRITE: TLSv1 Application Data, length = 960[Raw write]: length = 9650000: 17 03 01 03 C0 76 73 C9 5C 37 18 B3 8D 85 B6 4A .....vs.\\7.....J0010: A5 FF 06 E0 81 74 E2 46 22 C7 32 12 51 A6 C4 10 .....t.F\".2.Q...0020: 7E 1D 14 C6 1E 1B 44 95 57 6E AC 83 AA 8D A7 92 ......D.Wn......0030: 4C 34 01 5D E9 A1 1E 8C BB 03 55 D9 7A 09 0F 1E L4.]......U.z...0040: 5D C4 71 46 CA 29 72 0D C1 CC F8 CE 6E F9 51 3A ].qF.)r.....n.Q:...[Raw read]: length = 50000: 17 03 01 01 60 ....`[Raw read]: length = 3520000: CD C2 06 A2 9F EA 9F 00 C7 27 5E F0 B3 C4 3D 78 .........'^...=x0010: 2E 9B F4 52 08 FF D7 05 2E A8 1B 42 3F 9A 3D 73 ...R.......B?.=s...DefaultQuartzScheduler_Worker-3, READ: TLSv1 Application Data, length = 352##æ¥æ”¶æ•°æ®Padded plaintext after DECRYPTION: len = 3520000: 48 54 54 50 2F 31 2E 31 20 32 30 30 20 0D 0A 43 HTTP/1.1 200 ..C0010: 6F 6E 74 65 6E 74 2D 54 79 70 65 3A 20 74 65 78 ontent-Type: tex0020: 74 2F 78 6D 6C 3B 63 68 61 72 73 65 74 3D 55 54 t/xml;charset=UT0030: 46 2D 38 0D 0A 44 61 74 65 3A 20 54 68 75 2C 20 F-8..Date: Thu,0040: 30 31 20 46 65 62 20 32 30 31 38 20 30 39 3A 30 01 Feb 2018 09:00050: 35 3A 32 35 20 47 4D 54 0D 0A 43 6F 6E 6E 65 63 5:25 GMT..Connec0060: 74 69 6F 6E 3A 20 63 6C 6F 73 65 0D 0A 0D 0A 3C tion: close....&lt;0070: 73 6F 61 70 3A 45 6E 76 65 6C 6F 70 65 20 78 6D soap:Envelope xm0080: 6C 6E 73 3A 73 6F 61 70 3D 22 68 74 74 70 3A 2F lns:soap=\"http:/0090: 2F 73 63 68 65 6D 61 73 2E 78 6D 6C 73 6F 61 70 /schemas.xmlsoap00A0: 2E 6F 72 67 2F 73 6F 61 70 2F 65 6E 76 65 6C 6F .org/soap/envelo...[Raw read]: length = 50000: 15 03 01 00 20 ....[Raw read]: length = 320000: 10 E4 3E EF D9 D6 A2 0F F3 11 85 6F 8F 68 48 C8 ..&gt;........o.hH.0010: 26 73 2E C8 FA 9D 00 03 AB 3B 79 46 DE ED CC 40 &amp;s.......;yF...@DefaultQuartzScheduler_Worker-3, READ: TLSv1 Alert, length = 32Padded plaintext after DECRYPTION: len = 320000: 01 00 C2 40 0A 51 E1 F1 28 06 65 73 E4 84 81 01 ...@.Q..(.es....0010: 8F A9 A1 FD A9 6E 09 09 09 09 09 09 09 09 09 09 .....n..........DefaultQuartzScheduler_Worker-3, RECV TLSv1 ALERT: warning, close_notifyDefaultQuartzScheduler_Worker-3, called closeInternal(false)DefaultQuartzScheduler_Worker-3, SEND TLSv1 ALERT: warning, description = close_notifyPadded plaintext before ENCRYPTION: len = 320000: 01 00 4F BB 75 8C 9C 8A 12 64 D7 62 F6 AF 81 90 ..O.u....d.b....0010: 92 0E 91 25 6F 9B 09 09 09 09 09 09 09 09 09 09 ...%o...........DefaultQuartzScheduler_Worker-3, WRITE: TLSv1 Alert, length = 32[Raw write]: length = 370000: 15 03 01 00 20 C1 60 66 8A 2A 1D A5 6C 82 C3 59 .... .`f.*..l..Y0010: A8 D5 E9 28 70 1D 93 F1 DD 34 00 14 1F 56 12 46 ...(p....4...V.F0020: 33 0C 4C 3F 51 3.L?QDefaultQuartzScheduler_Worker-3, called closeSocket(selfInitiated)DefaultQuartzScheduler_Worker-3, called close()DefaultQuartzScheduler_Worker-3, called closeInternal(true)DefaultQuartzScheduler_Worker-3, called close()DefaultQuartzScheduler_Worker-3, called closeInternal(true) è¯ä¹¦è¯†åˆ«Javaç¨‹åºå¯¹å—ä¿¡è¯ä¹¦çš„æŸ¥æ‰¾é¡ºåºæ˜¯ï¼š javax.net.ssl.trustStore å°±æ˜¯System.setProperty(â€œjavax.net.ssl.trustStoreâ€,â€D:\\cacert.keystoreâ€);æˆ–è€…é€šè¿‡JVMå‚æ•°æŒ‡å®šï¼š-Djavax.net.ssl.trustStore=D:\\cacert.keystoreã€‚ JAVA_HOME\\jre\\lib\\security\\jssecacerts ã€æ¨èã€‘ é»˜è®¤æ²¡æœ‰jssecacertsï¼Œä¸€èˆ¬æŠŠcacertså¤åˆ¶æˆjssecacertsï¼Œç„¶åå†ä½¿ç”¨keytoolæ¥ä¿®æ”¹å®ƒã€‚jsseçš„å…¨ç§°æ˜¯Java Secure Socket Extensionã€‚ JAVA_HOME\\jre\\lib\\security\\cacerts é€šå¸¸æƒ…å†µä¸‹ä¸å°±å»ºè®®é€šè¿‡-Djavax.net.ssl.trustStore=D:\\cacert.keystoreæ¥ç›´æ¥ä¿®æ”¹keystoreæ–‡ä»¶çš„ä½ç½®ï¼Œå› ä¸ºè¿™æ ·ä¼šé€ æˆç³»ç»Ÿä¸­å…¶ä»–æ¨¡å—å¯èƒ½æ‰¾ä¸åˆ°è‡ªå·±å¯¹åº”çš„è¯ä¹¦äº†ã€‚æ¨èä½¿ç”¨jssecacertsã€‚æˆ‘ä»¬éœ€è¦ä»€ä¹ˆè¯ä¹¦ç›´æ¥å¾€è¿™ä¸ªä½ç½®å¯¼å°±è¡Œäº†ã€‚ç¨‹åºä¸éœ€è¦åšè°ƒæ•´ã€‚ Springboot ç¨‹åºå®ç°æˆ‘ä»¬å¸Œæœ›åœ¨Springbootåº”ç”¨æ¯æ¬¡å¯åŠ¨åéƒ½å‘æœåŠ¡å™¨è¯·æ±‚è¯ä¹¦ï¼Œå¹¶å°†è¯ä¹¦æ›´æ–°åˆ°Keystoreä¸­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203@ConditionalOnProperty(value = &quot;cert.installation&quot;, havingValue = &quot;true&quot;)@ConfigurationProperties(&quot;cert&quot;)@Configurationpublic class InstallCert implements CommandLineRunner &#123; private static Logger logger = LoggerFactory.getLogger(InstallCert.class); /** * ç”Ÿæˆçš„è¯ä¹¦éœ€è¦å­˜æ”¾çš„securityè·¯å¾„ï¼Œå³ï¼š %JAVA_HOME%\\jre\\lib\\security */ private String path; /** * éœ€è¦SSLè®¤è¯çš„åŸŸå */ private List&lt;String&gt; domains = new ArrayList&lt;&gt;(); private String password = &quot;changeit&quot;; public String getPath() &#123; return path; &#125; public void setPath(String path) &#123; this.path = path; &#125; public List&lt;String&gt; getDomains() &#123; return domains; &#125; public void setDomains(List&lt;String&gt; domains) &#123; this.domains = domains; &#125; public String getPassword() &#123; return password; &#125; public void setPassword(String password) &#123; this.password = password; &#125; @Override public void run(String... strings) throws Exception &#123; logger.info(&quot;ready to install valid certs&quot;); if (!Collections.isEmpty(domains))&#123; logger.info(&quot;domains is &#123;&#125;&quot;, domains.toString()); String[] arrayStr = new String[domains.size()]; installValidCerts(domains.toArray(arrayStr)); &#125; &#125; private void installValidCerts(String[] args) throws Exception &#123; logger.info(&quot;Usage: java InstallCert &lt;host&gt;[:port] [passphrase]&quot;); char[] passphrase = password.toCharArray(); String certPath = path; if (Strings.isNullOrEmpty(path))&#123; char separator = File.separatorChar; certPath = System.getProperty(&quot;java.home&quot;) + separator + &quot;lib&quot; + separator + &quot;security&quot;; &#125; File dir = new File(certPath);// File file = new File(&quot;jssecacerts&quot;);// if (file.isFile() == false) &#123;// char SEP = File.separatorChar;// File dir = new File(System.getProperty(&quot;java.home&quot;) + SEP + &quot;lib&quot; + SEP + &quot;security&quot;);// file = new File(dir, &quot;jssecacerts&quot;);// if (file.isFile() == false) &#123;// file = new File(dir, &quot;cacerts&quot;);// &#125; KeyStore ks = KeyStore.getInstance(KeyStore.getDefaultType()); InputStream in = null; logger.info(&quot;jre security dir path: &#123;&#125;&quot;, dir.getCanonicalPath()); File file = new File(dir, &quot;jssecacerts&quot;); if (!file.exists() &amp;&amp; !file.isFile())&#123; file.createNewFile(); File file1 = new File(dir, &quot;cacerts&quot;); if (!file1.isFile())&#123; logger.info(&quot;no certs will be registered, casue no cacerts file was found&quot;); return; &#125; in = new FileInputStream(file1); ks.load(in, passphrase); logger.info(&quot;file jssecacerts is created successfully&quot;); &#125;else &#123; in = new FileInputStream(file); ks.load(in, passphrase); logger.info(&quot;file jssecacerts is existing, will not create again&quot;); &#125; IOUtils.closeQuietly(in); logger.info(&quot;Loading KeyStore &quot; + file + &quot;...&quot;); SSLContext context = SSLContext.getInstance(&quot;TLS&quot;); TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm()); tmf.init(ks); X509TrustManager defaultTrustManager = (X509TrustManager) tmf.getTrustManagers()[0]; SavingTrustManager tm = new SavingTrustManager(defaultTrustManager); context.init(null, new TrustManager[] &#123; tm &#125;, null); SSLSocketFactory factory = context.getSocketFactory(); OutputStream out = new FileOutputStream(file); for (String domain: args)&#123; logger.info(&quot;domain is &#123;&#125;&quot;, domain); String[] c = args[0].split(&quot;:&quot;); String host = c[0]; int port = (c.length == 1) ? 443 : Integer.parseInt(c[1]); logger.info(&quot;Opening connection to &quot; + host + &quot;:&quot; + port + &quot;...&quot;); SSLSocket socket = (SSLSocket) factory.createSocket(host, port); socket.setSoTimeout(10000); try &#123; logger.info(&quot;Starting SSL handshake...&quot;); socket.startHandshake(); socket.close(); logger.info(&quot;No errors, certificate is already trusted&quot;); &#125; catch (SSLException e) &#123; e.printStackTrace(System.out); &#125; X509Certificate[] chain = tm.chain; if (chain == null) &#123; logger.info(&quot;Could not obtain server certificate chain, continue next one&quot;); continue; &#125; logger.info(&quot;Server sent &quot; + chain.length + &quot; certificate(s):&quot;); MessageDigest sha1 = MessageDigest.getInstance(&quot;SHA1&quot;); MessageDigest md5 = MessageDigest.getInstance(&quot;MD5&quot;); for (int i = 0; i &lt; chain.length; i++) &#123; X509Certificate cert = chain[i]; logger.info(&quot; &quot; + (i + 1) + &quot; Subject &quot; + cert.getSubjectDN()); logger.info(&quot; Issuer &quot; + cert.getIssuerDN()); sha1.update(cert.getEncoded()); logger.info(&quot; sha1 &quot; + toHexString(sha1.digest())); md5.update(cert.getEncoded()); logger.info(&quot; md5 &quot; + toHexString(md5.digest())); &#125; int k=0; X509Certificate cert = chain[k]; String alias = host + &quot;-&quot; + (k + 1); ks.setCertificateEntry(alias, cert); ks.store(out, passphrase); logger.info(cert.toString()); logger.info(&quot;Added &#123;&#125; certificate to keystore &apos;jssecacerts&apos; using alias &#123;&#125;&quot;, domain, alias); &#125; IOUtils.closeQuietly(out); &#125; private static final char[] HEXDIGITS = &quot;0123456789abcdef&quot;.toCharArray(); private static String toHexString(byte[] bytes) &#123; StringBuilder sb = new StringBuilder(bytes.length * 3); for (int b : bytes) &#123; b &amp;= 0xff; sb.append(HEXDIGITS[b &gt;&gt; 4]); sb.append(HEXDIGITS[b &amp; 15]); sb.append(&apos; &apos;); &#125; return sb.toString(); &#125; private static class SavingTrustManager implements X509TrustManager &#123; private final X509TrustManager tm; private X509Certificate[] chain; SavingTrustManager(X509TrustManager tm) &#123; this.tm = tm; &#125; @Override public X509Certificate[] getAcceptedIssuers() &#123; throw new UnsupportedOperationException(); &#125; @Override public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException &#123; throw new UnsupportedOperationException(); &#125; @Override public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException &#123; this.chain = chain; tm.checkServerTrusted(chain, authType); &#125; &#125;&#125; æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦åœ¨YAMLï¼ˆapplicaton.ymlï¼‰ä¸­é…ç½®è¦ç”³è¯·æ¡æ‰‹çš„æœåŠ¡å™¨å°±å¥½ 12345cert: installation: true domains: - bidxxxxxxx.xxxxxxxxxxxxxx.com - suppxxxxxx.xxxxx.com è‡³æ­¤ï¼Œå°±ä¸ä¼šå‡ºç°è¯ä¹¦æ‰¾ä¸åˆ°çš„é—®é¢˜äº† å‚è€ƒ https://www.cnblogs.com/huqiaoblog/p/8398009.html http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html https://blog.csdn.net/catoop/article/details/80819638","categories":[],"tags":[{"name":"SSL","slug":"SSL","permalink":"https://dayarch.top/tags/SSL/"}]},{"title":"Arthasè°ƒæ•´logæ—¥å¿—ç­‰çº§","slug":"Arthasè°ƒæ•´logæ—¥å¿—ç­‰çº§","date":"2019-04-09T05:39:37.000Z","updated":"2019-11-07T05:14:40.445Z","comments":true,"path":"/p/arthas-log-level.html","link":"","permalink":"https://dayarch.top/p/arthas-log-level.html","excerpt":"é˜¿é‡Œçš„å¼€æºJavaè¯Šæ–­å·¥å…·Arthaså¯ä»¥åœ¨çº¿è°ƒæ•´logç­‰çº§ 1. æŸ¥æ‰¾å½“å‰ç±»çš„classloader hashcode 1 sc -d com.example.demo.arthas.user.UserController | grep classLoaderHash 2. ç”¨OGNLè·å–logger 1 ognl -c 1be6f5c3 '@com.example.demo.arthas.user.UserController@logger' 3. å•ç‹¬è®¾ç½®UserControllerçš„logger level 1 ognl -c 1be6f5c3 '@c","text":"é˜¿é‡Œçš„å¼€æºJavaè¯Šæ–­å·¥å…·Arthaså¯ä»¥åœ¨çº¿è°ƒæ•´logç­‰çº§ æŸ¥æ‰¾å½“å‰ç±»çš„classloader hashcode 1sc -d com.example.demo.arthas.user.UserController | grep classLoaderHash ç”¨OGNLè·å–logger 1ognl -c 1be6f5c3 '@com.example.demo.arthas.user.UserController@logger' å•ç‹¬è®¾ç½®UserControllerçš„logger level 1ognl -c 1be6f5c3 '@com.example.demo.arthas.user.UserController@logger.setLevel(@ch.qos.logback.classic.Level@DEBUG)' å…¨å±€è®¾ç½®logger level 1ognl -c 1be6f5c3 '@org.slf4j.LoggerFactory@getLogger(\"root\").setLevel(@ch.qos.logback.classic.Level@DEBUG)'","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Arthas","slug":"Coding/Arthas","permalink":"https://dayarch.top/categories/Coding/Arthas/"}],"tags":[{"name":"Arthas","slug":"Arthas","permalink":"https://dayarch.top/tags/Arthas/"}]},{"title":"Springbootå»æ‰@RequestBodyä¸­å­—ç¬¦ä¸²ç±»å‹å€¼çš„å‰åç©ºæ ¼","slug":"Springbootå»æ‰-RequestBodyä¸­å­—ç¬¦ä¸²ç±»å‹å€¼çš„å‰åç©ºæ ¼","date":"2018-07-12T08:06:17.000Z","updated":"2019-11-01T08:56:36.962Z","comments":true,"path":"/p/spring-boot-request-body-space.html","link":"","permalink":"https://dayarch.top/p/spring-boot-request-body-space.html","excerpt":"æ”¹é€ MappingJackson2HttpMessageConverterå‰è¨€ é¡¹ç›®ç»„æå‡ºè¦æ±‚ï¼ŒSpringbooté¡¹ç›®ä¸­ï¼Œ@ResquestBodyæ ‡è®°çš„beanä¼ å…¥çš„å­—ç¬¦ä¸²ç±»å‹çš„å€¼è¦å»æ‰å‰åç©ºæ ¼ å®ç° å› ä¸ºé¡¹ç›®é»˜è®¤ä½¿ç”¨ MappingJackson2HttpMessageConverter ä½œä¸º Jsonè½¬æ¢å™¨ï¼Œ äºæ˜¯ä¹é‡å†™ä¸€äº›æ–¹æ³•åšæ–‡ç« ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42","text":"æ”¹é€ MappingJackson2HttpMessageConverter å‰è¨€é¡¹ç›®ç»„æå‡ºè¦æ±‚ï¼ŒSpringbooté¡¹ç›®ä¸­ï¼Œ@ResquestBodyæ ‡è®°çš„beanä¼ å…¥çš„å­—ç¬¦ä¸²ç±»å‹çš„å€¼è¦å»æ‰å‰åç©ºæ ¼ å®ç°å› ä¸ºé¡¹ç›®é»˜è®¤ä½¿ç”¨ MappingJackson2HttpMessageConverter ä½œä¸º Jsonè½¬æ¢å™¨ï¼Œ äºæ˜¯ä¹é‡å†™ä¸€äº›æ–¹æ³•åšæ–‡ç« ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@EnableWebMvc@Configurationpublic class WebConfig implements WebMvcConfigurer&#123; //... çœç•¥é‡å†™çš„å…¶ä»–æ–¹æ³• @Override public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123; super.configureMessageConverters(converters); //å¯¹åº”æ— æ³•ç›´æ¥è¿”å›Stringç±»å‹ converters.add(0, new MappingJackson2HttpMessageConverter()&#123; @Override public ObjectMapper getObjectMapper() &#123; super.getObjectMapper().setSerializationInclusion(JsonInclude.Include.NON_NULL); return super.getObjectMapper(); &#125; /** * é‡å†™readæ–¹æ³•ï¼Œç„¶ååšå»æ‰å‰åç©ºæ ¼å¤„ç†ï¼Œé‡æ–°è½¬æ¢æˆobject * @param type * @param contextClass * @param inputMessage * @return * @throws IOException * @throws HttpMessageNotReadableException */ @Override public Object read(Type type, Class&lt;?&gt; contextClass, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123; Object object = super.read(type, contextClass, inputMessage); String json = JSONObject.toJSONString(object); Map&lt;String,Object&gt; map = (Map&lt;String, Object&gt;) JSONObject.parse(json); Set&lt;Map.Entry&lt;String, Object&gt;&gt; entrySet = map.entrySet(); Map&lt;String, Object&gt; removeSpaceMap = Maps.newHashMap(); for (Map.Entry&lt;String, Object&gt; entry : entrySet)&#123; if (entry.getValue() instanceof String)&#123; removeSpaceMap.put(entry.getKey(), ((String) entry.getValue()).trim()); &#125;else &#123; removeSpaceMap.put(entry.getKey(),entry.getValue()); &#125; &#125; Gson gson = new Gson(); String removeSpaceJson = JSON.toJSONString(removeSpaceMap); return gson.fromJson(removeSpaceJson, type); &#125; &#125;); &#125;&#125; ä½†æ˜¯ä¸Šé¢çš„ä»£ç ç»è¿‡å„ç§æµ‹è¯•å‘ç°ä¸€ä¸ªé—®é¢˜ï¼ŒGsonåœ¨å¤„ç†Integerï¼ŒLongéæµ®ç‚¹å‹çš„æ•°å€¼ç±»å‹æ—¶å€™ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºDoubleæ¥å¤„ç†ï¼Œè¿™å¯¼è‡´åç»­ä»£ç åšä¸€äº›æ•°æ®è½¬æ¢çš„æ—¶å€™ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºGsonå†…éƒ¨åœ¨å¤„ç†æ•°æ®ç±»å‹éƒ½å½“æˆNumberç±»å‹ï¼Œå¯ä»¥è¯»ä¸€ä¸‹æºç ï¼Œè¿™æ ·éœ€è¦åšå¦‚ä¸‹çš„æ”¹åŠ¨ï¼š 1234567891011121314151617181920212223242526272829303132/** * * @param type * @param contextClass * @param inputMessage * @return * @throws IOException * @throws HttpMessageNotReadableException */@Overridepublic Object read(Type type, Class&lt;?&gt; contextClass, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123; Object object = super.read(type, contextClass, inputMessage); String json = JSONObject.toJSONString(object); Map&lt;String,Object&gt; map = (Map&lt;String, Object&gt;) JSONObject.parse(json); Set&lt;Map.Entry&lt;String, Object&gt;&gt; entrySet = map.entrySet(); Map&lt;String, Object&gt; removeSpaceMap = Maps.newHashMap(); for (Map.Entry&lt;String, Object&gt; entry : entrySet)&#123; if (entry.getValue() instanceof String)&#123; removeSpaceMap.put(entry.getKey(), ((String) entry.getValue()).trim()); &#125;else &#123; removeSpaceMap.put(entry.getKey(),entry.getValue()); &#125; &#125; String removeSpaceJson = JSON.toJSONString(removeSpaceMap); return JSONObject.parseObject(removeSpaceJson, type); //æ³¨é‡Šæ‰Gsonï¼Œè½¬æ¢é»˜è®¤å°†Integerï¼ŒLongç­‰è½¬æ¢æˆDoubleï¼Œå†…éƒ¨å¤„ç†çœ‹ä½œNumber /*Gson gson = new Gson(); return gson.fromJson(removeSpaceJson, type);*/&#125; ä»¥ä¸ºè¿™æ ·å°±ç»“æŸäº†å—ï¼Ÿå“ˆå“ˆï¼Œæ²¡æœ‰â€¦ ğŸ˜’ ä»¥ä¸Šæˆ‘ä»¬ä¼ å…¥çš„éƒ½æ˜¯æ­£å¸¸çš„JsonObjectï¼Œæ¯”å¦‚è¿™ç§æ ¼å¼çš„æ•°æ® 1234567891011121314151617181920212223242526&#123; \"commonName\":\"test2\", \"ver\":1, \"certificateRootType\":\"Z200\", \"expiredDate\":\"2118-01-01\", \"certificateName\":\"ç¨åŠ¡ç™»è®°è¯ ã€‚\", \"commonCode\":\"suibian\", \"updateTime\":\"2018-07-12 13:09:14\", \"perpetual\":2, \"certificateNo\":\"11111111\", \"certificateTypeName\":\"ç¨åŠ¡ç™»è®°è¯\", \"imgInfoVOList\":[ &#123; \"url\":\"https://www.a.b.c/a.jpg\" &#125;, &#123; \"url\":\"https://www.a.b.c/b.jpg\" &#125; ], \"producerType\":1, \"createTime\":\"2018-07-12 13:09:14\", \"supplier\":1043, \"id\":5016, \"startDate\":\"2018-01-01\", \"certificateType\":\"Z202\"&#125; ä½†æ˜¯è¦æœ‰è¿™ç§æ ¼å¼çš„æ•°æ® 1234567891011121314[ &#123; \"roleId\":212, \"name\":\"ä¸Šå¸è§†è§’\" &#125;, &#123; \"roleId\":212, \"name\":\"ä¸Šå¸è§†è§’\" &#125;, &#123; \"roleId\":212, \"name\":\"ä¸Šå¸è§†è§’\" &#125;] å¦‚æœæ˜¯ä¸‹é¢è¿™ç§æ ¼å¼çš„ï¼Œæˆ‘ä»¬è§£æçš„æ—¶å€™å°±ä¼šæŠ¥è½¬æ¢é”™è¯¯ï¼Œæ‰€ä»¥é’ˆå¯¹ä¸‹é¢JsonArrayç±»å‹çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦åšç‰¹æ®Šå¤„ç†ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354/** * * @param type * @param contextClass * @param inputMessage * @return * @throws IOException * @throws HttpMessageNotReadableException */@SuppressWarnings(\"unchecked\")@Overridepublic Object read(Type type, Class&lt;?&gt; contextClass, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123; Object object = super.read(type, contextClass, inputMessage); String json = JSONObject.toJSONString(object); String jsonResult = null; if (json.startsWith(\"[\"))&#123; JSONArray jsonArray = JSONArray.parseArray(json); if (jsonArray != null &amp;&amp; !jsonArray.isEmpty())&#123; List&lt;Map&lt;String, Object&gt;&gt; result = Lists.newArrayList(); for (int i=0; i&lt;jsonArray.size(); i++)&#123; Map&lt;String, Object&gt; map = (Map&lt;String, Object&gt;) jsonArray.get(i); Map&lt;String, Object&gt; removeSpaceMap = removeSpace(map); result.add(removeSpaceMap); &#125; jsonResult = JSON.toJSONString(result); &#125; &#125;else &#123; Map&lt;String,Object&gt; map = (Map&lt;String, Object&gt;) JSONObject.parse(json); Map&lt;String, Object&gt; removeSpaceMap = removeSpace(map); jsonResult = JSON.toJSONString(removeSpaceMap); &#125; //æ³¨é‡Šæ‰Gsonï¼Œè½¬æ¢é»˜è®¤å°†Integerï¼ŒLongç­‰è½¬æ¢æˆDoubleï¼Œå†…éƒ¨å¤„ç†çœ‹ä½œNumber /*Gson gson = new Gson(); return gson.fromJson(removeSpaceJson, type);*/ return JSONObject.parseObject(jsonResult, type);&#125;private Map&lt;String, Object&gt; removeSpace(Map&lt;String, Object&gt; map)&#123; Set&lt;Map.Entry&lt;String, Object&gt;&gt; entrySet = map.entrySet(); Map&lt;String, Object&gt; removeSpaceMap = Maps.newHashMap(); for (Map.Entry&lt;String, Object&gt; entry : entrySet)&#123; if (entry.getValue() instanceof String)&#123; removeSpaceMap.put(entry.getKey(), ((String) entry.getValue()).trim()); &#125;else &#123; removeSpaceMap.put(entry.getKey(),entry.getValue()); &#125; &#125; return removeSpaceMap;&#125; è¿™æ ·å°±åº”å¯¹å¤§å¤šæ•°é—®é¢˜äº† æ¥ä¸‹æ¥éœ€è¦å…·ä½“äº†è§£ä¸€ä¸‹ï¼Œæ„å»ºè¿‡ç¨‹ï¼Œå¦‚ä¸Šå›¾ï¼Œåœ¨HttpInputMessage é€šè¿‡ converter è½¬æ¢æˆObjectå¯¹è±¡ä¹‹å‰åšå¤„ç†ï¼Œè¿™æ ·åœ¨Controlleræ¥æ”¶çš„æ—¶å€™å°±å¯ä»¥æ‹¿åˆ°å¤„ç†åçš„å¯¹è±¡äº†","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Json","slug":"Json","permalink":"https://dayarch.top/tags/Json/"},{"name":"Springboot","slug":"Springboot","permalink":"https://dayarch.top/tags/Springboot/"}]},{"title":"Javaå®ç°æ–‡ä»¶ä¸‹è½½å¹¶å‹ç¼©æˆzipæ–‡ä»¶","slug":"Javaå®ç°æ–‡ä»¶ä¸‹è½½å¹¶å‹ç¼©æˆzipæ–‡ä»¶","date":"2018-07-04T05:48:44.000Z","updated":"2019-11-07T05:42:07.256Z","comments":true,"path":"/p/java-download-file-zip.html","link":"","permalink":"https://dayarch.top/p/java-download-file-zip.html","excerpt":"IOæµï¼Œç½‘ç»œç¼–ç¨‹çš„åŸºç¡€èƒŒæ™¯ æœ€è¿‘åœ¨åšSpringbootåˆ†å¸ƒå¼å¾®æœåŠ¡é¡¹ç›®ï¼Œç”¨åˆ°äº†æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ–‡ä»¶ä¸Šä¼ æ˜¯æ—¢æœ‰çš„åŠŸèƒ½ï¼Œå°†æ–‡ä»¶æˆ–å›¾ç‰‡ä¸Šä¼ åˆ°S3æœåŠ¡å™¨ä¸Šï¼Œå°†ç”Ÿæˆçš„æ–‡ä»¶URLåœ°å€å’Œæˆªå–çš„æ–‡ä»¶åå­˜å‚¨åˆ°DBä¸­ï¼Œæ­£å¸¸æˆ‘ä»¬åªéœ€è¦ç»™å‰ç«¯URLï¼Œé€šè¿‡æµè§ˆå™¨å°±å¯ä»¥å®ç°æ–‡ä»¶çš„ä¸‹è½½äº†ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å°†æ–‡ä»¶ä¸Šä¼ åˆ°S3æœåŠ¡å™¨ä¹‹å‰æ˜¯å°†æ–‡ä»¶åç§°è¿›è¡Œè½¬ç çš„ï¼Œå¦‚ï¼šæ–‡ä»¶test.docxä¸Šä¼ åˆ°S3æœåŠ¡å™¨ä¹‹åçš„URLåœ°å€æ˜¯ï¼š http://www.S3.xxx.com/files/abRsdf.docx, è¿™æ ·æˆ‘ä»¬ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶æ–‡ä»¶åå°±æ˜¯ abRsdf.docx, æ˜¾ç„¶è¿™æ˜¯ä¸ç¬¦åˆæˆ‘ä»¬è¦æ±‚çš„ï¼Œä¸‹è½½çš„æ–‡ä»¶ååº”è¯¥æ˜¯test.docx, å¹¶ä¸”éœ€","text":"IOæµï¼Œç½‘ç»œç¼–ç¨‹çš„åŸºç¡€ èƒŒæ™¯æœ€è¿‘åœ¨åšSpringbootåˆ†å¸ƒå¼å¾®æœåŠ¡é¡¹ç›®ï¼Œç”¨åˆ°äº†æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Œæ–‡ä»¶ä¸Šä¼ æ˜¯æ—¢æœ‰çš„åŠŸèƒ½ï¼Œå°†æ–‡ä»¶æˆ–å›¾ç‰‡ä¸Šä¼ åˆ°S3æœåŠ¡å™¨ä¸Šï¼Œå°†ç”Ÿæˆçš„æ–‡ä»¶URLåœ°å€å’Œæˆªå–çš„æ–‡ä»¶åå­˜å‚¨åˆ°DBä¸­ï¼Œæ­£å¸¸æˆ‘ä»¬åªéœ€è¦ç»™å‰ç«¯URLï¼Œé€šè¿‡æµè§ˆå™¨å°±å¯ä»¥å®ç°æ–‡ä»¶çš„ä¸‹è½½äº†ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å°†æ–‡ä»¶ä¸Šä¼ åˆ°S3æœåŠ¡å™¨ä¹‹å‰æ˜¯å°†æ–‡ä»¶åç§°è¿›è¡Œè½¬ç çš„ï¼Œå¦‚ï¼šæ–‡ä»¶test.docxä¸Šä¼ åˆ°S3æœåŠ¡å™¨ä¹‹åçš„URLåœ°å€æ˜¯ï¼š http://www.S3.xxx.com/files/abRsdf.docx, è¿™æ ·æˆ‘ä»¬ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶æ–‡ä»¶åå°±æ˜¯ abRsdf.docx, æ˜¾ç„¶è¿™æ˜¯ä¸ç¬¦åˆæˆ‘ä»¬è¦æ±‚çš„ï¼Œä¸‹è½½çš„æ–‡ä»¶ååº”è¯¥æ˜¯test.docx, å¹¶ä¸”éœ€è¦å¤šä¸ªæ–‡ä»¶å‹ç¼©æˆzipæ–‡ä»¶æ‰“åŒ…ä¸‹è½½. æ‰€ä»¥éœ€è¦åœ¨responseä¸­åšä¸€äº›æ–‡ç« ï¼Œä¿®æ”¹æ–‡ä»¶åï¼Œä»¥åŠåšå¤šæ–‡ä»¶çš„å‹ç¼©ã€‚ å®ç°å› ä¸ºDBä¸­å­˜å‚¨äº†æ–‡ä»¶çš„URLå’Œæ–‡ä»¶åç§°ï¼Œå¤§æ¦‚æ•°æ®å½¢å¼å¦‚ä¸‹ï¼š åºå· url name 1 http://www.S3.xxx.com/files/abRsdf.docx test.docx 2 http://www.S3.xxx.com/files/lsdTew.docx test1.docx å°è£…DBæ•°æ®å°†DBä¸­çš„urlå’Œnameæ•°æ®å°è£…åˆ°ç±»å‹ä¸ºDownloadVO.javaä¸­ï¼ŒDownloadVO.javaçš„ä»£ç å¾ˆç®€å•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319import com.google.common.base.Strings;import com.viewhigh.epro.mall.vo.base.DownloadVO;import io.jsonwebtoken.lang.Collections;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.*;import java.net.HttpURLConnection;import java.net.MalformedURLException;import java.net.URL;import java.util.ArrayList;import java.util.List;import java.util.UUID;import java.util.zip.ZipEntry;import java.util.zip.ZipOutputStream;public class DownloadUtil &#123; private final static Logger LOG = LoggerFactory.getLogger(DownloadUtil.class); /** * ä¸‹è½½å•ä¸ªæ–‡ä»¶ * @param downloadVO * @param request * @param response * @throws IOException */ public static void toDownloadFile(DownloadVO downloadVO, HttpServletRequest request, HttpServletResponse response)throws IOException &#123; String savePath = request.getServletContext().getRealPath(new StringBuffer(File.separator).append(\"attachment\").append(File.separator).toString()); LOG.info(\"The Path where file will storage is &#123;&#125;\", savePath); downloadFile(getFile(downloadVO, savePath), request, response, true); &#125; /** * åœ¨æœåŠ¡å™¨ç”Ÿæˆæ–‡ä»¶ * @param downloadVO * @param savePath * @return * @throws IOException */ public static File getFile(DownloadVO downloadVO, String savePath) throws IOException&#123; InputStream inputStream = null; FileOutputStream fileOutputStream = null; try &#123; URL url = new URL(downloadVO.getUrl()); HttpURLConnection conn = (HttpURLConnection)url.openConnection(); // åˆ›å»ºè¿æ¥å®ä¾‹ conn.setConnectTimeout(3*1000); //è®¾ç½®è¶…æ—¶é—´ä¸º3ç§’ conn.setRequestProperty(\"User-Agent\", \"Mozilla/4.0 (compatible; MSIE 5.0; Windows NT; DigExt)\"); //é˜²æ­¢å±è”½ç¨‹åºæŠ“å–è€Œè¿”å›403é”™è¯¯ conn.setRequestProperty(\"Charset\", \"UTF-8\"); inputStream = conn.getInputStream(); //è·å–è¿æ¥è¾“å…¥æµ byte[] getData = readInputStream(inputStream); //è·å–å­—èŠ‚æ•°ç»„ File saveDir = new File(savePath); // åˆ›å»ºæ–‡ä»¶å­˜æ”¾è·¯å¾„ if (!saveDir.exists())&#123; saveDir.mkdir(); &#125; File file = new File(savePath, downloadVO.getName()); // åœ¨æ–°å»ºè·¯å¾„ä¸‹åˆ›å»ºå¯¹åº”é™„ä»¶åç§°çš„æ–‡ä»¶ fileOutputStream = new FileOutputStream(file); fileOutputStream.write(getData); return file; &#125; catch (MalformedURLException e) &#123; throw e; &#125; catch (IOException e) &#123; throw e; &#125;finally &#123; // å…³é—­æµ if(fileOutputStream!=null)&#123; fileOutputStream.close(); &#125; if(inputStream!=null)&#123; inputStream.close(); &#125; &#125; &#125; /** * ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶å‹ç¼©æˆzip * @param downloadVOS å¾…ä¸‹è½½çš„æ–‡ä»¶ä¿¡æ¯ * @param request Servletè¯·æ±‚ * @param response Servletç›¸åº” * @param zipName å¾…ç”Ÿæˆçš„zipæ–‡ä»¶åæˆ * @throws IOException * @throws ServletException */ public static void toDownloadFiles(List&lt;DownloadVO&gt; downloadVOS, HttpServletRequest request, HttpServletResponse response, String zipName)throws IOException, ServletException &#123; if (!Collections.isEmpty(downloadVOS))&#123; LOG.info(\"The total of Attachment is &#123;&#125;\" , downloadVOS.size()); String savePath = request.getServletContext().getRealPath(new StringBuffer(File.separator).append(\"attachment\").append(File.separator).toString()); LOG.info(\"The Path where file will storage is &#123;&#125;\", savePath); List&lt;File&gt; files = new ArrayList&lt;File&gt;(downloadVOS.size()); /** * å¤„ç†åŒåæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä»¥ a.txt, a(1).txt, a(2).txt */ Map&lt;String, Integer&gt; map = Maps.newHashMap(); for (DownloadVO downloadVO : downloadVOS)&#123; String fileName = downloadVO.getName(); if (map.containsKey(fileName))&#123; map.put(fileName, map.get(fileName) + 1); &#125;else &#123; map.put(fileName, 0); &#125; if (map.get(fileName) != 0)&#123; int position = fileName.lastIndexOf(\".\"); downloadVO.setName(new StringBuffer(fileName.substring(0, position)).append(\"(\").append(map.get(fileName)).append(\")\").append(fileName.substring(position, fileName.length())).toString()); &#125; File file = getFile(downloadVO, savePath); files.add(file); &#125; // ç”Ÿæˆzipæ–‡ä»¶ File fileZip = generateZipFile(files, savePath, zipName); // ä¸‹è½½zipæ–‡ä»¶ downloadFile(fileZip, request, response, true); // åˆ é™¤æºæ–‡ä»¶ deleteSourceFile(files); &#125; &#125; private static void deleteSourceFile(List&lt;File&gt; files) &#123; if (!Collections.isEmpty(files))&#123; files.forEach(File::delete); &#125; &#125; /** * ä»è¾“å…¥æµä¸­è·å–å­—èŠ‚æ•°ç»„ï¼Œæ ¹æ® available è·å–ä¸€æ¬¡æ€§è¯»å–çš„å­—èŠ‚æ•°é‡ * @param inputStream * @return * @throws IOException */ public static byte[] readInputStream(InputStream inputStream) throws IOException &#123; int count = 0; while (count == 0) &#123; count = inputStream.available(); &#125; byte[] buffer = new byte[count]; int len = 0; ByteArrayOutputStream bos = new ByteArrayOutputStream(); while((len = inputStream.read(buffer)) != -1) &#123; bos.write(buffer, 0, len); &#125; LOG.info(\"current file length is &#123;&#125;\", len); bos.close(); return bos.toByteArray(); &#125; /** * ç”Ÿæˆzipæ–‡ä»¶ * @param files * @param savePath * @param zipName * @return */ public static File generateZipFile(List&lt;File&gt; files, String savePath, String zipName) throws IOException, ServletException &#123; String zipFileName = zipName; if (Strings.isNullOrEmpty(zipFileName))&#123; zipFileName = UUID.randomUUID().toString(); &#125; zipFileName = zipFileName + \".zip\"; File fileZip = new File(savePath, zipFileName ); FileOutputStream fileOutputStream = null; // æ–‡ä»¶è¾“å‡ºæµ ZipOutputStream zipOutputStream = null; // å‹ç¼©æµ try &#123; fileOutputStream = new FileOutputStream(fileZip); zipOutputStream = new ZipOutputStream(fileOutputStream); zipFile(files, zipOutputStream); &#125; catch (FileNotFoundException e) &#123; throw e; &#125;finally &#123; if (zipOutputStream != null)&#123; zipOutputStream.close(); &#125; if (fileOutputStream != null)&#123; fileOutputStream.close(); &#125; &#125; return fileZip; &#125; /** * å‹ç¼©æ–‡ä»¶ * @param files * @param outputStream * @throws IOException * @throws ServletException */ public static void zipFile(List&lt;File&gt; files, ZipOutputStream outputStream) throws IOException, ServletException &#123; try &#123; int size = files.size(); // å‹ç¼©åˆ—è¡¨ä¸­çš„æ–‡ä»¶ for (int i = 0; i &lt; size; i++) &#123; File file = (File) files.get(i); zipFile(file, outputStream); &#125; &#125; catch (IOException e) &#123; throw e; &#125; &#125; public static void zipFile(File inputFile, ZipOutputStream outputstream) throws IOException, ServletException &#123; FileInputStream inStream = null; BufferedInputStream bInStream = null; try &#123; if (inputFile.exists()) &#123; if (inputFile.isFile()) &#123; inStream = new FileInputStream(inputFile); bInStream = new BufferedInputStream(inStream); ZipEntry entry = new ZipEntry(inputFile.getName()); outputstream.putNextEntry(entry); final int MAX_BYTE = 10 * 1024 * 1024; // æœ€å¤§çš„æµä¸º10M long streamTotal = 0; // æ¥å—æµçš„å®¹é‡ int streamNum = 0; // æµéœ€è¦åˆ†å¼€çš„æ•°é‡ int leaveByte = 0; // æ–‡ä»¶å‰©ä¸‹çš„å­—ç¬¦æ•° byte[] inOutbyte; // byteæ•°ç»„æ¥å—æ–‡ä»¶çš„æ•°æ® streamTotal = bInStream.available(); // é€šè¿‡availableæ–¹æ³•å–å¾—æµçš„æœ€å¤§å­—ç¬¦æ•° streamNum = (int) Math.floor(streamTotal / MAX_BYTE); // å–å¾—æµæ–‡ä»¶éœ€è¦åˆ†å¼€çš„æ•°é‡ leaveByte = (int) streamTotal % MAX_BYTE; // åˆ†å¼€æ–‡ä»¶ä¹‹å,å‰©ä½™çš„æ•°é‡ if (streamNum &gt; 0) &#123; for (int j = 0; j &lt; streamNum; ++j) &#123; inOutbyte = new byte[MAX_BYTE]; // è¯»å…¥æµ,ä¿å­˜åœ¨byteæ•°ç»„ bInStream.read(inOutbyte, 0, MAX_BYTE); outputstream.write(inOutbyte, 0, MAX_BYTE); // å†™å‡ºæµ &#125; &#125; // å†™å‡ºå‰©ä¸‹çš„æµæ•°æ® inOutbyte = new byte[leaveByte]; bInStream.read(inOutbyte, 0, leaveByte); outputstream.write(inOutbyte); outputstream.closeEntry(); // Closes the current ZIP entry // and positions the stream for // writing the next entry &#125; &#125; else &#123; throw new ServletException(\"æ–‡ä»¶ä¸å­˜åœ¨ï¼\"); &#125; &#125; catch (IOException e) &#123; throw e; &#125;finally &#123; if (bInStream != null)&#123; bInStream.close(); // å…³é—­ &#125; if (inStream != null)&#123; inStream.close(); &#125; &#125; &#125; /** * ä¸‹è½½zipæ–‡ä»¶ * @param file * @param response * @param isDelete */ public static void downloadFile(File file,HttpServletRequest request , HttpServletResponse response,boolean isDelete) throws IOException &#123; BufferedInputStream bufferedInputStream = null; OutputStream outputStream = null; try &#123; bufferedInputStream = new BufferedInputStream(new FileInputStream(file.getPath())); byte[] buffer = new byte[bufferedInputStream.available()]; bufferedInputStream.read(buffer); response.reset(); // æ¸…ç©ºresponse outputStream = new BufferedOutputStream(response.getOutputStream()); response.setContentType(\"application/octet-stream\"); LOG.info(\"fileName:\" + file.getName()); String userAgent = request.getHeader(\"User-Agent\"); String formFileName = file.getName(); // é’ˆå¯¹IEæˆ–è€…ä»¥IEä¸ºå†…æ ¸çš„æµè§ˆå™¨ï¼š if (userAgent.contains(\"MSIE\") || userAgent.contains(\"Trident\") || userAgent.contains(\"Edge\")) &#123; formFileName = java.net.URLEncoder.encode(formFileName, \"UTF-8\"); &#125; else &#123; // éIEæµè§ˆå™¨çš„å¤„ç†ï¼š formFileName = new String(formFileName.getBytes(\"UTF-8\"), \"ISO-8859-1\"); &#125; response.setHeader(\"Content-Disposition\", \"attachment;filename=\" + formFileName); outputStream.write(buffer); outputStream.flush(); //æ˜¯å¦å°†ç”Ÿæˆçš„æœåŠ¡å™¨ç«¯æ–‡ä»¶åˆ é™¤ if(isDelete)&#123; file.delete(); &#125; &#125; catch (IOException ex) &#123; throw ex; &#125;finally &#123; if (bufferedInputStream != null)&#123; bufferedInputStream.close(); &#125; if (outputStream != null)&#123; outputStream.close(); &#125; &#125; &#125;&#125; servletè·¯å¾„é—®é¢˜ä¸Šé¢çš„ä»£ç å°†æ–‡ä»¶ä¸‹è½½åˆ°äº†servletçš„realPathä¸­ï¼Œé¡ºä¾¿æ€»ç»“ä¸€ä¸‹å„ç§è·¯å¾„çš„å·®åˆ« è¯·æ±‚è·¯å¾„çš„URL http://localhost:8080/electest/system/elecMenuAction_menuHome.do 12345678System.out.println(\"contentType------\"+request.getContentType());System.out.println(\"requestcontextPath------\"+request.getContextPath());System.out.println(\"servletPath----\"+request.getServletPath());System.out.println(\"requestRealPath\"+request.getRealPath(\"\"));System.out.println(\"realPath------\"+request.getServletContext().getRealPath(\"\"));System.out.println(\"requestURI------\"+request.getRequestURI());System.out.println(\"requestURL-------\"+request.getRequestURL());System.out.println(\"contextPath-------\"+request.getServletContext().getContextPath()); æ‰“å°ç»“æœ 12345678contentType------application/x-www-form-urlencodedrequestcontextPath------/electestservletPath----/system/elecMenuAction_menuHome.dorequestRealPathD:\\tomcate\\apache-tomcat-7.0.63-windows-x64\\apache-tomcat-7.0.63\\webapps\\electestrealPath------D:\\tomcate\\apache-tomcat-7.0.63-windows-x64\\apache-tomcat-7.0.63\\webapps\\electestrequestURI------/electest/system/elecMenuAction_menuHome.dorequestURL-------http://localhost:8080/electest/system/elecMenuAction_menuHome.docontextPath---------/electest æ–¹æ³•å’Œä»£ç çš„æ³¨é‡Šå†™çš„å·²ç»å¾ˆè¯¦ç»†äº†ï¼Œå…·ä½“çš„å®ç°å°±ä¸å†è¯¦è¿°äº†","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"IO","slug":"IO","permalink":"https://dayarch.top/tags/IO/"}]},{"title":"Springboot Jsonæ ¼å¼æ•°æ®ä¸è¿”å›nullå€¼å±æ€§","slug":"Springboot-Jsonæ ¼å¼æ•°æ®ä¸è¿”å›nullå€¼å±æ€§","date":"2018-07-02T05:41:37.000Z","updated":"2019-11-07T06:21:40.625Z","comments":true,"path":"/p/spring-boot-json-return-non-null.html","link":"","permalink":"https://dayarch.top/p/spring-boot-json-return-non-null.html","excerpt":"Spring ResponseBody without null fieldé€šå¸¸Restfulè¿”å›çš„Jsonæ ¼å¼æ•°æ®ï¼Œé‡Œé¢åŒ…å«å¾ˆå¤šä¸ºç©ºå€¼nullçš„å­—æ®µï¼Œæˆ‘ä»¬æ²¡å¿…è¦å°†è¿™äº›å­—æ®µè¿”å›ç»™å‰ç«¯ï¼Œåº”è¯¥ç»™å‡ºæ›´å¤šçš„æœ‰æ•ˆå­—æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨Converter Messageçš„æ—¶å€™å°†è¿™äº›nullå€¼å­—æ®µç»™è¿‡æ»¤æ‰ æ–¹æ³•ä¸€ æ·»åŠ  @JsonInclude(JsonInclude.Include.NON_NULL) æ³¨è§£ è¯¥æ–¹æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰å¤ªå¤šçš„è¿”å›ç±»å‹ï¼Œä¸€ä¸€æ·»åŠ ä¹Ÿæ˜¯å¾ˆå¤§çš„å·¥ä½œé‡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è½¬æ¢çš„æºå¤´è¿›è¡Œæ§åˆ¶ æ–¹æ³•äºŒ å®ç° WebMvcConfigurer æ¥å£ï¼Œæ·»åŠ  @EnableWebMvc å’Œ @Co","text":"Spring ResponseBody without null field é€šå¸¸Restfulè¿”å›çš„Jsonæ ¼å¼æ•°æ®ï¼Œé‡Œé¢åŒ…å«å¾ˆå¤šä¸ºç©ºå€¼nullçš„å­—æ®µï¼Œæˆ‘ä»¬æ²¡å¿…è¦å°†è¿™äº›å­—æ®µè¿”å›ç»™å‰ç«¯ï¼Œåº”è¯¥ç»™å‡ºæ›´å¤šçš„æœ‰æ•ˆå­—æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨Converter Messageçš„æ—¶å€™å°†è¿™äº›nullå€¼å­—æ®µç»™è¿‡æ»¤æ‰ æ–¹æ³•ä¸€æ·»åŠ  @JsonInclude(JsonInclude.Include.NON_NULL) æ³¨è§£è¯¥æ–¹æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰å¤ªå¤šçš„è¿”å›ç±»å‹ï¼Œä¸€ä¸€æ·»åŠ ä¹Ÿæ˜¯å¾ˆå¤§çš„å·¥ä½œé‡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è½¬æ¢çš„æºå¤´è¿›è¡Œæ§åˆ¶ æ–¹æ³•äºŒå®ç° WebMvcConfigurer æ¥å£ï¼Œæ·»åŠ  @EnableWebMvc å’Œ @Configuration æ³¨è§£ï¼Œç„¶åé‡å†™ MappingJackson2HttpMessageConverter ä¸­ getObjectMapper() æ–¹æ³• 123456789101112131415161718@EnableWebMvc@Configurationpublic class WebConfig implements WebMvcConfigurer&#123; //... çœç•¥é‡å†™çš„å…¶ä»–æ–¹æ³• @Override public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123; super.configureMessageConverters(converters); //å¯¹åº”æ— æ³•ç›´æ¥è¿”å›Stringç±»å‹ converters.add(0, new MappingJackson2HttpMessageConverter()&#123; @Override public ObjectMapper getObjectMapper() &#123; super.getObjectMapper().setSerializationInclusion(JsonInclude.Include.NON_NULL); return super.getObjectMapper(); &#125; &#125;); &#125;&#125; è¿™æ ·æ‰€æœ‰çš„nullå€¼éƒ½ä¼šè¢«è¿‡æ»¤æ‰ï¼Œæ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯ JsonInclude.Include.NON_NULLï¼Œ Jsonä¸­çš„æŸä¸ªé›†åˆå¦‚æœä¸ºç©ºè¿˜æ˜¯ä¼šè¿”å›ç©ºæ•°ç»„ï¼Œæˆ‘ä»¬å¸Œæœ›æŠŠè¿™æ ·çš„æ•°æ®ä¹Ÿè¿‡æ»¤æ‰ï¼Œåªéœ€è¦å°†JsonInclude.Include.NON_NULL ä¿®æ”¹ä¸º JsonInclude.Include.NON_EMPTY è¿™æ ·å°±å¥½äº†ï¼Œè¿”å›ç»™å‰ç«¯æ¸…æ™°æœ‰æ•ˆçš„æ•°æ®.","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"},{"name":"Json","slug":"Json","permalink":"https://dayarch.top/tags/Json/"}]},{"title":"ä½¿ç”¨ Docker éƒ¨ç½² Spring Boot","slug":"ä½¿ç”¨-Docker-éƒ¨ç½²-Spring-Boot","date":"2018-04-09T07:43:42.000Z","updated":"2019-11-01T08:58:35.964Z","comments":true,"path":"/p/docker-deploy-spring-boot.html","link":"","permalink":"https://dayarch.top/p/docker-deploy-spring-boot.html","excerpt":"å‰è¨€ æœ€è¿‘é™†ç»­åœ¨é€šè¿‡SpringBootæ­å»ºé¡¹ç›®ï¼Œå¾€é‡Œé¢é€æ¸æ·»åŠ åŠŸèƒ½ï¼Œé¡¹ç›®åœ°å€SpringBootLearning, å½“æ€»ç»“Dockeréƒ¨ç½²SpringBootçš„æ—¶å€™ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼ŒåŠ ä»¥æ€»ç»“ é—®é¢˜æ±‡æ€» æ–‡ç« ä¸»è¦å‚è€ƒSpring Boot 2.0(å››)ï¼šä½¿ç”¨ Docker éƒ¨ç½² Spring Boot, å› ä¸ºæˆ‘æ˜¯å·²æœ‰çš„SpringBooté¡¹ç›®ï¼Œä¸æ˜¯ç®€å•çš„SpringBooté¡¹ç›®ï¼Œæ‰€ä»¥ä½¿ç”¨Dockeréƒ¨ç½²SpringBootçš„æ—¶å€™é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç°æ€»ç»“å¦‚ä¸‹ï¼š 1. mvn package æ‰“åŒ…å‘½ä»¤ä¸èƒ½ç”ŸæˆjaråŒ…åˆ°targetç›®å½•ä¸‹ å› ä¸ºDockerä¼šç”¨åˆ°jaråŒ…ï¼Œæ‰€ä»¥åœ¨ç”¨Doc","text":"å‰è¨€æœ€è¿‘é™†ç»­åœ¨é€šè¿‡SpringBootæ­å»ºé¡¹ç›®ï¼Œå¾€é‡Œé¢é€æ¸æ·»åŠ åŠŸèƒ½ï¼Œé¡¹ç›®åœ°å€SpringBootLearning, å½“æ€»ç»“Dockeréƒ¨ç½²SpringBootçš„æ—¶å€™ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼ŒåŠ ä»¥æ€»ç»“ é—®é¢˜æ±‡æ€»æ–‡ç« ä¸»è¦å‚è€ƒSpring Boot 2.0(å››)ï¼šä½¿ç”¨ Docker éƒ¨ç½² Spring Boot, å› ä¸ºæˆ‘æ˜¯å·²æœ‰çš„SpringBooté¡¹ç›®ï¼Œä¸æ˜¯ç®€å•çš„SpringBooté¡¹ç›®ï¼Œæ‰€ä»¥ä½¿ç”¨Dockeréƒ¨ç½²SpringBootçš„æ—¶å€™é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç°æ€»ç»“å¦‚ä¸‹ï¼š mvn package æ‰“åŒ…å‘½ä»¤ä¸èƒ½ç”ŸæˆjaråŒ…åˆ°targetç›®å½•ä¸‹å› ä¸ºDockerä¼šç”¨åˆ°jaråŒ…ï¼Œæ‰€ä»¥åœ¨ç”¨Dockeréƒ¨ç½²ä¹‹å‰ï¼Œå…ˆç”¨Mavenæ¥è¿›è¡Œæ‰“åŒ…ï¼Œä¿è¯æ­£ç¡®ï¼Œä½†æ˜¯ä½¿ç”¨å‘½ä»¤å¹¶ä¸èƒ½ç”ŸæˆjaråŒ…ï¼Œå‘ç°æ‰“åŒ…ä¸­æ‰“äº†æˆ‘çš„æµ‹è¯•ç”¨ä¾‹ç±»ï¼Œæµ‹è¯•ç”¨ä¾‹æœ‰æŒç»­æ‰§è¡Œæ“ä½œï¼Œå½“ç„¶å…¶ä»–æŒç»­æ“ä½œä¹Ÿæœ‰å¯èƒ½å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æˆ‘åœ¨pom.xmlä¸­åŠ å…¥äº†pluginæ¥è¿‡æ»¤æ‰Test case.123456789101112&lt;properties&gt;&lt;!--mvn æ‰“åŒ…æ—¶çœç•¥testç”¨ä¾‹--&gt;&lt;skipTests&gt;true&lt;/skipTests&gt;&lt;/properties&gt;&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;skipTests&gt;$&#123;skipTests&#125;&lt;/skipTests&gt; &lt;/configuration&gt;&lt;/plugin&gt; é€šè¿‡Mavençš„dockeræ’ä»¶æ¥éƒ¨ç½²ï¼Œé‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼š [ERROR] Failed to execute goal com.spotify:docker-maven-plugin:1.0.0:build (default-cli) on project demo: Exception caught: java.util.concurrent.ExecutionException: com.spotify.docker.client.shaded.javax.ws.rs.ProcessingException: org.apache.http.conn.HttpHostConnectException: Connect to localhost:2375 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused: connect -&gt; [Help 1] [ERROR] Failed to execute goal com.spotify:docker-maven-plugin:1.0.0:build (default-cli) on project demo: Exception caught: java.util.concurrent.ExecutionException: com.spotify.docker.client.shaded.javax.ws.rs.ProcessingException: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target -&gt; [Help 1] é€šè¿‡æŸ¥æ‰¾èµ„æ–™åœ¨pom.xmlä¸­mavençš„dockeræ’ä»¶ä¸­æ·»åŠ äº†å¦‚ä¸‹å†…å®¹ï¼š 12&lt;dockerHost&gt;https://192.168.99.100:2376&lt;/dockerHost&gt;&lt;dockerCertPath&gt;D:/Users/fraser.yu/.docker/machine/machines/default&lt;/dockerCertPath&gt;","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Docker","slug":"Coding/Docker","permalink":"https://dayarch.top/categories/Coding/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://dayarch.top/tags/Docker/"},{"name":"Spring Boot","slug":"Spring-Boot","permalink":"https://dayarch.top/tags/Spring-Boot/"}]},{"title":"Dockerå­¦ä¹ (å››)â€”â€”å®¹å™¨","slug":"Dockerå­¦ä¹ -å››-â€”â€”å®¹å™¨","date":"2017-11-07T02:45:33.000Z","updated":"2019-11-07T05:21:11.715Z","comments":true,"path":"/p/docker-container.html","link":"","permalink":"https://dayarch.top/p/docker-container.html","excerpt":"å®¹å™¨æ˜¯é•œåƒçš„ä¸€ä¸ªè¿è¡Œå®ä¾‹ï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼Œå®ƒæœ‰é¢å¤–çš„å¯å†™æ–‡ä»¶å±‚ä¸Šä¸€ç¯‡æ–‡ç« Dockerå­¦ä¹ (ä¸‰)â€”â€”é•œåƒä»‹ç»äº†Dockerçš„é•œåƒï¼Œ åŒ…æ‹¬ è·å–é•œåƒï¼ŒæŸ¥çœ‹é•œåƒä¿¡æ¯ï¼Œæœå¯»é•œåƒï¼Œåˆ é™¤é•œåƒï¼Œåˆ›å»ºé•œåƒï¼Œå­˜å‚¨å’Œè½½å…¥é•œåƒï¼Œä¸Šä¼ é•œåƒï¼Œæ¥ä¸‹æ¥é€æ­¥æ‹†åˆ†è®²è§£Dockerçš„æ ¸å¿ƒå†…å®¹ä¹‹ä¸€â€”â€”å®¹å™¨. Dockerçš„å®¹å™¨ååˆ†è½»é‡çº§ï¼Œç”¨æˆ·å¯ä»¥éšæ—¶åˆ›å»ºæˆ–åˆ é™¤å®¹å™¨ åˆ›å»ºå®¹å™¨ å•çº¯åˆ›å»ºå®¹å™¨ è¯­æ³•: docker create [OPTIONS] IMAGE [COMMAND] [ARGâ€¦] 1. ä¸ºæœ¬åœ°Ubuntué•œåƒåˆ›å»ºå®¹å™¨ 1 $ docker create -it ubuntu","text":"å®¹å™¨æ˜¯é•œåƒçš„ä¸€ä¸ªè¿è¡Œå®ä¾‹ï¼Œæ‰€ä¸åŒçš„æ˜¯ï¼Œå®ƒæœ‰é¢å¤–çš„å¯å†™æ–‡ä»¶å±‚ ä¸Šä¸€ç¯‡æ–‡ç« Dockerå­¦ä¹ (ä¸‰)â€”â€”é•œåƒä»‹ç»äº†Dockerçš„é•œåƒï¼ŒåŒ…æ‹¬ è·å–é•œåƒï¼ŒæŸ¥çœ‹é•œåƒä¿¡æ¯ï¼Œæœå¯»é•œåƒï¼Œåˆ é™¤é•œåƒï¼Œåˆ›å»ºé•œåƒï¼Œå­˜å‚¨å’Œè½½å…¥é•œåƒï¼Œä¸Šä¼ é•œåƒï¼Œæ¥ä¸‹æ¥é€æ­¥æ‹†åˆ†è®²è§£Dockerçš„æ ¸å¿ƒå†…å®¹ä¹‹ä¸€â€”â€”å®¹å™¨. Dockerçš„å®¹å™¨ååˆ†è½»é‡çº§ï¼Œç”¨æˆ·å¯ä»¥éšæ—¶åˆ›å»ºæˆ–åˆ é™¤å®¹å™¨ åˆ›å»ºå®¹å™¨å•çº¯åˆ›å»ºå®¹å™¨è¯­æ³•: docker create [OPTIONS] IMAGE [COMMAND] [ARGâ€¦] ä¸ºæœ¬åœ°Ubuntué•œåƒåˆ›å»ºå®¹å™¨ 1$ docker create -it ubuntu:latest æŸ¥çœ‹æœ¬åœ°å¯åŠ¨çš„å®¹å™¨ï¼ˆæ³¨æ„è§‚å¯Ÿå®¹å™¨çš„çŠ¶æ€æ˜¯Created,æ¢å¥è¯è¯´è¿™ä¸ªå®¹å™¨æ˜¯ç»ˆæ­¢çŠ¶æ€ï¼Œæ²¡æœ‰è¿è¡Œï¼‰ 1$ docker ps -a å®¹å™¨ä¿¡æ¯è§£é‡Š CONTAINER IDï¼š å®¹å™¨ID IMAGE: å®¹å™¨æ‰€è¿è¡Œé•œåƒçš„åç§° COMMAND: è¿è¡Œå®¹å™¨æ—¶çš„å‘½ä»¤ CREATED: å®¹å™¨çš„åˆ›å»ºæ—¶é—´ STATUS: å®¹å™¨å½“å‰çŠ¶æ€ è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£ 1$ docker create --help å¯åŠ¨å®¹å™¨æ–¹æ³•ä¸€è¯­æ³•: docker start [OPTIONS] CONTAINER [CONTAINERâ€¦] æŸ¥çœ‹åˆšåˆšåˆ›å»ºçš„å®¹å™¨IDï¼Œé€šè¿‡startå‘½ä»¤æ¥å¯åŠ¨ 1$ docker start 93f é‡æ–°æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ï¼ˆæ³¨æ„å½“å‰å®¹å™¨çŠ¶æ€æ˜¯Exitedï¼Œå³å®¹å™¨è¿è¡Œç»ˆæ­¢ï¼‰ 1$ docker ps -a è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£ 1$ docker start --help å¯åŠ¨å®¹å™¨æ–¹æ³•äºŒåˆ›å»ºå®¹å™¨å’Œå¯åŠ¨å®¹å™¨æœ‰ä¸€ç§æ›´æ–¹ä¾¿çš„å‘½ä»¤æ¥å®Œæˆä¸Šé¢create å’Œ start çš„æ“ä½œ.è¯­æ³•: docker run [OPTIONS] IMAGE [COMMAND] [ARGâ€¦] ä¸ºæœ¬åœ°Ubuntué•œåƒåœ¨æ­¤åˆ›å»ºå®¹å™¨å¹¶å¯åŠ¨1$ docker run -it ubuntu:latest è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£ï¼ˆå’Œcreateæ˜¯ä¸€æ ·çš„ï¼‰1$ docker run --help é€€å‡ºå®¹å™¨è¾“å…¥exitæˆ–è€…Ctrl+Dæ¥é€€å‡ºå®¹å™¨ï¼Œå¯¹äºæ‰€åˆ›å»ºçš„bashå®¹å™¨ï¼Œå½“ä½¿ç”¨exitå‘½ä»¤é€€å‡ºä¹‹åï¼Œè¯¥å®¹å™¨å°±å‡ºäºç»ˆæ­¢çŠ¶æ€äº†ï¼Œè¿™æ˜¯å› ä¸ºå¯¹äºDockerå®¹å™¨æ¥è¯´ï¼Œå½“è¿è¡Œçš„åº”ç”¨ï¼ˆæ­¤å¤„ä»¥bashä¸ºä¾‹ï¼‰é€€å‡ºåï¼Œå®¹å™¨ä¹Ÿå°±æ²¡æœ‰ç»§ç»­è¿è¡Œçš„å¿…è¦äº†. å®ˆæŠ¤æ€è¿è¡Œæ›´å¤šçš„æ—¶å€™ï¼Œéœ€è¦è®©Dockerå®¹å™¨åœ¨åå°ä»¥å®ˆæŠ¤æ€ï¼ˆDaemonizedï¼‰å½¢å¼è¿è¡Œï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ·»åŠ -d optionæ¥å®ç°. è¿è¡Œå®¹å™¨ï¼Œæ¯éš”ä¸€ç§’æ‰“å°å‡ºhello world1$ docker run -d ubuntu /bin/sh -c \"while true; do echo hello world; sleep 1; done\" è·å–å®¹å™¨çš„è¾“å‡ºä¿¡æ¯1$ docker logs ce90 è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker logs --help ç»ˆæ­¢å®¹å™¨è¯­æ³•: docker stop [OPTIONS] CONTAINER [CONTAINERâ€¦]æ‰§è¡Œä¸Šè¿°å‘½ä»¤åï¼Œç»ˆæ­¢å®¹å™¨åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œå…ˆå‘å®¹å™¨å‘é€ä¸€ä¸ªSIGTERMä¿¡å·ï¼Œ10ç§’é’Ÿåä¼šå†æ¬¡å‘é€ä¸€ä¸ªSIGKILLä¿¡å·ç»ˆæ­¢å®¹å™¨ ç»ˆæ­¢ä¸Šæ–‡ä¸­å¯åŠ¨çš„å®¹å™¨1$ docker stop ce90 æŸ¥çœ‹ç»ˆæ­¢çš„å®¹å™¨1$ docker ps -a -q å¯åŠ¨å®¹å™¨1$ docker start ce90 é‡å¯å®¹å™¨ï¼ˆå°†è¿è¡Œä¸­çš„å®¹å™¨ç»ˆæ­¢ï¼Œå¹¶é‡æ–°å¯åŠ¨ï¼‰1$ docker restart ce90 è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker stop --help è¿›å…¥å®¹å™¨ä¸Šæ–‡ä¸­æåˆ°ä½¿ç”¨-då‚æ•°å¯ä»¥ä½¿Dockeræˆå®ˆæŠ¤æ€è¿è¡Œï¼Œä½†æ˜¯ç”¨æˆ·æ— æ³•çœ‹åˆ°å®¹å™¨çš„å†…éƒ¨ä¿¡æ¯ï¼Œè€Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦è¿›å…¥åˆ°å®¹å™¨å†…è¿›è¡Œæ“ä½œï¼ŒDockerä¹Ÿæä¾›äº†é›†ä¸­æ–¹æ³•æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ docker attachè¯­æ³•: docker attach [OPTIONS] CONTAINER, è¿è¡Œè¯¥å‘½ä»¤æ—¶ï¼Œè¯¥å®¹å™¨å¿…é¡»æ˜¯è¿è¡ŒçŠ¶æ€ï¼ˆUPï¼‰,å¦‚æœæ²¡æœ‰è¿è¡Œï¼Œä½¿ç”¨startå‘½ä»¤ï¼Œattachå‘½ä»¤å¯ä»¥ä¸ç”¨æŒ‡å®šå‘½ä»¤å‚æ•°ï¼Œé»˜è®¤æ‰§è¡Œä¸Šæ¬¡runçš„å‘½ä»¤å‚æ•°/bin/bash, ä½†æ˜¯å½“å¤šä¸ªçª—å£åŒæ—¶attachåˆ°åŒä¸€ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œæ‰€æœ‰çª—å£éƒ½ä¼šåŒæ­¥æ˜¾ç¤ºï¼Œå½“æŸä¸ªçª—å£å› ä¸ºæŸä¸€ä¸ªå‘½ä»¤é˜»å¡æ—¶ï¼Œå…¶ä»–çª—å£å°±æ— æ³•æ‰§è¡Œå…¶ä»–æ“ä½œäº†ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨. è¿›å…¥åˆšåˆšä»¥å®ˆæŠ¤æ€å¯åŠ¨çš„å®¹å™¨1$ docker attach 9d89 è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker attach --help docker execè¯­æ³•: docker exec [OPTIONS] CONTAINER COMMAND [ARGâ€¦], è¯¥å‘½ä»¤è‡³å°‘éœ€è¦ä¸€ä¸ªå‘½ä»¤å‚æ•° è¿›å…¥åˆšåˆšä¸€å®ˆæŠ¤æ€å¯åŠ¨çš„å®¹å™¨1$ docker exec -it 9d89 /bin/bash è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker exec --help åˆ é™¤å®¹å™¨è¯­æ³•: docker rm [OPTIONS] CONTAINER [CONTAINERâ€¦] åˆ é™¤å¤„äº ç»ˆæ­¢çŠ¶æ€ çš„å®¹å™¨ï¼ŒåŒæ—¶å¯ä»¥è¾“å…¥å¤šä¸ªå®¹å™¨IDæ‰¹é‡åˆ é™¤å®¹å™¨ åˆ é™¤å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨1$ docker rm 9d89 è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker rm --help å¯¼å…¥å’Œå¯¼å‡ºå®¹å™¨å¯¼å‡ºå®¹å™¨å¯¼å‡ºå®¹å™¨æ˜¯æŒ‡å¯¼å‡ºä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®¹å™¨åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸ç®¡è¯¥å®¹å™¨æ˜¯å¦æ˜¯å¤„äºè¿è¡ŒçŠ¶æ€è¯­æ³•: docker export [OPTIONS] CONTAINER å¯¼å‡º9d89å®¹å™¨åˆ°ubuntu_export.taræ–‡ä»¶1$ docker export 9d89 &gt; ubuntu_export.tar è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker export --help å¯¼å…¥å®¹å™¨å¯¼å‡ºçš„æ–‡ä»¶åˆå¯ä»¥ä½¿ç”¨docker import å‘½ä»¤å¯¼å…¥ï¼Œæˆä¸ºé•œåƒ å¯¼å…¥ä¸Šæ–‡ä¸­çš„ubuntu_export.taræ–‡ä»¶æˆä¸ºé•œåƒ1$ cat ubuntu_export.tar | docker import - test/ubuntu:v1.0 è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker import --help æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­è®²è¿‡è½½å…¥é•œåƒ docker load å‘½ä»¤å¯¼å…¥é•œåƒæ–‡ä»¶åˆ°æœ¬åœ°é•œåƒåº“ï¼Œè¿™èŠ‚é€šè¿‡ docker import å‘½ä»¤æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ï¼Œä½†æ˜¯å®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰å†å²æ•°æ®å’Œå…ƒæ•°æ®ï¼ˆä»…ä»…ä¿å­˜å®¹å™¨å½“å‰çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œ è€Œé•œåƒæ–‡ä»¶å½¢å¼ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯è¦å¤§ï¼Œæ­¤å¤–ï¼Œå®¹å™¨å¿«ç…§å¯¼å…¥æ ‡ç­¾å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾å…ƒæ•°æ®ç­‰ï¼Œå‘ä¸Šæ–‡ä¸­çš„test/ubuntu:v1.0","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Docker","slug":"Coding/Docker","permalink":"https://dayarch.top/categories/Coding/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://dayarch.top/tags/Docker/"}]},{"title":"Dockerå­¦ä¹ (ä¸‰)â€”â€”é•œåƒ","slug":"Dockerå­¦ä¹ -ä¸‰-â€”â€”é•œåƒ","date":"2017-11-06T06:50:32.000Z","updated":"2019-11-07T05:19:56.130Z","comments":true,"path":"/p/docker-image.html","link":"","permalink":"https://dayarch.top/p/docker-image.html","excerpt":"é•œåƒæ˜¯Dockerè¿è¡Œå®¹å™¨çš„å‰æä¸Šä¸€ç¯‡æ–‡ç« Dockerå­¦ä¹ (äºŒ)â€”â€”Dockeræ¶æ„è®²è¿°äº†Dockerçš„åŸºæœ¬æ¶æ„ï¼Œæ¥ä¸‹æ¥é€æ­¥æ‹†åˆ†è®²è§£Dockerçš„æ ¸å¿ƒå†…å®¹ä¹‹ä¸€â€”â€”é•œåƒ. Docker è¿è¡Œå®¹å™¨å‰éœ€è¦æœ¬åœ°å­˜æœ‰å¯¹åº”çš„é•œåƒï¼Œå¦‚æœé•œåƒä¸å­˜åœ¨ï¼ŒDockerä¼šå°è¯•å…ˆä»é»˜è®¤ï¼ˆDocker Hubå…¬å…±æ³¨å†ŒæœåŠ¡å™¨ä¸­çš„ä»“åº“ï¼‰é•œåƒä»“åº“ä¸‹è½½ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é…ç½®ä½¿ç”¨è‡ªå·±çš„ä»“åº“. æœ¬ç« å†…å®¹ä¸»è¦æœ‰ï¼šè·å–é•œåƒï¼ŒæŸ¥çœ‹é•œåƒä¿¡æ¯ï¼Œæœå¯»é•œåƒï¼Œåˆ é™¤é•œåƒï¼Œåˆ›å»ºé•œåƒï¼Œå­˜å‚¨å’Œè½½å…¥é•œåƒï¼Œä¸Šä¼ é•œåƒ. çœ‹ç€å†…å®¹å¾ˆå¤šï¼Œå…¶å®ç†Ÿæ‚‰Gitçš„æœ‹å‹ï¼Œåˆ†åˆ†é’Ÿå°±å¯ä»¥ç†è§£ä¸Šé¢çš„è¿™äº›å†…å®¹ï¼Œ æ“ä½œæ–¹å¼éƒ½æ˜¯ç›¸é€šçš„, è¯ä¸å¤šè¯´ï¼Œçœ‹å‘½ä»¤è¯´è¯. è·å–é•œåƒ è¯­æ³•: docker","text":"é•œåƒæ˜¯Dockerè¿è¡Œå®¹å™¨çš„å‰æ ä¸Šä¸€ç¯‡æ–‡ç« Dockerå­¦ä¹ (äºŒ)â€”â€”Dockeræ¶æ„è®²è¿°äº†Dockerçš„åŸºæœ¬æ¶æ„ï¼Œæ¥ä¸‹æ¥é€æ­¥æ‹†åˆ†è®²è§£Dockerçš„æ ¸å¿ƒå†…å®¹ä¹‹ä¸€â€”â€”é•œåƒ. Docker è¿è¡Œå®¹å™¨å‰éœ€è¦æœ¬åœ°å­˜æœ‰å¯¹åº”çš„é•œåƒï¼Œå¦‚æœé•œåƒä¸å­˜åœ¨ï¼ŒDockerä¼šå°è¯•å…ˆä»é»˜è®¤ï¼ˆDocker Hubå…¬å…±æ³¨å†ŒæœåŠ¡å™¨ä¸­çš„ä»“åº“ï¼‰é•œåƒä»“åº“ä¸‹è½½ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é…ç½®ä½¿ç”¨è‡ªå·±çš„ä»“åº“. æœ¬ç« å†…å®¹ä¸»è¦æœ‰ï¼šè·å–é•œåƒï¼ŒæŸ¥çœ‹é•œåƒä¿¡æ¯ï¼Œæœå¯»é•œåƒï¼Œåˆ é™¤é•œåƒï¼Œåˆ›å»ºé•œåƒï¼Œå­˜å‚¨å’Œè½½å…¥é•œåƒï¼Œä¸Šä¼ é•œåƒ. çœ‹ç€å†…å®¹å¾ˆå¤šï¼Œå…¶å®ç†Ÿæ‚‰Gitçš„æœ‹å‹ï¼Œåˆ†åˆ†é’Ÿå°±å¯ä»¥ç†è§£ä¸Šé¢çš„è¿™äº›å†…å®¹ï¼Œ æ“ä½œæ–¹å¼éƒ½æ˜¯ç›¸é€šçš„, è¯ä¸å¤šè¯´ï¼Œçœ‹å‘½ä»¤è¯´è¯. è·å–é•œåƒè¯­æ³•: docker pull NAME[:TAG] ä»Docker Hubçš„Ubuntuä»“åº“ä¸‹è½½æœ€æ–°ç‰ˆæœ¬Ubuntué•œåƒ(å¦‚æœä¸æŒ‡å®štagï¼Œé»˜è®¤tagæ˜¯latest,å³ä¸‹è½½æœ€æ–°ç‰ˆæœ¬)1$ docker pull ubuntu ä»Docker Hubçš„Ubuntuä»“åº“ä¸‹è½½æŒ‡å®šç‰ˆæœ¬Ubuntué•œåƒ1$ docker pull ubuntu:16.04 æˆ‘ä»¬å‰é¢è®²è¿‡ï¼Œé»˜è®¤æ˜¯ä»Docker Hubçš„Registryä¸­ä¸‹è½½ï¼Œæ‰€ä»¥ä»¥ä¸Šçš„å‘½ä»¤ç›¸å½“äº12$ docker pull registry.hub.docker.com/ubuntu:latest$ docker pull registry.hub.docker.com/ubuntu:16.04 ä»å…¶ä»–æ³¨å†ŒæœåŠ¡å™¨ä¸‹è½½Dockeré•œåƒï¼ˆå¦‚DockerPoolç¤¾åŒºï¼Œéœ€è¦æŒ‡å®šå®Œæ•´çš„æ³¨å†ŒæœåŠ¡å™¨åœ°å€ï¼‰1$ docker pull dl.dockerpool.com:5000/ubuntu è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker pull --help æŸ¥çœ‹é•œåƒä¿¡æ¯è¯­æ³•ï¼šdocker imagesé€šè¿‡è¯¥å‘½ä»¤å¯ä»¥æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼Œè¯´æ˜ä¸€ä¸‹æ‰§è¡Œè¯¥å‘½ä»¤ä¹‹åæ¯åˆ—çš„å«ä¹‰ REPOSITORY: æ¥è‡ªäºå“ªä¸ªä»“åº“ï¼ŒåŒæ ·æ˜¯å¦‚æœæ²¡æœ‰æŒ‡å®šæ³¨å†ŒæœåŠ¡å™¨çš„åœ°å€ï¼Œé‚£é»˜è®¤å°±æ˜¯Docker Hubçš„ä»“åº“ TAGï¼šé•œåƒçš„æ ‡ç­¾ä¿¡æ¯ï¼Œæ¯”å¦‚latestã€16.04 IMAGE IDï¼šé•œåƒçš„å”¯ä¸€IDæ ‡è¯† CREATED:ï¼ˆé•œåƒæ‹‰å–åˆ°æœ¬åœ°æˆ–è€…åœ¨æœ¬åœ°åˆ›å»ºé•œåƒçš„æ—¶é—´ï¼‰ VIRTUAL SIZE:é•œåƒçš„å¤§å° repositoryæ˜¯ä¸åŒçš„ä»“åº“ï¼Œtagæ˜¯æ ‡è®°åŒä¸€ä¸ªä»“åº“çš„ä¸åŒçš„é•œåƒ Tagæ‰“æ ‡è®°æœ‰æ—¶å€™é•œåƒéœ€è¦ä¸€ä¸ªè‡ªå·±éœ€è¦çš„tagæ ‡è¯†ï¼Œè¿™ä¼šæˆ‘ä»¬éœ€è¦ç”¨åˆ°docker çš„tagå‘½ä»¤æ¥æ–¹ä¾¿æˆ‘ä»¬ç®¡ç†é•œåƒè¯­æ³•ï¼šdocker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG] ç»™é•œåƒæ‰“ä¸Šè‡ªå·±çš„æ ‡ç­¾1$ docker tag dl.dockerpool.com:5000/ubuntu:latest ubuntu:20171106_ubuntu è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker tag --help æ‰§è¡Œå®Œä»¥ä¸Šå‘½ä»¤å†æ¬¡æŸ¥çœ‹[docker images]æœ¬åœ°æ‰€æœ‰é•œåƒï¼Œå‘ç°æˆ‘ä»¬æ‰“äº†æ ‡è®°çš„é•œåƒå’Œè¢«æ‰“æ ‡è®°çš„é•œåƒçš„é•œåƒIDç«Ÿç„¶ä¸€æ ·.è¿™è¯´æ˜æ–°æ‰“ä¸Šæ ‡ç­¾çš„é•œåƒåªæ˜¯æŒ‡å‘äº†åŒä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œåªæ˜¯åˆ«åä¸åŒï¼Œæ ‡ç­¾åœ¨è¿™é‡Œå°±èµ·åˆ°äº†å¼•ç”¨æˆ–å¿«æ·æ–¹å¼çš„ä½œç”¨. æŸ¥çœ‹é•œåƒçš„è¯¦ç»†ä¿¡æ¯è¯­æ³•ï¼šdocker inspect [OPTIONS] NAME|ID [NAME|ID]æ‰§è¡Œ[docker inspect]å‘½ä»¤ä¼šå¾—åˆ°ä¸€ä¸ªJsonæ ¼å¼çš„ä¿¡æ¯ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å…³æ³¨æŸä¸€ä¸ªéƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨[-f]å‚æ•°æ¥ä½¿ç”¨ï¼Œé•œåƒIDä½¿ç”¨å‰å‡ ä¸ªå­—ç¬¦å°±å¯ä»¥ï¼Œä¸ç”¨è¾“å…¥å…¨éƒ¨ æŸ¥çœ‹åˆšåˆšæ‰“äº†æ ‡è®°çš„Ubuntué•œåƒçš„è¯¦ç»†ä¿¡æ¯(é•œåƒIDå› äººè€Œå¼‚)1$ docker inspect 5506de2b643b æŸ¥çœ‹é•œåƒæŒ‡å®šçš„è¯¦ç»†ä¿¡æ¯1$ docker inspect -f &#123;&#123;\".Architecture\"&#125;&#125; 5506 è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker inspect --help æœå¯»é•œåƒè¯­æ³•ï¼šdocker search [OPTIONS] TERM æœå¯»mysqlé•œåƒ1$ docker search mysql è¯´æ˜ä¸€ä¸‹æ‰§è¡Œè¯¥å‘½ä»¤ä¹‹åæ¯åˆ—çš„å«ä¹‰ NAME: é•œåƒåç§° DESCRIPTIONï¼šç«ç›¸æè¿° STARTSï¼šé•œåƒæ˜Ÿçº§ï¼ˆä»£è¡¨å—æ¬¢è¿ç¨‹åº¦ï¼‰ OFFICIAL:æ˜¯å¦ä¸ºå®˜æ–¹åˆ›å»ºå’Œç»´æŠ¤çš„ AUTOMATED:æ˜¯å¦è‡ªåŠ¨åˆ›å»ºï¼ˆè‡ªåŠ¨åˆ›å»ºçš„èµ„æºå…è®¸ç”¨æˆ·éªŒè¯é•œåƒå†…å®¹ä»¥åŠæ¥æºï¼‰ åˆ é™¤é•œåƒè¯­æ³•ï¼šdocker rmi [OPTIONS] IMAGE [IMAGEâ€¦], IMAGEå¯ä»¥æ˜¯é•œåƒæ ‡ç­¾æˆ–è€…é•œåƒIDï¼Œrmiå…¶å®å°±æ˜¯remove imageçš„ç¼©å†™. åˆ é™¤é•œåƒè¿™é‡Œçš„è§„çŸ©ç¨ç¨å¤šä¸€ç‚¹ä½†æ˜¯éµå¾ªä»¥ä¸‹å‡ ä¸ªåŸåˆ™ï¼Œä¸ç”¨èƒŒè¯µä»¥ä¸‹ï¼Œä¼šåœ¨åé¢çš„å®è·µä¸­é€æ­¥æ¥éªŒè¯ å½“æœ¬åœ°ä¸€ä¸ªé•œåƒæœ‰å¤šä¸ªæ ‡ç­¾æ—¶ï¼Œåˆ é™¤æŸä¸€ä¸ªæ ‡ç­¾ä¸å½±å“å…¶ä»–é•œåƒ å½“æœ¬åœ°ä¸€ä¸ªé•œåƒåªæœ‰ä¸€ä¸ªæ ‡ç­¾æ—¶ï¼Œåˆ é™¤è¯¥æ ‡ç­¾ä¼šå½»åº•åˆ é™¤è¯¥é•œåƒ å½“é€šè¿‡é•œåƒIDåˆ é™¤é•œåƒçš„æ—¶å€™ï¼Œä¼šé€ä¸ªåˆ é™¤æŒ‡å‘è¯¥é•œåƒçš„æ ‡ç­¾ï¼Œæœ€ç»ˆåˆ é™¤é•œåƒ. å½“æœ‰è¯¥é•œåƒåˆ›å»ºçš„å®¹å™¨å­˜åœ¨æ—¶ï¼Œé•œåƒä¸ä¼šè¢«åˆ é™¤ï¼Œdockerä¼šæ›´æ¢è¯¥é•œåƒIDï¼Œå¹¶ä¸”é•œåƒæ²¡æœ‰åå­—. å½“æœ‰è¯¥é•œåƒåˆ›å»ºçš„å®¹å™¨å­˜åœ¨æ—¶,å¯ä»¥ä½¿ç”¨[-f] å‚æ•°æ¥å¼ºåˆ¶åˆ é™¤é•œåƒï¼ˆä¸å»ºè®®è¿™æ ·åšï¼‰ å½“æœ‰è¯¥é•œåƒåˆ›å»ºçš„å®¹å™¨å­˜åœ¨æ—¶,åº”éµå¾ªå…ˆåˆ é™¤å®¹å™¨ï¼Œç„¶åå†åˆ é™¤é•œåƒ åˆ é™¤mysqlé•œåƒ1$ docker rmi mysql:latest åˆ›å»ºé•œåƒåˆ›å»ºé•œåƒæœ‰ä¸‰ç§æ–¹å¼ï¼š åŸºäºå·²æœ‰é•œåƒçš„å®¹å™¨åˆ›å»º åŸºäºæœ¬åœ°æ¨¡æ¿å¯¼å…¥ åŸºäºDockerfileåˆ›å»ºï¼ˆæœ€å¸¸ç”¨ï¼Œæ­¤å¤„å…ˆäº†è§£æ•´ä¸ªè¿‡ç¨‹ï¼Œåç»­ç« èŠ‚ç»å¸¸ä½¿ç”¨çš„æ—¶å€™è‡ªç„¶å°±ä¼šäº†ï¼‰ åŸºäºå·²æœ‰é•œåƒçš„å®¹å™¨åˆ›å»ºæ–°é•œåƒè¯­æ³•ï¼šdocker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]] å¯åŠ¨é•œåƒï¼ˆé€šè¿‡å®¹å™¨è¿è¡ŒUbuntu16.04, å¹¶ä¸”è¿›å…¥bashç¯å¢ƒï¼‰ï¼Œè¿è¡Œåé€šè¿‡[docker ps -a]æ¥æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ï¼Œå½“ä¸‹ä¸»è¦å…³æ³¨å®¹å™¨ID1$ docker run -it ubuntu:1604 /bin/bash åˆ›å»ºtestæ–‡ä»¶å¹¶ä¸”é€€å‡ºå®¹å™¨12touch testexit é€šè¿‡è¿è¡Œçš„å®¹å™¨åˆ›å»ºæ–°çš„é•œåƒ,æ‰§è¡ŒæˆåŠŸåä¼šè¿”å›æ–°åˆ›å»ºçš„é•œåƒIDä¿¡æ¯1$ docker commit -m \"added a new file\" -a \"fraser\" a925cb test:latest è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£[â€œ-mâ€:æäº¤ä¿¡æ¯,â€-aâ€:ä½œè€…ä¿¡æ¯,â€-pâ€:æäº¤æ—¶æš‚åœå®¹å™¨è¿è¡Œ]1$ docker commit --help åŸºäºæœ¬åœ°æ¨¡æ¿å¯¼å…¥å¯ä»¥ç›´æ¥ä»ä¸€ä¸ªæ“ä½œç³»ç»Ÿæ¨¡æ¿æ–‡ä»¶å¯¼å…¥ä¸€ä¸ªé•œåƒï¼Œæ¨èOpenVZæä¾›çš„æ¨¡æ¿æ¥åˆ›å»º(ä¸ªäººè§‰å¾—è¿™ä¸ªåº”ç”¨çš„ä¸æ˜¯å¾ˆå¤šï¼Œäº†è§£å³å¯) é€šè¿‡æ¨¡æ¿æ–‡ä»¶å¯¼å…¥1$ sudo cat ubuntu-16.04-x86_64.tar.gz | docker import - ubuntu:1604 åŸºäºDockerfileåˆ›å»ºDockerfileéœ€è¦è®²è§£çš„å†…å®¹å¾ˆå¤šï¼ŒåŒ…æ‹¬é‡Œé¢å„ä¸ªæŒ‡ä»¤çš„åº”ç”¨ï¼Œæˆ‘ä»¬ä¼šå•ç‹¬æ‹¿å‡ºä¸€ä¸ªç« èŠ‚æ¥è®²è§£Dockerfile. å­˜å‡ºå’Œè½½å…¥é•œåƒå­˜å‡ºé•œåƒè¯­æ³•ï¼šdocker save [OPTIONS] IMAGE [IMAGEâ€¦] , å­˜å‡ºé•œåƒåˆ°æœ¬åœ°æ–‡ä»¶ å­˜å‡ºæœ¬åœ°çš„ubuntu:1604é•œåƒä¸ºubuntu_1604.tar1$ docker save -o ubuntu_1604.tar ubuntu:1604 è¯¦ç»†ä¿¡æ¯è¯·ä½¿ç”¨ä¸‹é¢å‘½ä»¤è‡ªè¡Œäº†è§£1$ docker save --help è½½å…¥é•œåƒè¯­æ³•ï¼šdocker load [OPTIONS] , ä»å­˜å‡ºçš„æœ¬åœ°æ–‡ä»¶ä¸­å†å¯¼å…¥åˆ°æœ¬åœ°é•œåƒåº“ ä»ubuntu_1604.taræ–‡ä»¶å¯¼å…¥é•œåƒåˆ°åˆ°æœ¬åœ°é•œåƒåˆ—è¡¨123$ docker load --input ubuntu_1604.taræˆ–$ docker load &lt; ubuntu_1604.tar ä¸Šä¼ é•œåƒè¯­æ³•ï¼šdocker push [OPTIONS] NAME[:TAG]ç”¨æˆ·åœ¨DockerHubä¸Šå®Œæˆæ³¨å†Œä¹‹åï¼Œå³å¯ä¸Šä¼ è‡ªåˆ¶çš„é•œåƒï¼Œä½†æ˜¯éœ€è¦æ‰“ä¸Šå¸¦æœ‰userçš„æ ‡ç­¾ï¼ˆæ³¨å†Œçš„ç”¨æˆ·åï¼‰ å°†æœ¬åœ°hello-worldé•œåƒåŠ ä¸Šæ ‡ç­¾1$ docker tag hello-world:latest fraseryu/helloworld:latest æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨å¯ä»¥çœ‹åˆ°æ‰“ä¸Šæ ‡ç­¾çš„é•œåƒ1$ docker images ç™»å½•å®ŒæˆDockerHubæˆæƒè®¤è¯ï¼Œè¾“å…¥åˆšåˆšåœ¨DockerHubä¸Šæ³¨å†Œçš„ç”¨æˆ·åå’Œå¯†ç 1$ docker login pushæœ¬åœ°è®¢åˆ¶çš„é•œåƒåˆ°DockerHub1$ docker push fraseryu/helloworld:latest ç™»å½•DockerHubçœ‹åˆ°æˆ‘ä»¬çš„é•œåƒå·²ç»pushæˆåŠŸ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Docker","slug":"Coding/Docker","permalink":"https://dayarch.top/categories/Coding/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://dayarch.top/tags/Docker/"}]},{"title":"Dockerå­¦ä¹ (äºŒ)â€”â€”Dockeræ¶æ„","slug":"Dockerå­¦ä¹ -äºŒ-â€”â€”Dockeræ¶æ„","date":"2017-11-03T05:53:16.000Z","updated":"2019-11-07T05:20:30.846Z","comments":true,"path":"/p/docker-architect.html","link":"","permalink":"https://dayarch.top/p/docker-architect.html","excerpt":"åƒé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸€æ ·ç†è§£Dockeré•œåƒä¸å®¹å™¨ä¸Šä¸€ç¯‡æ–‡ç« Dockerå­¦ä¹ (ä¸€)â€”â€”Dockerå®‰è£…è®²è¿°äº†åœ¨Ubuntuä¸‹å®‰è£…ï¼Œå®‰è£…å®Œäº†è¦äº†è§£ä¸€ä¸‹Dockeræ¶æ„ä¸ä¸€äº›åè¯è§£é‡Šï¼Œè¿™æ ·å¯¹Dockeråç»­çš„æ“ä½œä¼šæœ‰æ›´å¥½çš„ç†è§£. Docker ä½¿ç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨ (C/S) æ¶æ„æ¨¡å¼ï¼Œä½¿ç”¨è¿œç¨‹APIæ¥ç®¡ç†å’Œåˆ›å»ºDockerå®¹å™¨, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬é€šè¿‡Dockerå®¢æˆ·ç«¯æ¥å®Œæˆå¯¹é•œåƒä»¥åŠå®¹å™¨çš„ä¸€ç³»åˆ—æ“ä½œ å¯¹äºä¸Šé¢çš„å›¾ç‰‡å‡ºç°çš„ä¸€ç³»åˆ—åè¯å¯ä»¥è¿™æ ·ç†è§£ï¼š åè¯æœ¯è¯­è§£é‡ŠDocker é•œåƒ(Images)Docker é•œåƒæ˜¯ç”¨äºåˆ›å»º Docker å®¹å™¨çš„æ¨¡æ¿Docker å®¹å™¨(Container)å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€","text":"åƒé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸€æ ·ç†è§£Dockeré•œåƒä¸å®¹å™¨ ä¸Šä¸€ç¯‡æ–‡ç« Dockerå­¦ä¹ (ä¸€)â€”â€”Dockerå®‰è£…è®²è¿°äº†åœ¨Ubuntuä¸‹å®‰è£…ï¼Œå®‰è£…å®Œäº†è¦äº†è§£ä¸€ä¸‹Dockeræ¶æ„ä¸ä¸€äº›åè¯è§£é‡Šï¼Œè¿™æ ·å¯¹Dockeråç»­çš„æ“ä½œä¼šæœ‰æ›´å¥½çš„ç†è§£. Docker ä½¿ç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨ (C/S) æ¶æ„æ¨¡å¼ï¼Œä½¿ç”¨è¿œç¨‹APIæ¥ç®¡ç†å’Œåˆ›å»ºDockerå®¹å™¨, ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬é€šè¿‡Dockerå®¢æˆ·ç«¯æ¥å®Œæˆå¯¹é•œåƒä»¥åŠå®¹å™¨çš„ä¸€ç³»åˆ—æ“ä½œ å¯¹äºä¸Šé¢çš„å›¾ç‰‡å‡ºç°çš„ä¸€ç³»åˆ—åè¯å¯ä»¥è¿™æ ·ç†è§£ï¼š åè¯æœ¯è¯­ è§£é‡Š Docker é•œåƒ(Images) Docker é•œåƒæ˜¯ç”¨äºåˆ›å»º Docker å®¹å™¨çš„æ¨¡æ¿ Docker å®¹å™¨(Container) å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ Docker å®¢æˆ·ç«¯(Client) Docker å®¢æˆ·ç«¯é€šè¿‡å‘½ä»¤è¡Œæˆ–è€…å…¶ä»–å·¥å…·ä½¿ç”¨ Docker API (https://docs.docker.com/reference/api/docker_remote_api) ä¸ Docker çš„å®ˆæŠ¤è¿›ç¨‹é€šä¿¡ Docker ä¸»æœº(Host) ä¸€ä¸ªç‰©ç†æˆ–è€…è™šæ‹Ÿçš„æœºå™¨ç”¨äºæ‰§è¡Œ Docker å®ˆæŠ¤è¿›ç¨‹å’Œå®¹å™¨ Docker ä»“åº“(Registry) Docker ä»“åº“ç”¨æ¥ä¿å­˜é•œåƒï¼Œå¯ä»¥ç†è§£ä¸ºä»£ç æ§åˆ¶ä¸­çš„ä»£ç ä»“åº“ï¼ŒDocker Hub(https://hub.docker.com) æä¾›äº†åºå¤§çš„é•œåƒé›†åˆä¾›ä½¿ç”¨ å…³äºRegistryæˆ‘è¦å¤šè¯´ä¸€å¥ï¼Œåº”è¯¥æŠŠå®ƒç†è§£æˆç®¡ç†ä»“åº“çš„ä»“åº“ï¼Œè¿™ä¸ªä»“åº“ä¸­æœ‰Ubuntuä»“åº“ï¼ŒApacheä»“åº“ï¼ŒNginxä»“åº“ç­‰ï¼Œ æ¯ä¸ªå°ä»“åº“è¿˜éƒ½ç®¡ç†ä¸åŒversionçš„é•œåƒï¼Œå¦‚Ubuntu1604,Ubuntu1404ç­‰. æ–‡ç« å¼€å¤´æåˆ°åƒé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸€æ ·ç†è§£Dockeré•œåƒä¸å®¹å™¨ï¼Œçœ‹å¦‚ä¸‹è¡¨æ ¼ï¼Œä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼ˆé™¤äº†å•ä¾‹æ¨¡å¼ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªé•œåƒå¯ä»¥æœ‰å¤šä¸ªå®¹å™¨æ¥è¿è¡Œ. Docker é¢å‘å¯¹è±¡ é•œåƒ ç±» å®¹å™¨ å¯¹è±¡ å……åˆ†ç†è§£ä¸€ä¸‹è¿™ç¯‡æ¶æ„å›¾ä»¥åŠåè¯è§£é‡Šï¼Œå°±è¦è¿›å…¥æ¥ä¸‹æ¥çš„Dockerä¹‹æ—…äº†. å‚è€ƒ Dockeræ¶æ„ å‡ å¼ å›¾å¸®ä½ ç†è§£ docker åŸºæœ¬åŸç†åŠå¿«é€Ÿå…¥é—¨","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Docker","slug":"Coding/Docker","permalink":"https://dayarch.top/categories/Coding/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://dayarch.top/tags/Docker/"}]},{"title":"Dockerå­¦ä¹ (ä¸€)â€”â€”Dockerå®‰è£…","slug":"Dockerå­¦ä¹ -ä¸€-â€”â€”Dockerå®‰è£…","date":"2017-11-01T06:04:46.000Z","updated":"2019-11-07T05:18:34.850Z","comments":true,"path":"/p/docker-install.html","link":"","permalink":"https://dayarch.top/p/docker-install.html","excerpt":"Docker, incredible virtual machineä»€ä¹ˆæ˜¯Docker æŒ‰ç…§æƒ¯ä¾‹ï¼Œä»‹ç»ä¸€äº›å†å²ï¼Œè¯´æ˜ä¸€ä¸‹æ¥é¾™å»è„‰ï¼Œè‡³å°‘çŸ¥é“å®ƒæ˜¯æ€ä¹ˆæ¥çš„ï¼Œåˆä¸ºä»€ä¹ˆä¼šæ¥ï¼Œèƒ½å¹²ä»€ä¹ˆ 1. Docker æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œè¯ç”Ÿäº 2013 å¹´åˆï¼Œæœ€åˆæ˜¯ dotCloud å…¬å¸å†…éƒ¨çš„ä¸€ä¸ªä¸šä½™é¡¹ç›®ã€‚å®ƒåŸºäº Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€å®ç°ã€‚ é¡¹ç›®åæ¥åŠ å…¥äº† Linux åŸºé‡‘ä¼šï¼Œéµä»äº† Apache 2.0 åè®®ï¼Œé¡¹ç›®ä»£ç åœ¨ GitHub ä¸Šè¿›è¡Œç»´æŠ¤ 2. Docker è‡ªå¼€æºåå—åˆ°å¹¿æ³›çš„å…³æ³¨å’Œè®¨è®ºï¼Œä»¥è‡³äº dotCloud å…¬å¸åæ¥éƒ½æ”¹åä¸º Docker Incã€‚Redhat å·²ç»åœ¨å…¶ RHE","text":"Docker, incredible virtual machine ä»€ä¹ˆæ˜¯DockeræŒ‰ç…§æƒ¯ä¾‹ï¼Œä»‹ç»ä¸€äº›å†å²ï¼Œè¯´æ˜ä¸€ä¸‹æ¥é¾™å»è„‰ï¼Œè‡³å°‘çŸ¥é“å®ƒæ˜¯æ€ä¹ˆæ¥çš„ï¼Œåˆä¸ºä»€ä¹ˆä¼šæ¥ï¼Œèƒ½å¹²ä»€ä¹ˆ Docker æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œè¯ç”Ÿäº 2013 å¹´åˆï¼Œæœ€åˆæ˜¯ dotCloud å…¬å¸å†…éƒ¨çš„ä¸€ä¸ªä¸šä½™é¡¹ç›®ã€‚å®ƒåŸºäº Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€å®ç°ã€‚ é¡¹ç›®åæ¥åŠ å…¥äº† Linux åŸºé‡‘ä¼šï¼Œéµä»äº† Apache 2.0 åè®®ï¼Œé¡¹ç›®ä»£ç åœ¨ GitHub ä¸Šè¿›è¡Œç»´æŠ¤ Docker è‡ªå¼€æºåå—åˆ°å¹¿æ³›çš„å…³æ³¨å’Œè®¨è®ºï¼Œä»¥è‡³äº dotCloud å…¬å¸åæ¥éƒ½æ”¹åä¸º Docker Incã€‚Redhat å·²ç»åœ¨å…¶ RHEL6.5 ä¸­é›†ä¸­æ”¯æŒ Dockerï¼›Google ä¹Ÿåœ¨å…¶ PaaS äº§å“ä¸­å¹¿æ³›åº”ç”¨ã€‚ Docker é¡¹ç›®çš„ç›®æ ‡æ˜¯å®ç°è½»é‡çº§çš„æ“ä½œç³»ç»Ÿè™šæ‹ŸåŒ–è§£å†³æ–¹æ¡ˆã€‚ Docker çš„åŸºç¡€æ˜¯ Linux å®¹å™¨ï¼ˆLXCï¼‰ç­‰æŠ€æœ¯ã€‚åœ¨ LXC çš„åŸºç¡€ä¸Š Docker è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼Œè®©ç”¨æˆ·ä¸éœ€è¦å»å…³å¿ƒå®¹å™¨çš„ç®¡ç†ï¼Œä½¿å¾—æ“ä½œæ›´ä¸ºç®€ä¾¿ã€‚ç”¨æˆ·æ“ä½œ Docker çš„å®¹å™¨å°±åƒæ“ä½œä¸€ä¸ªå¿«é€Ÿè½»é‡çº§çš„è™šæ‹Ÿæœºä¸€æ ·ç®€å•ã€‚ Dockerä¸ä¼ ç»Ÿè™šæ‹Ÿæœºçš„å¯¹æ¯”é€šè¿‡ä¸¤å¼ å›¾ï¼Œæ¥ç†è§£ä¸€ä¸‹Dockerä¸ä¼ ç»Ÿè™šæ‹Ÿæœºçš„å¯¹æ¯”ï¼Œé€šè¿‡ä¸‹é¢ä¸¤å¼ å›¾èƒ½çœ‹å‡ºæ¥DockerèŠ‚çœäº†å“ªäº›èµ„æºå³å¯,å…¶ä»–çš„å¥½å¤„åœ¨åé¢çš„å­¦ä¹ è¿‡ç¨‹ä¸­é™†ç»­ä»‹ç» Dockerç›®å‰åˆ†ä¸ºä¸¤ä¸ªç‰ˆæœ¬ Docker Enterprise Edition (Docker EE) ä¸“ä¸ºä¼ä¸šå¼€å‘å’ŒITå›¢é˜Ÿè®¾è®¡ï¼Œç”¨äºåœ¨å¤§è§„æ¨¡ç”Ÿäº§ä¸­æ„å»ºï¼Œè¿é€å’Œè¿è¡Œå…³é”®ä¸šåŠ¡åº”ç”¨ç¨‹åºDocker EEé›†æˆï¼Œè®¤è¯å’Œæ”¯æŒï¼Œä¸ºä¼ä¸šæä¾›ä¸šç•Œæœ€å®‰å…¨çš„å®¹å™¨å¹³å°ï¼Œä½¿æ‰€æœ‰åº”ç”¨ç¨‹åºç°ä»£åŒ– Docker Community Edition (Docker CE) æ˜¯å¼€å‘äººå‘˜å’Œå°å›¢é˜Ÿçš„ç†æƒ³é€‰æ‹©ï¼Œå¸Œæœ›å¼€å§‹ä½¿ç”¨Dockerå¹¶å°è¯•åŸºäºå®¹å™¨çš„åº”ç”¨ç¨‹åºDocker CEå¯åœ¨è®¸å¤šå¹³å°ä¸Šä½¿ç”¨ï¼Œä»æ¡Œé¢åˆ°äº‘åˆ°æœåŠ¡å™¨ ç¯å¢ƒDockerç³»åˆ—å­¦ä¹ ä¸»è¦é€šè¿‡ VirtualBox åœ¨ Ubuntu16.04 ä¸­å®Œæˆå®‰è£…ä»¥åŠåç»­è¿›é˜¶è¯¾ç¨‹çš„å­¦ä¹ , Dockerç‰ˆæœ¬ä¸ºDockerCE å®‰è£…å®‰è£…Ubuntu16.04VirtualBox å®‰è£…Ubuntu1604è¯·å‚è€ƒåœ¨virtualboxä¸‹å®‰è£…ubuntu server 16.04 å®‰è£…dockeræŒ‰ç…§Dockerå®˜ç½‘Get Docker CE for Ubuntuæè¿°å®‰è£…DockerCE æ£€æŸ¥å®‰è£…æ¡ä»¶Docker è¦æ±‚ Ubuntu ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬é«˜äº 3.10 ï¼ŒæŸ¥çœ‹æœ¬é¡µé¢çš„å‰ææ¡ä»¶æ¥éªŒè¯ä½ çš„ Ubuntu ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ Dockerã€‚é€šè¿‡ uname -r å‘½ä»¤æŸ¥çœ‹ä½ å½“å‰çš„å†…æ ¸ç‰ˆæœ¬ 1$ uname -r å¸è½½æ—§çš„ç‰ˆæœ¬è€çš„Dockerç‰ˆæœ¬æˆ‘ä»¬å«åšdockeræˆ–docker-engine, å¦‚æœä¹‹å‰å®‰è£…è¿‡ï¼Œè¿™é‡Œéœ€è¦å…ˆå¸è½½, Docker CE packageç°åœ¨å«åšdocker-ce 1$ sudo apt-get remove docker docker-engine docker.io æ­å»ºDockerä»“åº“é¦–æ¬¡åœ¨å®¿ä¸»æœºä¸Šå®‰è£…DockerCEï¼Œéœ€è¦æ­å»ºDocker repository,æ­å»ºå®Œæˆåï¼Œå¯ä»¥é€šè¿‡repositoryå®‰è£…æˆ–æ›´æ–°Docker. æ›´æ–°apt package1$ sudo apt-get update å…è®¸aptç”¨httpsæ–¹å¼è®¿é—®Dockerä»“åº“ï¼ˆå‘½ä»¤å¤ªé•¿å¯ä»¥ç”¨ \\ ç¬¦å·æ¢è¡Œï¼‰12345$ sudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ software-properties-common æ·»åŠ Dockerçš„å®˜æ–¹GPGå¯†é’¥1$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - éªŒè¯fingerprint 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88, ç”¨åå…«ä½å­—ç¬¦å³å¯ 1$ sudo apt-key fingerprint 0EBFCD88 è®¾ç½®ç¨³å®šç‰ˆRepository1234$ sudo add-apt-repository \\ \"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\ $(lsb_release -cs) \\ stable\" å®‰è£…Docker CE æ›´æ–°aptç´¢å¼•1$ sudo apt-get update å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„Docker CE1$ sudo apt-get install docker-ce ç”Ÿäº§ç¯å¢ƒæŒ‡å®šDockerç‰ˆæœ¬ç”Ÿäº§ç¯å¢ƒä¸ºäº†ç¨³å®šæ€§ä¼šé€‰æ‹©æŒ‡å®šç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯Dokcerçš„æœ€æ–°ç‰ˆæœ¬ï¼ŒæŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬ï¼š123$ apt-cache madison docker-cedocker-ce | 17.09.0~ce-0~ubuntu | https://download.docker.com/linux/ubuntu xenial/stable amd64 Packages å®‰è£…æŒ‡å®šDocker CE ç‰ˆæœ¬1$ sudo apt-get install docker-ce=&lt;VERSION&gt; ç¡®è®¤Docker CE æ˜¯å¦å®‰è£…æˆåŠŸ ä»”ç»†é˜…è¯»docker run hello-worldçš„è¾“å‡ºå†…å®¹ï¼Œå¯¹äºç†è§£dockerçš„å·¥ä½œåŸç†æœ‰å¸®åŠ© 12$ sudo docker run hello-world$ sudo docker version å¯åŠ¨Docker1$ systemctl start docker é‡æ–°å¯åŠ¨Docker1$ systemctl restart docker Dockerå‘½ä»¤å»æ‰sudoé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¯æ¬¡æ•²dockerå‘½ä»¤éƒ½éœ€è¦sudoæƒé™ï¼Œä¸‹é¢çš„æ–¹æ³•å¯ä»¥çœå»sudoæ–¹ä¾¿å¾ˆå¤š. åˆ›å»ºdockerç»„1$ sudo groupadd docker æ·»åŠ å½“å‰ç”¨æˆ·åˆ°dockerç»„1$ sudo usermod -aG docker $USER ç™»å‡ºï¼Œé‡æ–°ç™»å½•shell éªŒè¯dockerå‘½ä»¤æ˜¯å¦å¯ä»¥è¿è¡Œï¼ˆæ³¨æ„æ²¡æœ‰sudoï¼‰1$ docker run hello-world","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Docker","slug":"Coding/Docker","permalink":"https://dayarch.top/categories/Coding/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://dayarch.top/tags/Docker/"}]},{"title":"æŒ‡æ•°åŸºé‡‘äº¤æ˜“ä¼šäº§ç”Ÿå“ªäº›è´¹ç”¨","slug":"æŒ‡æ•°åŸºé‡‘äº¤æ˜“ä¼šäº§ç”Ÿå“ªäº›è´¹ç”¨","date":"2017-06-09T01:58:14.000Z","updated":"2019-11-01T09:02:37.016Z","comments":true,"path":"/p/investment-index-fee.html","link":"","permalink":"https://dayarch.top/p/investment-index-fee.html","excerpt":"å¼•è¨€ åœ¨è´­ä¹°æŒ‡æ•°åŸºé‡‘æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è®©äººçœ¼èŠ±ç¼­ä¹±çš„å„ç§è´¹ç”¨ï¼Œæ—¢ç„¶ç†è´¢äº†ï¼Œå°±è¦çŸ¥é“ï¼š 1. æˆ‘ä»¬ä¸ºäº†è´­ä¹°è¿™äº›åŸºé‡‘éƒ½å‘ç”Ÿäº†é‚£äº›è´¹ç”¨ï¼Ÿ 2. æ€æ ·è´­ä¹°æ–¹å¼èƒ½èŠ‚çœè¿™äº›è´¹ç”¨ï¼Ÿ äº†è§£è¿™äº›å¯¹äºæˆ‘ä»¬è´¢å¯Œå¢é•¿å°†ä¼šèµ·åˆ°é‡è¦ä½œç”¨ï¼Œ ä»¥ä¸‹æ–‡ç« æ˜¯å€Ÿé‰´å‰è¾ˆâ€é“¶è¡Œèºä¸é’‰â€ çš„æ–‡ç« åŠ ä»¥æ€»ç»“. é’±éƒ½èŠ±åˆ°å“ªé‡Œå»äº† ç”³è´­è´¹ã€èµå›è´¹ã€äº¤æ˜“ä½£é‡‘ã€å°èŠ±ç¨ã€æœåŠ¡è´¹ã€æ‰˜ç®¡è´¹ã€ç®¡ç†è´¹â€¦â€¦, åœ¨äº†è§£è¿™ä¹ˆå¯¹è´¹ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æŒ‡æ•°åŸºé‡‘æŒ‰ç…§è´­ä¹°æ–¹å¼å¯ä»¥åˆ†ä¸ºï¼š 1. åœºå†…åŸºé‡‘ åœºå†…åŸºé‡‘æŒ‡çš„æ˜¯ä¸Šå¸‚ï¼ˆè‚¡å¸‚ï¼‰äº¤æ˜“çš„åŸºé‡‘ï¼Œåªèƒ½ç”¨è¯åˆ¸å¸æˆ·è´­ä¹°ï¼Œä¸»è¦æ˜¯å°é—­å¼åŸºé‡‘å’Œä¸Šå¸‚å‹å¼€æ”¾å¼åŸºé‡‘ï¼ˆLOFåŸºé‡‘ï¼‰ 2. åœºå¤–åŸºé‡‘","text":"å¼•è¨€åœ¨è´­ä¹°æŒ‡æ•°åŸºé‡‘æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è®©äººçœ¼èŠ±ç¼­ä¹±çš„å„ç§è´¹ç”¨ï¼Œæ—¢ç„¶ç†è´¢äº†ï¼Œå°±è¦çŸ¥é“ï¼š æˆ‘ä»¬ä¸ºäº†è´­ä¹°è¿™äº›åŸºé‡‘éƒ½å‘ç”Ÿäº†é‚£äº›è´¹ç”¨ï¼Ÿ æ€æ ·è´­ä¹°æ–¹å¼èƒ½èŠ‚çœè¿™äº›è´¹ç”¨ï¼Ÿ äº†è§£è¿™äº›å¯¹äºæˆ‘ä»¬è´¢å¯Œå¢é•¿å°†ä¼šèµ·åˆ°é‡è¦ä½œç”¨ï¼Œ ä»¥ä¸‹æ–‡ç« æ˜¯å€Ÿé‰´å‰è¾ˆâ€é“¶è¡Œèºä¸é’‰â€ çš„æ–‡ç« åŠ ä»¥æ€»ç»“. é’±éƒ½èŠ±åˆ°å“ªé‡Œå»äº†ç”³è´­è´¹ã€èµå›è´¹ã€äº¤æ˜“ä½£é‡‘ã€å°èŠ±ç¨ã€æœåŠ¡è´¹ã€æ‰˜ç®¡è´¹ã€ç®¡ç†è´¹â€¦â€¦, åœ¨äº†è§£è¿™ä¹ˆå¯¹è´¹ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æŒ‡æ•°åŸºé‡‘æŒ‰ç…§è´­ä¹°æ–¹å¼å¯ä»¥åˆ†ä¸ºï¼š åœºå†…åŸºé‡‘ åœºå†…åŸºé‡‘æŒ‡çš„æ˜¯ä¸Šå¸‚ï¼ˆè‚¡å¸‚ï¼‰äº¤æ˜“çš„åŸºé‡‘ï¼Œåªèƒ½ç”¨è¯åˆ¸å¸æˆ·è´­ä¹°ï¼Œä¸»è¦æ˜¯å°é—­å¼åŸºé‡‘å’Œä¸Šå¸‚å‹å¼€æ”¾å¼åŸºé‡‘ï¼ˆLOFåŸºé‡‘ï¼‰ åœºå¤–åŸºé‡‘ åœºå¤–åŸºé‡‘ä¸ä¸Šå¸‚äº¤æ˜“ï¼Œæ˜¯åªèƒ½åœ¨æŒ‡å®šçš„ç½‘ç‚¹ï¼ˆé“¶è¡Œã€åŸºé‡‘å…¬å¸ã€è¯åˆ¸å…¬å¸ç­‰ï¼‰ç”³è´­çš„åŸºé‡‘ï¼Œå¦‚ä¸€èˆ¬çš„å¼€æ”¾å¼åŸºé‡‘ åœºå†…åŸºé‡‘ï¼Œä¾‹å¦‚ETFåŸºé‡‘ï¼Œå®ƒæ—¢å¯ä»¥ç”³è´­èµå›ï¼Œåˆå¯ä»¥ä¹°å–ã€‚ç”³è´­èµå›éœ€è¦å‡ åä¸‡èµ·ï¼Œä¹°å–åˆ™æ˜¯100è‚¡èµ·ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬æ˜¯é€šè¿‡ä¹°å–è·å–ETFåŸºé‡‘ã€‚åœºå¤–åŸºé‡‘ä¸€èˆ¬åªæœ‰ç”³è´­èµå›ï¼Œå¤§éƒ¨åˆ†æ˜¯1000å…ƒèµ·ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€šè¿‡ç”³èµè·å–åœºå¤–åŸºé‡‘ï¼Œå…ˆåšä¸€ä¸ªè¡¨æ ¼æ¥è¯´æ˜è¿™äº›è´¹ç”¨éƒ½å‘ç”Ÿåœ¨å“ªäº›åŸºé‡‘ä¸Š åŸºé‡‘\\è´¹ç”¨ ç”³è´­è´¹ èµå›è´¹ äº¤æ˜“ä½£é‡‘ å°èŠ±ç¨ æœåŠ¡è´¹ æ‰˜ç®¡è´¹ ç®¡ç†è´¹ åœºå†…åŸºé‡‘ æ—  æ—  æœ‰ æœ‰ æ—  æœ‰ æœ‰ åœºå¤–åŸºé‡‘ æœ‰ æœ‰ æ—  æ—  æœ‰/æ—  æœ‰ æœ‰ è´¹ç”¨è¯¦è§£ ç”³è´­è´¹å’Œèµå›è´¹ åœºå†…åŸºé‡‘ä¹Ÿå¯ä»¥ç”³è´­ï¼Œæˆ‘åœ¨ä¸Šé¢è¡¨æ ¼ä¸­æ²¡æœ‰å†™, å› ä¸ºä¾‹å¦‚ETFåŸºé‡‘ç”³è´­ä¸€èˆ¬æ˜¯å‡ åä¸‡èµ·ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸é€šè¿‡ç”³è´­è¿™ä¸€é€”å¾„è·å–ETFåŸºé‡‘ï¼Œè€Œæ˜¯é€šè¿‡åœºå†…ä¹°å–ETFæ¥è·å–ã€‚ä¹°å–è·Ÿè‚¡ç¥¨ä¸€æ ·ï¼Œ100è‚¡èµ·ä¹°ï¼› åœºå¤–åŸºé‡‘ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”³è´­è·å¾—ã€‚äº¤æ˜“æ—¥ä¸‹åˆ3ç‚¹å‰ç”³è´­ï¼ŒæŒ‰ç…§å½“å¤©æ”¶ç›˜çš„åŸºé‡‘å‡€å€¼ç”³è´­ï¼›3ç‚¹åï¼ŒæŒ‰ç…§ä¸‹ä¸€äº¤æ˜“æ—¥æ”¶ç›˜åŸºé‡‘å‡€å€¼ç”³è´­ã€‚ ä»¥æˆ‘å¼€å§‹æŠ•èµ„åœºå¤–åŸºé‡‘çš„å¹³å°å—æ–¹åŸºé‡‘æ¥çœ‹ä¸‹å›¾ï¼š å¦‚æœé¢‘ç¹æ“ä½œè´­ä¹°ï¼Œ1-1.5%çš„ç”³è´­ä¸èµå›è´¹ç”¨è¿˜æ˜¯éå¸¸é«˜çš„ï¼Œè´­ä¹°1ä¸‡å…ƒå°±è¦100åˆ°150å…ƒçš„æˆæœ¬ï¼Œè´­ä¹°æŒ‡æ•°åŸºé‡‘æˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šæŒæœ‰è‡³å°‘ä¸‰å¹´ä»¥ä¸Šï¼Œç°åœ¨å¥½å¤šåŸºé‡‘å¹³å°éƒ½æ¨å‡ºç”³è´­é›¶æ‰‹ç»­è´¹ï¼Œå¦‚æœæŒæœ‰è¶…è¿‡ä¸¤å¹´ä¹Ÿå…æ‰èµå›è´¹ç”¨. äº¤æ˜“ä½£é‡‘(ä¹°å–ä½£é‡‘) äº¤æ˜“ä½£é‡‘é’ˆå¯¹åœºå†…åŸºé‡‘æ¥çš„ã€‚ä¸Šé¢è¯´è¿‡ï¼Œåœºå†…åŸºé‡‘å¯ä»¥é€šè¿‡ä¹°å–æ¥è·å¾—ï¼Œè·Ÿè‚¡ç¥¨ä¸€æ ·ã€‚éœ€è¦å»åˆ¸å•†å¼€è‚¡ç¥¨è´¦æˆ·ï¼Œç›®å‰åŸºæœ¬æ‰€æœ‰åˆ¸å•†å¼€æˆ·éƒ½æ˜¯å…è´¹çš„ã€‚äº¤æ˜“è´¹ç‡è·Ÿè‚¡ç¥¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ¨åˆ†åˆ¸å•†å¯ä»¥å•†è®®ã€‚ä¸ç¡®å®šçš„è¯å¯ä»¥è”ç³»è‡ªå·±çš„åˆ¸å•†å®¢æˆ·ç»ç†ç¡®å®šï¼Œæ²¡æœ‰ä»»ä½•åšå¹¿å‘Šçš„å«Œç–‘ï¼Œæˆ‘ç°åœ¨ç”¨åæ³°è¯åˆ¸ï¼Œè´¹ç‡è¿˜æ˜¯å¾ˆåˆé€‚çš„. å°èŠ±ç¨ å°èŠ±ç¨ä¹Ÿæ˜¯é’ˆå¯¹åœºå†…çš„å“ç§æ¥è¯´çš„ï¼Œè‚¡ç¥¨ä¹°å–äº¤æ˜“æ˜¯éœ€è¦äº¤å°èŠ±ç¨çš„ã€‚å°èŠ±ç¨æ˜¯è‚¡ç¥¨äº¤æ˜“éå¸¸é‡è¦çš„ä¸€ä¸ªç¨ç§ï¼Œç”šè‡³å¯ä»¥èµ·åˆ°è°ƒèŠ‚è‚¡å¸‚ç‰›ç†Šçš„ä½œç”¨ã€‚å°èŠ±ç¨æ˜¯åœ¨ä¹°å–è‚¡ç¥¨äº¤å‰²çš„æ—¶å€™åˆ¸å•†å°±ä»£ä¸ºæ‰£æ”¶äº†ï¼Œä¹°å–å®Œè‚¡ç¥¨åç¬¬äºŒå¤©æŸ¥ä¸‹äº¤å‰²å•å°±å¯ä»¥çŸ¥é“æ‰£äº†å¤šå°‘å°èŠ±ç¨ã€‚ç›®å‰è‚¡ç¥¨äº¤æ˜“çš„å°èŠ±ç¨æ˜¯äº¤æ˜“é¢çš„åƒåˆ†ä¹‹ä¸€ï¼Œå•è¾¹æ”¶å–ï¼Œå³ä¹°è‚¡ç¥¨ä¸æ”¶ï¼Œå–è‚¡ç¥¨æ”¶ã€‚å¯¹åœºå†…åŸºé‡‘æ¥è¯´ï¼Œç›®å‰ä¸éœ€è¦äº¤å°èŠ±ç¨ é”€å”®æœåŠ¡è´¹ æˆ‘ä»¬ç»å¸¸èƒ½çœ‹åˆ°ä¸€äº›åŸºé‡‘å…¬å¸å®£ä¼ æŸåªæŒ‡æ•°åŸºé‡‘ç”³èµè´¹ç”¨å…¨å…ã€‚è¿™é‡Œå…ç”³èµè´¹ç”¨çš„åŸºé‡‘æŒ‡çš„æ˜¯Cç±»åŸºé‡‘ã€‚æ˜¯é’ˆå¯¹åœºå¤–åŸºé‡‘æ¥è¯´çš„ã€‚ä¸€èˆ¬çš„åœºå¤–æŒ‡æ•°åŸºé‡‘ï¼Œæ˜¯æ”¶å–ç”³è´­èµå›è´¹ï¼Œä¸ç®¡ä¹°å–é¢‘ç‡å¦‚ä½•ã€‚è¿™æ ·å¯¹äºä¸€äº›é¢‘ç¹æ“ä½œåœºå¤–åŸºé‡‘çš„æŠ•èµ„è€…ï¼Œäº¤æ˜“æˆæœ¬æ˜¯éå¸¸é«˜çš„ã€‚Cç±»åŸºé‡‘æ¯”è¾ƒç‰¹æ®Šã€‚å®ƒä¸æ”¶å–ç”³è´­è´¹ç”¨ï¼Œä¸€èˆ¬æŒæœ‰ä¸€ä¸ªæœˆä»¥ä¸Šèµå›ä¹Ÿä¸æ”¶å–èµå›è´¹ç”¨ã€‚ä½†ä¼šå›ºå®šæ”¶å–ä¸€å®šæ¯”ä¾‹çš„é”€å”®æœåŠ¡è´¹ï¼Œä¸€èˆ¬æ˜¯0.4-0.6%ã€‚è¿™æ ·å°±æŠŠäº¤æ˜“æˆæœ¬å›ºå®šä¸‹æ¥äº†, ä¾æ—§ä»¥å—æ–¹åŸºé‡‘ä¸¾ä¾‹ ä¸è¿‡æˆ‘æŠ•èµ„æŒ‡æ•°åŸºé‡‘ä¸€èˆ¬æ˜¯åœ¨ä½ä¼°å€¼çš„æ—¶å€™åˆ†æ‰¹ä¹°ï¼Œé«˜ä¼°å€¼çš„æ—¶å€™åˆ†æ‰¹å–ï¼Œä¸€èˆ¬éœ€è¦æŒæœ‰ä¸€å¹´æˆ–å¤šå¹´ä»¥ä¸Šã€‚è¿™ç§æƒ…å†µä¸‹æŒ‘é€‰ç”³è´­è´¹ä¸€æŠ˜çš„å¹³å°ç”³è´­åœºå¤–åŸºé‡‘ï¼Œäº¤æ˜“æˆæœ¬å¯ä»¥æ§åˆ¶åœ¨åƒä¸€å·¦å³ï¼ŒæŒæœ‰ä¸¤å¹´ä»¥ä¸Šä¹Ÿæ²¡æœ‰äº†èµå›è´¹ï¼›Cç±»åŸºé‡‘åˆ™éœ€è¦å›ºå®šäº¤åƒå››åˆ°åƒå…­ï¼Œå¦‚æœä¸æ˜¯é¢‘ç¹ç”³èµï¼Œä¸æ˜¯ç‰¹åˆ«å¥½çš„é€‰æ‹© æ‰˜ç®¡è´¹ç®¡ç†è´¹ ä¸Šé¢è¯´çš„è´¹ç”¨éƒ½æ˜¯åœ¨åŸºé‡‘äº¤æ˜“ç›¸å…³çš„è´¹ç”¨ã€‚å®é™…ä¸ŠåŸºé‡‘åœ¨è¿è¥çš„æ—¶å€™è¿˜ä¼šäº§ç”Ÿç®¡ç†è´¹å’Œæ‰˜ç®¡è´¹ã€‚è¿™ä¸¤é¡¹è´¹ç”¨ä¼šç›´æ¥ä»åŸºé‡‘å‡€å€¼ä¸­æ‰£ã€‚ç®¡ç†è´¹å°±æ˜¯åŸºé‡‘å…¬å¸çš„ä¸€ä¸ªéå¸¸é‡è¦çš„åˆ©æ¶¦æ¥æºã€‚ä¸»åŠ¨å‹åŸºé‡‘ä¸€èˆ¬ä¼šæ”¶å–åŸºé‡‘è§„æ¨¡çš„1.5%ä½œä¸ºç®¡ç†è´¹ã€‚ä¾‹å¦‚ç®¡ç†10ä¸ªäº¿çš„èµ„äº§çš„è‚¡ç¥¨åŸºé‡‘ï¼Œä¸€å¹´ä¼šæ”¶å–1500ä¸‡çš„ç®¡ç†è´¹ã€‚æŒ‡æ•°åŸºé‡‘ä½œä¸ºè¢«åŠ¨å‹åŸºé‡‘ï¼Œç®¡ç†è´¹ç‡ä¸€èˆ¬ä½ä¸€äº›ã€‚å›½å†…æŒ‡æ•°åŸºé‡‘çš„å¹³å‡ç®¡ç†è´¹ç‡åœ¨0.83%å·¦å³ã€‚éƒ¨åˆ†è§„æ¨¡è¾ƒå¤§ã€è¿è¡Œæ—¶é—´è¾ƒé•¿çš„åŸºé‡‘ï¼Œç®¡ç†è´¹ç‡ä¼šé™åˆ°0.5%ã€‚è¿™äº›å¯ä»¥åœ¨åŸºé‡‘çš„å…¬å‘Šä¸­æŸ¥çœ‹ã€‚æ‰˜ç®¡è´¹æ˜¯äº¤ç»™åŸºé‡‘çš„æ‰˜ç®¡æ–¹çš„ã€‚åŸºé‡‘çš„åºå¤§èµ„äº§ï¼Œå¹¶ä¸æ˜¯ç›´æ¥å­˜æ”¾åœ¨åŸºé‡‘å…¬å¸ï¼Œä¸€èˆ¬ä¼šåœ¨ç¬¬ä¸‰æ–¹æ‰˜ç®¡æ–¹ï¼Œä¾‹å¦‚æŸå®¶å¤§å‹é“¶è¡Œã€‚åƒæˆ‘ä»¬ç†ŸçŸ¥çš„50ETFï¼ˆ510050ï¼‰ï¼Œå®ƒçš„æ‰˜ç®¡æ–¹å°±æ˜¯å·¥å•†é“¶è¡Œã€‚å›½å†…æŒ‡æ•°åŸºé‡‘çš„æ‰˜ç®¡è´¹ç‡å¹³å‡åœ¨0.17%å·¦å³ï¼Œä½çš„å¯ä»¥åšåˆ°0.15% æ€»ç»“æŒ‰ç…§ä¸Šé¢çš„è¡¨æ ¼ä»¥åŠè´¹ç”¨è¯¦ç»†åšå‡ºå¦‚ä¸‹æ€»ç»“ï¼š æ€»ä½“æ¥è¯´ï¼ŒæŠ•èµ„æŒ‡æ•°åŸºé‡‘ï¼Œæ— è®ºåœºå†…è¿˜æ˜¯åœºå¤–ï¼Œç®¡ç†è´¹å’Œæ‰˜ç®¡è´¹éƒ½è¦äº¤çš„ï¼Œä¼šä»åŸºé‡‘å‡€å€¼ä¸­æ‰£ï¼ˆæˆ‘ä»¬æ— èƒ½ä¸ºåŠ›ï¼‰ åœºå†…åŸºé‡‘ä¼šæ”¶å–äº¤æ˜“ä½£é‡‘å’Œå°èŠ±ç¨ã€‚ç›®å‰åœºå†…åŸºé‡‘å°èŠ±ç¨ä¸‹è°ƒåˆ°äº†0ï¼Œäº¤æ˜“ä½£é‡‘ä¸åŒåˆ¸å•†ä¸ä¸€æ · åœºå¤–åŸºé‡‘å¦‚æœä¸æ˜¯Cç±»åŸºé‡‘ï¼Œä¼šæ”¶å–ç”³è´­è´¹ï¼Œèµå›è´¹æŒæœ‰è¶…ä¸¤å¹´å¯å…ï¼›Cç±»åŸºé‡‘é€‚åˆé¢‘ç¹ç”³èµçš„æœ‹å‹ï¼Œä¼šæ”¶å–çº¦0.4-0.6%çš„é”€å”®æœåŠ¡è´¹ã€‚å®šæŠ•çš„è¯é€‰æ™®é€šçš„åœºå¤–åŸºé‡‘å°±å¥½ï¼Œä¸ç”¨é€‰Cç±»ï¼ˆå› ä¸ºæˆ‘ä»¬ä¼šæŒæœ‰è¿™ä¸ªåŸºé‡‘è‡³å°‘3å¹´ä»¥ä¸Šï¼‰ æˆ‘ä»¬ç»å¸¸çœ‹åˆ°æŸä¸€åªè‚¡ç¥¨ä¸Šæ ‡æ³¨ä¸€ä¸ªâ€œèâ€å­—ï¼Œé‚£è¿™ä¸ªå­—çš„å«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ è¿™ä¸ªè¯è·ç¦»èµ„é‡‘é‡è¿˜ä¸æ˜¯å¾ˆå¤§çš„æŠ•èµ„è€…æ¥è¯´å…¶å®æ˜¯ä¸€ä¸ªæ¯”è¾ƒé¥è¿œçš„ï¼Œå› ä¸ºèƒ½åšåˆ°èèµ„èåˆ¸ä¸åŒçš„åˆ¸å•†å¯¹æŠ•èµ„è€…è¿˜æœ‰æœ‰å¾ˆé«˜çš„è§„æ ¼é™åˆ¶çš„ï¼Œä¸è¿‡è¿™ä¸ªâ€œèâ€å­—çš„å†…åœ¨å«ä¹‰è¿˜æ˜¯éå¸¸æœ‰æ„æ€çš„. èâ€”â€”èèµ„èåˆ¸èèµ„èåˆ¸æ˜¯åˆ¸å•†å¼€æ‹“çš„ä¸šåŠ¡ï¼Œéƒ½æ˜¯å‘ç”Ÿåœ¨åˆ¸å•†å’ŒæŠ•èµ„è€…ä¹‹é—´ï¼Œå’Œä¸Šå¸‚å…¬å¸æœ¬ç”Ÿæ²¡å…³ç³»ã€‚ èï¼šå°±æ˜¯æ‰©å¤§ï¼Œå¼€æ‹“çš„æ„æ€ èèµ„ï¼šå…¶å®å°±æ˜¯å€Ÿé’± èåˆ¸ï¼šå°±æ˜¯å€Ÿè‚¡ç¥¨ å€Ÿé’±æˆ‘ä»¬å¥½ç†è§£ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦å€Ÿè‚¡ç¥¨å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ä¸­å›½è‚¡ç¥¨å¸‚åœºåªèƒ½åšå¤šï¼Œå°±æ˜¯ä½ ä¹°äº†è‚¡ç¥¨åªèƒ½ç­‰å¾…ä¸Šæ¶¨è·åˆ©ï¼Œå¦‚æœè‚¡ç¥¨ä¸‹è·Œå°±æ²¡æ³•è·åˆ©äº†ï¼Œè€Œèåˆ¸å°±æä¾›äº†ä¸€ç§åšç©ºçš„å·¥å…·ã€‚ ä¸¾ä¾‹è¯´æ˜ èèµ„ï¼šæŠ•èµ„è€…çœ‹å¥½ä¸€åªè‚¡ç¥¨åœ¨æœªæ¥ä¼šæœ‰ä¸Šå‡è¶‹åŠ¿ï¼Œè‹¦äºæ‰‹ä¸­æ²¡æœ‰é“¶ä¸¤æ¥è´­ä¹°è‚¡ç¥¨ï¼Œäºæ˜¯ä¹æ‰“ç®—å‘åˆ¸å•†å€Ÿé’±æ¥è´­ä¹°è¯¥è‚¡ç¥¨ï¼Œç­‰åˆ°æŒ‡å®šæœŸé™å°†é’±è¿˜ç»™åˆ¸å•†åŒæ—¶è¿˜è¦æ”¯ä»˜ä¸€äº›åˆ©æ¯ï¼ˆé’±ä¸èƒ½æ˜¯ç™½å€Ÿçš„å•Šï¼‰ å¼ ä¸‰çœ‹å¥½è‚¡ç¥¨Aåœ¨æœªæ¥ä¼šæœ‰ä¸Šå‡è¶‹åŠ¿ï¼Œæ‰‹ä¸­å´æ²¡æœ‰é“¶ä¸¤ï¼Œå¼ ä¸‰å·²ç»å…·å¤‡äº†èèµ„çš„èµ„æ ¼ï¼ˆä¸åŒçš„åˆ¸å•†æ ‡å‡†ä¸ä¸€æ ·ï¼Œè¯·å’¨è¯¢å…·ä½“çš„åˆ¸å•†ç»ç†ï¼‰ï¼Œäºæ˜¯ä¹å‘åˆ¸å•†å€Ÿäº†1ä¸‡å…ƒé’±ä»¥æ¯è‚¡10å…ƒçš„ä»·æ ¼è´­ä¹°äº†1000è‚¡ï¼Œåˆ¸å•†åå®šçš„è¿˜æ¬¾æ—¥æœŸåˆ°äº†ï¼Œæ­¤æ—¶è‚¡ç¥¨Açš„è‚¡ä»·å·²ç»æ¶¨åˆ°äº†20å…ƒï¼Œè¿™ä¼šæˆ‘è¿˜æ˜¯è¿˜åˆ¸å•†1ä¸‡å…ƒé’±+åˆ©æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™æ¬¡èèµ„çš„è¿‡ç¨‹ä¸­ï¼ˆé™¤å»åˆ©æ¯ï¼‰èµšäº†20000-10000=10000ï¼ˆå…ƒï¼‰ èåˆ¸ï¼šä¸èèµ„ç›¸åï¼ŒæŠ•èµ„è€…è§‰å¾—æŸè‚¡Aå…·æœ‰æ˜æ˜¾çš„ä¸‹è·Œç©ºé—´ï¼Œä½†æ˜¯æ‰‹ä¸­å¹¶æ²¡æœ‰è¯¥è‚¡ï¼Œäºæ˜¯ä¹æ‰“ç®—å‘åˆ¸å•†å€Ÿæ¥è‚¡ç¥¨å–å‡ºå» å¼ ä¸‰è§‰å¾—æŸè‚¡Aå…·æœ‰æ˜æ˜¾çš„ä¸‹è·Œç©ºé—´ï¼Œä½†æ˜¯æ‰‹ä¸­å¹¶æ²¡æœ‰è¯¥è‚¡ï¼Œäºæ˜¯å‘åˆ¸å•†å€Ÿäº†100æ‰‹äº10å…ƒå–å‡ºï¼Œå¾—10ä¸‡å…ƒï¼Œç­‰åˆ°è¯¥è‚¡ä¸‹è·Œåˆ°9å…ƒåä¹°å›100æ‰‹è¯¥è‚¡è¿˜ç»™åˆ¸å•†ï¼Œä¹°å›åªç”¨äº†9ä¸‡ï¼Œè·åˆ©1ä¸‡å…ƒã€‚è¿™å°±æ˜¯ä¸€ç§å…¸å‹çš„èåˆ¸ èåˆ¸è¿˜æœ‰ä¸€ç§æ–¹å¼å«åšå¯¹å†²ï¼Œè¯•ä¸¾ä¾‹è¯´æ˜ï¼šæŠ•èµ„è€…å½“å¤©äº10å…ƒä¹°å…¥æŸè‚¡100æ‰‹ï¼Œå½“å¤©å°±æ¶¨åˆ°äº11å…ƒï¼ŒæŠ•èµ„è€…æƒ³äºè¯¥ç‚¹å–å‡ºï¼Œä½†æ˜¯è‹¦äºä¸­å›½è‚¡å¸‚æ˜¯T+1åˆ¶åº¦ï¼Œå½“å¤©ä¹°è¿›çš„è‚¡ç¥¨å½“å¤©ä¸èƒ½å–å‡ºã€‚è¿™æ—¶ä½ å¯ä»¥èåˆ¸è¯¥è‚¡100æ‰‹äº11å…ƒå–å‡ºï¼Œè€ŒæŠŠæ‰‹ä¸­çš„100æ‰‹è¿˜ç»™åˆ¸å•†ï¼Œå°±ç›¸å½“äºåšäº†ä¸ªT+0. æ³¨æ„ å®é™…æ“ä½œä¸­è¿˜æœ‰å¾ˆå¤šé™åˆ¶ï¼Œæ¯”å¦‚â€œæ ‡çš„â€å°±æ˜¯ä¸€ç§ï¼Œä½ ä¸èƒ½å¯¹ä»»ä½•è‚¡ç¥¨éƒ½è¿›è¡Œèåˆ¸ï¼Œè€Œåªèƒ½å¯¹åˆ¸å•†æŒ‡å®šçš„è‚¡ç¥¨ç¾¤è¿›è¡Œèåˆ¸ï¼Œè¿™ä¸ªè‚¡ç¥¨ç¾¤å°±å«â€œæ ‡çš„â€ã€‚ å¦ä¸€ä¸ªé™åˆ¶å°±æ˜¯åˆ¸å•†æ‰‹ä¸­æœ‰å¯èƒ½æ²¡æœ‰ä½ æƒ³èåˆ¸çš„â€œæ ‡çš„â€ï¼Œå› ä¸ºåˆ¸å•†ä¹Ÿä¸å‚»ï¼Œä½ æƒ³å–çš„è‚¡ç¥¨ï¼Œå¤šåŠåˆ¸å•†ä¹Ÿä¸æƒ³ç•™åœ¨æ‰‹ä¸­ã€‚ã€‚ã€‚æ‰€ä»¥åœ¨è€ƒè™‘èåˆ¸ä¹‹å‰è¦æŸ¥è¯¢ä¸€ä¸‹åˆ¸å•†æ‰‹ä¸­æ˜¯å¦è¿˜æœ‰è¯¥è‚¡ç¥¨ã€‚ å¦å¤–ï¼Œå€Ÿï¼Œå°±è¦æœ‰åˆ©æ¯ï¼Œä¸ç®¡èèµ„è¿˜æ˜¯èåˆ¸éƒ½æŒ‰ç…§ç›¸å…³å¸‚å€¼çš„é“¶è¡Œåˆ©æ¯ç»“ç®—ï¼ˆå¤§è‡´å¦‚æ­¤ï¼‰ï¼Œä½†æ˜¯å¾ˆå¤šåˆ¸å•†éƒ½è§„å®šï¼šå½“å¤©å€Ÿå½“å¤©è¿˜æ²¡åˆ©æ¯ï¼Œæ‰€ä»¥æœ‰åˆ©äºåšT+0","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"æŠ•èµ„ç†è´¢å­¦ä¹ ","slug":"Life/æŠ•èµ„ç†è´¢å­¦ä¹ ","permalink":"https://dayarch.top/categories/Life/%E6%8A%95%E8%B5%84%E7%90%86%E8%B4%A2%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"è´¹ç”¨","slug":"è´¹ç”¨","permalink":"https://dayarch.top/tags/%E8%B4%B9%E7%94%A8/"},{"name":"æŒ‡æ•°åŸºé‡‘","slug":"æŒ‡æ•°åŸºé‡‘","permalink":"https://dayarch.top/tags/%E6%8C%87%E6%95%B0%E5%9F%BA%E9%87%91/"}]},{"title":"Javaå¤šæ€è°ƒç”¨é¡ºåº","slug":"Javaå¤šæ€è°ƒç”¨é¡ºåº","date":"2017-05-05T12:21:20.000Z","updated":"2019-11-07T06:36:20.433Z","comments":true,"path":"/p/java-polymorphism-order.html","link":"","permalink":"https://dayarch.top/p/java-polymorphism-order.html","excerpt":"Javaå¤šæ€è°ƒç”¨è¯¥æ¡ˆä¾‹ å¤§å®¶å…ˆçœ‹è‡ªè¡Œæµ‹è¯•å¦‚ä¸‹ç¨‹åºçš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 public class A { public String show(D obj) { return (\"A and D\"); } public String show(A obj) {","text":"Javaå¤šæ€è°ƒç”¨è¯¥æ¡ˆä¾‹å¤§å®¶å…ˆçœ‹è‡ªè¡Œæµ‹è¯•å¦‚ä¸‹ç¨‹åºçš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748public class A &#123; public String show(D obj) &#123; return (\"A and D\"); &#125; public String show(A obj) &#123; return (\"A and A\"); &#125; &#125; public class B extends A&#123; public String show(B obj)&#123; return (\"B and B\"); &#125; public String show(A obj)&#123; return (\"B and A\"); &#125; &#125; public class C extends B&#123; &#125; public class D extends B&#123; &#125; public class Test &#123; public static void main(String[] args) &#123; A a1 = new A(); A a2 = new B(); B b = new B(); C c = new C(); D d = new D(); System.out.println(\"1--\" + a1.show(b)); System.out.println(\"2--\" + a1.show(c)); System.out.println(\"3--\" + a1.show(d)); System.out.println(\"4--\" + a2.show(b)); System.out.println(\"5--\" + a2.show(c)); System.out.println(\"6--\" + a2.show(d)); System.out.println(\"7--\" + b.show(b)); System.out.println(\"8--\" + b.show(c)); System.out.println(\"9--\" + b.show(d)); &#125; &#125; ä»”ç»†æ€è€ƒå“¦â€¦â€¦â€¦â€¦â€¦.æ¥çœ‹ç­”æ¡ˆï¼Œæœ‰æ²¡æœ‰æ„å¤–å‘ç”Ÿï¼Ÿ 1--A and A 2--A and A 3--A and D 4--B and A 5--B and A 6--A and D 7--B and B 8--B and B 9--A and D æ¥ä¸‹æ¥ä¸»è¦é’ˆå¯¹ç¬¬å››ä¸ªè¾“å‡ºç»“æœåšå‡ºè§£é‡Šï¼Œå…¶ä»–çš„è¾“å‡ºç»“æœæŒ‰ç…§æ­¤è§„çŸ©è‡ªç„¶å°±èƒ½å¾—å‡ºï¼Œè¯·è®°ä½ï¼š å½“è¶…ç±»å¯¹è±¡å¼•ç”¨å˜é‡å¼•ç”¨å­ç±»å¯¹è±¡æ—¶ï¼Œè¢«å¼•ç”¨å¯¹è±¡çš„ç±»å‹è€Œä¸æ˜¯å¼•ç”¨å˜é‡çš„ç±»å‹å†³å®šäº†è°ƒç”¨è°çš„æˆå‘˜æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªè¢«è°ƒç”¨çš„æ–¹æ³•å¿…é¡»æ˜¯åœ¨è¶…ç±»ä¸­å®šä¹‰è¿‡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¢«å­ç±»è¦†ç›–çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒä»ç„¶è¦æ ¹æ®ç»§æ‰¿é“¾ä¸­æ–¹æ³•è°ƒç”¨çš„ä¼˜å…ˆçº§æ¥ç¡®è®¤æ–¹æ³•ï¼Œè¯¥ä¼˜å…ˆçº§ä¸ºï¼šthis.show(O)ã€super.show(O)ã€this.show((super)O)ã€super.show((super)O) æ‰€ä»¥ï¼Œè¿™é‡Œa2æ˜¯å¼•ç”¨å˜é‡ï¼Œä¸ºAç±»å‹ï¼Œå®ƒå¼•ç”¨çš„æ˜¯Bå¯¹è±¡ï¼Œå› æ­¤æŒ‰ç…§ä¸Šé¢é‚£å¥è¯çš„æ„æ€æ˜¯è¯´æœ‰Bæ¥å†³å®šè°ƒç”¨è°çš„æ–¹æ³•,æ‰€ä»¥a2.show(b)åº”è¯¥è¦è°ƒç”¨Bä¸­çš„show(B obj)ï¼Œäº§ç”Ÿçš„ç»“æœåº”è¯¥æ˜¯â€œB and Bâ€ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¼šä¸å‰é¢çš„è¿è¡Œç»“æœäº§ç”Ÿå·®å¼‚å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å¿½ç•¥äº†åé¢é‚£å¥è¯â€œä½†æ˜¯è¿™å„¿è¢«è°ƒç”¨çš„æ–¹æ³•å¿…é¡»æ˜¯åœ¨è¶…ç±»ä¸­å®šä¹‰è¿‡çš„â€ï¼Œé‚£ä¹ˆshow(B obj)åœ¨Aç±»ä¸­å­˜åœ¨å—ï¼Ÿæ ¹æœ¬å°±ä¸å­˜åœ¨ï¼æ‰€ä»¥è¿™å¥è¯åœ¨è¿™é‡Œä¸é€‚ç”¨ï¼Ÿé‚£ä¹ˆéš¾é“æ˜¯è¿™å¥è¯é”™è¯¯äº†ï¼Ÿéä¹Ÿï¼å…¶å®è¿™å¥è¯è¿˜éšå«è¿™è¿™å¥è¯ï¼šå®ƒä»ç„¶è¦æŒ‰ç…§ç»§æ‰¿é“¾ä¸­è°ƒç”¨æ–¹æ³•çš„ä¼˜å…ˆçº§æ¥ç¡®è®¤ã€‚æ‰€ä»¥å®ƒæ‰ä¼šåœ¨Aç±»ä¸­æ‰¾åˆ°show(A obj)ï¼ŒåŒæ—¶ç”±äºBé‡å†™äº†è¯¥æ–¹æ³•æ‰€ä»¥æ‰ä¼šè°ƒç”¨Bç±»ä¸­çš„æ–¹æ³•ï¼Œå¦åˆ™å°±ä¼šè°ƒç”¨Aç±»ä¸­çš„æ–¹æ³•ã€‚ æ„Ÿè°¢æ„Ÿè°¢ä½œè€…åŸæ–‡","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"å¤šæ€","slug":"å¤šæ€","permalink":"https://dayarch.top/tags/%E5%A4%9A%E6%80%81/"}]},{"title":"OAuth2.0 è¯¦è§£","slug":"Oauth2-0-è¯¦è§£","date":"2017-05-05T08:13:12.000Z","updated":"2019-11-01T09:00:21.204Z","comments":true,"path":"/p/oauth2-detail.html","link":"","permalink":"https://dayarch.top/p/oauth2-detail.html","excerpt":"OAuth2.0 è¯¦è§£ ä»¥ä¸‹å†…å®¹ä¸ºè½¬è½½åšä¸»çš„å†…å®¹ 1. ä¸ºä»€ä¹ˆéœ€è¦ Oauth2.0 åè®®ï¼Ÿ 2. å¼€æ”¾å¹³å° 3. Access Token ä¸ Refresh Token 4. Implicit æˆæƒæ–¹å¼ 5. Authorization Code æˆæƒ 6. Resource Owner Password Credentials æˆæƒå’Œ Client Credentials æˆæƒ","text":"OAuth2.0 è¯¦è§£ä»¥ä¸‹å†…å®¹ä¸ºè½¬è½½åšä¸»çš„å†…å®¹ ä¸ºä»€ä¹ˆéœ€è¦ Oauth2.0 åè®®ï¼Ÿ å¼€æ”¾å¹³å° Access Token ä¸ Refresh Token Implicit æˆæƒæ–¹å¼ Authorization Code æˆæƒ Resource Owner Password Credentials æˆæƒå’Œ Client Credentials æˆæƒ","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"å®‰å…¨-åè®®-è§„èŒƒ","slug":"Coding/å®‰å…¨-åè®®-è§„èŒƒ","permalink":"https://dayarch.top/categories/Coding/%E5%AE%89%E5%85%A8-%E5%8D%8F%E8%AE%AE-%E8%A7%84%E8%8C%83/"}],"tags":[{"name":"OAuth2.0","slug":"OAuth2-0","permalink":"https://dayarch.top/tags/OAuth2-0/"}]},{"title":"Hybris tomcat Jrebelçƒ­éƒ¨ç½²é…ç½®","slug":"Hybris-tomcat-Jrebelçƒ­éƒ¨ç½²é…ç½®","date":"2017-03-30T07:31:33.000Z","updated":"2019-11-07T05:28:27.664Z","comments":true,"path":"/p/hybris-jrebel.html","link":"","permalink":"https://dayarch.top/p/hybris-jrebel.html","excerpt":"èƒŒæ™¯ Jrebelæ˜¯éå¸¸å¼ºå¤§çš„å®ç°é¡¹ç›®çƒ­éƒ¨ç½²çš„è½¯ä»¶ï¼Œå½“ç„¶ä¹Ÿæ¯”è¾ƒæ¶ˆè€—ç”µè„‘çš„æ€§èƒ½ï¼Œå½“å¦‚Hybrisçš„è¿™ç§å¯åŠ¨éœ€è¦ä¸€æ®µæ—¶é—´çš„é¡¹ç›®ï¼Œå¯¹äºåç«¯å¼€å‘äººå‘˜æ¥è¯´ï¼Œæ”¹åŠ¨ä¸€äº›ä¸œè¥¿å°±è¦é‡å¯æœåŠ¡çœŸçš„æ˜¯ä¸€ç§æŠ˜ç£¨ï¼Œæµªè´¹æ—¶é—´ï¼Œæ¥ä¸‹æ¥è¯´æ˜ä¸€ä¸‹Jrebelåœ¨Hybrisé¡¹ç›®ä¸­çš„é…ç½® é…ç½®Jrebel Jrebelå¯ä»¥é€šè¿‡IntelliJ IDEAæ¥ä¸‹è½½å®‰è£…é›†æˆå¥½çš„æ’ä»¶ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä¸‹è½½Jrebelçš„åŒ… ï¼ˆè¯·æ”¯æŒæ­£ç‰ˆï¼‰ æ–¹æ³•ä¸€ï¼šé€šè¿‡IntelliJ IDEA æ’ä»¶ å¦‚ä¸‹å›¾ä¸‹è½½å®‰è£…InteliJ IDEA æ’ä»¶ å®‰è£…å¥½ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨IntelliJ IDEAçš„å®‰è£…ç›®å½•ä¸­çœ‹åˆ°è¯¥æ’ä»¶ï¼Œæ¥ä¸‹æ¥åœ¨Hybrisçš„local.prop","text":"èƒŒæ™¯Jrebelæ˜¯éå¸¸å¼ºå¤§çš„å®ç°é¡¹ç›®çƒ­éƒ¨ç½²çš„è½¯ä»¶ï¼Œå½“ç„¶ä¹Ÿæ¯”è¾ƒæ¶ˆè€—ç”µè„‘çš„æ€§èƒ½ï¼Œå½“å¦‚Hybrisçš„è¿™ç§å¯åŠ¨éœ€è¦ä¸€æ®µæ—¶é—´çš„é¡¹ç›®ï¼Œå¯¹äºåç«¯å¼€å‘äººå‘˜æ¥è¯´ï¼Œæ”¹åŠ¨ä¸€äº›ä¸œè¥¿å°±è¦é‡å¯æœåŠ¡çœŸçš„æ˜¯ä¸€ç§æŠ˜ç£¨ï¼Œæµªè´¹æ—¶é—´ï¼Œæ¥ä¸‹æ¥è¯´æ˜ä¸€ä¸‹Jrebelåœ¨Hybrisé¡¹ç›®ä¸­çš„é…ç½® é…ç½®JrebelJrebelå¯ä»¥é€šè¿‡IntelliJ IDEAæ¥ä¸‹è½½å®‰è£…é›†æˆå¥½çš„æ’ä»¶ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä¸‹è½½Jrebelçš„åŒ… ï¼ˆè¯·æ”¯æŒæ­£ç‰ˆï¼‰ æ–¹æ³•ä¸€ï¼šé€šè¿‡IntelliJ IDEA æ’ä»¶å¦‚ä¸‹å›¾ä¸‹è½½å®‰è£…InteliJ IDEA æ’ä»¶ å®‰è£…å¥½ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨IntelliJ IDEAçš„å®‰è£…ç›®å½•ä¸­çœ‹åˆ°è¯¥æ’ä»¶ï¼Œæ¥ä¸‹æ¥åœ¨Hybrisçš„local.propertiesæ–‡ä»¶ä¸­æ¥é…ç½®tomcat #JRebel tomcat.javaoptions=-agentpath:&quot;D:/Users/fraser/.IntelliJIdea2016.2/config/plugins/jr-ide-idea/lib/jrebel6/lib/jrebel64.dll&quot; -DforceANSI=true tomcat.debugjavaoptions=-agentpath:&quot;D:/Users/fraser/.IntelliJIdea2016.2/config/plugins/jr-ide-idea/lib/jrebel6/lib/jrebel64.dll&quot; -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=8000,suspend=n -DforceANSI=trueæ–¹æ³•äºŒï¼šé€šè¿‡å®‰è£…åŒ…ä¸‹è½½Jrebelå®‰è£…åŒ…æ¥ï¼Œå°†å®‰è£…åŒ…è§£å‹åˆ°æŸä¸€ä¸ªç›®å½•ä¸‹ï¼Œç„¶ååŒæ ·é…ç½®local.properties æ–‡ä»¶å¦‚ä¸‹ï¼š #JREBEL tomcat.javaoptions=-Xverify:none -javaagent:&quot;E:/MyProjectSpace/jrebel_5.6.0/jrebe/jrebel.jar=de.hybris.tomcat.HybrisWebappClassLoader60&quot; tomcat.debugjavaoptions=-Xverify:none -javaagent:&quot;E:/MyProjectSpace/jrebel_5.6.0/jrebe/jrebel.jar=de.hybris.tomcat.HybrisWebappClassLoader60&quot;-Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=8060,suspend=y #å¯ä¸é… tomcat.generaloptions=-Xmx2G -Xms2G -XX:PermSize=500M -XX:MaxPermSize=300M -Xss256K -XX:+DisableExplicitGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+CMSPermGenSweepingEnabled -XX:+CMSClassUnloadingEnabled -XX:+UseCMSInitiatingOccupancyOnly -XX:+CMSParallelRemarkEnabled -XX:+ParallelRefProcEnabled -XX:+CMSScavengeBeforeRemark -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xloggc:&quot;${HYBRIS_LOG_DIR}/tomcat/java_gc.log&quot; -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Dorg.tanukisoftware.wrapper.WrapperManager.mbean=true -Djava.endorsed.dirs=..b/endorsed -Dcatalina.base=%CATALINA_BASE% -Dcatalina.home=%CATALINA_HOME% -Dfile.encoding=UTF-8 -Dlog4j.configuration=log4j_init_tomcat.properties -Djava.util.logging.config.file=jdk_logging.properties -Djava.io.tmpdir=&quot;${HYBRIS_TEMP_DIR}&quot; -Dsun.rmi.dgc.client.gcInterval=3600000 -Dsun.rmi.dgc.server.gcInterval=3600000æµ‹è¯•å¯åŠ¨HybrisæœåŠ¡å™¨å¦‚çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯å°±è¯´æ˜Jrebelé…ç½®æˆåŠŸï¼š è¿™æ ·æˆ‘ä»¬æ‰§è¡Œant build å‘½ä»¤ç­‰å¾…buildæˆåŠŸï¼Œå°±å¯ä»¥å®ç°çƒ­éƒ¨ç½²ï¼Œå¦‚æœé‡åˆ°å¦‚ä¸‹é—®é¢˜ï¼š æ‰¾åˆ°D:\\projects\\hybrisHn\\hybris\\bin\\ext-backoffice\\backoffice\\buildcallbacks.xml æ–‡ä»¶ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ³¨é‡Šæ‰ å³å¯ &lt;macrodef name=&quot;backoffice_after_build&quot;&gt; &lt;sequential&gt; &lt;!--&lt;backoffice_remove_web_fragments/&gt;--&gt; &lt;backoffice_create_web_fragments/&gt; &lt;/sequential&gt; &lt;/macrodef&gt;é‡æ–°å°è¯•ant build å‘½ä»¤åº”è¯¥å°±å¯ä»¥buildæˆåŠŸï¼Œå¿«å°è¯•ä¸€ä¸‹å§","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Others","slug":"Coding/Others","permalink":"https://dayarch.top/categories/Coding/Others/"}],"tags":[{"name":"Hybris","slug":"Hybris","permalink":"https://dayarch.top/tags/Hybris/"},{"name":"Jrebel","slug":"Jrebel","permalink":"https://dayarch.top/tags/Jrebel/"}]},{"title":"Linux æ ¹æ®å…³é”®å­—æŸ¥çœ‹é›†ç¾¤æœåŠ¡å™¨çš„log","slug":"Linux-æ ¹æ®å…³é”®å­—æŸ¥çœ‹é›†ç¾¤æœåŠ¡å™¨çš„log","date":"2017-03-29T07:22:34.000Z","updated":"2019-11-01T08:46:43.214Z","comments":true,"path":"/p/linux-search-keyword-script.html","link":"","permalink":"https://dayarch.top/p/linux-search-keyword-script.html","excerpt":"èƒŒæ™¯ ç°åœ¨é¡¹ç›®å¤šæ•°ä¼šé‡‡ç”¨é›†ç¾¤éƒ¨ç½²çš„å½¢å¼ï¼Œè¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œæ¥åˆ†æ‹…å®¢æˆ·ç«¯å¤§é‡è¯·æ±‚çš„å‹åŠ›ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚å‘ç”Ÿå¼‚å¸¸ï¼Œå¼‚å¸¸logåªèƒ½åœ¨æŸä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Šäº§ç”Ÿï¼Œå½“æœåŠ¡å™¨èŠ‚ç‚¹æ¯”è¾ƒå°‘æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®logçš„å…³é”®å­—æ¥å•ä¸ªæŸ¥æ‰¾ï¼Œä½†æ˜¯å½“æœåŠ¡å™¨èŠ‚ç‚¹å¤šçš„æ—¶å€™æˆ‘ä»¬è¿˜è¿™ä¹ˆæŸ¥æ‰¾çœŸçš„æœ‰äº›æµªè´¹æ—¶é—´è€Œä¸”ä¸å‡†ç¡®. è§£å†³æ–¹æ¡ˆ åœ¨æŸä¸€å°release æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹é¢è„šæœ¬å³å¯å®Œæˆå¤šä¸ªèŠ‚ç‚¹çš„logä¿¡æ¯çš„æŸ¥è¯¢ check_log_in_console.shè„šæœ¬å†…å®¹å¦‚ä¸‹ #!/bin/bash if [ $# -lt 1 ]; then echo \"please provide the content you want to find","text":"èƒŒæ™¯ç°åœ¨é¡¹ç›®å¤šæ•°ä¼šé‡‡ç”¨é›†ç¾¤éƒ¨ç½²çš„å½¢å¼ï¼Œè¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œæ¥åˆ†æ‹…å®¢æˆ·ç«¯å¤§é‡è¯·æ±‚çš„å‹åŠ›ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚å‘ç”Ÿå¼‚å¸¸ï¼Œå¼‚å¸¸logåªèƒ½åœ¨æŸä¸€ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹ä¸Šäº§ç”Ÿï¼Œå½“æœåŠ¡å™¨èŠ‚ç‚¹æ¯”è¾ƒå°‘æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®logçš„å…³é”®å­—æ¥å•ä¸ªæŸ¥æ‰¾ï¼Œä½†æ˜¯å½“æœåŠ¡å™¨èŠ‚ç‚¹å¤šçš„æ—¶å€™æˆ‘ä»¬è¿˜è¿™ä¹ˆæŸ¥æ‰¾çœŸçš„æœ‰äº›æµªè´¹æ—¶é—´è€Œä¸”ä¸å‡†ç¡®. è§£å†³æ–¹æ¡ˆåœ¨æŸä¸€å°release æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹é¢è„šæœ¬å³å¯å®Œæˆå¤šä¸ªèŠ‚ç‚¹çš„logä¿¡æ¯çš„æŸ¥è¯¢check_log_in_console.shè„šæœ¬å†…å®¹å¦‚ä¸‹ #!/bin/bash if [ $# -lt 1 ]; then echo &quot;please provide the content you want to find&quot; echo &quot;usage: $0 [content] [date in yyyymmdd format]&quot; exit 0 fi if [ &quot;$2&quot; == &quot;&quot; ]; then d=`date +%Y%m%d` else d=$2 fi s=prd-hybris-pad for((i=1;i&lt;=4;i++)) do server=$s$i.bb.com echo &quot;============check logs on $server====================&quot; ssh app@$server &quot;grep &apos;$1&apos; /data/workspace/hybris/hybris/log/tomcat/console-$d.log&quot; sleep 1 done echo &quot;done&quot; #exit 0è¿™æ ·æˆ‘ä»¬åªéœ€è¦åœ¨è¯¥æ–‡ä»¶ç›®å½•ä¸­æ‰§è¡Œ ./check_log_in_console.sh &quot;ä½ è¦æœç´¢çš„å…³é”®å­—&quot; [å›è½¦]å°±ä¼šå»ä»¥ä¸ŠèŠ‚ç‚¹ä¸­å››ä¸ªæœåŠ¡å™¨ä¸­å»æŸ¥æ‰¾ä½ è¦æœç´¢çš„å…³é”®å­—ï¼Œæ‰“å°å‡ºç±»ä¼¼å¦‚ä¸‹çš„logä¿¡æ¯ï¼š ============check logs on prd-hybris-pad1.bb.com========== ============check logs on prd-hybris-pad2.bb.com========== ============check logs on prd-hybris-pad3.bb.com========== ============check logs on prd-hybris-pad4.bb.com==========","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Linux","slug":"Coding/Linux","permalink":"https://dayarch.top/categories/Coding/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://dayarch.top/tags/Linux/"}]},{"title":"Spring MVC ä¹‹ @ResponseStatus","slug":"Spring-MVC-ä¹‹-ResponseStatus","date":"2017-03-28T09:09:03.000Z","updated":"2019-12-19T13:33:55.817Z","comments":true,"path":"/p/springmvc-response-status.html","link":"","permalink":"https://dayarch.top/p/springmvc-response-status.html","excerpt":"@ResponseStatus Restful webserviceè¯·æ±‚ä¼šç”¨åˆ°@ResponseStatus æ³¨è§£ï¼Œè¯¥æ³¨è§£å¯ç”¨äºç±»çº§åˆ«ä¸Šï¼Œä¹Ÿå¯ä»¥åº”ç”¨åœ¨æ–¹æ³•çº§åˆ«ä¸Šï¼Œä»£è¡¨è¯·æ±‚å“åº”çš„çŠ¶æ€ï¼Œé€šå¸¸å°±æ˜¯è¿”å›HttpStatusçš„çŠ¶æ€ç ï¼Œå…·ä½“å¯æŸ¥è¯¢æ¯ä¸ªçŠ¶æ€ç ä»£ï¼Œè¿™é‡Œç®€å•ç½—åˆ—ä¸€äº›ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 CONTINUE(100, \"Continue\"), SWITCHING_PROTOCOLS(101, \"Switching Protocols\"), PROCESSING(102, \"Processing\"), CHECKPOINT(103","text":"@ResponseStatusRestful webserviceè¯·æ±‚ä¼šç”¨åˆ°@ResponseStatus æ³¨è§£ï¼Œè¯¥æ³¨è§£å¯ç”¨äºç±»çº§åˆ«ä¸Šï¼Œä¹Ÿå¯ä»¥åº”ç”¨åœ¨æ–¹æ³•çº§åˆ«ä¸Šï¼Œä»£è¡¨è¯·æ±‚å“åº”çš„çŠ¶æ€ï¼Œé€šå¸¸å°±æ˜¯è¿”å›HttpStatusçš„çŠ¶æ€ç ï¼Œå…·ä½“å¯æŸ¥è¯¢æ¯ä¸ªçŠ¶æ€ç ä»£ï¼Œè¿™é‡Œç®€å•ç½—åˆ—ä¸€äº›ï¼š 1234567891011121314151617CONTINUE(100, \"Continue\"),SWITCHING_PROTOCOLS(101, \"Switching Protocols\"),PROCESSING(102, \"Processing\"),CHECKPOINT(103, \"Checkpoint\"),OK(200, \"OK\"),CREATED(201, \"Created\"),ACCEPTED(202, \"Accepted\"),NON_AUTHORITATIVE_INFORMATION(203, \"Non-Authoritative Information\"),NO_CONTENT(204, \"No Content\"),RESET_CONTENT(205, \"Reset Content\"),PARTIAL_CONTENT(206, \"Partial Content\"),MULTI_STATUS(207, \"Multi-Status\"),ALREADY_REPORTED(208, \"Already Reported\"),IM_USED(226, \"IM Used\"),MULTIPLE_CHOICES(300, \"Multiple Choices\"),MOVED_PERMANENTLY(301, \"Moved Permanently\"),FOUND(302, \"Found\"), åº”ç”¨åœ¨ç±»çº§åˆ«åˆ›å»ºä¸€ä¸ªå¼‚å¸¸ç±»ï¼Œç”¨è¯¥æ³¨è§£æ ‡æ³¨ 123456789package com.zj.exception;import org.springframework.http.HttpStatus;import org.springframework.web.bind.annotation.ResponseStatus;@ResponseStatus(value=HttpStatus.FORBIDDEN,reason=\"ç”¨æˆ·ä¸åŒ¹é…\")public class UserNotMatchException extends RuntimeException&#123;&#125; å†™ä¸€ä¸ªç›®æ ‡æ–¹æ³•æ¥æŠ›å‡ºå¼‚å¸¸ 123456@RequestMapping(\"/testResponseStatus\")public String testResponseStatus(int i)&#123; if(i==0) throw new UserNotMatchException(); return \"hello\";&#125; è¿™æ ·å½“æˆ‘ä»¬è¯·æ±‚è¯¥æ–¹æ³•ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œä¼šå°†ç”¨æˆ·ä¸åŒ¹é…çš„ä¿¡æ¯è¿”å›ç»™æµè§ˆå™¨ï¼Œè®©å¼‚å¸¸ä¿¡æ¯æ›´åŠ æ˜ç¡®ï¼Œè€Œä¸æ˜¯ä¸€å †å¼‚å¸¸ä¿¡æ¯ä»£ç  åº”ç”¨åœ¨æ–¹æ³•çº§åˆ«1234567@ResponseStatus(value=HttpStatus.FORBIDDEN,reason=\"ç”¨æˆ·åä¸åŒ¹é…\")@RequestMapping(\"/testResponseStatus\")public String testResponseStatus(int i)&#123; if(i==0) throw new UserNotMatchException(); return \"hello\";&#125; ResponseStatusä¿®é¥°ç›®æ ‡æ–¹æ³•ï¼Œæ— è®ºå®ƒæ‰§è¡Œæ–¹æ³•è¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰å¼‚å¸¸äº§ç”Ÿï¼Œç”¨æˆ·éƒ½ä¼šå¾—åˆ°å¼‚å¸¸çš„ç•Œé¢ã€‚è€Œç›®æ ‡æ–¹æ³•æ­£å¸¸æ‰§è¡Œ è¿™ä¸ªæƒ…å†µè¦çœ‹é¡¹ç›®çš„ä½¿ç”¨æƒ…å†µï¼Œé€šå¸¸ä¼šåˆ¶å®šä¸€ä¸ªæ ‡å‡†çš„å¼‚å¸¸ä¿¡æ¯æ˜¾ç¤ºï¼Œå¯ä»¥çµæ´»ä½¿ç”¨.","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://dayarch.top/tags/Spring/"}]},{"title":"Spring MVC ä¹‹ @initbinder","slug":"Spring-MVC-ä¹‹-initbinder","date":"2017-03-28T08:24:26.000Z","updated":"2019-12-19T13:33:04.382Z","comments":true,"path":"/p/springmvc-init-binder.html","link":"","permalink":"https://dayarch.top/p/springmvc-init-binder.html","excerpt":"èƒŒæ™¯ åœ¨Webé¡¹ç›®ä¸­ï¼Œå¤ªå¤šéœ€è¦æäº¤è¡¨å•æˆ–è€…åœ¨è¯·æ±‚URLä¸­æ·»åŠ å‚æ•°ä¿¡æ¯çš„æ“ä½œï¼Œæ— è®ºæ˜¯å‰è€…è¿˜æ˜¯åè€…ï¼ŒSpringMVCéƒ½å°†æ¯ä¸ªå…ƒç´ å½“åšStringæ¥å¤„ç†ï¼Œ å¦‚æœå‰å°ä¼ å…¥æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²çš„æ—¥æœŸæˆ–è¿™æ•°å€¼ç±»å‹çš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼ˆåœ¨SpringMVCä¸­ï¼Œbeanä¸­å®šä¹‰äº†Dateï¼Œdoubleç­‰ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰åšä»»ä½•å¤„ç†çš„è¯ï¼Œæ—¥æœŸä»¥åŠdoubleéƒ½æ— æ³•ç»‘å®šï¼‰ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ¥å¼ºåˆ¶è½¬å‹å¾ˆæ˜¯éº»çƒ¦ï¼ŒSpringMVC æä¾›çš„@initbinder å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜ @initbinder åœ¨æˆ‘çš„é¡¹ç›®ä¸­æ˜¯åœ¨BaseControllerä¸­å¢åŠ æ–¹æ³•initBinderï¼Œå¹¶ä½¿ç”¨æ³¨è§£@InitBinderæ ‡æ³¨ï¼Œé‚£ä¹ˆspring mvc","text":"èƒŒæ™¯åœ¨Webé¡¹ç›®ä¸­ï¼Œå¤ªå¤šéœ€è¦æäº¤è¡¨å•æˆ–è€…åœ¨è¯·æ±‚URLä¸­æ·»åŠ å‚æ•°ä¿¡æ¯çš„æ“ä½œï¼Œæ— è®ºæ˜¯å‰è€…è¿˜æ˜¯åè€…ï¼ŒSpringMVCéƒ½å°†æ¯ä¸ªå…ƒç´ å½“åšStringæ¥å¤„ç†ï¼Œ å¦‚æœå‰å°ä¼ å…¥æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²çš„æ—¥æœŸæˆ–è¿™æ•°å€¼ç±»å‹çš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼ˆåœ¨SpringMVCä¸­ï¼Œbeanä¸­å®šä¹‰äº†Dateï¼Œdoubleç­‰ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰åšä»»ä½•å¤„ç†çš„è¯ï¼Œæ—¥æœŸä»¥åŠdoubleéƒ½æ— æ³•ç»‘å®šï¼‰ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ¥å¼ºåˆ¶è½¬å‹å¾ˆæ˜¯éº»çƒ¦ï¼ŒSpringMVC æä¾›çš„@initbinder å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜ @initbinderåœ¨æˆ‘çš„é¡¹ç›®ä¸­æ˜¯åœ¨BaseControllerä¸­å¢åŠ æ–¹æ³•initBinderï¼Œå¹¶ä½¿ç”¨æ³¨è§£@InitBinderæ ‡æ³¨ï¼Œé‚£ä¹ˆspring mvcåœ¨ç»‘å®šè¡¨å•ä¹‹å‰ï¼Œéƒ½ä¼šå…ˆæ³¨å†Œè¿™äº›ç¼–è¾‘å™¨, Springè‡ªå·±æä¾›äº†å¤§é‡çš„å®ç°ç±»ï¼Œè¯¸å¦‚CustomDateEditor ï¼ŒCustomBooleanEditorï¼ŒCustomNumberEditorç­‰è®¸å¤šï¼ŒåŸºæœ¬ä¸Šå¤Ÿç”¨, å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±æ¥å†™è¿™äº›ç¼–è¾‘å™¨. è‡ªå®šä¹‰ç¼–è¾‘å™¨123456789101112131415161718192021222324252627282930import org.springframework.beans.propertyeditors.PropertiesEditor; public class DoubleEditor extends PropertiesEditor &#123; @Override public void setAsText(String text) throws IllegalArgumentException &#123; if (text == null || text.equals(\"\")) &#123; text = \"0\"; &#125; setValue(Double.parseDouble(text)); &#125; @Override public String getAsText() &#123; return getValue().toString(); &#125; &#125; ``` ç±»ä¼¼Longã€Floatç­‰éƒ½å¯ä»¥è¿™æ ·å†™ï¼Œç„¶åå°†è¿™äº›è‡ªå®šä¹‰çš„ç¼–è¾‘å™¨æˆ–Springè‡ªå¸¦çš„ç¼–è¾‘å™¨æ”¾åˆ°BaseControllerä¸­å¸¦æœ‰@initbinderçš„æ–¹æ³•ä¸­æ³¨å†Œå°±å¥½.```java@InitBinder protected void initBinder(WebDataBinder binder) &#123; binder.registerCustomEditor(Date.class, new CustomDateEditor(new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\"), true)); binder.registerCustomEditor(int.class, new CustomNumberEditor(int.class, true)); binder.registerCustomEditor(int.class, new IntegerEditor()); binder.registerCustomEditor(long.class, new CustomNumberEditor(long.class, true)); binder.registerCustomEditor(long.class, new LongEditor()); binder.registerCustomEditor(double.class, new DoubleEditor()); binder.registerCustomEditor(float.class, new FloatEditor()); &#125; å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è‡ªå®šä¹‰çš„ç¼–è¾‘å™¨ç›´æ¥ç»§æ‰¿ PropertyEditorSupportï¼Œ å› ä¸ºï¼š 1public class org.springframework.beans.propertyeditors.PropertiesEditor extends java.beans.PropertyEditorSupport &#123; å‚è€ƒéå¸¸æ„Ÿè°¢ä¸€ä¸‹ä¸¤ä½ä½œè€…è´¡çŒ®æ•´ç†çš„æ–‡ç« ï¼š spring mvcä½¿ç”¨@InitBinder æ ‡ç­¾å¯¹è¡¨å•æ•°æ®ç»‘å®š @InitBindæ¥è§£å†³å­—ç¬¦ä¸²è½¬æ—¥æœŸç±»å‹","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"SpringMVC","slug":"SpringMVC","permalink":"https://dayarch.top/tags/SpringMVC/"}]},{"title":"Javaä¸­çš„ArrayListçš„å®¹é‡","slug":"Javaä¸­çš„ArrayListçš„å®¹é‡","date":"2017-03-16T03:33:44.000Z","updated":"2019-11-07T05:31:10.268Z","comments":true,"path":"/p/java-arraylist-capacity.html","link":"","permalink":"https://dayarch.top/p/java-arraylist-capacity.html","excerpt":"1. Listæ¥å£çš„å¤§å°å¯å˜æ•°ç»„çš„å®ç°ã€‚å®ç°äº†æ‰€æœ‰å¯é€‰åˆ—è¡¨æ“ä½œï¼Œå¹¶å…è®¸åŒ…æ‹¬ null åœ¨å†…çš„æ‰€æœ‰å…ƒç´ ã€‚ 2. ArrayListç»§æ‰¿äºListæ¥å£ï¼Œé™¤ç»§æ‰¿è¿‡æ¥çš„æ–¹æ³•å¤–ï¼Œè¿˜æä¾›ä¸€äº›æ–¹æ³•æ¥æ“ä½œå†…éƒ¨ç”¨æ¥å­˜å‚¨åˆ—è¡¨çš„æ•°ç»„çš„å¤§å°ã€‚ 3. æ¯ä¸ªArrayListå®ä¾‹éƒ½æœ‰ä¸€ä¸ªå®¹é‡ã€‚è¯¥å®¹é‡æ˜¯æŒ‡ç”¨æ¥å­˜å‚¨åˆ—è¡¨å…ƒç´ çš„æ•°ç»„çš„å¤§å°ã€‚å®ƒæ€»æ˜¯è‡³å°‘ç­‰äºåˆ—è¡¨çš„å¤§å°ã€‚éšç€å‘ArrayListä¸­ä¸æ–­æ·»åŠ å…ƒç´ ï¼Œå…¶å®¹é‡ä¹Ÿè‡ªåŠ¨å¢é•¿ã€‚å¹¶æœªæŒ‡å®šå¢é•¿ç­–ç•¥çš„ç»†èŠ‚ï¼Œå› ä¸ºè¿™ä¸åªæ˜¯æ·»åŠ å…ƒç´ ä¼šå¸¦æ¥åˆ†æ‘Šå›ºå®šæ—¶é—´å¼€é”€é‚£æ ·ç®€å•ã€‚ 4. ArrayListæ˜¯ç»å¸¸ä¼šè¢«ç”¨åˆ°çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨çš„æ—¶å€™ä¼š","text":"Listæ¥å£çš„å¤§å°å¯å˜æ•°ç»„çš„å®ç°ã€‚å®ç°äº†æ‰€æœ‰å¯é€‰åˆ—è¡¨æ“ä½œï¼Œå¹¶å…è®¸åŒ…æ‹¬ null åœ¨å†…çš„æ‰€æœ‰å…ƒç´ ã€‚ ArrayListç»§æ‰¿äºListæ¥å£ï¼Œé™¤ç»§æ‰¿è¿‡æ¥çš„æ–¹æ³•å¤–ï¼Œè¿˜æä¾›ä¸€äº›æ–¹æ³•æ¥æ“ä½œå†…éƒ¨ç”¨æ¥å­˜å‚¨åˆ—è¡¨çš„æ•°ç»„çš„å¤§å°ã€‚ æ¯ä¸ªArrayListå®ä¾‹éƒ½æœ‰ä¸€ä¸ªå®¹é‡ã€‚è¯¥å®¹é‡æ˜¯æŒ‡ç”¨æ¥å­˜å‚¨åˆ—è¡¨å…ƒç´ çš„æ•°ç»„çš„å¤§å°ã€‚å®ƒæ€»æ˜¯è‡³å°‘ç­‰äºåˆ—è¡¨çš„å¤§å°ã€‚éšç€å‘ArrayListä¸­ä¸æ–­æ·»åŠ å…ƒç´ ï¼Œå…¶å®¹é‡ä¹Ÿè‡ªåŠ¨å¢é•¿ã€‚å¹¶æœªæŒ‡å®šå¢é•¿ç­–ç•¥çš„ç»†èŠ‚ï¼Œå› ä¸ºè¿™ä¸åªæ˜¯æ·»åŠ å…ƒç´ ä¼šå¸¦æ¥åˆ†æ‘Šå›ºå®šæ—¶é—´å¼€é”€é‚£æ ·ç®€å•ã€‚ ArrayListæ˜¯ç»å¸¸ä¼šè¢«ç”¨åˆ°çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨çš„æ—¶å€™ä¼šåƒè¿™æ ·è¿›è¡Œå£°æ˜ï¼š List arrayList = new ArrayList();å¦‚æœåƒä¸Šé¢è¿™æ ·ä½¿ç”¨é»˜è®¤çš„æ„é€ æ–¹æ³•ï¼Œåˆå§‹å®¹é‡è¢«è®¾ç½®ä¸º10ã€‚å½“ArrayListä¸­çš„å…ƒç´ è¶…è¿‡10ä¸ªä»¥åï¼Œä¼šé‡æ–°åˆ†é…å†…å­˜ç©ºé—´ï¼Œä½¿æ•°ç»„çš„å¤§å°å¢é•¿åˆ°16ã€‚å¯ä»¥é€šè¿‡è°ƒè¯•çœ‹åˆ°åŠ¨æ€å¢é•¿çš„æ•°é‡å˜åŒ–ï¼š10-&gt;16-&gt;25-&gt;38-&gt;58-&gt;88-&gt;â€¦ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è¿›è¡Œå£°æ˜ï¼š List arrayList = new ArrayList(4);å°†ArrayListçš„é»˜è®¤å®¹é‡è®¾ç½®ä¸º4ã€‚å½“ArrayListä¸­çš„å…ƒç´ è¶…è¿‡4ä¸ªä»¥åï¼Œä¼šé‡æ–°åˆ†é…å†…å­˜ç©ºé—´ï¼Œä½¿æ•°ç»„çš„å¤§å°å¢é•¿åˆ°7ã€‚å¯ä»¥é€šè¿‡è°ƒè¯•çœ‹åˆ°åŠ¨æ€å¢é•¿çš„æ•°é‡å˜åŒ–ï¼š4-&gt;7-&gt;11-&gt;17-&gt;26-&gt;â€¦ é‚£ä¹ˆå®¹é‡å˜åŒ–çš„è§„åˆ™æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¯·çœ‹ä¸‹é¢çš„å…¬å¼ï¼š ((æ—§å®¹é‡ * 3) / 2) + 1æ³¨ï¼šè¿™ç‚¹ä¸C#è¯­è¨€æ˜¯ä¸åŒçš„ï¼ŒC#å½“ä¸­çš„ç®—æ³•å¾ˆç®€å•ï¼Œæ˜¯ç¿»å€ã€‚ ä¸€æ—¦å®¹é‡å‘ç”Ÿå˜åŒ–ï¼Œå°±è¦å¸¦æ¥é¢å¤–çš„å†…å­˜å¼€é”€ï¼Œå’Œæ—¶é—´ä¸Šçš„å¼€é”€ã€‚æ‰€ä»¥ï¼Œåœ¨å·²ç»çŸ¥é“å®¹é‡å¤§å°çš„æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨ä¸‹é¢æ–¹å¼è¿›è¡Œå£°æ˜ï¼šList arrayList = new ArrayList(CAPACITY_SIZE); å³æŒ‡å®šé»˜è®¤å®¹é‡å¤§å°çš„æ–¹å¼ã€‚ æ„Ÿè°¢åŸæ–‡ä½œè€…ï¼šåŸæ–‡","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Java","slug":"Coding/Java","permalink":"https://dayarch.top/categories/Coding/Java/"}],"tags":[{"name":"ArrayList","slug":"ArrayList","permalink":"https://dayarch.top/tags/ArrayList/"}]},{"title":"Jenkinsè‡ªåŠ¨åŒ–éƒ¨ç½²Hybris","slug":"Jenkinsè‡ªåŠ¨åŒ–éƒ¨ç½²Hybris","date":"2017-03-08T07:03:17.000Z","updated":"2019-11-01T08:46:23.478Z","comments":true,"path":"/p/jenkins-hybris-deploy.html","link":"","permalink":"https://dayarch.top/p/jenkins-hybris-deploy.html","excerpt":"å‰è¨€ é¡¹ç›®å¼€å‘æ—¶é—´ä¸ç®—ç´§å¼ ï¼ŒçŸ¥é“é¡¹ç›®åº”ç”¨Jenkins æŒç»­é›†æˆå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œè¿™ä¸ªéƒ¨ç½²æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå‘æ¶æ„å¸ˆå–ç»ç ”ç©¶ä¹‹ååšæ­¤è®°å½•. éƒ¨ç½²æ¶æ„æ‹“æ‰‘å›¾ ä»¥ä¸‹æ˜¯é¡¹ç›®éƒ¨ç½²æ¶æ„ç®€æ˜“æ‹“æ‰‘å›¾ï¼Œä¸åŒ…æ‹¬SolræœåŠ¡å™¨çš„éƒ¨ç½², Prod Envé‡‡ç”¨Cluster Deploymentçš„æ–¹å¼. è¿ç»´äººå‘˜æ­å»ºJenkinsæœåŠ¡å™¨ä¹‹åï¼Œæ¯ä½è¢«æˆæƒçš„å¼€å‘äººå‘˜éƒ½å¯ä»¥è®¿é—®Jenkins å·¥ä½œä¸»é¡µï¼Œ å½“pushä»£ç ä¹‹åï¼Œç»Ÿä¸€åœ¨æŒ‡å®šæ—¶é—´ç‚¹build (Jenkinsæ²¡æœ‰é‡‡ç”¨æœ‰pushä»£ç è‡ªåŠ¨buildçš„æ–¹å¼ ). 1. å¼€å‘äººå‘˜Push ä»£ç  2. Build QA1, åŠŸèƒ½æµ‹è¯•é€šè¿‡ä¹‹åè¿›è¡Œä¸‹ä¸€æ­¥ 3. Bu","text":"å‰è¨€é¡¹ç›®å¼€å‘æ—¶é—´ä¸ç®—ç´§å¼ ï¼ŒçŸ¥é“é¡¹ç›®åº”ç”¨Jenkins æŒç»­é›†æˆå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œè¿™ä¸ªéƒ¨ç½²æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå‘æ¶æ„å¸ˆå–ç»ç ”ç©¶ä¹‹ååšæ­¤è®°å½•. éƒ¨ç½²æ¶æ„æ‹“æ‰‘å›¾ä»¥ä¸‹æ˜¯é¡¹ç›®éƒ¨ç½²æ¶æ„ç®€æ˜“æ‹“æ‰‘å›¾ï¼Œä¸åŒ…æ‹¬SolræœåŠ¡å™¨çš„éƒ¨ç½², Prod Envé‡‡ç”¨Cluster Deploymentçš„æ–¹å¼. è¿ç»´äººå‘˜æ­å»ºJenkinsæœåŠ¡å™¨ä¹‹åï¼Œæ¯ä½è¢«æˆæƒçš„å¼€å‘äººå‘˜éƒ½å¯ä»¥è®¿é—®Jenkins å·¥ä½œä¸»é¡µï¼Œ å½“pushä»£ç ä¹‹åï¼Œç»Ÿä¸€åœ¨æŒ‡å®šæ—¶é—´ç‚¹build (Jenkinsæ²¡æœ‰é‡‡ç”¨æœ‰pushä»£ç è‡ªåŠ¨buildçš„æ–¹å¼ ). å¼€å‘äººå‘˜Push ä»£ç  Build QA1, åŠŸèƒ½æµ‹è¯•é€šè¿‡ä¹‹åè¿›è¡Œä¸‹ä¸€æ­¥ Build QA2, åŠŸèƒ½æµ‹è¯•é€šè¿‡ä¹‹åè¿›è¡Œä¸‹ä¸€æ­¥ ç­‰å¾…å‘å¸ƒç‰ˆæœ¬æ—¶é—´èŠ‚ç‚¹ Build Stageç¯å¢ƒï¼ŒåŠŸèƒ½æµ‹è¯•é€šè¿‡ä¹‹åè¿›è¡Œä¸‹ä¸€æ­¥ ï¼ˆæ‹“æ‰‘å›¾ä¸­æ²¡æœ‰æ˜¾ç¤ºStageç¯å¢ƒï¼‰ Build Prod ç¯å¢ƒï¼Œ åŠŸèƒ½æµ‹è¯•é€šè¿‡ä¹‹åæˆåŠŸå‘å¸ƒ. å¼€å‘äººå‘˜åªéœ€è¦ç‚¹å‡»Jenkinsæ§åˆ¶å°çš„Buildï¼Œå³å¯å®Œæˆè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œè¿™æ­£æ˜¯Jenkins å¸¦æ¥çš„ä¾¿åˆ©ï¼Œæ¥ä¸‹æ¥å°±è§£é‡Šä¸€ä¸‹Jenkins æ•´ä¸ªå·¥ä½œè¿‡ç¨‹. Jenkins æŒç»­é›†æˆè¿‡ç¨‹è¯¦è§£ç”Ÿäº§ç¯å¢ƒæ˜¯é‡‡ç”¨é›†ç¾¤éƒ¨ç½²ï¼Œå’ŒQAç¯å¢ƒæ˜¯æœ‰æ‰€åŒºåˆ«çš„ï¼Œä¸‹é¢é’ˆå¯¹ç”Ÿäº§ç¯å¢ƒå’ŒQAç¯å¢ƒåˆ†åˆ«ä½œè§£é‡Š Common ç¯å¢ƒè§£é‡ŠJenkins çš„Home Directory æ˜¯ /var/lib/jenkinsQAç¯å¢ƒéƒ¨ç½² ä»¥QA1 ç¯å¢ƒä¸ºä¾‹ï¼Œitemåç§°ä¸º qa_honor_hybris, workspaceçš„è·¯å¾„æ˜¯Jenkins çš„workspaceè·¯å¾„ä¸itemåç§°çš„æ‹¼æ¥ï¼Œè¿™æ ·å½“å‰itemçš„$workspaceçš„è·¯å¾„ä¸º /var/lib/jenkins/workspace/qa_honor_hybris ç‚¹å‡»buildä¹‹åï¼ŒJenkinsä¼šæŒ‰ç…§è¯¥itemé…ç½®å¥½çš„Git Repository æ¥æ‹‰å–æœ€æ–°ä»£ç åˆ°workspaceä¸­ æ‰§è¡Œè‡ªå®šä¹‰Shell è„šæœ¬(Jenkins æ§åˆ¶å°å†™å¥½çš„è„šæœ¬) # 1. ç§»é™¤æ‰å·¥ä½œåŒºæ—§ä»£ç  rm -rf /data/qa_honor_hybris/hybris/bin/custom # 2. copy æ‹‰å–ä¸‹æ¥çš„æœ€æ–°ä»£ç åˆ°å·¥ä½œåŒºä¸­ cp -r $WORKSPACE/bin/custom /data/qa_honor_hybris/hybris/bin # 3. copy local.properties å’Œ localextensions.xml åˆ° å·¥ä½œåŒºconfigç›®å½•ä¸‹ cp $WORKSPACE/config/local.properties /data/qa_honor_hybris/hybris/config cp $WORKSPACE/config/localextensions.xml /data/qa_honor_hybris/hybris/config # 5. è¿›å…¥å·¥ä½œåŒºplatform ç›®å½• cd /data/qa_honor_hybris/hybris/bin/platform # 6. è®¾ç½®åŸºæœ¬ç¯å¢ƒå˜é‡ï¼Œå½“ç„¶å¯ä»¥Jenkins è®¾ç½®å¥½ export JAVA_HOME=/usr/local/jdk1.8 export JRE_HOME=/usr/local/jdk1.8/jre export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib:$CLASSPATH export PATH=$JAVA_HOME/bin:$PATH # 7. æŒ‡å®šant ç›®å½•å¹¶ä¸”buildï¼Œæ‰§è¡Œè¯¥æ­¥éª¤æ˜¯ä¸ºäº†æ£€æµ‹é¡¹ç›®æ˜¯å¦èƒ½buildæˆåŠŸ . ./setantenv.sh ant clean all # 8. åˆ‡æ¢åˆ°å·¥ä½œåŒºbuild ç›®å½•ä¸‹ cd /data/qa_honor_hybris/build ./build_and_deploy.sh ./build_and_deploy.sh è„šæœ¬å†…å®¹ #!/bin/bash # 1. è¿›å…¥å·¥ä½œåŒºç›®å½• cd /var/lib/jenkins/workspace/qa1-honor-hybris echo &quot;build for honor hybris qa1&quot; # åˆ é™¤workspace å†å²å†…å®¹ echo &quot;create honor source code tar ball&quot; rm -rf honor rm -rf honor.tar.gz # åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œç­‰å¾…æ‰“åŒ… mkdir honor # copy workspace æœ€æ–°ä»£ç æ‹·è´åˆ° åˆšåˆšæ–°å»ºçš„honor æ–‡ä»¶å¤¹ä¸­ cp -r /var/lib/jenkins/workspace/qa1-honor-hybris/bin honor cp -r /var/lib/jenkins/workspace/qa1-honor-hybris/config/qa honor # å°†honor æ–‡ä»¶å¤¹å‹ç¼©æ‰“åŒ… tar -zcvf honor.tar.gz honor # å°†æ‰“åŒ…çš„honor.tar.gz è¿œç¨‹copyåˆ° QA1 æœåŠ¡å™¨çš„workspace ä¸­ echo &quot;======copy tar ball to qa1 server(10.11.12.233)=====&quot; scp honor.tar.gz app@10.11.12.233:/data/build_workspace # è¿›å…¥åˆ°QA1 ç¯å¢ƒå¹¶ä¸”è¿›å…¥workspace, åœæ‰QA1 çš„æœåŠ¡ echo &quot;===build hybris and start hybris on qa1 server===&quot; ssh app@10.11.12.233 &apos;cd /data/build_workspace;. ./stop.sh&apos; # æ‰§è¡ŒQA1ç›¸åº”è·¯å¾„ä¸‹çš„è„šæœ¬. ssh app@10.11.12.233 &apos;cd /data/build_workspace;. ./build_and_start.sh&apos; echo &quot;build_and_deploy done&quot; exit 0 ./build_and_start.sh è„šæœ¬å†…å®¹ #!/bin/bash # 1. åˆ é™¤æ‰honor æ–‡ä»¶å¤¹ï¼ˆç¡®ä¿æ–‡ä»¶å¤¹åˆ é™¤ï¼Œä¸‹é¢å…¶å®å·²ç»åˆ é™¤äº†ä¸€æ¬¡ï¼‰ rm -rf honor # 2. èµ‹äºˆå¯è¯»å¯å†™å¯æ‰§è¡Œçš„æƒé™ chmod 755 honor.tar.gz # 3. è§£å‹åˆšåˆšä¼ è¾“è¿‡æ¥çš„å‹ç¼©åŒ…ï¼Œå¹¶èµ‹äºˆå¯è¯»å¯å†™å¯æ‰§è¡Œçš„æƒé™ tar -zxvf honor.tar.gz chmod -R 755 honor # 4. åˆ é™¤æ‰æ—§çš„Hybrisä»£ç  echo &quot;remove old honor hybris source code...&quot; rm -rf /data/build_workspace/honor-hybris/hybris/bin/custom rm -rf /data/build_workspace/honor-hybris/hybris/config/local.properties rm -rf /data/build_workspace/honor-hybris/hybris/config/localextensions.xml # 5. copyåˆšåˆšè§£å‹å‡ºæ¥çš„honoræ–‡ä»¶å¤¹çš„å†…å®¹åˆ°å·¥ä½œåŒº echo &quot;copy new honor source code...&quot; cd /data/build_workspace cp -r honor/* honor-hybris/hybris cp honor/qa/local_qa1.properties honor-hybris/hybris/config/local.properties cp honor/qa/localextensions.xml honor-hybris/hybris/config/localextensions.xml # 6. åˆ é™¤è§£å‹å‡ºæ¥çš„æ–‡ä»¶å¤¹ rm -rf honor # 7. è®¾ç½®ç¯å¢ƒå˜é‡ echo &quot;begin to start qa1...&quot; export JAVA_HOME=&quot;/usr/local/jdk1.8.0_101&quot; export PATH=$JAVA_HOME/bin:$PATH cd /data/build_workspace/honor-hybris/hybris/bin/platform . ./setantenv.sh ant clean all # 8. ç›´æ¥ä»¥debugæ¨¡å¼å¯åŠ¨ï¼ˆæ–¹ä¾¿è¿œç¨‹è°ƒè¯•ï¼Œä½†æ˜¯Jenkins buildè¿›åº¦æ¡å§‹ç»ˆæ˜¯çº¢è‰²ï¼Œä¸å½±å“ä½¿ç”¨ï¼Œè¿˜æ²¡æ‰¾åˆ°è¿™ä¸ªè§£å†³åŠæ³•ï¼‰ . ./hybrisserver.sh debug exit 0 ä»¥ä¸Šæ˜¯QAç¯å¢ƒè¿˜ä¸æ¶‰åŠåˆ°å¤šnodeçš„æƒ…å†µï¼Œæ¥ä¸‹æ¥ä¼šä»‹ç»Prod çš„æƒ…å†µï¼Œå¤§ä½“æµç¨‹å’ŒQAç¯å¢ƒç›¸ä¼¼ï¼Œåªä¸è¿‡æ˜¯å¤šäº†å¤„ç†nodeçš„æƒ…å†µ. Prod ç¯å¢ƒéƒ¨ç½² Jenkins åœ¨buildä¹‹åä¼šå°†æœ€æ–°çš„ä»£ç pullåˆ°releaseæœåŠ¡å™¨ï¼Œ ç„¶ååœ¨releaseæœåŠ¡å™¨ä¸Šæ‰§&gt; è¡Œè„šæœ¬ï¼Œå°†ä»£ç å‘å¸ƒåˆ°å„ä¸ªæœåŠ¡å™¨ä¸Š, åœ¨releaseæœåŠ¡å™¨çš„/data ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªç›®å½• /data/install: å°†ç¯å¢ƒæ‰€éœ€çš„è½¯ä»¶ã€Licenceç­‰å­˜æ”¾åœ¨æ­¤ï¼Œè¿™äº›åªæ˜¯ç¬¬ä¸€æ¬¡å‘å¸ƒçš„æ—¶å€™ä¼šç”¨åˆ° /data/build: è¿™æ˜¯çœŸæ­£buildçš„æ‰€éœ€è¦çš„ç›®å½• ç‚¹å‡»buildä¹‹åï¼ŒJenkinsä¼šæŒ‰ç…§è¯¥itemé…ç½®å¥½çš„Git Repository æ¥æ‹‰å–æœ€æ–°ä»£ç åˆ°workspaceä¸­ æ‰§è¡Œè‡ªå®šä¹‰Shell è„šæœ¬(Jenkins æ§åˆ¶å°å†™å¥½çš„è„šæœ¬, å’ŒQAç¯å¢ƒç±»ä¼¼ï¼Œæ³¨æ„ç›®å½•çš„æ”¹å˜) rm -rf /data/prod_honor_hybris/hybris/bin/custom cp -r $WORKSPACE/bin/custom /data/prod_honor_hybris/hybris/bin cp $WORKSPACE/config/local.properties /data/prod_honor_hybris/hybris/config cp $WORKSPACE/config/localextensions.xml /data/prod_honor_hybris/hybris/config cd /data/prod_honor_hybris/hybris/bin/platform export JAVA_HOME=/usr/local/jdk1.8 export JRE_HOME=/usr/local/jdk1.8/jre export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib:$CLASSPATH export PATH=$JAVA_HOME/bin:$PATH . ./setantenv.sh ant clean all cd /data/prod_honor_hybris/build ./build_and_deploy.sh ./build_and_deploy.sh è„šæœ¬å†…å®¹ #!/bin/bash cd /var/lib/jenkins/workspace/prod-honor-hybris echo &quot;build for honor hybris product&quot; echo &quot;create honor source code tar ball&quot; rm -rf honor rm -rf honor.tar.gz mkdir honor cp -r /var/lib/jenkins/workspace/prod-honor-hybris/bin honor cp -r /var/lib/jenkins/workspace/prod-honor-hybris/config/prod honor tar -zcvf honor.tar.gz honor # 1. ç”Ÿäº§ä¸Šè¦å¤‡ä»½åŸæœ‰çš„å‹ç¼©åŒ…ï¼Œä»¥é˜²ä¸‡ä¸€è¿›è¡Œæ¢å¤ç‰ˆæœ¬ echo &quot;======backup original tar in release server(10.11.12.232)=====&quot; ssh app@10.11.12.232 &quot;cp /data/build/product/honor.tar.gz /data/build/product/honor.tar.gz_backup&quot; echo &quot;======copy tar ball to release server(10.11.12.232)=====&quot; scp honor.tar.gz app@10.11.12.232:/data/build/product echo &quot;build_and_deploy done&quot; exit 0 å‘å¸ƒå†…å®¹å‰ç«¯æœåŠ¡å™¨ï¼Œè¿›å…¥åˆ°Prod Release æœåŠ¡å™¨ç›¸åº”ç›®å½•æ‰§è¡Œè„šæœ¬app_release.sh ä¸»è¦åŠ¨æ€å¾ªç¯IPåœ°å€ï¼Œå°†æ–‡ä»¶ä¼ é€åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œæ‰§è¡Œç›¸åº”æœåŠ¡å™¨çš„è„šæœ¬. #!/bin/bash if [ $# -lt 2 ]; then echo &quot;please provide server start index and end index&quot; echo &quot;usage: $0 [start] [end]&quot; # exit 0 fi s=prd-hybris-pad baseIp=11.12.126. let ipStartNum=$1+54 echo &quot;release artifact to hybris server from $s$1 to $s$2&quot; for((i=$1;i&lt;=$2;i++)) do server=$s$i.xxx.com ipAddr=$baseIp$ipStartNum echo &quot;============deploy on $server====================&quot; echo &quot;copy Hybris production Deployment ZIP to $server&quot; scp /data/build/product/honor.tar.gz app@$server:/data/workspace echo &quot;build hybris on $server and start hybris&quot; ssh app@$server &quot;cd /data/workspace;./stop.sh; nohup ./build_and_start.sh $ipAddr &gt;./build.log 2&gt;&amp;1 &amp; &quot; let ipStartNum=$ipStartNum+1 sleep 1 done echo &quot;done&quot; #exit 0 Prod æœåŠ¡å™¨ç›®å½•ç»“æ„ è¿›å…¥åˆ°Prod æœåŠ¡å™¨ä¹‹ä¸€ æŸ¥çœ‹./stop.sh è„šæœ¬å†…å®¹ #!/bin/bash cd /data/workspace/hybris/hybris/bin/platform . ./setantenv.sh &amp;&amp; ./hybrisserver.sh stop æŸ¥çœ‹./build_and_start.shå†…å®¹ï¼ˆå†…å®¹æœ‰äº›å¤æ‚ï¼‰ #!/bin/bash rm -rf honor chmod 755 honor.tar.gz tar -zxvf honor.tar.gz chmod -R 755 honor echo &quot;remove old honor hybris source code...&quot; rm -rf /data/workspace/hybris/hybris/bin/custom rm -rf /data/workspace/hybris/hybris/config/local.properties rm -rf /data/workspace/hybris/hybris/config/localextensions.xml echo &quot;copy new honor source code...&quot; cp -r honor/* hybris/hybris cp honor/prod/local.properties hybris/hybris/config/local.properties cp honor/prod/localextensions.xml hybris/hybris/config/localextensions.xml cp template.tomcat.context.tpl hybris/hybris/config/tomcat/tomcat_context.tpl sed -c -i &apos;s/.*name=&quot;backoffice&quot;.*/&lt;!-- &lt;extension name=&quot;backoffice&quot; \\/&gt; --&gt;/g&apos; hybris/hybris/config/localextensions.xml sed -c -i &apos;s/.*requires-channel=&quot;https&quot;.*/&lt;intercept-url pattern=&quot;\\/\\*\\*&quot; requires-channel=&quot;https&quot;\\/&gt;/g&apos; hybris/hybris/bin/custom/honor/honorcommercewebservices/web/webroot/WEB-INF/config/v2/security-v2-spring.xml sed -c -i &apos;s/.*name=&quot;mcc&quot;.*/&lt;!-- &lt;extension name=&quot;mcc&quot; \\/&gt; --&gt;/g&apos; hybris/hybris/config/localextensions.xml #echo cluster.id=$1 &gt;&gt; hybris/hybris/config/local.properties echo -e &quot;\\ncluster.broadcast.method.jgroups.tcp.bind_addr=$1&quot; &gt;&gt; hybris/hybris/config/local.properties echo -e &quot;\\ntask.processing.enabled=fase&quot; &gt;&gt; hybris/hybris/config/local.properties echo -e &quot;\\nhac.webroot=/hac&quot; &gt;&gt; hybris/hybris/config/local.properties rm -rf honor echo &quot;begin to start server...&quot; export JAVA_HOME=&quot;/usr/local/jdk1.8.0_101&quot; export PATH=$JAVA_HOME/bin:$PATH cd /data/workspace/hybris/hybris/bin/platform . ./setantenv.sh ant clean all . ./hybrisserver.sh start exit 0 template.tomcat.context.tpl æ–‡ä»¶å†…å®¹ #if ( $contextPath != &apos;/hmc&apos; &amp;&amp; $contextPath != &apos;/hac&apos; &amp;&amp; $contextPath != &apos;/backoffice&apos; &amp;&amp; $contextPath != &apos;/advancedexport&apos; &amp;&amp; $contextPath != &apos;/admincockpit&apos; &amp;&amp; $contextPath != &apos;/mcc&apos; &amp;&amp; $contextPath != &apos;/reportcockpit&apos; &amp;&amp; $contextPath != &apos;/importcockpit&apos; &amp;&amp; $contextPath != &apos;/cscockpit&apos; &amp;&amp; $contextPath != &apos;/cmscockpit&apos; &amp;&amp; $contextPath != &apos;/cmscockpitRegular&apos; &amp;&amp; $contextPath != &apos;/productcockpit&apos; &amp;&amp; $contextPath != &apos;/chinacheckoutaddon&apos; &amp;&amp; $contextPath != &apos;/instore&apos; &amp;&amp; $contextPath != &apos;/virtualjdbc&apos; &amp;&amp; $contextPath != &apos;/erpintegration&apos; &amp;&amp; $contextPath != &apos;/acceleratorservices&apos; &amp;&amp; $contextPath != &apos;/commercesearchsampledata&apos; &amp;&amp; $contextPath != &apos;/solrfacetsearch&apos; ) #if($contextDescription &amp;&amp; $contextDescription != &apos;&apos;) &lt;!-- $contextDescription --&gt; #end &lt;Context path=&quot;$contextPath&quot; docBase=&quot;$contextDocBase&quot; $!contextAdditionalAttributes&gt; &lt;Manager pathname=&quot;&quot; /&gt; #if($contextLoader &amp;&amp; $contextLoader != &apos;&apos;) $contextLoader #end #if($contextAdditionalElements &amp;&amp; $contextAdditionalElements != &apos;&apos;) $contextAdditionalElements #end &lt;/Context&gt; #end å‘å¸ƒå†…å®¹åç«¯æœåŠ¡å™¨ï¼Œè¿›å…¥åˆ°Prod Release æœåŠ¡å™¨ç›¸åº”ç›®å½•æ‰§è¡Œè„šæœ¬backend_release.sh #!/bin/bash if [ $# -lt 2 ]; then echo &quot;please provide server start index and end index&quot; echo &quot;usage: $0 [start] [end]&quot; # exit 0 fi s=prd-hybris baseIp=10.0.126. let ipStartNum=$1+52 echo &quot;release artifact to hybris server from $s$1 to $s$2&quot; for((i=$1;i&lt;=$2;i++)) do server=$s$i.xxxx.com ipAddr=$baseIp$ipStartNum echo &quot;============deploy on $server====================&quot; echo &quot;copy Hybris production Deployment ZIP to $server&quot; scp /data/build/product/honor.tar.gz app@$server:/data/workspace echo &quot;build hybris on $server and start hybris&quot; ssh app@$server &quot;cd /data/workspace;./stop.sh; nohup ./build_and_start.sh $ipAddr &gt;./build.log 2&gt;&amp;1 &amp; &quot; let ipStartNum=$ipStartNum+1 sleep 1 done echo &quot;done&quot; #exit 0 security-v2-spring.xml æ–‡ä»¶å†…å®¹ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!-- [y] hybris Platform Copyright (c) 2000-2016 SAP SE or an SAP affiliate company. All rights reserved. This software is the confidential and proprietary information of SAP (&quot;Confidential Information&quot;). You shall not disclose such Confidential Information and shall use it only in accordance with the terms of the license agreement you entered into with SAP. --&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:security=&quot;http://www.springframework.org/schema/security&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd&quot;&gt; &lt;http pattern=&quot;/v2/**&quot; entry-point-ref=&quot;oauthAuthenticationEntryPointV2&quot; access-decision-manager-ref=&quot;webSecurityAccessDecisionManager&quot; xmlns=&quot;http://www.springframework.org/schema/security&quot; create-session=&quot;stateless&quot;&gt; &lt;anonymous username=&quot;anonymous&quot; granted-authority=&quot;ROLE_ANONYMOUS&quot;/&gt; &lt;!--&lt;session-management session-authentication-strategy-ref=&quot;fixation&quot;/&gt;--&gt; &lt;intercept-url pattern=&quot;/**&quot; requires-channel=&quot;https&quot;/&gt; &lt;port-mappings&gt; &lt;port-mapping http=&quot;#{configurationService.configuration.getProperty(&apos;tomcat.http.port&apos;)}&quot; https=&quot;#{configurationService.configuration.getProperty(&apos;tomcat.ssl.port&apos;)}&quot;/&gt; &lt;port-mapping http=&quot;#{configurationService.configuration.getProperty(&apos;embeddedserver.http.port&apos;)}&quot; https=&quot;#{configurationService.configuration.getProperty(&apos;embeddedserver.ssl.port&apos;)}&quot; /&gt; &lt;/port-mappings&gt; &lt;custom-filter ref=&quot;resourceServerFilter&quot; before=&quot;PRE_AUTH_FILTER&quot;/&gt; &lt;access-denied-handler ref=&quot;oauthAccessDeniedHandlerV2&quot;/&gt; &lt;headers &gt; &lt;content-type-options /&gt; &lt;hsts include-subdomains=&quot;true&quot; max-age-seconds=&quot;16070400&quot; /&gt; &lt;xss-protection /&gt; &lt;security:frame-options disabled=&quot;true&quot;/&gt; &lt;/headers&gt; &lt;security:csrf disabled=&quot;true&quot;/&gt; &lt;/http&gt; &lt;bean id=&quot;oauthAuthenticationEntryPointV2&quot; parent=&quot;oauthAuthenticationEntryPoint&quot;&gt; &lt;property name=&quot;exceptionRenderer&quot; ref=&quot;oAuth2ExceptionRendererV2&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;oauthAccessDeniedHandlerV2&quot; parent=&quot;oauthAccessDeniedHandler&quot;&gt; &lt;property name=&quot;exceptionRenderer&quot; ref=&quot;oAuth2ExceptionRendererV2&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;oAuth2ExceptionRendererV2&quot; parent=&quot;oAuth2ExceptionRenderer&quot;&gt; &lt;property name=&quot;messageConverters&quot; ref=&quot;messageConvertersV2&quot;/&gt; &lt;/bean&gt; &lt;/beans&gt; å¤§å®¶çœ‹åˆ°äº†å¥½å¤„ï¼Œä¹Ÿçœ‹åˆ°äº†Jenkins ä¸åŒæœåŠ¡å™¨çš„éƒ¨ç½²åŸºæœ¬ç±»ä¼¼ï¼Œå°±æ˜¯è‹¦åŠ›æ´»äº†ï¼Œ æ¥ä¸‹æ¥ä¼šå°†dockerçš„éƒ¨ç½²é™†ç»­æ·»åŠ è¿›æ¥.","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"DevOps","slug":"Coding/DevOps","permalink":"https://dayarch.top/categories/Coding/DevOps/"}],"tags":[{"name":"Jenkins","slug":"Jenkins","permalink":"https://dayarch.top/tags/Jenkins/"}]},{"title":"Spring AOP","slug":"Spring-AOPé…ç½®","date":"2017-02-23T12:14:54.000Z","updated":"2019-11-01T08:52:53.872Z","comments":true,"path":"/p/spring-aop.html","link":"","permalink":"https://dayarch.top/p/spring-aop.html","excerpt":"å‰è¨€ Spring AOP çš„é“ç†æ‡‚å¾—ï¼Œä½†æ˜¯å¾ˆå°‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œåˆšå·§è¿™ä¸ªé¡¹ç›®ä¸­æœ‰ç”¨åˆ°ï¼Œå°†AOPçš„ç†è§£ä»¥åŠä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜åŠ ä»¥æ€»ç»“è®°å½• ä½¿ç”¨åœºæ™¯ è®¾æƒ³ä¸€ä¸‹ï¼Œé¡¹ç›®å·²æ¥è¿‘å°¾å£°ï¼Œç»ç†è¯´ä¸ºäº†é¡¹ç›®éªŒæ”¶ï¼Œæ›´å¥½çš„ç›‘æ§ç¨‹åºè°ƒç”¨æ—¥å¿—ï¼Œéœ€è¦åœ¨æ¯ä¸ªæ–¹æ³•è°ƒç”¨å‰æˆ–è°ƒç”¨ååŠ ä¸Šæ—¥å¿—ï¼Œå¤©å•Šï¼Œè¿™æ˜¯å¤šå¤§çš„å·¥ä½œé‡ï¼Œé¡¹ç›®ä¸­è‡³å°‘æœ‰å‡ ç™¾ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬è¦åšè¿™ç§æ— è„‘çš„å·¥ä½œäº†å—ï¼Ÿ å¦‚æœä¸æ‡‚å¾—Spring AOPé¢å‘åˆ‡é¢ç¼–ç¨‹çš„é“ç†ï¼Œé‚£è¿™ä¸ªä½“åŠ›æ´»çœ‹æ¥æ˜¯è´¹åŠ›ä¸è®¨å¥½çš„äº‹æƒ…ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ…¢æ…¢å‰–æSpring AOP çš„é“ç†. Java åŠ¨æ€ä»£ç† Java23ä¸­è®¾è®¡æ¨¡å¼ä¹‹ä¸€ä»£ç†æ¨¡å¼ï¼ŒSpring AOPå……åˆ†åˆ©ç”¨äº†Java åŠ¨æ€ä»£ç†åŠŸèƒ½æ¥å®ç°ï¼ˆå¯¹åŠ¨æ€ä»£ç†æœ‰æ‰€","text":"å‰è¨€Spring AOP çš„é“ç†æ‡‚å¾—ï¼Œä½†æ˜¯å¾ˆå°‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œåˆšå·§è¿™ä¸ªé¡¹ç›®ä¸­æœ‰ç”¨åˆ°ï¼Œå°†AOPçš„ç†è§£ä»¥åŠä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜åŠ ä»¥æ€»ç»“è®°å½• ä½¿ç”¨åœºæ™¯è®¾æƒ³ä¸€ä¸‹ï¼Œé¡¹ç›®å·²æ¥è¿‘å°¾å£°ï¼Œç»ç†è¯´ä¸ºäº†é¡¹ç›®éªŒæ”¶ï¼Œæ›´å¥½çš„ç›‘æ§ç¨‹åºè°ƒç”¨æ—¥å¿—ï¼Œéœ€è¦åœ¨æ¯ä¸ªæ–¹æ³•è°ƒç”¨å‰æˆ–è°ƒç”¨ååŠ ä¸Šæ—¥å¿—ï¼Œå¤©å•Šï¼Œè¿™æ˜¯å¤šå¤§çš„å·¥ä½œé‡ï¼Œé¡¹ç›®ä¸­è‡³å°‘æœ‰å‡ ç™¾ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬è¦åšè¿™ç§æ— è„‘çš„å·¥ä½œäº†å—ï¼Ÿ å¦‚æœä¸æ‡‚å¾—Spring AOPé¢å‘åˆ‡é¢ç¼–ç¨‹çš„é“ç†ï¼Œé‚£è¿™ä¸ªä½“åŠ›æ´»çœ‹æ¥æ˜¯è´¹åŠ›ä¸è®¨å¥½çš„äº‹æƒ…ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ…¢æ…¢å‰–æSpring AOP çš„é“ç†. Java åŠ¨æ€ä»£ç†Java23ä¸­è®¾è®¡æ¨¡å¼ä¹‹ä¸€ä»£ç†æ¨¡å¼ï¼ŒSpring AOPå……åˆ†åˆ©ç”¨äº†Java åŠ¨æ€ä»£ç†åŠŸèƒ½æ¥å®ç°ï¼ˆå¯¹åŠ¨æ€ä»£ç†æœ‰æ‰€ç†è§£çš„å¯ä»¥è·³è¿‡è¯¥æ®µå†…å®¹ï¼‰ï¼Œå³ä¾¿æ²¡æœ‰Spring AOP æˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿé€šè¿‡Java åŠ¨æ€ä»£ç†è§£å†³ä¸Šè¿°é—®é¢˜. åœ¨Java åŠ¨æ€ä»£ç†ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¥å£æˆ–ç±»ï¼š InvocationHandler ï¼ˆInterfaceï¼‰ Proxy ï¼ˆClassï¼‰ è¿™ä¸€ä¸ªæ¥å£å’Œç±»æ˜¯å®ç°æˆ‘ä»¬åŠ¨æ€ä»£ç†æ‰€å¿…é¡»ç”¨åˆ°çš„ï¼Œå…¶å®è¿™ç§è®¾è®¡æ¨¡å¼å¯ä»¥è”æƒ³åˆ°æˆ‘ä»¬ç°å®ç”Ÿæ´»ä¸­çš„ä»£è´­æˆ–ä»£ç†å•†: è¿™æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆå¥½åƒå’Œæˆ‘ä»¬è¯´çš„é¡¹ç›®ä¸­éœ€è¦ä¸æ²¾è¾¹é™…ï¼Œé¡¹ç›®å¿«è¦ç»“æŸäº†ï¼Œæ»¡é¡¹ç›®é‹å­å’Œè¡£æœæ–¹æ³•å·²ç»å†™å¥½ï¼Œçªç„¶é¡¹ç›®ç»ç†è¯´è¦ç»™é‹å­å’Œè¡£æœåŠ ä¸ŠåŒ…è£…ï¼ˆæ—¥å¿—ï¼‰ï¼Œåˆšå¥½ä»£ç†å•†å¯ä»¥è½»æ¾åšåˆ°è¿™ä¸ªï¼Œæ¯æ¬¡å®¢æˆ·è°ƒç”¨é‹å­å’Œè¡£æœæ–¹æ³•æ—¶ï¼Œåªéœ€è¦è°ƒç”¨ä»£ç†å•†æš´éœ²å‡ºæ¥çš„é‹å­å’Œæ–¹æ³•å³å¯, è¿˜æ²¡æ‡‚ï¼Ÿ æ²¡å…³ç³»ï¼Œç¨‹åºçŒ¿çœ‹ä»£ç è¿˜æ˜¯æœ€å®é™…çš„. InvocationHandlerçœ‹ä¸€ä¸‹å®˜æ–¹å®šä¹‰ï¼š InvocationHandler is the interface implemented by the invocation handler of a proxy instance. Each proxy instance has an associated invocation handler. When a method is invoked on a proxy instance, the method invocation is encoded and dispatched to the invoke method of its invocation handler. â€”â€” InvocationHandler æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒè¢«ä¸€ä¸ªä»£ç†ç±»å®ä¾‹çš„handleræ‰€å®ç°ï¼Œæ¯ä¸€ä¸ªä»£ç†ç±»å®ä¾‹éƒ½æœ‰å…¶å¯¹åº”çš„handler, å½“ä¸€ä¸ªä»£ç†å®ä¾‹çš„æ–¹æ³•è¢«è°ƒç”¨ï¼Œæ–¹æ³•çš„è°ƒç”¨å°±äº¤ç»™äº†å®ƒå¯¹åº”çš„handleræ¥å¤„ç† InvocationHandler æ¥å£åªå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•ï¼š Object invoke(Object proxy, Method method, Object[] args) throws Throwable; proxy : ä»£ç†ç±»å¯¹è±¡ method : æˆ‘ä»¬è°ƒç”¨çœŸå®å¯¹è±¡çš„æŸä¸ªæ–¹æ³• args : æˆ‘ä»¬è°ƒç”¨çœŸæ˜¯å¯¹è±¡çš„æŸä¸ªæ–¹æ³•æ¥å—çš„å‚æ•° Proxyçœ‹ä¸€ä¸‹å®˜æ–¹å®šä¹‰ï¼š Proxy provides static methods for creating dynamic proxy classes and instances, and it is also the superclass of all dynamic proxy classes created by those methods. â€”â€” Proxyæä¾›ä¸€ä¸ªé™æ€æ–¹æ³•ç”¨æ¥åˆ›å»ºåŠ¨æ€ä»£ç†ç±»å®ä¾‹ï¼Œå¹¶ä¸”æ˜¯æ‰€æœ‰ä»£ç†ç±»çš„çˆ¶ç±» Proxy ç±»ä¸­æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ï¼š /** *Returns an instance of a proxy class for the specified interfaces that dispatches method invocations to the specified invocation handler */ public static Object newProxyInstance(ClassLoader loader, Class[] interfaces, InvocationHandler h) { try { Class e = getProxyClass(loader, interfaces); return e.getConstructor(new Class[]{InvocationHandler.class}).newInstance(new Object[]{h}); } catch (RuntimeException var4) { throw var4; } catch (Exception var5) { throw new CodeGenerationException(var5); } } loader : ä¸€ä¸ªClassLoaderå¯¹è±¡ï¼Œå®šä¹‰äº†ç”±å“ªä¸ªClassLoaderå¯¹è±¡æ¥å¯¹ç”Ÿæˆçš„ä»£ç†å¯¹è±¡è¿›è¡ŒåŠ è½½ interfaces : ä¸€ä¸ªInterfaceå¯¹è±¡çš„æ•°ç»„ï¼Œè¡¨ç¤ºçš„æ˜¯æˆ‘å°†è¦ç»™æˆ‘éœ€è¦ä»£ç†çš„å¯¹è±¡æä¾›ä¸€ç»„ä»€ä¹ˆæ¥å£ï¼Œå¦‚æœæˆ‘æä¾›äº†ä¸€ç»„æ¥å£ç»™å®ƒï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ç†å¯¹è±¡å°±å®£ç§°å®ç°äº†è¯¥æ¥å£(å¤šæ€)ï¼Œè¿™æ ·æˆ‘å°±èƒ½è°ƒç”¨è¿™ç»„æ¥å£ä¸­çš„æ–¹æ³•äº† h : ä¸€ä¸ªInvocationHandlerå¯¹è±¡ï¼Œè¡¨ç¤ºçš„æ˜¯å½“æˆ‘è¿™ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå…³è”åˆ°å“ªä¸€ä¸ªInvocationHandlerå¯¹è±¡ä¸Š ä»£ç ç¤ºä¾‹å®šä¹‰Subject æ¥å£ï¼špublic interface Subject { public void shoes(); public void clothes(String str); }å®šä¹‰æ¥å£çœŸå®å®ç°ç±»public class RealSubject implements Subject { @Override public void shoes() { System.out.println(&quot;This is shoes method without packaging&quot;); } @Override public void clothes(String str) { System.out.println(&quot;hello: &quot; + str); } }å®šä¹‰åŠ¨æ€ä»£ç†ç±»ï¼Œå¹¶å®ç°InvocationHandler æ¥å£public class DynamicProxy implements InvocationHandler { //è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¦ä»£ç†çš„çœŸå®å¯¹è±¡ private Object subject; //æ„é€ æ–¹æ³•ï¼Œç»™æˆ‘ä»¬è¦ä»£ç†çš„çœŸå®å¯¹è±¡èµ‹åˆå€¼ public DynamicProxy(Object subject) { this.subject = subject; } @Override public Object invoke(Object object, Method method, Object[] args) throws Throwable { //åœ¨ä»£ç†çœŸå®å¯¹è±¡å‰æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€äº›è‡ªå·±çš„æ“ä½œï¼Œæ¯”å¦‚ç»™é‹å­å’Œè¡£æœåšåŒ…è£… System.out.println(&quot;before packaging&quot;); System.out.println(&quot;Method:&quot; + method); //å½“ä»£ç†å¯¹è±¡è°ƒç”¨çœŸå®å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œå…¶ä¼šè‡ªåŠ¨çš„è·³è½¬åˆ°ä»£ç†å¯¹è±¡å…³è”çš„handlerå¯¹è±¡çš„invokeæ–¹æ³•æ¥è¿›è¡Œè°ƒç”¨ method.invoke(subject, args); //åœ¨ä»£ç†çœŸå®å¯¹è±¡åæˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ ä¸€äº›è‡ªå·±çš„æ“ä½œï¼ŒåŠ å®ŒåŒ…è£…ä¹‹åçš„ä¸€äº›å”®åæœåŠ¡ System.out.println(&quot;after packaging&quot;); return null; } }çœ‹çœ‹å®¢æˆ·ç«¯ç±»çš„å®šä¹‰public class Client { public static void main(String[] args) { //æˆ‘ä»¬è¦ä»£ç†çš„çœŸå®å¯¹è±¡ Subject realSubject = new RealSubject(); //æˆ‘ä»¬è¦ä»£ç†å“ªä¸ªçœŸå®å¯¹è±¡ï¼Œå°±å°†è¯¥å¯¹è±¡ä¼ è¿›å»ï¼Œæœ€åæ˜¯é€šè¿‡è¯¥çœŸå®å¯¹è±¡æ¥è°ƒç”¨å…¶æ–¹æ³•çš„ InvocationHandler handler = new DynamicProxy(realSubject); /* * é€šè¿‡Proxyçš„newProxyInstanceæ–¹æ³•æ¥åˆ›å»ºæˆ‘ä»¬çš„ä»£ç†å¯¹è±¡ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä¸‰ä¸ªå‚æ•° * ç¬¬ä¸€ä¸ªå‚æ•° handler.getClass().getClassLoader() ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨handlerè¿™ä¸ªç±»çš„ClassLoaderå¯¹è±¡æ¥åŠ è½½æˆ‘ä»¬çš„ä»£ç†å¯¹è±¡ * ç¬¬äºŒä¸ªå‚æ•°realSubject.getClass().getInterfaces()ï¼Œæˆ‘ä»¬è¿™é‡Œä¸ºä»£ç†å¯¹è±¡æä¾›çš„æ¥å£æ˜¯çœŸå®å¯¹è±¡æ‰€å®è¡Œçš„æ¥å£ï¼Œè¡¨ç¤ºæˆ‘è¦ä»£ç†çš„æ˜¯è¯¥çœŸå®å¯¹è±¡ï¼Œè¿™æ ·æˆ‘å°±èƒ½è°ƒç”¨è¿™ç»„æ¥å£ä¸­çš„æ–¹æ³•äº† * ç¬¬ä¸‰ä¸ªå‚æ•°handlerï¼Œ æˆ‘ä»¬è¿™é‡Œå°†è¿™ä¸ªä»£ç†å¯¹è±¡å…³è”åˆ°äº†ä¸Šæ–¹çš„ InvocationHandler è¿™ä¸ªå¯¹è±¡ä¸Š */ Subject subject = (Subject)Proxy.newProxyInstance(handler.getClass().getClassLoader(), realSubject .getClass().getInterfaces(), handler); System.out.println(subject.getClass().getName()); subject.shoes(); subject.clothes(&quot;clothes, it&apos;s without packaging&quot;); } }æ§åˆ¶å°çš„è¾“å‡ºç»“æœ$Proxy0 before packaging Method:public abstract void com.xiaoluo.dynamicproxy.Subject.shoes() This is shoes method without packaging after packaging before packaging Method:public abstract void com.xiaoluo.dynamicproxy.Subject.clothes(java.lang.String) hello: clothes, it&apos;s without packaging after packagingProxy.newProxyInstance ç”Ÿæˆä»£ç†å¯¹è±¡æ—¶æ‰€éœ€è¦çš„invocationHandler å‚æ•°æ›´åƒæ˜¯ä»£ç†å•†å’Œä¾›åº”å•†ä¹‹é—´çš„ç‰©æµï¼Œå½“ä»£ç†å•†éœ€è¦ä¾›åº”å•†çš„é‹å­æ—¶å€™ï¼Œéœ€è¦å‘Šè¯‰è¿™ä¸ªç‰©æµå»å–é‹å­. ä¸€ä¸ªä»£ç†å•†å½“ç„¶ä¹Ÿä»£ç†å¤šä¸ªå“ç‰Œï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå‚æ•°ä¸­interfaces æ˜¯æ•°ç»„å½¢å¼ï¼Œè‡³æ­¤å…³äºJava åŠ¨æ€ä»£ç†å°±å‘Šä¸€æ®µè½äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹Spring AOP , é“ç†éƒ½æ˜¯ç›¸é€šçš„. Spring AOPæœ¯è¯­è§£é‡Š æœ¯è¯­åç§° å¯¹åº”è§£é‡Š å®˜æ–¹æœ¯è¯­æè¿° Aspect å®ƒæ˜¯ä¸€ä¸ªåŒ…å«ä¸€ç³»åˆ—APIçš„æ¨¡å—ï¼ŒåŒæ—¶æä¾›æ¨ªåˆ‡çš„éœ€æ±‚ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•. A module which has a set of APIs providing cross-cutting requirements. For example, a logging module would be called AOP aspect for logging. An application can have any number of aspects depending on the requirement. Join point åº”ç”¨ç¨‹åºçœŸæ­£ä¼šå‘ç”Ÿé€šçŸ¥è¡Œä¸ºçš„ä¸€ä¸ªç‚¹ This represents a point in your application where you can plug-in AOP aspect. You can also say, it is the actual place in the application where an action will be taken using Spring AOP framework. Advice å¯ä»¥ç†è§£ä¸ºé€šçŸ¥ï¼Œåœ¨ç›®æ ‡ç¨‹åºæ‰§è¡Œå‰é€šçŸ¥è¿˜æ˜¯æ‰§è¡Œåé€šçŸ¥ This is the actual action to be taken either before or after the method execution. This is actual piece of code that is invoked during program execution by Spring AOP framework. Pointcut Join Pointçš„é›†åˆï¼Œç¨‹åºä¸­æ‰€æœ‰æƒ³åˆ‡å…¥çš„ç‚¹çš„é›†åˆ This is a set of one or more joinpoints where an advice should be executed. You can specify pointcuts using expressions or patterns as we will see in our AOP examples. Advice é€šçŸ¥ æœ¯è¯­åç§° å¯¹åº”è§£é‡Š å®˜æ–¹æœ¯è¯­æè¿° before åœ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•ä¹‹å‰é€šçŸ¥ Run advice before the a method execution after åœ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•ä¹‹åé€šçŸ¥ï¼Œä¸ç®¡ç›®æ ‡æ–¹æ³•æ˜¯å¦æ‰§è¡ŒæˆåŠŸ Run advice after the a method execution regardless of its outcome. after-returning å½“ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œæ²¡æœ‰ä»»ä½•å¼‚å¸¸ä¹‹å Run advice after the a method execution only if method completes successfully after-throwing after æˆ– after-returning è¿è¡Œä¹‹åæ•è·å¼‚å¸¸ Run advice after the a method execution only if method exits by throwing an exception. around è¿è¡Œç›®æ ‡æ–¹æ³•å‰åç¯ç»• Run advice before and after the advised method is invoked try{ //å‰ç½®é€šçŸ¥ //ç¯ç»•é€šçŸ¥ //è°ƒç”¨ç›®æ ‡å¯¹è±¡æ–¹æ³• //ç¯ç»•é€šçŸ¥ //åç½®é€šçŸ¥ }catch(){ //å¼‚å¸¸é€šçŸ¥ }finally{ //ç»ˆæ­¢é€šçŸ¥ }Spring XMLé…ç½®&lt;context:annotation-config/&gt; &lt;aop:config proxy-target-class=&quot;true&quot; expose-proxy=&quot;true&quot;&gt; &lt;aop:aspect ref=&quot;capitalModification&quot;&gt; &lt;aop:pointcut id=&quot;handleOrder&quot; expression=&quot;execution(* com.honor.facades.app.order.HonorOrderFacade.handleCapital(..)) || execution(* com.honor.facades.serviceOrder.HonorServiceOrderFacade.handleCapital(..)) || execution(* com.honor.facades.aftersales.HonorReturnFormFacades.handleCapital(..))&quot;/&gt; &lt;aop:after method=&quot;capitalAndRecordModification&quot; pointcut-ref=&quot;handleOrder&quot;/&gt; &lt;aop:after-throwing throwing=&quot;ex&quot; method=&quot;capitalAndRecordModificationExceptionHandle&quot; pointcut-ref=&quot;handleOrder&quot;/&gt; &lt;/aop:aspect&gt; &lt;/aop:config&gt; &lt;bean id=&quot;capitalModification&quot; class=&quot;com.honor.core.customerCapital.impl.DefaultCapitalModificationStrategy&quot;&gt; &lt;property name=&quot;customerCapitalService&quot; ref=&quot;customerCapitalService&quot;/&gt; &lt;property name=&quot;honorSuperOrderService&quot; ref=&quot;honorSuperOrderService&quot;/&gt; &lt;property name=&quot;honorBillService&quot; ref=&quot;honorBillService&quot;/&gt; &lt;/bean&gt;å¤šä¸ªpointcut å¯ä»¥ç”¨ || æˆ– or æ¥å®ç°. é¡¹ç›®ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜å…³äºAOPæ— æ³•åˆ‡å…¥åŒç±»è°ƒç”¨æ–¹æ³•çš„é—®é¢˜Controller å±‚æ–¹æ³•Aè°ƒç”¨äº†Facadeå±‚æ–¹æ³•Bï¼Œå¯æ˜¯Bå†…è°ƒç”¨äº†æ–¹æ³•C, æˆ‘ä»¬æƒ³ä½¿ç”¨AOPç»‡å…¥æ–¹æ³•C, å½“ç¨‹åºè¿è¡Œåï¼Œ å§‹ç»ˆæ‰¾ä¸åˆ°ä»£ç†æ–¹æ³•ï¼Œæ„å‘³ç€ç»‡å…¥Cæ²¡æœ‰æˆåŠŸ, public class MyController{ public void methodA(){ myFacade.methodB(); } } public class MyController{ public void methodB(){ myFacade.methodC(); } public void methodC(){ System.out.println(&quot;bingo&quot;); } } public class Aspect { @AfterReturning(execution(* Facade.methodB(..))) public void after() { Logger.info(after call and do something); } } æˆ‘ä»¬å‘ç°åœ¨ AopContext.class ä¸­ï¼š public static Object currentProxy() throws IllegalStateException { Object proxy = currentProxy.get(); if(proxy == null) { throw new IllegalStateException(&quot;Cannot find current proxy: Set \\&apos;exposeProxy\\&apos; property on Advised to \\&apos;true\\&apos; to make it available.&quot;); } else { return proxy; } }è§£å†³åŠæ³•ï¼š è®¾ç½®proxy-target-class=â€trueâ€expose-proxy=â€trueâ€ &lt;aop:aspectj-autoproxy proxy-target-class=&quot;true&quot;expose-proxy=&quot;true&quot;/&gt; æ‰‹åŠ¨æŒ‡å®šä»£ç†è°ƒç”¨æ–¹æ³• ((Facade) AopContext.currentProxy()).methodB(); å‚è€ƒé“¾æ¥éå¸¸æ„Ÿè°¢ä»¥ä¸‹å‡ ä½åšä¸»ï¼Œåœ¨ä½ ä»¬è®¤çœŸçš„åšå®¢ä¸Šå­¦åˆ°äº†è®¸å¤š. http://blog.csdn.net/lirui0822/article/details/8555691 http://www.cnblogs.com/xiaoluo501395377/p/3383130.html åŒæ—¶ä¿®æ”¹AOPå‡½æ•°è¿”å›å€¼åŠè·å–å‡½æ•°å‚æ•°è¯·å‚è€ƒä»¥ä¸‹æ–‡ç« ï¼š http://blog.csdn.net/cleverutd/article/details/8607491 https://my.oschina.net/itblog/blog/211693","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring","slug":"Coding/Spring","permalink":"https://dayarch.top/categories/Coding/Spring/"}],"tags":[{"name":"Spring","slug":"Spring","permalink":"https://dayarch.top/tags/Spring/"},{"name":"AOP","slug":"AOP","permalink":"https://dayarch.top/tags/AOP/"}]},{"title":"Jenkinså­¦ä¹ ä¹‹é‚®ç®±é…ç½®","slug":"Jenkinså­¦ä¹ ä¹‹é‚®ç®±é…ç½®","date":"2017-01-05T07:05:18.000Z","updated":"2019-11-01T08:46:03.072Z","comments":true,"path":"/p/jenkins-config-mail.html","link":"","permalink":"https://dayarch.top/p/jenkins-config-mail.html","excerpt":"ä½¿ç”¨åœºæ™¯ å¼€å‘äººå‘˜build project ä¹‹åï¼Œbuildç»“æœæ— è®ºæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½è¦åŠæ—¶çš„é€šçŸ¥ç»„å†…å…¶ä»–æˆå‘˜äº†è§£æœ€æ–°æƒ…å†µï¼Œé‚®ä»¶é€šçŸ¥è¿™æ—¶å€™å°±æ´¾ä¸Šç”¨åœºï¼Œæ°å·§ Jenkins æä¾›äº†è¿™ä¹ˆä¸€ä¸ªåŠŸèƒ½ï¼Œä¸è¿‡è¯¥åŠŸèƒ½è¿˜æ˜¯è¿‡äºå•ä¸€ï¼Œå¦‚ä¸èƒ½ç¼–å†™email template æ¥æ ¼å¼åŒ–é‚®ä»¶å†…å®¹ï¼Œä½†Extended E-mail Notificationï¼ˆJenkins é‚®ä»¶æ’ä»¶ï¼‰å®ç°äº†æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥é€æ­¥çœ‹ä¸€ä¸‹ Jenkins é‚®ä»¶åŠŸèƒ½çš„é…ç½® é…ç½®é‚®ä»¶æœåŠ¡å™¨ ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ï¼Œåœ¨ Jenkins é¦–é¡µclick Manage Jenkins, ç„¶å click Configure System, ä¸‹æ‹‰åˆ°é¡µé¢","text":"ä½¿ç”¨åœºæ™¯å¼€å‘äººå‘˜build project ä¹‹åï¼Œbuildç»“æœæ— è®ºæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½è¦åŠæ—¶çš„é€šçŸ¥ç»„å†…å…¶ä»–æˆå‘˜äº†è§£æœ€æ–°æƒ…å†µï¼Œé‚®ä»¶é€šçŸ¥è¿™æ—¶å€™å°±æ´¾ä¸Šç”¨åœºï¼Œæ°å·§ Jenkins æä¾›äº†è¿™ä¹ˆä¸€ä¸ªåŠŸèƒ½ï¼Œä¸è¿‡è¯¥åŠŸèƒ½è¿˜æ˜¯è¿‡äºå•ä¸€ï¼Œå¦‚ä¸èƒ½ç¼–å†™email template æ¥æ ¼å¼åŒ–é‚®ä»¶å†…å®¹ï¼Œä½†Extended E-mail Notificationï¼ˆJenkins é‚®ä»¶æ’ä»¶ï¼‰å®ç°äº†æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥é€æ­¥çœ‹ä¸€ä¸‹ Jenkins é‚®ä»¶åŠŸèƒ½çš„é…ç½® é…ç½®é‚®ä»¶æœåŠ¡å™¨ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ï¼Œåœ¨ Jenkins é¦–é¡µclick Manage Jenkins, ç„¶å click Configure System, ä¸‹æ‹‰åˆ°é¡µé¢çš„æœ€åº•éƒ¨ E-mail Notification å¤„ï¼š æ­¤å¤„æˆ‘ç”¨äº†ç½‘æ˜“yeah.netçš„é‚®ç®±ï¼ŒUser Name(é‚®ç®±è´¦å·)ï¼ŒPassword(é‚®ç®±å¯†ç )ï¼Œåœ¨Test e-mail recipient(æ¥æ”¶é‚®ä»¶)ï¼Œä¸è¿‡é…ç½®äº†è¿™äº›ä»…ä»…æ˜¯é…ç½®é‚®ä»¶æœåŠ¡å™¨åœ°å€ã€è´¦å·å’Œå¯†ç ï¼Œä½†æ˜¯jenkinsä¸çŸ¥é“é‡‡ç”¨å“ªä¸ªé‚®ç®±å»å‘é€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è¯¥å¤„é…ç½®å‘é€çš„é‚®ç®±ï¼Œå¹¶ä¸”è¦å’Œç®¡ç†å‘˜çš„é‚®ç®±ä¸€è‡´ åˆ°æ­¤ç‚¹å‡»ä¸€ä¸‹Test configuration button çœ‹ä¸€ä¸‹æµ‹è¯•ç»“æœï¼Œå¦‚æœæµ‹è¯•ä¸æˆåŠŸè¦æ£€æŸ¥ä¸€ä¸‹ç®¡ç†å‘˜é‚®ç®±æ˜¯å¦æœ‰å¼€é€š SMTPæœåŠ¡ï¼Œç™»å½•ä½ è®¾ç½®çš„é‚®ç®±å¼€é€šSMTP è®¾ç½®å®Œä¹‹åæµ‹è¯•ç»“æœä¸ºæˆåŠŸ å½“æˆ‘ä»¬åœ¨project ä¸­é…ç½®buildä¹‹åçš„è¡Œä¸ºæ—¶ï¼Œå¯ä»¥æ·»åŠ é‚®ä»¶é€šçŸ¥ï¼Œè¿™æ ·åœ¨æ¥æ”¶äººåˆ—è¡¨ä¸­çš„äººéƒ½å¯ä»¥æ¥å—åˆ°buildçš„ç»“æœï¼š build ä¸€ä¸‹é¡¹ç›®ï¼Œçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰æ”¶åˆ°é‚®ä»¶é€šçŸ¥å§. å®‰è£…Emailæ’ä»¶Jenkins é¦–é¡µ â€”â€” Manage Jenkins â€”â€” Manage Pluginsï¼Œå®‰è£…è¯¥æ’ä»¶ é‡æ–°å¯åŠ¨Jenkins, å¯ä»¥åœ¨åˆšåˆšé…ç½®é‚®ä»¶çš„ä¸Šæ–¹çœ‹åˆ°å·²å®‰è£…å¥½çš„email æ’ä»¶ è¿™æ ·ç¼–è¾‘Default Content å­—æ®µæ¥ç¼–å†™email template, æ”¯æŒ HTML æ ‡ç­¾. è¿™æ ·åœ¨é¡¹ç›®æ„å»ºåè¡Œä¸ºä¸­é€‰æ‹©Editable Email Notificatioin æ¥å‘å¸ƒbuildçš„ç»“æœ NOTE: å¤§å®¶çœ‹ä¸æ‡‚çš„å­—æ®µå¤šå¤šç‚¹å¼€å­—æ®µå³ä¾§çš„é—®å·ï¼Œé‡Œé¢çš„è¯´æ˜è¿˜æ˜¯éå¸¸æ¸…æ™°çš„. é‚®ä»¶æ’ä»¶çš„å…¶ä»–å°åŠŸèƒ½ä¹Ÿè¯·è‡ªè¡Œç ”ç©¶.","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"DevOps","slug":"Coding/DevOps","permalink":"https://dayarch.top/categories/Coding/DevOps/"}],"tags":[{"name":"Jenkins","slug":"Jenkins","permalink":"https://dayarch.top/tags/Jenkins/"}]},{"title":"å·§ç”¨PostMan","slug":"å·§ç”¨PostMan","date":"2016-10-27T09:06:12.000Z","updated":"2019-11-01T09:01:07.922Z","comments":true,"path":"/p/postman-advanced-usage.html","link":"","permalink":"https://dayarch.top/p/postman-advanced-usage.html","excerpt":"ç°åœ¨è¶Šå‘çš„è®¤è¯†åˆ°å·§ç”¨å·¥å…·æé«˜å·¥ä½œæ•ˆç‡çš„é‡è¦æ€§ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹PostManå¸¦æ¥çš„ä¾¿åˆ© ä¸šåŠ¡æƒ…æ™¯ åœ¨å®é™…å·¥ä½œä¸­ï¼Œå½“Appæˆ–å…¶ä»–æ¸ é“æ¥è°ƒç”¨Javaåå°æ¥å£çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç”¨åˆ°PostManè¿™ä¸ªå·¥å…·æ¥æ¨¡æ‹Ÿè°ƒç”¨ï¼Œå½“éœ€è¦tokenæ¥ä½œä¸ºéªŒè¯çš„æ—¶å€™ï¼Œå½“æ¯æ¬¡è¯·æ±‚çš„tokenå‘ç”Ÿå˜åŒ–çš„æ—¶å€™æˆ‘ä»¬åŒæ—¶è¦æ”¹å˜å…¶ä»–è¯·æ±‚URLä¸­çš„tokenå†…å®¹ï¼Œè¿™æ ·å¾ˆéº»çƒ¦ï¼Œé™ä½å·¥ä½œæ•ˆç‡ï¼ŒPostMançš„ç¯å¢ƒå˜é‡è§£å†³äº†è¿™ä¸ªé—®é¢˜ é…ç½®ç¯å¢ƒå˜é‡ and and and and and and è‡³æ­¤è®¾ç½®ç¯å¢ƒå˜é‡ç»“æŸï¼Œå…¶ä»–åŠŸèƒ½ä¼šé™†ç»­è¡¥å…….","text":"ç°åœ¨è¶Šå‘çš„è®¤è¯†åˆ°å·§ç”¨å·¥å…·æé«˜å·¥ä½œæ•ˆç‡çš„é‡è¦æ€§ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹PostManå¸¦æ¥çš„ä¾¿åˆ© ä¸šåŠ¡æƒ…æ™¯åœ¨å®é™…å·¥ä½œä¸­ï¼Œå½“Appæˆ–å…¶ä»–æ¸ é“æ¥è°ƒç”¨Javaåå°æ¥å£çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç”¨åˆ°PostManè¿™ä¸ªå·¥å…·æ¥æ¨¡æ‹Ÿè°ƒç”¨ï¼Œå½“éœ€è¦tokenæ¥ä½œä¸ºéªŒè¯çš„æ—¶å€™ï¼Œå½“æ¯æ¬¡è¯·æ±‚çš„tokenå‘ç”Ÿå˜åŒ–çš„æ—¶å€™æˆ‘ä»¬åŒæ—¶è¦æ”¹å˜å…¶ä»–è¯·æ±‚URLä¸­çš„tokenå†…å®¹ï¼Œè¿™æ ·å¾ˆéº»çƒ¦ï¼Œé™ä½å·¥ä½œæ•ˆç‡ï¼ŒPostMançš„ç¯å¢ƒå˜é‡è§£å†³äº†è¿™ä¸ªé—®é¢˜ é…ç½®ç¯å¢ƒå˜é‡andandandandandand è‡³æ­¤è®¾ç½®ç¯å¢ƒå˜é‡ç»“æŸï¼Œå…¶ä»–åŠŸèƒ½ä¼šé™†ç»­è¡¥å…….","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Others","slug":"Coding/Others","permalink":"https://dayarch.top/categories/Coding/Others/"}],"tags":[{"name":"PostMan","slug":"PostMan","permalink":"https://dayarch.top/tags/PostMan/"}]},{"title":"Git Ignoring Files","slug":"Git-Ignoring-Files","date":"2016-10-15T01:32:43.000Z","updated":"2019-11-07T05:24:49.443Z","comments":true,"path":"/p/git-ignore.html","link":"","permalink":"https://dayarch.top/p/git-ignore.html","excerpt":"å‰è¨€ ä»¥ä¸‹å†…å®¹æ ¹æ®Git Helpä»¥åŠGit Docs æ•´ç†ç¿»è¯‘ Ignoring files(å¿½ç•¥æ–‡ä»¶) æœ‰æ—¶å€™ä¼šæœ‰ä¸€äº›æˆ‘ä»¬ä¸æƒ³Git æäº¤ä¸€äº›æ–‡ä»¶åˆ°GitHub/GitLabï¼Œä¸‹é¢æœ‰å‡ ç§æ–¹å¼è®©æˆ‘ä»¬å‘Šè¯‰Gitæ¥å¿½ç•¥å“ªäº›æ–‡ä»¶. Create a local .gitignoreï¼ˆåˆ›å»ºå±€éƒ¨/æœ¬åœ°çš„.gitignoreæ–‡ä»¶ï¼‰ å¦‚æœåœ¨local repositoryï¼ˆä»“åº“ï¼‰ä¸­åˆ›å»ºä¸€ä¸ªåä¸º.gitignoreçš„æ–‡ä»¶ï¼Œåœ¨ä½ commitï¼ˆæäº¤ï¼‰åŠ¨ä½œä¹‹å‰ï¼ŒGit å°†ä¼šè¯»å–*.gitignoreæ–‡ä»¶å»åˆ¤æ–­å“ªäº›æ–‡ä»¶æˆ–è€…ç›®å½•éœ€è¦å¿½ç•¥æ‰. åŒæ—¶è¿™ä¸ªæ–‡ä»¶åº”è¯¥pushåˆ°remote repository, è¿™æ ·cl","text":"å‰è¨€ä»¥ä¸‹å†…å®¹æ ¹æ®Git Helpä»¥åŠGit Docs æ•´ç†ç¿»è¯‘ Ignoring files(å¿½ç•¥æ–‡ä»¶)æœ‰æ—¶å€™ä¼šæœ‰ä¸€äº›æˆ‘ä»¬ä¸æƒ³Git æäº¤ä¸€äº›æ–‡ä»¶åˆ°GitHub/GitLabï¼Œä¸‹é¢æœ‰å‡ ç§æ–¹å¼è®©æˆ‘ä»¬å‘Šè¯‰Gitæ¥å¿½ç•¥å“ªäº›æ–‡ä»¶. Create a local .gitignoreï¼ˆåˆ›å»ºå±€éƒ¨/æœ¬åœ°çš„.gitignoreæ–‡ä»¶ï¼‰ å¦‚æœåœ¨local repositoryï¼ˆä»“åº“ï¼‰ä¸­åˆ›å»ºä¸€ä¸ªåä¸º.gitignoreçš„æ–‡ä»¶ï¼Œåœ¨ä½ commitï¼ˆæäº¤ï¼‰åŠ¨ä½œä¹‹å‰ï¼ŒGit å°†ä¼šè¯»å–*.gitignoreæ–‡ä»¶å»åˆ¤æ–­å“ªäº›æ–‡ä»¶æˆ–è€…ç›®å½•éœ€è¦å¿½ç•¥æ‰. åŒæ—¶è¿™ä¸ªæ–‡ä»¶åº”è¯¥pushåˆ°remote repository, è¿™æ ·cloneè¯¥repositoryçš„ç”¨æˆ·éƒ½ä¼šå…±äº«ignoreçš„è§„åˆ™. å½“ç„¶GitHubä¸Šç»´æŠ¤äº†ä¸€ä¸ªå®˜æ–¹çš„ã€é’ˆå¯¹è®¸å¤šæµè¡Œçš„æ“ä½œç³»ç»Ÿã€ç¯å¢ƒã€è¯­è¨€çš„.gitignore æ–‡ä»¶æ ·ä¾‹ åœ¨ç»ˆç«¯ï¼Œå®šä½åˆ°Git repositoryæ‰€åœ¨ä½ç½®ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»º.gitignoreæ–‡ä»¶ï¼ˆå½“ç„¶åœ¨windowsç¯å¢ƒå¯ä»¥ç›´æ¥åœ¨ä»“åº“ä½ç½®é¼ æ ‡å³é”®åˆ›å»ºåä¸º.gitignoreçš„æ–‡ä»¶å³å¯ï¼‰ touch .gitignoreæ³¨æ„ï¼šå¦‚æœæŸä¸ªæ–‡ä»¶å·²ç»è¢«æäº¤ï¼Œæ­¤æ—¶ä½ æƒ³è®©git å¿½ç•¥å®ƒï¼Œè¿™æ˜¯ä½ æŠŠè¿™ä¸ªæ–‡ä»¶æ·»åŠ åˆ°.gitignoreæ–‡ä»¶ä¸­ï¼Œgitä¹Ÿä¸ä¼šå¿½ç•¥å®ƒï¼Œæ­¤æ—¶æˆ‘ä»¬å¿…é¡»å…ˆuntrackè¿™ä¸ªæ–‡ä»¶ï¼Œè¿™æ ·Gitæ‰ä¼šå¿½ç•¥è¿™ä¸ªæ–‡ä»¶ git rm --cached FILENAMECreate a global .gitignoreï¼ˆåˆ›å»ºå…¨å±€.gitignoreæ–‡ä»¶ï¼‰ é€šå¸¸æˆ‘ä»¬ä¼šæœ‰å¤šä¸ªrepositoryï¼Œå¦‚æœå¤šä¸ªä»“åº“éœ€è¦çš„è§„åˆ™ç±»ä¼¼ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸ºæ¯ä¸€ä¸ªrepositoryéƒ½æ–°å»ºä¸€ä¸ª.gitignore æ–‡ä»¶å—ï¼Ÿæ˜¾ç„¶æˆ‘ä»¬æ­¤åˆ»éœ€è¦ä¸€ä¸ªå…¨å±€çš„æ–¹å¼æ¥ç®¡æ§æ‰€æœ‰çš„repository. æœ‰ä¸¤ç§æ–¹å¼æ¥åˆ›å»ºè¯¥å…¨å±€æ–‡ä»¶ï¼š å½“å®‰è£…äº†Gitä¹‹åï¼Œåœ¨git ä¸»ç›®å½•(Windowsç¯å¢ƒC:\\Users\\Fraser)ä¸‹ä¼šæœ‰ä¸€ä¸ª.gitconfigæ–‡ä»¶ï¼Œé‡Œé¢æŒ‡å®šäº†å¦‚ä¸‹å†…å®¹ï¼š [user] [core] excludesfile = D:\\\\Users\\\\fraser\\\\Documents\\\\gitignore_global.txt [user] [user] name = XXXXX email = XXXXX@qq.comä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æŠŠè§„åˆ™å®šä¹‰åœ¨gitignore_global.txtæ–‡ä»¶ä¸­å°±å¥½. æˆ–è€…æŒ‡å®šå…¶ä»–æ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶æ˜¯windowsè‡ªåŠ¨ç”Ÿæˆçš„ é€šè¿‡å‘½ä»¤æŒ‡å®š.gitignore_globalçš„æ–‡ä»¶ git config --global core.excludesfile ~/.gitignore_globalé€šå¸¸.gitignore_globalæ–‡ä»¶ä¹Ÿæ˜¯æ”¾åœ¨ä¸»ç›®å½•ä¸‹. Explicit repository excludes(æ˜ç¡®ä»“åº“å¿½ç•¥çš„æ–‡ä»¶) å¦‚æœä½ ä¸æƒ³åˆ›å»ºä¸€ä¸ª.gitignoreæ–‡ä»¶å¹¶ä¸”shareç»™å…¶ä»–äººï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸éœ€è¦æäº¤åˆ°repositoryçš„è§„åˆ™ï¼Œæ¯”å¦‚æˆ‘ä½¿ç”¨IntelliJ IDEAç¼–è¾‘å™¨ï¼Œç¼–è¾‘å™¨ä¼šç”Ÿæˆä¸€äº›ç›¸åº”æ–‡ä»¶ï¼Œä½†æ˜¯åŒäº‹ä½¿ç”¨Eclipseï¼Œä¹Ÿå°±æ˜¯è¯´IntelliJ IDEAç¼–è¾‘å™¨ç”Ÿæˆçš„æ–‡ä»¶è§„åˆ™å¹¶ä¸é€‚ç”¨Eclipseï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨å¦å¤–æ–¹æ³•æ¥å¤„ç†è¿™ç§æƒ…å†µ. ç”¨ç¼–è¾‘å™¨æ‰“å¼€.git/info/excludeï¼Œå°†è§„åˆ™åŠ è½½è¿™é‡Œå³å¯,è¿™ä¸ªgitæ˜¯ä¸ä¼šæäº¤çš„. Ignore è§„åˆ™è¯´æ˜gitignore - Specifies intentionally untracked files to ignore æè¿°ä¸Šé¢æˆ‘ä»¬è¯´åˆ°äº†æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¤šç§æ–¹å¼æ¥è®©git ignoreæ–‡ä»¶ï¼ŒåŒæ—¶é…ç½®äº†è¿™äº›æ–‡ä»¶ï¼Œä¼˜å…ˆçº§æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ Level1å‘½ä»¤è¡Œæ‰§è¡Œçš„å‘½ä»¤(å¾ˆå°‘ç”¨) Level2ä»“åº“ä¸­çš„.gitignore æ–‡ä»¶ Level3$GIT_DIR/info/exclude Level4å…¨å±€çš„é…ç½®ï¼šcore.excludesFile PATTERN FORMATè§„åˆ™è¯´æ˜ ç©ºè¡Œï¼Œæ²¡æœ‰ä»»ä½•å®é™…ignoreæ„ä¹‰ï¼Œåªæ˜¯ä½œä¸ºå¯è¯»æ€§çš„åˆ†éš”ç¬¦ â€œ#â€å·å¼€å¤´ä»£è¡¨è¯¥è¡Œæ˜¯æ³¨é‡Šï¼Œå¦‚æœåœ¨å‰é¢åŠ ä¸Šâ€œ\\â€ï¼Œåˆ™è½¬ä¹‰æˆä»¥â€œ#â€å¼€å¤´ â€œ!â€ æ˜¯é‡æ–°è®©git check in æŸæ–‡ä»¶çš„æ„æ€ï¼Œä½†æ˜¯è¯¥æ–‡ä»¶çš„çˆ¶ç›®å½•è¢«excludeï¼Œre-include è¯¥æ–‡ä»¶Gitæ˜¯åšä¸åˆ°çš„. åŒæ ·å¯ä»¥åŠ ä¸Šâ€&quot;æ¥è½¬ä¹‰ï¼Œ!important!.txtå’Œ!important!.txt ä»¥â€œ/â€ç»“æŸï¼Œå¦‚foo/ ä¼šåŒ¹é…fooä»¥åŠfooä¸‹é¢çš„å­æ–‡ä»¶å¤¹ï¼Œä½†æ˜¯ä¸ä¼šåŒ¹é…foo/ä¸‹é¢çš„ä»»ä½•æ–‡ä»¶. * æ˜¯é€šé…ç¬¦ï¼Œå¦‚*.cï¼Œä¼šåŒ¹é…æ‰€æœ‰.cä¸ºåç¼€çš„æ–‡ä»¶ ** çš„å«ä¹‰éå¸¸å¤šï¼š A leading â€œ**â€ followed by a slash means match in all directories. For example, â€œ/fooâ€ matches file or directory â€œfooâ€ anywhere, the same as pattern â€œfooâ€. â€œ/foo/barâ€ matches file or directory â€œbarâ€ anywhere that is directly under directory â€œfooâ€. A trailing â€œ/**â€ matches everything inside. For example, â€œabc/**â€ matches all files inside directory â€œabcâ€, relative to the location of the .gitignore file, with infinite depth. A slash followed by two consecutive asterisks then a slash matches zero or more directories. For example, â€œa/**/bâ€ matches â€œa/bâ€, â€œa/x/bâ€, â€œa/x/y/bâ€ and so on.","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"DevOps","slug":"Coding/DevOps","permalink":"https://dayarch.top/categories/Coding/DevOps/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://dayarch.top/tags/Git/"}]},{"title":"Windowsä¸‹åˆ é™¤è¿‡é•¿æ–‡ä»¶è·¯å¾„æˆ–è¿‡é•¿æ–‡ä»¶åçš„æ–‡ä»¶","slug":"Windowsä¸‹åˆ é™¤è¿‡é•¿æ–‡ä»¶è·¯å¾„æˆ–è¿‡é•¿æ–‡ä»¶åçš„æ–‡ä»¶","date":"2016-09-05T07:28:25.000Z","updated":"2019-11-01T08:58:12.351Z","comments":true,"path":"/p/delete-long-name-file-in-windows.html","link":"","permalink":"https://dayarch.top/p/delete-long-name-file-in-windows.html","excerpt":"åœ¨Windowsä¸‹ï¼Œåˆ é™¤æ–‡ä»¶æ—¶æŠ¥é”™â€æ–‡ä»¶è·¯å¾„å¤ªé•¿æˆ–è€…æ–‡ä»¶åå¤ªé•¿â€ï¼Œæ— è®ºæ˜¯Shift+Delã€è¿›å…¥å­ç›®å½•ä¸€ç‚¹ç‚¹åˆ é™¤éƒ½ä¸å¯ä»¥ä»¥åŠä½¿ç”¨Windowså†…ç½®å‘½ä»¤éƒ½ä¸å¯ä»¥ï¼Œä½†æ˜¯æˆ‘ç”µè„‘ä¸­è£…æœ‰nodeï¼Œäºæ˜¯å®‰è£…ã€rimrafã€‘â€”â€”æ˜¯ä¸“é—¨ç”¨äºåˆ é™¤æ¨¡å—çš„æ’ä»¶ å®˜æ–¹æè¿°ï¼šA deep deletion module for node (like rm -rf) npm install -g rimraf ä½¿ç”¨æ–¹æ³•ï¼š 1. è¿›å…¥projectç›®å½• cd project/ 2. åˆ é™¤hybrisç›®å½•åŠç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ rimraf hybris","text":"åœ¨Windowsä¸‹ï¼Œåˆ é™¤æ–‡ä»¶æ—¶æŠ¥é”™â€æ–‡ä»¶è·¯å¾„å¤ªé•¿æˆ–è€…æ–‡ä»¶åå¤ªé•¿â€ï¼Œæ— è®ºæ˜¯Shift+Delã€è¿›å…¥å­ç›®å½•ä¸€ç‚¹ç‚¹åˆ é™¤éƒ½ä¸å¯ä»¥ä»¥åŠä½¿ç”¨Windowså†…ç½®å‘½ä»¤éƒ½ä¸å¯ä»¥ï¼Œä½†æ˜¯æˆ‘ç”µè„‘ä¸­è£…æœ‰nodeï¼Œäºæ˜¯å®‰è£…ã€rimrafã€‘â€”â€”æ˜¯ä¸“é—¨ç”¨äºåˆ é™¤æ¨¡å—çš„æ’ä»¶ å®˜æ–¹æè¿°ï¼šA deep deletion module for node (like rm -rf) npm install -g rimrafä½¿ç”¨æ–¹æ³•ï¼š è¿›å…¥projectç›®å½• cd project/ åˆ é™¤hybrisç›®å½•åŠç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ rimraf hybris å¯ä»¥çœ‹åˆ°ï¼Œhybrisç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•åŠæ–‡ä»¶å…¨éƒ¨åˆ é™¤å¹²å‡€ï¼Œéå¸¸çˆ½ã€‚ æ„Ÿè°¢åŸä½œè€…çš„åˆ†äº«","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Others","slug":"Coding/Others","permalink":"https://dayarch.top/categories/Coding/Others/"}],"tags":[{"name":"Windows","slug":"Windows","permalink":"https://dayarch.top/tags/Windows/"},{"name":"Node","slug":"Node","permalink":"https://dayarch.top/tags/Node/"}]},{"title":"Gité…ç½®å¤šä¸ªè´¦å·ï¼ˆGitLabå’ŒGitHubï¼‰","slug":"Gité…ç½®å¤šä¸ªè´¦å·ï¼ˆGitLabå’ŒGitHubï¼‰","date":"2016-08-09T02:29:32.000Z","updated":"2019-11-07T05:27:32.582Z","comments":true,"path":"/p/git-multiple-account.html","link":"","permalink":"https://dayarch.top/p/git-multiple-account.html","excerpt":"èƒŒæ™¯ ç°åœ¨å¥½å¤šå…¬å¸ç”¨GitLabä½œä¸ºé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œè‡ªå·±ä¹Ÿä¼šæœ‰å¼€æºé¡¹ç›®åœ¨GitHubä¸Šï¼ŒæŒ‰ç…§ä»¥å¾€çš„é…ç½®å…¨å±€çš„ç”¨æˆ·è²Œä¼¼åœ¨è¿™ç§æƒ…å½¢ä¸‹å°±æ²¡æœ‰ä½œç”¨äº†ï¼ˆå…¬å¸çš„é¡¹ç›®éœ€è¦ç”¨å…¬å¸é‚®ç®±ï¼Œè‡ªå·±çš„é¡¹ç›®éœ€è¦ç”¨è‡ªå·±çš„é‚®ç®±ï¼‰ï¼Œæ­¤æ—¶å°±è¦åšGitå¤šè´¦æˆ·çš„ç®¡ç†ä¸è®¾ç½®ã€‚ Gitæ”¯æŒçš„åè®® Gitä¸»è¦æ”¯æŒå››ä¸­åè®®ï¼š file:// , git://, http(s)://, ssh://, è¿™é‡Œä¸»è¦è¯´æ˜ä¸€ä¸‹http(s)å’Œsshåè®®çš„åŒºåˆ«ã€‚ https å’Œ SSH çš„åŒºåˆ« 1. å‰è€…å¯ä»¥éšæ„å…‹éš†githubä¸Šçš„é¡¹ç›®ï¼Œè€Œä¸ç®¡æ˜¯è°çš„ï¼›è€Œåè€…åˆ™æ˜¯ä½ å¿…é¡»æ˜¯ä½ è¦å…‹éš†çš„é¡¹ç›®çš„æ‹¥æœ‰è€…æˆ–ç®¡ç†å‘˜ï¼Œä¸”éœ€è¦å…ˆæ·»åŠ  SSH key (è¿™é‡Œå°±æ˜¯æ·»åŠ å…¬é’¥","text":"èƒŒæ™¯ç°åœ¨å¥½å¤šå…¬å¸ç”¨GitLabä½œä¸ºé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œè‡ªå·±ä¹Ÿä¼šæœ‰å¼€æºé¡¹ç›®åœ¨GitHubä¸Šï¼ŒæŒ‰ç…§ä»¥å¾€çš„é…ç½®å…¨å±€çš„ç”¨æˆ·è²Œä¼¼åœ¨è¿™ç§æƒ…å½¢ä¸‹å°±æ²¡æœ‰ä½œç”¨äº†ï¼ˆå…¬å¸çš„é¡¹ç›®éœ€è¦ç”¨å…¬å¸é‚®ç®±ï¼Œè‡ªå·±çš„é¡¹ç›®éœ€è¦ç”¨è‡ªå·±çš„é‚®ç®±ï¼‰ï¼Œæ­¤æ—¶å°±è¦åšGitå¤šè´¦æˆ·çš„ç®¡ç†ä¸è®¾ç½®ã€‚ Gitæ”¯æŒçš„åè®®Gitä¸»è¦æ”¯æŒå››ä¸­åè®®ï¼š file:// , git://, http(s)://, ssh://, è¿™é‡Œä¸»è¦è¯´æ˜ä¸€ä¸‹http(s)å’Œsshåè®®çš„åŒºåˆ«ã€‚ https å’Œ SSH çš„åŒºåˆ« å‰è€…å¯ä»¥éšæ„å…‹éš†githubä¸Šçš„é¡¹ç›®ï¼Œè€Œä¸ç®¡æ˜¯è°çš„ï¼›è€Œåè€…åˆ™æ˜¯ä½ å¿…é¡»æ˜¯ä½ è¦å…‹éš†çš„é¡¹ç›®çš„æ‹¥æœ‰è€…æˆ–ç®¡ç†å‘˜ï¼Œä¸”éœ€è¦å…ˆæ·»åŠ  SSH key (è¿™é‡Œå°±æ˜¯æ·»åŠ å…¬é’¥ï¼Œå–å¾—ç®¡ç†å‘˜çš„ä¿¡ä»»)ï¼Œå¦åˆ™æ— æ³•å…‹éš†ã€‚ https url åœ¨pushçš„æ—¶å€™æ˜¯éœ€è¦éªŒè¯ç”¨æˆ·åå’Œå¯†ç çš„ï¼Œè€Œ SSH åœ¨pushçš„æ—¶å€™ï¼Œæ˜¯ä¸éœ€è¦è¾“å…¥ç”¨æˆ·åçš„ï¼Œå¦‚æœé…ç½®SSH keyçš„æ—¶å€™è®¾ç½®äº†å¯†ç ï¼Œåˆ™éœ€è¦è¾“å…¥å¯†ç çš„ï¼Œå¦åˆ™ç›´æ¥æ˜¯ä¸éœ€è¦è¾“å…¥å¯†ç çš„ã€‚ Gitè®¾ç½®å¤šè´¦æˆ·æ£€æŸ¥æœ¬æœºæ˜¯å¦å·²æœ‰SSH Key$ cd ~/.ssh $ lså¦‚æœå­˜åœ¨ä¼šæœ‰ä¸¤ä¸ªç§˜é’¥æ–‡ä»¶id_rsa(ç§é’¥)å’Œid_rsa.pub(å…¬é’¥)ï¼Œå¦‚æœæ²¡æœ‰åˆ™éœ€è¦ä¸‹ä¸€æ­¥çš„åˆ›å»ºã€‚ åˆ›å»ºSSH Keyè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š $ ssh-keygen -t rsa -C &quot;your_email@example.com&quot;å‚æ•°è§£æï¼š -t æŒ‡å®šå¯†é’¥ç±»å‹ï¼Œé»˜è®¤æ˜¯ rsa ï¼Œå¯ä»¥çœç•¥ã€‚ -C è®¾ç½®æ³¨é‡Šæ–‡å­—ï¼Œæ¯”å¦‚é‚®ç®±ã€‚ -f æŒ‡å®šå¯†é’¥æ–‡ä»¶å­˜å‚¨æ–‡ä»¶åã€‚ ä»¥ä¸Šä»£ç çœç•¥äº† -f å‚æ•°ï¼Œå› æ­¤ï¼Œè¿è¡Œä¸Šé¢é‚£æ¡å‘½ä»¤åä¼šè®©ä½ è¾“å…¥ä¸€ä¸ªæ–‡ä»¶åï¼Œç”¨äºä¿å­˜åˆšæ‰ç”Ÿæˆçš„ SSH key ä»£ç ï¼Œå¦‚ï¼š Generating public/private rsa key pair. # Enter file in which to save the key (/c/Users/you/.ssh/id_rsa): [Press enter]å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸è¾“å…¥æ–‡ä»¶åï¼Œç›´æ¥è½¦ï¼Œä½¿ç”¨é»˜è®¤æ–‡ä»¶åï¼ˆæ¨èï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šç”Ÿæˆ id_rsa å’Œ id_rsa.pub ä¸¤ä¸ªç§˜é’¥æ–‡ä»¶ã€‚ æ¥ç€åˆä¼šæç¤ºä½ è¾“å…¥ä¸¤æ¬¡å¯†ç ï¼ˆè¯¥å¯†ç æ˜¯ä½ pushæ–‡ä»¶çš„æ—¶å€™è¦è¾“å…¥çš„å¯†ç ï¼Œè€Œä¸æ˜¯githubç®¡ç†è€…çš„å¯†ç ï¼‰ï¼Œè¿™æ ·åˆ«äººç”¨ä½ çš„æœºå™¨æ²¡æœ‰å¯†ç æ˜¯ä¸å¯èƒ½éšä¾¿pushä»£ç çš„ï¼Œä¸€ç§å®‰å…¨æ€§çš„ä½“ç°ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸è¾“å…¥å¯†ç ï¼Œç›´æ¥æŒ‰å›è½¦ã€‚é‚£ä¹ˆpushçš„æ—¶å€™å°±ä¸éœ€è¦è¾“å…¥å¯†ç ï¼Œç›´æ¥æäº¤åˆ°githubä¸Šäº†ã€‚ Enter passphrase (empty for no passphrase): # Enter same passphrase again:åœ¨æ­¤æ¡ˆä¾‹ä¸­ï¼Œå°±éœ€è¦è¾“å…¥ä¸¤ä¸ªemailæ¥åˆ›å»ºä¸ªç›¸åº”çš„SSH Key: $ ssh-keygen -t rsa -C &quot;personal@example.com&quot; (ä¸ªäººé‚®ç®±) $ ssh-keygen -t rsa -C &quot;company@example.com&quot; (å…¬å¸é‚®ç®±)æ­¤æ—¶åœ¨.ssh ç›®å½•ä¸‹åº”è¯¥ä¼šæœ‰ä¸‹é¢å››ä¸ªæ–‡ä»¶ï¼š id_rsa id_rsa.pub id_rsa_company id_rsa_company.pubå°†å…¬é’¥id_rsa.pubå’Œid_rsa_company.pub åˆ†åˆ«æ·»åŠ åˆ°GitHubå’ŒGitLabä¸Šï¼Œæ€æ ·æ·»åŠ è¯·è‡ªè¡ŒæŸ¥è¯¢ï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼ˆå¯ä»¥æ›´å¤šï¼‰ï¼Œæ€æ ·æŒ‡å®šè¦è¿æ¥GitHubè¿˜æ˜¯GitLabå‘¢ï¼Ÿè¿™æ ·å°±éœ€è¦è§£å†³å¤šç”¨æˆ·çš„æƒé™é—®é¢˜ã€‚ å¤šç”¨æˆ·æƒé™é—®é¢˜GitHub/GitLabä½¿ç”¨SSHä¸å®¢æˆ·ç«¯è¿æ¥ã€‚å¦‚æœæ˜¯å•ç”¨æˆ·ï¼ˆAï¼‰ï¼Œç”Ÿæˆå¯†é’¥å¯¹åï¼Œå°†å…¬é’¥ä¿å­˜è‡³ GitHub/GitLabï¼Œæ¯æ¬¡è¿æ¥æ—¶SSHå®¢æˆ·ç«¯å‘é€æœ¬åœ°ç§é’¥ï¼ˆé»˜è®¤~/.ssh/id_rsaï¼‰åˆ°æœåŠ¡ç«¯éªŒè¯ã€‚å•ç”¨æˆ·æƒ…å†µä¸‹ï¼Œè¿æ¥çš„æœåŠ¡å™¨ä¸Šä¿å­˜çš„å…¬é’¥å’Œå‘é€çš„ç§é’¥è‡ªç„¶æ˜¯é…å¯¹çš„ã€‚ä½†æ˜¯å¦‚æœæ˜¯ å¤šç”¨æˆ· ï¼ˆA,Bï¼‰ï¼Œæˆ‘ä»¬åœ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªå¸å·æ—¶ï¼ŒBä¿å­˜çš„æ˜¯è‡ªå·±çš„å…¬é’¥ï¼Œä½†æ˜¯SSHå®¢æˆ·ç«¯ä¾ç„¶å‘é€é»˜è®¤ç§é’¥ï¼Œå³Açš„ç§é’¥ï¼Œé‚£ä¹ˆè¿™ä¸ªéªŒè¯è‡ªç„¶æ— æ³•é€šè¿‡, æ‰€ä»¥éœ€è¦è®©SSHå®¢æˆ·ç«¯å‘ç°Bçš„ç§é’¥ã€‚ æŸ¥çœ‹ç³»ç»ŸSSH Key $ ssh-add -lå¦‚æœæç¤ºï¼š $ Could not open a connection to your authentication agent.å¯ä»¥è¾“å…¥å¦‚ä¸‹å‘½ä»¤ç„¶åé‡æ–°è¾“å…¥ï¼šssh-add -l $ ssh-agent bash ssh-agent bashå‘½ä»¤è§£é‡Šï¼šssh-agentæ˜¯ä¸“ä¸ºæ—¢ä»¤äººæ„‰å¿«åˆå®‰å…¨çš„å¤„ç†RSAå’ŒDSAå¯†é’¥è€Œè®¾è®¡çš„ç‰¹æ®Šç¨‹åºï¼Œä¸åŒäºsshï¼Œssh-agentæ˜¯ä¸ªé•¿æ—¶é—´æŒç»­è¿è¡Œçš„å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰ï¼Œè®¾è®¡å®ƒçš„å”¯ä¸€ç›®çš„å°±æ˜¯å¯¹è§£å¯†çš„ä¸“ç”¨å¯†é’¥è¿›è¡Œé«˜é€Ÿç¼“å­˜ã€‚sshåŒ…å«çš„å†…å»ºæ”¯æŒå…è®¸å®ƒåŒssh-agenté€šä¿¡ï¼Œå…è®¸sshä¸å¿…æ¯æ¬¡æ–°è¿æ¥æ—¶éƒ½æç¤ºæ‚¨è¦å¯†ç æ‰èƒ½è·å–è§£å¯†çš„ä¸“ç”¨å¯†é’¥ã€‚å¯¹äºssh-agentï¼Œæ‚¨åªè¦ä½¿ç”¨ssh-addæŠŠä¸“ç”¨å¯†é’¥æ·»åŠ åˆ°ssh-agentçš„é«˜é€Ÿç¼“å­˜ä¸­ã€‚è¿™æ˜¯ä¸ªä¸€æ¬¡æ€§è¿‡ç¨‹ï¼›ç”¨è¿‡ssh-addä¹‹åï¼Œsshå°†ä»ssh-agentè·å–æ‚¨çš„ä¸“ç”¨å¯†é’¥ï¼Œè€Œä¸ä¼šæç¤ºè¦å¯†ç çŸ­è¯­æ¥çƒ¦æ‚¨äº†ã€‚å¦‚æœå‡ºç°å¦‚ä¸‹æç¤ºä¿¡æ¯è¯´æ˜æ²¡æœ‰SSH Keyåœ¨ä»£ç†ä¸­ $ The agent has no identities.ä¸‹é¢å¯ä»¥æ‰‹åŠ¨åŠ å…¥SSH Key åˆ°ä»£ç†ä¸­ï¼š $ ssh-add ~/.ssh/id_rsa_companyå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤remove SSH Key $ ssh-add -D é…ç½®config è·¯ç”±æ–‡ä»¶configæ–‡ä»¶å³ç»‘å®šç§é’¥å’Œè¿œç¨‹æœåŠ¡å™¨çš„å…³ç³»ï¼Œä»¥æˆ‘çš„configæ–‡ä»¶ä¸ºä¾‹ï¼š # è¯¥æ–‡ä»¶ç”¨äºé…ç½®ç§é’¥å¯¹åº”çš„æœåŠ¡å™¨ # é»˜è®¤è‡ªå·±GitHubçš„é…ç½® Host github HostName github.com User FraserYu PreferredAuthentications publickey IdentityFile ~/.ssh/id_rsa # å…¬å¸æ‰€ç”¨GitLabçš„é…ç½® Host gitlab HostName gitlab.com #(å¯ä»¥æ˜¯åŸŸå/IPåœ°å€) User Fraser PreferredAuthentications publickey IdentityFile ~/.ssh/id_rsa_company æµ‹è¯•è¾“å…¥å¦‚ä¸‹å‘½ä»¤è¿›è¡ŒGitLabå’ŒGitHubçš„æµ‹è¯•(æ³¨æ„å‘½ä»¤ä¸­ç”¨äº†Hostçš„åˆ«å)ï¼š $ ssh -T git@github $ ssh -T git@gitlab $ git clone git@github:username/project.git ç”¨æˆ·åé‚®ç®±é…ç½®Gitå…¨å±€é…ç½®å’Œå•ä¸ªä»“åº“çš„ç”¨æˆ·åé‚®ç®±é…ç½®ï¼Œå­¦ä¹ gitçš„æ—¶å€™, å¤§å®¶åˆšå¼€å§‹ä½¿ç”¨ä¹‹å‰éƒ½é…ç½®äº†ä¸€ä¸ªå…¨å±€çš„ç”¨æˆ·åå’Œé‚®ç®± $ git config --global user.name &quot;github&apos;s Name&quot; $ git config --global user.email &quot;github@xx.com&quot; $ git config --listå¦‚æœä½ å…¬å¸çš„é¡¹ç›®æ˜¯æ”¾åœ¨è‡ªå»ºçš„gitlabä¸Šé¢, å¦‚æœä½ ä¸è¿›è¡Œé…ç½®ç”¨æˆ·åå’Œé‚®ç®±çš„è¯, åˆ™ä¼šä½¿ç”¨å…¨å±€çš„, è¿™ä¸ªæ—¶å€™æ˜¯é”™è¯¯çš„, æ­£ç¡®çš„åšæ³•æ˜¯é’ˆå¯¹å…¬å¸çš„é¡¹ç›®, åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿›è¡Œå•ç‹¬é…ç½® $ git config user.name &quot;gitlab&apos;s Name&quot; $ git config user.email &quot;gitlab@xx.com&quot; $ git config --listgit config â€“listæŸ¥çœ‹å½“å‰é…ç½®, åœ¨å½“å‰é¡¹ç›®ä¸‹é¢æŸ¥çœ‹çš„é…ç½®æ˜¯å…¨å±€é…ç½®+å½“å‰é¡¹ç›®çš„é…ç½®, ä½¿ç”¨çš„æ—¶å€™ä¼šä¼˜å…ˆä½¿ç”¨å½“å‰é¡¹ç›®çš„é…ç½® é™¤äº†é»˜è®¤çš„id_rsaæ˜¯è¢«gité»˜è®¤è¯»å–ï¼Œæˆ‘ä»¬æ¯æ¬¡æ‰“å¼€ç»ˆç«¯éƒ½éœ€è¦æ‰§è¡Œ ssh-add ï½/.ssh/id_rsa_companyï¼Œ è¿™æ ·ååˆ†éº»çƒ¦ï¼Œä»¥MacOsä¸ºğŸŒ°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ·»åŠ åˆ° KeyChain Accessï¼Œ æ‰§è¡Œå‘½ä»¤ ssh-add -K [path/to/your/ssh-key]ï¼Œ å¦‚ï¼šssh-add -K ï½/.ssh/id_rsa_company å³å¯","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"DevOps","slug":"Coding/DevOps","permalink":"https://dayarch.top/categories/Coding/DevOps/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://dayarch.top/tags/Git/"}]},{"title":"Chromeä¿å­˜ç½‘é¡µä¸ºè„±æœºæ–‡ä»¶","slug":"Chromeä¿å­˜ç½‘é¡µä¸ºè„±æœºæ–‡ä»¶","date":"2016-08-08T11:23:15.000Z","updated":"2019-11-01T08:36:23.784Z","comments":true,"path":"/p/chrome-save-offline-file.html","link":"","permalink":"https://dayarch.top/p/chrome-save-offline-file.html","excerpt":"Chrome æµè§ˆå™¨ä¿å­˜ç½‘é¡µä¸ºè„±æœºæ–‡ä»¶ æˆ‘ä»¬ç»å¸¸éœ€è¦å°†ä¸€äº›ç½‘é¡µä¿å­˜ä¸ºè„±æœºæ–‡ä»¶ï¼Œè¿™æ ·å³ä¾¿æ²¡æœ‰ç½‘ç»œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ­£å¸¸çš„æµè§ˆï¼ŒIEæµè§ˆå™¨å°†ç½‘é¡µå¦å­˜ä¸ºåœ¨é€‰æ‹©æ–‡ä»¶ç±»å‹çš„åœ°æ–¹ä¼šæœ‰é€‰æ‹©*.mht, å¯æ˜¯Chrome å´æ²¡æœ‰è¿™ä¸ªé€‰é¡¹ï¼Œæ¥ä¸‹æ¥æ•™å¤§å®¶å¦‚ä½•é€šè¿‡Chromeæ¥ä¿å­˜ç½‘é¡µä¸ºmhtæ–‡ä»¶ 1. æ‰“å¼€æµè§ˆå™¨è¾“å…¥ chrome://flags/ 2. é€šè¿‡å…³é”®å­—æœç´¢save æˆ– å¦å­˜ä¸ºå¦‚ä¸‹å›¾ï¼š 3. ç‚¹å‡»Enableæˆ–ä½¿ç”¨ï¼Œé‡æ–°å¯åŠ¨æµè§ˆå™¨ 4. é¼ æ ‡å³é”®å¦å­˜ä¸ºé€‰æ‹©ç±»å‹å’Œä¿å­˜è·¯å¾„å¦‚ä¸‹å›¾ï¼š 5. ç­‰å¾…ä¸‹è½½å®Œæˆå³","text":"Chrome æµè§ˆå™¨ä¿å­˜ç½‘é¡µä¸ºè„±æœºæ–‡ä»¶æˆ‘ä»¬ç»å¸¸éœ€è¦å°†ä¸€äº›ç½‘é¡µä¿å­˜ä¸ºè„±æœºæ–‡ä»¶ï¼Œè¿™æ ·å³ä¾¿æ²¡æœ‰ç½‘ç»œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ­£å¸¸çš„æµè§ˆï¼ŒIEæµè§ˆå™¨å°†ç½‘é¡µå¦å­˜ä¸ºåœ¨é€‰æ‹©æ–‡ä»¶ç±»å‹çš„åœ°æ–¹ä¼šæœ‰é€‰æ‹©*.mht, å¯æ˜¯Chrome å´æ²¡æœ‰è¿™ä¸ªé€‰é¡¹ï¼Œæ¥ä¸‹æ¥æ•™å¤§å®¶å¦‚ä½•é€šè¿‡Chromeæ¥ä¿å­˜ç½‘é¡µä¸ºmhtæ–‡ä»¶ æ‰“å¼€æµè§ˆå™¨è¾“å…¥ chrome://flags/ é€šè¿‡å…³é”®å­—æœç´¢save æˆ– å¦å­˜ä¸ºå¦‚ä¸‹å›¾ï¼š ç‚¹å‡»Enableæˆ–ä½¿ç”¨ï¼Œé‡æ–°å¯åŠ¨æµè§ˆå™¨ é¼ æ ‡å³é”®å¦å­˜ä¸ºé€‰æ‹©ç±»å‹å’Œä¿å­˜è·¯å¾„å¦‚ä¸‹å›¾ï¼š ç­‰å¾…ä¸‹è½½å®Œæˆå³å¯","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Others","slug":"Coding/Others","permalink":"https://dayarch.top/categories/Coding/Others/"}],"tags":[{"name":"Chrome","slug":"Chrome","permalink":"https://dayarch.top/tags/Chrome/"}]},{"title":"git ä½¿ç”¨æµç¨‹","slug":"git-ä½¿ç”¨æµç¨‹","date":"2016-06-24T01:44:01.000Z","updated":"2019-11-07T06:36:00.509Z","comments":true,"path":"/p/git-workflow.html","link":"","permalink":"https://dayarch.top/p/git-workflow.html","excerpt":"Gitåˆ†æ”¯ç®¡ç†ç­–ç•¥ é¦–å…ˆshareä¸€ä¸‹Ruanè€å¸ˆçš„åšå®¢å†…å®¹ï¼šGitåˆ†æ”¯ç®¡ç†ç­–ç•¥ ï¼Œè¯»è¿‡ä¹‹åï¼Œç†è§£Masterã€Developã€ä¸´æ—¶åˆ†æ”¯ï¼ˆfeatureã€releaseã€fixbugï¼‰çš„åŸºæœ¬æ„æ€ï¼Œè¿™é‡Œå†™çš„å°±æ›´åŠ é€å½»äº†ï¼šA successful Git branching modelï¼Œ é¡¹ç›®ä¸­å¦‚æœæŒ‰ç…§è¿™ç§ä¸¥æ ¼è§„èŒƒæ¥æ‰§è¡Œç‰ˆæœ¬çš„ç®¡ç†ï¼Œåº”è¯¥æ˜¯ä¼šå–å¾—æˆåŠŸçš„ç»“æœ. ä»”ç»†é˜…è¯»è¿™ä¸ªworkflowæ·±åˆ»çš„ä½“ä¼šï¼š Git ä½¿ç”¨å®æˆ˜æƒ…æ™¯è¯´æ˜ ä¸ºä»€ä¹ˆä¸ç½—åˆ—å‡ºæ¥Gitçš„å‘½ä»¤åˆ—è¡¨ï¼Œå› ä¸ºç½—åˆ—åœ¨è¿™è²Œä¼¼ä¹Ÿå¾ˆéš¾æ·±åˆ»ç†è§£å‘½ä»¤çš„å«ä¹‰ï¼Œä¹Ÿä¸çŸ¥é“æ€æ ·å»ä½¿ç”¨ï¼Œæ‰€ä»¥åšä¸€äº›æƒ…æ™¯æ¡ˆä¾‹æ¥è¯´æ˜gitå‘½ä»¤ è·Ÿè¸ªGitHubä¸Šå¼€æºé¡¹ç›® å½“åœ¨Git","text":"Gitåˆ†æ”¯ç®¡ç†ç­–ç•¥é¦–å…ˆshareä¸€ä¸‹Ruanè€å¸ˆçš„åšå®¢å†…å®¹ï¼šGitåˆ†æ”¯ç®¡ç†ç­–ç•¥ ï¼Œè¯»è¿‡ä¹‹åï¼Œç†è§£Masterã€Developã€ä¸´æ—¶åˆ†æ”¯ï¼ˆfeatureã€releaseã€fixbugï¼‰çš„åŸºæœ¬æ„æ€ï¼Œè¿™é‡Œå†™çš„å°±æ›´åŠ é€å½»äº†ï¼šA successful Git branching modelï¼Œ é¡¹ç›®ä¸­å¦‚æœæŒ‰ç…§è¿™ç§ä¸¥æ ¼è§„èŒƒæ¥æ‰§è¡Œç‰ˆæœ¬çš„ç®¡ç†ï¼Œåº”è¯¥æ˜¯ä¼šå–å¾—æˆåŠŸçš„ç»“æœ. ä»”ç»†é˜…è¯»è¿™ä¸ªworkflowæ·±åˆ»çš„ä½“ä¼šï¼š Git ä½¿ç”¨å®æˆ˜æƒ…æ™¯è¯´æ˜ä¸ºä»€ä¹ˆä¸ç½—åˆ—å‡ºæ¥Gitçš„å‘½ä»¤åˆ—è¡¨ï¼Œå› ä¸ºç½—åˆ—åœ¨è¿™è²Œä¼¼ä¹Ÿå¾ˆéš¾æ·±åˆ»ç†è§£å‘½ä»¤çš„å«ä¹‰ï¼Œä¹Ÿä¸çŸ¥é“æ€æ ·å»ä½¿ç”¨ï¼Œæ‰€ä»¥åšä¸€äº›æƒ…æ™¯æ¡ˆä¾‹æ¥è¯´æ˜gitå‘½ä»¤ è·Ÿè¸ªGitHubä¸Šå¼€æºé¡¹ç›®å½“åœ¨Githubä¸­é¨æ¸¸ä¸€é˜µï¼Œå‘ç°äº†å–œæ¬¢çš„é¡¹ç›®æƒ³åœ¨æœ¬åœ°ç ”ç©¶ï¼ŒåŒæ—¶è¿˜æƒ³è·Ÿè¸ªäº†è§£æºé¡¹ç›®çš„æœ€æ–°åŠ¨æ€ï¼Œæˆ‘ä»¬éœ€è¦å¦‚ä¸‹çš„ä¸€äº›æ­¥éª¤ï¼š Fork (åˆ†å‰)åœ¨è·Ÿè¸ªçš„å¼€æºé¡¹ç›®ä¸Šç‚¹å‡»Forkï¼Œä¼šå‘ç°åˆ†å‰åˆ°ä½ çš„Repoä¸­ï¼Œæ­¤æ—¶æˆ‘ä»¬åº”ç”¨å¦‚ä¸‹å‘½ä»¤å°†é¡¹ç›®cloneåˆ°local Repo, httpsæˆ–sshä¸¤ç§éƒ½å¯ä»¥ $ git clone git@github.com:YOUR-USERNAME/REPO-NAME $ git clone https://github.com/YOUR-USERNAME/REPO-NAMEæ­¤æ—¶å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹remoteçš„ç‰ˆæœ¬ï¼Œå³ä½ è‡ªå·±çš„remote Repoçš„ä¿¡æ¯ $ git remote -vå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š https://github.com/YOUR_USERNAME/YOUR_FORK.git (fetch) https://github.com/YOUR_USERNAME/YOUR_FORK.git (push) æ·»åŠ  fork æºä»“åº“çš„åœ°å€æˆ‘ä»¬çš„ç›®çš„ä¸ä½†æ˜¯è¦åœ¨æœ¬åœ°ä¿®æ”¹è‡ªå·±æƒ³è¦çš„ä»£ç ï¼Œè¿˜è¦äº†è§£æœ€æ–°çš„æºçš„åŠ¨æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š $ git remote add originProject https://github.com/ORIGINAL_OWNER/ORIGINAL_REPO.gitåŒæ ·åº”ç”¨ git remote -vå‘½ä»¤ä¼šçš„åˆ°å¦‚ä¸‹ç»“æœï¼š origin https://github.com/YOUR_USERNAME/YOUR_FORK.git (fetch) origin https://github.com/YOUR_USERNAME/YOUR_FORK.git (push) originProject https://github.com/ORIGINAL_OWNER/ORIGINAL_REPO.git(fetch) originProject https://github.com/ORIGINAL_OWNER/ORIGINAL_REPO.git (push)æ­¤å¤„çš„originProject å¯ä»¥æ˜¯ä½ å–å¾—ä»»æ„çš„åå­—, å°±æ˜¯ç»™è¿œç¨‹ä¸»æœºå–ä¸ªåå­— $ git remote add &lt;ä¸»æœºå&gt; &lt;ç½‘å€&gt; Fetchæºå½“ä½ è¦è·Ÿè¸ªæºåŠ¨æ€ï¼Œå°±è¦fetchä¸€ä»½åˆ°æœ¬åœ°Repo $ git fetch originProjecté€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹åˆ†æ”¯ï¼š $ git branch åˆå¹¶æºåˆ°æœ¬åœ°é¦–å…ˆåˆ‡æ¢åˆ°æœ¬åœ°masteråˆ†æ”¯ $ git checkout masterä¹‹åmergeæºåˆ°æœ¬åœ°master $ git merge originProject/masterè¿™ä¸ªåœ°æ–¹å¯èƒ½ä¼šæœ‰å†²çªï¼Œéœ€è¦è§£å†³å†²çªå®Œæˆmergeï¼Œæœ€åå°†mergeå¥½çš„ä»£ç pushåˆ°è‡ªå·±remote git push origin master æœ¬åœ°ä¸Šä¼ ä»£ç åˆ°GitHubé€šå¸¸ä¼šåœ¨æœ¬åœ°å†™ç‚¹ç¨‹åºï¼Œç„¶åæ”¾åˆ°githubæ¥ç®¡ç†ï¼Œæ­¤æ—¶æˆ‘ä»¬æ€æ ·æŠŠæœ¬åœ°çš„ä»£ç ä¸Šä¼ åˆ°githubå‘¢ gitåˆå§‹åŒ–æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆå§‹åŒ– $ git initä½ çš„é¡¹ç›®codeåº”è¯¥åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ æ·»åŠ é¡¹ç›®æ–‡ä»¶åˆ°æœ¬åœ°Repoæˆ‘ä»¬éœ€è¦å°†æœ¬åœ°çš„codeæ·»åŠ åˆ°æœ¬åœ°çš„Repoä¸­ï¼Œadd . ä»£è¡¨æ·»åŠ å…¨éƒ¨æ–‡ä»¶ $ git add . æäº¤æ–‡ä»¶åˆ°æœ¬åœ°Repoæ·»åŠ æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦commitæ–‡ä»¶åˆ°æœ¬åœ°Repoï¼Œå¹¶ä¸”æ ‡è®°æ³¨é‡Š $ git commit -m &quot;æ³¨é‡Šè¯­å¥&quot; åœ¨githubä¸Šæ–°å»ºRepoåœ¨githubä¸Šæ–°å»ºRepoï¼Œå¹¶ä¸”copy Repoçš„httpsæˆ–ssh URL $ git remote add origin https://github.com/YOUR_USERNAME/YOUR_FORK.git Pullè¿œç¨‹ä»£ç åœ¨pushä¹‹å‰æˆ‘ä»¬éœ€è¦pull remote ä»£ç  $ git pull origin master Pushæœ¬åœ°ä»£ç åˆ°remoteæˆ‘ä»¬å·²ç»æäº¤ä»£ç åˆ°æœ¬åœ°Repoï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦pushåˆ°remote $ git push -u origin master æ›´æ”¹è¿œç¨‹URLåœ¨å®é™…åœºæ™¯ä¸­æˆ‘ä»¬ä¼šé‡åˆ°GitæœåŠ¡å™¨è¿ç§»äº†ï¼Œè¿™æ ·æˆ‘ä»¬.gitä»“åº“å­˜å‚¨çš„remote repositoryçš„åœ°å€ä¿¡æ¯å°±æ˜¯é”™è¯¯çš„ï¼Œæ‰€ä»¥éœ€è¦æ›´æ”¹è¿™ä¸ªURL. è¯·å‚è€ƒGit Helpä¹‹Changing a remoteâ€™s URL å¦‚æœä½ è§‰å¾—ä½ åˆå¹¶åçš„çŠ¶æ€æ˜¯ä¸€å›¢ä¹±éº»ï¼Œæƒ³æŠŠå½“å‰çš„ä¿®æ”¹éƒ½æ”¾å¼ƒï¼Œä½ å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤å›åˆ°åˆå¹¶ä¹‹å‰çš„çŠ¶æ€ï¼š $ git reset --hard HEADæˆ–è€…ä½ å·²ç»æŠŠåˆå¹¶åçš„ä»£ç æäº¤ï¼Œä½†è¿˜æ˜¯æƒ³æŠŠå®ƒä»¬æ’’é”€ï¼š $ git reset --hard ORIG_HEADä½†æ˜¯åˆšæ‰è¿™æ¡å‘½ä»¤åœ¨æŸäº›æƒ…å†µä¼šå¾ˆå±é™©ï¼Œå¦‚æœä½ æŠŠä¸€ä¸ªå·²ç»è¢«å¦ä¸€ä¸ªåˆ†æ”¯åˆå¹¶çš„åˆ†æ”¯ç»™åˆ äº†ï¼Œé‚£ä¹ˆ ä»¥ååœ¨åˆå¹¶ç›¸å…³çš„åˆ†æ”¯æ—¶ä¼šå‡ºé”™ã€‚ Gitè¿œç¨‹æ“ä½œå‘½ä»¤è¯¦è§£æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨è¿™é‡Œå¼•ç”¨ä¸€ä¸‹Ruanè€å¸ˆçš„åšå®¢å†…å®¹ï¼Œæ…¢æ…¢ç†è§£ä¸ä½“ä¼š Gitè¿œç¨‹æ“ä½œè¯¦è§£ å’Œ Gitå¸¸ç”¨å‘½ä»¤æ¸…å•, åŒæ—¶è¿˜è¦æŠŠå»–é›ªå³°è€å¸ˆçš„Gitæ•™ç¨‹ç®€ä»‹ï¼šGitè¿œç¨‹æ“ä½œè¯¦è§£æ”¾åœ¨è¿™é‡Œï¼Œéƒ½æ˜¯æœ€å¥½çš„å­¦ä¹ èµ„æ–™ï¼Œåç»­æˆ‘è¿˜ä¼šç»§ç»­è¡¥å……. æœ‰ç–‘é—®å¯ä»¥ç•™è¨€ï¼ŒåŠ å…¥gitå®ç”¨æƒ…æ™¯ä¸­.","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"DevOps","slug":"Coding/DevOps","permalink":"https://dayarch.top/categories/Coding/DevOps/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://dayarch.top/tags/Git/"}]},{"title":"WeChatFeedback","slug":"WeChatFeedback","date":"2016-05-23T07:55:56.000Z","updated":"2019-11-01T08:57:45.837Z","comments":true,"path":"/p/english-common-model.html","link":"","permalink":"https://dayarch.top/p/english-common-model.html","excerpt":"éƒ‘é‡å£°æ˜ï¼š æœªç»åŒæ„ï¼Œä¸å¾—è½¬è½½ å¾®ä¿¡ä½œä¸šåé¦ˆ2016 ä¸‡èƒ½å¥å‹ ä¸‡èƒ½å¥å‹ç¬¬ä¸€å‘[got to get] å…ˆé™„ä¸Šä¸¤å¼ å›¾ç‰‡æ¥åšä¸€ä¸ªæ€»è§ˆï¼Œæ¥ä¸‹æ¥é€ä¸ªä¸¾ä¾‹è¯´æ˜ï¼š ä¸‡èƒ½å¥å‹å‰é¢æ­é…ï¼š åºå·æ­é…çœç•¥â€™veæˆ–â€™s1Iâ€™veå¯ä»¥2Weâ€™veå¯ä»¥3Youâ€™veå¯ä»¥4Theyâ€™veå¯ä»¥5Heâ€™sä¸å¯ä»¥6Sheâ€™sä¸å¯ä»¥ä¸‡èƒ½å¥å‹ä¸¾ä¾‹ï¼š åºå·å¥å­ç¿»è¯‘è¿è¯»éŸ³æ ‡1I got to get goingæˆ‘å¾—èµ°äº†2I got to get used to itæˆ‘å¾—é€‚åº”æŸç‰©3I got to get used to this bedæˆ‘å¾—é€‚åº”è¿™å¼ åºŠ4I got to get Used to the new comp","text":"éƒ‘é‡å£°æ˜ï¼š æœªç»åŒæ„ï¼Œä¸å¾—è½¬è½½ å¾®ä¿¡ä½œä¸šåé¦ˆ2016ä¸‡èƒ½å¥å‹ä¸‡èƒ½å¥å‹ç¬¬ä¸€å‘[got to get]å…ˆé™„ä¸Šä¸¤å¼ å›¾ç‰‡æ¥åšä¸€ä¸ªæ€»è§ˆï¼Œæ¥ä¸‹æ¥é€ä¸ªä¸¾ä¾‹è¯´æ˜ï¼š ä¸‡èƒ½å¥å‹å‰é¢æ­é…ï¼š åºå· æ­é… çœç•¥â€™veæˆ–â€™s 1 Iâ€™ve å¯ä»¥ 2 Weâ€™ve å¯ä»¥ 3 Youâ€™ve å¯ä»¥ 4 Theyâ€™ve å¯ä»¥ 5 Heâ€™s ä¸å¯ä»¥ 6 Sheâ€™s ä¸å¯ä»¥ ä¸‡èƒ½å¥å‹ä¸¾ä¾‹ï¼š åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get going æˆ‘å¾—èµ°äº† 2 I got to get used to it æˆ‘å¾—é€‚åº”æŸç‰© 3 I got to get used to this bed æˆ‘å¾—é€‚åº”è¿™å¼ åºŠ 4 I got to get Used to the new computer æˆ‘å¾—é€‚åº”è¿™ä¸ªæ–°ç”µè„‘ 5 I got to get used to waking up early æˆ‘å¾—é€‚åº”æ—©èµ· 6 I got to get Used to eating less æˆ‘å¾—é€‚åº”å°‘åƒç‚¹ 7 I got to get Used to drinking tea æˆ‘å¾—é€‚åº”å–èŒ¶ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get a life æˆ‘å¾—å¾—åˆ°ä¸€ä¸ªç”Ÿæ´»ï¼ˆæƒ³è±¡ï¼šå¤©å¤©å®…åœ¨å®¶é‡Œï¼Œçªç„¶é†’æ‚Ÿå¯¹è‡ªå·±è¯´è¿™å¥è¯ï¼‰ 2 I got to get a nicer house æˆ‘å¾—å¾—åˆ°/æœ‰/ä¹°ä¸€ä¸ªæ›´å¥½çš„æˆ¿å­ 3 I got to get a girl friend æˆ‘å¾—æœ‰ä¸ªå¥³æœ‹å‹ 4 I got to get an invite æˆ‘å¾—å¾—åˆ°/æ”¶åˆ°ä¸€ä¸ªé‚€è¯· 5 I got to get an extra plate æˆ‘å¾—è¦ä¸€ä¸ªé¢å¤–çš„ç›˜å­ 6 I got to get an apartment æˆ‘å¾—æœ‰/ä¹°/å¾—åˆ°ä¸ªå…¬å¯“ 7 I got to get a coffee æˆ‘å¾—æ¥æ¯å’–å•¡ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get serious æˆ‘å¾—å˜å¾—ä¸¥è‚ƒç‚¹ 2 I got to get stronger æˆ‘å¾—å˜å¾—æ›´å¼ºå£® 3 I got to get taller æˆ‘å¾—æ›´é«˜ä¸€ç‚¹ 4 I got to get healthier æˆ‘å¾—æ›´å¥åº·ä¸€äº› 5 I got to get better at sth æˆ‘å¾—æ›´æ“…é•¿æŸäº‹ 6 I got to get better at doing sth æˆ‘å¾—æ›´æ“…é•¿åšæŸäº‹ 7 I got to get faster at sth æˆ‘å¾—æ›´å¿«é€ŸäºæŸäº‹ 8 I got to get faster at doing sth æˆ‘å¾—æ›´å¿«é€ŸäºåšæŸäº‹ [Sb] got to get more [sth] å¾—å¾—åˆ°æ›´å¤š åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get more than that æˆ‘å¾—å¾—åˆ°æ›´å¤šï¼Œæ¯”æ‰‹é‡Œæ‹¥æœ‰çš„æ›´å¤š 2 I got to get more clothes æˆ‘å¾—æœ‰/å¾—åˆ°æ›´å¤šè¡£æœ 3 I got to get more money æˆ‘å¾—å¾—åˆ°/æ‹¥æœ‰æ›´å¤šé’± [Sb] got to get started [doing sth] å¼€å§‹åšæŸäº‹ï¼Œå¤šæŒ‡éœ€è¦ä¸€æ®µæ—¶é—´è¿‡ç¨‹çš„äº‹æƒ…ï¼Œä¸æ˜¯ä¸€ç¬é—´å°±èƒ½æå®šçš„ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get started writing my report æˆ‘å¾—å¼€å§‹å†™æˆ‘çš„æŠ¥å‘Š 2 I got to get started working on my project æˆ‘å¾—å¼€å§‹åšæˆ‘çš„é¡¹ç›® 3 I got to get started planning my wedding æˆ‘å¾—å¼€å§‹ç­¹åˆ’å©šç¤¼ 4 I got to get started moving these boxes æˆ‘å¾—å¼€å§‹æ¬è¿™äº›ç›’å­äº† 5 I got to get started cooking dinner æˆ‘å¾—å¼€å§‹åšé¥­äº† [Sb] got to get [adv]å‰¯è¯/[prep]ä»‹è¯ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get up æˆ‘å¾—èµ·åºŠäº† 2 You got to get up early tomorrow ä½ æ˜æ—©å¾—æ—©èµ· 3 I got to get started planning my wedding æˆ‘å¾—å¼€å§‹ç­¹åˆ’å©šç¤¼ 4 I got to get started moving these boxes æˆ‘å¾—å¼€å§‹æ¬è¿™äº›ç›’å­äº† 5 I got to get started cooking dinner æˆ‘å¾—å¼€å§‹åšé¥­äº† [Sb] got to get backâ€¦æŸäººå¾—å›å»ã€å›å®¶ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get back æˆ‘å¾—å›å®¶ ï¼ˆæœ‰æ—¶å€™è¯´å›å®¶ä¸ä¸€å®šéè¦æœ‰homeï¼‰ 2 You got to get back to work[sth] ä½ å¾—å›å»å·¥ä½œäº† 3 Sheâ€™s got to get back on that horse å¥¹å¾—å†åšæŒä¸€æ¬¡ï¼ˆä¿šè¯­ï¼Œä¹‹å‰ä»é©¬ä¸Šæ‰ä¸‹æ¥ä¸€æ¬¡ï¼Œå†æ¬¡å›åˆ°é©¬ä¸Šï¼‰ 4 Heâ€™s got to get back soon. ä»–å¾—é©¬ä¸Šå›æ¥ 5 I got to get back in the game æˆ‘å¾—å›åˆ°è€è¡Œå½“ï¼ˆçˆ±å¥½ï¼Œå·¥ä½œï¼Œå–œå¥½) ç®—æ˜¯é‡æ“æ—§ä¸š [Sb] got to get thereâ€¦æŸäººå¾—åˆ°è¾¾æŸå¤„ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get there at 4 æˆ‘å¾—4ç‚¹åˆ°é‚£ 2 You got to get there on time ä½ å¾—å›å»å·¥ä½œäº† 3 Sheâ€™s got to get there in time å¥¹å¾—åŠæ—¶åˆ°é‚£ 4 Heâ€™s got to get there before itâ€™s too late ä»–èµ¶ç´§åˆ°é‚£å„¿ï¼Œä¸ç„¶å°±æ™šäº† [Sb] got to get outâ€¦ æŸäººå¾—å‡ºå»/è·‘èµ°/é¿å…ã€æ‘†è„± åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get out of here æˆ‘å¾—ç¦»å¼€è¿™ 2 Sheâ€™s got to get out of work å¥¹å¾—æ‘†è„±å·¥ä½œï¼ˆä¸€èµ·çœ‹ç”µå½±ï¼Œå¥¹å·¥ä½œå¾ˆå¿™ï¼Œè¦æ˜¯æƒ³å»éœ€è¦å…ˆæ‘†è„±å·¥ä½œï¼‰ 3 Heâ€™s got to get out of this relationship ä»–å¾—æ‘†è„±è¿™æ®µå…³ç³»çš„çº ç¼  4 You got to get out of bed ä½ å¾—ç¦»å¼€åºŠï¼ˆæ»šä¸‹åºŠï¼‰ [Sb] got to get [to smw] / [to the smw] /[smw] æŸäººå¾—å»æŸä¸ªåœ°æ–¹ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get to school æˆ‘å¾—å»å­¦æ ¡ 2 You got to get to work ä½ å¾—å»ä¸Šç­ 3 Heâ€™s got to get home. ä»–å¾—å›å®¶ 4 We got to get to the hospital æˆ‘ä»¬å¾—å»åŒ»é™¢ 5 You got to get to the part where [SVO]ä¸»è°“å®¾ ä½ å¾—å»æŠŠï¼ˆç”µè§†ï¼Œå‰§é›†ç­‰ï¼‰çœ‹åˆ°å“ªä¸ªæ®µè½ï¼Œå“ªä¸€é›† [Sb] got to get [Sb][sth] æŸäººå¾—ç»™æŸä¸ªäººé€æŸä¸ªä¸œè¥¿ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get to you a gift æˆ‘å¾—ç»™ä½ é€ä¸ªç¤¼ç‰© 2 You got to get him a girlfriend ä½ å¾—ç»™ä»–æ‰¾ä¸ªå¥³æœ‹å‹ 3 We got to get them a car æˆ‘ä»¬å¾—ç»™ä»–å¼„è¾†è½¦ 4 We got to get to the hospital æˆ‘ä»¬å¾—å»åŒ»é™¢ 5 They got to get me a job ä»–ä»¬å¾—ç»™æˆ‘æ‰¾ä¸ªå·¥ä½œ [Sb] got to get [Sb][smw] æŸäººå¾—é€æŸä¸ªäººå»æŸä¸ªåœ°æ–¹ åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got to get you to school æˆ‘å¾—é€ä½ å»å­¦æ ¡ 2 You got to get me home ä½ å¾—é€æˆ‘å›å®¶ 3 We got to get them a car æˆ‘ä»¬å¾—ç»™ä»–å¼„è¾†è½¦ 4 I got to get you out of here. æˆ‘å¾—è®©ä½ ç¦»å¼€è¿™å„¿ 5 I got to get this off the wall. æˆ‘å¾—æŠŠè¿™ä¸œè¥¿ä»å¢™ä¸Šå¼„ä¸‹æ¥ä½œ 6 Sheâ€™s got to get all this stuff into the luggage å¥¹å¾—æŠŠæ‰€æœ‰ä¸œè¥¿å¡è¿›è¡Œæç®± MarMar 29th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I donâ€™t know what to do è¿™ä¸ªçœ‹èµ·æ¥ä¹Ÿå¾ˆå¥½ 2 Give it to him æŠŠè¿™ä¸ªç»™ä»–å§ 3 I made an important decision today æˆ‘ä»Šå¤©åšäº†ä¸ªå¾ˆé‡è¦çš„å†³å®š 4 I have to leave early last night å·®ä¸å¤šæ˜¯æ—¶å€™äº† Mar 30th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 This one looks good too è¿™ä¸ªçœ‹èµ·æ¥ä¹Ÿå¾ˆå¥½ 2 I tried to talk to him æˆ‘è¯•ç€æƒ³è·Ÿä»–èŠ(ä½†ä»–ä¸å¬) 3 Itâ€™s hard to tell è¿™ä¸å¥½è¯´ 4 Itâ€™s about time å·®ä¸å¤šæ˜¯æ—¶å€™äº† 5 I canâ€™t tell, can you æˆ‘çœ‹ä¸å‡ºæ¥ï¼Œä½ å¯ä»¥å— 6 Iâ€™ve decided to move forward with it æˆ‘å†³å®šç»§ç»­å‰è¿› Mar 31st åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 What do you mean ä½ æƒ³è¡¨è¾¾ä»€ä¹ˆï¼Œä½ ä»€ä¹ˆæ„æ€ 2 We could do that å½“æœ‰äººæè®®æˆ‘ä»¬ä¸€èµ·åšä¸€ä»¶äº‹æ—¶ï¼Œå¥½å•Šï¼Œæˆ‘ä»¬å¯ä»¥åš.. äº‹ 3 Donâ€™t let your guard down åˆ«æ”¾æ¾è­¦æƒ• 4 It might take a while è¿™å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ 5 It wonâ€™t take too long ä¸ä¼šèŠ±è´¹å¤ªé•¿æ—¶é—´çš„ 6 Donâ€™t tell me the answer ä¸è¦å‘Šè¯‰æˆ‘ç­”æ¡ˆ 7 Iâ€™ve decided to move forward with it æˆ‘å†³å®šç»§ç»­å‰è¿› AprApr 4th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Yep, pretty much å¯¹ï¼Œå·®ä¸å¤š 2 Keep pushing, come on ç”¨åŠ›æ¨ï¼Œä½¿åŠ² 3 I always keep people at distance æˆ‘ä¸€ç›´éƒ½è·Ÿåˆ«äººä¿æŒè·ç¦» 4 They have deep pocket ä»–ä»¬æœ‰çš„æ˜¯é’± 5 I got a backup plan æˆ‘å·²ç»ç•™äº†åæ‰‹ 6 You guys got to keep pace ä½ ä»¬å¾—è·Ÿæˆ‘èŠ‚å¥ Apr 5th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Stop being stupid åˆ«å‚»äº† 2 I couldnâ€™t help but notice æˆ‘æ— æ³•ä¸æ³¨æ„åˆ° 3 Weâ€™ll stop by on weekends æˆ‘ä»¬å‘¨æœ«å›è¿‡æ¥çš„ 4 Youâ€™re very upbeat today ä½ ä»Šå¤©è¿™æ˜¯å‡ºå¥‡çš„æ´»è·ƒå•Š 5 Can you stop being so loud ä½ ä¸èƒ½å°ç‚¹å£°å— 6 Can you help me èƒ½å¸®æˆ‘ä¸€ä¸‹å— Apr 6th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 We need to take a step back å’±ä»¬éœ€è¦é€€ä¸€æ­¥ 2 I have to stop by my place first æˆ‘å¾—å…ˆå›å®¶ä¸€è¶Ÿ 3 I need to go pick up my friend æˆ‘è¦å»æ¥æˆ‘çš„æœ‹å‹ 4 I have to make up for past mistakes æˆ‘å¿…é¡»å¼¥è¡¥æˆ‘è¿‡å»çš„é”™è¯¯ 5 Can you grab me a coke èƒ½ç»™æˆ‘å¸¦ä¸ªå¯ä¹å— 6 Donâ€™t rub my fact in it åˆ«åœ¨ä¼¤å£ä¸Šæ’’ç› Apr 7th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 He didnâ€™t show up for work ä»–æ²¡æ¥ä¸Šç­ 2 She dressed up for her interview å¥¹ä¸ºé¢è¯•æ‰“æ‰®çš„ 3 You need to stand up for yourself ä½ è¦ç»´æŠ¤ä½ è‡ªå·± 4 I got a backup plan æˆ‘å·²ç»ç•™äº†åæ‰‹ 5 Can you stop moping åˆ«å†è¿™ä¹ˆæ¶ˆæ²‰äº†å¥½å— 6 I bought my son a popup book æˆ‘ç»™æˆ‘å„¿å­ä¹°äº†æœ¬ç«‹ä½“æ•…äº‹ä¹¦ Apr 11st åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Iâ€™d take christmas alone any day æˆ‘å®æ„¿è‡ªå·±è¿‡åœ£è¯èŠ‚ 2 I take classes on line æˆ‘åœ¨ç½‘ä¸Šä¸Šè¯¾ 3 Why donâ€™t you ask questions ä½ æ€ä¹ˆä¸é—®é—®é¢˜ 4 Iâ€™ll take care of it æˆ‘è§‰å¾—ä½ å¾ˆå¯çˆ± 5 You look gorgeous ä½ çœ‹èµ·æ¥å¥½è¿·äºº 6 You look great too ä½ çœ‹èµ·æ¥ä¹Ÿå¾ˆæ£’ Apr 12nd åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 He gets a big kick out of it ä»–ä»è¿™ä»¶äº‹ä¸­æ”¶è´§å¾ˆå¤šä¹è¶£ 2 He wears thick glasses ä»–å¸¦ç€åšåšçš„çœ¼é•œ 3 You look good ä½ æ°”è‰²ä¸é”™å•Š 4 I think you look cute æˆ‘è§‰å¾—ä½ å¾ˆå¯çˆ± 5 Is this a trick question ä½ é—®çš„è¿™ä¸ªé—®é¢˜æ˜¯ä¸ªé™·é˜±å— 6 I bought a new bookcase from IKEA æˆ‘ä»å®œå®¶ä¹°äº†ä¸ªæ–°ä¹¦æŸœ Apr 13rd åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 They make good pizza here ä»–ä»¬è¿™çš„Pizzaå¾ˆä¸é”™ 2 Iâ€™ve got an electric guitar æˆ‘å¾—åˆ°äº†ä¸€æŠŠç”µå‰ä»– 3 Heâ€™s a very romantic guy ä»–æ˜¯ä¸ªå¾ˆæµªæ¼«çš„äºº 4 Whoâ€™s milk carton is this è¿™ç›’å¥¶æ˜¯è°çš„ 5 Itâ€™s all a big coverup è¿™å…¨æ˜¯æ¼”ç¤º 6 Thatâ€™s a big cat é‚£åªçŒ«çœŸè‚¥ Apr 14th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Either the dog goes or I go è®©ç‹—ç¦»å¼€ï¼Œè¦ä¹ˆæˆ‘èµ° 2 He sent me a gag gift for christmas ä»–é€äº†æˆ‘ä¸€ä¸ªææ€ªçš„åœ£è¯ç¤¼ç‰© 3 What do you say, big guy ä½ æ€ä¹ˆçœ‹å“¥ä»¬ 4 Can we at least hug goodbye æˆ‘ä»¬èƒ½è‡³å°‘æ‹¥æŠ±ä¸€ä¸‹æ¥å‘Šåˆ«å— 5 He took credit for my work ä»–æŠŠæˆ‘çš„åŠŸåŠ³å ä¸ºå·±æœ‰ 6 These are big cups è¿™äº›æ¯å­å¥½å¤§ Apr 18th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Sheâ€™s so great å¥¹çœŸå¥½ 2 This is so unfair è¿™ä¸ªå¤ªä¸å…¬å¹³äº† 3 This is sick çœŸå˜æ€ 4 I leave for work at seven in the morning æˆ‘æ—©ä¸Šä¸ƒç‚¹å»ä¸Šç­ 5 I live for dance æˆ‘æ˜¯ä¸ºäº†è·³èˆè€Œç”Ÿ 6 Breath through the pain å’¬å’¬ç‰™ Apr 19th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I lost Monicaâ€™s shoes æˆ‘æŠŠè«å¦®å¡çš„é‹å­ä¸¢äº† 2 yes, she is å¥¹ç¡®å®æ˜¯ 3 Let show them whoâ€™s boss è®©ä»–ä»¬çœ‹çœ‹è°æ‰æ˜¯è€æ¿ 4 What does she do? å¥¹æ˜¯åšä»€ä¹ˆçš„ 5 Why is she here å¥¹ä¸ºä»€ä¹ˆåœ¨è¿™ 6 How long has she been in the bathroom å¥¹åœ¨æ´—æ‰‹é—´å¤šé•¿æ—¶é—´äº† Apr 20th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 These are nice shoes è¿™é‹å­ä¸é”™ 2 I think heâ€™s shy æˆ‘æƒ³ä»–æ˜¯å®³ç¾ 3 I really like this shirt æˆ‘ç‰¹åˆ«å–œæ¬¢è¿™ä»¶è¡£æœ 4 This is because she doesnâ€™t like you è¿™æ˜¯å› ä¸ºå¥¹ä¸å–œæ¬¢ä½  5 How is she doing å¥¹ç°åœ¨çŠ¶æ€æ€ä¹ˆæ ·å•Š 6 What she like å¥¹äººæ€ä¹ˆæ ·å•Š Apr 21st åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Go and have fun å»å¥½å¥½åœ°ç© 2 Houseflies live for a day æœè‡åªæ´»ä¸€å¤© 3 What kind of food are they serving ä»–ä»¬æä¾›å“ªäº›ç§ç±»çš„é£Ÿç‰© 4 Itâ€™s cruel twist of fate è¿™æ˜¯ä¸ªæ®‹é…·çš„å‘½è¿åè½¬ 5 I have to leave for work æˆ‘å¾—èµ°äº†å»ä¸Šç­äº† 6 I have faith in you æˆ‘å¯¹ä½ æœ‰ä¿¡å¿ƒ Apr 25th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Of course she likes me ä»–å½“ç„¶å–œæ¬¢æˆ‘å•Š 2 She hasnâ€™t, has she å¥¹æ²¡æœ‰ï¼Œå¯¹å§ 3 How is that possible æ€ä¹ˆå¯èƒ½è¿™æ · 4 Give it back æŠŠå®ƒè¿˜ç»™æˆ‘ 5 Itâ€™s hard to say goodbye è¯´å†è§çœŸä¸å®¹æ˜“ 6 Give me my credit card æŠŠæˆ‘çš„ä¿¡ç”¨å¡ç»™æˆ‘ Apr 26th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 How could that even be possible è¿™æ˜¯æ€ä¹ˆå¯èƒ½çš„å•Š 2 What are you up to å¹²å•¥å•Šä½  3 Itâ€™s just another one of his pipe dream è¿™æ˜¯ä»–çš„å¦ä¸€ä¸ªç™½æ—¥æ¢¦ 4 Letâ€™s get back to the topic at hand å’±ä»¬è¨€å½’æ­£ä¼  5 Henryâ€™s rock bottom lately äº¨åˆ©æœ€è¿‘æƒ³å…¥äº†äººç”Ÿçš„è°·åº• 6 Letâ€™s look the big picture å’±ä»¬ä»å¤§å±€ç€æƒ³ Apr 27th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 This is my big break è¿™æ˜¯æˆ‘çš„é‡å¤§çªç ´ 2 This is a public place è¿™æ˜¯å…¬å…±åŒºåŸŸ 3 Itâ€™s no big deal æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ 4 It broke down this morning å®ƒä»Šå¤©æ—©æ™¨åæ‰äº† 5 How bad could it be èƒ½ååˆ°å“ªå»å‘¢ 6 so, howâ€™d go æ€ä¹ˆæ ·äº† Apr 28th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I think I should go æˆ‘è§‰å¾—æˆ‘è¯¥èµ°äº† 2 I think you need to read the subtitle æˆ‘æƒ³ä½ éœ€è¦çœ‹å­—å¹• 3 We canâ€™t stop, we got to keep going æˆ‘ä»¬ä¸èƒ½åœï¼Œæˆ‘ä»¬å¾—ç»§ç»­ 4 oh yeah, big time æ˜¯çš„ï¼Œç›¸å½“çš„ 5 You got to give it back ä½ å¾—æ¢å›å» 6 good bye å†è§ MayMay 2nd åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Donâ€™t I know you? æˆ‘å¥½åƒåœ¨å“ªè§è¿‡ä½  2 I did, didnâ€™t I? æˆ‘åšäº†ï¼Œå¯¹å§ï¼Ÿ 3 Donâ€™t even try it æƒ³ä¹Ÿåˆ«æƒ³ 4 I wouldnâ€™t even care æˆ‘ä¸€ç‚¹éƒ½ä¸ä¼šåœ¨ä¹çš„ 5 Listen to me ä½ å¬æˆ‘è¯´ 6 Letâ€™s move on to something else å’±ä»¬è®¨è®ºä¸‹ä¸ªå§ May 3rd åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Shouldnâ€™t I do something about this æˆ‘ä¸åº”è¯¥åšäº›ä»€ä¹ˆå— 2 I donâ€™t mean to be rude æˆ‘ä¸æ˜¯æ•…æ„å†’çŠ¯ä½  3 Thereâ€™s no reason to do that æ²¡æœ‰å¿…è¦è¿™æ · 4 I havenâ€™t spoken to him in years æˆ‘å¥½å‡ å¹´éƒ½æ²¡å’Œä»–è¯´è¯äº† 5 Letâ€™s move on to something else å’±ä»¬èŠä¸‹ä¸€ä¸ªè¯é¢˜å§ 6 Do you believe in Santa Claus ä½ ç›¸ä¿¡åœ£è¯è€å…¬å…¬å— May 4th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 There are plenty of intelligent inventors æœ‰å¾ˆå¤šèªæ˜çš„å‘æ˜å®¶ 2 Iâ€™m on a international flight to Canada æˆ‘æ­£åœ¨åä¸€ä¸ªå›½é™…èˆªç­å»Canada 3 There are twenty presenters scheduled for today ä»Šå¤©å®‰æ’äº†20ä¸ªæ¼”è®²è€… 4 There are identical twins åŒåµåŒèƒèƒ 5 He works in the entertainment industry ä»–åœ¨å¨±ä¹åœˆå·¥ä½œ 6 Why wonâ€™t he listen to me ä»–ä¸ºä»€ä¹ˆä¸å¬æˆ‘çš„è¯ May 5th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Why does he do that ä»–ä¸ºä»€ä¹ˆé‚£ä¹ˆåš 2 Why doesnâ€™t he come to me ä»–ä¸ºä»€ä¹ˆä¸æ¥æ‰¾æˆ‘ 3 Did he mention us ä»–æåˆ°æˆ‘ä»¬äº†å— 4 There he is ä»–åœ¨é‚£ 5 I thought he was nice æˆ‘è§‰å¾—ä»–æŒºå¥½çš„å•Š 6 I think about him all the time æˆ‘ä¸€ç›´åœ¨æƒ³ä»– May 10th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Iâ€™ll take him to the store æˆ‘ä¼šå¸¦ä»–å»å•†åº— 2 Iâ€™m looking for him æˆ‘åœ¨æ‰¾ä»– 3 Let him do what he wants è®©ä»–åšä»–æƒ³åšçš„ 4 Can you tell him for me ä½ èƒ½æ›¿æˆ‘å‘Šè¯‰å¥¹å— 5 Iâ€™ll give him back his book æˆ‘ä¼šæŠŠä»–çš„ä¹¦è¿˜ç»™ä»– 6 Itâ€™s his, not mine æ˜¯ä»–çš„ï¼Œä¸æ˜¯æˆ‘çš„ May 11th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 They found a gun in his hand ä»–ä»¬åœ¨ä»–æ”¶æ‰¾åˆ°ä¸€æŠŠæª 2 This is his office è¿™æ˜¯ä»–çš„åŠå…¬å®¤ 3 When is his birthday ä»€ä¹ˆæ—¶å€™æ˜¯ä»–çš„ç”Ÿæ—¥ 4 Donâ€™t push her åˆ«é€¼å¥¹/åˆ«æ¨å¥¹ 5 I walked her out to the bus stop æˆ‘æŠŠå¥¹é€åˆ°äº†è½¦ç«™ 6 I wanna make her breakfast æˆ‘æƒ³ç»™å¥¹åšæ—©é¤ May 12th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 He really told her off ä»–è‡­éª‚äº†å¥¹ä¸€é¡¿ 2 I went to the mall with her æˆ‘è·Ÿå¥¹ä¸€èµ·å»äº†å•†åœº 3 Youâ€™ve got to call her ä½ å¾—ç»™å¥¹æ‰“ä¸ªç”µè¯ 4 Is it her birthday today ä»Šå¤©æ˜¯å¥¹çš„ç”Ÿæ—¥å— 5 I think his ideaâ€™s good æˆ‘è§‰å¾—ä»–çš„ä¸»æ„æŒºå¥½ 6 Is this his wallet è¿™æ˜¯ä»–çš„é’±åŒ…å— May 16th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Get in the car ä¸Šè½¦ 2 Itâ€™s not in there ä¸åœ¨é‚£é‡Œ 3 This is my first night in BJ è¿™æ˜¯æˆ‘åœ¨åŒ—äº¬çš„ç¬¬ä¸€å¤œ 4 Heâ€™s out in the hallway ä»–åœ¨å¤–é¢çš„èµ°å»Š 5 It hit me right in the eye æ­£å¥½æ‰“åˆ°æˆ‘çš„çœ¼ç› 6 Whatâ€™s that in the car è½¦é‡Œé‚£ä¸ªæ˜¯ä»€ä¹ˆ May 17th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 This is a important day for me è¿™å¯¹æˆ‘æ˜¯ä¸€ä¸ªé‡è¦çš„æ—¥å­ 2 Martin said the milk is rotten é©¬ä¸è¯´ç‰›å¥¶å·²ç»è¿‡æœŸäº† 3 Would you like some sweetener for your coffee ä½ æƒ³åŠ ä¸€äº›ç”œå‘³å‰‚ç»™ä½ çš„å’–å•¡å— 4 Can you draw the curtains ä½ èƒ½æ‹‰ä¸Šé‚£ä¸ªçª—å¸˜å— 5 I wanna help lighten the load æˆ‘æƒ³å¸®å¿™åˆ†æ‹…ä¸€äº›é‡é‡ 6 Iâ€™ve written a letter to him æˆ‘å·²ç»ç»™ä»–å†™ä¿¡äº† May 18th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I need to buy a hair straightener æˆ‘éœ€è¦ä¹°ä¸€ä¸ªç›´å‘åŠ ç­ 2 I just got a new kitten æˆ‘åˆšåˆšä¹°äº†ä¸€åªå°çŒ« 3 Have you seen my mittens ä½ çœ‹åˆ°æˆ‘çš„è¿æŒ‡æ‰‹å¥—äº†å— 4 Have you eaten yet ä½ åƒé¥­äº†å— 5 I lost a button æˆ‘ä¸¢äº†ä¸€ä¸ªæ‰£å­ 6 Are you certain that he left ä½ ç¡®å®šä»–å·²ç»èµ°äº†å— May 19th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 The dentist is going to whiten my teeth ç‰™åŒ»å°†ä¼šç»™æˆ‘çš„ç‰™é½¿ç¾ç™½ 2 Itâ€™s disheartening news è¿™æ˜¯ä¸ªä»¤äººæ²®ä¸§çš„æ¶ˆæ¯ 3 Please enlighten me è¯·æŒ‡å¼•æˆ‘ 4 I wanna shorten my bangs æˆ‘æƒ³å‰ªçŸ­æˆ‘çš„åˆ˜æµ· 5 The wall is crooked, it needs to be straightened è¿™å µå¢™æ­ªäº†ï¼Œéœ€è¦é‡æ–°è°ƒæ•´ 6 The horror movie we saw was frightening æˆ‘ä»¬çœ‹è¿‡çš„é‚£ä¸ªææ€–ç‰‡å¾ˆå¯æ€• May 23rd åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 What about you é‚£ä½ å‘¢ 2 Can I get you something to drink ä½ æƒ³è¦å–ç‚¹ä»€ä¹ˆå— 3 Thatâ€™s what you said ä½ å°±æ˜¯è¿™ä¹ˆè¯´çš„å•Š 4 Thereâ€™s something that you should know æœ‰äº›äº‹æƒ…ä½ åº”è¯¥çŸ¥é“ 5 Look at you, youâ€™re mess çœ‹çœ‹ä½ ï¼Œä½ ä¸€å›¢ç³Ÿ 6 I thought you left already æˆ‘ä»¥ä¸ºä½ å·²ç»èµ°äº† May 24th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 I got you flowers æˆ‘ç»™ä½ ä¹°äº†èŠ± 2 Donâ€™t you wanna know? ä½ ä¸æƒ³çŸ¥é“å— 3 Is that what youâ€™re saying ä½ è¯´çš„æ˜¯è¿™ä¸ªæ„æ€å— 4 What did you do ä½ åšäº†ä»€ä¹ˆ 5 Would you give it a rest ä½ èƒ½ä¸èƒ½åˆ«æŠ˜è…¾äº† 6 How could you do that to me ä½ æ€ä¹ˆèƒ½è¿™æ ·å¯¹æˆ‘ May 25th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Hey, Iâ€™m glad youâ€™re here å˜¿ï¼Œå¹¸äºä½ æ¥äº† 2 Should you be doing that ä½ åº”è¯¥è¿™ä¹ˆåšå— 3 I told you yesterday that Iâ€™m busy today æˆ‘æ˜¨å¤©å°±è·Ÿä½ è¯´äº†æˆ‘ä»Šå¤©å¾ˆå¿™ 4 He said you wanted to go home ä»–è¯´äº†ä½ æƒ³å›å®¶ 5 Iâ€™m sorry I stood you up last night ä¸å¥½æ„æ€æ˜¨å¤©æ™šä¸Šæ”¾äº†ä½ é¸½å­ 6 Why would you do that ä½ ä¸ºä»€ä¹ˆé‚£ä¹ˆåš May 26th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Did you sleep okay ä½ ç¡å¾—å¥½å— 2 How did you do that ä½ æ˜¯æ€ä¹ˆåšçš„ 3 I donâ€™t need your pity æˆ‘ä¸éœ€è¦ä½ çš„å¯æ€œ 4 I brought you some books æˆ‘ç»™ä½ å¸¦äº†ä¹¦ 5 Why canâ€™t you go ä½ ä¸ºä»€ä¹ˆä¸èƒ½å» 6 Donâ€™t let your guard down ä½ åˆ«æ”¾æ¾è­¦æƒ• May 30th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 What are you talking about? ä½ åœ¨è¯´ä»€ä¹ˆå•Š 2 Whatâ€™s going on æœ€è¿‘æ€ä¹ˆæ · 3 What are you doing here ä½ åœ¨è¿™é‡Œåšä»€ä¹ˆ 4 Iâ€™m tell you, this guys mean business æˆ‘è·Ÿä½ è®²ï¼Œä»–ä»¬æ˜¯ç©çœŸçš„ 5 Yeah, thatâ€™s right, keep walking æ²¡é”™ï¼Œç»§ç»­èµ° 6 Iâ€™m having the time of my life æˆ‘æ­£åœ¨äº«å—ä¸€ç”Ÿä¸­æœ€å¿«ä¹çš„æ—¶å…‰ May 31st åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 What are you saying? ä½ ä»€ä¹ˆæ„æ€å•Š 2 Quit being such a wuss åˆ«åšèƒ†å°é¬¼äº† 3 What are you looking at ä½ çœ‹ä»€ä¹ˆå‘¢ 4 What are you trying to do ä½ æƒ³åšä»€ä¹ˆ 5 When are we starting æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™å¼€å§‹ 6 Iâ€™m getting you home æˆ‘é€ä½ å›å®¶ JunJun 1st åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Hey, Iâ€™m talking to you å˜¿ï¼Œæˆ‘æ­£å’Œä½ è®²è¯å‘¢ 2 Heâ€™s going into the house ä»–æ­£è¦èµ°è¿›é‚£ä¸ªæˆ¿å­ 3 Iâ€™ve been waiting all day æˆ‘ç­‰äº†ä¸€æ•´å¤© 4 Stop shouting at me åˆ«å†²æˆ‘åš·åš· 5 Theyâ€™re fighting again ä»–ä»¬åˆåµèµ·æ¥äº† 6 When are we meeting æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™è§é¢ Jun 2nd åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 He keeps hitting on her ä»–ä¸€ç›´åœ¨æ­è®ªå¥¹ 2 Iâ€™m putting out the cigarette æˆ‘æ­£åœ¨æŠŠçƒŸç­äº† 3 Whatâ€™s he eating ä»–åœ¨åƒä»€ä¹ˆ 4 This is exciting è¿™ä¸ªå¥½åˆºæ¿€ 5 I was putting on my jacket æˆ‘å½“æ—¶åœ¨ç©¿å¤¹å…‹ 6 He keeps putting it off ä»–ä¸€ç›´åœ¨æ‹–å»¶ Jun 6th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 They arenâ€™t coming, are theyï¼Ÿ ä»–ä»¬ä¸å›æ¥äº†ï¼Œå¯¹å§ï¼Ÿ 2 She couldnâ€™t have done that ä»–ä¸ä¼šåšé‚£æ ·çš„äº‹çš„ 3 She would have asked for permission ä»–æœ¬æ¥å¯ä»¥å…ˆå¾æ±‚è®¸å¯çš„ 4 I would have done it differently å¦‚æœæ˜¯æˆ‘æˆ‘ä¸ä¼šè¿™ä¹ˆåš 5 Itâ€™d been done before æ—©å°±æœ‰äººåšè¿‡äº† 6 You shouldnâ€™t have said anything ä½ æœ¬æ¥ä»€ä¹ˆéƒ½ä¸åº”è¯¥è®²çš„ Jun 7th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Where have you been ? ä½ åˆ°å“ªå»äº†ï¼Ÿ 2 Why are you so annoying? ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆç”Ÿæ°”ï¼Ÿ 3 Doesnâ€™t he know ä»–ä¸çŸ¥é“å—ï¼Ÿ 4 When have you ever cared about me? ä½ ä»€ä¹ˆæ—¶å€™åœ¨ä¹è¿‡æˆ‘ï¼Ÿ 5 She would told me if she could å¦‚æœå¯ä»¥çš„è¯å¥¹ä¸€å®šä¼šå‘Šè¯‰æˆ‘çš„ 6 He wasnâ€™t even here when it happened äº‹æƒ…å‘ç”Ÿçš„æ—¶å€™ä»–ä¸åœ¨è¿™é‡Œ Jun 8th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 You need not have done that ä½ ä¸éœ€è¦åšé‚£ä»¶äº‹ 2 They havenâ€™t had a chance ä»–ä»¬ä¸€ç›´æ²¡æœ‰æœºä¼š 3 It will do for now æš‚æ—¶è¿™æ ·å°±å¯ä»¥äº† 4 It couldnâ€™t have been him ä¸å¯èƒ½æ˜¯ä»– 5 Whereâ€™s our food æˆ‘ä»¬çš„åƒçš„åœ¨å“ª 6 He wouldnâ€™t have done that to you [å¦‚æœæ˜¯ä»–]ä»–ä¸ä¼šå¯¹ä½ è¿™ä¹ˆåšçš„ Jun 9th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 It had better be good æœ€å¥½æ˜¯å¥½äº‹ 2 Where has she beenï¼Ÿ å¥¹åˆ°å“ªå»äº† 3 It would be nice if you could cut me some slack ä½ è¦æ˜¯å¯¹æˆ‘è¦æ±‚æ¾ä¸€ç‚¹å°±å¥½äº† 4 It couldnâ€™t have been her ä¸å¯èƒ½æ˜¯å¥¹ 5 There is a good restaurant on the corner è¡—è§’æœ‰ä¸€å®¶å¥½åƒçš„é¥­åº— 6 When have I ever led you wrong? æˆ‘ä»€ä¹ˆæ—¶å€™å¸¦ä½ èµ°è¿‡å¼¯è·¯ Jun 13th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Who did you talk to? ä½ å’Œè°è¯´è¿‡äº† 2 What did you do? ä½ åšäº†ä»€ä¹ˆ 3 When did you go? ä½ æ˜¯ä»€ä¹ˆæ—¶å€™å»çš„ 4 Where did you put it? ä½ æ”¾å“ªå„¿å»äº† 5 Why did you do that ? ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆåšäº† 6 How did you do that? ä½ æ˜¯æ€ä¹ˆåšåˆ°çš„ Jun 14th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 Who do you talk to? ä½ å¹³æ—¶å’Œè°è¯´å•Š 2 What do you do? ä½ æ˜¯åšä»€ä¹ˆçš„ 3 When do you go? ä½ ä»€ä¹ˆæ—¶å€™è¦å» 4 Where do you put it? ä½ å¹³æ—¶æ”¾å“ª 5 Why do you do that ? ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆåš 6 How do you do that? è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„ Jun 15th åºå· å¥å­ ç¿»è¯‘ è¿è¯»éŸ³æ ‡ 1 You got to get ahead ä½ å¾—æƒ³åŠæ³•å‡ºäººå¤´åœ° 2 I wanted to talk about the future æˆ‘æƒ³èŠèŠæœªæ¥ 3 I donâ€™t know if thatâ€™s good idea æˆ‘ä¸çŸ¥é“é‚£æ˜¯ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ 4 You should come to the party ä½ åº”è¯¥å‚åŠ é‚£ä¸ªèšä¼š 5 Let me give it a shot è®©æˆ‘è¯•ä¸€è¯• 6 You want to give me a crack at it è®©æˆ‘è¯•è¯•å¥½å—","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"English","slug":"Life/English","permalink":"https://dayarch.top/categories/Life/English/"}],"tags":[{"name":"English","slug":"English","permalink":"https://dayarch.top/tags/English/"}]},{"title":"SpringMVCä¹‹RequestMappingæ³¨è§£","slug":"SpringMVCä¹‹RequestMappingæ³¨è§£","date":"2016-01-26T02:49:59.000Z","updated":"2019-12-19T13:34:55.755Z","comments":true,"path":"/p/springmvc-requestmapping-annotation.html","link":"","permalink":"https://dayarch.top/p/springmvc-requestmapping-annotation.html","excerpt":"SpringMVCä¹‹RequestMappingæ³¨è§£ ä»€ä¹ˆæ˜¯RequestMappingæ³¨è§£ åœ¨SpringMVCçš„APIä¸­æˆ‘ä»¬å‘ç°å¯¹@interface RequestMapping æœ‰å¦‚ä¸‹çš„å®šä¹‰ï¼š *Annotation for mapping web requests onto specific handler classes and/or handler methods. Provides a consistent style between Servlet and Portlet environments, with the semantics adapting to the","text":"SpringMVCä¹‹RequestMappingæ³¨è§£ ä»€ä¹ˆæ˜¯RequestMappingæ³¨è§£åœ¨SpringMVCçš„APIä¸­æˆ‘ä»¬å‘ç°å¯¹@interface RequestMapping æœ‰å¦‚ä¸‹çš„å®šä¹‰ï¼š *Annotation for mapping web requests onto specific handler classes and/or handler methods. Provides a consistent style between Servlet and Portlet environments, with the semantics adapting to the concrete environment. * ç¿»è¯‘è¿‡æ¥çš„æ„æ€å°±æ˜¯é€šè¿‡åœ¨åœ¨ç±»å’Œæ–¹æ³•ä¸Šçš„é™åˆ¶æ¥åŒ¹é…request RequestMappingçš„å‡ å¤§å±æ€§åœ¨Spring4.2.4çš„APIä¸­å‘ç°RequestMappingæœ‰å…«å¤§å±æ€§æ¥mappingURLè¯·æ±‚ value *In a Servlet environment this is an alias for path(). For example @RequestMapping(â€œ/fooâ€) is equivalent to @RequestMapping(path=â€/fooâ€). *åœ¨Servletä¸­valueå°±æ˜¯è¡¨ç¤ºpathï¼Œè¡¨ç¤ºè¯·æ±‚çš„è·¯å¾„çš„mapping, æ”¯æŒé€šé…ç¬¦å½¢å¼ method The HTTP request methods to map to, narrowing the primary mapping: *GET, POST, HEAD, OPTIONS, PUT, PATCH, DELETE, TRACE. ***Httpè¯·æ±‚ä¸­æœ‰ä»¥ä¸Šå‡ ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŠ å…¥methodæ¥é™åˆ¶mappingèŒƒå›´ params Same format for any environment: a sequence of â€œmyParam=myValueâ€ style expressions, with a request only mapped if each such parameter is found to have the given value. Expressions can be negated by using the â€œ!=â€ operator, as in â€œmyParam!=myValueâ€. â€œmyParamâ€ style expressions are also supported, with such parameters having to be present in the request (allowed to have any value). Finally, â€œ!myParamâ€ style expressions indicate that the specified parameter is not supposed to be present in the request. *è¯·æ±‚å‚æ•°ä¸­å¿…é¡»æœ‰key*ç­‰äºæŸä¸ªvalueæˆ–è€…keyå¿…é¡»ä¸ç­‰äºæŸä¸ªvalueï¼Œå¤šä¸ªæ¡ä»¶æ˜¯ä¸**çš„å…³ç³»ã€‚ headers Same format for any environment: a sequence of â€œMy-Header=myValueâ€ style expressions, with a request only mapped if each such header is found to have the given value. Expressions can be negated by using the â€œ!=â€ operator, as in â€œMy-Header!=myValueâ€. â€œMy-Headerâ€ style expressions are also supported, with such headers having to be present in the request (allowed to have any value). Finally, â€œ!My-Headerâ€ style expressions indicate that the specified header is not supposed to be present in the request. Also supports media type wildcards (), for headers such as Accept and Content-Type. For instance,will match requests with a Content-Type of â€œtext/htmlâ€, â€œtext/plainâ€, etc. *å’Œparamså±æ€§ç±»ä¼¼ï¼Œæ”¯æŒé€šé…ç¬¦åŒ¹é…ã€‚ 1@RequestMapping(value = \"/something\", headers = \"content-type=text/*\") name Assign a name to this mapping. Supported at the type level as well as at the method level! When used on both levels, a combined name is derived by concatenation with â€œ#â€ as separator.ç»™mappingå‘½åï¼Œæ”¯æŒåœ¨ç±»å’Œæ–¹æ³•ä¸Šä½¿ç”¨è¯¥å±æ€§ï¼Œè”åˆèµ·æ¥çš„nameç”¨#æ¥åˆ†éš” consumes *The consumable media types of the mapped request, narrowing the primary mapping. The format is a single media type or a sequence of media types, with a request only mapped if the Content-Type matches one of these media types. Examples: consumes = &quot;text/plain&quot; consumes = {&quot;text/plain&quot;, &quot;application/*&quot;} *Expressions can be negated by using the â€œ!â€ operator, as in â€œ!text/plainâ€, which matches all requests with a Content-Type other than â€œtext/plainâ€. *consumesæ•°ç»„é‡Œé¢å¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ï¼Œåªè¦åŒ¹é…åˆ°ä»–ä»¬å…¶ä¸­ä¸€ä¸ªå³å¯ã€‚ produces he producible media types of the mapped request, narrowing the primary mapping. The format is a single media type or a sequence of media types, with a request only mapped if the Accept matches one of these media types. Examples: produces = &quot;text/plain&quot; produces = {&quot;text/plain&quot;, &quot;application/*&quot;} produces = &quot;application/json; charset=UTF-8&quot; *It affects the actual content type written, for example to produce a JSON response with UTF-8 encoding, â€œapplication/json; charset=UTF-8â€ should be used. Expressions can be negated by using the â€œ!â€ operator, as in â€œ!text/plainâ€, which matches all requests with a Accept other than â€œtext/plainâ€. *æŒ‡å®šè¿”å›çš„å†…å®¹ç±»å‹ï¼Œä»…å½“requestè¯·æ±‚å¤´ä¸­çš„(Accept)ç±»å‹ä¸­åŒ…å«è¯¥æŒ‡å®šç±»å‹æ‰è¿”å› path In a Servlet environment only: the path mapping URIs (e.g. â€œ/myPath.doâ€). Ant-style path patterns are also supported (e.g. â€œ/myPath/.doâ€). At the method level, relative paths (e.g. â€œedit.doâ€) are supported within the primary mapping expressed at the type level. Path mapping URIs may contain placeholders (e.g. â€œ/${connect}â€) * ä»¥ä¸Šæ‰€æœ‰å±æ€§éƒ½æ˜¯æ¥é™åˆ¶mappingè¦æ±‚çš„ï¼Œä½†æ˜¯å¸¸ç”¨çš„æ˜¯paramsã€methodã€consumes. éªŒè¯å±æ€§ valuevalueæ”¯æŒé€šé…ç¬¦çš„è¡¨ç°å½¢å¼, ?è¡¨ç¤ºåŒ¹é…æ–‡ä»¶åä¸­çš„ä¸€ä¸ªå­—ç¬¦, * è¡¨ç¤ºåŒ¹é…ä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦, ** è¡¨ç¤ºåŒ¹é…å¤šå±‚è·¯å¾„çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦, @PathVariableç®—æ˜¯URLå‚æ•°çš„å ä½ç¬¦ã€‚ @RequestMapping(value=&quot;/?/testValue1/{id}&quot;) public String testValue1(@PathVariable(&quot;id&quot;) String id){ System.out.println(&quot;valueæµ‹è¯•&quot; + id); return SUCCESS; } URL: http://localhost:8080/springMVC1/demo/a/testValue1/28Result: valueæµ‹è¯•28 ç°åœ¨æˆ‘ä»¬é‡åˆ°ä¸€ç§æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬çš„idæ˜¯1.2.0007.9 è¿™ç§ç±»å‹çš„å­—ç¬¦ï¼Œå¦‚æœåœ¨è¿˜å‘ä¸Šé¢é‚£æ ·æ¥ä¼ å‚æ•°åªä¼šçš„åˆ°1.0è¿™æ ·çš„ç»“æœï¼Œäºæ˜¯æˆ‘ä»¬éœ€è¦ç”¨åˆ°æ­£åˆ™è¡¨è¾¾å¼ï¼š @RequestMapping(value=&quot;/?/testValue1/{idï¼š.*}&quot;) public String testValue1(@PathVariable(&quot;id&quot;) String id){ System.out.println(&quot;valueæµ‹è¯•&quot; + id); return SUCCESS; } å†™æˆ{id:.*} æˆ– {id:.+} éƒ½å¯ä»¥ã€‚ methodjspéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š &lt;dl&gt; &lt;dt&gt;Test method&lt;/dt&gt; &lt;dd&gt; &lt;a href=&quot;demo/testMethod_GET&quot;&gt;Method_GET&lt;/a&gt; &lt;/dd&gt; &lt;dd&gt; &lt;form action=&quot;demo/testMethod_POST&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Method_POST&quot;/&gt; &lt;/form&gt; &lt;/dd&gt; &lt;dd&gt; &lt;form action=&quot;demo/testMethod_DELETE&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;DELETE&quot;/&gt; &lt;input type=&quot;submit&quot; value=&quot;Method_DELETE&quot;/&gt; &lt;/form&gt; &lt;/dd&gt; &lt;dd&gt; &lt;form action=&quot;demo/testMethod_PUT&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;_method&quot; value=&quot;PUT&quot;/&gt; &lt;input type=&quot;submit&quot; value=&quot;Method_PUT&quot;/&gt; &lt;/form&gt; &lt;/dd&gt; &lt;/dl&gt;GETå’ŒPOSTæ–¹æ³•å¾ˆå¥½ç†è§£ï¼Œå¯æ˜¯åœ¨DELETEæ–¹æ³•å’ŒPUTæ–¹æ³•ä¸­æˆ‘ä»¬å´åŠ å…¥äº†ä¸€ä¸ªhiddenç±»å‹çš„inputï¼Œå€¼åˆ†åˆ«ä¸ºDELETEå’ŒPUTï¼Œä¸ºä»€ä¹ˆè¦åŠ è¿™ä¸ªéšè—åŸŸï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹Springä¸­org.springframework.web.filter.HiddenHttpMethodFilterç±»çš„ä¸€æ®µæºç ï¼š public static final String DEFAULT_METHOD_PARAM = &quot;_method&quot;; private String methodParam = DEFAULT_METHOD_PARAM; @Override protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)throws ServletException, IOException { String paramValue = request.getParameter(this.methodParam); if (&quot;POST&quot;.equals(request.getMethod()) &amp;&amp; StringUtils.hasLength(paramValue)) { String method = paramValue.toUpperCase(Locale.ENGLISH); HttpServletRequest wrapper = new HttpMethodRequestWrapper(request, method); filterChain.doFilter(wrapper, response); } else { filterChain.doFilter(request, response); } }è¿™æ®µä»£ç çš„ä¸»è¦æ„æ€å°±æ˜¯å¦‚æœ_methodä¸­å­˜åœ¨å€¼ï¼Œå¹¶ä¸”æ˜¯postæ–¹æ³•ï¼Œé‚£æˆ‘ä»¬çš„servletå¯¹è¿™ä¸ªæ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œä¸ºäº†å®Œæˆè¿™ä¸ªåŠŸèƒ½æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥åœ¨web.xmlä¸­é…ç½®è¿™ä¸ªorg.springframework.web.filter.HiddenHttpMethodFilterï¼Œå¦‚ä¸‹ï¼š &lt;!-- org.springframework.web.filter.HiddenHttpMethodFilter å¯ä»¥å°†postè¯·æ±‚è½¬ä¸ºPUTå’ŒDELETEè¯·æ±‚ --&gt; &lt;filter&gt; &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.HiddenHttpMethodFilter&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt;ç°åœ¨æˆ‘ä»¬æ¥çœ‹JAVAåå°controllerä¸­çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š @RequestMapping(value=&quot;/testMethod_GET&quot;, method=RequestMethod.GET) public String testMethod_GET(){ System.out.println(&quot;This is GET method&quot;); return SUCCESS; } @RequestMapping(value=&quot;/testMethod_POST&quot;,method=RequestMethod.POST) public String testMethod_POST(){ System.out.println(&quot;This is POST method&quot;); return SUCCESS; } @RequestMapping(value=&quot;/testMethod_DELETE&quot;, method=RequestMethod.DELETE) public String testMethod_DELETE(){ System.out.println(&quot;This is DELETE method&quot;); return SUCCESS; } @RequestMapping(value=&quot;/testMethod_PUT&quot;, method=RequestMethod.PUT) public String testMethod_PUT(){ System.out.println(&quot;This is PUT method&quot;); return SUCCESS; } paramsjspéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š &lt;dl&gt; &lt;dt&gt;Test params&lt;/dt&gt; &lt;dd&gt; &lt;a href=&quot;demo/testParams?username&amp;age=10&quot;&gt;testParams&lt;/a&gt; &lt;/dd&gt; &lt;/dl&gt;Javaçš„Controllerä»£ç å¦‚ä¸‹ï¼š @RequestMapping(value=&quot;/testParams&quot;, params={&quot;username&quot;,&quot;age!=0&quot;}) public String testParams(){ System.out.println(&quot;testParams&quot;); return SUCCESS; }params={â€œusernameâ€,â€age!=0â€}ä»£è¡¨è¯·æ±‚å‚æ•°ä¸­å¿…é¡»æœ‰usernameå’Œageè¿™ä¸¤ä¸ªå‚æ•°ï¼ŒåŒæ—¶ageä¸èƒ½ç­‰äº0. headersheaderså±æ€§åŒparamsç±»ä¼¼ï¼Œéƒ½æ˜¯å¯ä»¥ä»¥æ•°ç»„çš„å½¢å¼æ¥è¿›è¡Œçº¦æŸã€‚éœ€è¦ä»€ä¹ˆæ ·çš„è¯·æ±‚å‚æ•°å¯ä»¥é€šè¿‡å¼€å‘è€…å·¥å…·æ¥æŸ¥çœ‹è¯·æ±‚ä¸­éƒ½æœ‰ä»€ä¹ˆæ ·çš„å‚æ•°ã€‚","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Spring-Boot","slug":"Coding/Spring-Boot","permalink":"https://dayarch.top/categories/Coding/Spring-Boot/"}],"tags":[{"name":"æ³¨è§£","slug":"æ³¨è§£","permalink":"https://dayarch.top/tags/%E6%B3%A8%E8%A7%A3/"},{"name":"annotation","slug":"annotation","permalink":"https://dayarch.top/tags/annotation/"}]},{"title":"Maven Project","slug":"Maven-Project","date":"2016-01-21T09:28:06.000Z","updated":"2019-11-01T09:05:15.895Z","comments":true,"path":"/p/maven-project-structure.html","link":"","permalink":"https://dayarch.top/p/maven-project-structure.html","excerpt":"åˆ›å»ºMaven Web Project ä»€ä¹ˆæ˜¯Maven åœ¨Apache Maven å®˜ç½‘ä¸Šçš„è¯´æ˜æ˜¯ï¼šApache Maven is a software project management and comprehension tool. Based on the concept of a project object model (POM), Maven can manage a projectâ€™s build, reporting and documentation from a central piece of information. ç¿»è¯‘è¿‡æ¥çš„åŸºæœ¬æ„æ€å°±æ˜¯ï¼šMavenæ˜¯åŸºäºé¡¹","text":"åˆ›å»ºMaven Web Project ä»€ä¹ˆæ˜¯Mavenåœ¨Apache Maven å®˜ç½‘ä¸Šçš„è¯´æ˜æ˜¯ï¼šApache Maven is a software project management and comprehension tool. Based on the concept of a project object model (POM), Maven can manage a projectâ€™s build, reporting and documentation from a central piece of information. ç¿»è¯‘è¿‡æ¥çš„åŸºæœ¬æ„æ€å°±æ˜¯ï¼šMavenæ˜¯åŸºäºé¡¹ç›®å¯¹è±¡æ¨¡å‹(POM)ï¼Œå¯ä»¥é€šè¿‡ä¸€å°æ®µæè¿°ä¿¡æ¯æ¥ç®¡ç†é¡¹ç›®çš„æ„å»ºï¼ŒæŠ¥å‘Šå’Œæ–‡æ¡£çš„è½¯ä»¶é¡¹ç›®ç®¡ç†å·¥ å…·ã€‚ ä½¿ç”¨Mavenç®¡ç†é¡¹ç›®çš„å¥½å¤„ å¯¹ç¬¬ä¸‰æ–¹ä¾èµ–åº“è¿›è¡Œç»Ÿä¸€çš„ç‰ˆæœ¬ç®¡ç†ã€‚ åªè¦ç”¨äº†Mavenå°±ä¸ç”¨å†ä¸ºæ¯ä¸ªé¡¹ç›®å¤åˆ¶spring.jarå’Œhibernate.jaräº†ï¼ŒMavenä¼šåœ¨ä½ éœ€è¦çš„æ—¶å€™ï¼Œè‡ªåŠ¨æŠŠè¿™äº›ç¬¬ä¸‰æ–¹ä¾èµ–åº“æ‰¾åˆ°ï¼Œä½ éœ€è¦ç¼–è¯‘ï¼ŒMavenå°±æŠŠè¿™äº›jaråŒ…æ”¾åˆ°classpathé‡Œï¼Œä½ éœ€è¦æ‰“åŒ…ï¼ŒMaven2å°±å¸®ä½ æŠŠéœ€è¦çš„jaråŒ…éƒ½å¤åˆ¶åˆ°WEB- INF/lib/ç›®å½•ä¸‹ã€‚ ç»Ÿä¸€é¡¹ç›®çš„ç›®å½•ç»“æ„ å¯ä»¥ä¿è¯æ‰€æœ‰é¡¹ç›®çš„ç›®å½•ç»“æ„éƒ½æ˜¯ä¸€æ ·çš„ï¼Œç›®å½•ç»“æ„ç»Ÿä¸€çš„å¥½å¤„å°±æ˜¯ï¼Œä½ è¦æ‰¾æºä»£ç å°±å»src/main/java/ä¸‹ï¼Œä½ è¦æ‰¾éœ€è¦æ”¾åˆ°classpathä¸‹çš„èµ„æºï¼Œå°±å»src/main/resources/ä¸‹ï¼Œä½ è¦æ‰¾å•å…ƒæµ‹è¯•å¯¹åº”çš„ä»£ç å’Œèµ„æºï¼Œå°±å»src/test/ä¸‹ã€‚æ¯ä¸ªç›®å½•ä¸‹æ”¾ä»€ä¹ˆä¸œè¥¿ï¼Œç¨‹åºç¼–è¯‘ï¼Œå‘å¸ƒçš„æ—¶å€™ï¼Œæ¯ä¸ªç›®å½•èµ·ä»€ä¹ˆä½œç”¨éƒ½å¾ˆæ¸…æ¥šæ˜äº†ï¼Œä¸ä¼šå‡ºç°æ‰“å¼€é¡¹ç›®æ‰¾ä¸åˆ°è¦æ‰¾çš„æ–‡ä»¶çš„æƒ…å†µã€‚ ç»Ÿä¸€è½¯ä»¶æ„å»ºé˜¶æ®µ Maven2æŠŠè½¯ä»¶å¼€å‘çš„è¿‡ç¨‹åˆ’åˆ†æˆäº†å‡ ä¸ªç»å…¸é˜¶æ®µï¼Œæ¯”å¦‚ä½ å…ˆè¦ç”Ÿæˆä¸€äº›javaä»£ç ï¼Œå†æŠŠè¿™äº›ä»£ç å¤åˆ¶åˆ°ç‰¹å®šä½ç½®ï¼Œç„¶åç¼–è¯‘ä»£ç ï¼Œå¤åˆ¶éœ€è¦æ”¾åˆ° classpathä¸‹çš„èµ„æºï¼Œå†è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œå•å…ƒæµ‹è¯•éƒ½é€šè¿‡äº†æ‰èƒ½è¿›è¡Œæ‰“åŒ…ï¼Œå‘å¸ƒã€‚ æ”¯æŒå¤šç§æ’ä»¶ åœ¨http://maven.apache.com/å’Œhttp://mojo.codehaus.org/ä¸Šå¯ä»¥æ‰¾åˆ°å¤§é‡çš„Maven2æ’ä»¶ï¼Œé€šè¿‡è¿™äº›æ’ä»¶å¯ä»¥å®Œæˆå¤šç§å¤šæ ·çš„æ‰©å±•åŠŸèƒ½ã€‚ ä»¥ä¸Šåªæ˜¯æ¦‚å¿µæ€§çš„ä¸œè¥¿ï¼Œé™†ç»­ä¼šç”¨å®ä¾‹è¯æ˜ä»¥ä¸Šå¥½å¤„ ä¸‹è½½åŠå®‰è£…Maven è®¿é—®Maven ä¸‹è½½ï¼š ä»¥Windows ç¯å¢ƒä¸ºä¾‹ï¼Œå°†ä¸‹è½½çš„apache-maven-3.3.9-bin.zip è§£å‹åˆ°æŸä¸€ç£ç›˜ç›®å½•ä¸‹ï¼Œapache-maven-3.3.9 ä½œä¸ºMAVEN_HOME ç›®å½•ï¼Œ æ–°å»ºæœ¬åœ°Mavenä»“åº“ï¼ˆRepositoryï¼‰ï¼Œç¼–è¾‘apache-maven-3.3.9\\conf\\setting.xml æ–‡ä»¶ï¼Œåœ¨æœ¬åœ°å»ºç«‹ä»“åº“ï¼ˆä»»æ„ä¸€æ¬¡ç›˜æ–‡ä»¶å¤¹ä¸‹å³å¯ï¼‰ ç¯å¢ƒå˜é‡å¯é…ç½®ä¹Ÿå¯ä¸é…ç½®ï¼Œå¦‚æœç”¨åˆ°å‘½ä»¤è¡Œå¿…é¡»è¦é…ç½®ç¯å¢ƒå˜é‡ã€‚ æ–°å»ºç³»ç»Ÿå˜é‡MAVEN_HOME, å¹¶æŒ‡å®šç›®å½•ï¼šE:\\Java_Web\\apache-maven-3.3.9-bin\\apache-maven-3.3.9 ç¼–è¾‘ç³»ç»Ÿå˜é‡Pathï¼Œå¢åŠ %MAVEN_HOME%\\bin; å‘½ä»¤è¡Œä¸‹ï¼ˆcmdï¼‰æ£€æµ‹Maven ç‰ˆæœ¬ï¼š mvn -v Eclipseä¸‹é…ç½®Maven ç°åœ¨æ–°ç‰ˆæœ¬çš„Eclipseå·²ç»é›†æˆäº†Mavenæ’ä»¶ï¼Œåœ¨Windows-Preferences-MavenèŠ‚ç‚¹ä¸‹çš„Installationsæ·»åŠ Maven, æœ€åå‹¾é€‰ä¸Šæ·»åŠ çš„Mavenã€‚ åœ¨Windows-Preferences-MavenèŠ‚ç‚¹ä¸‹çš„User Settingè®¾ç½®setting.xml æ–‡ä»¶ ### æ–°å»ºMaven Web Project é¼ æ ‡é‚®ä»¶New Maven Project é€‰æ‹©Artifact ID å¡«å†™required text pom.xml ä¸Šé¼ æ ‡é‚®ä»¶run as Maven install, ä¼šå‘ç°å…³äºè¿™ä¸ªé¡¹ç›®çš„waråŒ…åœ¨Mavenä»“åº“ä¸­å·²ç»ç”Ÿæˆ å¸¸ç”¨MVNå‘½ä»¤ mvn help:system è‡ªåŠ¨åœ¨æœ¬ç”¨æˆ·ä¸‹åˆ›å»º ~/.m2/repository mvn clean compile æ¸…ç†ç¼–è¯‘ mvn clean test æ¸…ç†æµ‹è¯• mvn clean package æ¸…ç†æ‰“åŒ… mvn clean install æ¸…ç†å°†æ‰“åŒ…å¥½çš„jarå­˜å…¥ æœ¬åœ°ä»“åº“ æ³¨æ„æ˜¯æœ¬åœ°ä»“åº“ mvn archetype:generate ä½¿ç”¨Archetypeç”Ÿæˆé¡¹ç›®éª¨æ¶ mvn clean deploy æ ¹æ®pomä¸­çš„é…ç½®ä¿¡æ¯å°†é¡¹ç›®å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“ä¸­ Mavené¡¹ç›®ç›®å½•ç»“æ„è¯´æ˜ src/main/java :æ­£å¼å†…å®¹åŒ…è·¯å¾„ src/mian/resources :æ­£å¼çš„é…ç½®æ–‡ä»¶è·¯å¾„ src/test/java :æµ‹è¯•åŒ…è·¯å¾„ src/test/resources :æµ‹è¯•çš„é…ç½®æ–‡ä»¶è·¯å¾„ src/main/webapp : war èµ„æºç›®å½• æ›´å¤šæ›´å¤šå…³äºIntelliJ IDEA ä¸‹åˆ›å»ºMavené¡¹","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"DevOps","slug":"Coding/DevOps","permalink":"https://dayarch.top/categories/Coding/DevOps/"}],"tags":[{"name":"Maven","slug":"Maven","permalink":"https://dayarch.top/tags/Maven/"}]},{"title":"English","slug":"English","date":"2016-01-15T09:43:37.000Z","updated":"2019-11-01T08:39:34.656Z","comments":true,"path":"/p/spoken-english.html","link":"","permalink":"https://dayarch.top/p/spoken-english.html","excerpt":"è¿è¯» 1. Youâ€™re gonna wanna get more experiences before you apply before å¯ä»¥è¯»æˆ /b fÉ”r/ï¼Œ youå’Œapplyä¹‹é—´åŠ wçš„éŸ³ 2. I just wanted to have a look at her resume before you hired her wanted to è¯»æˆ /wa nI tÉ™/ï¼Œ nt+vowel,çœt wanted=/wÉ‘ntÉªd/=/wÉ‘nÉªd/, at her è¯»æˆ/Ã¦ dÉ™r/ hired her åŒç†ä¸å‘","text":"è¿è¯» Youâ€™re gonna wanna get more experiences before you apply before å¯ä»¥è¯»æˆ /b fÉ”r/ï¼Œ youå’Œapplyä¹‹é—´åŠ wçš„éŸ³ I just wanted to have a look at her resume before you hired her wanted to è¯»æˆ /wa nI tÉ™/ï¼Œ nt+vowel,çœt wanted=/wÉ‘ntÉªd/=/wÉ‘nÉªd/, at her è¯»æˆ/Ã¦ dÉ™r/ hired her åŒç†ä¸å‘hçš„éŸ³ *Give up or make decision because you canâ€™t have it both ways * give up or è¯»æˆ/gÉª vÊŒ pÉ™r/ , because è¯»æˆ/kÉ”z/, åŒæ—¶æ³¨æ„ canâ€™tå’Œcançš„è¯»éŸ³åŒºåˆ« Didnâ€™t it seem kinda cold last night Didnâ€™t it /dÉª dÉªn nÉª/ And your daddy didnâ€™t understandï¼Ÿ / É™ njÉ™r dÃ¦ di dÉª â€˜É™ nÊŒn dÉ™r sdÃ¦nd?/ How does he expect me to buy stuff / hÉ‘u dÊŒ ziks bekt mi dÉ™ bÉ‘i sdÊŒf?/ Youâ€™re probably gonna wanna train the new intern because he is hopeless** probableå¯ä»¥çœç•¥ä¸­é—´çš„bçš„éŸ³ /â€˜prÉ‘bÉ™li/ new internä¹‹é—´åŠ wçš„éŸ³ï¼Œ because he is /kÉ” zÉªs/ Look Iâ€™m really tired, so can we go home? look Iâ€™m /lÊŠ kai m/ Who else wants to see a movie? who else ä¸­é—´æœ‰wçš„éŸ³ see a ä¸­é—´æœ‰jçš„éŸ³ Oh,we do, but not just yet. /Ouwi dÂµ, bÊŒâ€™ nÉ‘â€™ dÊ’ÊŒ sjeâ€™/ But it wonâ€™t work out /bÊŒâ€™Éªâ€™ wounâ€™ wÉ™r kÉ‘uâ€™/ This might be a bad idea be a ä¸­é—´æœ‰jçš„éŸ³ ideaä¸­é—´ä¹Ÿæœ‰jçš„éŸ³ But Iâ€™m gonna do it anyway What if I had taken that job at Merrill Lynch? /wÊŒ dÉª fÉ‘i hÃ¦â€™ tei kÉªn Ã°Ã¦â€™ dÊ’É‘ bÃ¦â€™ meÉ™r rÉ™l lintÊƒ? / Well, why didnâ€™tyou take the job? /Wel wÉ‘i dÉª â€˜É™n tÊƒÂµ teik Ã°É™ dÊ’É‘b/ Do you not wanna be seen with me? /dÉ™ jÎ¼ nÉ‘â€™ wÉ‘ nÉ™bi sin wÉªÎ¸ mi?/ ** weâ€™renot gonna hide it anymore.** /wÉ™r nÉ‘â€™ gÊŒ nÉ™ hÉ‘i dÉª dÃ¦ ni mÉ”r / Here, let me give it a shot è®©æˆ‘è¯•ä¸€è¯• give it a shot /É¡Éª vÉª dÉ™ ÊƒÉ‘/ When are we gonna hang out? æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™å‡ºå»ç©ä¸€ç© when are we /we nar wi/ This isnâ€™t what I wanted wanted /wÉ‘nÉªd/ Matt canâ€™t be that fat, can he? é‡éŸ³ï¼š canâ€™tã€ thatï¼Œ can he /cÃ¦ni/ Itâ€™dâ€™ve been nice to go out today Itâ€™dâ€™ve = It would have /Iâ€™ dI dIv/ when am I going to get promoted when am I /we nÉ™ maÉª/ Is it a school night and she has a lot of homework to do? /Éª zÉª dÉ™ sguÉ™l nÉ‘iâ€™ É™n áµ—Êƒi hÃ¦ zÉ™ lÉ‘ dÉ™ houmwÉ™rk tÉ™ dÂµ/ Whenâ€™s her birthday? /wen tsÉ™r bÉ™rÎ¸ dei/ Would you give it a rest ä½ çœçœå§ï¼Œä¼‘æ¯ä¸€ä¸‹å§ï¼Œ ï¼ˆä¸è¦å–‹å–‹ä¸ä¼‘äº†ï¼Œèƒ½åœåœå—ï¼‰ He is gonna wish he was never born wish he /wÉªÊƒi/ æ­¤å¤„çœç•¥h could youâ€¦ hold out that ring and ask me to marry you? /kÊŠ dÊ’Âµâ€¦ houl dÉ‘uâ€™ Ã°Ã¦â€™ riÅ‹ Å‹É™nâ€¦ Ã¦s mi dÉ™ mÃ¦ rijÂµ?/ that å’¬èˆŒåœé¡¿ï¼Œç•¥è¯» How much is it? /hÉ‘u mÊŒ tÊƒÉª zÉªâ€™ ?/ é‡éŸ³åœ¨isä¸Š I thought that it mattered what I said or where I said it /É‘i Î¸É”â€™ Ã°Ã¦ dÉªâ€™ mÃ¦dÉ™rd wÊŒdÉ‘i sed, É”r weÉ™rrÉ‘ise dÉªâ€™/ He knows what itâ€™s about /hi nou zwÊŒ dÉªtsÉ™ bÉ‘uâ€™/ You wanted it to be a surprise. / jÂµ wanÉª dÉªâ€™ tÉ™ bi jÉ™ sÓ™â€™praiz / I never had a bike of my own /É‘ine vÉ™r hÃ¦ dÉ™ bÉ‘i kÉ™ mÉ‘i Ê²oun / Not really, I got to drag him around, too! / nÉ‘â€™rÉªlli, É‘i gÉ‘â€™ tÉ™ drÃ¦g hÉª mÉ™ rÉ‘unâ€™ tÂµ! / (æ³¨æ„æ˜¯gÉ‘â€™ tÉ™ï¼Œ è¡¨ç¤ºâ€œæˆ‘ä¹Ÿæœ‰æ‹–ç€ä»–è·‘çš„â€ï¼Œ ä¸æ˜¯â€œæˆ‘å¾—æ‹–ç€ä»–è·‘â€) Iâ€™m sorry we canâ€™t store your childhood things anymore. /É‘im sÉ”r ri wi kÃ¦nâ€™ tsdÉ”r jÉ™r tÊƒÉ‘ild hÊŠâ€™ Î¸iÅ‹ ze nimÉ”r./ ** I used to love to play restaurant.** /É‘i jÂµs tÉ™ lÊŒv tÉ™ plei res dÉ™r rÉ”nâ€™/ Sheâ€™s not as pretty as she was when she was 29 /Êƒis nÉ‘ dÉ™z prÉª di Ê²Ã¦ Êƒi wÊŒz wen áµ—Êƒi wÊŒz twe ni nÉ‘in/ Ms. Greene would like to establish some ground rules before she comes out /mÉªs grin wÊŠâ€™ lÉ‘ik tÂµ Ê·Éªs dÃ¦blÉªÊƒ sÊŒm grÉ‘unâ€™ ruÉ™lz bÉ™ fÉ”r Êƒi kÊŒm zÉ‘uâ€™/ No, I love it.Thank you /nouÊ·É‘i lÊŒvÉªâ€™ Î¸Ã¦Å‹kjÂµ/ Now that youâ€™re a couple, we donâ€™t get two presents from you guys? /nÉ‘uÃ°Ã¦â€™ jÉ™r rÉ™ kÊŒpÉ™l, wi dounâ€™geâ€™ tÂµprezÉªnáµ—s frÊŒ mjÂµ gÉ‘iz?/ you have got to try this cheesecake /jÂµhÃ¦v gÉ‘â€™ tÉ™ trÉ‘i Ã°Éªs tÊƒiz keik / Somebody sent it to us /sÊŒmbÉ‘ di se nÉªâ€™ tÂµ Ê·ÊŒs/ Iâ€™ll be right with you /É‘lbi rÉ‘iâ€™ wÉª Î¸jÂµ / I was not staring at her /É‘iwÊŒz nÉ‘â€™ tsdeÉ™r riÅ‹ Å‹Ã¦â€™ hÉ™r/ In college, Ross used to wear leg warmers! / Éªn kÉ‘ lÉªdÊ’, rÉ”s jÂµs tÉ™ weÉ™r le gwÉ‘É™r mÉ™rz/ Monica couldnâ€™t tell time â€™til she was 13 /mÉ‘ nÉª kÉ™ kÊŠ â€˜É™n tel tÉ‘i mÊŒn tÉªl Êƒi wÊŒz Î¸É™r tin/ We used to be very close / wi jÂµs tÉ™ bi ve ri klous/ Itâ€™s not a big deal! /Éªts nÉ‘ dÉ™ bÉªâ€™ diÉ™l/ What did you say when you made up your vows? / wÊŒ dÉª dÊ’Âµ sei we njÂµ mei dÊŒâ€™ jÉ™r vÉ‘uz?/ I am supposed to be writing my vows and all I have is this! /É‘im sÊŒ pous tÉ™ bi rÉ‘i diÅ‹ mÉ‘i vÉ‘uz É™ nÉ‘l lÉ‘ihÃ¦v Éªz Ã°Éªs./ Those boots are amazing /Ã°ouz bÂµ tsÉ‘É™r rÉ™ mei ziÅ‹/ é‡‘ç‰ŒéŸ³æ ‡ /v/ åŒâ€œé£â€çš„å£å‹ï¼Œå–‰å’™éœ‡åŠ¨ never ever over very give have love everything every even move believe leave everybody haven live five everyone whatever drive leaving moving alive movie giving forever lovely given evening cover seven leaving loved voice above evil save government forgive private /Ã°/ èˆŒå¤´æ”¾åœ¨ä¸Šä¸‹é½¿ä¹‹é—´æˆ–è€…èˆŒå¤´é¡¶åœ¨ç‰™é½¿ä¸Šï¼Œå–‰å’™éœ‡åŠ¨ the than those that other this these there then they mother father another together brother though either rather others /Ê’/ /Êƒ/ è‹±æ–‡å•è¯ä»¥sion sure sual rsionä¸ºç»“å°¾çš„åŒ…å«Ê’éŸ³ï¼ŒåŒsheçš„å£å‹ï¼Œå˜Ÿèµ·å˜´å”‡ï¼Œå–‰å’™éœ‡åŠ¨, æ³¨æ„ä¸åŒäºæ±‰è¯­çš„â€œæ¹¿â€ conclusion confusion decision division occasion provision television visionexposure measure pleasure disclosure, enclosure, leisure, treasure*usual visual casual *aversion conversion dispersion immersion perversion versionaction cooperation inflation situation appreication /ai/ /au/ /n/ å‘/n/ èˆŒå¤´è¦è´´ä¸Šé¢š /ai/ é˜¿å§¨ behind bind blind wind find mind /au/ å•Šå±‹ /aun/ è”æƒ³â€œäº‘â€å­—bound hound count mount pound found down brown town downtown /â€˜É™n/ /É™/ å˜´å·´å…¨éƒ¨æ”¾æ¾å–‰å’™éœ‡åŠ¨ï¼Œ å¾ˆæ‡’å¾ˆæ”¾æ¾çš„â€œé¥¿â€ certain certainly fountain(å–·æ³‰ï¼Œæ³‰æ°´) mountain curtainï¼ˆçª—å¸˜ï¼‰ shorten written bitten gotten sweetenï¼ˆå‡è½»ï¼Œä½¿å˜ç”œï¼‰ forgottten kitten(å°çŒ«) mitten(æ‰‹å¥—)/tÉ™n/ é€šå¸¸drop t /â€˜É™l/ /É™/ å˜´å·´å…¨éƒ¨æ”¾æ¾å–‰å’™éœ‡åŠ¨ï¼Œ å¾ˆæ‡’å¾ˆæ”¾æ¾çš„â€œé¥¿â€ /l/ èˆŒå°–å‘ä¸Šå·ç¢°åˆ°ç‰™é½¿, å˜´å”‡ä¸åŠ¨ï¼Œ æ‹‰é•¿â€œæ¥¼â€çš„éŸ³ *people able pull bicycle table uncle principle deal heal meal rural actural formal legal * /r/ èˆŒå¤´å‘åä¸Šè½¬æ˜¯æ­£å¸¸çš„rï¼ˆåœ¨æœ«å°¾ï¼‰ åŠ¨ä½œå›å»å°±æ˜¯rçš„å¦ä¸€ä¸ªå‘éŸ³ï¼ˆåœ¨å¼€å¤´ï¼‰ï¼Œ é€šå¸¸r æ—¢åœ¨æœ«å°¾åˆè¦åœ¨å¼€å¤´éƒ½å‘éŸ³ï¼Œ å¦‚teacher is /titÊƒÉšr rIs/ råœ¨å¼€å¤´ï¼š rain ring read ride role roområœ¨æœ«å°¾: wider easier higher dear poker /t/ /d/ æ¸…è¾…éŸ³å’ŒæµŠè¾…éŸ³å°±æ˜¯å–‰å’™æœ‰æ²¡æœ‰éœ‡åŠ¨,ç”¨æ°”å¼¹é‚£ä¹ˆä¸€ä¸‹talked take top installed leged learnt student /ÊŠ/ ç±»ä¼¼äºâ€œé¥¿â€çš„è¯»éŸ³ï¼Œ ä½†æ˜¯æ²¡æœ‰â€œé¥¿â€è¿™ä¸ªéŸ³å–‰å’™é‚£ä¹ˆç”¨åŠ› good look book took hood cook could would should put /i/ /Éª/ å°†â€œå¶â€å­—åˆ†è§£. *it, fit hit bit itch(ç—’) lip sit * ç¾è¯­å£è¯­2016.3.2 Future WorldJ: ** Did u hear the Apple Pay is coming to China? It means we can *pay with our Iphone, isnâ€™t that nifty* pay with: ç”¨â€¦ æ”¯ä»˜; nifty: /â€˜nÉªfti/ X: Thatâ€™s pretty slick, who wouldâ€™ve thought that one day we could make payments with a mobile phone? Technology seems to make our lives better and better, what do u think the future has in store for us over the next 50 years slick ç­‰åŒ niftyï¼Œè¡¨ç¤ºé«˜ç§‘æŠ€çš„å°ç‰©ä»¶æ¯”è¾ƒé…·who wouldâ€™ve thought that one dayâ€¦ è°èƒ½æƒ³åˆ°æœ‰ä¸€å¤©â€¦sth has/have in store for ç­‰åŒäº sth will happen in the future J: I think *things** will continue to get smaller, Maybe one day our cellphone will be the size of a grain of rice* things æ—¥å¸¸çš„ä¸œè¥¿cellphone åœ¨ç¾å›½æ‰‹æœºç»å¸¸ç”¨è¿™ä¸ªè¯the size of a grain of rice ç±³ç²’å„¿ä¸€æ ·çš„å¤§å° X: * Thatâ€™d be pretty cool! Maybe it will be implanted in our bodies, weâ€™ll see a greater integration between man and machine* Thatâ€™d be pretty cool ä¸€ç§çŒœæµ‹ï¼Œè™šæ‹Ÿè¯­æ°”implant æ¤å…¥integration é›†æˆ ICå¡ï¼ˆIntegrated Circuit Cardï¼‰ J: I think VR(virtual reality) is the next big thing, I bet stem cell research will make great strides as well, maybe we can grow a new in the lab(laboratory) organ instead of transplanting some elseâ€™s the next big thing æˆä¸ºä¸»æµï¼Œsomething that is not popular now, but will be popular and mainstream in the futuremake great strides å–å¾—æ›´å¤§è¿›æ­¥stem cell å¹²ç»†èƒ X: Iâ€™d rather work than become a *couch potato*** couch potato æ²™å‘åœŸè±† æŒ‡æ‡’äºº 2016.3.7 Online LearningX: I thought you were supposed to have class now? what are you doing at your home? were supposed to æœ¬åº”è¯¥å¹²ä»€ä¹ˆå´æ²¡å¹² J: Iâ€™m having class, canâ€™t you see? have class ä¸Šè¯¾ X: What do you mean? youâ€™re at home on your computer what do you mean? ä»€ä¹ˆæ„æ€ï¼Ÿ æœŸå¾…å¯¹æ–¹ç»™äºˆç­”æ¡ˆon your computer é¢å¯¹ç”µè„‘. Iâ€™m on my computer æˆ‘æ­£åœ¨ç”¨ç”µè„‘. on the internet ä¸Šç½‘. Iâ€™m on the bus æˆ‘åœ¨å…¬äº¤è½¦ä¸Š J: Come on, *get with the times,** a lot of people are taking classes online now, itâ€™s perfect for workaholics(å·¥ä½œç‹‚) like me, not only that, you can go online and learn just about anything, right now, iâ€™m studying economics. The best thing is I can choose the time I want to study, the time isnâ€™t set in stone* get with the times è·Ÿä¸Šæ—¶ä»£çš„æ½®æµtake class = have class ä¸Šè¯¾ (where are you taking class? iâ€™m taking class online)not only that ä¸ä»…å¦‚æ­¤just about anything å‡ ä¹æ‰€æœ‰çš„äº‹æƒ…/ä¸œè¥¿ï¼Œ juståœ¨è¿™é‡ŒæŒ‡å‡ ä¹economy ç»æµ economics ç»æµå­¦ economist ç»æµå­¦å®¶set in stone è®¾ç½®åœ¨çŸ³å¤´ä¸Šï¼Œè¡¨ç¤ºâ€œå›ºå®š,æ°¸ä¹…ä¸å˜çš„â€ï¼Œ isnâ€™t set in stone ä¸å›ºå®š X: I had no idea that you could learn online have no idea æ˜¯å®Œå…¨ä¸çŸ¥é“ï¼Œ i donâ€™t know æœ‰æ—¶å€™è¿˜è¡¨ç¤ºä¸€äº›ä¸ç¡®å®šåœ¨é‡Œé¢ J: You should jump on the bandwagon and study online too jump on the bandwagon è·Ÿä¸Šæ½®æµ. keep up with trend, trendæœ¬èº«å°±æ˜¯ä¸€ä¸ªå¤§çš„è¶‹åŠ¿ï¼Œæ‰€ä»¥åƒä¸‡ä¸è¦å†™big trendï¼Œ ä»æ±‰è¯­çš„è§£é‡Šbigå°±æ˜¯ç´¯èµ˜ X: Iâ€™d love to, Maybe next semester I can pick some online classes, Right now my *thesis** is driving me bonkers* thesis /â€˜Î¸isÉªs/ æ¯”è¾ƒæ­£å¼çš„è®ºæ–‡drive me bonkers/nuts/crazy è®©æˆ‘æŠ“ç‹‚ J: What do you so stressed about? I thought you had the whole semester to get it done stress about æŠ“ç‹‚ï¼ˆä»€ä¹ˆä¸œè¥¿å‹ç€ä½ ï¼‰ X: Yeah, I did, but I procrastinated until the very last minute, Now iâ€™m paying the price procrastinate /proâ€™krÃ¦stÉªnet/ è€½æã€å»¶è¿Ÿpay the price ä»˜å‡ºä»£ä»· J: Just take it easy, Rome is not built in a day, you know? Rome is not built in a day ç½—é©¬ä¸æ˜¯ä¸€å¤©å»ºæˆçš„ J: * Good thing you are here, my computer crashed, now i canâ€™t boot it, I have to finish my homework by the end of the day, can you help me outï¼Œ Iâ€™m really pressed for time with this homework* good thing å¹¸äºï¼Œ ç±»ä¼¼äºthanks god.crashed å¯ä»¥è¡¨ç¤ºç”µè„‘æ­»æœºboot å¯åŠ¨ boot an electronic device (å¯åŠ¨ç”µå­è®¾å¤‡)by the end of the day æˆªæ­¢åˆ°ä»Šå¤©help me out å¸®æˆ‘æ¸¡è¿‡éš¾å…³/å›°éš¾pressed for time æ—¶é—´ç´§è¿« X: * You scratch my back, I will scratch your back, itâ€™s only fair* you scratch my back, iâ€™ll scratch your back ä½ æŒ æŒ æˆ‘éƒ½åèƒŒï¼Œæˆ‘æŒ æŒ ä½ çš„åèƒŒï¼ŒæŒ‡äº’å¸®äº’åŠ© J: Alright, you winï¼Œ It works, you really are *a Jack of all trades*** a Jack of all trades æŸäººå„ç§å·¥ä½œéƒ½å¹²å¾—å¾ˆå¥½ï¼Œä¸€ä¸ªä»€ä¹ˆéƒ½ä¼šåšçš„äºº è¡¨ç¤ºä»€ä¹ˆéƒ½ä¼š X: So you are gonna *renege on our deal? *thatâ€™s cold renege on our deal/go back on your words/go back on your promise åæ‚”thatâ€™s cold ä¸€ç§å¿ƒç†æè¿°ï¼Œ â€œå¤ªä¸é è°±äº†â€ å¿ƒç°æ„å†· 2016.3.10 Visiting a friend in the hospitalJ: What a pleasant surprise Iâ€™m so happy to see you è¡¨ç¤ºéå¸¸é«˜å…´ X: How ya doinâ€™, Sis? I thought Iâ€™d pay you a visit, I bet you are pretty lonely here in the hospital all by yourself How are you doing? åœ¨å£è¯­ä¸­å¯ä»¥è¯´ How ya doinâ€™, è¡¨ç¤ºé—®å€™â€œæ€ä¹ˆæ ·äº†â€pay a visit to sb = pay sb a visit (æ‹œè®¿æŸäºº) J: Thatâ€™s so sweet of you, my mom just left a few minutes ago, Iâ€™m surprised you didnâ€™t bump into her as you were coming up so sweet of you = so kind of you (ä½ çœŸå¥½)bump into sb (å¶ç„¶é‡åˆ°æŸäººï¼Œ å¼ºè°ƒå¶ç„¶æ€§) X: Oh rats, That wouldâ€™ve been great to catch up with her, I havenâ€™t seen her in ages, anyways, howâ€™d your operation go? oh rats çœŸå¯æƒœï¼Œå¾ˆå¯æƒœcatch up with sb (Talk with someone who you havenâ€™t seen in a long time å’Œå¾ˆä¹…æ²¡è§çš„äººå” å—‘èŠå¤©)I havenâ€™t see her in ages (æˆ‘å¥½ä¹…æ²¡è§åˆ°å¥¹äº†ï¼Œ long time no see)Howâ€™d (did) your operation/holiday/birthday go? (â€¦ è¿‡å¾—æ€ä¹ˆæ ·)ï¼Ÿ J: It was success, The doctor said I will be back to normal in no time, Although, iâ€™m feeling a little woozy(å¤´æ™•) from the anesthesia(éº»è¯) I will be back to normal in no time = Iâ€™ll get back on my feet soon = Iâ€™ll fully recover soonanesthesia /,Ã¦nÉ™sâ€™Î¸iÊ’É™/ éº»è¯ X: Thatâ€™s a relief, I wouldâ€™ve come earlier had I known Thatâ€™s a relief (é‚£æˆ‘å°±æ”¾å¿ƒäº†) J: Two days ago, I was helpig my mom do the dishes when I slipped and fell on my knee,Thankfully, we didnâ€™t have to call ambulance, my mom rushed me to the ER(emergency room) do the dishes æ´—ç¢—thankfully éå¸¸å¹¸è¿åœ°rush sb to smw = send sb smw quickly (é£é€Ÿçš„æŠŠæŸäººé€åˆ°æŸåœ°) X: Good thing your mom was there to help you out. I brought you some stuff to munch on, beef jerky, your favorite munch on = to snack on = to eatbeef jerky ç‰›è‚‰å¹² pork jerky çŒªè‚‰å¹² J: This will make me feel even better, I should stay in the hospital a little longer, I donâ€™t mind being pampered by you pamper /â€˜pÃ¦mpÉš/ to take really good care of someone ç²¾å¿ƒç…§æ–™ X: Is there anything I can do for you (å¸¸ç”¨å£è¯­ï¼Œ æˆ‘èƒ½ä¸ºä½ åšäº›ä»€ä¹ˆäº‹æƒ…å—)J: You can go pick up some medicine for me at drug store, take this prescription and get me three bottles of painkillers and three bottles of penicillin, The drug store is on the first floor to the left of entrance, on your way back, help me ask the nurse on duty, if Iâ€™ll be able to come home tomorrow drug store = pharmacy ï¼ˆè¯æˆ¿ï¼‰prescription å¤„æ–¹ï¼Œ painkiller æ­¢ç—›è¯ï¼Œ penicillin é’éœ‰ç´ The drug store is on the first floor to the left of entrance ï¼ˆæ³¨æ„æç»˜æ–¹ä½ï¼‰on your way back åœ¨ä½ å›æ¥çš„è·¯ä¸Šon duty å€¼ç­ 2016.3.14 Negotiating with LandlordsL: After seeing the apartment, are you satisfied with everything? be satisfied with å¯¹â€¦ æ»¡æ„look for a house/place æ‰¾æˆ¿å­ X: I think so, I just have a few questions if you donâ€™t mind if you donâ€™t mind å¦‚æœä½ ä¸ä»‹æ„ï¼Œä¸€ç§éå¸¸å®¢æ°”çš„è¯´æ³•ï¼Œå¯ä»¥æ”¾åœ¨å¥å­å¼€å¤´ä¹Ÿå¯ä»¥æ”¾åœ¨å¥å­æœ«å°¾ L: Okay, shoot shoot éå¸¸å£è¯­åŒ–çš„è¡¨è¾¾â€œè¯·ç›´è¯´ï¼Œä½†è¯´æ— å¦¨ï¼Œé—®å§â€ X: Iâ€™m on the fence about choosing the big room or the small room, they are both very nice Iâ€™m on the fence about sth/doing sth è¡¨ç¤ºâ€œä¸å¤§ç¡®å®šï¼Œè¿˜åœ¨çŠ¹è±«â€to sit on the fence â€œå¢™å¤´è‰â€œçš„æ„æ€ he is to sit on the fence L: If I were you, Iâ€™d pick the bigger room, itâ€™s closer to the bathroom and the view is facing the city, itâ€™s really the best of both worlds the view is facing the city çª—å­å†²ç€å¸‚åŒºæ™¯è‰²itâ€™s really the best of both worlds ä¸¤å…¨å…¶ç¾ X: Youâ€™re right, Iâ€™m a sucker for beautiful scenery, Okay, iâ€™m sold, the big room it is, whatâ€™s the next step? Iâ€™m a sucker for sth æˆ‘å¯¹â€¦ æ²¡æœ‰æŠµæŠ—åŠ›iâ€™m sold æˆ‘è¦äº†/æˆ‘ä¹°äº†the big room it is å°±æ˜¯è¿™ä¸ªå¤§æˆ¿é—´äº†ï¼Œ .. it is è¡¨ç¤ºå°±æ˜¯.. äº† Pizza it is å°±æ˜¯æŠ«è¨äº† L: If you are sure youâ€™d like to live here, we require that all of tenants sign a one year lease agreement, then I need your John Hancock here lease agreement ç§Ÿçº¦ï¼Œ é€šå¸¸è¿ç”¨John Hancock ç­¾å = autograph (æ‰€æœ‰ç­¾åçš„å•è¯éƒ½å¯ä»¥é€šç”¨åœ¨ä»»ä½•åœºåˆ) X: There you go, are we finished?L: Thatâ€™s it, here is your key, youâ€™re free to move in anytime, if you have any question, please give us a call and weâ€™ll glad to assit you move in æ¬è¿›æ¥ï¼Œå…¥ä½ L: Hello, Mr. Gao, how is the new apartment?X: Well.. itâ€™s great, but there is a slight problem slight problem å°é—®é¢˜ï¼Œä¸€ç§å§”å©‰çš„è¯´æ³• Lï¼š Whatâ€™s the matter?X: Thereâ€™s a huge pest(å®³è™«ã€è™«å­ã€æœ‰å®³ä¹‹ç‰©) problem in the kitchen, Iâ€™m worried that it might come into my room *L: *What kind of pests are we talking about?X: Roaches roach (èŸ‘è‚) å…¨ç¨‹cockroach L: Iâ€™m very sorry to hear that, have you tried cleaning the kitchen thoroughly(å½»åº•åœ°ï¼Œå®Œå…¨åœ°)X: Thatâ€™s why I came here, isnâ€™t there something that you can do?L: Iâ€™m afraid notX: But you are my landlord, I thought your slogan was â€œabove and beyond the call of dutyâ€ slogan å£å·above and beyond the call of duty ç«­å°½å…¨åŠ›åšæŸäº‹ï¼Œå…¨å¿ƒå…¨æ„åšæŸäº‹ L: You mustnâ€™t have read the fine print in the contract. it says here on line 217 that we are not responsible for any bug infestations fine print å°å­—ä½“ large print å¤§å­—ä½“infestation /ÉªnfÉ›sâ€™teÊƒÉ™n/ æ„ŸæŸ“ï¼Œä¾µæ‰° X: I seeï¼Œ in that case, Iâ€™ll have to hire a prefessional to get rid of the bugs in that case é‚£ä¹ˆï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹get rid of æ¸…é™¤.. 2016.3.16 House of CardsJ: Hi,Xiaogao, why do you have those bags under your eyes, have you not been sleeping well lately? bags under oneâ€™s eyes = to have dark shadows under oneâ€™s eyes, usually from a lack of sleep (ç”±äºç¡çœ ä¸è¶³å¯¼è‡´çš„é»‘çœ¼åœˆ) X: You can say that you can say that (ä½ å¯ä»¥è¿™ä¹ˆè¯´ï¼‰ ç­‰åŒäºyesï¼Œè¡¨ç¤ºè‚¯å®š J: Care to elaborate? care to elaborate = can you please explain? èƒ½è§£é‡Šä¸€ä¸‹å—ï¼Ÿ è¯¦ç»†è¯´è¯´ï¼Ÿ X: Iâ€™ve been binging on House of Cards lately, season 4 came out last week, and my eyes have been glued to the screen ever since binge on sth/doing sth = to over indulge in sth è¿‡æ¸¡åšæŸäº‹ï¼Œ è¿™é‡ŒæŒ‡ç–¯ç‹‚è¿½å‰§çº¸ç‰Œå±‹binge drinking (é…—é…’ï¼Œè±ªé¥®)come out ä¸Šæ˜ ï¼Œ å¤šç”¨äºå½±ç‰‡oneâ€™s eyes have been glued to the screen = to be infatuated with a movie or show to the point where you donâ€™t want to do anything çœ¼ç›è´´åœ¨å±å¹•ä¸Šäº†ï¼Œæ„æŒ‡æ²‰è¿·äºç”µå½±æˆ–ç”µè§†èŠ‚ç›®è€Œæ— å¿ƒåšå…¶ä»–äº‹ J: Season 4 is already out? I just remember just a few years ago when the first season came out back in early 2013. It seems like just yesterday It seems like just yesterday ï¼ˆused to refer to something that isstill fresh in oneâ€™s memoryï¼‰ æå¦‚æ˜¨æ—¥çš„æ„Ÿè§‰ X: Yeah, Iâ€™m hooked on it, I think it is so cool that Netflix was able to make such a successful online-only web television series, They really broke new grounds Be hooked on sth = to be addicted to sth æ²‰è¿·äºæŸäº‹ï¼Œä¸Šç˜¾hook uponline-only web television åªåœ¨ç½‘ç»œä¸Šæ’­æ”¾çš„ç½‘å‰§break new grounds ï¼ˆto accomplish something that hasnâ€™t been accomplished beforeï¼‰ å®Œæˆä»æœªè¢«å®Œæˆè¿‡çš„äº‹ï¼Œå¸¸æŒ‡å¼€åˆ›æ–°å±€é¢ J: Did you know the first season received nine prime time Emmy Award nominations, The whole world seems like to love this political drama receive .. award è·å¾—.. å¥–é¡¹political drama ï¼ˆA drama series that has a political backgroundï¼‰ æœ‰æ”¿æ²»èƒŒæ™¯çš„å‰§é›† X: I think Kevin Spacey and Robin Wrightâ€™s acting is outstanding! The first three seasons kept me on the edge of my seat during each episode. I love Neve Campbellâ€™s performance in season 4! Sheâ€™s one of my favorite actresses of all time. outstanding è¿™é‡ŒæŒ‡æ¼”æŠ€å‡ºç¥å…¥åŒ–ï¼Œå¾ˆæ£’[Something] keeps you on the edge of your seat = [something] is very suspenseful éå¸¸å…·æœ‰æ‚¬å¿µçš„æŸäº‹ è¿™é‡ŒæŒ‡å¾ˆåˆºæ¿€of all time ä¸€ç›´ä»¥æ¥ J: So, how is season 4? I heard there are some similarities(ç›¸ä¼¼ä¹‹å¤„) between season 4 and the American election campaign. Is that true?X: Thatâ€™s right! There certainly are parallelsï¼ˆç›¸ä¼¼ä¹‹å¤„ï¼‰ between season 4â€™s script and the 2016 primary campaign. Are you sure you want me to go into specifics? It might spoilï¼ˆå‰§é€ï¼‰ it for you? Go into specifics = talk about something in detail (è¯¦ç»†è¯´ï¼Œä»”ç»†è§£é‡Š) J: On second thought, I think youâ€™d better wait until I watch itmyself. on second thought ç»è¿‡å†ä¸€æ¬¡è€ƒè™‘ X: Well, all I can say is get ready for more suspense and nail-biting drama! Itâ€™s so fun to watch Frank Underwood climb up the ladder of power! all that I can say is = what I can say is ï¼ˆå…·ä½“æŸ¥çœ‹è¯­æ³•å®šè¯­ä»å¥ï¼‰nail-biting (å’¬æŒ‡ç”²ï¼ŒæŒ‡éå¸¸åˆºæ¿€çš„å‰§æƒ…)climb up the ladder = to ascend in rank, power, or status ï¼ˆå­—é¢çˆ¬ä¸Šæ¢¯å­ï¼Œæ„æŒ‡è¾¾åˆ°æŸç§æƒåŠ›) 2016.3.23 Artificial IntelligenceJï¼š I didnâ€™t know you played Go(å›´æ£‹)X: I donâ€™t, but I really wanna learn it, Did you hear about the amazing archievement of Googleâ€™s AI robot AplhaGo? hear about å¬è¯´archievement æˆå°±ï¼Œéå¸¸å¤§çš„è¯æ±‡ï¼Œè¡¨ç¤ºå¾ˆäº†ä¸èµ·çš„æˆæœ J: I heard about it, why are you so excited? *X: *Because itâ€™s the first AI program that could beat a professional player at the most complex board game mankindï¼ˆäººç±»ï¼‰ has ever created. board game æ£‹ç›˜æ¸¸æˆ J: I thought computers have been able to beat humans at chess for a long time, whatâ€™s the big deal? for a long time = in ageswhatâ€™s the big deal? æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œå¤šå¤§çš„äº‹ X: Youâ€™re right, but there is a huge difference between chess and Go, computers could easily beat humans because itâ€™s way less complicated. computers donâ€™t need to be smart to win at chess, they just need to be fast, a computer can use technique called brute forceto(BF) win at chess, this is not possible with Go, AlphaGo use reall AI called deep learning in order to solve problem. there is a huge difference between A and B (A å’Œ Bæœ‰å¾ˆå¤§çš„ä¸åŒ)way less complicated (æ­¤å¤„çš„wayç›¸å½“äºvery /much)deep learning (æ·±åº¦å­¦ä¹ )win at sth ï¼ˆèµ¢å¾—ä»€ä¹ˆ/å–èƒœï¼‰ J: I think I understand now, but why does this matter for mankind? why does this matter for mankind? (ä½†æ­¤äº‹ä¸ºä½•å¯¹äººç±»äº‹å…³é‡è¦ï¼Ÿ) X: such as complex weather conditions,disease control, and global warming issuesJ: I heard the AI robot only won 4 out of 5 matches. Does that mean that AI has room for improvement? 4 out of 5 äº”åˆ†ä¹‹å›› å››åˆ†ä¹‹ä¸‰ï¼šthree fourths= three quarters äº”åˆ†ä¹‹ä¸‰ï¼šthree fifths åˆ†æ•°çš„è¡¨è¾¾æ³•ï¼šåˆ†å­ç”¨åŸºæ•°è¯,åˆ†æ¯è¦ç”¨åºæ•°è¯,åˆ†å­å¤§äº1æ—¶,åˆ†æ¯çš„åºæ•°è¯ååŠ s.å¯¹äºå››åˆ†ä¹‹ä¸€,å¸¸ç”¨quarteræ¥è¡¨ç¤º.sth has room for improvement ï¼ˆsth è¿˜æœ‰è¿›æ­¥ç©ºé—´ï¼‰ X: Thatâ€™s right. The robot isnâ€™t perfect, but it certainly impressed the entire world. Some of AlphaGoâ€™s moves were described as â€œbeautifulâ€ by Go fans. sth impressed sb ï¼ˆ.. ç»™æŸäººç•™ä¸‹æ·±åˆ»å°è±¡ï¼‰AlphaGoâ€™s moves æ­¤å¤„çš„moveè¡¨ç¤ºæ£‹è·¯ J: This is getting scary. Are robots going to take over the world? take over (æ§åˆ¶/æ¥ç®¡) Xï¼š Although Googleâ€™s AI victory marked a major milestone for artificial intelligence, the world is still a long way away from mimicing true human intelligence. mark a major milestone (æ ‡è¯†ä¸€ä¸ªé‡è¦çš„é‡Œç¨‹ç¢‘)mimic /â€˜mÉªmÉªk/ vt. æ¨¡ä»¿ï¼Œæ‘¹æ‹ŸA long way away fromâ€¦ = ä¸â€¦å·®å¾—å¾ˆè¿œ 2016.3.28 HoroscopeJ: Weâ€™ve already talked about the first six zodiac signs, I think itâ€™s time we talk about the last six . Pop quiz first six å‰å…­ä¸ª last six åå…­ä¸ªpop quiz è€ƒè€ƒä½  X: These people love justice(å…¬æ­£) and fairnessï¼ˆå…¬å¹³ï¼‰ï¼Œ they also work well with other people work well with sb éå¸¸èæ´½çš„å’ŒæŸäººåˆä½œã€ é…åˆé»˜å¥‘ J: Libras are known to be cooperative(æœ‰åˆä½œç²¾ç¥çš„), they donâ€™t like violenceï¼ˆæš´åŠ›ï¼‰ or injusticeï¼ˆä¸å…¬æ­£ï¼‰ of any kind.X: Scorpios seem quiet and cool on the outside, but they are actually really emotional(å†…å¿ƒæ„Ÿæƒ…ä¸°å¯Œ) and passionate(å¯Œæœ‰æ¿€æƒ…) on the inside on the outside å¤–è¡¨ on the inside å†…å¿ƒ J: I heard they make really great leaders, they donâ€™t like being lied to, so make sure youâ€™re always honest to a Scorpio make great leaders éå¸¸ä¼šåšé¢†å¯¼ æ³¨æ„makeçš„ç”¨æ³• X: Sagittarius are deep thinkers deep thinkers æ€æƒ³å®¶/æ€æƒ³è€… J: They are really extroverted and optimistic, itâ€™s hard for a Sagittarius to feel downï¼Œ weâ€™ve finally reached the last three zodiac signs(æ˜Ÿåº§) extroverted/introverted (å¤–å‘çš„/å†…å‘çš„)optimistic/pessimistic ï¼ˆä¹è§‚çš„/æ‚²è§‚çš„ï¼‰feel down (ä¸å¼€å¿ƒï¼Œæƒ…ç»ªä½è½)reach åˆ°è¾¾ï¼Œ åˆ°è¾¾äº†æœ€åä¸‰ä¸ªï¼Œå°±ä»£è¡¨å‰©ä¸‹ä¸‰ä¸ª X: These people is known for their professionalism and traditional values , they are really serious people professionalism and traditional values ï¼ˆä¸“ä¸šç²¾ç¥å’Œä¼ ç»Ÿä»·å€¼è§‚ï¼‰serious people (ä¸¥è‚ƒè®¤çœŸçš„äººï¼Œ é«˜å†·) J: Letâ€™s move on, it should not surprise you that the symbol of Aquarius the water bearer, they can also be boisterous and energetic. They love to lend a helping hand to those in need. it should not surprise you (æ¯«æ— ç–‘é—®ï¼Œä¸ä¼šè®©ä½ æ„Ÿåˆ°æƒŠè®¶)boisterous /ËˆbÉ”Éª.stÉš.É™s/ å–§é—¹çš„, ç²¾åŠ›æ—ºç››çš„lend a helping hand to sb å¸®åŠ©æŸäºº X: The Pisces is a very gentle and affectionate(æ·±æƒ…çš„ï¼Œæœ‰çˆ±å¿ƒçš„) person. They are there for you when you need to spill your guts. Why would I want to be like you? spill your guts è¯´å¿ƒé‡Œè¯why would I wannt to be like you? ä¸ºä»€ä¹ˆæˆ‘è¦åƒä½ ä¸€æ ·ï¼Ÿ åäºŒæ˜Ÿåº§ Aries /Ëˆer.iËz/ ç™½ç¾Šåº§ Taurus /ËˆtÉ”Ër.É™s/ é‡‘ç‰›åº§ Gemini /ËˆdÊ’em.É™.naÉª/ åŒå­åº§ cancer /ËˆkÃ¦n.sÉš/ å·¨èŸ¹åº§ Leo /ËˆliË.oÊŠ/ ç‹®å­åº§ Virgo /ËˆvÉË.É¡oÊŠ/ å¤„å¥³åº§ Libra /ËˆliË.brÉ™/ å¤©ç§¤åº§ Scorpio /ËˆskÉ”Ër.pi.oÊŠ/ å¤©èåº§ Sagittarius /ËŒsÃ¦dÊ’.É™Ëˆter.i.É™s/ å°„æ‰‹åº§ Capricorn /ËˆkÃ¦p.rÉ™.kÉ”Ërn/ æ‘©ç¾¯åº§ Aquarius /É™Ëˆkwer.i.É™s/ æ°´ç“¶åº§ Pisces /ËˆpaÉª.siËz/ åŒé±¼åº§ 2016.3.30 Airport EnglishXiaogao is at the airport checking in(åŠç†ç™»æœº), Jingjing plays the part of the airline employeeJ: Hello sir, where are you flying today? (æ‚¨æ­¤è¡Œé£å¾€ä½•å¤„ï¼Ÿ)X: Iâ€™m headed to Detroit. be headed to smw å‰å¾€æŸåœ°ï¼Œ ä¸èƒ½æŒ‡ä»å¤–åœ°å›å®¶Head to = to go to å»ï¼ˆå¾€ï¼‰æŸåœ° Jï¼š Can I please see your passport? do you have any goods to declare? declare ç”³æŠ¥ï¼Œ æŒ‡è¿‡æµ·å…³çš„ç”³æŠ¥ Xï¼š Hereâ€™s my passport, no goods to declare this time.J: Okay, will you be checking in any bags? check in (æ—¢å¯ä»¥æŒ‡åŠç†ç™»æœºï¼Œä¹Ÿå¯ä»¥æŒ‡æ‰˜è¿è¡Œæï¼Œæ­¤å¤„æ˜¯åè€…) X: Yes, Just this oneJ: Please place it on the scale, oh *your bag is overweightï¼ˆè¶…é‡ï¼‰, Iâ€™m afraid youâ€™ll have to pay a small fee*** place it on the scale(ç§¤: a device to measure weights) æŠŠå®ƒæ”¾åœ¨ç§¤ä¸Špay a small fee (æ­¤å¤„è¦ç”¨feeï¼Œ tipæŒ‡åƒå®Œé¥­ç»™çš„å°è´¹)Iâ€™m afraid that ï¼ˆææ€•â€¦ï¼‰ Iâ€™m afraid of (å®³æ€•â€¦) æ³¨æ„äºŒè€…çš„åŒºåˆ« X: Thatâ€™s fine, here you go(ç»™ä½ )J: Hereâ€™s your boarding pass, youâ€™ll begin boarding at 10:05 at gate D12 boarding pass (ç™»æœºç‰Œ) X: Thanks maâ€™am maâ€™am /mÉ‘Ëm/ å¯¹å¥³å£«é¥¿ä¸€ç§ç¤¼è²Œçš„ç§°å‘¼ï¼Œä¸åœ¨ä¹ç»“å©šä¸å¦ Xiao Gao is going through the security check. Jing Jing plays the part of the customs agent go through é€šè¿‡security check å®‰æ£€ J: Please take your laptop out of your bag and place it in a bin(æŒ‡å®‰æ£€çš„å°ç›’å­)X: No problem, should I take my shoes off too?J: Yes, sir, you can put your shoes in another bin, please step through the metal detector. step through ï¼ˆèµ°è¿‡ï¼‰ æ³¨æ„å’Œgo throughçš„åŒºåˆ«metal detector ï¼ˆé‡‘å±æ¢æµ‹å™¨ï¼‰ X: Iâ€™m gonna have to pat your down, do you have any metal items in your pockets? pat oneâ€™s down (å¾ˆå½¢è±¡çš„è¯´æ˜â€œæœæŸ¥èº«ä½“â€ï¼Œ åŸæ„æ˜¯æ‹æ‹ä½ çš„èº«ä½“) to search someoneâ€™s clothes for items they shouldnâ€™t have J: No, I think it might be the belt buckle, itâ€™s made of metal. belt buckle (çš®å¸¦æ‰£) X: You are free to go, donâ€™t forget to grab your things grab sth ï¼ˆæ‹¿ä¸ŠæŸç‰©ï¼‰grab a bite to eat/ grab sth to eat Xiao Gao is onthe airplane getting ready to take off. Jing Jing plays the part of the stewardess(æŒ‡ç©ºå§) Flight attendants/stewardess ç©ºä¹˜äººå‘˜ J: Here is a hot towel(æ¯›å·¾) for you.Would you care for a pair of head phones? care for sth (éœ€è¦â€¦)head phones (è€³æœº) X: I will take a pair(æŒ‡ä¸€å¯¹è€³æœº)ï¼Œ BTWï¼Œ could I have a cup of water, please?J: Coming right up, and hereâ€™s some peanuts(èŠ±ç”Ÿ) and pretzelsï¼ˆæ¤’ç›è„†é¥¼ï¼‰ for you to snack on. coming right up (é©¬ä¸Šé€è¿‡æ¥)snack on = munch on (é£Ÿç”¨, å½“é›¶é£Ÿåƒ) X: Thanks! Those are my favorite! favorite æ­¤å¤„æ˜¯å½¢å®¹è¯ä½œåè¯ï¼Œç›´æ¥å•æ•°å½¢å¼ The captain makes an announcementï¼ˆæœºé•¿å¼€å§‹å¹¿æ’­ï¼‰Good morning ladies and gentlemen. This is your captain speaking. We have been cleared for takeoff(åè¯ï¼šèµ·é£). Weâ€™ll be leaving in just a few minutes. Please sit down and fasten your seatbelts. We expect to arrive in Detroit in 12 hours. Thank you for flying with Happy Airlines. Flight attendants, prepare for takeoff! æ‰©å±•ç¿»è¯‘ å“ªé‡Œæ˜¯è½åœ°ç­¾åŠç†å¤„ï¼ŸWhere can I find the visa on arrival office? æˆ‘åœ¨28å·å®‰æ£€å£ç­‰å¾…å®‰æ£€Iâ€™m waiting at gate 28 for a security check å¯ä»¥å…è´¹æ‰˜è¿å¤šé‡çš„è¡Œæï¼ŸWhatâ€™s the heaviest amount of luggage that we can check for free? è½¬æœºæ—¶æ˜¯å¦éœ€è¦å–è¡Œæ?è¡Œæå¯ä»¥ç›´è¾¾ç›®çš„åœ°å—ï¼ŸDo I have to grab my luggage during connecting flights? Can we send my luggage directly to my destination? ç´§æ€¥å‡ºå£åœ¨å“ªå„¿ï¼ŸWhereâ€™s the emergency exit? 2016.4.6 CampingJ: What are you gonna do for the weekend? what are you gonna do/what are you plans/what you have in mind for the weekend? å‘¨æœ«æ‰“ç®—åšä»€ä¹ˆ X: I havenâ€™t decided yet, itâ€™s still up in the air as to whether Iâ€™ll go camping with my friends or go bike riding through the countryside(éƒŠå¤–). I havenâ€™t decided yet. ï¼ˆæ³¨æ„åŠ ä¸Šyetæ›´åŠ å®Œæ•´ï¼Œè¡¨ç¤ºâ€œæˆ‘è¿˜æ²¡æœ‰å†³å®šâ€ï¼‰sth is still up in the air ï¼ˆæŸäº‹è¿˜æ²¡å†³å®šï¼Œæ­¤å¤„æ˜¯äº‹æ²¡ç¡®å®šï¼‰sb is on the fence about sth ï¼ˆæŸäººè¿˜åœ¨çŠ¹è±«æŸäº‹ï¼Œ æ­¤å¤„æ˜¯äººåœ¨çŠ¹è±«ï¼‰as to ï¼ˆè‡³äºâ€¦. ï¼‰ J: Both of those things sound really tiring. why donâ€™t you stay in town and hang out with your friends? tiring: sth is tiring that makes you tired.æ³¨æ„hang out å’Œ playçš„åŒºåˆ«, playè·Ÿå¤šçš„æ˜¯æŒ‡å°æœ‹å‹ä¹‹é—´çš„ç©è€ï¼Œhang out æŒ‡é€›è¡—ä¹‹ç±»çš„ X: Iâ€™m an outdoorsman, I love nature, and besides, lately the weather has taken a turn for the better. outdoorsman ï¼ˆæˆ·å¤–è¿åŠ¨æ§ï¼‰take a turn ï¼ˆè½¬ä¸ªå¼¯ï¼Œå˜åŒ–ï¼‰ å¤šæ•°ç”¨äºå¤©æ°”/èº«ä½“ take a turn for the better/worse J: I guess different things make us happy, I use my weekend to catch some shuteye catch some shuteye (è¡¥è§‰) X: I think youâ€™d really like camping,how about we both go camping this weekend?J: I donâ€™t know, is it expensive?X: Not at all, but Iâ€™d appreciate some help with gas money. itâ€™s a long drive out to the campsite(åº¦å‡è¥åœ°) not at all (ä¸€ç‚¹ä¹Ÿä¸ï¼Œæ³¨æ„è¿è¯»)Iâ€™d appreicate some help â€¦ éå¸¸å§”å©‰å®¢æ°”çš„è¯´æ³•Itâ€™s a long drive out to the campsite/hospital/my mom house (å»..çš„è·¯ç¨‹å¾ˆè¿œ) J: Iâ€™ll spring for gas, can I help with anything else? spring (ä½œåŠ¨è¯è®²æ„æ€ï¼šæ‹¿å‡º..ä¸œè¥¿) pay for = spring for the ticket/dinner X: Iâ€™ll let you set up a tent, youâ€™ll love it set up a tent = pitch a tent ï¼ˆæ­å¸ç¯·ï¼‰ J: It sounds like Iâ€™m getting the raw end of the deal, I heard that can be a lot of work get the raw end of the deal (raw ç”Ÿçš„ï¼Œ is not fairï¼Œ æ„æ€æ˜¯åƒäº†äºï¼Œæ‹¿åˆ°äº†ä¸å¥½çš„ä¸€ç«¯) X: Donâ€™t worry, Iâ€™ll help you through it. so are we on for the weekend? Iâ€™ll help you throught it = Iâ€™ll help you out (æˆ‘ä¼šå¸®ä½ æå®šå®ƒ)are we on .. (æˆ‘ä»¬è¯´å®šäº†..å˜›ï¼Ÿ) are we on for tonight/the weekend? ï¼ˆè¯´å¥½ä»Šæ™š/å‘¨æœ«ï¼Ÿï¼‰ J: weâ€™re on è¯´å®šäº† J: You should have looked at the weather report before we left.I canâ€™t believe itâ€™s raining right now, this is the pits I canâ€™t believe itâ€™s raining/April 4This is the pits (pit: the hole in the ground, è¡¨ç¤ºä¸ç†æƒ³çš„æƒ…å†µï¼Œ å¤ªç³Ÿç³•äº†) X: Donâ€™t worry, we still have a good time, hurry up and pitch the tent before we get any wetter. hurry up and pitch the tent before we get any wetter (å¿«æ¥ï¼Œåœ¨æˆ‘ä»¬æ·‹æ¹¿ä¹‹å‰æŠŠå¸ç¯·æ‰“èµ·æ¥ï¼Œæ³¨æ„æ­¤å¤„æ¯”è¾ƒçº§çš„è¿ç”¨ï¼Œæ›´åŠ åœ°é“) J: There a lot of poles(æ†å­), I donâ€™t know what to do first.X: There is nothing to it, watch me, there, all done there is nothing to it (æ²¡éš¾åº¦ï¼Œå¾ˆç®€å•) J: I guess that wasnâ€™t so bad, so what are we supposed to do now? itâ€™s too cold and wet to be outside right now.X: How about we make dinner in tent? I brought a portable stove and some ramen portable ï¼ˆå”¯ä¸€è¡¨ç¤ºâ€œä¾¿æºå¼â€çš„å•è¯ï¼‰ramen æ‹‰é¢ J: Now youâ€™re talking, cooking is right up my alley, ok, Xiaogao, just sit back and relax, iâ€™m gonna cook up a mean bowl of noodles. youâ€™re talking (å¤ªå¥½äº†ï¼Œå¾ˆåŒæ„è¿™ä¹ˆåšï¼Œè¡¨ç¤ºèµæˆ)sth is right up oneâ€™s alley = sb is good at stha mean bowl/dish of sth (ä¸€ç¢—ç‰¹åˆ«å¥½åƒçš„â€¦) X: Hey, you should come camping more often! You seem like a pro! pro æ­¤å¤„è¡¨ç¤ºä¸“å®¶ï¼Œ æ³¨æ„å’Œprofessorçš„åŒºåˆ«ï¼Œ æ­¤å¤„ä¸èƒ½ç”¨professorï¼Œ proè¡¨ç¤ºå¾ˆä¸“ä¸šmore ofen è¡¨ç¤ºâ€œç»å¸¸â€ J: What can I say? I guess Iâ€™m just good at everything I do! what can I say (æˆ‘èƒ½è¯´ä»€ä¹ˆå‘¢ï¼Ÿ å¾ˆç‚«è€€çš„ä¸€ç§è¯´æ³•)Iâ€™m good at everything I do = Iâ€™m a Jack of all trades (æˆ‘ä»€ä¹ˆäº‹éƒ½èƒ½åšå¥½ï¼Œ æˆ‘æ˜¯ä¸ªå…¨æ‰) 2016.4.11 30-day ChallengeX: My friends and I are gonna go see Zootopia and then go grab a bite to eat, you in? grab a bite to eat åƒç‚¹ä¸œè¥¿A: you in? B: yes, Iâ€™m in / no, Iâ€™ll pass J: Iâ€™ll passX: What? I thought you were dying to see that movie be dying to do sth = Yearning to do something (éå¸¸/æ¸´æœ›æƒ³åšæŸäº‹) J: I do really wanna see that movie, but Iâ€™ve got other plans, Lately Iâ€™ve been helping people at the old folksâ€™ home old folksâ€™ home = nursing home (æ•¬è€é™¢ï¼Œå‰è€…å¤šç”¨äºå£è¯­ä¸­) X: Why would you do that instead of going to the movies? That doesnâ€™t make sense make sense (æœ‰æ„ä¹‰)That doesnâ€™t make sense (æ ¹æœ¬æ²¡é“ç†ï¼Œè®²ä¸é€š) J: I made a commitment to myself that I will do something good every day for 30days, I recently attented a TED seminarï¼ˆä¸“é¢˜è®¨è®ºä¼šï¼‰ by Matt, He talked about the benefits of doing something for 30 days straight. make a commitement (åšæ‰¿è¯º)æ³¨æ„æ­¤å¤„Straightçš„ç”¨å¤„ X: Oh yeah, tell me about it. tell me about it = care to elaborate J: He said itâ€™s a greate way to improve yourself-confidence. Itâ€™s also a great way to force yourself to do something that youâ€™ve always wannted to do, but never got around to actually doing improve yourself-confidence (æ³¨æ„ï¼šæå‡è‡ªä¿¡å¿ƒè¦ç”¨improve)push sb to do sth = force sb to do sthget around to doing sth (æŠ½æ—¶é—´åšæŸäº‹) åœ¨è‚¯å®šå¥ä¸­ï¼š finally get around to doing sth åœ¨å¦å®šå¥ä¸­ï¼š never get around to doing sth X: Oh, that sounds like something I should doâ€¦J: I think youâ€™d love it. You can pick something that youâ€™re willing to do for 30 days, for example, writing a 50,000-word short story. Every day you just have to write 1667 words, but the tough part is that you canâ€™t go to sleep until youâ€™ve finished what you promised yourself youâ€™d do. the tough part (æœ€è‰°éš¾çš„éƒ¨åˆ†) X: I think Iâ€™ll give this a shot.Okay, have fun helping the old people. Iâ€™m off to the movies! give it/this a shot ï¼ˆè¯•ä¸€è¯•ï¼‰have fun doing sth (æœ‰å…´è¶£åšæŸäº‹)Iâ€™m off (æˆ‘èµ°äº†ï¼Œå¯ç”¨äºç»“æŸä¸€å¤©çš„å·¥ä½œæŒ‡â€œä¸‹ç­â€) J: * You look a lot thinner than the last time we met.* package some pounds ï¼ˆå˜èƒ–ï¼‰ X: I took your advice and decided to go on a diet for 30 days. So far, Iâ€™ve stuck to my diet really well. go on a diet (èŠ‚é£Ÿã€å‡è‚¥)stick to doing sth/sth ï¼ˆåšæŒåšæŸäº‹ï¼‰ J: Thatâ€™s great! So, tell me about it? What exactly are you doing? what exactly are you doing? (ä½ åˆ°åº•åšäº†ä»€ä¹ˆ) X: * I promised myself that I would eat healthy for at least 30 days. I also promised myself to get lots of exercise by walking and going to the gym.*J: How are you making sure that you eat heathy?X: * I weigh all of my food on a digital scale before I eat it. Then I calculate the amount of calories. Right now, I only eat about 1900 calories a day. Itâ€™s really helped me slim down.* digital scale (ç”µå­ç§¤) å…³è”2016.3.30 Airport English ä¸­ place it on the scaleslim down (ç˜¦èº«ï¼Œç˜¦ä¸‹æ¥) J: I can see that! You look like a completely different person! (ä½ ç®€ç›´åƒæ¢äº†ä¸€ä¸ªäººï¼Œæ³¨æ„completelyçš„ä½¿ç”¨)X: By the way, are you still sticking to your commitment?J: My 30-day commitment ended two weeks ago, but I felt so good about myself that I decided to keep it as a healthy habit. I still try to do one good thing every day. I love it! 2016.4.18 Getting Money BackX: Can I talk to you for a minute? Iâ€™d like to pick your brains about something. pick someoneâ€™s brains (è¯¢é—®/å¾æ±‚æŸäººæ„è§) Can I get your advice? J: Iâ€™m all ears, whatâ€™s up? Iâ€™m all ears (æµ‘èº«ä¸Šä¸‹éƒ½æ˜¯è€³æœµï¼ŒæŒ‡åœ¨è®¤çœŸå¬ï¼Œæ´—è€³æ­å¬) X: I lent my friend 500RMB two weeks ago, and he still hasnâ€™t paid me back, Iâ€™m at a loss of what to do borrow sth from sb (ä»æŸäººå€ŸæŸç‰©)lend sth to sb (å€Ÿç»™æŸäººæŸç‰©)pay me back (è¿˜é’±ç»™æˆ‘)Iâ€™m at a loss [of]â€¦ æˆ‘å›°æƒ‘.. ä¸çŸ¥é“æ€ä¹ˆåŠ I donâ€™t know what to do. J: You could give him the benefit of the doubt, maybe he forget about the money give sb the benefit of the doubt (æš‚ä¸”ç›¸ä¿¡æŸäºº ç«™åœ¨å¯¹æ–¹çš„ç«‹åœºä¸Šæƒ³ï¼Œç»™æŸäººä¸€æ¬¡è¯æ˜è‡ªå·±çš„æœºä¼š) X: * Thatâ€™s a lot of money to forget about. Iâ€™m really starting to get angry now.*J: I suggest you sit down with him and have a heart-to-heart talk. whatever you do, donâ€™t lash out and accuse him of stealing your money, he really might have forgotten. heart-to-heart talk (å¦è¯šçš„ï¼Œå¼€è¯šå¸ƒå…¬çš„è°ˆè¯)lash out (ç”¨è¨€è¯­æ”»å‡»ã€ç‹ æ‰¹) donâ€™t lash out (ä¸è¦è¯´ä¼¤äººçš„è¯ï¼Œä¸è¦æƒ…ç»ªå¤ªå†²åŠ¨å¤±æ§)accuse sb of doing sth (è°´è´£/æ–¥è´£/æŒ‡æ§æŸäººåšæŸäº‹ï¼Œ ä¸è§å¾—æœ‰è¯æ®çš„æŒ‡æ§/æ–¥è´£) X: I think Iâ€™d better keep him at armâ€™s length from now on keep sb at armâ€™s length (å’ŒæŸäººä¿æŒè·ç¦») J: Donâ€™t jump to conclusions so fast, talk to him about it first, and then draw your conclusion. jump to conclusions (å¦„ä¸‹ç»“è®º)draw oneâ€™s conclusion (ä¸‹ç»“è®º) X: Okay, Iâ€™ll keep you posted keep you posted (å‘ŠçŸ¥æŸäººæŸäº‹ï¼Œæˆ‘ä¼šä¿æŒæ›´æ–°æ¶ˆæ¯ï¼Œ æœ‰æ¶ˆæ¯å°±å‘Šè¯‰ä½ , å¯ä»¥ç”¨åœ¨é‚®ä»¶ä¹¦å†™ä¸­) J: Were you able to get your money back? get money back (è¿˜é’±) X: Yeah, but it was no walk in the park. a walk in the park (è½»è€Œæ˜“ä¸¾)a pain in the neck (è„–å­ä¸Šæœ‰ç–¼ç—›ï¼ŒæŒ‡ä¸é¡ºåˆ©ï¼Œæœ‰éº»çƒ¦)twists and turns (æ•…äº‹ä¸Šçš„â€œæ›²æŠ˜â€) The story is twists and turns J: What do you mean?X: I asked him if he could give me my money back, and he told me that it had completely slipped his mind. slip oneâ€™s mind (å¿˜å¾—ä¸€å¹²äºŒå‡€) J: So did he give the money back to you thenX: He only gave me 300. He said he will give me the other 200 next week once he gets paid. But then I remembered that he was going on vacation next week, so I called him on his bluff call sb bluff ï¼ˆæ­ç©¿æŸäººï¼‰ J: Did he come clean? come clean (å˜å¾—æ¸…æ™° æŒ‡è¯´çœŸè¯ è€å®äº¤ä»£) X: Yes, he apologized and gave me the other 200 the next day. He said he has been really tight for cash lately. tight for cash (æ‰‹å¤´ç´§) J: It sounds like youburied the hatchet with him? bury the hatchet (åŸ‹æ‰æˆ˜äº‰ã€æ–§å¤´, æŒ‡â€œå’Œè§£ï¼›å†°é‡Šå‰å«Œâ€) X: Yeah, I decided to let bygones be bygones. Now weâ€™re back to being good friends,just like before. let bygones be bygones (è¿‡å»çš„äº‹å°±è®©è¿‡å»å§ï¼Œ æ—¢å¾€ä¸å’) J: * Iâ€™m glad you listened to me and were able to remain friends with him.* remain friends (ç»´æŒæœ‹å‹å…³ç³») X: what would I do without you? 2016.4.20 Taxi EnglishJJ is visiting NewYork for the first time. XG plays the part of the taxi driver.JJ: Thanks so much for stopping, do you know how to get to Times Square(æ—¶ä»£å¹¿åœº) from here? how to get to smw from here? ä»è¿™æ€æ ·å»smw XGï¼š Hop in, so, is this your first time to The Big Apple? hop in ï¼ˆä¸Šè½¦ï¼‰/ hop out (ä¸‹è½¦) hopæœ¬æ„æ˜¯â€œè·³â€NYC(NewYork city åˆ«ç§°å«The Big Apple) JJï¼š Yeah, it sure is, I never thought NewYork was this big, It reminds me of ShangHai,China It sure is (å½“ç„¶äº†ï¼Œç¡®å®æ˜¯è¿™æ ·)this ï¼ˆæ­¤å¤„è¡¨ç¤ºå¼ºè°ƒï¼Œ å¢å¼ºæè¿°è¯­æ°”ï¼‰remind sb of sth ï¼ˆè®©æŸäººæƒ³èµ·æŸäº‹ï¼‰ XG: Youâ€™re from China, eh? wow, thatâ€™s a long way from NewYork. when did you land? itâ€™s a long way from swm (è·ç¦»æŸåœ°å¾ˆè¿œ)when did you land (ä»€ä¹ˆæ—¶å€™åˆ°çš„) = when did you arrive JJ: Last night, Iâ€™m still a little jet lagged Iâ€™m still a little jet lagged (æˆ‘ç°åœ¨ä»ç„¶æœ‰ç‚¹æ—¶å·®ç–²åŠ³) tired from the time difference between two placesiâ€™m lagging (é€šå¸¸æ˜¯æŒ‡â€œæˆ‘ç½‘ç»œå»¶è¿Ÿâ€) XGï¼š Well, welcome to Manhattan(æ›¼å“ˆé¡¿) ï¼Œ where else are you gonna see while youâ€™re here?JJ: *Iâ€™m planning on visiting Central Park(ä¸­å¤®å…¬å›­) and of course , the Empire State Building(å¸å›½å¤§å¦), maybe you can tell me some good places to visit? * Iâ€™m planning on doing sth (æ­£æ‰“ç®—æŸäº‹) XGï¼š Itâ€™d be my pleasure, I think you should add the Statue of Liberty(è‡ªç”±å¥³ç¥) to your list, itâ€™s a must-see must-see(å¿…çœ‹çš„[åœ°æ–¹]) must-do(å¿…åšçš„[äº‹æƒ…]) JJï¼š thaâ€™s a greate idea.XG: If youâ€™re into animals, you should check out the Bronx ZOO(å¸ƒæœ—å…‹æ–¯åŠ¨ç‰©å›­), The 9/11 memorial is also a place you canâ€™t miss, and since youâ€™re laddy, I bet you like shopping, right? be into sth (ç‰¹åˆ«å–œæ¬¢æŸç‰©/äº‹)check out (å»çœ‹çœ‹ï¼Œ åœ¨é…’åº—ç»“è´¦é€€æˆ¿ä¹Ÿå¯ä»¥ç”¨check out)A place you canâ€™t miss (éè¦å»çœ‹ä¸å¯çš„åœ°æ–¹)The 9/11 memorial is also a place you canâ€™t miss (æ³¨æ„å¥å­ç»“æ„ç”¨æ³•) JJï¼š Thatâ€™s rightXGï¼š Wellï¼Œ youâ€™ll love downtown Manhattan(æ›¼å“ˆé¡¿é—¹å¸‚åŒº)ï¼Œ thereâ€™s enough shopping malls there to keep you busy for days. but make sure you save some money for Coney island(åº·å°¼å²›), thereâ€™s a lot of things to do, If you have enough energy, You should check out NewYorkâ€™s night life, You wonâ€™t be disappointed.JJ: Thanks so much, those are some great tips!(å°æ”»ç•¥)XGï¼š Here we are, Times Square! Thatâ€™ll be $32.50ï¼ˆthirty two dollars and fifty centsï¼‰JJ: Hereâ€™s $35, keep the change. By the way, can you tell me how to get to the music store? keep the change = You can keep the tip(ç•™ç€å°è´¹å§) XGï¼š Sure, walk two blocks east. Youâ€™ll see it on your right.Good luck walk two blocks east (å‘ä¸œèµ°ä¸¤æ¡è¡—ï¼Œ æ³¨æ„ä¹‹è·¯æ–¹å‘è¯çš„ç”¨æ³•) æ‰©å±•ï¼š çº½çº¦å¸‚å…±åˆ†ä¸ºäº”åŒºã€ˆBoroughã€‰ï¼šå¸ƒæœ—ã€ˆThe Bronxã€‰ã€å¸ƒé²å…‹æ—ã€ˆBrooklynã€‰ã€æ›¼å“ˆé¡¿ã€ˆManhattanã€‰ã€çš‡åã€ˆQueensã€‰ã€åŠæå¥‡æ–‡(åˆç§°ä¸ºåˆ—æ²»æ–‡)ã€ˆRichmond (Staten Island)ã€‰ã€‚ put your arm out (ä¼¸å‡ºæ‰‹ï¼Œæƒ³è±¡å«å‡ºç§Ÿè½¦çš„æ ·å­) 2016.4.25 Vacation EnglishXiao Gao is checking into a hotel(åŠç†å…¥ä½é…’åº—). Jing Jing plays the part of the front desk employeeJJ: How may I help you?XG: I have a reservation under the name Gao A: I have a reservation. B: under which name (ç”¨å“ªä¸ªåå­—é¢„å®šçš„) JJï¼š Wait a moment while Iâ€™ll look you up, XG, is that right? look [sth] up (æŸ¥è¯¢) XGï¼š Yes, thatâ€™s rightJJ: It looks like you have booked a queen size bed? queen size bed ï¼ˆå¤§åºŠæˆ¿ï¼‰ King size bed (è¶…çº§å¤§åºŠæˆ¿) XGï¼š BTW, could you tell me some fun things to do around here? itâ€™s my first time to Miami.JJ: You asked the right person, I used to work as a tour guide before getting this job at the hotel, I think you should check out Miami beach, itâ€™s a great place to get a tan, At Miami beach, you can go on a speed boat tour, afterwardsï¼ˆç„¶åï¼‰, you should take a boat to the Bahamas(å·´å“ˆé©¬)ï¼Œ itâ€™s a paradise, youâ€™ll love the restaurants and bars there you asked the right person (ä½ é—®å¯¹äººäº†)get a tan (æ™’çš„ç¾é»‘) (tan æ—¢å¯ä»¥æ˜¯åè¯ï¼Œ ä¹Ÿå¯ä»¥æ˜¯åŠ¨è¯ Iâ€™m tanning now)get a sunburnt(æ™’çº¢ï¼Œ å°±æ˜¯æŒ‡æ™’ä¼¤äº†)sea sick (æ™•èˆ¹)go on a speed boat(å¿«è‰‡)/sth tour (æ¥ä¸€ä¸ªâ€¦æ¸¸)itâ€™s a paradise (å°±æ˜¯ä¸€ä¸ªå¤©å ‚å•Š) XGï¼š thanks, Iâ€™m gonna get my swim suit on and hit the beach swim suit (æ³³è¡£)you look good in the suit. the suit looks nice on you (æ³¨æ„ä»‹è¯inå’Œonçš„ä½¿ç”¨)hit the beach (å¥”å‘æµ·æ»©ï¼Œæ³¨æ„åŠ¨è¯hitçš„ä½¿ç”¨ï¼ŒæŒ‡å»å“ª) XG is at a restaurant at the Bahamas. Jing Jing plays the part of the restaurant employeeJJï¼š Sir, table for one? table for one/two (ä¸€ä½/ä¸¤ä½å—)A: how many? (å‡ ä½ï¼Ÿ) B: table for six (å…­ä¸ªäºº) XG Yes, PleaseJJ: Smoking or non? (æ‚¨æƒ³åå¸çƒŸåŒºè¿˜æ˜¯éå¸çƒŸåŒº)XGï¼š Non, pleaseJJ: right this way, *Can I get started off with a something to drink?*** right this way (è¿™è¾¹è¯·)Can I get started off(start off å°±ç›¸å½“äºstart) with a something to drink? XG: How about a martini(é©¬ä¸å°¼)JJ: Coming right up, do u still need a minute to look at the menu? coming right up (é©¬ä¸Šå°±æ¥) XGï¼š What are your specials today? (ä»Šå¤©çš„ç‰¹ä»·èœæ˜¯ä»€ä¹ˆï¼Ÿ)JJï¼š Today our specials are steakï¼ˆç‰›æ’ï¼‰ and potatoesï¼ˆåœŸè±†ï¼‰ and roasted salmonï¼ˆçƒ¤ä¸‰æ–‡é±¼ï¼‰. Do any of those sound good?XGï¼š Iâ€™ll go with the steak please. Iâ€™ll have / go with + èœå ï¼ˆæˆ‘è¦ç‚¹ä»€ä¹ˆ.. ï¼‰ JJï¼š Okay, Iâ€™ll be right back with your order. ï¼ˆæ‚¨çš„å•å¾ˆå¿«å°±æ¥ï¼‰JJ: How are we doing? Can I get you another martini? how are we doing (æ€ä¹ˆæ ·ï¼Œå¤–å›½åƒå›½å†…éœ€è¦å«æœåŠ¡å‘˜ï¼Œä»–ä»¬ä¼šå››å¤„èµ°æ¥ç…§é¡¾é¡¾å®¢éœ€æ±‚) XGï¼š No, thank you, Iâ€™m feeling a bit tipsy already. Iâ€™ll take the check, though. Iâ€™m feeling a bit tipsy already(æˆ‘æ„Ÿè§‰æœ‰ç‚¹å¾®é†ºäº†) / Iâ€™m feeling a little tipsy/woozy (I think Iâ€™ve caught a buzz). I gotta foot the bill.Iâ€™ll take the check ï¼Œ though(æˆ‘è¦ä¹°å•äº†, thoughå°±ç®—æ˜¯ä¸€ç§è¯­æ°”è¯â€œäº†â€) JJï¼š You got it. Here you are. Iâ€™ll be back to pick that up in a few minutes.(æˆ‘è¿‡ä¸€ä¼šå›æ¥æ‹¿ï¼‰ you got it (æ²¡é—®é¢˜) æ‰©å±•ï¼š å››å¤§æ´‹ï¼š the Pacific [pÉ™â€™sÉªfÉªk] Ocean (å¤ªå¹³æ´‹),the Atlantic [É™tâ€™lÃ¦ntÉªk] (Ocean)(å¤§è¥¿æ´‹),the Indian Ocean(å°åº¦æ´‹),the Arctic [â€˜É‘rktÉªk] Ocean (åŒ—å†°æ´‹) Hurricane crashed the Florida last week (é£“é£ä¸Šå‘¨è¢­å‡»äº†å¼—ç½—é‡Œè¾¾å·) 2016.5.4 House Warming PartyJJ: XG, howâ€™s the guest list coming along? howâ€™s [sth] coming along? (sthè¿›å±•çš„æ€ä¹ˆæ ·ï¼Œè¿˜æ²¡æœ‰ç»“æŸ) XGï¼š Itâ€™s pretty good, Iâ€™ve already thought of 30 people who we should invite.JJ: I think you should limit your guest list, after all weâ€™re on a tight budget. hosting so many people could be really expensive. on a tight budget (é¢„ç®—æœ‰é™) æ³¨æ„å’Œtight for cashçš„ç†è§£åŒºåˆ«hosting (é‚€è¯·) XGï¼š Youâ€™re right, what about invitations? maybe we should use social media instead of paper invitations in order to cut down on costs what aboutï¼ˆç›´æ¥æå‡ºé€‰æ‹©ã€æƒ³æ³•ï¼‰ å’Œ how aboutï¼ˆæœ‰äº†ä¸€ä¸ªï¼Œæå‡ºå¦å¤–ä¸€ä¸ªï¼‰cut down on costs (å‡å°‘å¼€æ”¯) JJï¼š Good idea, make sure you request an RVSP so that we can play for foods and drinks better. RVSP (RÃ©pondez sâ€™il vous plait(French for â€œplease respondâ€) æ•¬è¯·å›å¤,æ”¶åˆ°è¯·å›å¤) XGï¼š Speaking of food, I think we should have finger foods that people can munch on while they mingle. speaking of [sth] (è¯´é“sth)saying [sth] ï¼ˆæ¯”å¦‚sthï¼‰finger foods (foods that are convenient to eat with your hands èƒ½ç”¨æ‰‹æ‹¿ç€åƒçš„æ–¹ä¾¿é£Ÿç‰©)mingle (Mingle = to socialize é™Œç”Ÿäººä¹‹é—´çš„ç¤¾äº¤) JJ: I was thinking we should hire a catering service to provide our food . that way we can focus on decorating our new home, we want it to look nice when the guests arrive. catering service (a service that provides food for an event or party ä¸ºç‰¹å®šæ´»åŠ¨æä¾›é¤é¥®æœåŠ¡) XGï¼š Great party huhï¼ŸJJï¼š Yeahï¼Œ it sure is, the music is great, and the food is even better. it sure is (ç¡®å®ï¼Œç»™ä¸è‚¯å®š) XGï¼š Who do you know here? (ä½ éƒ½è®¤è¯†è¿™é‡Œçš„è°ï¼Œæ³¨æ„è¡¨è¾¾)JJï¼š Iâ€™m JJâ€™s friend, we went to school together. we went to school together (å¯ä»¥è¡¨ç¤ºæˆ‘ä»¬è¿‡å»æ—¶åŒå­¦) XGï¼š Oh cool. Xiao Gao and I are on the same basketball team. Nice to meet you. Iâ€™m Bob, by the way. æ³¨æ„å£è¯­å¯¹è¯ä¸­ by the way çš„ä½¿ç”¨ï¼Œ é¡ºä¾¿ä»‹ç»ä¸€ä¸‹è‡ªå·± JJï¼š Iâ€™m Jennifer. Nice to meet you too. Did you get to go on a tour of the place yet? Itâ€™s such a nice home. Iâ€™m so happy for them go on a tour of the place (åœ¨è¿™ä¸ªæˆ¿å­é‡Œå››å¤„è½¬è½¬äº†å—ï¼Ÿ) è”æƒ³ go on a speed boat tour (æ¥ä¸€ä¸ªå¿«è‰‡æ¸¸) æ³¨æ„çµæ´»ä½¿ç”¨ XGï¼š Yeah, Iâ€™m surprised at how much space they have. Anyways, would you like to go grab some refreshmentsï¼ˆé›¶é£Ÿï¼Œç‚¹å¿ƒï¼‰? I see youâ€™re almost done with your drink. The turkey is splendidï¼ˆéå¸¸å¥½ï¼‰. sb is done with sth (æŸäººçš„sthå¿«åšå®Œäº†/sthå¿«æ²¡äº†) Iâ€™m done with my work. JJï¼š Iâ€™m a veganï¼ˆ ä¸¥æ ¼ç´ é£Ÿä¸»ä¹‰è€…ï¼‰, so I donâ€™t eat meat. But Iâ€™ll join you for some more spirits. spirits (we just use the word â€œspiritsâ€ to refer to liquor(é…’) in general, so we only use it in plural(å¤æ•°) form (spirits). We canâ€™t say â€œIâ€™d like a spiritâ€, instead we should say specifically what kind you want, such as â€œIâ€™d like a shot of vodkaâ€ or â€œIâ€™d like a glass of whiskeyâ€) XG: Do you think I could get your phone number? You seem like a really cool person. Weâ€™re always looking for more members on our basketball team. Itâ€™s open to both guys and girls. Think youâ€™d be interested? åœ¨å›½å¤–è¦å¼‚æ€§ç”µè¯å°±æ˜¯å¯¹å¯¹æ–¹æœ‰å¥½æ„Ÿï¼Œ å§”å©‰ä¸€äº›å¯ä»¥æå‡ºä¸€äº›å€Ÿå£å¦‚ï¼ˆYou seem like a really cool personï¼‰ 2016.5.9 Obsessive Compulsive Disorder ï¼ˆOCDï¼‰JJï¼š Quit biting your nails, itâ€™s a bad habit.XG: Itâ€™s a bad habit, Iâ€™ve done it since I was a kid.JJ: Sounds like you got OCD, do you do it a lot?XG: Yeah, pretty often, do you ever tweak out about things like that? tweak out about sth = freak out about sth = worry about sth JJ: Sometimes, when Iâ€™m about to put my earbuds(å¡å…¥å¼è€³æœº) in to listen to music, I always have to make sure that the R and L are in the correct ear. be about to do sth(é©¬ä¸Šè¦åšæŸäº‹) Iâ€™m about to leave. (æˆ‘é©¬ä¸Šè¦ç¦»å¼€) XGï¼š Do you know what else drive me nuts? After I set the alarm at night to wake me up in the morning, I gotta check again like 5 minutes later to make sure I acturally set it. drive sb nuts/crazy/bonkers/up the wall è®©æŸäººæŠ“ç‹‚ JJï¼š Year, sometimes I have to make sure over and over that I locked the door at night before I sleep. over and over (åå¤ï¼Œä¸€éåˆä¸€éï¼‰ XGï¼š I canâ€™t stand it when someone doesnâ€™t completely clean the blackboard in school, I feel really weird in class and keep looking at. I canâ€™t stand it (æˆ‘ä¸èƒ½å¿å—) JJï¼š I remember when I was going to school and our test grades would be out for us to look at, I would never go and see my score.XG: Sounds like weâ€™re both a little OCD. Hey, what does OCD stand for anyway?JJ: You tell me! Why donâ€™t you go home and do some research about it?XG: Geez, is being bossy one of your OCD habits too? (å¤©å“ªï¼Œéš¾é“å‘å·æ–½ä»¤ä¹Ÿæ˜¯ä½ çš„å¼ºè¿«ç—‡ç—‡çŠ¶ä¹‹ä¸€å—ï¼Ÿ)JJ: So, what did you find out about OCD?XG: it stands for Obsessive Compulsive Disorder, Basicly itâ€™s when you have a lot of anxiety and you do a lot of repetitive behaviors to make the anxiety go away. (å¤§è‡´å°±æ˜¯è¯´ä½ æœ‰å¾ˆå¤šçš„ç„¦è™‘ï¼Œå¹¶ä¸”å¿…é¡»é€šè¿‡é‡å¤æŸç§è¡Œä¸ºæ‰è®©è¿™ç§ç„¦è™‘æ¶ˆå¤±ã€‚) JJ: What kinds of behaviors are you talking about? Did you find out about anything newXG: Yeah I did. Do you know what hoarders(å›¤ç§¯æ§) are? herder (ç‰§äºº) JJ: * I think so. Arenâ€™t they the people who have to round up a bunch(ç¾¤) of sheep?* round up sth (æ”¶é›† èšé›† å½’æ‹¢ ) XGï¼š * No, those are called herdersï¼ˆç‰§äººï¼‰, Iâ€™m talking about hoarders! H-O-A-R-D-E-R-S. Hoarders! Hoarding is when you keep a lot of things and donâ€™t throw them away, even if they are worthless or meaningless.*JJï¼š I donâ€™t know, Xiao Gaoâ€¦ Your room is pretty messyï¼ˆæ‚ä¹±çš„ï¼‰. Do you think you might â€¦. messy (æŒ‡å®¶ï¼ŒåŠå…¬å®¤ï¼Œå¤´å‘æ‚ä¹±çš„ï¼Œå°æœ‹å‹åƒé¥­å¼„å¾—å“ªé‡Œéƒ½æ˜¯ä¹Ÿå¯ä»¥ç”¨ ) XGï¼š Hey! My room is messy but itâ€™s not that bad!JJï¼š Anyways, do a lot of people suffer from this disorder?XGï¼š Itâ€™s fairlyï¼ˆç›¸å½“ï¼‰ common. Actually, itâ€™s the fourth-most diagnosed mentalï¼ˆå¿ƒç†çš„ï¼‰ disorder. One in fifty people have been diagnosed with it in the United States.JJï¼š Uh oh! Weâ€™re doomed! We probably have it too! Youâ€™re so dead (ä½ æ­»å®šäº†) Weâ€™re doomedï¼ˆæˆ‘ä»¬æ­»å®šäº†ï¼‰ XGï¼š Donâ€™t worry! I think weâ€™re okay. I also learned that just because you might have some obsessive behaviors, doesnâ€™t mean that you have OCD.JJï¼š Is it treatable?XGï¼š Yes. The good news is that this mental disorder is treatable with therapy(æ²»ç–—ï¼Œç–—æ³•) and medication! 2016.5.11 At The CrossroadsJJ: Hey,XG why do you look so stressed out? do you have a lot of homework or something? stressed out (æŠ“ç‹‚)or something æ”¾åœ¨é—®å¥çš„ç»“å°¾ç±»ä¼¼æ±‰è¯­çš„â€œ..å§/å—â€ XGï¼š Wellï¼Œ itâ€™s just it, schoolâ€™s going fine this yearâ€¦ but Iâ€™m not sure about next year. well, itâ€™s just it (å°±æ˜¯è¿™ä¹ˆå›äº‹)Iâ€™m not sure about sth (ä¸ç¡®å®šsth) JJï¼š I donâ€™t get it, you said schoolâ€™s going fine now, why do you have an issue at school year? I donâ€™t get it (æˆ‘æ²¡æ˜ç™½) = I donâ€™t understandYou got it (å¤šæ•°æ˜¯å›ç­”å¯¹è¯æŒ‡â€œæ²¡é—®é¢˜â€) XG: The way things are looking now, I donâ€™t think Iâ€™ll be able to fork up enough money for tuition next year. the way things are looking now (ç…§ç›®å‰æ¥çœ‹)fork up money = pay a large amount of money. JJ: Thatâ€™s not good, so what are you gonna do?XG: I was planning on working at a factory this summer and saving up some money and maybe take out a student loan, that way, I should be able to go to school next year. take out a [student] loan (ç”³è¯·åŠ©å­¦è´·æ¬¾)that way (é‚£æ ·çš„è¯)save up (å‚¨è“„ï¼Œ å­˜å‚¨) JJï¼š Problem solved, right? what are you worrying about? worry about sth = tweak out about sth = freak out about sth XG: I got a job offer to work as an English teacher, I wouldnâ€™t be able to go to school on such a low salary, but I think it would be really fun, so now Iâ€™m having second thoughts, Maybe I should take the teaching English position instead. have second thoughts (çŠ¹è±«ï¼Œå†åŠ æ€ç´¢)on second thought (ç»è¿‡å†æ¬¡æ€è€ƒ)instead æ”¾åœ¨å¥å°¾ä½¿ç”¨ JJï¼š You have to think this through carefully, On one hand the English teaching job is fun, thatâ€™s right, but on the other hand you wouldnâ€™t be able to fulfill your long term goal of getting a bachelorâ€™s degree, I donâ€™t think itâ€™s in your best interests to take the English teaching job think sth through [carefully] (å……åˆ†çš„è€ƒè™‘æŸäº‹)on one hand â€¦ on the other hand â€¦ ï¼ˆä¸€æ–¹é¢â€¦ å¦ä¸€æ–¹é¢â€¦ï¼‰fulfill your long term goal (å®Œæˆ/å®ç°é•¿è¿œç›®æ ‡ï¼Œ fulfill å¯ä»¥æŒ‡å®Œæˆç›®æ ‡ã€éœ€æ±‚ã€æ„¿æœ›)in oneâ€™s best interests (å¯¹æŸäººæœ€å¥½çš„åˆ©ç›Šï¼Œ æ˜¯æŸäººæœ€å¥½çš„é€‰æ‹©) XGï¼š *But I think that teaching job will help me in the future to land a better job, donâ€™t you think it will look good on my resume, if I had some teaching experience. * land a job (è·å¾—å·¥ä½œ)æ³¨æ„experienceæ˜¯ç»éªŒçš„æ—¶å€™ä¸å¯æ•° JJï¼š It might help, but I think having a bachelorâ€™s degree on your resume will look even better. you really have to weight the pros and cons åœ¨ç®€å†ä¸Šç”¨ on resumeweight the pros and cons (æƒè¡¡åˆ©å¼Š) XGï¼š *But working in the factory will be so boring, Iâ€™d much rather do something that would make me happy, itâ€™s always been one of my dreams * I would rather do sth(æˆ‘å®æ„¿åšsth) JJ: Well, thatâ€™s part of growing up and being responsible. This experience will make you a better and more responsible person in the future. Trust me, a bachelorâ€™s degree is worth much more than a temporary English teaching job. Plus, you donâ€™t even know for sure if youâ€™ll like teaching English. Anyways, you could always make learning English your hobby at night when you come home from work. Next semester at school, maybe you could take an English elective class. If youâ€™re certain you really like teaching English, then next semester maybe you could tutor a child on the weekend and at the same time make some extra money? thatâ€™s part of growing up ï¼ˆè¿™å°±æ˜¯æˆé•¿çš„ä¸€éƒ¨åˆ†ï¼‰A is worth much more than B (Aæ¯”Bæ›´æœ‰ä»·å€¼/æ„ä¹‰)elective class (é€‰ä¿®è¯¾) mandatory class(å¿…ä¿®è¯¾)tutor a child (æŒ‡å¯¼å­©å­ï¼Œåšå®¶æ•™) XGï¼š Okay, youâ€™ve convinced me. Iâ€™m gonna do whatâ€™s best for myself and work hard to earn enough money to pay for school! Thanks so much, Jing Jing. youâ€™ve convinced me (ä½ è¯´æœäº†æˆ‘) 2016.5.16 Left and Right HandednessJJ: Have you ever wondered how hard it must be for people who are left-handed(å·¦æ’‡å­) to use a computer, the computer mouse is made for right-handed(å³æ’‡å­) people. Have you ever wondered â€¦ ï¼ˆä½ æœ‰æ²¡æœ‰æƒ³è¿‡â€¦ï¼‰mouse (é¼ æ ‡)ï¼Œ wireless mouse (hamsterä»“é¼ ï¼Œ å› ä¸ºæ²¡æœ‰å°¾å·´.) XG: Year, it must be hard, my sister is lefty and she seems to do alright. lefty (å·¦æ’‡å­ï¼Œ æ¯”left-handed æ›´åŠ å£è¯­åŒ–) JJï¼š So do people choose to be left-handed or is it something that theyâ€™re born with? something that theyâ€™re born with (ä»–ä»¬ä¸ç”Ÿä¿±æ¥çš„ï¼Œä»–ä»¬ç”Ÿæ¥å°±æœ‰çš„) XGï¼š The actual reasons why some people are left-handed are still a little vagueï¼ˆè°œï¼‰, but scientists think that it has to do with peopleâ€™s geneticsï¼ˆé—ä¼ å­¦ï¼ŒåŸºå› å­¦ï¼‰ and the environment they grew up in. Studies also show that about 15% of the population is left-handed. vague (è°œ)the environment they grew up in (æ³¨æ„inä¸èƒ½ä¸¢æ‰ï¼Œ æˆé•¿åœ¨ç¯å¢ƒä¸­)studies/study/research show[s] ç ”ç©¶è¡¨æ˜ JJï¼š So besides holding a pen with their left hand, are there any other differences between left-handers and right-handers?XGï¼š Actually, yes.JJï¼š I heard left-handed people are kinda clumsyï¼ˆç¬¨æ‹™çš„ï¼‰, is that true?XGï¼š No, itâ€™s not. There are a lot of social stigmasï¼ˆç¤¾ä¼šåè§ï¼‰ about left-handed people that are completely false.In reality, left-handed people tend to be more athleticï¼ˆè¿åŠ¨çš„ï¼‰. Also, left-handed people seem to have better problem-solving skills. social stigmas (ç¤¾ä¼šåè§ï¼ŒæŒ‡æ ¹æ·±è’‚å›ºçš„åè§) â€”â€” To be a nonreader carries a social stigma.bias about/against sth (å¯¹æŸäº‹æœ‰åè§) bias toward/against sb (å¯¹æŸäºº.. çš„åè§)outright wrong (å®Œå…¨æ²¡æœ‰æ ¹æ®çš„é”™è¯¯) JJ: Wow, I kinda wish I were left-handed nowXG: Did you know that a lot of famous people were left-handed? Like Barak Obama and Prince William of England.JJ: Thatâ€™s really interesting. Iâ€™m gonna go home and see what I can learn about right-handed people now. Take care! A: see ya B: take care / A: take care B: see ya ï¼ˆå¯¹è¯ä¸­åŒæ–¹ï¼‰ XGï¼š See ya.JJï¼š So, did you find out anything about right-handed people? find out sth ï¼ˆè°ƒæŸ¥/æŸ¥è¯¢åˆ°sthï¼‰ XGï¼š Well, thereâ€™s one major plus to being a right-handed person: most items in life are geared towards right-handed people. Everything from water bubblers to door handles.Other than that, thereâ€™s really no intellectual advantage to being right-handed. plus (åœ¨æ­¤å¤„æŒ‡â€œå¥½å¤„ï¼Œä¼˜ç‚¹â€)gear toward sb (ä¸“é—¨ä¸ºsbåˆ¶é€ çš„)water bubblers (é¥®æ°´æœº) water fountain (æˆ·å¤–é¥®æ°´æ³‰)other than that (é™¤æ­¤ä¹‹å¤–) JJï¼š * So, do right-handed people use the right side of their brain and left-handed people use the left?*XGï¼š No, itâ€™s actually the opposite. Right-handed people are left-brain oriented and vice versa. money oriented (é‡‘é’±å¯¼å‘çš„)vice versa (åä¹‹äº¦ç„¶) XGï¼š Are there any people that can use both left and right hands equally well?JJï¼š Yes, these people are called ambidextrousï¼ˆ åŒæ‰‹éƒ½ä½¿ç”¨å¾—éå¸¸çµå·§çš„ï¼‰. Itâ€™s incredibly rare, but you can actually teach yourself to become ambidextrous.XGï¼š Really? So you mean I could teach myself how to use my left hand to do things?JJï¼š Yes, but donâ€™t expect it to be a cinch. You might have grey whiskers by the time you master it. a cinch = walk in a park = a piece of cakehave grey whiskers (ç™½å‘è‹è‹ï¼ŒæŒ‡å˜è€çš„æ—¶å€™) XG: Cool,well,Iâ€™m gonna go practice some left-handed food eating. You coming? you coming? (ä½ æ¥å—) 2016.5.23 Personality TraitsXG: Ouch! I just got bit again by another skeeter(èšŠå­)! I think summer is just around the corner. Summer is just around the corner (å¤å¤©å°±è¦æ¥äº†) JJï¼š Yeah, you must have sweet blood.XGï¼š Well, all I know is that my blood type is â€œAâ€, Iâ€™m not sure if itâ€™s sweet or not.JJï¼š Oh, you know your blood type eh? Did you know that thereâ€™s been a lot of research done about blood type in relation to personality?XGï¼š No, I didnâ€™t,can you enlighten me? enlighten me (ç»™æˆ‘è®²è®²ï¼Œè®©æˆ‘æ˜ç™½å—æ•™) JJï¼š As you know,there are four possible blood types that a human being can have: A, B, AB, and O. Since youâ€™re A, let me tell you a few things about your personality.XGï¼š Okay, give it your best shot. Let me give it a shot (è®©æˆ‘è¯•ä¸€è¯•)give it your best shot (ä½ æ¥è¯•è¯•å§) JJï¼š Most type As are sensitive to the needs of others and are good listeners.XGï¼š Yeah, well,doesnâ€™t this describe everyone?JJï¼š * Hold on! Iâ€™m not done yet! Youâ€™re also detail-oriented, creative and inventive. On the outside, you seem really calm, but on the inside, you are filled with anxiety and worry.* on the outside (åœ¨å¤–è¡¨çœ‹æ¥) on the inside (åœ¨å†…å¿ƒçœ‹æ¥) XGï¼š Youâ€™re lying! I think you are describing me on purpose. â€¦ on purpose (â€¦ æ˜¯æ•…æ„çš„) JJï¼š Iâ€™m not kidding! The research really shows this. Also, type As are usually shy and sensitive, and a lot of them are perfectionistsï¼ˆå®Œç¾ä¸»ä¹‰è€…ï¼‰.XGï¼š Thatâ€™s me to a T! .. to a T (è¡¨ç¤ºå‡†ç¡®æäº†ï¼Œå®Œå…¨ç²¾å‡†çš„æè¿°) JJï¼š Romantically,type As work best with other type As and ABs. Romantically (æ„Ÿæƒ…ä¸Šè¯´) XGï¼š What do type As end up doing for jobs?JJ: Common type A career choices include accountants, librarians, economists, computer programmers and writers.XG: I was once a computer programmer! Does it say anything about us being really stressed out(å‹åŠ›å¤§)?Iâ€™m usually pretty tenseï¼ˆç´§å¼ ï¼‰ during the day.JJï¼š Yes it does,actually. Most type As often bottle up anxiety in order to get along with others. Many of them are tense, impatient, and unable to sleep well. bottle up emotions [anxiety] (æŠŠç„¦è™‘è—èµ·æ¥ï¼Œæƒ³è±¡ç“¶å­è£…èµ·æ¥ä¸€ä¸ªä¸œè¥¿å¹¶ä¸”æŠŠç“¶å¡å¡ä¸Šï¼Œåœ¨æ„Ÿæƒ…è—åœ¨å¿ƒé‡Œï¼Œä¸å‘Šè¯‰åˆ«äººï¼Œä¹Ÿä¸é‡Šæ”¾å‡ºæ¥) XGï¼š Ahh! Itâ€™s like youâ€™re reading my mind! What blood type are you? Tell me now!! read my mind (è¯»å¿ƒ) JJï¼š Thatâ€™s for you to determine. Go home and research all the different blood types, then letâ€™s see if you can guess it correctly!XG: Okay, Jingjing, Iâ€™ve done my research. I think I know which blood type you are.JJ: Oh yeah? Which one?XG: Youâ€™re a type B!JJ: Youâ€™re right.But how did you come to that conclusion? come to that conclusion. (æ€ä¹ˆå¾—å‡ºè¿™ä¸ªç»“è®ºï¼Œæœ‰ä¸€ä¸ªå¾ªåºæ¸è¿›çš„è¿‡ç¨‹åœ¨é‡Œé¢) XG: Well, it said type Bs are easygoing(éšå’Œçš„), creative, original and flexible.JJï¼š Can you say something more concreteï¼ˆå…·ä½“çš„ï¼‰?XGï¼š Well, it says that type Bs are globally-oriented people. Also, it says that you learn best through listening. On top of thatï¼ˆå¹¶ä¸”ï¼‰, it says you are goal-oriented and ambitious. on top of that (å¹¶ä¸”) JJï¼š Itâ€™s true, I am good at listening, thatâ€™s why I like working on the radio.XGï¼š * It also said you arenâ€™t a very picky person, and you donâ€™t worry about little things too much.* a picky person (ä¸€ä¸ªæŒ‘å‰”çš„äººï¼Œè®¡è¾ƒçš„äºº) JJ: Yup, for example, I donâ€™t say anything to you when you come to work dressed like a slob (æ²¡æœ‰æ¡ç†ï¼Œé‚‹é¢çš„äºº).XG: Hey! That wasnâ€™t very nice.JJ: How about romance-wise? romance-wise (æ„Ÿæƒ…æ–¹é¢ï¼Œæ„Ÿæƒ…è§’åº¦)time-wise (æ—¶é—´æ–¹é¢ï¼Œæ—¶é—´è§’åº¦) XGï¼š Type Bs do best with other type Bs and ABs. do best with others = work together well. JJ: Anything else?XG: Basically, you are thoughtful like type As and ambitious like Os. Itâ€™s a very interesting blood type. But do you know what the smoking gun was that made me convinced you were blood type B? smoking gun (è®©ä½ ç ´æ¡ˆçš„çº¿ç´¢ï¼Œç¡®å‡¿è¯æ®ï¼Œ æƒ³è±¡å†’çƒŸçš„æªï¼Œç ´æ¡ˆçš„çº¿ç´¢) JJï¼š No, what was it?XGï¼š Common career choices for type B, such as cooks, military leadersï¼ˆå†›å®˜ï¼‰, talk show hosts and journalists!JJï¼š Thatâ€™s me,indeed! Good job, Greg! So we talked about blood type As and blood type Bs, but do you remember me telling you there was also a blood type AB? do you remember sb doing sth XG: Yeah, Ido, I found them to be the most interesting of all!JJ: Me too. Not surprisingly, they have both A and B traits(ç‰¹æ€§).Sometimes theyâ€™re shy and outgoingï¼ˆå¤–å‘çš„ï¼Œextrovertedï¼‰, hesitant and confident.XG: Type ABs often stand out like a sore thumb among other types. They are trustworthy and like to help others. stand out like a sore thumb ï¼ˆæ°å‡ºï¼Œçªå‡ºï¼Œé¹¤ç«‹é¸¡ç¾¤ï¼‰trustworthy (å¯é çš„) JJï¼š They also think logically and are determined to do things correctly. think logicaly/emotionally/rationally (é€»è¾‘ã€æ„Ÿæ€§ã€ç†æ€§) XGï¼š Type ABs can find a soul mate with any other blood type. soul mate ï¼ˆçµé­‚ä¼´ä¾£ï¼‰ JJï¼š Did you know that both John F. Kennedy and Marilyn Monroe are type ABs?XGï¼š Yeah, what a coincidence! Whatâ€™s even more interesting is that only about 2%ï½5% of the population are blood type AB. what a coincidence (å¤ªå·§äº†) JJï¼š Theyâ€™re really charmingï¼ˆè¿·äººçš„ï¼Œå¯çˆ±çš„ï¼‰ and popular. They donâ€™t sweat the small stuff. sweat the small stuff (ä¸æ‹˜å°èŠ‚ï¼Œä¸çº ç»“äºå°äº‹æƒ…, ä¸ä¸ºå°äº‹çƒ¦å¿ƒ) XGï¼š So what do type ABs usually do for work?JJï¼š Well, some common type AB careers are bartendersï¼ˆè°ƒé…’å¸ˆï¼‰, lawyers, teachers and sales peopleï¼ˆé”€å”®ï¼‰.XGï¼š Thereâ€™s never a dull moment in a type ABs life. If you can find one for a friend, consider yourself lucky! Well, weâ€™ve talked about A, B, and AB. We havenâ€™t even said a thing about type O yet. Thereâ€™s never a dull moment in sth (åœ¨sthä¸Šä¸€ç‚¹ä¹Ÿä¸å•è°ƒ) Thereâ€™s never a dull moment in GFGconsider yourself lucky (ä½ å®åœ¨å¤ªå¹¸è¿äº†) JJï¼š Type Os are really unique. Theyâ€™re responsible, decisiveï¼ˆæœ‰å†³å¿ƒçš„ï¼‰, organizedï¼ˆæœ‰æ¡ç†çš„ï¼‰, and practicalï¼ˆåŠ¡å®çš„ï¼‰.XGï¼š Thatâ€™s right. Type Os are shot callers. They often end up being bankers,politicians, gamblersï¼ˆèµŒå¾’ï¼‰, investment brokersï¼ˆæŠ•èµ„ç»çºªäººï¼‰, and pro athletes shot caller (æ³•ä»¤å¼€æªçš„äººï¼ŒæŒ‡â€œå†³ç­–äººâ€) JJï¼š They tend to be lonersï¼ˆç‹¬è¡Œä¾ ï¼‰ or leaders and are self-reliantï¼ˆè‡ªç«‹çš„ï¼‰ and daringï¼ˆå‹‡æ•¢çš„ï¼‰.XGï¼š They cope with stress better than any other blood types and donâ€™t get sick that much. cope with sth (å¤„ç†sth) ï¼ˆå¯ä»¥å†ä¹Ÿä¸ç”¨handleäº†ï¼Œ æ¬§è€¶ï¼‰ JJï¼š They also have a strong build ï¼ˆå¥åº·çš„ä½“é­„ï¼‰and like to stay active.XGï¼š Being hard-headedï¼ˆå¤´è„‘æ¸…æ™°å†·é™çš„ï¼‰ and determined to succeed helps them to reach their goals. be determined to do sth (å†³å¿ƒè¦åšæŸäº‹)reach oneâ€™s goal (å®ç°ç›®æ ‡) JJï¼š Theyâ€™re also really creative and are often the center of attention. the center of attention (å…³æ³¨çš„ç„¦ç‚¹) Children offen wanna be the center of attention. XG: Thatâ€™s right, they are the social butterflies that you meet in life from time to time. social butterfly (å–„äºäº¤é™…çš„ï¼Œæ²¡æœ‰è´¬ä¹‰)from time to time (ä¸æ—¶ï¼Œæœ‰æ—¶ï¼‰ JJï¼š What I found most interesting is that they seem to use their five senses better than the other blood types.XGï¼š Well, now we know a lot more about different blood types. Iâ€™m still surprised at how accurately it described me. be surprised at sth (åƒæƒŠâ€¦ ) 2016.6.1 Awesome Brand New Book Is OutJW: Hey, Anya. Howâ€™s it hanging? What are you doing howâ€™s it hanging? = whatâ€™s going on? = how youâ€™re doing ? ï¼ˆæœ€è¿‘æ€ä¹ˆæ ·ï¼‰ AY: Iâ€™m listening to Going for Gold. Normally Iâ€™d be studying the book, but Iâ€™ve already gone through the whole thing normally (ä¸€èˆ¬æ¥è¯´)Go through the whole thing = to finish something entirely, front to back (å®ŒæˆæŸäº‹) JW: Oh, I love Going for Gold. I canâ€™t imagine life without it. I canâ€™t imagine life without it (æ ‡å‡†å¥å‹ï¼Œæ³¨æ„ä½¿ç”¨ï¼Œâ€œä¸æ•¢æƒ³è±¡ç”Ÿæ´»æ²¡æœ‰å®ƒä¼šæ€æ ·â€) AYï¼š Me too. I bought Jing Jing and Xiao Gaoâ€™s first book last year. Also, I listen to their show using an app on my phone. I like to look at the scriptï¼ˆæ–‡æœ¬ï¼‰ on WeChatJWï¼š :I get home from work pretty late at night, but Jing Jing always hosts an evening show online for those of us who like to self-studyï¼ˆè‡ªå­¦ï¼‰. Iâ€™ve gotten so much out of it. Iâ€™ve learned so many native phrases(ç”¨è¯­ï¼ŒçŸ­è¯­)! Iâ€™ve gotten so much out of it (æˆ‘è§‰å¾—æ”¶è·å¾ˆå¤§) AY: This is the best program Iâ€™ve ever listened to. It totally changed the way I study English. I wasnâ€™t learning native stuff in the past, in fact it was mostly Chinglishï¼ˆä¸­å¼è‹±è¯­ï¼‰. By following Going for Gold, not only have I learned how to express myself, but Iâ€™ve learned correct pronunciation and have gained confidence in speaking. gain confidence (è·å¾—è‡ªä¿¡) improve confidence (æå‡è‡ªä¿¡) JWï¼š The first book was awesome because it came with an MP3 CD. The second book is even better because you can download the dialogues for free. Iâ€™m definitely buying the second book so I can keep learning. sth1 came with sth2 (sth1éšèº«é™„å¸¦sth2) AYï¼š :Iâ€™ve already passed the show on to several of my friends, classmates, and even family members. I really liked watching Xiao Gaoâ€™s videos that he used to post on Weibo. I hope he posts more in the future. It was a great way to learn! pass sth on to sb = to share [something] with other people (å¤šæŒ‡å£å¤´åˆ†äº«)post (å‘å¸ƒä¸œè¥¿) JWï¼š I heard there was a way to get an autographed copy of the new book. Is that true? autographed copy of the new book (æ–°ä¹¦çš„ç­¾åç‰ˆ) AYï¼š Yeah, we just have to follow Jing Jingâ€™s Weibo account and forward comments about the book, then weâ€™ll be eligible for a raffleï¼ˆæŠ½å¥–ï¼‰. Theyâ€™ll announce the winners on the weekend. be eligible for sth/doing sth (æœ‰èµ„æ ¼åšæŸäº‹) JWï¼š I heard this book is a limited edition. Iâ€™d better hurry up and buy it! limited edition (é™é‡ç‰ˆ)Iâ€™d better hurry up and buy it! (æˆ‘å¾—èµ¶ç´§å…¥æ‰‹) AYï¼š Yeah, what are you waiting for? Next Monday will be the first class of the new book. Iâ€™m gonna participate more in the WeChat challenges each week, because the more I practice, the better I get. This is another reason why I love this radio show so much!JWï¼š Hey, we forgot the most important part: Going for Gold is free! We can learn so many things without paying anything. That is so awesome! so much feedback (æ³¨æ„ç”¨much) 2016.6.6 Bad HabitsJJ: Pee yew! Whatâ€™s that awful smell? Pee yew (å’¿å‘€, å£è¯­åŒ–çš„è¡¨è¾¾ï¼Œ é€šå¸¸å’Œ whatâ€™s that awful smell ä»€ä¹ˆå‘³é“è¿™ä¹ˆéš¾é—») XG: Donâ€™t look at me! I took a shower today! take a shower (æ´—æ¾¡ï¼ŒæŒ‡æ·‹æµ´) shower ä¹Ÿå¯ä»¥å½“åŠ¨è¯ä½¿ç”¨ï¼Œ I showered today (æˆ‘ä»Šå¤©æ´—æ¾¡äº†) JJï¼š No, I meanâ€¦ something smells like smoke. *XGï¼š *Oh, I recently picked up a bad habit. I started smoking a few weeks ago pick up a bad habit ï¼ˆå…»æˆä¸€ä¸ªåä¹ æƒ¯ï¼‰ JJï¼š Really? Why did you start doing that? Why did you start doing that (ä½ æ˜¯æ€æ ·å¼€å§‹çš„ï¼Ÿ ) XGï¼š I bummed a cigarette from my friend one day. After that, I got hooked. bum (to ask someone for something without intending to pay for it), (æœ‰ä¸€å¤©æˆ‘ä»æˆ‘æœ‹å‹é‚£å„¿é¡ºäº†ä¸€æ ¹çƒŸ)get hooked [on sth] ([å¯¹æŸäº‹]ä¸Šç˜¾) JJï¼š Well, I think you should kick the habit! kick the habit (æ”¹æ‰é‚£ä¸ªä¹ æƒ¯) XGï¼š I want to, but itâ€™s really hard!JJï¼š You know what they say: Bad habits are like comfortable beds, easy to get into, hard to get out of. you know what they say [that]â€¦(ä¿—è¯è¯´â€¦) XG: You can say that again. So, do you have any suggestions on how to quit? you can say that again (ä½ è¯´çš„å¤ªå¯¹äº†ï¼Œç”¨ä»¥è¡¨ç¤ºâ€œè‚¯å®šâ€)suggestions on â€¦ (â€¦çš„å»ºè®®) JJï¼š I heard the patchï¼ˆæˆ’çƒŸè´´ç‰‡ï¼‰ works really well. Why donâ€™t you give it a try and see if it helps?XGï¼š Okay, Iâ€™ll give it a shot. Talk to you later!JJï¼š Hey, Xiaogao.Were you able to quit smoking yet?XGï¼š * Yes, thank God! It was really hard, but I finally did it.* It was really hard, but I finally did it (å¯ä»¥å¸¸ç”¨ï¼Œè¡¨ç¤ºç»è¿‡ä¸€ç•ªåŠªåŠ›å–å¾—æˆåŠŸï¼Œå¾ˆæœ‰æˆå°±æ„Ÿçš„æ„Ÿè„š) JJï¼š Iâ€™m sure it was, after all, old habits die hard. So did you use the patch? old habits die hard (æ—§ä¹ éš¾æ”¹) XGï¼š No, the patch was a rip off, so I didnâ€™t buy it. sth is a rip off (â€¦å¤ªè´µäº†) JJï¼š So how did you do it?XGï¼š I went cold turkey. Itâ€™s the cheapest and most effective method there is. go/went code turkey (é‡‡ç”¨ç®€å•ç²—æš´çš„æ–¹æ³•, ç«‹åˆ»å®Œå…¨åœæ­¢åšæŸäº‹ï¼Œä¸å€ŸåŠ©ä»»ä½•è¯ç‰©çš„å¸®åŠ©ï¼Œä¹Ÿä¸ç»™è‡ªå·±ç•™æ—¶é—´æ…¢æ…¢æ¥) JJï¼š Wow, good for you! How do you feel now? Did you have any withdrawals? withdrawal (å‰¯ä½œç”¨ï¼Œç˜¾ã€‚å› ä¸ºæ²¡æœ‰è·å¾—è¶³å¤Ÿè‡ªå·±å·²ç»ä¸Šç˜¾çš„ç‰©è´¨ï¼Œä¾‹å¦‚å’–å•¡å› ã€å°¼å¤ä¸ã€é…’ç²¾ç­‰ï¼Œè€Œé€ æˆçš„éš¾å—çš„æ„Ÿè§‰)phisical suffering XGï¼š For the first three days I had a headache,after that it was smooth sailing. smooth sailing (ä¸€å¸†é£é¡º) JJï¼š Well, Iâ€™m glad youâ€™ve given yourself a new lease of life. In the future, donâ€™t bum anymore cigarettes! a new lease of life=æ–°é¢è²Œï¼Œåœ¨ç»å†ä¸€æ®µè‰°è¾›åè¿æ¥çš„å´­æ–°ç”Ÿæ´»donâ€™t bum anymore cigarettes (ä»¥åå¯åˆ«å†æ²¾çƒŸäº†) XG: I learned my lesson, I wonâ€™t make that mistake again! I learned my lesson.=å¸å–äº†æ•™è®­ã€‚æŒ‡æŸäººçŠ¯è¿‡ä¸€æ¬¡é”™è¯¯åï¼Œä¸ä¼šå†çŠ¯ç±»ä¼¼çš„é”™è¯¯ã€‚I wonâ€™t make that mistake again = æˆ‘ä¸ä¼šå†çŠ¯é‚£æ ·çš„é”™ 2016.6.13 Getting Along with Co-workersXG: Ohhh, Jingjing! I have been having the worst time at work lately! My co-workers are driving me up the wall. drive sb nuts/crazy/up the wall/bonkers/ lose sbâ€™s nerve JJ: Well, you came to the right person. You know Iâ€™m always here to listen when you want to vent your feelings. So whatâ€™s up? Who is bothering you and why? you came to the right person (ä½ é—®å¯¹äººäº†)vent oneâ€™s feelings (åæ§½ï¼Œå‘æ³„æƒ…ç»ª) XGï¼š Well, my cube mate, Jerry, smacks gum all day. Itâ€™s so distractingï¼ˆåˆ†å¿ƒçš„ï¼‰ and discourteousï¼ˆæ— ç¤¼çš„ï¼‰! cubicleçš„å£è¯­åŒ–ç®€ç§° cube (æŒ‡åŠå…¬å®¤çš„å·¥ä½)smack gum (åš¼å£é¦™ç³–å‡ºå£°éŸ³)slurp smack ï¼ˆéƒ½æŒ‡å‡ºå£°éŸ³çš„å’€åš¼ä¸œè¥¿ï¼‰ JJï¼š Have you ever thought about asking him to not chew so loudly? Or how about asking your boss if you can change cubicles? have you ever thought about sth XG: Iâ€™ve thought about that, but weâ€™re working on the same project together, I donâ€™t want to make him upset. Anyways, I can live with this problem, but thereâ€™s some other things at work that are making me lose my nerve too. work on sthmake sb upset ï¼ˆè®©æŸäººå¿ƒçƒ¦ï¼‰live with sth (å¿å—sth)lose my nerve ï¼ˆå¿æ— å¯å¿ï¼Œè®©æˆ‘æŠ“ç‹‚ï¼‰ JJï¼š Yeah? Like what? like whatï¼ˆä»€ä¹ˆäº‹ï¼Ÿï¼‰, like whoï¼ˆæ¯”å¦‚è°ï¼Ÿï¼‰, like whenï¼ˆä»€ä¹ˆæ—¶å€™ï¼‰ XGï¼š My other co-worker, Bob, takes all the credit for the work I do. I designed a website last week for our company, Bob only edited two pictures, but he told everyone that he did the whole thing! Itâ€™s so unfair! take all the credit for sth ï¼ˆæŠ¢åŠŸå ä¸ºå·±æœ‰ï¼‰ JJï¼š Yeah, I feel you. Thatâ€™s happened to me a couple times too. I suggest you tell Bob that he isnâ€™t being a team player. You have a right to tell him how much it upset you, but be careful not to lose your temper and start screaming at him. He probably doesnâ€™t realize what he did. I feel you (æˆ‘ç†è§£ä½  I understand you)you have a/every/the right to do sthlose oneâ€™s temper (å¤±æ€ï¼Œå‘è„¾æ°”)scream/yell at sb ï¼ˆå¤§å¼å¤§å«æŸäººï¼‰ XGï¼š Youâ€™re probably right. Wow, you sure know a lot about this kind of situation.Can you give me some more advice? can you give me some more advice? = can I pick your brains? JJ: I tell you what, itâ€™s almost lunch time. Letâ€™s go sit down at a restaurant and Iâ€™ll tell you some rules of thumb for dealing with difficult people at work. a rule of thumb=ç»éªŒæ³•åˆ™ï¼Œä¸ºé€‚å®œçš„è¡Œä¸ºæä¾›æŒ‡å¯¼deal with sb ï¼ˆå’ŒæŸäººç›¸å¤„ï¼Œæ‰“äº¤é“ï¼‰ Jingjing and Xiaogao sit down at a restaurant and begin their conversationJJ: Alright, Xiaogao, rule number one: when youâ€™re at work, make sure you always carry your own weight.That means you should always do whatâ€™s asked of you and try not to let other co-workers pick up the slack. carry your own weight (åšå¥½åˆ†å†…çš„äº‹ï¼Œä¸èƒ½è¦æ±‚åˆ«äººä¸ºä½ åš)pick up the slack (æ›¿åˆ«äººåšä»–ä»¬åº”è¯¥åšä½†æ²¡æœ‰åšçš„) XG: Okay, that I can do. But what about when my co-workers are in a grumpy mood? Sometimes I want to lash out at them. grumpyï¼ˆmoodï¼‰=è„¾æ°”æš´èºï¼Œç”Ÿæ°”æˆ–ä¸å‹å–„lash out at sb ï¼ˆå‘æŸäººå‘ç«ï¼‰ï¼Œ yell at sb, lay into sb(ç—›æ–¥æŸäºº)I am so gonna do (æˆ‘ç‰¹åˆ«æƒ³åš) JJ: That brings me to rule number two: no matter how other people act at work, you should always maintain a professional attitude. That means you should talk to people with respect at all times. If something bothers you, you can talk to your boss or the HR department. maintain a professional attritude (ä¿æŒä¸“ä¸šçš„æ€åº¦) XGï¼š I have another co-worker who sits close to me, her name is Amanda. Sheâ€™s always on the phone with her boyfriend talking up a storm. Itâ€™s really distracting, just like Jerry chewing his gum(æ²¡æœ‰å¤æ•°å½¢å¼ï¼Œæœ¬èº«å°±æ˜¯å¤æ•°). What should I do about that? Sheâ€™s a girl, is it okay to confront her about it? Sheâ€™s always on the phone with her boyfriend talking up a storm,Itâ€™s really distracting (å¥¹æ€»æ˜¯å’Œå¥¹çš„ç”·æœ‹å‹ç…²ç”µè¯ç²¥ã€‚è¿™çœŸçš„å¾ˆè®©äººåˆ†å¿ƒ)talk up a storm (æ»”æ»”ä¸ç»çš„è®²)confront sb (ç›´é¢æŸäºº) JJï¼š Of course itâ€™s okay. Just remember to stay professional and ask nicely. She probably doesnâ€™t realize that sheâ€™s being a chatterbox. If you ask her nicely Iâ€™m sure sheâ€™ll keep her voice down. She probably doesnâ€™t realize that sheâ€™s being a chatterbox (å¥¹å¯èƒ½æ²¡æœ‰æ„è¯†åˆ°è‡ªå·±ä¸€ç›´åœ¨å–‹å–‹ä¸ä¼‘)keep her voice down XG: Thanks for all your advice. I have to get back to work now, wish me luck.JJ: One last thing, Xiaogao. Just remember that the most important thing at work is getting along with your co-workers. If you have a bad relationship with them, then you will start to hate your job, or maybe your coworkers will despise(é„™è§†) you. A happy workplace is a healthy workplace! XGï¼š Got it. Okay, I gotta run. Talk to you later!JJï¼š Hey, Xiaogao! You didnâ€™t pay the bill! Waaaaiiit! Ohâ€¦ forget it! pay the bill (ä¹°å•)forget it ï¼ˆç®—äº†å§ï¼‰ 2016.6.20 A Fork in a RoadXG: Hey, Jing Jing,why do you look so vexed? vexed = annoyed (å¿ƒçƒ¦æ„ä¹±çš„) JJ: Iâ€™ve come to a fork in the road, I donâ€™t know what to do. Can you give me some advice? Come to a fork in the road = be in a position where you must make a tough decision (äººç”Ÿåšé‡è¦å†³å®šçš„å…³å£)give sb some advice/pointers/tips ï¼ˆç»™æŸäººå»ºè®®ï¼‰ XGï¼š Sure, Iâ€™ll trymy best. Whatâ€™s up?JJï¼š Well, Iâ€™ve been working as an RN at an ICU unit for the past four years, but I feel like Iâ€™ve hit a plateau. Itâ€™s the same thing over and over, the night shift is really taking a toll on me. But three years ago, a teacher got me thinking, and I started to look into nursing overseas. I began to study professional English with the hopes of one day working as a nurse abroad. RN (Registered Nurse) æ³¨å†ŒæŠ¤å£«ICU (Intensive Care Unit) é‡ç—‡ç›‘æŠ¤å®¤hit a plateau = to be unable to make any more progress (åˆ°è¾¾ç“¶é¢ˆå¤„)overcome / break out/ surmount the plateau å…‹æœç“¶é¢ˆnight shift/day shift (å¤œç­/ç™½ç­)take a toll on sb = If something takes its/a toll, it causes suffering, deaths, or damageget one thinking (å¯å‘ï¼Œç»™äº†æŸäººä¸€ä¸ªçµæ„Ÿ)look into (é’»ç ”ï¼Œç ”ç©¶) XGï¼š It sounds like a no-brainer.Whatâ€™s holding you back? no-brainer = requiring no thought; an easy decision (ä¸éœ€è¦è´¹è„‘å­çš„å†³å®š)hold sb back = make [one] hesitate ï¼ˆè®©äººçŠ¹è±«ä¸å†³ï¼‰ JJï¼š I took a test in Singapore from the SNB and passed with flying colors. Just as I was about to make my next move, my parents and boyfriend complained that I shouldnâ€™t go abroad to be a nurse. Theyâ€™re worried that I wonâ€™t be able to adapt to the way of life and work environment over there. And once I go to work abroad, Iâ€™ll lose my job here in China. My parents donâ€™t have really high expectations of me, theyâ€™ve never demanded that I find a super high paying job. As long as I am near their side theyâ€™ll be happy. pass with flying colors (é«˜åˆ†é€šè¿‡)have high expectations of/on sb (å¯¹æŸäººæœ‰å¾ˆé«˜çš„æœŸå¾…) XGï¼š Well I think that might be the problem right there. Look at what youâ€™re saying: it will make your parents happy if you stay at the same hospital. Did they ever consider what would make you happy? If youâ€™ve studied English so hard and are able to pass the Singapore test, why should they be worried about you not being able to adapt to life abroad? I think that might be the problem right there (æˆ‘è§‰å¾—è¿™å¯èƒ½å°±æ˜¯é—®é¢˜çš„æ‰€åœ¨)be adapt to env/sth (é€‚åº”â€¦) JJ: What they donâ€™t know is, Singapore was just my first step. My ultimate goal is to go to America to work as an RN. Iâ€™m confused about that too. Should I first use Singapore as a stepping stone and work there for a bit, or should I go directly to the United States to work? ultimate goal (ç»ˆæç›®æ ‡ï¼Œæœ€ç»ˆç›®æ ‡)stepping stone (å«è„šçŸ³ï¼Œæ•²é—¨ç –) XGï¼š Thatâ€™s a tough call. Considering youâ€™re only 27 years old, youâ€™re still young and can do many things. If you wait any longer, you might miss your chance. I think going to Singapore first would be a good idea because you can prepare for what it feels like to work abroad. You might also learn important skills there that will help you when you go to the United States to work. Iâ€™m 32 years old. Iâ€™m preparing to start my second Masterâ€™s degree. I had to make this decision on my own.Taking a risk and coming to China was the best decision I â€˜ve ever made in my life. tough call = a hard decisionmake a call = make a decisionyou never too old to learn sth newtake a risk (å†’é™©) JJï¼š Okay, Iâ€™m starting to feel better now. But what if I canâ€™t find a job anywhere?XG: Unless people stop becoming sick, youâ€™ll be able to find a job as a nurse anywhere on Earth. Good luck to you! 2016.6.22 Saying GoodbyeXG: Well, Jingjing, Iâ€™m afraid Iâ€™m going to have to cut my stay short here in Beijing. cut my stay short (æå‰ç¦»å¼€) We had to cut short our holiday because Richard was ill. JJ: What? You mean youâ€™re gonna split(ç¦»å¼€)? Why? I thought you liked it here?XGï¼š Donâ€™t worry, Iâ€™ll be back. Iâ€™m just going home to straighten out my visa. strainghten sth out / out sth = to solve a problem or to deal successfully with a confusing situation (è§£å†³é—®é¢˜) Once we get these problems straightened out, we should be all right.straighten sb out = to improve someoneâ€™s behaviour I thought that once he got a girlfriend that would straighten him out. JJ: Oh, okay, phew! Well, when are you coming back? phew (é‚£è¿˜å¥½ï¼Œå“å‘€ï¼Œä½ å“æ­»æˆ‘äº†ï¼Œè¯­æ°”è¯ï¼ŒæŒ‡æ¾äº†ä¸€å£æ°”) XG: Probably in a month or so. But I have to leave soon. My visa expires in a couple of days so itâ€™s a race against the clock to get back home as soon as possible. Probably in a month or so (ä¸€ä¸ªæœˆå·¦å³ï¼Œæ³¨æ„ or so)race against the clock=åˆ†ç§’å¿…äº‰ï¼ŒæŒ‡ç€æ€¥ JJ: Oh, I see. Well, when you come back hopefully youâ€™ll have all the time in the world. Itâ€™s no fun being pressed for time. Hey, do you have anyone that will send you to the airport? have all time in the world (æœ‰å¤§é‡çš„æ—¶é—´; æŒ‡ä¸å¿…æ‹…å¿ƒæˆ–æœ‰å‹åŠ›)Itâ€™s no fun being pressed for time(è¿™ä¹ˆç´§è¿«å®åœ¨å¤ªç—›è‹¦äº†)pressed for time (æ—¶é—´ç´§è¿«) XG: No, I was gonna take a cab there. Unlessâ€¦ take a cab (åå‡ºç§Ÿè½¦) JJï¼š Of course Iâ€™ll take you! You know you donâ€™t have to ask that! æ³¨æ„You know you donâ€™t have to ask that! è¯­æ°” XGï¼š Really? Youâ€™re the greatest!JJï¼š I know I am! What time does your flight leave? I know I am (æ¯”è¾ƒéª„å‚²çš„è¯´ï¼šæˆ‘ä¹Ÿè¿™ä¹ˆè®¤ä¸ºçš„)What time does your flight[äº¤é€šå·¥å…·] leave? ï¼ˆä½ çš„èˆªç­å‡ ç‚¹èµ·é£ï¼‰ XGï¼š Nine in the morning, do you think you can handle that? handle (æå®šï¼Œæ­¤å¤„ä»¥ä¸ºæ¥å¾—åŠå—) JJï¼š Iâ€™ll be at your place at 6:00 on the dot. See you then! on the dot/sharp(å‡†æ—¶å‡†ç‚¹ï¼Œåªèƒ½ç”¨åœ¨æ•´ç‚¹, å¦‚7:00 on the dotï¼Œä¸èƒ½è¯´7:15 on the dot XGï¼š I must say, Jingjing. I have to take my hat off for you, you said youâ€™d be at my place at 6:00 sharp and you were. I really appreciate it! I got to say/ I got to tell you (è€å®è¯´)take my hat for sb (è„±å¸½è‡´æ•¬)I really appreciate it JJ: No problem, you know I always keep my word. Well, right now itâ€™s only 7:00. You still have some time to kill before your plane leaves. keep my word (è¯´è¯ç®—è¯)you have my word (ä¿å¯† ä¸æ³„å¯†) renege on our deal/go back on your words/go back on your promise åæ‚”have some time to kill=æœ‰ç©ºé—²æ—¶é—´æ¥æ¶ˆç£¨ XG: Okay, letâ€™s go get a cup of coffee. Itâ€™s my treat. (Xiaogao saysto the coffee shop worker) Two cups of coffee please. Itâ€™s my treat (æˆ‘è¯·å®¢) JJ: Wow! This coffee is so strong! It just about knocked my socks off! I donâ€™t usually drink coffee this early in the morning. knock oneâ€™s socks off=ï¼ˆé€šå¸¸æŒ‡å£å‘³æˆ–æ°”å‘³ï¼‰éå¸¸æµ“çƒˆã€‚ä¾‹å¦‚ï¼Œä¸€æ¯äºŒé”…å¤´ä¼šâ€œknock XG: Yeah, this is some good stuff. You know, Jingjing, Iâ€™m really gonna miss you.JJ: Now is not the time to get all emotional. Here, I brought you a going away gift. ç°åœ¨è¿˜ä¸æ˜¯å‚¬æ³ªçš„æ—¶å€™ã€‚çœ‹ï¼Œæˆ‘ç»™ä½ å¸¦äº†ä¸€ä¸ªå‘Šåˆ«ç¤¼ç‰© XG: A gift? Why did you do that?JJ: Itâ€™s common for Chinese to give a gift when someone is coming or going. You didnâ€™t know?XG: * No, I didnâ€™t. Thatâ€™s so nice of you. Can I open it?*JJ: Be my guest. be my guest = of course è¯·ä¾¿ XG: Cool! A new watch! I needed a new one!JJ: * Iâ€™m glad you like it.*(The loud speaker at the airport says Now boarding flight1423 to Detroit.) Thatâ€™s my flight. I gotta bounce(é¢ äº†ï¼Œç¦»å¼€). Thanks for everything,Jingjing. Iâ€™ll see you when I get back. 2016.6.27 Meeting Someone at The AirportM: Hey! Long time no see! Thanks so much for picking me up! pick up sb/skill/knowledge/friend JJ: No problem! Your plane was a little late coming in. You must be beat! You must be beat (ä½ ä¸€å®šç´¯äº†å§) Iâ€™m beat åä¹‰ Iâ€™m wired M: Iâ€™m fine, I chugged a bunch of coffee on the plane, so now Iâ€™m wired. chug ï¼ˆa drinkï¼‰=çŒï¼ˆé¥®æ–™ï¼‰ drink a lot of sth very quicklywired=ç›¸å…¶å…´å¥‹çš„ JJ: So? How was your trip? Tell me all about it.M: I had a great time. It was really nice to see my family. I just wish that I could have stayed a little longer.JJ: Well, you know what they say:all good things must come to an end. You should just be happy that you even got to go on vacation at all. Iâ€™ve been working here the past month, lucky you! you know what they say, all good things must come to an end (ä¸€åˆ‡ç¾å¥½çš„äº‹ç‰©éƒ½ä¼šæœ‰å°½å¤´ï¼Œå¤©ä¸‹æ— ä¸æ•£çš„ç­µå¸­)go on vacation M: Thatâ€™s true! Oh, I almost forgot, I got a present for you while I was in America. Here you go, hope you like it! here you go å°±æ˜¯ç»™ä½ .. there you go æœ‰ç‚¹ç±»ä¼¼å½’è¿˜ä¸œè¥¿ JJ: Thanksâ€¦ but what is it?M: Itâ€™s a voodoo dollï¼ˆå·«æ¯’å¨ƒå¨ƒï¼‰.JJï¼š A what doll?M: A voodoo doll. I bought it in New Orleansï¼ˆæ–°å¥¥å°”è‰¯ï¼‰ where voodoo is heavily practicedï¼ˆç››è¡Œï¼‰. This doll will bring you luck and protection. I hope it works!JJï¼š Cool, I love it! I hope you didnâ€™t spend too much money on it?M: Nah, in New Orleans theyâ€™re a dime a dozen. a dime a dozen=å¸¸è§è€Œä¾¿å®œçš„ä¸œè¥¿ JJ: Okay, thatâ€™s good. Letâ€™s hit the road now. We should get back home before the sun goes down. hit the road (ä¸Šè·¯)sun goes down (å¤ªé˜³è½å±±) M: Well, we finally made it.Thanks again for the ride, Jingjing. give me a ride (è½½æˆ‘ä¸€ç¨‹) JJï¼š Donâ€™t mention it.M: By the way, can I give you some gas money?JJ: Donâ€™t worry about it. Just take me to the airport next month when I go to see my parents and weâ€™ll be even. weâ€™ll be even (æˆ‘ä»¬å°±æ‰¯å¹³äº†) M: Okay, cool. Hey, why donâ€™t you come in and drink a glass of lemonade(æŸ æª¬æ°´) with me before you go home? Itâ€™s the least I could do for you.JJï¼š That sounds like it will hit the spot! It seems like this heat wave will never end! Hey, while weâ€™re at it how about we watch a DVD too? hit the spot (æ­£ä¸­è¦å®³ï¼Œæ­£åˆæˆ‘æ„)heat wave (çƒ­æµªï¼Œä¸èƒ½ç”¨hotï¼Œ hot weather, heat wave) M: Iâ€™d love to, but I have to wake up at the crack of dawn tomorrow to go to work. crack of dawn (ç ´æ™“) JJï¼š Really? Geezï¼ˆå¤©å•Šï¼‰, I never knew you were such an early bird. early bird/night owl M: Yupâ€¦ Donâ€™t you wake up early to go to work too?JJ: Not as early as you. Iâ€™m more of a night owl. I like staying up late and working on my computer. Iâ€™m more of a night owl (æˆ‘å…¶å®æ˜¯ä¸ªå¤œçŒ«å­) M: Ohâ€¦ Well, letâ€™s go inside and get that ice cold glass of lemonade thatâ€™s waiting for us! dog days of summer (had nothing to doï¼Œé—²ç€ï¼Œåƒå¤å¤©ç‹—çƒ­äº†èººåœ¨åœ°ä¸Šä»€ä¹ˆä¹Ÿä¸å¹²) 2016.7.4 Donâ€™t text and driveM: Ah! Jingjing! Iâ€™m in a grind! Iâ€™m in a grind/bind (æˆ‘å¥½ç—›è‹¦ï¼Œä¸æ–¹ä¾¿ï¼Œå°´å°¬ï¼Œ æŒ‡ç²¾ç¥æƒ…æ„Ÿçš„ï¼Œä¸æ˜¯èº«ä½“ä¸Šçš„) JJ: Whatâ€™s the matter? You look like youâ€™ve seen a ghost! ï¼ˆä½ çœ‹èµ·æ¥åƒè§äº†é¬¼ä¸€æ ·ï¼‰M: Yeah, I just got in a wreck. My parents are gonna bite my head off. get in a wreck (å‡ºäº†è½¦ç¥¸ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æŠ¥é”€äº†ï¼Œæˆæœ¬å¤§äº2000ç¾å…ƒ)fender bender (è½¦ç¥¸ï¼Œæˆæœ¬å°äº2000ç¾å…ƒï¼Œå¯ä»¥ä¿®ç†)bite sb head off (yell at sb, å¤§å–Šå¤§å«ï¼ŒæŒ‡éå¸¸ç”Ÿæ°”) JJï¼š Really? Are you okay? How about your car?M: Iâ€™m fine, but my car is totaled! They gave that car to me last year when I graduated college, it cost thirty grand! I donâ€™t know what to do! totaled (â€œå®Œè›‹äº†â€ï¼Œ ä¸èƒ½ç›´æ¥è¯´totaledï¼Œéœ€è¦ç»“åˆä¸Šä¸‹æ–‡ï¼Œ I wrecked my car totally)grand (1000ç¾å…ƒ) JJï¼š Just stay calm! Accidents happen. Iâ€™m sure it wasnâ€™t your fault. stay calm (ä¿æŒå†·é™) M: Actually it was. I really goofed up, Jingjing. I was texting and driving. I wasnâ€™t paying attention to the road. goofed up/messed up/screw up (å‡ºå¤§é”™ï¼Œæç ¸äº†)text (å¯ä»¥åŠ¨è¯ä½¿ç”¨ï¼Œ Iâ€™ll text youï¼Œ æˆ‘ä¼šç»™ä½ å‘ä¿¡æ¯) JJï¼š Mark! Whatâ€™s gotten into you? That doesnâ€™t seem like something youâ€™d do! whatâ€™s gotten into you (ä½ æ˜¯æ€ä¹ˆæƒ³çš„ï¼Ÿ è„‘è¢‹è¿›æ°´äº†å—) M: I know. I donâ€™t know what I was thinking. Jingjing, what am I supposed to do?! what am I supposed to do (what should I do? ä½†æ˜¯å‰è€…æ›´å¸¸ç”¨ï¼Œè¡¨è¾¾æ›´å¥½ä¸€ç‚¹) JJï¼š Look, you need to be blunt with your parents and tell them what happened. Iâ€™m sure theyâ€™ll forgive you! After all, theyâ€™re your parents. be blunt with sb (å¦ç‡çš„è¯´ï¼Œä¸é¡¾åŠå¯¹æ–¹æ„Ÿå—ï¼Œæœ‰ç‚¹ç®€å•ç²—æš´ï¼Œåªæ˜¯å¦‚å®è¯´å‡ºæ¥) M: Okay, Iâ€™m gonna go home now and spill the beans. spill the beans (å¦‚æ˜¯è¯´ï¼Œæ›´å¼ºè°ƒå®è¯å®è¯´ï¼Œæ³¨æ„å’Œbe blunt with sb çš„åŒºåˆ«) JJï¼š So? How did it go with your parents? Are they ticked off? ticked off (ç”Ÿæ°”ï¼Œä¹‹å‰å¿äº†å‡ æ¬¡äº† è¿™æ¬¡å½»åº•çˆ†å‘äº†ï¼Œ å¿æ— å¯å¿) M: No. They were more worried than anything. They were just happy I wasnâ€™t hurt. The good news is that the insurance will cover the cost of the car. cover the cost of the car (ä¿é™©å…¬å¸å°†ä¼šèµ”ä»˜æˆ‘æ±½è½¦çš„æŸå¤±) JJ: Wow, it sounds like they are letting you off pretty easy. Whatâ€™s the catch? let sb off pretty easy(æ”¾ä½ ä¸€é©¬ï¼Œå¾ˆå®¹æ˜“çš„æ”¾è¿‡ä½ )whatâ€™s the catch (æœ‰ä»€ä¹ˆæ¡ä»¶) M: The catch is that they are making me pay the deductable(æŠµæ‰£æ¬¾), and they told me Iâ€™m not allowed to send text for a month.JJï¼š No text messages? I think I would go bananas! I love sending texts. I bet you canâ€™t wait for this month to go by, huh? go bananas (ç–¯æ‰äº†ï¼Œä½†æ˜¯æ²¡æœ‰ä¼¤å®³çš„ï¼Œno harm) M: Thatâ€™s right, next month Iâ€™ll be like a dog with two tails. Although, I swear Iâ€™ll never send another text while driving again. Iâ€™ll be like a dog with two tails (æ¢å¤è‡ªç”±äº†ï¼ŒæŒ‡éå¸¸é«˜å…´) JJï¼š Look on the bright side, at least youâ€™ll save a lot of money this month by not having to send texts. Texting can be expensive. look on the bright/down/dark side (å¾€å¥½å¤„/åå¤„æƒ³) M: Thatâ€™s true! I never thought about that. With all this left over money(çœä¸‹æ¥çš„é’±), I think I might go buy some books that Iâ€™ve been wanting to read.JJï¼š See, Mark. This whole ordealï¼ˆç£¨éš¾ï¼‰ has turned out to be a blessing in disguise. turn out to be a blessing in disguise (å› ç¥¸å¾—ç¦) M: Hey, how come you always seem to cheer me up? Do you have magical powers or something? cheer sb up (é¼“åŠ±æŸäººï¼Œæ¿€åŠ±æŸäºº) JJï¼š No, Iâ€™m just awesome!ï¼ˆæˆ‘å°±æ˜¯å¤©æ‰ï¼Œæ¯”è¾ƒéª„å‚²çš„å£å»ï¼‰ Thatâ€™s allâ€¦ è‹±è¯­è¯­æ³•å®šè¯­ä»å¥å®šè¯­ä»å¥ç›¸å…³åŸºæœ¬æ¦‚å¿µ å®šè¯­ä»å¥çš„å®šä¹‰ï¼šç”¨ä½œå®šè¯­çš„ä»å¥å«å®šè¯­ä»å¥ å®šè¯­ä»å¥ç»“æ„ï¼šå…ˆè¡Œè¯ + å¼•å¯¼è¯ + å®šè¯­ä»å¥ å…ˆè¡Œè¯ï¼šè¢«å®šè¯­ä»å¥æ‰€ä¿®é¥°çš„åè¯æˆ–ä»£è¯ å®šè¯­ä»å¥çš„ä½ç½®ï¼šç´§è·Ÿå…ˆè¡Œè¯ï¼ˆåè¯æˆ–ä»£è¯ï¼‰ä¹‹å å¼•å¯¼è¯ï¼šå¼•å¯¼å®šè¯­ä»å¥çš„è¯ï¼ˆåŒ…æ‹¬å…³ç³»ä»£è¯å’Œå…³ç³»å‰¯è¯ï¼‰ å…³ç³»ä»£è¯ï¼šthat/who/whom/which/as å…³ç³»å‰¯è¯ï¼šwhen/where/why å¼•å¯¼è¯çš„åŠŸèƒ½ è¿æ¥å…ˆè¡Œè¯å’Œå®šè¯­ä»å¥ã€‚ï¼ˆç›¸å½“äºæ¡¥æ¢ï¼‰ *I like the book which I bought. * åœ¨å®šè¯­ä»å¥ä¸­å……å½“ä¸€å®šçš„æˆåˆ†ï¼ˆå…³ç³»ä»£è¯å……å½“ä¸»è¯­æˆ–å®¾è¯­ï¼Œå…³ç³»å‰¯è¯å……å½“çŠ¶è¯­ï¼‰ã€‚ *This is the man who studied with me. *ï¼ˆå…³ç³»ä»£è¯åšä¸»è¯­ï¼‰ This is the man with whom I studied. * (å…³ç³»ä»£è¯åšå®¾è¯­, å°†ä»‹è¯æå‰) å®šè¯­ä»å¥ç±»å‹å®šè¯­ä»å¥æœ‰é™åˆ¶æ€§å’Œéé™åˆ¶æ€§ä¸¤ç§ã€‚é™åˆ¶æ€§å®šè¯­ä»å¥æ˜¯å…ˆè¡Œè¯ä¸å¯ç¼ºå°‘çš„éƒ¨åˆ†ï¼Œå»æ‰å®ƒä¸»å¥æ„æ€å¾€å¾€ä¸æ˜ç¡®ï¼›éé™åˆ¶æ€§å®šè¯­ä»å¥æ˜¯å…ˆè¡Œè¯çš„é™„åŠ è¯´æ˜ï¼Œå»æ‰äº†ä¹Ÿä¸ä¼šå½±å“ä¸»å¥çš„æ„æ€ï¼Œå®ƒä¸ä¸»å¥ä¹‹é—´é€šå¸¸ç”¨é€—å·åˆ†å¼€ï¼Œä»¥ä¸‹æ˜¯ç®€å•ä¾‹å­è¯´æ˜ï¼š This is the house which I bought last month ï¼ˆé™åˆ¶æ€§å®šè¯­ä»å¥ï¼‰ The house, which I bought last month, is very nice (éé™å®šæ€§å®šè¯­ä»å¥) (ä¸€) é™åˆ¶æ€§å®šè¯­ä»å¥ï¼ˆä¸»å¥å’Œå®šè¯­ä»å¥ä¹‹é—´æ— é€—å·éš”å¼€ï¼‰ The man who youâ€™re talking to is my friend. The man to whom youâ€™re talking is my friend. I need a pencil with which I can write a letter I need a piece of paper on which I can write a letter The man (*who/whom/that** éƒ½å¯ä»¥) I talked about at the meeting is from Peking University. * The man about whom I talked at the meetingï¼‰is from Peking University. The palace (which/that éƒ½å¯ä»¥) I often pay a visit to was built in the 17th century. The palace to which I often pay a visit was built in the 17th century æ€»ç»“ï¼š ä»‹è¯å¯ä»¥æ”¾åˆ°å…³ç³»ä»£è¯ä¹‹å‰ä¹Ÿå¯ä»¥æ”¾åœ¨å¥å­æœ«å°¾ï¼Œæ”¾åœ¨å…³ç³»ä»£è¯ä¹‹å‰æ˜¯å¾ˆåœ°é“çš„ä¹¦å†™æ–¹å¼ï¼Œä»‹è¯åªèƒ½åŠ å®¾è¯­ï¼Œäºæ˜¯åªæœ‰ ä»‹è¯+which å’Œ ä»‹è¯+whomä¸¤ç§å½¢å¼ï¼Œ whoåœ¨å®šè¯­ä»å¥ä¸­æ—¢å¯ä»¥åšä¸»è¯­ä¹Ÿå¯ä»¥åšå®¾è¯­ï¼Œä½œå®¾è¯­å¯ä»¥ä¸whomäº’æ¢ï¼Œä½†æ˜¯å¦‚æœæœ‰ä»‹è¯ï¼Œå¿…é¡»è¦ç”¨whomï¼Œ å¦å¤–paperå•ç‹¬æŒ‡è®ºæ–‡ï¼Œä¸€é¡µçº¸è¦ç”¨a piece of paper, åŒ—äº¬å¤§å­¦è¦ç”¨Peking Universityï¼ŒBJ UniversityæŒ‡åŒ—äº¬çš„å¤§å­¦ã€‚ (äºŒ) éé™åˆ¶æ€§å®šè¯­ä»å¥ ï¼ˆä¸»å¥å’Œå®šäºä»å¥ä¹‹é—´æœ‰é€—å·åˆ†éš”ï¼‰å½“å½“å…ˆè¡Œè¯æ˜¯ä¸“æœ‰åè¯æˆ–ç‰©ä¸»ä»£è¯å’ŒæŒ‡ç¤ºä»£è¯æ‰€ä¿®é¥°æ—¶ï¼Œå…¶åçš„å®šè¯­ä»å¥é€šå¸¸æ˜¯éé™åˆ¶æ€§çš„ Charles Smith, who was my former teacther, retired last year My house, which I bought last month, has got a lovely garden The novel, which I have reading three times, is very touching éé™åˆ¶æ€§å®šè¯­ä»å¥è¿˜èƒ½å°†æ•´ä¸ªä¸»å¥ä½œä¸ºå…ˆè¡Œè¯,å¯¹å…¶è¿›è¡Œä¿®é¥°,è¿™æ—¶ä»å¥è°“è¯­åŠ¨è¯è¦ç”¨ç¬¬ä¸‰äººç§°å•æ•° He seems not to have grasped what I meant, which greatly upsets me ä»–ä¼¼ä¹æ²¡æŠ“ä½æˆ‘çš„æ„æ€ï¼Œè¿™ä½¿æˆ‘å¿ƒçƒ¦ ç”±ä»‹è¯+å…³ç³»ä»£è¯ï¼ˆwhom/whichï¼‰å¼•å¯¼ I live in a house far away from city, in front of which is a big tree. å…¶ä¸­far away from city åšåç½®å®šè¯­ There is an apple tree standing there at the gate, on which are many apples ç”±â€œä»£è¯/åè¯+of+whom/whichâ€æˆ–â€œof which/ whom +åè¯/ä»£è¯â€(å…ˆè¡Œè¯æŒ‡äººç”¨whom,æŒ‡ç‰©ç”¨which)å¼•å¯¼ã€‚One, some, any, none,all, both, several, many, most, neither, eitherç­‰è¯ã€æ•°è¯ã€åˆ†æ•°æˆ–ç™¾åˆ†æ¯”ä¸of whomæˆ–of whichè¿ç”¨ã€‚ He has five children, two of whom are abroad. (He has five children, and two of them are abroad. å¤–å›½äººä¸å–œæ¬¢é‡å¤ï¼Œæ‰€ä»¥å°†è¿è¯å»æ‰å¹¶ä¸”æŠŠthemæ¢æˆwhichï¼Œ å› ä¸ºè¿™é‡Œwhichå°±æ˜¯æŒ‡ä»£them) We have three books, none of which is/are interesting. (We have three books, but none of them is/are interesting é“ç†åŒä¸Š) whoseå¼•å¯¼éé™å®šæ€§å®šè¯­ä»å¥ The house, whose window faces South, is mine æ³¨æ„ï¼š å…³ç³»ä»£è¯thatå’Œå…³ç³»å‰¯è¯whyä¸èƒ½å¼•å¯¼éé™åˆ¶æ€§å®šè¯­ä»å¥ å¼•å¯¼è¯ï¼ˆå…³ç³»ä»£è¯ï¼‰that/which/whoç”¨æ³•è¯¦è§£ï¼ˆä¸€ï¼‰ å½“å…ˆè¡Œè¯æ˜¯ç‰©æ—¶ï¼Œå…³ç³»ä»£è¯(that/which)åªç”¨thatçš„æƒ…å†µ å½“å…ˆè¡Œè¯è¢«åºæ•°è¯æˆ–å½¢å®¹è¯æœ€é«˜çº§ä¿®é¥°æ—¶ï¼Œåªèƒ½ç”¨that, å½“ç„¶thatä¹Ÿå¯ä»¥çœç•¥This is the best film that has been shown this year.This is the first book that I borrow from the libraryHe is the first student that/who came to school today (student æ˜¯äººï¼Œæ‰€ä»¥å¯ä»¥ç”¨who) å½“å…ˆè¡Œè¯ä¸ºä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šåˆ†åˆ«æŒ‡äººå’Œç‰©çš„åè¯æ—¶ï¼Œåªèƒ½ç”¨thatHe talked about the teachers and the school that he had visited. å½“å…ˆè¡Œè¯æœ¬èº«æ˜¯allçš„ï¼Œåªèƒ½ç”¨thatAll that(what) I want to say to you is â€œThank youâ€ (all that=what)Go over all that (what) we learned å…ˆè¡Œè¯ä¸ºsomething, anything, nothing, everything, thingæ—¶, åªèƒ½ç”¨thatIâ€™ll tell you anything that I know. å½“å…ˆè¡Œè¯å‰æœ‰all, much, little, many, (a) few, every, some, any, no, only, the very, one of, the only, the last, the nextç­‰ä¿®é¥°è¯­æ—¶This is one of the books in which Iâ€™m very interested ï¼ˆæœ‰ä»‹è¯å°±è¦ç”¨whichï¼‰This is the only book that I read.He is the only one of the boys that likes playing the piano. å½“å…ˆè¡Œè¯åœ¨ä»¥whoæˆ–whichå¼€å¤´çš„ç‰¹æ®Šç–‘é—®å¥ä¸­æ—¶ï¼Œç”¨thatå¼•å¯¼ä»¥é¿å…æ··æ·†ï¼Who is the man that is talking with the lady?Which of you that know the answer can come to the front? å½“å…ˆè¡Œè¯æ˜¯åœ¨å®šè¯­ä»å¥ä¸­ä½œè¡¨è¯­æ—¶ï¼Œç”¨thatHe likes the girl that sheused to be. ï¼ˆäºŒï¼‰å½“å…ˆè¡Œè¯æ˜¯ç‰©æ—¶ï¼Œå…³ç³»ä»£è¯(that/which)åªç”¨whichçš„æƒ…å†µ ä½œä»‹å®¾ä¸”ä»‹è¯ç½®äºå¼•å¯¼è¯ä¹‹å‰æ—¶ï¼The room in which he lives is very large. å¼•å¯¼éé™å®šæ€§å®šè¯­ä»å¥æ—¶ï¼ˆä¸»ï¼Œå®¾éƒ½ç”¨which,éƒ½ä¸èƒ½çœç•¥ï¼‰Football, which is a very interesting game, is played all over the world.The house, which I visited yesterday, is very large. whichæŒ‡æ•´ä¸ªå¥å­çš„å†…å®¹æˆ–éƒ¨åˆ†å†…å®¹ï¼Œå¼•å¯¼éé™å®šæ€§å®šè¯­ä»å¥He always makes fun of me, which upsets me. ï¼ˆä¸‰ï¼‰å…¶ä»–ç‰¹æ®Šæƒ…å†µ å…ˆè¡Œè¯æ˜¯these, thoseæŒ‡äººæ—¶ï¼Œå…³ç³»ä»£è¯åªç”¨whoThose who are playing over there are my students å…ˆè¡Œè¯æ˜¯äººç§°ä»£è¯(he, sheâ€¦)æ—¶ï¼Œå…³ç³»ä»£è¯åªç”¨whoHe who doesnâ€™t reach the Great Wall is not a true man ä¸å®šä»£è¯someone, anyone,everyone, no one, somebody, anybody, everybodyä½œå…ˆè¡Œè¯æ—¶ï¼Œå…³ç³»ä»£è¯ç”¨whoAnybody who breaks the rules would be pubnished (æ³¨æ„æ˜¯breaksï¼ŒAnybodyåœ¨æ„æ€ä¸ŠæŒ‡â€œå…¨éƒ¨â€ï¼Œ è¯­æ³•ä¸Šåªåšç¬¬ä¸‰äººç§°å•æ•°ç”¨) å…ˆè¡Œè¯æ˜¯the only one of +å¯æ•°åè¯å¤æ•°ï¼Œåœ¨å®šè¯­ä»å¥ä¸­ä½œä¸»è¯­æ—¶ï¼Œå®šè¯­ä»å¥ä¸­çš„è°“è¯­ç”¨å•æ•°å½¢å¼, å› ä¸ºæ­¤æ—¶é™å®šçš„æ˜¯the only one æ³¨æ„ä»¥ä¸‹ä¸¤ä¸ªä¾‹å¥å®šè¯­ä»å¥speakçš„å½¢å¼åŒºåˆ«He is the only one of the students who(å£è¯­)/that speaks Japanese in our classHe is one of the students who speak Japanese in our class å½“å…ˆè¡Œè¯æ˜¯the way, åœ¨å®šè¯­ä»å¥ä¸­å……å½“æ–¹å¼çŠ¶è¯­æ—¶ï¼ˆthe wayè¡¨ï¼‚ä»¥â€¦æ–¹å¼ï¼æ–¹æ³•ï¼‚ï¼‰ï¼Œå¼•å¯¼è¯é€šå¸¸ç”¨thatæˆ–çœç•¥ï¼Œä¹Ÿå¯ç”¨in whichï¼I donâ€™t like the way (that) you speakI donâ€™t like the way in which you speak å…³ç³»ä»£è¯æˆ–å…³ç³»å‰¯è¯åœ¨ä»å¥ä¸­å……å½“ä¸€ä¸ªå¥å­æˆåˆ†ï¼Œå› æ­¤è¦æ³¨æ„é¿å…ä»å¥ä¸­å¥å­æˆåˆ†çš„é‡å¤å‡ºç°This isthe most beautiful place that I have visited it. (é”™è¯¯: ité‡å¤ï¼Œthatåœ¨è¿™é‡Œå·²ç»åšå®¾è¯­ ï¼‰his isthe most beautiful place thatI have visited å®šè¯­ä»å¥ä¸­å…³ç³»ä»£è¯æˆ–å…³ç³»å‰¯è¯çš„é€‰æ‹©å–å†³äºå®ƒä»¬åœ¨ä»å¥ä¸­æ‰€å……å½“çš„å¥å­æˆåˆ†ã€‚å¦‚ä½œä¸»è¯­å’Œå®¾è¯­ç”¨å…³ç³»ä»£è¯ï¼›ä½œçŠ¶è¯­ï¼Œç”¨å…³ç³»å‰¯è¯Iâ€™ll never forget the day when I went abroad myself.æˆ‘æ°¸è¿œè®°å¾—æˆ‘ç‹¬è‡ªåœ¨å›½å¤–çš„æ—¥å­, ï¼ˆè¿™é‡Œçš„the day æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼ŒæŒ‡ä¸€æ®µæ—¥å­ï¼‰Iâ€™ll never forget the days that we spent together.æˆ‘æ°¸è¿œä¸ä¼šå¿˜è®°æˆ‘ä»¬ä¸€èµ·åº¦è¿‡çš„é‚£äº›å¤©/æ—¥å­, (è¿™é‡Œçš„the daysæ˜¯ä¸€ä¸ªå…·ä½“çš„æ¦‚å¿µ) the day (minute)ç­‰è¡¨æ—¶é—´çš„å•æ•°åè¯å+å…³ç³»å‰¯è¯when ï¼ˆè¡¨æŠ½è±¡çš„ä¸€æ®µæ—¶é—´ï¼‰the days(minutes)ç­‰è¡¨æ—¶é—´çš„å¤æ•°åè¯å+å…³ç³»ä»£è¯that ã€which ï¼ˆè¡¨å…·ä½“çš„ä¸€æ®µæ—¶é—´ï¼‰ å®šä»ç»å…¸ç»„åˆï¼ˆä»‹è¯+å…³ç³»ä»£è¯ï¼‰åå¤§éš¾ç‚¹Note: ä»‹è¯+å…³ç³»ä»£è¯ä¸»è¦çœ‹ç»“æ„ï¼ˆä¸€ï¼‰ ä»‹è¯+whichåœ¨å®šè¯­ä»å¥ä¸­åˆ†åˆ«ä½œæ—¶é—´ã€åœ°ç‚¹å’ŒåŸå› çŠ¶è¯­ï¼Œä»£æ›¿ç›¸åº”çš„å…³ç³»å‰¯è¯when,whereå’Œwhyï¼Œä»‹è¯+whichåˆåŒ– when/where/why I still remember the day on which(when) I first came to school ï¼ˆæˆ‘ä»ç„¶è®°å¾—å½“åˆæ¥å­¦æ ¡çš„é‚£ä¸€å¤©ï¼‰ ç†è§£ï¼š I came to school on the day.2. The factory in which(where) I work is a large one. (æˆ‘å·¥ä½œçš„å·¥å‚æ˜¯ä¸€ä¸ªå¤§å·¥å‚)ç†è§£ï¼š factoryä¸å¯èƒ½åšworkçš„å®¾è¯­ï¼ˆå·¥ä½œå·¥å‚ï¼‰ï¼Œ æ˜¯åœ¨å·¥å‚å·¥ä½œï¼Œ I work in the factory3. This is the reason for which(why) he was late (è¿™å°±æ˜¯ä»–ä¸ºä»€ä¹ˆè¿Ÿåˆ°çš„åŸå› )ç†è§£ï¼š reasonä¸å¯èƒ½åšlateçš„å®¾è¯­ï¼Œ be late forå› ä¸ºä»€ä¹ˆè¿Ÿåˆ° ï¼ˆäºŒï¼‰ ä»‹è¯+whichï¼ˆæŒ‡ç‰©ï¼‰/ whomï¼ˆæŒ‡äººï¼‰åœ¨å®šè¯­ä»å¥ä¸­ä½œåœ°ç‚¹çŠ¶è¯­ï¼Œè¡¨ç¤ºå­˜åœ¨å…³ç³»ï¼Œå®šè¯­ä»å¥ä¸»è°“ä¸€èˆ¬è¦å€’ç½®ã€‚ æ‰“å—è¾¹æ¥äº†ä¸€ä¸ªå–‡å˜›ï¼›èƒŒä¸ŠèƒŒç€ä¸€ä¸ªèƒ–å¨ƒå¨ƒ They arrived at a farm house, in front of which sat a small boy ä»–æ¥åˆ°ä¸€å¤„å†œèˆï¼Œ(å†œèˆ)å‰è¾¹åç€ä¸€ä¸ªå°ç”·å­©ã€‚ ç†è§£ï¼š a small boy sat in front of the farm houseï¼ˆæ­¤æ—¶a small boyæ˜¯ä¸»è¯­ï¼Œ sat æ˜¯è°“è¯­ï¼‰, åœ°ç‚¹çŠ¶è¯­åšä¸»è¯­ä¹‹åï¼Œä¸»è°“å€’è£…ï¼Œ a small boy åšsatçš„å®¾è¯­2. I saw a man,on the head of whom stood a bird.ç†è§£ï¼š é“ç†åŒä¸Š a bird stood on the head of a man. åœ°ç‚¹çŠ¶è¯­åœ¨å‰ï¼Œä¸»è°“å€’è£… ï¼ˆä¸‰ï¼‰ ä»‹è¯+ whichï¼ˆæŒ‡ç‰©ï¼‰/ whomï¼ˆæŒ‡äººï¼‰åœ¨å®šè¯­ä»å¥ä¸­ä½œç›®çš„ã€æ–¹å¼æˆ–åœ°ç‚¹çŠ¶è¯­ã€‚è¿™ç§ç»“æ„ä¸­çš„ä»‹è¯ä¸€èˆ¬å—åŠ¨è¯æˆ–ä»‹è¯åçš„åè¯æ‰€åˆ¶çº¦ã€‚æ‰¾å®šè¯­ä»å¥é‡Œçš„åŠ¨è¯çœ‹å®ƒåº”è¯¥æ­é…ä»€ä¹ˆä»‹è¯ Could you tell me for whom you brought this coat (ä½ èƒ½å‘Šè¯‰æˆ‘è¿™ä»¶è¡£æœæ˜¯ç»™è°ä¹°çš„å—ï¼Ÿ) ç†è§£ï¼š buy sth for sb, for whom åœ¨æ­¤å¤„æ˜¯ç›®çš„ï¼ŒæŒ‡ç»™æŸäºº2. The man, from whom I learned the news, is an engineer. (è¿™äººæ˜¯ä¸€ä½å·¥ç¨‹å¸ˆï¼Œæˆ‘æ˜¯ä»ä»–é‚£é‡Œå¾—åˆ°è¿™æ¶ˆæ¯çš„ã€‚)ç†è§£ï¼š learn sth from sb ï¼Œæ­¤å¤„æ˜¯æ–¹å¼ ï¼ˆå››ï¼‰ ä»‹è¯+which/whomï¼Œç”¨äºè¢«åŠ¨ç»“æ„çš„å®šè¯­ä»å¥ä¸­ï¼Œä½œçŠ¶è¯­ï¼Œè¯´æ˜åŠ¨ä½œçš„å‘å‡ºè€…ã€‚ è¢«åŠ¨çš„ä½¿ç”¨æ˜¯ä¸ºäº†æ›´åŠ å¼ºè°ƒåŠ¨ä½œå‘å‡ºè€…çš„å‰å®³ The wolf by which the sheep was killed was shot (ä¼¤å®³ç¾Šçš„é‚£åªç‹¼è¢«æ‰“æ­»äº†) ç†è§£ï¼š the sheep was killed by the wolf, ä¸Šé¢å¥å­ä¸­çš„whichå°±æ˜¯è¡¨ç¤ºthe wolf.2. The man by whom the wolf was shot was a good hunter. æ‰“æ­»ç‹¼çš„é‚£äººæ˜¯ä¸ªå¥½çŒæ‰‹ã€‚ç†è§£ï¼š the wolf was shot by the man, ä¸Šé¢å¥å­ä¸­çš„whomè¡¨ç¤ºthe man å€’è£…å¥è‹±è¯­å€’è£…ç»“æ„çš„å…­å¤§å½¢å¼è¯¦è§£ï¼ˆä¸€ï¼‰ å¦å®šå‰¯è¯ä½äºå¥é¦–æ—¶çš„å€’è£…åœ¨æ­£å¼æ–‡ä½“ä¸­ï¼Œnever, seldom, rarely, little,hardly, scarcely, no sooner, no longer, nowhere ç­‰å«æœ‰å¦å®šæ„ä¹‰çš„å‰¯è¯è‹¥ä½äºå¥é¦–ï¼Œåˆ™å…¶åè¦ç”¨éƒ¨åˆ†å€’è£…ï¼š I shall never forgive him -&gt; Never shall I forgive him. æˆ‘æ°¸è¿œä¸ä¼šå®½æ•ä»–ã€‚ He seldom goes out for dinner -&gt; Seldom does he go out for dinner. ä»–å¾ˆå°‘å‡ºå»åƒé¥­ã€‚ She hardly has time to listen to music -&gt; Hardly does she have time to listen to music. å¥¹å‡ ä¹æ²¡æ—¶é—´å¬éŸ³ä¹ã€‚ He little realizes how important this meeting is -&gt; Little doeshe realize how important this meeting is. ä»–ä¸ç”šæ˜ç™½è¿™ä¸ªä¼šè®®çš„é‡è¦æ€§ We had no sooner reached the airport than the plane took off -&gt; No sooner had we reached the airport than the plane took off. æˆ‘ä»¬åˆšåˆ°æœºåœº,é£æœºå°±èµ·é£äº†ã€‚ æ³¨æ„ï¼š in no time(ç«‹å³ï¼Œé©¬ä¸Š)ä½äºå¥é¦–æ—¶ï¼Œå…¶åæ— éœ€ç”¨å€’è£…è¯­åºï¼š In no time he worked out the problem. ä»–é©¬ä¸Šå°±ç®—å‡ºäº†é‚£é“é¢˜ã€‚ (äºŒ) only+çŠ¶è¯­â€ä½äºå¥é¦–æ—¶çš„å€’è£…å½“ä¸€ä¸ªçŠ¶è¯­å—å‰¯è¯onlyçš„ä¿®é¥°ä¸”ç½®äºå¥é¦–æ—¶ï¼Œå…¶åç”¨éƒ¨åˆ†å€’è£…è¯­åºï¼š Only then did he realize that he was wrong. åˆ°é‚£æ—¶ä»–æ‰æ„è¯†åˆ°ä»–é”™äº†ã€‚ Only in this way are you able to do it well. ä½ åªæœ‰ç”¨è¿™ç§æ–¹æ³•æ‰èƒ½æŠŠå®ƒåšå¥½ã€‚ Only when he returned home did he realize what had happened. å½“ä»–å›åˆ°å®¶é‡Œæ—¶ï¼Œæ‰çŸ¥é“å‡ºäº†ä»€ä¹ˆäº‹ã€‚ (ä¸‰) so+adj. / adv.â€ä½äºå¥é¦–æ—¶çš„å€’è£…å‰¯è¯soåæ¥å½¢å®¹è¯æˆ–å‰¯è¯ä½äºå¥é¦–æ—¶ï¼Œå…¶åç”¨éƒ¨åˆ†å€’è£… The weather was so cold that we had to stay at home. -&gt; So cold was the weather that we had to stay at home. å¤©æ°”å¤ªå†·ï¼Œæˆ‘ä»¬åªå¥½å‘†åœ¨å®¶é‡Œã€‚ Light travels so fast that we can hardly imagine its speed -&gt; So fastdoes light travel that we can hardly imagine its speed. å…‰é€Ÿå¾ˆå¿«ï¼Œæˆ‘ä»¬å‡ ä¹æ²¡æ³•æƒ³åƒå®ƒçš„é€Ÿåº¦ã€‚ The attack was so sudden that we had no time to escape -&gt; So suddenwas the attack that we had no time to escape. è¢­å‡»æ¥å¾—éå¸¸çªç„¶ï¼Œæˆ‘ä»¬æ¥ä¸åŠé€ƒè·‘ã€‚ æ€»ç»“ï¼š æ­¤ç±»å‹çš„åŸå¥å°±æ˜¯soâ€¦that (å¦‚æ­¤.. ä»¥è‡³äº..) (å››) so+åŠ©åŠ¨è¯+ä¸»è¯­â€å€’è£…å½“è¦è¡¨ç¤ºå‰é¢æå‡ºçš„æŸä¸€è‚¯å®šçš„æƒ…å†µä¹ŸåŒæ ·é€‚åˆäºåè€… You are young and so am I. (ä½ å¹´è½»ï¼Œæˆ‘ä¹Ÿå¹´è½») æ³¨æ„ï¼š ä¸èƒ½çœç•¥and, so am I æ˜¯ä¸€ä¸ªå¥å­ï¼Œéœ€è¦è¿æ¥She likes music and so do I. (å¥¹å–œæ¬¢éŸ³ä¹ï¼Œæˆ‘ä¹Ÿå–œæ¬¢ï¼‰If he can do it,so can I. (è¦æ˜¯ä»–èƒ½åšæ­¤äº‹ï¼Œæˆ‘ä¹Ÿèƒ½) æ³¨æ„â€œé€—å·â€çš„ä½¿ç”¨ï¼Œ æ¡ä»¶ä»å¥è‹¥å‰é¢æå‡ºæŸä¸€å¦å®šçš„æƒ…å†µï¼Œè¦è¡¨ç¤ºåè€…ä¹Ÿå±äºåŒæ ·çš„å¦å®šæƒ…å†µï¼Œåˆ™åº”å°†å…¶ä¸­çš„soæ”¹ä¸ºneitheræˆ–norYou arenâ€™t young and neither am I. (ä½ ä¸å¹´è½»ï¼Œæˆ‘ä¹Ÿä¸å¹´è½»)She hasnâ€™t read it and nor have I. (å¥¹æ²¡æœ‰è¯»å®ƒï¼Œæˆ‘ä¹Ÿæ²¡æœ‰è¯»)æ³¨æ„è¯¥ç»“æ„ä¸è¡¨ç¤ºå¼ºè°ƒæˆ–åŒæ„çš„â€œso+ä¸»è¯­+ç‰¹æ®ŠåŠ¨è¯â€ç»“æ„çš„åŒºåˆ«, æ­¤ç§æƒ…å†µä¸éœ€è¦å€’è£…A: â€œIt was cold yesterday.(æ˜¨å¤©å¾ˆå†·)â€ B: â€œSo it was. (çš„ç¡®å¾ˆå†·)â€A: â€œFather, you promised.(çˆ¸çˆ¸ï¼Œä½ ç­”åº”è¿‡çš„)â€ B: â€œWell,so I did. ï¼ˆå—¯ï¼Œæ˜¯ç­”åº”è¿‡ï¼‰â€æ³¨æ„ï¼š so + adj/adv åŸºæœ¬å¯ä»¥äº’æ¢such a/an + adj + n, suchå¼€å¤´çš„ä¹Ÿè¦å€’è£…ï¼Œä½†æ˜¯äº’æ¢æœ‰æ—¶ä¼šæ”¹å˜è¡¨è¾¾æƒ…æ„Ÿ ï¼ˆäº”ï¼‰ ç”±not onlyâ€¦but alsoå¼•å‡ºçš„å€’è£…å½“not onlyâ€¦but alsoä½äºå¥é¦–å¼•å‡ºå¥å­æ—¶ï¼Œnot only åçš„å¥å­é€šå¸¸ç”¨éƒ¨åˆ†å€’è£…å½¢å¼ï¼Œ but also åé¢æ­£å¸¸è¯­åº Not only is he a teacher, but also he is a poet. (ä»–ä¸ä»…æ˜¯ä¸€ä½æ•™å¸ˆï¼Œè€Œä¸”æ˜¯ä¸€ä½è¯—äºº)Not only did he speak more correctly, but also he spoke more easily. (ä¸ä»…ä»–è®²å¾—æ›´æ­£ç¡®ï¼Œä¹Ÿè®²å¾—æ›´ä¸è´¹åŠ²äº†) æ³¨æ„ï¼š not only .. but also ä¸­but alsoä¸ä¸€å®šéè¦è¿åœ¨ä¸€èµ·ï¼Œä¹Ÿå¯ä»¥åªç•™butæˆ–åªç•™also ï¼š Not only is he a teacher, but he is also a poet (è¿™æ ·å†™æ›´èˆ’æœåœ°é“) (å…­) è™šæ‹Ÿæ¡ä»¶å¥çš„çœç•¥ä¸å€’è£…å½“ifå¼•å¯¼çš„è™šæ‹Ÿæ¡ä»¶ä»å¥ä¸­å«æœ‰had, were, shouldç­‰æ—¶ï¼Œå¦‚å°†ifçœç•¥ï¼Œåˆ™è¦å°†had, were, shouldç­‰ç§»åˆ°ä¸»è¯­å‰ï¼Œæ„æˆå€’è£…å¥ If you had come yesterday, you would have seen him. -&gt; Had you come yesterday, you would have seen him.If you should require anything give me a ring. -&gt; Should you require anything give me a ring.If it were not for your help,I would still be homeless. -&gt; Were it not for your help, I would still be homeless. (è¦ä¸æ˜¯ä½ å¸®åŠ©ï¼Œæˆ‘ä¼šä»ç„¶æ— å®¶å¯å½’)çœç•¥ifåæå‰çš„hadä¸ä¸€å®šæ˜¯åŠ©åŠ¨è¯If I had money, I would buy it. -&gt; Had I money, I would buy it. (æ­¤å¤„çš„hadæ˜¯å®æ„åŠ¨è¯) ï¼ˆä¸ƒï¼‰ As å¼•å¯¼çš„è®©æ­¥çŠ¶è¯­ä»å¥å€’è£…asä½œâ€œè™½ç„¶â€è§£ï¼Œå¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥æ—¶ï¼Œå¿…é¡»å°†è¡¨è¯­ã€çŠ¶è¯­æˆ–åŠ¨è¯åŸå½¢æåˆ°aså‰é¢ã€‚æ­¤æ—¶åº”æ³¨æ„å‡ ç‚¹ï¼š è‹¥æå‰çš„è¡¨è¯­æ˜¯æ²¡æœ‰å½¢å®¹è¯ä¿®é¥°çš„å•æ•°å¯æ•°åè¯ï¼Œè¦çœç•¥ä¸å®šå† è¯ï¼› è‹¥æå‰çš„æ˜¯åŠ¨è¯åŸå½¢(å¤šä¸ºä¸åŠç‰©åŠ¨è¯)ï¼Œä¸ä¹‹è¿ç”¨çš„é€šå¸¸æ˜¯may, might, will, wouldç­‰ï¼Œä¸”è¿™äº›è¯éƒ½è¦ä¿ç•™åœ¨åŸæ¥çš„ä½ç½®ä¸Š(ä¸»è¯­å)ï¼› thoughæœ‰æ—¶ä¹Ÿå¯åƒasè¿™æ ·ä½¿ä½œå€’è£…ï¼Œ althoughç»å¯¹ä¸èƒ½å€’è£…** Tiredï¼ˆå½¢å®¹è¯ï¼‰ as I was, I tried to help them. è™½ç„¶æˆ‘å¾ˆç´¯ï¼Œæˆ‘è¿˜æ˜¯åŠªåŠ›å¸®åŠ©ä»–ä»¬ã€‚ =Although I was tired, I tried to help them.Tryï¼ˆåŠ¨è¯ï¼‰ as he would, he couldnâ€™t open the door. ä»–è¯•è¿‡å¤šæ¬¡äº†, å´ä»æ‰“ä¸å¼€é‚£é—¨ã€‚ =Although he would try, he couldnâ€™t open the door.Search(åŠ¨è¯ï¼‰ as they would, they would find nobody in the house. æ— è®ºæ€æ ·æœæŸ¥ï¼Œä»–ä»¬åœ¨æˆ¿å­é‡Œä»ç„¶æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªäººã€‚ =Although they would search, they would find nobody in the house.Hard(å‰¯è¯ï¼‰ as (though) they tried, they couldnâ€™t make her change her mind. å°½ç®¡ä»–ä»¬åšäº†å¾ˆå¤§åŠªåŠ›ï¼Œå´æ²¡æ³•è®©å¥¹æ”¹å˜ä¸»æ„ã€‚ =Although they tried hard, they couldnâ€™t make her change her mind.Boy(åè¯æ— å† è¯ï¼‰ as he was, he behaved like a girl. ä»–è™½æ˜¯ä¸ªç”·å­©ï¼Œä½†ä¸¾æ­¢å´åƒä¸ªå¥³å­©ã€‚ =Although he was a boy, he behaved like a girl. çŠ¶è¯­ä»å¥çŠ¶è¯­ä¸»è¦æ˜¯ç”¨æ¥ä¿®é¥°åŠ¨è¯å’Œå½¢å®¹è¯çš„ï¼Œä»¥è¡¨æ˜åŠ¨ä½œå‘ç”Ÿæˆ–çŠ¶æ€å­˜åœ¨çš„æ—¶é—´ã€åœ°ç‚¹ã€åŸå› ã€ç›®çš„ã€ç»“æœç­‰ã€‚çŠ¶è¯­ä»å¥å³æŒ‡åœ¨ä¸»ä»å¤åˆå¥ä¸­ç”¨ä½œçŠ¶è¯­çš„ä»å¥ã€‚çŠ¶è¯­ä»å¥ä¸»è¦ç”¨æ¥ä¿®é¥°ä¸»å¥æˆ–ä¸»å¥çš„è°“è¯­ï¼ˆä¸€ï¼‰ æ—¶é—´çŠ¶è¯­ä»å¥æ—¶é—´çŠ¶è¯­ä»å¥ç”¨è¡¨ç¤ºæ—¶é—´çš„è¿è¯è¿æ¥ä¸€ä¸ªå¥å­ä½œçŠ¶è¯­ï¼Œè¿™æ ·çš„ä¸»ä»å¤åˆå¥å°±æ˜¯æ—¶é—´çŠ¶è¯­ä»å¥, å¸¸ç”¨å¼•å¯¼è¯ï¼šwhen, as, while, as soon as, before, after, since , till, until ç”±when,while, aså¼•å¯¼çš„æ—¶é—´çŠ¶è¯­ä»å¥çš„åŒºåˆ«ç”¨æ³• whenå¼•å¯¼çš„ä»å¥çš„è°“è¯­åŠ¨è¯å¯ä»¥æ˜¯å»¶ç»­æ€§çš„åŠ¨è¯ï¼Œåˆå¯ä»¥æ˜¯ç¬æ—¶åŠ¨è¯, å¹¶ä¸”whenæœ‰æ—¶è¡¨ç¤ºâ€œå°±åœ¨é‚£æ—¶â€When she came in, I stopped eating.å¥¹è¿›æ¥æ—¶ï¼Œæˆ‘åœ¨åƒé¥­ã€‚(ç¬æ—¶åŠ¨è¯) [came in æ­¤æ—¶æ˜¯ç¬é—´åŠ¨è¯ï¼Œ å¥¹è¿›æ¥æˆ‘æœ‰æ³¨æ„åˆ°å¥¹ï¼Œåƒé¥­åœäº†ä¸€ä¸‹]When I lived in the countryside, I used to carry some water for him.å½“æˆ‘çš„ä½åœ¨å†œæ‘æ—¶ï¼Œæˆ‘å¸¸å¸¸ä¸ºä»–æ‹…æ°´ã€‚ï¼ˆå»¶ç»­æ€§çš„åŠ¨è¯ï¼‰ [live in æ˜¯å»¶ç»­æ€§åŠ¨è¯ï¼Œä¸€ç›´åœ¨ä½ç€]We were about to leave when he came in.æˆ‘ä»¬å°±è¦ç¦»å¼€ï¼Œå°±åœ¨é‚£æ—¶ä»–è¿›æ¥äº†ã€‚ï¼ˆå°±åœ¨é‚£æ—¶ï¼‰ æ€»ç»“ï¼š when å¼•å¯¼çš„ä»å¥æœ‰æ¿€æ´»ä¸»å¥çš„æ„Ÿè§‰ï¼Œä»å¥çš„å†…å®¹è¦å¹³è¡Œå¹¶åˆ—ä¸»å¥. Whileå¼•å¯¼çš„ä»å¥çš„è°“è¯­åŠ¨ä½œå¿…é¡»æ˜¯å»¶ç»­æ€§çš„ï¼Œå¹¶å¼ºè°ƒä¸»å¥å’Œä»å¥çš„åŠ¨ä½œåŒæ—¶å‘ç”Ÿï¼ˆæˆ–è€…ç›¸å¯¹åº”ï¼‰ã€‚å¹¶ä¸”whileæœ‰æ—¶è¿˜å¯ä»¥è¡¨ç¤ºå¯¹æ¯”My wife was reading the newspaper, while I was watching TV. æˆ‘å¦»å­åœ¨çœ‹æŠ¥çº¸ï¼Œæˆ‘åœ¨çœ‹ç”µè§†ã€‚(was readingæ˜¯å»¶ç»­æ€§çš„åŠ¨è¯ï¼Œå¹¶ä¸”was readingå’Œwas watchingåŒæ—¶å‘ç”Ÿ)I like playing football while you like playing basketball.æˆ‘å–œæ¬¢è¸¢è¶³çƒï¼Œè€Œä½ å–œæ¬¢æ‰“ç¯®çƒã€‚ (æ­¤å¤„è¡¨ç¤ºå¯¹æ¯”) æ€»ç»“ï¼š whileåé¢å§‹ç»ˆè¦åŠ å»¶ç»­æ€§åŠ¨è¯ Asè¡¨ç¤ºâ€œä¸€è¾¹â€¦â€¦ä¸€è¾¹â€ï¼Œaså¼•å¯¼çš„åŠ¨ä½œæ˜¯å»¶ç»­æ€§çš„åŠ¨ä½œï¼Œä¸€èˆ¬ç”¨äºä¸»å¥å’Œä»å¥åŠ¨ä½œåŒæ—¶å‘ç”Ÿï¼›asä¹Ÿå¯ä»¥å¼ºè°ƒâ€œä¸€å…ˆä¸€åã€‚We always sing as we walk.æˆ‘ä»¬æ€»æ˜¯è¾¹èµ°è¾¹å”±ã€‚ï¼ˆasè¡¨ç¤ºâ€œä¸€è¾¹â€¦â€¦ä¸€è¾¹â€ï¼‰ [è¿™é‡Œå¼ºè°ƒæˆ‘ä»¬æŒç»­è¿™æ ·å¾ˆé•¿æ—¶é—´ï¼Œåƒæ˜¯ä¸€è¾ˆå­çš„ä¹ æƒ¯]As we was going out, it began to snow. å½“æˆ‘ä»¬å‡ºé—¨æ—¶ï¼Œå¼€å§‹ä¸‹é›ªäº†ã€‚ï¼ˆaså¼ºè°ƒå¥ä¸­ä¸¤ä¸ªåŠ¨ä½œç´§æ¥ç€å…ˆåå‘ç”Ÿï¼Œè€Œä¸å¼ºè°ƒå¼€å§‹ä¸‹é›ªçš„ç‰¹å®šæ—¶é—´ï¼‰ æ€»ç»“ï¼š asè¡¨ç¤ºçš„æŒç»­æ€§ç”šè‡³æ˜¯ä¸€ç§ä¹ æƒ¯ Note: ä¸»ä»å¤åˆå¥ï¼Œè¦å¼ºè°ƒçš„ä¸œè¥¿åœ¨å‰é¢å†™ï¼Œè¿™ä¹Ÿæ˜¯è‹±æ–‡çš„çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œå¼ºè°ƒçš„ä¸œè¥¿å§‹ç»ˆæ”¾åœ¨ç¬¬ä¸€ä½ . ç”±beforeå’Œafterå¼•å¯¼çš„æ—¶é—´çŠ¶è¯­ä»å¥çš„åŒºåˆ«ç”¨æ³• beforeå¼•å¯¼çš„ä»å¥ä¸å†ç”¨å¦å®šå¼çš„è°“è¯­ï¼Œå¹¶ä¸”å½“beforeå¼•å¯¼çš„ä»å¥ä½äºä¸»å¥ä¹‹åï¼Œæœ‰æ—¶è¯‘æˆâ€œå°±ï¼Œæ‰â€æˆ–â€œ è¿˜æ²¡æ¥å¾—åŠâ€¦ å°±â€ã€‚è¿˜è¦æ³¨æ„ä¸»å¥å’Œä»å¥ä¹‹é—´çš„æ—¶é—´å…³ç³»ã€‚å½“ä¸»å¥ç”¨å°†æ¥æ—¶ï¼Œä»å¥æ€»æ˜¯ç”¨ç°åœ¨æ—¶ï¼›å¦‚æœbeforeå¼•å¯¼çš„ä»å¥è°“è¯­ç”¨çš„æ˜¯è¿‡å»æ—¶ï¼Œåˆ™ä¸»å¥åŠ¨è¯å¤šç”¨è¿‡å»å®Œæˆæ—¶ï¼Œè¿™æ ·ä»¥ä¾¿ä½“ç°åŠ¨ä½œå‘ç”Ÿçš„å…ˆåIt will be four days before they come back. ï¼ˆä¸»å°†ä»ç°ï¼Œä¸€ä¸€å¯¹åº”ï¼‰ (ä»–ä»¬è¦è¿‡å››å¤©æ‰èƒ½å›æ¥)Einstein almost knocked me down before he saw me. ï¼ˆå‡ ä¹åŒæ—¶å‘ç”Ÿï¼‰ (çˆ±å› æ–¯å¦å‡ ä¹æŠŠæˆ‘æ’å€’æ‰çœ‹åˆ°æˆ‘)My father had left for Canada just before the letter arrived. ï¼ˆä¸»è¿‡å®Œä»è¿‡ï¼‰ (æˆ‘çˆ¶äº²æ°å¥½åœ¨ä¿¡åˆ°ä¹‹å‰å»åŠ æ‹¿å¤§äº†) leave for smw (ç¦»å¼€å»æŸåœ°)They had not been married four months before they were divorced. (ä»–ä»¬ç»“å©šè¿˜ä¸åˆ°å››ä¸ªæœˆå°±ç¦»å©šäº†) afterè¡¨ç¤ºä¸»å¥åŠ¨ä½œå‘ç”Ÿåœ¨ä»å¥åŠ¨ä½œä¹‹åã€‚ä¸»å¥å’Œä»å¥çš„åŠ¨ä½œçš„æ—¶é—´å…³ç³»æ­£å¥½ä¸beforeå¼•å¯¼çš„ä»å¥ç›¸åAfter you think it over, please let me know what you decide. (ä½ ä»”ç»†è€ƒè™‘è¿‡ä»¥åï¼Œå‘Šè¯‰æˆ‘ä½ æ˜¯æ€æ ·å†³å®šçš„)After we had finished the work, we went home. (å®Œæˆå·¥ä½œä¹‹åï¼Œæˆ‘ä»¬å›å®¶äº†) ï¼ˆä»å¥ç”¨è¿‡å»å®Œæˆæ—¶ï¼Œä¸»å¥ç”¨ä¸€èˆ¬è¿‡å»æ—¶ï¼‰ tillæˆ–untilå¼•å¯¼çš„æ—¶é—´çŠ¶è¯­ä»å¥çš„åŒºåˆ« tillå’Œuntilä¸€èˆ¬æƒ…å†µä¸‹ä¸¤è€…å¯ä»¥äº’æ¢ï¼Œä½†æ˜¯åœ¨å¼ºè°ƒå¥å‹ä¸­å¤šç”¨until,ä½†æ˜¯æ³¨æ„æ³¨æ„æ³¨æ„ï¼šâ‘ å¦‚æœä¸»å¥ä¸­çš„è°“è¯­åŠ¨è¯æ˜¯ç¬æ—¶åŠ¨è¯æ—¶ï¼Œå¿…é¡»ç”¨å¦å®šå½¢å¼ï¼›â‘¡å¦‚æœä¸»å¥ä¸­çš„è°“è¯­åŠ¨è¯æ˜¯å»¶ç»­æ€§åŠ¨è¯æ—¶ï¼Œç”¨è‚¯å®šæˆ–å¦å®šå½¢å¼éƒ½å¯ä»¥ï¼Œä½†è¡¨è¾¾çš„æ„æ€ä¸åŒã€‚â‘¢tillä¸å¯ä»¥ç”¨åœ¨å¥é¦–ï¼Œè€Œuntilå¯ä»¥æ”¾åœ¨å¥é¦–ã€‚I didnâ€™t go to bed untilï¼ˆtillï¼‰my father came back. (ç›´åˆ°æˆ‘çˆ¶äº²å›æ¥æˆ‘æ‰ä¸ŠåºŠç¡è§‰ã€‚)It was not until the meeting was over that he began to teach me English. (ç›´åˆ°æ•£ä¼šä¹‹åä»–æ‰å¼€å§‹æ•™æˆ‘è‹±è¯­)I worked until he came back.æˆ‘å·¥ä½œåˆ°ä»–å›æ¥ä¸ºæ­¢ã€‚ï¼ˆå‰è‚¯æ„ä¸ºå¦ï¼‰I didnâ€™t work until he came back.ä»–å›æ¥æˆ‘è¿™æ‰å¼€å§‹å·¥ä½œã€‚ï¼ˆå‰å¦æ„ä¸ºè‚¯ï¼‰Please wait until I arrived.åœ¨æˆ‘åˆ°è¾¾ä¹‹å‰è¯·ç­‰æˆ‘ã€‚ sinceå¼•å¯¼çš„æ—¶é—´çŠ¶è¯­ä»å¥çš„ç”¨æ³• sinceå¼•å¯¼çš„ä»å¥çš„è°“è¯­åŠ¨è¯å¯ä»¥æ˜¯å»¶ç»­æ€§çš„åŠ¨è¯ï¼Œåˆå¯ä»¥æ˜¯ç¬æ—¶åŠ¨è¯ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä»å¥è°“è¯­åŠ¨è¯ç”¨ä¸€èˆ¬è¿‡å»æ—¶ï¼Œè€Œä¸»å¥çš„è°“è¯­åŠ¨è¯ç”¨ç°åœ¨å®Œæˆæ—¶ã€‚ä½†åœ¨It is ï¼‹æ—¶é—´ï¼‹sinceä»å¥çš„å¥å‹ä¸­ï¼Œä¸»å¥å¤šç”¨ä¸€èˆ¬ç°åœ¨æ—¶I have been in Beijing since you left. ï¼ˆä¸»ç°å®Œä»è¿‡å»ï¼‰ (è‡ªä»ä½ ç¦»å¼€ä»¥æ¥ï¼Œæˆ‘ä¸€ç›´åœ¨åŒ—äº¬äº†)Where have you been since I last saw you? ï¼ˆä¸»ç°å®Œä»è¿‡å»ï¼‰ (è‡ªä¸Šæ¬¡æˆ‘å’Œä½ è§é¢ä»¥åï¼Œä½ åˆ°å“ªé‡Œå»äº†ï¼Ÿ)It is four years since my sister lived in Beijing. (æˆ‘å¦¹å¦¹ä¸åœ¨åŒ—äº¬ä½æœ‰å››å¹´äº†)ï¼ˆä»Šæ—¥é‡ç‚¹å¥å‹ï¼Œè¡¨ç¤ºç›¸åæ„æ€ï¼‰ åœ¨æ—¶é—´çŠ¶è¯­ä»å¥ä¸­ å½“ä¸»å¥æ˜¯ä¸€èˆ¬å°†æ¥æ—¶æˆ–ç¥ˆä½¿å¥è¡¨ç¤ºå°†æ¥çš„æ„ä¹‰æ—¶ï¼Œæ—¶é—´çŠ¶è¯­ä»å¥ç”¨ä¸€èˆ¬ç°åœ¨æ—¶Iâ€™ll let him know as soon as she comes.ï¼ˆä¸»å°†ä»ç°ï¼‰ (å¥¹ä¸€æ¥ï¼Œæˆ‘å°±ä¼šè®©ä½ çŸ¥é“) ï¼ˆäºŒï¼‰ åŸå› çŠ¶è¯­ä»å¥ç”¨è¡¨ç¤ºåŸå› çš„è¿è¯è¿æ¥ä¸€ä¸ªå¥å­ä½œçŠ¶è¯­ï¼Œè¿™æ ·çš„ä¸»ä»å¤åˆå¥å°±æ˜¯åŸå› çŠ¶è¯­ä»å¥ï¼ŒåŸå› çŠ¶è¯­ä»å¥é€šå¸¸ç”±because, since, as,for å¼•å¯¼ é¡¹ç›® ä½ç½® å†…æ¶µ è¯­æ°” èƒ½å¦å›ç­”why because(å› ä¸º) ä¸»å¥å‰æˆ–è€…åï¼Œé€šå¸¸æ”¾åœ¨åé¢ä¸ºå¥½ ç›´æ¥å› æœå…³ç³»ï¼Œæˆ–ä¸€äº›ä¸å¤ªæƒ³è¯´çš„åŸå›  å¼º èƒ½ as(ç”±äº) ä¸»å¥å‰æˆ–è€…å åŒæ–¹éƒ½çŸ¥é“çš„åŸå›  å¼± ä¸èƒ½ since/now that (æ—¢ç„¶) ä¸»è¯­å‰ åŒæ–¹éƒ½çŸ¥é“åŸå›  å¼± ä¸èƒ½ for (å› ä¸º) å¥ä¸­ï¼Œé€šå¸¸ç”±é€—å·éš”å¼€ è¡¥å……è¯´æ˜åŸå› æˆ–æ¨æ–­çš„ä¾æ® å¼± ä¸èƒ½ becauseè¡¨ç¤ºç›´æ¥åŸå› ï¼Œè¯­æ°”æœ€å¼ºã€‚Becauseå¼•å¯¼çš„åŸå› çŠ¶è¯­ä»å¥å¤šæ”¾åœ¨ä¸»å¥ä¹‹åã€‚å›ç­”ç”±whyæå‡ºçš„é—®é¢˜ï¼Œåªèƒ½ç”¨becauseã€‚I was absent from the meeting because I was ill. aså’Œsinceè¯­æ°”è¾ƒå¼±ï¼Œä¸€èˆ¬ç”¨æ¥è¡¨ç¤ºæ˜æ˜¾çš„åŸå› ,å³ä¼—æ‰€å‘¨çŸ¥æˆ–å½“äº‹äººéƒ½çŸ¥é“ï¼Œç”±aså’Œsinceå¼•å¯¼çš„åŸå› çŠ¶è¯­ä»å¥å¤šæ”¾åœ¨å¥é¦–As it is raining, we will not go to the park. (PS:ä¸‹é›¨å°±åœ¨çœ¼å‰ï¼Œéƒ½çŸ¥é“)Now that/ Since everybody is here, letâ€™s begin our meeting. foræœ‰æ—¶ä¹Ÿå¯å¼•å‡ºè¡¨ç¤ºåŸå› çš„åˆ†å¥ï¼Œä½†å®ƒåªèƒ½ä½äºåé¢ï¼Œå¯¹å‰ä¸€åˆ†å¥åŠ ä»¥è§£é‡Šæˆ–æ¨æ–­It must have rained last night, for the ground is wetï¼ (ä¸‰) ç›®çš„çŠ¶è¯­ä»å¥*ç”¨è¡¨ç¤ºç›®çš„çš„è¿è¯è¿æ¥ä¸€ä¸ªå¥å­ä½œçŠ¶è¯­ï¼Œè¿™æ ·çš„ä¸»ä»å¤åˆå¥å°±æ˜¯ç›®çš„çŠ¶è¯­ä»å¥ï¼Œç›®çš„çŠ¶è¯­ä»å¥é€šå¸¸ç”±so that, in order to , in case, for fear * I hired a boat so that I could go fishing. (æˆ‘ç§Ÿäº†ä¸€æ¡èˆ¹å»é’“é±¼) Take your raincoat in case it rains (should rain). (å¸¦ä¸Šé›¨è¡£ä»¥é˜²ä¸‹é›¨) He studied hard in order that he could pass the exam. (ä»–åŠªåŠ›å­¦ä¹ æ˜¯ä¸ºäº†èƒ½é€šè¿‡è€ƒè¯•) æ³¨æ„ï¼š in case å’Œ for fear çš„åŒºåˆ«ï¼š in case æŒ‡â€œå‡å¦‚æŸç§æƒ…å†µå‡ºç°,æˆ‘ä»¬è¦â€¦â€¦â€ åŒæ—¶å‘ç”Ÿçš„å¯èƒ½æ€§éå¸¸å¤§ä¸å¯é¿å…,for fearæŒ‡â€œæˆ‘ä»¬è¦â€¦â€¦ä»¥å…æŸç§æƒ…å†µå‡ºç°â€,å‰è€…å¼ºè°ƒä¸»è¯­çš„èƒ½åŠ¨æ€§ He worked hard for fear that he might be fired by the boss (ä»–æ‹¼å‘½åœ°å¹²æ´»æƒŸæè¢«è€æ¿è§£é›‡) He walked fast for fear that he should be late. (ä»–å¿«èµ°,ä»¥å…è¿Ÿåˆ°) æ³¨æ„ï¼š so thatæ—¢å¯å¼•å¯¼ç›®çš„çŠ¶è¯­ä»å¥ï¼Œåˆå¯å¼•å¯¼ç»“æœçŠ¶è¯­ä»å¥ã€‚åŒºåˆ«è¿™ä¸¤ç§ä»å¥çš„åŠæ³•æœ‰ä¸¤ä¸ª ç›®çš„çŠ¶è¯­ä»å¥é‡Œå¾€å¾€å¸¦æœ‰æƒ…æ€åŠ¨è¯can, could, may, mightç­‰,ä»æ„æ€ä¸Šçœ‹ï¼Œç›®çš„çŠ¶è¯­ä»å¥å¾€å¾€è¡¨ç¤ºçš„ç›®çš„å¾ˆæ˜ç¡®Speak clearly so that they may understand you. (ç›®çš„çŠ¶è¯­ä»å¥)Jack is badly ill so that he has to rest. (ç»“æœçŠ¶è¯­ä»å¥) ï¼ˆå››ï¼‰ æ¡ä»¶çŠ¶è¯­ä»å¥ç”¨è¡¨ç¤ºæ¡ä»¶çš„è¿è¯è¿æ¥ä¸€ä¸ªå¥å­ä½œçŠ¶è¯­ï¼Œè¿™æ ·çš„ä¸»ä»å¤åˆå¥å°±æ˜¯æ¡ä»¶çŠ¶è¯­ä»å¥ï¼Œå¼•å¯¼æ¡ä»¶çŠ¶è¯­ä»å¥çš„ä»å±è¿è¯ä¸»è¦æœ‰if, unlessï¼Œas long as, æ¿€æ´»æ¡ä»¶ Donâ€™t come unless I telephone (é™¤éæˆ‘æ‰“ç”µè¯ï¼Œå¦åˆ™ä½ åˆ«æ¥) If you watch carefully you will **see how to do it (å¦‚æœä½ ä»”ç»†çœ‹ï¼Œä½ ä¼šçœ‹å‡ºè¯¥æ€æ ·åš) Iâ€™ll help you with your English if I am free tomorrow (å¦‚æœæˆ‘æ˜å¤©æœ‰ç©ºï¼Œæˆ‘å°±å¸®ä½ è¾…å¯¼è‹±è¯­) He wonâ€™t be late unless he is ill (é™¤éä»–ç—…äº†ï¼Œå¦åˆ™ä»–ä¸ä¼šè¿Ÿåˆ°) æ³¨æ„ï¼š ç¥ˆä½¿å¥è¿è¯è¦åœ¨ä¸­é—´ åœ¨æ¡ä»¶çŠ¶è¯­ä»å¥é‡Œï¼Œè°“è¯­åŠ¨è¯é€šå¸¸ç”¨ç°åœ¨æ—¶æ€è¡¨ç¤ºå°†æ¥çš„åŠ¨ä½œæˆ–çŠ¶æ€ï¼ˆä¸»å°†ä»ç°ï¼‰ï¼Œä½†æ˜¯æ¡ä»¶æ˜¯ä¸å¯èƒ½å‘ç”Ÿæˆ–å®ç°çš„å°±æ˜¯è™šæ‹Ÿè¯­æ°”äº†ï¼Œâ€œIf I were you â€ ï¼ˆäº”ï¼‰ ç»“æœçŠ¶è¯­ä»å¥å¼•å¯¼ç»“æœçŠ¶è¯­ä»å¥çš„ä»å±è¿è¯ä¸»è¦æœ‰so that, soâ€¦thatï¼Œsuchâ€¦thatç­‰ åœ¨ç”±soâ€¦thatå¼•å¯¼çš„ç»“æœçŠ¶è¯­ä»å¥ä¸­ï¼Œsoæ˜¯å‰¯è¯ï¼Œä¸å½¢å®¹è¯è¿ç”¨ã€‚å…¶ç»“æ„æ˜¯: â€œâ€¦so + å½¢å®¹è¯ï¼ˆå‰¯è¯ï¼‰+ that + ä»å¥ The hall is so big that it can hold 2,000 people (è¿™ä¸ªå¤§å…å¤§å¾—èƒ½å®¹çº³2000äºº) Mother lives so far away that we hardly ever see her (å¦ˆå¦ˆä½å¾—å¤ªè¿œäº†æˆ‘ä»¬éƒ½æ— æ³•å¸¸è§é¢) He shut the window with such force that the glass broke (ä»–å…³çª—å­ç”¨åŠ›å¤ªå¤§ï¼Œç»ç’ƒéƒ½éœ‡ç ´äº†) åœ¨ç”±suchâ€¦thatå¼•å¯¼çš„ç»“æœçŠ¶è¯­ä»å¥ä¸­ï¼Œsuchæ˜¯å½¢å®¹è¯ï¼Œå®ƒä¿®é¥°çš„å¯ä»¥æ˜¯å•æ•°æˆ–å¤æ•°å¯æ•°åè¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸å¯æ•°åè¯ï¼›åè¯å‰é¢å¯ä»¥å¸¦å½¢å®¹è¯ï¼Œä¹Ÿå¯ä¸å¸¦ã€‚å¦‚æœæ˜¯å•æ•°å¯æ•°åè¯ï¼Œå‰é¢éœ€åŠ ä¸å®šå† è¯aæˆ–an It was such a hot day that nobody wanted to do anything (å¤©å¤ªçƒ­äº†ï¼Œæ²¡äººæ„¿æ„å¹²æ´») He made such rapid progress that he did very well in the mid-term. (ä»–è¿›æ­¥å¾ˆå¿«ï¼ŒæœŸä¸­è¡¨ç°éå¸¸å¥½) å¦‚æœåè¯å‰ç”±many, much, little, fewç­‰è¯ä¿®é¥°æ—¶ï¼Œåªèƒ½ç”¨so, ä¸ç”¨such, å³â€œå¤šå¤šå°‘å°‘åªèƒ½ç”¨soâ€ Soon there were so many deer(å•å¤æ•°ä¸€æ ·) that they ate up all the wild roses (å¾ˆå¿«å°±èšé›†äº†è®¸å¤šé¹¿ï¼Œå•ƒå…‰äº†æ‰€æœ‰çš„é‡ç«ç‘°) He has so little time that he canâ€™t go to the cinema with you (ä»–å‡ ä¹æ²¡æ—¶é—´è·Ÿä½ ä»¬å»ç”µå½±é™¢) soâ€¦thatâ€¦å¥å‹çš„å¦å®šå½¢å¼å¯ç”¨ç®€å•å¥tooâ€¦toâ€¦æˆ–notâ€¦enough toä»£æ›¿ He is so young that he canâ€™t go to school = He is too young to go to school å½“so/suchâ€¦thatç»“æ„ä¸­çš„soæˆ–suchæ”¾åœ¨å¥é¦–æ—¶ï¼Œä¸»å¥ç”¨å€’è£…è¯­åº So proud was he that he never listened to any advice (ä»–å¤ªéª„å‚²äº†ä»¥è‡´äºä»æ¥å¬ä¸è¿›ä»»ä½•å»ºè®®) (å…­) è®©æ­¥çŠ¶è¯­ä»å¥ é¡¹ç›® ä½ç½® æ³¨æ„äº‹é¡¹ though å¥é¦–,æˆ–å¥æœ« æ”¾åœ¨å¥æœ«ï¼Œåšå‰¯è¯ï¼Œæ„ä¸ºâ€œå¯æ˜¯ï¼Œä¸è¿‡â€ ,ä¸å¯ä¸butè¿ç”¨ï¼Œå¯ä¸yet,stillè¿ç”¨ even though é€šå¸¸æ”¾åœ¨å¥ä¸­é“¾æ¥ä¸»ä»å¥ even if é€šå¸¸æ”¾åœ¨å¥ä¸­é“¾æ¥ä¸»ä»å¥ although å¥é¦–æˆ–å¥ä¸­ åœ¨å¥é¦–éœ€è¦æœ‰é€—å·ï¼Œåœ¨å¥ä¸­ä¸éœ€è¦é€—å·ï¼Œä¸å¯ä¸butè¿ç”¨ï¼Œå¯ä¸yet,stillè¿ç”¨ å¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥çš„ä»å±è¿è¯ä¸»è¦æœ‰although, though, even thoughï¼Œeven ifï¼ˆå³ä½¿ï¼‰ Though we are poor, we are still happy. æˆ‘ä»¬è™½ç„¶ç©·ï¼Œä½†æ˜¯å¾ˆå¿«æ´»ã€‚ He went out even though it was raining. å°½ç®¡ä¸‹ç€é›¨ï¼Œä»–è¿˜æ˜¯å‡ºå»äº†ã€‚ Itâ€™s hard work, I enjoy it though. å·¥ä½œå¾ˆè¾›è‹¦ï¼Œå¯æˆ‘ä¹æ„å¹² The speech is good, it could be better though. è¿™æ¬¡æ¼”è®²ä¸é”™ï¼Œè™½ç„¶è¿˜å¯ä»¥å†å¥½ä¸€ç‚¹ Although Princeton has a world famous university, it is still a small quiet town. æ™®æ—æ–¯é¡¿è™½ç„¶æœ‰ä¸€æ‰€é—»åä¸–ç•Œçš„å¤§å­¦ï¼Œä½†ä»ç„¶æ˜¯ä¸ªå®‰é™çš„å°é•‡ã€‚ He often helps me with my English although he is pretty busy. å°½ç®¡ä»–ç›¸å½“å¿™ï¼Œä½†è¿˜æ˜¯å¸¸å¸¸å¸®åŠ©æˆ‘å­¦è‹±è¯­ã€‚ Although the book was old , we decided to buy it . å°½ç®¡è¿™æœ¬ä¹¦å¾ˆæ—§ï¼Œæˆ‘ä»¬è¿˜æ˜¯å†³å®šä¹°ã€‚ Though she was busy with her work, yet she managed to find time to stay with her family è™½ç„¶å¥¹å¿™äºå·¥ä½œ,ä½†å¥¹è¿˜æ˜¯æŒ¤å‡ºæ—¶é—´ä¸å®¶äººåœ¨ä¸€èµ·. She was busy with her work ,and yet she managed to find time to stay with her family (è¿™é‡Œæ˜¯å‰¯è¯and yet ==but ) She was busy with her work , yet she managed to find time to stay with her family ï¼ˆè¿™é‡Œæ˜¯è¿æ¥è¯,è§£é‡Šä¸ºï¼šè™½ç„¶,ä½†æ˜¯=but ï¼‰ è¿è¯whileæœ‰æ—¶ä¹Ÿå¯è¡¨ç¤ºâ€œå°½ç®¡â€ã€â€œè™½ç„¶â€ï¼Œå¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥ While we donâ€™t agree with each other, we continue to be friends. å°½ç®¡æˆ‘ä»¬æ„è§ä¸åŒï¼Œæˆ‘ä»¬è¿˜æ˜¯æœ‹å‹ whatever, whoever, however, whenever, whereverç­‰å¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥, æ­Œè¯ä¸­å¤šè§ Donâ€™t lose heart whatever you do. ä¸ç®¡ä½ åšä»€ä¹ˆï¼Œéƒ½ä¸è¦ç°å¿ƒã€‚ Whoever you are, you canâ€™t pass this way. ä¸ç®¡ä½ æ˜¯è°ï¼Œä½ éƒ½ä¸èƒ½ä»è¿™é‡Œé€šè¿‡ asä¹Ÿå¯å¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥ï¼Œä½†è¦å°†åè¯ã€å½¢å®¹è¯æˆ–å‰¯è¯ç­‰æåˆ°aså‰ï¼Œè‹¥æå‰çš„æ˜¯å•æ•°å¯æ•°åè¯ï¼Œè¦çœç•¥aæˆ–anï¼Œå¼•å¯¼è®©æ­¥çŠ¶è¯­ä»å¥ Teacher as he is, he canâ€™t know everything. è™½ç„¶æ˜¯è€å¸ˆï¼Œä»–ä¹Ÿä¸å¯èƒ½ä»€ä¹ˆéƒ½æ‡‚ã€‚ Thoughå¼•å¯¼çš„è®©æ­¥çŠ¶è¯­ä»å¥å¯ç”¨éƒ¨åˆ†å€’è£…ï¼Œå€’è£…åä½äºå¥é¦–çš„åè¯ä¹‹å‰ä¸ç”¨å† è¯aæˆ–an Poor though I am ,I can afford it. æˆ‘è™½ç©·ï¼Œä½†è¿™ä¸œè¥¿è¿˜æ˜¯ä¹°å¾—èµ·çš„ã€‚ ä¹ è¯­ as though (å¥½åƒï¼Œä»¿ä½›)ï¼Œeven though (å³ä½¿ï¼Œçºµç„¶)ï¼Œ æœ‰ä¸€ç§è™šæ‹Ÿåœ¨é‡Œé¢, ä¸ç¡®å®šæ˜¯å¦æ˜¯æŸç§æƒ…å†µ She closed her eyes as though she were tired. å¥¹é—­ä¸Šçœ¼ï¼Œä»¿ä½›å¾ˆç–²åŠ³ä¼¼çš„ã€‚He is an honest man, I must say, even though I has opposed him. å°½ç®¡æˆ‘åå¯¹ä»–ï¼Œæˆ‘è¿˜å¾—è¯´ä»–æ˜¯ä¸ªè¯šå®çš„äººã€‚ (ä¸ƒ) åœ°ç‚¹çŠ¶è¯­ä»å¥æ³¨æ„åŒºåˆ†whereå¼•å¯¼çš„å®šè¯­ä»å¥ä¸çŠ¶è¯­ä»å¥ Youâ€™d better make a mark where you have any questions. (çŠ¶è¯­ä»å¥)ä½ æœ€å¥½åœ¨æœ‰ç–‘é—®çš„åœ°æ–¹åšä¸ªè®°å·ã€‚ Youâ€™d better make a mark at the place where you have any questions. (å®šè¯­ä»å¥) ä½ æœ€å¥½åœ¨æœ‰ç–‘é—®çš„åœ°æ–¹åšä¸ªè®°å·ã€‚ Whereå¼•å¯¼çŠ¶è¯­ä»å¥â€”å‰¯è¯æ€§ä»å¥ å½“Whereå¼•å¯¼çŠ¶è¯­ä»å¥æ—¶ï¼ŒWhereå‰æ²¡æœ‰è¡¨ç¤ºåœ°ç‚¹çš„å…ˆè¡Œè¯ï¼ŒWhereæ˜¯ä»å±è¿è¯ï¼ŒWhereå¼•å¯¼çš„ä»å¥ä¿®é¥°ä¸»å¥çš„è°“è¯­åŠ¨è¯ The famous scientist grew up where he was born and in 1930 he came to Shanghai. (è¿™ä½çŸ¥åçš„ç§‘å­¦å®¶å°±åœ¨å‡ºç”Ÿåœ°æˆé•¿ï¼Œ1930å¹´æ¥åˆ°ä¸Šæµ·ã€‚)è¯„æï¼šå¥ä¸­â€œthe famous scientist grew up â€œè¿™ä¸€éƒ¨åˆ†æ˜¯è¯¥å¥çš„ä¸»å¥ï¼ŒWhereåˆ°å¥å­æœ€åæ˜¯åœ°ç‚¹çŠ¶è¯­ä»å¥ï¼Œwhereå‰æ²¡æœ‰è¡¨ç¤ºåœ°ç‚¹çš„å…ˆè¡Œè¯. She found her passport where she lost it . (å¥¹åœ¨å¥¹ä¸¢æŠ¤ç…§çš„åœ°æ–¹æ‰¾åˆ°äº†æŠ¤ç…§ã€‚)è¯„æï¼šâ€passportâ€æ˜¯ä¸»å¥ found åçš„å®¾è¯­ï¼Œå®ƒå¹¶ä¸æ˜¯ä»å¥ä¸­lostçš„åœ°ç‚¹ï¼Œå› æ­¤ where å¼•å¯¼çš„æ˜¯åœ°ç‚¹çŠ¶è¯­ä»å¥ï¼Œä»å±è¿è¯whereå¼•å¯¼çš„ä»å¥ä¿®é¥°ä¸»å¥çš„è°“è¯­åŠ¨è¯ found ã€‚ Whereå¼•å¯¼å®šè¯­ä»å¥â€”å½¢å®¹è¯æ€§ä»å¥ å½“where å¼•å¯¼å®šè¯­ä»å¥æ—¶ï¼ŒWhereå‰æœ‰è¡¨ç¤ºåœ°ç‚¹çš„å…ˆè¡Œè¯ï¼Œwhere å¼•å¯¼çš„ä»å¥ä¿®é¥°å…ˆè¡Œè¯ï¼ŒWhereæ˜¯å…³ç³»å‰¯è¯ï¼Œåœ¨ä»å¥ä¸­ä½œåœ°ç‚¹çŠ¶è¯­ Heâ€™s got himself into a dangerous situation where is likely to lose control over the plane . (ä»–åœ¨é£æœºä¸Šå¤±å»æ§åˆ¶ï¼Œå¤„äºæå…¶å±é™©çš„å¢ƒåœ°ã€‚)è¯„æï¼šsituation æ˜¯å…ˆè¡Œè¯ï¼Œå…¶åæ˜¯Whereå¼•å¯¼çš„å®šè¯­ä»å¥ã€‚ This is the place where Luxun once lived . (è¿™æ˜¯é²è¿…æ›¾ç»ç”Ÿæ´»è¿‡çš„åœ°æ–¹ã€‚)è¯„æï¼š the place æ˜¯å…ˆè¡Œè¯ï¼Œå…¶åæ˜¯ whereå¼•å¯¼çš„å®šè¯­ä»å¥ ï¼Œwhere åœ¨ä»å¥ä¸­ä½œåœ°ç‚¹çŠ¶è¯­ã€‚ åœ¨æœ‰äº›æƒ…å†µä¸‹,whereå¼•å¯¼çš„å®šè¯­ä»å¥å¯è½¬æ¢ä¸ºwhereå¼•å¯¼çš„åœ°ç‚¹çŠ¶è¯­ä»å¥. A tall building was put up at the place where there used to be a desert.ï¼A tall building was put up where there used to be a desert. (åœ¨ä»¥å‰æ›¾æ˜¯æ²™æ¼ çš„åœ°æ–¹ç›–èµ·äº†ä¸€å¹¢é«˜æ¥¼.) whereå¼•å¯¼å®¾è¯­ä»å¥ã€è¡¨è¯­ä»å¥ã€ä¸»è¯­ä»å¥â€”â€”â€”åè¯æ€§ä»å¥ This is where Luxun once lived. è¿™æ˜¯é²è¿…æ›¾ç»ä½çš„åœ°æ–¹(where å¼•å¯¼è¡¨è¯­ä»å¥) I donâ€™t know where Luxun once lived .æˆ‘ä¸æ¸…æ¥šé²è¿…æ›¾ç»ä½åœ¨å“ªé‡Œã€‚(where å¼•å¯¼å®¾è¯­ä»å¥) She was free to go to where she liked . å¥¹å¯ä»¥å»ä»»ä½•å¥¹å–œæ¬¢çš„åœ°æ–¹ã€‚(where å¼•å¯¼å®¾è¯­ä»å¥) Where Mary was born is Beijing . ç›åˆ©å‡ºèº«çš„åœ°æ–¹æ˜¯åŒ—äº¬ã€‚(where å¼•å¯¼ä¸»è¯­ä»å¥) å­¦åæ„Ÿ å…ˆè¡Œè¯æ˜¯åœ°ç‚¹ç±»çš„åè¯ place situation caseï¼Œ åé¢çš„whereå¼•å¯¼å®šè¯­ä»å¥ where å‡ºç°åœ¨ä»€ä¹ˆåœ°æ–¹å°±æ˜¯å……å½“ä»€ä¹ˆæˆåˆ† ä¸»å¥åŠ¨è¯åé¢é™¤äº†å®¾è¯­å’Œè¡¨è¯­ï¼Œå‰©ä¸‹çš„å°±æ˜¯çŠ¶è¯­ çŠ¶è¯­ç”¨æ¥ä¿®é¥°çš„æ˜¯ä¸»å¥çš„åŠ¨è¯ è¯¾åä¹ é¢˜ æœ‰å¿—è€…äº‹ç«Ÿæˆã€‚ Where there is a will, there is a way. ä¹¦åœ¨ä½ åŸæ¥æ”¾çš„åœ°æ–¹ã€‚ The book is where you left it. å¥¹å›åˆ°äº†å¥¹åˆšæ‰åçš„åœ°æ–¹ã€‚ She is back to where she sat just now. è¯·å‘†åœ¨åŸå¤„ã€‚ Please stay where you are. è¿™å°±æ˜¯ä»–æ›¾å·¥ä½œè¿‡çš„å†œåœºã€‚ This is the farm where he once worked. ï¼ˆå…«ï¼‰ æ¯”è¾ƒçŠ¶è¯­ä»å¥å¸¸è§çš„å¼•å¯¼è¯æœ‰ï¼š asâ€¦as,not so (as)â€¦as, than, the moreâ€¦the moreç­‰ the more + ä¸»è°“ï¼Œ the more + åè¯ + ä¸»è°“ The harder you work, the more progress you will make. ä½ è¶ŠåŠªåŠ›ï¼Œå–å¾—çš„è¿›æ­¥å°±è¶Šå¤§ã€‚ The more you study, the more knowledge you can get. ä½ å­¦çš„çŸ¥è¯†è¶Šå¤šï¼Œä½ çš„çŸ¥è¯†è¶Šä¸°å¯Œã€‚ not so/as â€¦ as ä¹‹é—´åªèƒ½æ˜¯å½¢å®¹è¯åŸçº§ï¼Œä¸å¯ä»¥æ˜¯æ¯”è¾ƒçº§å’Œæœ€é«˜çº§ The work is not so difficult as you imagine. è¿™å·¥ä½œä¸åƒä½ æƒ³åƒçš„é‚£ä¹ˆå›°éš¾ã€‚ He doesnâ€™t work as hard as she (does). ä»–å·¥ä½œä¸åƒå¥¹é‚£æ ·åŠªåŠ›ã€‚ è¡¨ç¤ºå€æ•°çš„ä¸‰ç§å¥å‹ å€æ•°ï¼‹as many +å¯æ•°åè¯å¤æ•°+as å€æ•°+as much+ä¸å¯æ•°åè¯+as å€æ•°+as+å½¢å®¹è¯åŸçº§+åè¯+as I have twice as many books as you do. æˆ‘æ‹¥æœ‰çš„ä¹¦æ˜¯ä½ çš„ä¸¤å€ã€‚ It is reported that the United States uses twice as much energy as the whole of Europe. æ®æŠ¥é“ç¾å›½äººä½¿ç”¨çš„èƒ½æºæ˜¯æ•´ä¸ªæ¬§æ´²çš„ä¸¤å€ã€‚ I can rent three times as big a room as yours in my city using that money. ç”¨é‚£äº›é’±æˆ‘èƒ½åœ¨æˆ‘ä»¬çš„åŸå¸‚ç§Ÿä¸€ä¸ªä¸‰å€å¤§çš„æˆ¿é—´ã€‚ æ³¨æ„ï¼š adj + a/an + åè¯ ï¼ˆä¹ï¼‰ æ–¹å¼çŠ¶è¯­ä»å¥å¸¸è§çš„å¼•å¯¼è¯æœ‰ï¼šas ,as if ï¼Œas though ** as if ä»å¥ç”¨é™ˆè¿°è¯­æ°”çš„æƒ…å†µ,å½“è¯´è¯è€…è®¤ä¸ºå¥å­æ‰€è¿°çš„æ˜¯çœŸå®çš„æˆ–ææœ‰å¯èƒ½å‘ç”Ÿæˆ–å­˜åœ¨çš„äº‹å®æ—¶ ** It sounds as if it is rainingï¼å¬èµ·æ¥åƒæ˜¯åœ¨ä¸‹é›¨ã€‚ He talks as if he is drunkï¼ä»ä»–è°ˆè¯çš„æ ·å­æ¥çœ‹ä»–æ˜¯é†‰äº†ã€‚ as if ä»å¥ç”¨è™šæ‹Ÿè¯­æ°”çš„æƒ…å†µ,å½“è¯´è¯äººè®¤ä¸ºå¥å­æ‰€è¿°çš„æ˜¯ä¸çœŸå®çš„æˆ–æå°‘æœ‰å¯èƒ½å‘ç”Ÿæˆ–å­˜åœ¨çš„æƒ…å†µæ—¶ã€‚ä»å¥è™šæ‹Ÿè¯­æ°”åŠ¨è¯æ—¶æ€çš„å½¢å¼å¦‚ä¸‹ å¦‚æœä»å¥è¡¨ç¤ºä¸ç°åœ¨äº‹å®ç›¸åï¼Œè°“è¯­åŠ¨è¯ç”¨ä¸€èˆ¬è¿‡å»æ—¶ You look as if you didnâ€™t careï¼ ä½ çœ‹ä¸Šå»å¥½åƒå¹¶ä¸åœ¨ä¹ã€‚ He talks as if he knew where she wasï¼ ä»–è¯´è¯çš„æ ·å­ï¼Œå¥½åƒä»–çŸ¥é“å¥¹åœ¨å“ªé‡Œä¼¼çš„ã€‚ ä»å¥è¡¨ç¤ºä¸è¿‡å»äº‹å®ç›¸åï¼Œè°“è¯­åŠ¨è¯ç”¨â€œhadï¼‹è¿‡å»åˆ†è¯â€ He talks about Rome as if he had been there beforeï¼ ä»–è¯´èµ·ç½—é©¬æ¥å¥½åƒä»–ä»¥å‰å»è¿‡ç½—é©¬ä¼¼çš„ã€‚ The girllistened as if she had been turned to stoneï¼ é‚£å¥³å­©å€¾å¬ç€ï¼Œä¸€åŠ¨ä¹Ÿä¸åŠ¨ï¼Œåƒå·²ç»å˜æˆäº†çŸ³å¤´ä¼¼çš„ã€‚ ä»å¥è¡¨ç¤ºä¸å°†æ¥äº‹å®ç›¸åï¼Œè°“è¯­åŠ¨è¯ç”¨â€œwouldï¼couldï¼mightï¼‹åŠ¨è¯åŸå½¢â€ He opened his mouth as if he would say somethingï¼ ä»–å¼ å¼€å˜´å¥½åƒè¦è¯´ä»€ä¹ˆã€‚ It looks as if it might snowï¼çœ‹æ¥å¥½åƒè¦ä¸‹é›ªäº†ã€‚ æ³¨æ„ï¼š as if /thoughå¼•å¯¼çš„ä»å¥å¸¸ç”¨è™šæ‹Ÿè¯­æ°”ï¼Œè¡¨ç¤ºéçœŸå®æƒ…å†µï¼Œä½†å¦‚æœä»å¥ä¸­é™ˆè¿°çš„æƒ…å†µå¾ˆå¯èƒ½å®ç°ï¼Œä¹Ÿå¯ç”¨é™ˆè¿°è¯­æ°” ï¼ˆåï¼‰ çŠ¶è¯­ä»å¥çš„çœç•¥å½“æ—¶é—´ã€æ¡ä»¶ã€è®©æ­¥ã€æ–¹å¼å’Œæ¯”è¾ƒçŠ¶è¯­ä»å¥çš„ä¸»è¯­ä¸ä¸»å¥ä¸€è‡´æˆ–ä¸ºit æˆ– thereä¸”è°“è¯­åŠ¨è¯å«beåŠ¨è¯æ—¶ï¼Œä»å¥ä¸­çš„ä¸»è¯­å’Œè°“è¯­å¯ä»¥ä¸€èµ·çœå» Donâ€™t speak until spoken to.( çœç•¥äº†you are) ä½ ä¸è¦è®²è¯ï¼Œé™¤éè®©ä½ è®²è¯ã€‚ I have no money. If any, I will lend yousome. æˆ‘æ‰‹é‡Œæ²¡æœ‰é’±ï¼Œæœ‰çš„è¯ï¼Œæˆ‘ä¼šå€Ÿç»™ä½ çš„ã€‚( çœç•¥äº†there is) Though cold, he still wore a shirt. å°½ç®¡å¾ˆå†·ï¼Œä»–å´åªç©¿ä¸€ä»¶çŸ­è¢–ã€‚ ( çœç•¥äº†it was) å¼ºè°ƒå¥ï¼ˆä¸€ï¼‰ åŒºåˆ†å¼ºè°ƒå¥ä¸å…¶ä»–ç±»å‹ä»å¥ï¼ˆä¸»ã€å®šã€çŠ¶ï¼‰ å¼ºè°ƒå¥ä¸ä¸»è¯­ä»å¥çš„åŒºåˆ« It is true that he is honest. (ä¸»è¯­ä»å¥) ä»–çœŸçš„å¾ˆè¯šå®ã€‚ True he is honest (å»æ‰It is â€¦ that ä¹‹åä¸æˆå¥å­ï¼Œæ‰€ä»¥æ˜¯ä¸»è¯­ä»å¥ï¼Œå¼ºè°ƒå¥å»æ‰ä»ç„¶æˆå¥å­å¦‚ï¼š It is Mr Fu that is honest) It is known to all that China is a country with a long history. (ä¸»è¯­ä»å¥) ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸­å›½æ˜¯ä¸€ä¸ªå†å²æ‚ ä¹…çš„å›½å®¶ã€‚It was here that he fell off his bicycle.(å¼ºè°ƒå¥) è¿™æ­£æ˜¯ä»–ä»è‡ªè¡Œè½¦ä¸Šæ‘”ä¸‹æ¥çš„åœ°æ–¹ã€‚ æ€»ç»“ï¼š â€œIt is / was + å½¢å®¹è¯ / åˆ†è¯ / + thatä»å¥â€æ˜¯ä¸»è¯­ä»å¥ï¼Œå®ƒè¯‘æˆä¸­æ–‡æ—¶ä¸å¯åŠ ä¸Šâ€œæ­£æ˜¯â€¦â€¦â€â€œå°±æ˜¯â€¦â€¦â€ä¹‹ç±»å­—çœ¼ï¼Œ å«æœ‰å®šè¯­ä»å¥çš„å¼ºè°ƒå¥å‹ (åœ¨è¢«å¼ºè°ƒçš„åè¯åå†è®¾è®¡ä¸€ä¸ªä»¥è¯¥åè¯ä¸ºå…ˆè¡Œè¯çš„å®šè¯­ä»å¥ï¼Œè¿™æ—¶ä¸è¦æŠŠå®šè¯­ä»å¥å½“ä½œå¼ºè°ƒå¥)ã€‚ It was this school where (in which) he once studied that gave him a chance of teaching.æ­£æ˜¯è¿™æ‰€ä»–æ›¾ç»å­¦ä¹ è¿‡çš„å­¦æ ¡ç»™äº†ä»–æ•™å­¦çš„æœºä¼šã€‚ æ€»ç»“ï¼š è¿™ç§å¥å­å…ˆå†™ä¸»å¹²ï¼š It was this schoolâ€¦. that gave him a chance of teaching å¼ºè°ƒå¥å‹ä¸çŠ¶è¯­ä»å¥çš„åŒºåˆ« It was at 7:00 that I arrived.(å¼ºè°ƒå¥å‹ï¼Œå¼ºè°ƒæ—¶é—´çŠ¶è¯­at 7:00)æ­£æ˜¯åœ¨7:00æ—¶ï¼Œ æˆ‘åˆ°äº†ã€‚ It was 7:00 when I arrived.(æ—¶é—´çŠ¶è¯­ä»å¥ï¼Œåœ¨7:00å‰æ— ä»‹è¯at) å½“æˆ‘åˆ°è¾¾æ—¶ï¼Œ æ—¶é—´æ˜¯7:00ã€‚ It was two years ago that I began to learn drawing.(å¼ºè°ƒå¥å‹ï¼Œå‰åæ—¶æ€ä¸€è‡´) æ­£æ˜¯åœ¨ä¸¤å¹´å‰æˆ‘å¼€å§‹å­¦ä¹ ç»˜ç”»ã€‚ It is(has been) two years since I began to learn drawing.(sinceå¼•å¯¼çš„æ—¶é—´çŠ¶è¯­ä»å¥ï¼Œå‰åæ—¶æ€ä¸ä¸€è‡´) è‡ªä»æˆ‘å­¦ä¹ ç»˜ç”»ä»¥æ¥å·²ç»æœ‰ä¸¤å¹´äº†ã€‚ It was two years before they came to see us.(æ—¶é—´çŠ¶è¯­ä»å¥) è¿‡äº†ä¸¤å¹´åä»–ä»¬æ‰æ¥çœ‹æˆ‘ä»¬ã€‚ It was two years later that they came to see us.(å¼ºè°ƒå¥å‹) æ­£æ˜¯ä¸¤å¹´åä»–ä»¬æ‰æ¥çœ‹æˆ‘ä»¬çš„ã€‚ It wonâ€™t be long before we graduate from the school. (æ—¶é—´çŠ¶è¯­ä»å¥) ä¸ä¹…æˆ‘å°±å°†æ¯•ä¸šäº†ã€‚ It will be two years before we graduate from this university. (æ—¶é—´çŠ¶è¯­ä»å¥) å†è¿‡ä¸¤å¹´æˆ‘ä»¬å°±å°†å¤§å­¦æ¯•ä¸šäº†ã€‚ æ€»ç»“ï¼š å¯ä»¥çœ‹å…ˆè¡Œè¯ï¼Œå¦‚æœæ˜¯å¼•å¯¼æ—¶é—´çš„è¯since before after å°±æ˜¯æ—¶é—´çŠ¶è¯­ä»å¥ï¼Œ thatæ˜¯å¼ºè°ƒå¥ ï¼ˆäºŒï¼‰ å¼ºè°ƒä¸‰å…³ å¸¸ç”¨å¥å¼ sb1 cut sb1 off sb1æˆªæ–­äº†sb2çš„æ¥æºï¼ˆå¤šåªç»æµæ¥æºï¼‰ My daddy cut me off æˆ‘è€çˆ¸æ–­äº†æˆ‘çš„ç»æµæ¥æºsth cut sb off (sthæ–­äº†)Machine cut me off (ç”µè¯æ–­äº†) sb is dumb blonde that has no common sense æŸäººæ˜¯æ²¡æœ‰å¸¸è¯†çš„é‡‘å‘å¥³éƒï¼ˆä¸–ç•Œè§‚åŠä»·å€¼è§‚ä¸å¸¸äººä¸åŒï¼‰ I knew it was stupid and I shouldnâ€™t have done it æˆ‘çŸ¥é“è¿™äº‹æƒ…å¾ˆè ¢æˆ‘ä¹Ÿä¸è¯¥è¿™ä¹ˆåš shouldnâ€™t have done, æœ¬æ¥ä¸è¯¥åšçš„äº‹æƒ…åšäº†ï¼ŒåŒç†ï¼Œshould have done,æœ¬è¯¥åšçš„äº‹æƒ…æ²¡åšï¼Œå£è¯­ä¸­ä½¿ç”¨é¢‘ç‡å¾ˆé«˜.You shouldnâ€™t have said that. sb is at rock bottom æŸäººåœ¨å¾ˆæƒ¨/ä½è°·çš„æ—¶å€™ I think it is the best thing that couldâ€™ve ever happened to you get out on oneâ€™s way è‡ªåŠ›æ›´ç”Ÿ We should get out on our way. How does he expect me to do sth è´£å¤‡çš„è¯­æ°”ï¼Œæ€ä¹ˆå¯ä»¥è¿™æ ·ï¼Ÿå¤ªè¿‡åˆ†äº† How does my boss expect me to work overtime tune (æ›²è°ƒï¼Œè°ƒæ•´ï¼Œä½¿ä¸€è‡´) tune in(æ”¶å¬) America tuned in to watch six very attractive singles navigate relationships and life in New York Citystay tuned (ä¸è¦æ¢å°ï¼Œä¸è¦èµ°å¼€ï¼Œ DJå¸¸ç”¨è¯­) clip å°æ®µéŸ³é¢‘æˆ–è§†é¢‘ï¼Œ next clipï¼Œ clip section 2 wind(wound) up doing == end up doing æœ€ç»ˆ.. Right in the very beginning å°±åœ¨ä¸€å¼€å§‹ *we really just fell in love and adoredï¼ˆå€¾æ…•ï¼‰ each other instantly * sitcom = situation comedy ï¼ˆæƒ…æ™¯å–œå‰§ï¼‰ Who have the best chemistry of the group? chemistry: åŒ–å­¦ååº”ï¼Œç›¸äº’å¸å¼•ï¼Œå¹¶éé…åˆçš„é»˜å¥‘ take sb under oneâ€™s â€¦ he graciously took me under his wings. be filthy rich filthy /â€˜fÉªlÎ¸i/ è‚®è„çš„ï¼Œæ±¡ç§½çš„ï¼ŒçŒ¥äºµçš„ï¼Œ æ˜¯æŒ‡æœ‰é“œè‡­çš„é‚£ç§æ„Ÿè§‰ Tom is filthy rich. I donâ€™t want to go into sth æˆ‘ä¸æƒ³è¯¦ç»†çš„è§£é‡Š/è®²è¿™ä»¶äº‹ï¼Œ å› ä¸ºæ‡’/éº»çƒ¦ä¸æ„¿æ„è¯´ It wonâ€™t work out â€¦è¡Œä¸é€š have words è¾¾æˆä¸€è‡´ His mind is blown/ sb blew his mind è„‘è¢‹çˆ†ç‚¸ï¼ŒæŒ‡ä¿¡æ¯é‡å¾ˆå¤§ï¼Œä¸€æ—¶æ¥å—ä¸äº† But not yet â€¦è¿˜æ²¡æ€æ ·ï¼Œä½†æ˜¯è¦å¿«äº† I expect(é¢„æµ‹)/look forward to(æœŸç›¼) it will rain today What if I â€¦ å¦‚æœæˆ‘â€¦. é€šå¸¸æ¥è¿‡å»æ—¶/è¿‡å»å®Œæˆæ—¶ What if I was still fat ï¼ˆè¿‡å»æ—¶ï¼‰What if I had had the guts(å‹‡æ°”) to quit my job ï¼ˆè¿‡å»å®Œæˆæ—¶ï¼‰What ifâ€¦? ä¸»è¦æœ‰ä¸‰ç§ç”¨æ³•ï¼Œæ­¤å¤„è¡¨ç¤ºå‡è®¾ï¼Œæ„æ€æ˜¯â€œè¦æ˜¯â€¦â€¦å°†ä¼šæ€ä¹ˆæ ·â€ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å¯ä»¥è¡¨ç¤ºé‚€è¯·æˆ–å»ºè®®ï¼Œæ„æ€æ˜¯â€œå¦‚æœâ€¦â€¦å¦‚ä½•ï¼Ÿâ€What ifâ€¦? è¿˜å¯ä»¥è¡¨ç¤ºæŸäº‹ä¸é‡è¦ï¼Œå¸¸å¸¸ä¸soè¿ç”¨ï¼Œæ„ä¸ºâ€œå°±ç®—â€¦â€¦é‚£åˆæ€æ ·ï¼ŸWhat if you join us for lunch? åŒæˆ‘ä»¬ä¸€èµ·åƒæ™šé¥­æ€ä¹ˆæ · ï¼ˆè¡¨ç¤ºé‚€è¯·/å»ºè®®ï¼‰So what if weâ€™re a little late? å°±ç®—æˆ‘ä»¬è¿Ÿåˆ°ä¸€å°ä¼šåˆæ€æ · ï¼ˆè¡¨ç¤ºæŸäº‹ä¸é‡è¦ï¼‰ golden years é»„é‡‘å¹´ä»£ prime time é»„é‡‘æ—¶é—´ Thatâ€™s for sure é‚£æ¯‹åº¸ç½®ç–‘ï¼Œ å¯ä»¥åœ¨è‡ªå·±è¯´çš„å¥å­æœ«å°¾åŠ ä¸Šè¿™å¥è¯ï¼Œ ä¹Ÿå¯ä»¥åœ¨åˆ«äººè¯´è¿‡è¯ä¹‹åè¯´è¿™å¥è¯è¡¨ç¤ºè‚¯å®šå’Œè®¤å¯ Donâ€™t dwell (ä¸è¦æ²‰æººäºè¿‡å») dwell /dwÉ›l/ (vi. å±…ä½ï¼›å­˜åœ¨äºï¼›ç»†æƒ³æŸäº‹)move on / look forward æ˜¯å…¶åä¹‰è¯ è¡¨ç¤ºå‘å‰çœ‹ casual Friday é€šå¸¸æ‰€è¯´çš„happy Friday, æŒ‡å·¥ä½œæ—ä¸ç”¨åœ¨æ˜ŸæœŸäº”ç©¿è¥¿è£…æ‰“é¢†å¸¦é‚£ä¹ˆä¸è‡ªç”± only if/if only only if çš„only æ˜¯é‡ç‚¹ï¼Œâ€åªæœ‰å¦‚æœ(å½“â€¦)â€,if only çš„ifæ˜¯é‡ç‚¹â€å¦‚æœâ€¦å°±å¥½äº†(æ—¢ç„¶å‡è®¾å°±è™šæ‹Ÿ)â€ You guys really think that Iâ€™m that shallow (ä½ ä»¬çœŸçš„é‚£ä¹ˆè®¤ä¸ºæˆ‘é‚£ä¹ˆè‚¤æµ…/æµ…è–„å—ï¼Ÿ) wear a tie (æˆ´é¢†å¸¦) sb have a knack for sth æŸäººæœ‰â€¦ å¤©åˆ† knack /nÃ¦k/ n. è¯€çªï¼›æœ¬é¢†ï¼›ç†Ÿç»ƒæŠ€æœ¯ï¼›å·§å¦™æ‰‹æ³• I have a knack for stocks æˆ‘æœ‰ç‚’è‚¡ç¥¨çš„å¤©åˆ†/æ½œè´¨ quit my job æ”¾å¼ƒæˆ‘çš„å·¥ä½œï¼Œè¡¨ç¤ºè¾èŒ I have to admit, *the horoscope stuff really caught my attention. æˆ‘ä¸å¾—ä¸æ‰¿è®¤ï¼Œæ˜Ÿåº§è¿åŠ¿è¿™ä¸œè¥¿å¼•èµ·äº†æˆ‘çš„å…´è¶£ Virgos have a strong attention to detail, they are known to take good care of people å¤„å¥³åº§åŠå…¶å…³æ³¨ç»†èŠ‚ï¼Œä»–ä»¬æ˜¯å…¬è®¤çš„æ“…é•¿ç…§é¡¾åˆ«äºº Do you have some studying(homework) to do? Do you not wanna be seen with me? å’Œ Donâ€™t you wanna be seen with me? (ä¸¤è€…è¡¨è¾¾çš„æ„æ€ä¸ä¸€æ ·ï¼Œ å‰è€…åœ¨å½“æ—¶çš„å¯¹è¯æƒ…æ™¯çŒœæµ‹åˆ°å¯¹æ–¹çš„æ„æ€) Iâ€™m about to leave (æˆ‘é©¬ä¸Šè¦ç¦»å¼€ï¼Œ æŒ‡ä¸‹ä¸€ç§’å°†è¦åšæŸäº‹) *you may frown upon that. * ï¼ˆä½ å¯èƒ½å¿ƒé‡Œå¤´ä¸èˆ’æœï¼Œè¡¨ç¤ºè¡¨æƒ…ä¸Šï¼Œå†…å¿ƒé‡Œï¼ˆæš—æš—ï¼‰ä¸æ»¡ï¼Œä¸åŒæ„ï¼Œ è€Œdisapprove,disagree è¡¨ç¤ºè¨€è¯­ä¸Šçš„ä¸åŒæ„ï¼‰ You are so fired. ï¼ ä½ é“å®šè¢«è§£é›‡äº† æœ‰ç‚¹ä½ ä¼šè¢«è§£é›‡çš„å¾ˆæƒ¨çš„æ„æ€ you are so dead ä½ æ­»å®šäº† what are you [doing] å¥å‹æ‰©å±• what are you trying to say. (ä½ æƒ³è¯´ä»€ä¹ˆ)æƒ…æ™¯åº”ç”¨ï¼š A: è¯´äº†åŠå¤©ä¹Ÿè¯´ä¸æ˜ç™½ï¼Œæˆ–è€…åœ¨çº ç»“è¯¥ä¸è¯¥è¯´ B: what are you trying to say? ä½ ç°åœ¨æ­£åœ¨å°è¯•è¦è¯´ä»€ä¹ˆï¼Ÿ what do you want to say? (ä½ æƒ³è¯´ä»€ä¹ˆ)æƒ…æ™¯åº”ç”¨ï¼š A: è·‘åˆ°Bé¢å‰è¯´â€œCan I talk to you?â€ B: what do you want to say? ä½ æƒ³è¦è¯´ä»€ä¹ˆï¼Ÿ what are you doing saying this ï¼ˆä½ è¯´è¿™ä¸ªå¹²ä»€ä¹ˆï¼Œå¸¦æœ‰è´£å¤‡è¯­æ°”ï¼‰æƒ…æ™¯åº”ç”¨ï¼š ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¥å‹ what are you doing [doing] å¸¦æœ‰è´£å¤‡çš„æƒ…æ„Ÿåœ¨é‡Œé¢ what are you doing talking to her about that? ä½ å’Œå¥¹è°ˆè®ºé‚£ä¸ªå¹²ä»€ä¹ˆï¼Ÿ Please bear in mind è¯·è®°ä½ Please bear in mind that I love you forever. Twist the knife å¾€ä¼¤å£ä¸Šæ’’ç›ï¼Œæ­ä¼¤ç–¤ Theyâ€™re all twisting the knife. Split the cost åˆ†æ‘Šæˆæœ¬ï¼Œç±»ä¼¼äºä¸­å›½çš„AAåˆ¶ you canâ€™t be too careful in your work Aï¼šä½ å‡ºé—¨è¿˜å¸¦åˆ€è‡ªæˆ‘ä¿æŠ¤ï¼Œå¤ªå¤¸å¼ äº†å§ Bï¼šYou canâ€™t be too careful.ï¼ˆç°åœ¨ä¸–é“è¿™ä¹ˆä¹±ï¼Œå†æ€ä¹ˆå°å¿ƒä¹Ÿä¸ä¸ºè¿‡, å°å¿ƒä½¿å¾—ä¸‡å¹´èˆ¹ï¼‰ Do you mind if we switch placesï¼Ÿ ï¼ˆbecasue I get off next å¯è¯´å¯ä¸è¯´ï¼‰ ç±»ä¼¼äºåœ¨ç”µæ¢¯ä¸­è¯·æ±‚äº’æ¢ä½ç½® mean to do sth æœ‰æ„åšæŸäº‹ æ•…æ„åšæŸäº‹ // run into sb ä¸å°å¿ƒæ’åˆ°åˆ«äººï¼Œå¶é‡åˆ«äºº=bump into Oops, I did not mean to run into you like that, sir å“å‘€ï¼æˆ‘æ²¡æˆæƒ³è¦è¿™ä¹ˆç¢°åˆ°ä½ çš„ï¼Œå¯¹ä¸èµ·ï¼Œå…ˆç”Ÿã€‚ school night/work night school night æ˜æ—©è¿˜è¦ä¸Šå­¦work night æ˜å¤©è¦ä¸Šç­ä»¥ä¸Šä¸¤ç§å¥å‹çš„ç†è§£ï¼šä¸Šç­(ä¸Šå­¦)æœŸé—´ï¼Œä¸æ˜¯æ”¾å‡æœŸé—´ï¼Œæ™šä¸Šä¸è¦ç©ç–¯ï¼Œè¦åšå‡†å¤‡ï¼Œä¸ºäº†ç¬¬äºŒå¤©å·¥ä½œã€å­¦ä¹  Is it a school night and she has a lot of homework to do? Bring â€™em on æ”¾é©¬è¿‡æ¥ è¿˜æƒ³è¯´ä»€ä¹ˆå°±è¯´å§ girl/boy scouts ç¾å›½12å²ä»¥ä¸‹å­©å­çš„ä¸€ä¸ªreal lifeçš„é”»ç‚¼æ´»åŠ¨ï¼Œ çŒœæµ‹ç±»ä¼¼å¤ä»¤è¥ï¼Œ ä¸ºäº†ç­¹åŠæ´»åŠ¨ä¹°girl/boy scouts cookies Tell sb good luck with sth. è¡¨ç¤ºâ€œç¥æŸäººåœ¨æŸäº‹ä¸Šæœ‰å¥½è¿â€ï¼Œå£è¯­ä¸­ç»å¸¸ä½¿ç”¨ã€‚ A: Tom will have an exam tomorrow. æ±¤å§†æ˜å¤©æœ‰ä¸ªè€ƒè¯•ã€‚ B: Tell him good luck with that. å¸®æˆ‘ç¥ä»–å¥½è¿ã€‚ I can let it go for eight. (ç»“åˆä¸Šä¸‹æ–‡æ˜¯8000å…ƒæˆäº¤çš„æ„æ€ï¼Œ å…¶ä¸­let it goï¼Œ å¯ä»¥æƒ³è±¡å…»äº†å¥½ä¹…çš„å® ç‰©è¦èµ°äº†ï¼Œèˆä¸å¾—ï¼Œæ­¤å¤„ç†è§£ä¸ºâ€œå‹‰å¼ºæˆäº¤ï¼Œéå¸¸ä¸æƒ…æ„¿çš„è®©ä»·â€) We stand firm at $10 (æˆ‘ä»¬åšå†³ä»˜åå—ï¼Œ stand firm at â€¦ åšå®š..ç«‹åœº) Iâ€™m over it (ä¸åœ¨ä¹ï¼Œæ— æ‰€è°“äº†) hold out sth ï¼ˆä¼¸å‡ºæ‰‹é‡Œçš„ä¸œè¥¿ï¼Œç›´ç›´çš„æ‹¿ç€â€¦ï¼‰ Engagement ring ç»“å©šæˆ’æŒ‡ poker face ï¼ˆ ä¸€æœ¬æ­£ç»çš„é¢å®¹, é¢æ— è¡¨æƒ…çš„äººï¼‰ a man-to-man talk (ä¸€å¯¹ä¸€çš„ï¼Œå¦ç‡çš„,ç›´è¨€ä¸è®³çš„; ç•…æ‰€æ¬²è¨€çš„) count on sb (ä¾èµ–/æŒ‡æœ›æŸäºº) Donâ€™t count on me (åˆ«æŒ‡æœ›æˆ‘)You can count on us (ä½ å¯ä»¥æŒ‡æœ›/ä¾èµ–æˆ‘ä»¬) toe the line (è„šé ç€çº¿ï¼Œä¸è¦è¶Šç•Œï¼Œå¾ªè§„è¹ˆçŸ©ï¼Œéµå®ˆè§„åˆ™) thread the needle (æœ‰balanceçš„æ„æ€ ä¹Ÿæœ‰è®½åˆºè¿™ä¸ªä¸œè¥¿å¾ˆéš¾ï¼Œ â€œçº¿ç©¿é’ˆçœ¼â€) itâ€™s like thread the needle. (è¿™ä¸ªä¸œè¥¿å¾ˆéš¾) think outside the box (åˆ›æ–°æ€ç»´ï¼Œæ‘†è„±æ€ç»´å®šå¼) I have bigger fish to fry (æœ‰æ›´å¤§ã€é‡è¦çš„äº‹æƒ…è¦å¤„ç†) é€šå¸¸ä¼šè¯´ I have bigger fish *sb is heartless * ( æŸäººæ— æƒ…æ— ä¹‰) she/he gets on one knee ï¼ˆå•è†è·ªåœ°æ±‚å©šï¼‰ take a knee (æ•™ç»ƒï¼šå›´èµ·æ¥å¬æ•™ç»ƒè®²è¯) Weâ€™re engaged æˆ‘ä»¬è®¢å©šäº† engagement ring è®¢å©šæˆ’æŒ‡ Weâ€™re dying out here! ( æˆ‘ä»¬ç­‰å¾—å¿«æ€¥æ­»äº†ï¼) be likely to do sth. (è¡¨ç¤ºâ€œå¾ˆæœ‰å¯èƒ½åšæŸäº‹â€ï¼Œå¼ºè°ƒå¯èƒ½æ€§) It is likely to rain. å¥½åƒå¿«è¦ä¸‹é›¨äº†ã€‚be unlikely to (ä¸å¤§å¯èƒ½ï¼Œä¸å†å‘ç”Ÿ)These tactics are unlikely to be helpful to you (è¿™ç§æ–¹æ³•å¯¹ä½ æœªå¿…æœ‰ç”¨)He is very ill and unlikely to recover (ä»–ç—…å¾—å¾ˆé‡ï¼Œä¸å¤§å¯èƒ½æ¢å¤å¥åº·äº†) lose oneâ€™s temper ï¼ˆå¤±æ€ï¼‰ the box that it came in ï¼ˆåŒ…è£…çš„ç®±å­ï¼‰ shake hand (æ¡æ‰‹) Parents shouldnâ€™t play favorites ï¼ˆçˆ¶æ¯ä¸åº”åå¿ƒï¼‰ Iâ€™m the favorite (æˆ‘æ˜¯çˆ¶æ¯å–œæ¬¢çš„é‚£ä¸€ä¸ª) Iâ€™m kind/sort of ï¼ˆkinaï¼‰tired ï¼ˆæˆ‘æœ‰ç‚¹ç´¯ï¼Œæ¯”Iâ€™m a little bit tiredæ›´åœ°é“ï¼‰ clever/smart/resourceful/competent åœ¨ç¾å›½cleverå¸¦æœ‰â€œå°èªæ˜â€çš„æ„æ€ï¼Œä¹Ÿæœ‰æŒ‡åŠ¨ç‰©çš„èªæ˜ï¼Œ åœ¨è‹±å›½cleverå¯ä»¥æŒ‡äººçš„èªæ˜ï¼Œ æ‰€ä»¥å¤¸äººèªæ˜è¿˜æ˜¯ç”¨smartæ¯”è¾ƒåˆé€‚resourceful å½¢å®¹äººæ¯”è¾ƒè¶³æ™ºå¤šè°‹ï¼Œèµ„æºåˆ†ä¸°å¯Œcompetent/incompetent æœ‰èƒ½åŠ›çš„å’Œæ²¡æœ‰èƒ½åŠ›çš„ å½¢å®¹äºº *get the hell out of here * ï¼ˆæ»šå‡ºå» ä¹Ÿæœ‰å¼ºè°ƒçš„æ„æ€ï¼Œ è¦è¯»çš„å¿«å’Œåœ°é“æ‰æœ‰æ„Ÿè§‰ï¼‰ check clear/bounce (å½¢å®¹æ”¯ç¥¨æ˜¯å¯ä»¥æ”¯å‡ºé’±æˆ–ä¸èƒ½æ”¯å‡ºé’±) I canâ€™t wait to see everything again! ï¼ˆ æˆ‘éƒ½ç­‰ä¸åŠè¦å†æ¬¡çœ‹åˆ°å®ƒä»¬äº†ï¼ï¼‰ canâ€™t wait to do sth.è¡¨ç¤ºâ€œè¿«ä¸åŠå¾…è¦åšæŸäº‹â€ï¼Œå£è¯­ä¸­çš„ä½¿ç”¨é¢‘ç‡å¾ˆé«˜ã€‚ canâ€™t/couldnâ€™t help doing sth. (æƒ…ä¸è‡ªç¦åšæŸäº‹) I canâ€™t help laughing. (æˆ‘å¿ä¸ä½å¤§ç¬‘) hit å¸¸ç”¨çŸ­è¯­æ€»ç»“ï¼š hit on sb (æ’©å¦¹ï¼Œæ³¡å¦) â€”â€” Cindy never realizes when boys are hitting on her(Cindy æ€»æ˜¯æµ‘ç„¶ä¸çŸ¥æœ‰ç”·ç”Ÿåœ¨è¿½å¥¹) hit on sth (çµæœºä¸€åŠ¨æƒ³åˆ°sth) â€”â€” He hit on an idea that would be a perfect surprise (ä»–çµæœºä¸€åŠ¨ï¼Œæƒ³åˆ°äº†å®Œç¾çš„ç”Ÿæ—¥è¶´ä½“æƒŠå–œ) hit smw (ä¸Šè·¯å»å“ª) â€”â€” Letâ€™s hit the road after staying here for a night (æˆ‘ä»¬åœ¨è¿™å‘†ä¸€æ™šå°±ä¸Šè·¯å§) hit the sack/hay (å°±å¯ã€ç¡è§‰) â€”â€” Tina was so tired that she hit the sack soon after long hours works ï¼ˆTina å®åœ¨æ˜¯å¤ªç´¯äº†ï¼Œé•¿æ—¶é—´å·¥ä½œä»¥åæ—©æ—©ç¡è§‰å»äº†ï¼‰ hit the nail[æŒ‡ç”²ã€é’‰å­] (è¯´è¯ä¸­è‚¯ï¼Œä¸€é’ˆè§è¡€) â€”â€” He always hit the nail on the head so all people found him extremly reliable ï¼ˆä»–è¯´è¯æ€»æ˜¯ä¸€é’ˆè§è¡€ï¼Œæ‰€æœ‰äººéƒ½è§‰å¾—ä»–å¾ˆé è°±ï¼‰ hit the jackpot (ä¸­å¤´å½©) â€”â€” Jocelin is the perfect girl for me, Iâ€™ve hit the jackpot in life being with her (Jocelinæ˜¯æˆ‘çš„çœŸå‘½å¤©å¥³ï¼Œèƒ½å’Œå¥¹åœ¨ä¸€èµ·çœŸæ˜¯æˆ‘è¿™è¾ˆå­æœ€å¤§çš„ç¦åˆ†) hit it off well (ä¸€æ‹å³åˆ) â€”â€” We all thought the two of you would hit it off well ï¼ˆæˆ‘ä»¬å¤§å®¶éƒ½è®¤ä¸ºä½ ä»¬ä¼šç›¸å¤„æ„‰å¿«ï¼‰ hit the bottle (é…—é…’) â€”â€” He started to hit the bottle to relieve stress. (ä»–å¼€å§‹ç”¨é…—é…’æ¥é‡Šæ”¾å‹åŠ›) hit the light (å¼€ç¯) â€”â€” Would you please hit the light for me? ï¼ˆè¯·é—®ä½ å¯ä»¥å¸®æˆ‘å¼€ä¸€ä¸‹ç¯ä¹ˆï¼Ÿï¼‰ hit the big (åšåˆ°ï¼ŒæˆåŠŸ) â€”â€” We hit the big (æˆ‘ä»¬æˆåŠŸäº†) hit the book (å•ƒä¹¦ï¼Œç”¨å·¥è¯»ä¹¦) â€”â€” I got an exam tomorrow. so I got to hit the books tonight. ï¼ˆæˆ‘æ˜å¤©æœ‰ä¸ªè€ƒè¯•ï¼Œä»Šæ™šæˆ‘è¦å¿µä¹¦å‘¢ï¼‰ hit the roof (æš´è·³å¦‚é›·ï¼Œå¤§æ€’) â€”â€” My parents would hit the roof if he knew that I wrecked his car ï¼ˆå¦‚æœæˆ‘çˆ¸å‘ç°æˆ‘æ¯äº†ä»–çš„è½¦ï¼Œä¸€å®šä¼šæš´è·³å¦‚é›·çš„ï¼‰ hit me (åœºæ™¯ï¼š å¯¹é…’å§è°ƒé…’å¸ˆè¯´hit me, æŒ‡å†æ¥ä¸€æ¯) *ground rules = basic rule * (åŸºæœ¬è§„åˆ™) Are there ground rules (æœ‰ä»€ä¹ˆåŸºæœ¬çš„è§„åˆ™å—ï¼Ÿ å¦‚åœ¨ç©æ¸¸æˆå‰åšå¥½è§„åˆ™) Iâ€™m just saying (A: youâ€™re so handsome, Iâ€™m just saying. ä¸ºäº†é¿å…å°´å°¬çš„å±€é¢ï¼Œå¯ä»¥è¯´Iâ€™m just saying.) He really told her off (ä»–è‡­éª‚äº†å¥¹ä¸€é¡¿) shave a head (ç†å‘) *on top of * (å¹¶ä¸” å¦å¤–) *reduce anxiety * (å‡å°‘ã€é™ä½ç„¦è™‘ï¼Œæ³¨æ„åŠ¨è¯çš„ä½¿ç”¨) fixate on sth (æèµ·sth) Why does everyone keep fixating on that? (ä¸ºä»€ä¹ˆå¤§å®¶éƒ½ç»•ç€è¿™ä¸ªè¯é¢˜æ‰“è½¬ï¼Ÿ ) *of course it was a line * (æ˜¾ç„¶è¿™æ˜¯éª—ä½ çš„) live off (ä»¥â€¦ä¸ºé£Ÿæ–™ï¼›é â€¦ç”Ÿæ´»ï¼›ä½åœ¨â€¦ä¹‹å¤–) You canâ€™t live off your parents all the time (ä½ ä¸èƒ½ä¸€ç›´é ä½ çˆ¶æ¯ç”Ÿæ´») æ˜¯ï¼ˆisï¼‰, æœ‰ï¼ˆthere beï¼‰, æ—¶ï¼ˆwhenï¼‰ (ä¸‡èƒ½è½¬æ¢) loudly å’Œ loud çš„åŒºåˆ« loudly æœ‰åµé—¹çš„å£°éŸ³å¤§çš„æ„Ÿè§‰speak loud and clear ä¸ºæŸäººæ”¯ä»˜è´¹ç”¨ cover for you (æš‚æ—¶å¸®ä½ ä»˜ï¼Œå›å¤´ä½ éœ€è¦å½’è¿˜) I forgot my wallet, can you cover me? (æˆ‘å¿˜è®°å¸¦é’±åŒ…äº†ï¼Œèƒ½å…ˆä¸´æ—¶å¸®æˆ‘ä»˜ä¸€ä¸‹å—ï¼Ÿ)pay for you (å¸®ä½ ä»˜ï¼Œä¸éœ€è¦ä½ è¿˜) She gives him a withering look ï¼ˆå¥¹ç”¨ä¸€ä¸ªç»æœ›æˆ–å¤±æœ›çš„çœ¼ç¥çœ‹äº†ä»–ä¸€çœ¼ï¼‰ You had one job (å°±è®©ä½ å¹²äº†ä¸€ä»¶äº‹è¿˜å¹²ä¸å¥½çš„æ„æ€) *beyond oneâ€™s grasp, beyond oneâ€™s capatibility , out of reach, out of control åŒºåˆ« * beyond oneâ€™s grasp (é­é•¿è«åŠï¼Œæœ‰èƒ½åŠ›ï¼Œä½†æ˜¯è¿œæ°´è§£ä¸äº†è¿‘æ¸´çš„æ„Ÿè§‰) I canâ€™t help him because itâ€™s beyond my graspbeyond oneâ€™s capatibility (è¶…å‡ºæŸäººçš„èƒ½åŠ›èŒƒå›´) The work is difficult and beyond my capatibility (å·¥ä½œå¤ªéš¾è¶…å‡ºäº†æˆ‘çš„èƒ½åŠ›èŒƒå›´ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¯´ itâ€™s beyond me)out of reach (æŒ‡ç©ºé—´è·ç¦»çš„ä¸èƒ½åŠ) Iâ€™m in BJï¼Œ teaching in SH is out of reachout of control (æŸç‰©ä¸å¯æ§) The fire is out of control (å¤§ç«å¤±å»äº†æ§åˆ¶) a family of three (ä¸‰å£ä¹‹å®¶) *have yet to do sth * (used for saying that something has not happened or been done up to the present time, especially when you think it should have happened or been done) As for accommodation, the resort has yet to announce the price of a stay in its hotel rooms. (è‡³äºè†³å®¿ï¼Œåº¦å‡èƒœåœ°è¿˜æ²¡æœ‰å…¬å¸ƒé…’åº—çš„è´¹ç”¨) trial run/flight/version (è¯•è¿è¡Œ/è¯•é£/è¯•ç”¨ç‰ˆæœ¬) turn over in oneâ€™s mind (Think about something thoroughly) My father gave me some advice that Iâ€™ve been turning over in my mind ever since (æˆ‘çˆ¶äº²æ•™å¯¼è¿‡æˆ‘ä¸€å¥è¯ï¼Œæˆ‘è‡³ä»Šè¿˜å¿µå¿µä¸å¿˜) web celebrity (ç½‘çº¢ï¼Œ celebrityä¹Ÿå¯ä»¥æŒ‡åå£°åæ°”) *You have got to do sth * (å¼ºçƒˆå»ºè®®åšæŸäº‹ï¼Œ got è¦åŠ é‡éŸ³) Youâ€™ve got to try this. Iâ€™m not that much of â€¦ (æˆ‘è¿˜æ²¡é‚£ä¹ˆâ€¦,è¿˜æ²¡åˆ°..ç¨‹åº¦ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§è°¦è™šçš„è¯´æ³•) Iâ€™m not that much of an artistIâ€™m not that much of a sweet tooth (æˆ‘ä¸é‚£ä¹ˆå–œæ¬¢åƒç”œé£Ÿ) This is the best sth/sb I have ever done This is the best radio show I have ever listened to.This is the best movie I have ever seen Sth is addressed to you* (sthæ˜¯é‚®å¯„ç»™ä½ çš„) This is not addressed to you (è¿™ä¸æ˜¯é‚®å¯„ç»™ä½ çš„)æ³¨æ„åè¯åŠ¨è¯çš„è¯»éŸ³åŒºåˆ† vt. æ¼”è¯´ï¼›ä»äº‹ï¼›å¿™äºï¼›å†™å§“ååœ°å€ï¼›å‘â€¦è‡´è¾ï¼›ä¸â€¦è¯´è¯ï¼›æå‡ºï¼›å¤„ç† n. åœ°å€ï¼›æ¼”è®²ï¼›è‡´è¾ï¼›è¯´è¯çš„æŠ€å·§ï¼›ç§°å‘¼ send away send away for sth (request another sth) æƒ³è±¡â€œè®©å¿«é€’å°å“¥é€è¿‡æ¥sthâ€ ** Iâ€™ll be right with you.** (ç­‰ç­‰ï¼Œæˆ‘é©¬ä¸Šå°±æ¥) Wait a few minutes and Iâ€™ll be right with you. (è¯·ç­‰ä¸€ä¸‹ï¼Œæˆ‘é©¬ä¸Šå°±æ¥) sink oneâ€™s teeth into sth/sb bite to sth/sbI canâ€™t wait to sink my teeth into that delicious-looking dessert(é¤åç”œç‚¹) you madeThe dog sunk his teeth into the little boyâ€™s arm. get a chance to do something energetically or productivelyI want to give the students a project they can really sink their teeth into.Iâ€™m so bored at work. I would like something I can sink my teeth into. first-tier city (ä¸€çº¿åŸå¸‚) take sb/sth for granted (æŠŠâ€¦å½“æˆç†æ‰€å½“ç„¶) So many of us take clean water for granted.Children often take their parents for granted. slow motion hair shake (æ…¢åŠ¨ä½œç”©å¤´å‘) Itâ€™s a running gag ï¼ˆä¸åœå‡ºç°çš„ç¬‘ç‚¹ï¼‰ gag me (short for gag me with a spoon) Shit i have so much homework. Gag meee! (æ€äº†æˆ‘å§ï¼Œæ¶å¿ƒæ­»æˆ‘å§) stare at sb ( ç›¯ç€æŸäººçœ‹ï¼Œ ä¸æ˜¯å¾ˆç¤¼è²Œçš„è¡Œä¸º) Donâ€™t stare wafer thin ice (å¾ˆå±é™©äº†) youâ€™re standing on thin ice ï¼ˆä½ å¾ˆå±é™©äº†ï¼Œâ€œåˆ«å˜šç‘Ÿäº†ï¼Œå†è§¦ç¢°åº•çº¿å°±æ­»å®šäº†â€ï¼‰ sth rules (sthå¾ˆç»™åŠ›ï¼ŒæŒ‡å¾ˆè¿‡ç˜¾) movie rules / water rules *leg warms * (ç§‹è£¤) You shush ï¼ˆä½ é—­å˜´å§ï¼‰ å£è¯­ä¸­ï¼ŒYou shushæˆ–è€…Shushçš„ä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œè¯´è¯è€…ç”¨æ¥è®©å¯¹æ–¹â€œé—­å˜´â€æˆ–è€…â€œå®‰é™ä¸€ä¸‹Shush! I want to hear the weather. (å®‰é™ï¼æˆ‘è¦å¬å¤©æ°”é¢„æŠ¥)Shush! Here he comes. Iâ€™ll talk to you later. (å˜˜ï¼ä»–æ¥äº†ã€‚æˆ‘ä¸€ä¼šå„¿å†è·Ÿä½ è¯´)Donâ€™t shush me. (è®©å¯¹æ–¹å®‰é™çš„æ„æ€)æ³¨æ„ï¼š Shushä¸Shut upæ‰€è¡¨è¾¾çš„å«ä¹‰ç›¸åŒï¼Œä½†Shushçš„è¯­æ°”æ¯”è¾ƒå§”å©‰å’Œå®¢æ°”ï¼Œè€ŒShut upåˆ™æ¯”è¾ƒç²—é²ï¼Œä¸€èˆ¬æ˜¯æ€¥äº†çš„æƒ…å†µä¸‹ç”¨è¿™ç§è¡¨è¾¾æ¥è®©å¯¹æ–¹â€œä½å£â€ *one hit wonder * (one hit wonderï¼ŒæŒ‡ä»£ä¸€ä¸ªæ­Œæ‰‹æˆ–è€…ç»„åˆåªæœ‰ä¸€é¦–æˆåŠŸçš„å•æ›²) There are lots of singers are one hit wonder tell each other secrets (äº’ç›¸æ­ç©¿ç§˜å¯†) freshman sophomore junior senior (å¤§ä¸€å¤§äºŒå¤§ä¸‰å¤§å››) *valley girl * ï¼ˆè¯´è¯å£°éŸ³æ¯”è¾ƒå¤§ï¼Œæ¯”è¾ƒå…´å¥‹çš„å¥³å­©ï¼Œä¼šè®©å‘¨å›´çš„äººè§‰å¾—å¾ˆåµ ï¼‰ è‹±è¯­ä¸­æ²¡æœ‰å­¦å“¥å°å¦¹ï¼Œåªéœ€è¦è¯´æ¥è‡ªåŒä¸€ä¸ªå­¦æ ¡å°±å¯ä»¥äº†ï¼Œ he was my friend from college æˆ–è€… alumni /É™â€™lÊŒmnaÉª/ æ ¡å‹ to make matters worse (æ›´ç³Ÿç³•çš„æ˜¯) tough cookie = a difficult people (éš¾ç›¸å¤„çš„äºº) wedding vows ï¼ˆvery serious promiseï¼Œ ç°åœ¨å¤šæ•°åœ¨ç»“å©šæ—¶å€™ç”¨äº†ï¼‰ å©šå§»èª“è¯ flash back episode (å›é¡¾ç‰‡æ®µ ç”µå½±ä¸­çš„å›å¿†ç‰‡æ®µ) *steal oneâ€™s thunder * (æŠ¢äº†è°çš„é£å¤´) Your roof, your rules (ä½ çš„åœ°ç›˜ä½ åšä¸») a blessing in disguise (å¡ç¿å¤±é©¬ï¼Œå› ç¥¸å¾—ç¦) word on the street (å°é“æ¶ˆæ¯) *second mother tongue * ï¼ˆç¬¬äºŒæ¯è¯­ï¼‰ serve for sth ï¼ˆæœåŠ¡../ç”¨æ¥åš..ï¼‰ show off (ç‚«è€€ï¼Œæ˜¾æ‘†) Reading makes a full man; conference a ready man;and writing an exact man (è¯»ä¹¦ä½¿äººå……å®ï¼›äº¤è°ˆä½¿äººæœºæ•ï¼›ç¬”è®°ä½¿äººç²¾ç¡®) learn from the past (ä»å†å²/è¿‡å»ä¸­å­¦ä¹ ) Those are way too expensive (way too + adj å¤ªâ€¦) Heâ€™s a pushover (ä»–æ˜¯ä¸€ä¸ªå®¹æ˜“è¢«æŒæ§ä½¿å”¤çš„äºº) Heâ€™s a buzzkill (ä»–æ˜¯ä¸€ä¸ªæ‰«å…´çš„äºº) iâ€™m not doing it/sth (æ­£åœ¨å¦è®¤ä¸åšä»€ä¹ˆ) Iâ€™m not returning them, youâ€™ll see (youâ€™ll see ç­‰ç€çœ‹å§ï¼Œå°¾è¯­) æˆè¯­çŸ­è¯­æ€»ç»“ ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ &lt;â€”â€”&gt; ç»å‰é¡¾å rain or shine &lt;â€”â€”&gt; take a look around You have to carry out(è´¯å½»ï¼Œæ‰§è¡Œ) your plan, rain or shine. Buddy, just keep goingï¼Œ Iâ€™ll be along with you, rain or shine. If you take a look around, you will miss a lot of oppotunities that were supposed to belong to you. ä¸å¯’è€Œæ — Make oneâ€™ s teeth chatter(ä½¿å¡å—’å¡å—’ä½œå£°). Make oneâ€™s flesh(è‚‰ä½“) creep The mysterious /mÉªâ€™stÉªrÉªÉ™s/ sound in the dark made Lilyâ€™s teeth chatter. The news that fake vaccines were being sold to different provinces in China made my teeth chatter. ä¸å¯æ•‘è¯ &lt;â€”â€”&gt; å¾®æ„Ÿä¸é€‚ beyond remedy(è¡¥æ•‘ï¼Œæ²»ç–—ï¼Œèµ”å¿) &lt;â€”â€”&gt; To feel off color Robertâ€™s laziness is beyond remedy. Tom feels off color ä¸å¯åŒæ—¥è€Œè¯­ &lt;â€”â€”&gt; ç›¸æå¹¶è®º canâ€™t be mentioned on the same day &lt;â€”â€”&gt; place on par Johnâ€™s idea is different from Jeanâ€™s, they canâ€™t be mentioned on the same day. Both of things can not be placed on par. ç”Ÿè¯è¡¨ åºå· å•è¯ éŸ³æ ‡ è¯æ€§å’Œè§£é‡Š 1 ditch /dÉªtÊƒ/ vt. åœ¨â€¦ä¸Šæ˜æ²Ÿï¼›æŠŠâ€¦å¼€å…¥æ²Ÿé‡Œï¼›ä¸¢å¼ƒ n. æ²Ÿæ¸ ï¼›å£•æ²Ÿ 2 custod /â€˜kÊŒstÉ™di/ n. ä¿ç®¡ï¼›ç›‘æŠ¤ï¼›æ‹˜ç•™ï¼›æŠšå…»æƒ 3 alcoholic /,Ã¦lkÉ™â€™hÉ”lÉªk/ adj. é…’ç²¾çš„ï¼Œå«é…’ç²¾çš„ n. é…’é¬¼ï¼Œé…—é…’è€… 4 revelation /â€˜rÉ›vÉ™â€™leÊƒÉ™n/ n. å¯ç¤ºï¼›æ­éœ²ï¼›å‡ºä¹æ„æ–™çš„äº‹ï¼›è¢«æ­éœ²çš„çœŸç›¸ 5 massage /mÉ™â€™sÉ‘ËÊ’ n. æŒ‰æ‘©ï¼›æ‰ vt. æŒ‰æ‘©ï¼›æ‰ 6 horoscope /â€˜hÉ”rÉ™skop n. å æ˜Ÿæœ¯ï¼›æ˜Ÿè±¡ï¼›åäºŒå®«å›¾ 7 nonsense /â€˜nÉ‘nsÉ›n/ n. èƒ¡è¯´ï¼›åºŸè¯ 8 charming /â€˜tÊƒÉ‘rmÉªÅ‹/ adj. è¿·äººçš„ï¼›å¯çˆ±çš„ 9 arrogant /â€˜Ã¦rÉ™É¡É™n/ adj. è‡ªå¤§çš„ï¼Œå‚²æ…¢çš„ 10 oops /uËps/ ï¼ˆè¡¨ç¤ºæƒŠè®¶æˆ–åæ‚”ï¼‰å“å“Ÿâ€¦ 11 taboo /tÉ™ËˆbuË/ ç¦å¿Œ 12 dash /dÃ¦Êƒ/ è¿å­—ç¬¦â€-â€œ 13 underscore /ËŒÊŒn.dÉšËˆskÉ”Ër/ ä¸‹åˆ’çº¿â€_â€ 14 money-oriented / -É”Ër.i.en.tÌ¬Éªd/ å¯¼å‘é’±çš„, æ³¨æ„è¿å­—ç¬¦çš„ä½¿ç”¨ 15 detail-oriented / -É”Ër.i.en.tÌ¬Éªd/ å¯¼å‘ç»†èŠ‚çš„ï¼Œ æ³¨æ„è¿å­—ç¬¦çš„ä½¿ç”¨ï¼Œå¯èƒ½å‡ ç™¾å¹´åå°±æ˜¯ä¸€ä¸ªå•è¯ï¼Œä¸­é—´æ²¡æœ‰è¿å­—ç¬¦ 16 alley / ËˆÃ¦l.i/ å°è¡—, å°å··ï¼Œèƒ¡åŒ, ï¼ˆå°¤æŒ‡ä¸¤è¾¹æœ‰æ ‘æˆ–çŒæœ¨çš„ï¼‰å°å¾„â€¦ 17 stove / stoÊŠv/ ï¼ˆç”¨äºå–æš–çš„ï¼‰ç‚‰ï¼Œç«ç‚‰, ç‚‰ç¶â€¦ 18 ramen /ËˆrÉ‘Ë.men/ æ—¥å¼æ‹‰é¢ æ–¹ä¾¿é¢ 19 drip-&gt;dribble /drÉªp/ /ËˆdrÉªb.É™l/ æ»´å—’-&gt;æ»´æ»´ç­”ç­” frequentative form åå¤åŠ¨è¯ 20 murmur /ËˆmÉË.mÉš/ è½»å£°è¯´, ä½å£°è¯´ ,å–ƒå–ƒè‡ªè¯­ frequentative form åå¤åŠ¨è¯ 21 jerk /dÊ’ÉœËk/ ï¼ˆç¾ä¿š) foolish person è ¢äºº.é˜¿å‘†,ç¬¨ç“œ,ä¸æ‡‚ä¸–æ•… ï¼ˆé€‚åˆå¥½æœ‹å‹ä¹‹é—´ç”¨ï¼Œæœ‰ç‚¹å¹¼ç¨šï¼Œå¯çˆ±çš„æ„Ÿè§‰ï¼‰ 22 seminar /Ëˆsem.É™.nÉ‘Ër/ ä¸“é¢˜è®¨è®ºä¼š, ç ”è®¨ä¼šâ€¦ 23 bluff /blÊŒf/ ä»¥å‡è±¡æ¬ºéª—ï¼Œè’™ï¼Œå”¬ 24 bury /Ëˆber.i/ åŸ‹, åŸ‹è‘¬ï¼Œå®‰è‘¬, æ©åŸ‹ 25 hatchet /ËˆhÃ¦tÊƒ.Éªt/ å°æ–§å¤´ 26 cosmetic /kÉ‘ËzËˆmetÌ¬.Éªk/ adj. ç¾å®¹çš„ï¼›åŒ–å¦†ç”¨çš„ n. åŒ–å¦†å“ï¼›è£…é¥°å“ 27 sentimental /â€˜sÉ›ntÉ™â€™mÉ›ntl/ adj. ä¼¤æ„Ÿçš„ï¼›å¤šæ„å–„æ„Ÿçš„ï¼›æ„Ÿæƒ…ç”¨äº‹çš„ï¼›å¯“æœ‰æƒ…æ„Ÿçš„ 28 bendï¼ˆè¿‡å»æ—¶bentâ€å¼¯æ›²çš„â€ï¼‰ /bÉ›nd/ vt. ä½¿å¼¯æ›²ï¼›ä½¿å±ˆæœï¼›ä½¿è‡´åŠ›ï¼›ä½¿æœå‘ vi. å¼¯æ›²ï¼Œè½¬å¼¯ï¼›å±ˆæœï¼›å€¾å‘ï¼›ä¸“å¿ƒäº n. å¼¯æ›² 29 daisy /â€˜deÉªzÉª/ n. é›èŠï¼›èŠç§‘æ¤ç‰©ï¼›æå¥½çš„ä¸œè¥¿ adj. æå¥½çš„ï¼›ä¸Šç­‰çš„ 30 tassel /â€˜tÃ¦sl/ n. æµè‹ï¼›ç¼¨ï¼›ç©— vt. ç”¨æµè‹è£…é¥°ï¼›æ‘˜ä¸‹â€¦ç©— 31 step-dad, step-mom, step-brother, step-sister ç»§çˆ¶,ç»§æ¯,ç»§å…„,ç»§å¥³ 32 asbestos /Ã¦zâ€™bestÉ’s / n.çŸ³æ£‰ 33 ceiling /â€˜siËlÉªÅ‹/ å¤©èŠ±æ¿ 34 oven /â€˜ÊŒvÉ™n/ n. çƒ¤ç®± 35 bulb /bÊŒlb/ n. ç”µç¯æ³¡ 36 bittersweet /â€˜bÉªtÉš,swit/ adj. è‹¦ä¹å‚åŠçš„ï¼›åˆè‹¦åˆç”œçš„ n. åˆè‹¦åˆç”œçš„ä¸œè¥¿ï¼›èœ€ç¾Šæ³‰ 37 narcissist /nÉ‘râ€™sÉªsÉªst/ n. è‡ªæˆ‘é™¶é†‰è€… è‡ªæ‹çš„äºº 38 narcissism /â€˜nÉ‘rsÉªâ€™sÉªzÉ™/ n. [å¿ƒç†] è‡ªæ‹ï¼Œè‡ªæˆ‘é™¶é†‰ 39 downhill /,daÊŠnâ€™hÉªl/ adv. ä¸‹å¡ï¼›å‘ä¸‹ï¼›æ¯å†µæ„ˆä¸‹ adj. ä¸‹å¡çš„ï¼›å®¹æ˜“çš„ n. ä¸‹å¡ï¼›æ»‘é™ 40 punchline /â€˜pÊŒntÊƒlaÉªn/ n. ç¬‘ç‚¹ï¼›ç»“å°¾è­¦è¯­ï¼›å¦™è¯­å¦‚ç  41 bald /bÉ”ld/ adj. ç§ƒé¡¶çš„ï¼›å…‰ç§ƒçš„ï¼›å•è°ƒçš„ï¼›æ— è£…é¥°çš„ vi. å˜ç§ƒ 42 therapy /â€˜Î¸É›rÉ™pi/ n. æ²»ç–—ï¼Œç–—æ³• 43 tuition /tÊŠâ€™ÉªÊƒÉ™n/ n. å­¦è´¹ï¼›è®²æˆ 44 tutor /â€˜tÊŠtÉš/ vt. è¾…å¯¼ï¼›çº¦æŸ n. å¯¼å¸ˆï¼›å®¶åº­æ•™å¸ˆï¼›åŠ©æ•™ vi. å½“å®¶åº­æ•™å¸ˆï¼›ï¼ˆç¾ï¼‰åœ¨å®¶åº­æ•™å¸ˆæŒ‡å¯¼ä¸‹å­¦ä¹  45 scooter /ËˆskuË.tÌ¬Éš/ n. å•è„šæ»‘è¡Œè½¦ 46 ambidextrous /â€˜Ã¦mbÉ™â€™dÉ›kstrÉ™s/ n. æ—è§‚è€… 47 onlooker = spectator /â€˜É‘nlÊŠkÉš/ adj. åŒæ‰‹çµå·§çš„ï¼›æ€€æœ‰äºŒå¿ƒçš„ 48 vague /veÉ¡/ adj. æ¨¡ç³Šçš„ï¼›å«ç³Šçš„ï¼›ä¸æ˜ç¡®çš„ï¼›æš§æ˜§çš„ 49 genetics /dÊ’É™â€™nÉ›tÉªks/ n. é—ä¼ å­¦ 50 clumsy /â€˜klÊŒmzi/ adj. ç¬¨æ‹™çš„ 51 stigma /â€˜stÉªÉ¡mÉ™/ n. [æ¤] æŸ±å¤´ï¼›è€»è¾±ï¼›æ±¡åï¼›çƒ™å°ï¼›ç‰¹å¾ 52 gasp /É¡Ã¦sp/ vi. å–˜æ°”ï¼›å–˜æ¯ï¼›æ¸´æœ› vt. æ°”å–˜åååœ°è¯´ï¼›å–˜ç€æ°”è¯´è¯ n. å–˜æ°” (å¾ˆæƒŠè®¶çš„åœºæ™¯ï¼Œå€’å¸ä¸€å£æ°”) 53 creamy /â€˜krimi/ adj. å¥¶æ²¹è‰²çš„ï¼›ä¹³è„‚çŠ¶çš„ï¼›å«ä¹³è„‚çš„ 54 hypocrite /â€˜hÉªpÉ™â€™krÉª/ n. ä¼ªå›å­ï¼›ä¼ªå–„è€… 55 foreshadow /fÉ”rËˆÊƒÃ¦dÂ·oÊŠ/ vt. é¢„ç¤ºï¼›æˆä¸ºâ€¦çš„å‰å…†ï¼Œåšé“ºå« n. é¢„å…†ï¼Œé“ºå« 56 cliche /kliËËˆÊƒeÉª/ n. é™ˆè¯æ»¥è°ƒï¼›[å°åˆ·] é“…ç‰ˆï¼›é™ˆè…æ€æƒ³ adj. é™ˆè…çš„ a saying or remark that is very often made and is therefore not original and not interesting ,æƒ³è±¡å‰§æƒ…ä¸­çš„ç”©å¤´å‘å¤ªæ™®éäº†ï¼Œçƒ‚å¤§è¡—äº† 57 conversationalist /ËŒkÉ‘Ën.vÉšËˆseÉª.ÊƒÉ™n.É™l.Éªst/ n. å¥è°ˆçš„äºº someone who enjoys or is good at talking with people 58 intently /ÉªnËˆtentÂ·li/ adv. ä¸“å¿ƒåœ°ï¼›ä¸€å¿ƒä¸€æ„åœ°ï¼›å¿ƒæ— æ—éª›åœ° in a way that shows great attention to something 59 pathetic /pÉ™ËˆÎ¸etÌ¬.Éªk/ adj. å¯æ€œçš„ï¼Œæ‚²å“€çš„ï¼›æ„Ÿä¼¤çš„ï¼›ä¹å‘³çš„","categories":[{"name":"Life","slug":"Life","permalink":"https://dayarch.top/categories/Life/"},{"name":"English","slug":"Life/English","permalink":"https://dayarch.top/categories/Life/English/"}],"tags":[{"name":"English","slug":"English","permalink":"https://dayarch.top/tags/English/"}]},{"title":"Hexoåœ¨githubä¸Šæ­å»ºè‡ªå·±çš„åšå®¢","slug":"buildGithubBlog","date":"2015-08-09T12:01:29.000Z","updated":"2019-11-07T05:16:06.555Z","comments":true,"path":"/p/build-github-pages-blog.html","link":"","permalink":"https://dayarch.top/p/build-github-pages-blog.html","excerpt":"å¼•è¨€ é•¿æ—¶é—´åœ¨æŸå¹³å°ä¸Šå†™åšå®¢è®°å½•äº›ä»€ä¹ˆï¼Œä½†æ˜¯è¿‘æœŸè¯¥å¹³å°é™†é™†ç»­ç»­å‡ºç°ä¸€äº›å°é—®é¢˜ï¼Œè®©å†™åšå®¢è¿™ä¹ˆæ„‰å¿«çš„äº‹æƒ…æ€»æ˜¯å……æ–¥ç€å„ç§æ’æ›²ï¼Œç¨ç¨ä¸çˆ½ï¼Œäºæ˜¯ä¹å¼€å§‹å‡†å¤‡æ­å»ºè‡ªå·±çš„çš„åšå®¢ï¼Œé€šè¿‡æŸ¥é˜…èµ„æ–™ç”¨äº†ä¸¤å¤©æ—¶é—´åˆæ­¥æ­å»ºèµ·æ¥ï¼Œæ”¶è·é¢‡ä¸°ï¼Œæ‰€ä»¥è¶çƒ­æ‰“é“è®°å½•æ•´ä¸ªè¿‡ç¨‹ï¼Œæ­å»ºè¿‡ç¨‹å‚è€ƒäº†éå¸¸å¤šå‰è¾ˆä»¬çš„blogï¼Œå…ˆçœŸè¯šçš„é“ä¸€å£°â€œæ„Ÿè°¢â€ï¼Œæ–‡ç« æœ«å°¾ä¼šç»™å‡ºç›¸å…³çš„å‚è€ƒé“¾æ¥ã€‚å¯æ­å»ºåšå®¢çš„æ¡†æ¶å¾ˆå¤šï¼Œå‚è€ƒé™æ€åšå®¢æ¡†æ¶å¯¹æ¯”ï¼Œé€‰æ‹©ä½ çœ‹ä¸Šçœ¼çš„ï¼Œæœ¬æ–‡é€‰æ‹©Hexoï¼Œä¸ºä»€ä¹ˆé€‰æ‹©å®ƒï¼Œæˆ‘åªèƒ½è¯´å¯¹æ¯”ä¹‹åå–œæ¬¢. ä¸ºä»€ä¹ˆé€‰æ‹©githubå¹³å°ï¼Ÿ ä¸ºä»€ä¹ˆé€‰æ‹©githubå¹³å°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¸¤ç»„é—®é¢˜å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†. åšå‹ä»¬æ˜¯å¦åœ¨ç¼–å†™åšå®¢çš„æ—¶å€™é‡åˆ°è¿‡ä»¥ä¸‹é—®é¢˜ï¼š 1.","text":"å¼•è¨€é•¿æ—¶é—´åœ¨æŸå¹³å°ä¸Šå†™åšå®¢è®°å½•äº›ä»€ä¹ˆï¼Œä½†æ˜¯è¿‘æœŸè¯¥å¹³å°é™†é™†ç»­ç»­å‡ºç°ä¸€äº›å°é—®é¢˜ï¼Œè®©å†™åšå®¢è¿™ä¹ˆæ„‰å¿«çš„äº‹æƒ…æ€»æ˜¯å……æ–¥ç€å„ç§æ’æ›²ï¼Œç¨ç¨ä¸çˆ½ï¼Œäºæ˜¯ä¹å¼€å§‹å‡†å¤‡æ­å»ºè‡ªå·±çš„çš„åšå®¢ï¼Œé€šè¿‡æŸ¥é˜…èµ„æ–™ç”¨äº†ä¸¤å¤©æ—¶é—´åˆæ­¥æ­å»ºèµ·æ¥ï¼Œæ”¶è·é¢‡ä¸°ï¼Œæ‰€ä»¥è¶çƒ­æ‰“é“è®°å½•æ•´ä¸ªè¿‡ç¨‹ï¼Œæ­å»ºè¿‡ç¨‹å‚è€ƒäº†éå¸¸å¤šå‰è¾ˆä»¬çš„blogï¼Œå…ˆçœŸè¯šçš„é“ä¸€å£°â€œæ„Ÿè°¢â€ï¼Œæ–‡ç« æœ«å°¾ä¼šç»™å‡ºç›¸å…³çš„å‚è€ƒé“¾æ¥ã€‚å¯æ­å»ºåšå®¢çš„æ¡†æ¶å¾ˆå¤šï¼Œå‚è€ƒé™æ€åšå®¢æ¡†æ¶å¯¹æ¯”ï¼Œé€‰æ‹©ä½ çœ‹ä¸Šçœ¼çš„ï¼Œæœ¬æ–‡é€‰æ‹©Hexoï¼Œä¸ºä»€ä¹ˆé€‰æ‹©å®ƒï¼Œæˆ‘åªèƒ½è¯´å¯¹æ¯”ä¹‹åå–œæ¬¢. ä¸ºä»€ä¹ˆé€‰æ‹©githubå¹³å°ï¼Ÿä¸ºä»€ä¹ˆé€‰æ‹©githubå¹³å°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¸¤ç»„é—®é¢˜å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†. åšå‹ä»¬æ˜¯å¦åœ¨ç¼–å†™åšå®¢çš„æ—¶å€™é‡åˆ°è¿‡ä»¥ä¸‹é—®é¢˜ï¼š åšå®¢å¹³å°å‡çº§ç»´æŠ¤ æ²¡æœ‰ç½‘ç»œï¼ˆæ¯”åšå®¢å‡çº§å’Œç»´æŠ¤è¿˜æƒ¨ï¼‰ ä¸å¤Ÿå®šåˆ¶åŒ– githubä¸Šæ­å»ºè‡ªå·±çš„åšå®¢å½“ç„¶æ˜¯æœ‰å¾ˆå¤šå¥½å¤„çš„ï¼š å­¦ç€ç”¨githubï¼Œäº«å—githubçš„ä¾¿åˆ©ï¼Œä¸Šé¢æœ‰å¾ˆå¤šå¤§ç‰›ï¼Œçœ¼ç•Œä¼šå¼€é˜”å¾ˆå¤š é¡ºä¾¿çœ‹çœ‹githubå·¥ä½œåŸç†ï¼Œæœ€å¥½çš„å›¢é˜Ÿåä½œæµç¨‹ è‡ªæˆ‘è®¤ä¸ºå¼€æºæ˜¯ä¸€ç§è¶‹åŠ¿ï¼Œgithubä¸Šæœ‰è‰¯å¥½çš„å¼€æºæ°›å›´ä¸ç²¾ç¥ å®šåˆ¶åŒ–çš„åšå®¢ï¼Œå¯ä»¥æŒ‰ç…§è‡ªå·±çš„å–œå¥½æ¥åšæ›´æ”¹ å³ä¾¿ç¦»çº¿æˆ‘ä¹Ÿå¯ä»¥æŒ‰ç…§Markdownè¯­æ³•æ¥ç¼–å†™åšå®¢ï¼Œæœ‰ç½‘ç»œæ—¶ä¸Šä¼ å³å¯ ä¸€ä»½ä½¿ç”¨ Markdown æ ¼å¼æ’°å†™çš„æ–‡ä»¶åº”è¯¥å¯ä»¥ç›´æ¥ä»¥çº¯æ–‡æœ¬å‘å¸ƒï¼Œå¹¶ä¸”çœ‹èµ·æ¥ä¸ä¼šåƒæ˜¯ç”±è®¸å¤šæ ‡ç­¾æˆ–æ˜¯æ ¼å¼æŒ‡ä»¤æ‰€æ„æˆï¼Œå¯è¯»æ€§å¼º æ­å»ºè¿‡ç¨‹æŒ‰ç…§ä¸‹é¢çš„è¿‡ç¨‹é€æ­¥è¿›è¡Œï¼Œç»†å¿ƒç†è§£é¢†ä¼šï¼Œä½ ä¼šå‘ç°æ­å»ºè¿‡ç¨‹å¾ˆç®€å•, ä¸‹æ–‡éƒ½æ˜¯åœ¨Windows ç¯å¢ƒè¿›è¡Œæ­å»ºã€‚ å‰æœŸå‡†å¤‡å·¥ä½œå®‰è£…Hexoå¾ˆç®€å•ï¼Œä½†æ˜¯éœ€è¦ä¸‹é¢ä¸¤æ ·ä¸œä¸œçš„æ”¯æŒï¼š Node.js Git åœ¨Windows ç¯å¢ƒå®‰è£…çœŸçš„æ˜¯å¤ªç®€å•äº†ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ— è„‘ä¸‹ä¸€æ­¥ Hexoå®‰è£…åœ¨æŸä¸ªç£ç›˜ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åé¼ æ ‡å³é”®å•å‡»ã€Git Bashã€‘, è¿›å…¥ä¸‹å›¾ï¼š æ‰§è¡Œä¸‹é¢å‘½ä»¤å®‰è£…Hexoï¼š $ npm install -g hexo-cli æŸ¥çœ‹ä¸€ä¸‹å®‰è£…çš„Hexoç‰ˆæœ¬ï¼ˆæœ¬äººå®‰è£…çš„æ˜¯3.1.1ï¼‰ hexoçš„å‘½ä»¤è¦æ€ä¹ˆç”¨ï¼Ÿå¿…é¡»helpå‘½ä»¤æ¥å¸®å¿™ å®‰è£…å¥½åå°±éœ€è¦åˆå§‹åŒ–Hexoæ¥åˆ›å»ºé¡¹ç›®äº† $ hexo init è¯¥æ–‡ä»¶å¤¹ä¸‹ä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š scaffolds è„šæ‰‹æ¶ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå·¥å…·æ¨¡æ¿ scripts å†™æ–‡ä»¶çš„jsï¼Œæ‰©å±•hexoçš„åŠŸèƒ½ source å­˜æ”¾åšå®¢æ­£æ–‡å†…å®¹ source/_drafts è‰ç¨¿ç®± source/_posts æ–‡ä»¶ç®± themes å­˜æ”¾çš®è‚¤çš„ç›®å½• themes/landscape é»˜è®¤çš„çš®è‚¤ _config.yml å…¨å±€çš„é…ç½®æ–‡ä»¶ db.json é™æ€å¸¸é‡ é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œå°±è¦å¯åŠ¨äº† $ hexo server è¿™ä¸ªåœ°æ–¹å¯èƒ½ä¼šé‡åˆ°é”™è¯¯ï¼Œ å› ä¸ºserveråœ¨Hexo 3çš„ç‰ˆæœ¬è¢«åˆ†ç¦»å‡ºæ¥ï¼Œéœ€è¦å•ç‹¬å®‰è£…ï¼š $ npm install hexo-server â€“save è¿™æ ·é‡æ–°å¯åŠ¨å°±å¥½äº†. è¿™æ—¶ç«¯å£4000è¢«æ‰“å¼€äº†ï¼Œæˆ‘ä»¬èƒ½è¿‡æµè§ˆå™¨æ‰“å€ï¼Œhttp://localhost:4000/ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æ¥åˆ›å»ºæ–°pageæ¥å†™åšå®¢äº† $ hexo new myNewPage åˆ›å»ºå¥½myNewPage.mdæ–‡ä»¶ä¼šè‡ªåŠ¨æ”¾åœ¨source/_postsç›®å½•ä¸‹ï¼Œç”Ÿæˆçš„mdåç¼€çš„æ–‡ä»¶éœ€è¦é‡‡ç”¨Markdownè¿›è¡Œç¼–å†™ï¼Œç„¶ååˆ·æ–°é¡µé¢ï¼Œä½ å°±ä¼šå‘ç°ä½ çš„æ–°æ–‡ç« äº†ï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹å°æ¿€åŠ¨ï¼Œè¿˜æœ‰æ›´å¥½çš„ï¼Œå¾€ä¸‹çœ‹ã€‚ æ›´æ”¹Hexoä¸»é¢˜å®‰è£…å¥½çš„Hexoæˆ‘ä»¬éƒ½æ˜¯ä¸€æ ·çš„åœ¨source/themesé»˜è®¤ä¸»é¢˜landscape, æ˜¯ä¸æ˜¯è§‰å¾—ä¸å¤Ÿçˆ½ï¼Œ é‚£å°±é€‰æ‹©ä¸»é¢˜, è¿™é‡Œé¢åº”è¯¥æœ‰ä½ æƒ³è¦çš„é‚£ä¸€æ¬¾å§ã€‚ æ‰§è¡Œä¸‹é¢å‘½ä»¤å°†é€‰å¥½çš„ä¸»é¢˜cloneåˆ°è‡ªå·±çš„hexoç©ºé—´ $ git clone https://github.com/A-limon/pacman.git themes/pacman è¿™æ ·ä½ ä¼šå‘ç°pacmanè¿™ä¸ªä¸»é¢˜å°±åœ¨ä½ çš„themesæ–‡ä»¶ä¸‹äº†ï¼Œæƒ³è®©è‡ªå·±åšå®¢æŒ‡å®šä¸»é¢˜ï¼Œåªéœ€è¦ä¿®æ”¹hexoçš„ä¸»é¢˜æ–‡ä»¶_config.yml ä¸­çš„themeå±æ€§å³å¯ theme: pacman é‡æ–°å¯åŠ¨ï¼Œåˆ·æ–°ä½ çš„é¡µé¢ï¼Œä¸»é¢˜å˜äº†å§ã€‚ é…ç½®å’Œä½¿ç”¨Githubæˆ‘ä»¬å¦‚ä½•è®©æœ¬åœ°gité¡¹ç›®ä¸è¿œç¨‹çš„githubå»ºç«‹è”ç³»å‘¢ï¼Ÿç”¨SSH keyså¼€å§‹èœå•å¤„å•å‡»ã€Git Bashã€‘** é¦–å…ˆæˆ‘ä»¬éœ€è¦æ£€æŸ¥ä½ ç”µè„‘ä¸Šç°æœ‰çš„ssh keyï¼š $ cd ~/.ssh å¦‚æœæç¤ºï¼šNo such file or directory è¯´æ˜ä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨gitï¼Œ æ¥ä¸‹æ¥éœ€è¦ç”ŸæˆSSH keys $ ssh-keygen -t rsa -C â€œé‚®ä»¶åœ°å€@youremail.comâ€Generating public/private rsa key pair.Enter file in which to save the key (/Users/your_user_directory/.ssh/id_rsa):&lt;å›è½¦å°±å¥½&gt; æ³¨æ„: æ­¤å¤„çš„é‚®ç®±åœ°å€ï¼Œä½ å¯ä»¥è¾“å…¥è‡ªå·±çš„é‚®ç®±åœ°å€ï¼›æ³¨æ„2: æ­¤å¤„çš„ã€Œ-Cã€çš„æ˜¯å¤§å†™çš„ã€ŒCã€ ç³»ç»Ÿè¦æ±‚è¾“å…¥å¯†ç å’Œç¡®è®¤å¯†ç ï¼š $ Enter passphrase (empty for no passphrase):&lt;è¾“å…¥åŠ å¯†ä¸²&gt;$ Enter same passphrase again:&lt;å†æ¬¡è¾“å…¥åŠ å¯†ä¸²&gt; æœ€åçœ‹åˆ°ä¸‹é¢ç•Œé¢å°±ç”Ÿæˆäº†SSH keys æŒ‰ç…§logæç¤ºæ‰¾åˆ°id_rsa.pubæ–‡ä»¶ï¼Œå¤åˆ¶é‡Œé¢çš„å†…å®¹ï¼Œç„¶åå°†SSH keysæ·»åŠ åˆ°githubä¸Šï¼Œç™»é™†githubç³»ç»Ÿã€‚ç‚¹å‡»å³ä¸Šè§’çš„ Account Settingsâ€”-&gt;SSH Public keys â€”-&gt; add another public keys å¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤æ¥è¿›è¡Œæµ‹è¯•æ˜¯å¦æˆåŠŸ $ ssh -T git@github.com ç°åœ¨ä½ å·²ç»å¯ä»¥é€šè¿‡SSHé“¾æ¥åˆ°GitHubäº†ï¼Œè¿˜æœ‰ä¸€äº›ä¸ªäººä¿¡æ¯éœ€è¦å®Œå–„çš„ã€‚ Gitä¼šæ ¹æ®ç”¨æˆ·çš„åå­—å’Œé‚®ç®±æ¥è®°å½•æäº¤ã€‚GitHubä¹Ÿæ˜¯ç”¨è¿™äº›ä¿¡æ¯æ¥åšæƒé™çš„å¤„ç†ï¼Œè¾“å…¥ä¸‹é¢çš„ä»£ç è¿›è¡Œä¸ªäººä¿¡æ¯çš„è®¾ç½®ï¼ŒæŠŠåç§°å’Œé‚®ç®±æ›¿æ¢æˆä½ è‡ªå·±çš„ï¼Œåå­—å¿…é¡»æ˜¯ä½ çš„çœŸåï¼Œè€Œä¸æ˜¯GitHubçš„æ˜µç§°ã€‚ $ git config â€“global user.name â€œyour nameâ€$ git config â€“global user.email â€œusername@gmail.comâ€œ è‡³æ­¤SSH keysè®¾ç½®æˆåŠŸ å‘å¸ƒåšå®¢åˆ°Githubæˆ‘ä»¬çš„ç»ˆæç›®æ ‡æ˜¯å°†åšå®¢å‘å¸ƒåˆ°githubä¸Šï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦æœ‰ä¸€äº›å‡†å¤‡å·¥ä½œè¦åšã€‚åœ¨githubä¸Šæ–°å»ºusername.github.ioçš„repositoryï¼Œè‡³äºä¸ºä»€ä¹ˆè¯·å‚è€ƒgithub pages æœ¬åœ°æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹å³é”®å•å‡»ã€Git Bashã€‘ æ‰§è¡Œå‘½ä»¤ $ git clone git@github.com:username/username.github.io.git è¿™æ ·å°±åœ¨æœ¬åœ°ç”Ÿæˆäº†è‡ªå·±çš„repository æ€æ ·å‘å¸ƒåˆ°githubä¸Šå»ï¼Œæˆ‘ä»¬åŒæ ·è¦ä¿®æ”¹hexoä¸‹çš„_config.ymlæ–‡ä»¶ï¼Œåœ¨æœ€ådeploymentå¤„å¢åŠ è¿™æ ·ä¸¤è¡Œ deploy:type: githubrepo: git@github.com:username/username.github.io.git ç„¶åæ‰§è¡Œå‘½ä»¤è¿›è¡Œé™æ€åŒ–ï¼Œå°†æ‰€æœ‰æ–‡ä»¶é™æ€åŒ–åˆ°publicæ–‡ä»¶å¤¹ä¸‹ $ hexo generate ç„¶åè¿›è¡Œéƒ¨ç½² $ hexo deploy è¿™ä¸ªåœ°æ–¹å¯èƒ½åˆé‡åˆ°é—®é¢˜äº†ï¼Œæç¤ºã€hexo ERROR Deployer not found: githubã€‘ï¼ŒåŒæ ·æ˜¯3ä»¥ä¸Šç‰ˆæœ¬çš„é—®é¢˜ï¼ŒæŒ‰ç…§ä¸‹é¢æ“ä½œå³å¯ï¼š $ npm install hexo-deployer-git â€“save ç„¶åå°†ä¸Šé¢è¯´åˆ°çš„éƒ¨ç½²æ–‡ä»¶çš„typeç”±githubæ”¹ä¸ºgit deploy:type: gitrepo: git@github.com:username/username.github.io.git é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œç„¶åå‘å¸ƒï¼Œè¿™æ ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥username.github.ioå°±å¯ä»¥åˆ°ä½ åœ¨githubä¸Šçš„åšå®¢äº†ï¼Œ æœ‰æ²¡æœ‰å°æ¿€åŠ¨ï¼Ÿ æœ€åå°ä¼™ä¼´ä»¬å“ªé‡Œçœ‹ä¸æ‡‚æˆ–å“ªé‡Œæœ‰é—®é¢˜æ¬¢è¿ç•™è¨€ï¼Œæˆ‘è¿›è¡Œè¡¥å……æˆ–å›ç­”, æ›´å¤šé—®é¢˜å¯ä»¥å‚è€ƒå®˜ç½‘æ–‡æ¡£Docs . æœ€åçœŸçš„æ„Ÿæ¿€å‰è¾ˆä»¬çš„åšæ–‡æŒ‡ç‚¹ï¼Œä¸‹é¢æä¾›æˆ‘å‚è€ƒè¿‡çš„ä¸€äº›é“¾æ¥ï¼š å¦‚ä½•æ­å»ºä¸€ä¸ªç‹¬ç«‹åšå®¢â€”â€”ç®€æ˜GithubPagesä¸Hexoæ•™ç¨‹ Hexoåœ¨githubä¸Šæ„å»ºå…è´¹çš„Webåº”ç”¨ æ­å»ºä¸€ä¸ªå…è´¹çš„ï¼Œæ— é™æµé‡çš„Blogâ€”-github Pageså’ŒJekyllå…¥é—¨ ç”¨Jekyllåœ¨githubä¸Šå†™åšå®¢â€”â€”ã€Šæ­å»ºä¸€ä¸ªå…è´¹çš„ï¼Œæ— é™æµé‡çš„Blogã€‹çš„æ³¨è„š","categories":[{"name":"Coding","slug":"Coding","permalink":"https://dayarch.top/categories/Coding/"},{"name":"Others","slug":"Coding/Others","permalink":"https://dayarch.top/categories/Coding/Others/"}],"tags":[{"name":"GitHub Pages","slug":"GitHub-Pages","permalink":"https://dayarch.top/tags/GitHub-Pages/"}]}]}